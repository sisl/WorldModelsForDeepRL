Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.05				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((len(self.replay_buffer)*PPO_EPOCHS)//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -24.4186, Test: -54.7602 [16.51], Avg: -71.2712 (0.997)
Ep: 1, Reward: -57.0355, Test: -44.4351 [13.86], Avg: -64.7825 (0.994)
Ep: 2, Reward: -33.7874, Test: -48.8070 [11.25], Avg: -63.2070 (0.991)
Ep: 3, Reward: -60.7929, Test: -64.7147 [11.59], Avg: -66.4811 (0.988)
Ep: 4, Reward: -76.9844, Test: -67.2960 [13.49], Avg: -69.3415 (0.985)
Ep: 5, Reward: -65.4720, Test: -58.5071 [5.68], Avg: -68.4829 (0.982)
Ep: 6, Reward: -49.0748, Test: -38.8992 [14.04], Avg: -66.2618 (0.979)
Ep: 7, Reward: -52.7955, Test: -30.1425 [32.37], Avg: -65.7932 (0.976)
Ep: 8, Reward: -19.1968, Test: 5.9603 [13.46], Avg: -59.3162 (0.973)
Ep: 9, Reward: 0.8226, Test: 9.6579 [44.90], Avg: -56.9085 (0.970)
Ep: 10, Reward: 32.5658, Test: 125.9490 [63.70], Avg: -46.0763 (0.967)
Ep: 11, Reward: 164.6214, Test: 275.3640 [60.22], Avg: -24.3083 (0.965)
Ep: 12, Reward: 256.3115, Test: 477.9249 [261.72], Avg: -5.8071 (0.962)
Ep: 13, Reward: 415.7963, Test: 501.8855 [162.41], Avg: 18.8563 (0.959)
Ep: 14, Reward: 478.2559, Test: 547.5963 [208.46], Avg: 40.2085 (0.956)
Ep: 15, Reward: 489.1659, Test: 308.4376 [180.84], Avg: 45.6706 (0.953)
Ep: 16, Reward: 464.7984, Test: 553.1662 [183.24], Avg: 64.7443 (0.950)
Ep: 17, Reward: 398.7589, Test: 284.4686 [159.64], Avg: 68.0821 (0.947)
Ep: 18, Reward: 468.7286, Test: 535.2417 [228.14], Avg: 80.6623 (0.945)
Ep: 19, Reward: 781.0282, Test: 610.5487 [243.86], Avg: 94.9636 (0.942)
Ep: 20, Reward: 566.9566, Test: 470.5022 [184.51], Avg: 104.0603 (0.939)
Ep: 21, Reward: 354.0948, Test: 528.7605 [227.52], Avg: 113.0231 (0.936)
Ep: 22, Reward: 522.7874, Test: 671.3888 [220.18], Avg: 127.7267 (0.933)
Ep: 23, Reward: 294.5476, Test: 291.6149 [153.22], Avg: 128.1711 (0.930)
Ep: 24, Reward: 437.2597, Test: 623.8340 [227.34], Avg: 138.9041 (0.928)
Ep: 25, Reward: 673.2583, Test: 633.2036 [216.96], Avg: 149.5710 (0.925)
Ep: 26, Reward: 722.7667, Test: 682.9111 [167.52], Avg: 163.1199 (0.922)
Ep: 27, Reward: 811.5516, Test: 421.4412 [205.11], Avg: 165.0203 (0.919)
Ep: 28, Reward: 399.9736, Test: 442.9070 [253.16], Avg: 165.8731 (0.917)
Ep: 29, Reward: 305.0480, Test: 188.2386 [95.39], Avg: 163.4390 (0.914)
Ep: 30, Reward: 246.3824, Test: 95.7849 [85.32], Avg: 158.5044 (0.911)
Ep: 31, Reward: 211.1994, Test: 229.0279 [110.51], Avg: 157.2548 (0.908)
Ep: 32, Reward: 188.4183, Test: 234.9535 [129.63], Avg: 155.6809 (0.906)
Ep: 33, Reward: 295.3926, Test: 270.0160 [93.84], Avg: 156.2837 (0.903)
Ep: 34, Reward: 245.6427, Test: 274.9344 [73.75], Avg: 157.5666 (0.900)
Ep: 35, Reward: 371.4310, Test: 328.8518 [134.01], Avg: 158.6020 (0.897)
Ep: 36, Reward: 306.4025, Test: 462.6133 [179.94], Avg: 161.9552 (0.895)
Ep: 37, Reward: 526.2352, Test: 432.0267 [246.13], Avg: 162.5853 (0.892)
Ep: 38, Reward: 349.6631, Test: 175.4534 [114.11], Avg: 159.9894 (0.889)
Ep: 39, Reward: 256.6483, Test: 252.2659 [106.07], Avg: 159.6445 (0.887)
Ep: 40, Reward: 271.0214, Test: 202.7194 [114.84], Avg: 157.8941 (0.884)
Ep: 41, Reward: 244.6757, Test: 128.1121 [87.37], Avg: 155.1048 (0.881)
Ep: 42, Reward: 117.7563, Test: 124.3229 [107.29], Avg: 151.8939 (0.879)
Ep: 43, Reward: 95.8869, Test: 111.2609 [143.46], Avg: 147.7100 (0.876)
Ep: 44, Reward: 156.9742, Test: 65.6472 [118.03], Avg: 143.2636 (0.874)
Ep: 45, Reward: 78.9633, Test: 15.7728 [85.97], Avg: 138.6232 (0.871)
Ep: 46, Reward: 71.8393, Test: 65.0547 [89.66], Avg: 135.1504 (0.868)
Ep: 47, Reward: 3.0262, Test: 43.8627 [49.90], Avg: 132.2090 (0.866)
Ep: 48, Reward: 66.6456, Test: 85.6910 [111.79], Avg: 128.9781 (0.863)
Ep: 49, Reward: 52.4301, Test: 79.8116 [127.02], Avg: 125.4544 (0.861)
Ep: 50, Reward: 76.9197, Test: 84.4216 [96.19], Avg: 122.7638 (0.858)
Ep: 51, Reward: 84.9479, Test: 51.9412 [94.84], Avg: 119.5780 (0.855)
Ep: 52, Reward: 98.4031, Test: 104.7350 [123.79], Avg: 116.9623 (0.853)
Ep: 53, Reward: 125.1987, Test: 120.8354 [106.60], Avg: 115.0600 (0.850)
Ep: 54, Reward: 55.6648, Test: 275.2555 [164.14], Avg: 114.9883 (0.848)
Ep: 55, Reward: 242.9225, Test: 196.1593 [59.53], Avg: 115.3748 (0.845)
Ep: 56, Reward: 133.1860, Test: 129.0908 [82.03], Avg: 114.1763 (0.843)
Ep: 57, Reward: 212.2661, Test: 214.0910 [148.01], Avg: 113.3471 (0.840)
Ep: 58, Reward: 310.3909, Test: 256.8629 [109.59], Avg: 113.9222 (0.838)
Ep: 59, Reward: 257.1308, Test: 179.7295 [150.32], Avg: 112.5137 (0.835)
Ep: 60, Reward: 181.3708, Test: 266.6721 [133.73], Avg: 112.8486 (0.833)
Ep: 61, Reward: 194.2455, Test: 273.0362 [184.65], Avg: 112.4541 (0.830)
Ep: 62, Reward: 319.1503, Test: 105.7228 [112.22], Avg: 110.5660 (0.828)
Ep: 63, Reward: 253.0371, Test: 194.8169 [97.03], Avg: 110.3664 (0.820)
Ep: 64, Reward: 199.0170, Test: 124.9755 [116.23], Avg: 108.8029 (0.818)
Ep: 65, Reward: 121.0370, Test: 79.5912 [119.39], Avg: 106.5514 (0.815)
Ep: 66, Reward: 71.7732, Test: 85.8237 [133.36], Avg: 104.2516 (0.813)
Ep: 67, Reward: 174.9949, Test: 134.2460 [112.58], Avg: 103.0371 (0.810)
Ep: 68, Reward: 142.3477, Test: 236.8959 [115.06], Avg: 103.3095 (0.808)
Ep: 69, Reward: 215.5050, Test: 228.4307 [141.01], Avg: 103.0826 (0.805)
Ep: 70, Reward: 302.6235, Test: 198.5039 [137.47], Avg: 102.4904 (0.803)
Ep: 71, Reward: 257.0092, Test: 273.0976 [208.63], Avg: 101.9622 (0.801)
Ep: 72, Reward: 314.4058, Test: 191.2671 [137.21], Avg: 101.3060 (0.798)
Ep: 73, Reward: 302.9931, Test: 115.0850 [107.59], Avg: 100.0383 (0.796)
Ep: 74, Reward: 304.1541, Test: 186.6466 [119.08], Avg: 99.6054 (0.793)
Ep: 75, Reward: 194.6028, Test: 270.0085 [103.00], Avg: 100.4923 (0.791)
Ep: 76, Reward: 230.0989, Test: 195.6020 [89.50], Avg: 100.5652 (0.789)
Ep: 77, Reward: 257.6176, Test: 151.7548 [164.66], Avg: 99.1104 (0.786)
Ep: 78, Reward: 214.2810, Test: 171.9112 [157.24], Avg: 98.0415 (0.784)
Ep: 79, Reward: 178.3868, Test: 208.7593 [107.55], Avg: 98.0811 (0.782)
Ep: 80, Reward: 200.9326, Test: 324.8495 [124.06], Avg: 99.3492 (0.779)
Ep: 81, Reward: 234.7899, Test: 271.0148 [137.41], Avg: 99.7669 (0.777)
Ep: 82, Reward: 213.1245, Test: 303.1233 [184.53], Avg: 99.9937 (0.775)
Ep: 83, Reward: 234.9005, Test: 274.9628 [169.04], Avg: 100.0643 (0.772)
Ep: 84, Reward: 269.1506, Test: 173.5802 [153.54], Avg: 99.1228 (0.770)
Ep: 85, Reward: 290.1388, Test: 210.2525 [107.62], Avg: 99.1637 (0.768)
Ep: 86, Reward: 331.0634, Test: 172.4879 [108.31], Avg: 98.7615 (0.765)
Ep: 87, Reward: 313.4641, Test: 350.7011 [152.17], Avg: 99.8953 (0.763)
Ep: 88, Reward: 366.3269, Test: 235.3617 [143.76], Avg: 99.8020 (0.761)
Ep: 89, Reward: 456.4865, Test: 336.0378 [89.05], Avg: 101.4375 (0.758)
Ep: 90, Reward: 363.1911, Test: 477.1123 [213.40], Avg: 103.2207 (0.756)
Ep: 91, Reward: 395.2669, Test: 355.0487 [194.23], Avg: 103.8467 (0.754)
Ep: 92, Reward: 423.0973, Test: 398.7944 [201.51], Avg: 104.8514 (0.752)
Ep: 93, Reward: 291.9294, Test: 247.0515 [165.58], Avg: 104.6027 (0.749)
Ep: 94, Reward: 306.1987, Test: 289.0516 [170.17], Avg: 104.7530 (0.747)
Ep: 95, Reward: 438.3466, Test: 390.2557 [134.39], Avg: 106.3270 (0.745)
Ep: 96, Reward: 343.6003, Test: 361.6075 [234.29], Avg: 106.5435 (0.743)
Ep: 97, Reward: 402.3838, Test: 328.6117 [160.36], Avg: 107.1732 (0.740)
Ep: 98, Reward: 472.6146, Test: 525.7241 [193.09], Avg: 109.4505 (0.738)
Ep: 99, Reward: 632.3026, Test: 448.0779 [234.72], Avg: 110.4896 (0.736)
Ep: 100, Reward: 545.8202, Test: 532.0533 [189.52], Avg: 112.7870 (0.734)
Ep: 101, Reward: 410.2301, Test: 461.4632 [185.37], Avg: 114.3881 (0.732)
Ep: 102, Reward: 374.0036, Test: 524.5081 [185.07], Avg: 116.5731 (0.729)
Ep: 103, Reward: 526.9261, Test: 398.7069 [210.68], Avg: 117.2601 (0.727)
Ep: 104, Reward: 514.2860, Test: 556.1752 [256.73], Avg: 118.9952 (0.725)
Ep: 105, Reward: 430.6829, Test: 407.5993 [240.49], Avg: 119.4492 (0.723)
Ep: 106, Reward: 523.6497, Test: 419.7858 [211.51], Avg: 120.2793 (0.721)
Ep: 107, Reward: 637.8940, Test: 625.5861 [171.97], Avg: 123.3657 (0.719)
Ep: 108, Reward: 501.0544, Test: 457.2018 [130.75], Avg: 125.2289 (0.716)
Ep: 109, Reward: 555.6908, Test: 566.7204 [213.35], Avg: 127.3029 (0.714)
Ep: 110, Reward: 655.1993, Test: 647.4914 [225.92], Avg: 129.9540 (0.712)
Ep: 111, Reward: 691.2148, Test: 679.9743 [150.16], Avg: 133.5241 (0.710)
Ep: 112, Reward: 763.0936, Test: 521.4764 [231.00], Avg: 134.9131 (0.708)
Ep: 113, Reward: 564.3103, Test: 524.9131 [221.34], Avg: 136.3926 (0.706)
Ep: 114, Reward: 605.6879, Test: 708.9792 [159.97], Avg: 139.9806 (0.704)
Ep: 115, Reward: 730.4724, Test: 554.7993 [213.43], Avg: 141.7166 (0.702)
Ep: 116, Reward: 568.6698, Test: 579.7229 [262.52], Avg: 143.2165 (0.699)
Ep: 117, Reward: 601.6086, Test: 595.9861 [152.07], Avg: 145.7648 (0.697)
Ep: 118, Reward: 651.5866, Test: 577.9935 [188.90], Avg: 147.8096 (0.695)
Ep: 119, Reward: 611.1048, Test: 381.5006 [180.65], Avg: 148.2516 (0.693)
Ep: 120, Reward: 511.7633, Test: 597.7596 [233.94], Avg: 150.0332 (0.691)
Ep: 121, Reward: 588.3623, Test: 599.5209 [156.03], Avg: 152.4385 (0.689)
Ep: 122, Reward: 642.1790, Test: 651.8544 [169.99], Avg: 155.1168 (0.687)
Ep: 123, Reward: 635.6232, Test: 586.6742 [200.80], Avg: 156.9777 (0.685)
Ep: 124, Reward: 694.2708, Test: 738.1266 [122.23], Avg: 160.6491 (0.683)
Ep: 125, Reward: 556.1204, Test: 524.1997 [241.96], Avg: 161.6141 (0.681)
Ep: 126, Reward: 504.2497, Test: 374.1338 [188.09], Avg: 161.8064 (0.679)
Ep: 127, Reward: 611.3689, Test: 539.6203 [193.33], Avg: 163.2478 (0.677)
Ep: 128, Reward: 594.4542, Test: 573.1824 [236.27], Avg: 164.5940 (0.675)
Ep: 129, Reward: 560.6036, Test: 424.7894 [256.44], Avg: 164.6229 (0.673)
Ep: 130, Reward: 546.6066, Test: 627.6729 [203.26], Avg: 166.6061 (0.671)
Ep: 131, Reward: 629.6262, Test: 471.9855 [229.23], Avg: 167.1830 (0.669)
Ep: 132, Reward: 523.4726, Test: 437.5210 [172.96], Avg: 167.9152 (0.667)
Ep: 133, Reward: 447.2910, Test: 395.3235 [236.92], Avg: 167.8442 (0.665)
Ep: 134, Reward: 463.0300, Test: 450.4476 [168.18], Avg: 168.6918 (0.663)
Ep: 135, Reward: 600.0622, Test: 553.4365 [212.17], Avg: 169.9607 (0.661)
Ep: 136, Reward: 556.2318, Test: 419.2679 [119.58], Avg: 170.9077 (0.659)
Ep: 137, Reward: 510.9502, Test: 550.3170 [249.39], Avg: 171.8498 (0.657)
Ep: 138, Reward: 598.4299, Test: 356.7963 [237.38], Avg: 171.4726 (0.655)
Ep: 139, Reward: 486.8105, Test: 279.5663 [183.45], Avg: 170.9344 (0.653)
Ep: 140, Reward: 438.6182, Test: 403.3594 [187.49], Avg: 171.2531 (0.651)
Ep: 141, Reward: 420.5999, Test: 337.6537 [132.70], Avg: 171.4904 (0.649)
Ep: 142, Reward: 521.9243, Test: 345.9260 [200.83], Avg: 171.3058 (0.647)
Ep: 143, Reward: 393.6672, Test: 288.3868 [168.57], Avg: 170.9483 (0.645)
Ep: 144, Reward: 426.4426, Test: 317.9944 [146.97], Avg: 170.9488 (0.643)
Ep: 145, Reward: 422.1151, Test: 469.0711 [149.58], Avg: 171.9662 (0.641)
Ep: 146, Reward: 439.1934, Test: 493.7951 [214.16], Avg: 172.6986 (0.639)
Ep: 147, Reward: 394.5961, Test: 562.7822 [189.78], Avg: 174.0520 (0.637)
Ep: 148, Reward: 468.3562, Test: 364.6861 [267.17], Avg: 173.5384 (0.635)
Ep: 149, Reward: 523.1154, Test: 499.8084 [197.51], Avg: 174.3968 (0.633)
Ep: 150, Reward: 500.6020, Test: 593.2070 [203.50], Avg: 175.8227 (0.631)
Ep: 151, Reward: 499.5292, Test: 531.3786 [211.18], Avg: 176.7725 (0.630)
Ep: 152, Reward: 480.7340, Test: 484.3919 [246.61], Avg: 177.1713 (0.628)
Ep: 153, Reward: 510.7610, Test: 531.8873 [208.78], Avg: 178.1189 (0.626)
Ep: 154, Reward: 623.8813, Test: 481.6632 [259.68], Avg: 178.4019 (0.624)
Ep: 155, Reward: 569.5365, Test: 321.3877 [214.04], Avg: 177.9464 (0.622)
Ep: 156, Reward: 531.6223, Test: 521.0002 [179.70], Avg: 178.9869 (0.620)
Ep: 157, Reward: 524.6696, Test: 667.6661 [228.09], Avg: 180.6362 (0.618)
Ep: 158, Reward: 515.6754, Test: 445.0808 [239.37], Avg: 180.7938 (0.616)
Ep: 159, Reward: 577.9816, Test: 538.6358 [240.90], Avg: 181.5247 (0.615)
Ep: 160, Reward: 501.3957, Test: 482.8826 [270.55], Avg: 181.7161 (0.613)
Ep: 161, Reward: 549.8602, Test: 623.0409 [254.59], Avg: 182.8688 (0.611)
Ep: 162, Reward: 507.5599, Test: 415.4899 [235.98], Avg: 182.8482 (0.609)
Ep: 163, Reward: 489.2382, Test: 539.9454 [239.23], Avg: 183.5669 (0.607)
Ep: 164, Reward: 462.1924, Test: 532.7000 [207.23], Avg: 184.4269 (0.605)
Ep: 165, Reward: 553.1401, Test: 373.9317 [180.51], Avg: 184.4811 (0.604)
Ep: 166, Reward: 476.7327, Test: 426.1101 [165.67], Avg: 184.9360 (0.602)
Ep: 167, Reward: 442.2156, Test: 562.6992 [251.02], Avg: 185.6904 (0.600)
Ep: 168, Reward: 479.9088, Test: 355.5270 [199.67], Avg: 185.5139 (0.598)
Ep: 169, Reward: 453.7937, Test: 482.6537 [217.46], Avg: 185.9826 (0.596)
Ep: 170, Reward: 330.2319, Test: 516.9767 [228.37], Avg: 186.5827 (0.595)
Ep: 171, Reward: 480.8080, Test: 421.8730 [164.98], Avg: 186.9915 (0.593)
Ep: 172, Reward: 424.8857, Test: 348.5928 [201.08], Avg: 186.7633 (0.591)
Ep: 173, Reward: 442.5162, Test: 421.1397 [199.20], Avg: 186.9654 (0.589)
Ep: 174, Reward: 468.9188, Test: 573.3918 [213.98], Avg: 187.9508 (0.588)
Ep: 175, Reward: 443.6567, Test: 452.5577 [241.73], Avg: 188.0808 (0.586)
Ep: 176, Reward: 499.4578, Test: 367.9836 [184.51], Avg: 188.0548 (0.584)
Ep: 177, Reward: 482.7224, Test: 314.6723 [199.12], Avg: 187.6475 (0.582)
Ep: 178, Reward: 518.5008, Test: 367.5099 [260.19], Avg: 187.1988 (0.581)
Ep: 179, Reward: 516.5814, Test: 488.7899 [191.81], Avg: 187.8087 (0.579)
Ep: 180, Reward: 478.8865, Test: 497.0737 [262.60], Avg: 188.0665 (0.577)
Ep: 181, Reward: 447.4753, Test: 570.9376 [171.50], Avg: 189.2279 (0.575)
Ep: 182, Reward: 568.3055, Test: 614.4749 [195.35], Avg: 190.4841 (0.574)
Ep: 183, Reward: 486.9974, Test: 383.2939 [268.70], Avg: 190.0717 (0.572)
Ep: 184, Reward: 385.0355, Test: 503.8602 [256.82], Avg: 190.3796 (0.570)
Ep: 185, Reward: 537.6434, Test: 465.8710 [217.32], Avg: 190.6924 (0.568)
Ep: 186, Reward: 474.9556, Test: 504.0624 [235.66], Avg: 191.1080 (0.567)
Ep: 187, Reward: 357.4004, Test: 506.5488 [180.57], Avg: 191.8253 (0.565)
Ep: 188, Reward: 446.0632, Test: 520.7588 [201.84], Avg: 192.4978 (0.563)
Ep: 189, Reward: 477.1751, Test: 491.7015 [235.02], Avg: 192.8356 (0.562)
Ep: 190, Reward: 559.8074, Test: 460.3845 [229.60], Avg: 193.0343 (0.560)
Ep: 191, Reward: 463.1147, Test: 603.5318 [262.08], Avg: 193.8073 (0.558)
Ep: 192, Reward: 429.5915, Test: 458.6168 [169.85], Avg: 194.2993 (0.557)
Ep: 193, Reward: 453.9301, Test: 466.0943 [286.45], Avg: 194.2238 (0.555)
Ep: 194, Reward: 650.8678, Test: 492.7943 [247.73], Avg: 194.4845 (0.553)
Ep: 195, Reward: 538.4057, Test: 599.7299 [178.12], Avg: 195.6433 (0.552)
Ep: 196, Reward: 687.0801, Test: 498.5523 [259.59], Avg: 195.8632 (0.550)
Ep: 197, Reward: 522.0266, Test: 595.7455 [266.07], Avg: 196.5390 (0.548)
Ep: 198, Reward: 532.8314, Test: 734.2287 [163.64], Avg: 198.4186 (0.547)
Ep: 199, Reward: 597.5143, Test: 614.4308 [277.01], Avg: 199.1136 (0.545)
Ep: 200, Reward: 581.8237, Test: 607.3354 [214.72], Avg: 200.0763 (0.543)
Ep: 201, Reward: 689.3586, Test: 574.3875 [228.67], Avg: 200.7973 (0.542)
Ep: 202, Reward: 687.5183, Test: 513.7227 [279.60], Avg: 200.9615 (0.540)
Ep: 203, Reward: 616.4361, Test: 506.1397 [294.85], Avg: 201.0121 (0.539)
Ep: 204, Reward: 653.1117, Test: 519.8093 [294.76], Avg: 201.1294 (0.537)
Ep: 205, Reward: 576.9609, Test: 721.3821 [196.25], Avg: 202.7022 (0.535)
Ep: 206, Reward: 585.9415, Test: 532.5977 [232.77], Avg: 203.1714 (0.534)
Ep: 207, Reward: 589.6869, Test: 456.0698 [259.48], Avg: 203.1398 (0.532)
Ep: 208, Reward: 651.4407, Test: 622.4177 [264.44], Avg: 203.8806 (0.530)
Ep: 209, Reward: 607.7845, Test: 546.1613 [226.25], Avg: 204.4331 (0.529)
Ep: 210, Reward: 552.6030, Test: 577.1790 [221.02], Avg: 205.1522 (0.527)
Ep: 211, Reward: 444.5457, Test: 484.1008 [202.04], Avg: 205.5150 (0.526)
Ep: 212, Reward: 503.4118, Test: 430.1374 [225.56], Avg: 205.5106 (0.524)
Ep: 213, Reward: 540.2108, Test: 573.0193 [218.32], Avg: 206.2077 (0.523)
Ep: 214, Reward: 552.6298, Test: 643.6009 [146.39], Avg: 207.5612 (0.521)
Ep: 215, Reward: 558.0411, Test: 629.4778 [216.85], Avg: 208.5106 (0.519)
Ep: 216, Reward: 514.7446, Test: 409.1697 [179.09], Avg: 208.6100 (0.518)
Ep: 217, Reward: 504.1682, Test: 420.0077 [267.88], Avg: 208.3509 (0.516)
Ep: 218, Reward: 538.2977, Test: 486.5917 [196.13], Avg: 208.7259 (0.515)
Ep: 219, Reward: 473.3973, Test: 509.4863 [253.68], Avg: 208.9399 (0.513)
Ep: 220, Reward: 555.1944, Test: 537.3019 [242.74], Avg: 209.3273 (0.512)
Ep: 221, Reward: 514.9878, Test: 566.6253 [226.12], Avg: 209.9182 (0.510)
Ep: 222, Reward: 454.9215, Test: 544.2416 [253.24], Avg: 210.2818 (0.509)
Ep: 223, Reward: 544.5223, Test: 480.4834 [208.68], Avg: 210.5564 (0.507)
Ep: 224, Reward: 440.6814, Test: 481.8070 [219.76], Avg: 210.7853 (0.506)
Ep: 225, Reward: 526.2541, Test: 345.2160 [149.17], Avg: 210.7200 (0.504)
Ep: 226, Reward: 616.4022, Test: 492.1499 [293.22], Avg: 210.6681 (0.503)
Ep: 227, Reward: 559.8734, Test: 355.6128 [190.10], Avg: 210.4701 (0.501)
Ep: 228, Reward: 441.7321, Test: 650.3227 [190.05], Avg: 211.5609 (0.500)
Ep: 229, Reward: 636.6523, Test: 410.5073 [229.72], Avg: 211.4271 (0.498)
Ep: 230, Reward: 369.7930, Test: 571.7941 [191.93], Avg: 212.1563 (0.497)
Ep: 231, Reward: 509.3997, Test: 474.1640 [262.38], Avg: 212.1547 (0.495)
Ep: 232, Reward: 451.6541, Test: 603.2972 [228.23], Avg: 212.8538 (0.494)
Ep: 233, Reward: 454.9857, Test: 626.3046 [235.00], Avg: 213.6165 (0.492)
Ep: 234, Reward: 391.3519, Test: 533.7277 [236.15], Avg: 213.9738 (0.491)
Ep: 235, Reward: 500.3053, Test: 638.9570 [179.99], Avg: 215.0119 (0.489)
Ep: 236, Reward: 548.6945, Test: 379.5192 [224.85], Avg: 214.7572 (0.488)
Ep: 237, Reward: 521.1590, Test: 538.9338 [293.04], Avg: 214.8881 (0.486)
Ep: 238, Reward: 475.0942, Test: 305.9432 [136.82], Avg: 214.6966 (0.485)
Ep: 239, Reward: 460.0834, Test: 552.4419 [253.55], Avg: 215.0474 (0.483)
Ep: 240, Reward: 461.1174, Test: 379.7652 [287.51], Avg: 214.5379 (0.482)
Ep: 241, Reward: 344.4678, Test: 336.0670 [175.33], Avg: 214.3156 (0.480)
Ep: 242, Reward: 340.3347, Test: 405.1454 [251.58], Avg: 214.0656 (0.479)
Ep: 243, Reward: 456.8406, Test: 463.5715 [253.67], Avg: 214.0485 (0.478)
Ep: 244, Reward: 415.6472, Test: 632.3409 [247.28], Avg: 214.7465 (0.476)
Ep: 245, Reward: 390.2732, Test: 388.2579 [240.99], Avg: 214.4722 (0.475)
Ep: 246, Reward: 545.3856, Test: 399.8597 [233.59], Avg: 214.2770 (0.473)
Ep: 247, Reward: 478.0960, Test: 373.7642 [229.18], Avg: 213.9960 (0.472)
Ep: 248, Reward: 430.0913, Test: 491.2469 [249.90], Avg: 214.1059 (0.470)
Ep: 249, Reward: 627.2907, Test: 507.8311 [205.25], Avg: 214.4598 (0.469)
Ep: 250, Reward: 606.2639, Test: 476.7803 [249.91], Avg: 214.5092 (0.468)
Ep: 251, Reward: 472.8693, Test: 596.2732 [181.90], Avg: 215.3023 (0.466)
Ep: 252, Reward: 452.3022, Test: 352.5449 [252.06], Avg: 214.8485 (0.465)
Ep: 253, Reward: 455.3707, Test: 508.5546 [206.17], Avg: 215.1931 (0.463)
Ep: 254, Reward: 577.2595, Test: 603.7745 [266.07], Avg: 215.6735 (0.462)
Ep: 255, Reward: 462.7629, Test: 453.9062 [241.85], Avg: 215.6594 (0.461)
Ep: 256, Reward: 489.4397, Test: 521.6294 [336.22], Avg: 215.5417 (0.459)
Ep: 257, Reward: 630.3004, Test: 650.0911 [185.96], Avg: 216.5052 (0.458)
Ep: 258, Reward: 616.5064, Test: 570.0458 [274.00], Avg: 216.8123 (0.456)
Ep: 259, Reward: 527.6470, Test: 471.8733 [221.05], Avg: 216.9432 (0.455)
Ep: 260, Reward: 559.7088, Test: 409.8931 [271.54], Avg: 216.6420 (0.454)
Ep: 261, Reward: 593.1385, Test: 538.6452 [285.31], Avg: 216.7821 (0.452)
Ep: 262, Reward: 564.4400, Test: 659.1938 [250.45], Avg: 217.5120 (0.451)
Ep: 263, Reward: 442.3584, Test: 530.6594 [293.08], Avg: 217.5880 (0.450)
Ep: 264, Reward: 506.8648, Test: 309.5795 [269.82], Avg: 216.9169 (0.448)
Ep: 265, Reward: 564.6708, Test: 476.9527 [256.76], Avg: 216.9292 (0.447)
Ep: 266, Reward: 352.0250, Test: 299.6857 [146.09], Avg: 216.6920 (0.446)
Ep: 267, Reward: 615.8079, Test: 509.0422 [217.77], Avg: 216.9703 (0.444)
Ep: 268, Reward: 570.5670, Test: 558.2464 [308.71], Avg: 217.0913 (0.443)
Ep: 269, Reward: 560.0994, Test: 524.0711 [206.50], Avg: 217.4635 (0.442)
Ep: 270, Reward: 414.7493, Test: 486.5249 [162.26], Avg: 217.8576 (0.440)
Ep: 271, Reward: 557.6363, Test: 478.5185 [224.85], Avg: 217.9892 (0.439)
Ep: 272, Reward: 508.8517, Test: 482.2871 [209.89], Avg: 218.1885 (0.438)
Ep: 273, Reward: 511.8426, Test: 419.9259 [268.43], Avg: 217.9451 (0.436)
Ep: 274, Reward: 478.5215, Test: 436.1741 [278.56], Avg: 217.7257 (0.435)
Ep: 275, Reward: 461.6194, Test: 430.5501 [187.75], Avg: 217.8165 (0.434)
Ep: 276, Reward: 580.4529, Test: 411.6163 [187.56], Avg: 217.8390 (0.432)
Ep: 277, Reward: 561.5899, Test: 433.7180 [239.79], Avg: 217.7530 (0.431)
Ep: 278, Reward: 417.3567, Test: 409.7623 [258.71], Avg: 217.5139 (0.430)
Ep: 279, Reward: 459.5697, Test: 572.1916 [242.86], Avg: 217.9133 (0.429)
Ep: 280, Reward: 532.5275, Test: 507.1707 [259.47], Avg: 218.0193 (0.427)
Ep: 281, Reward: 450.6346, Test: 419.2779 [188.39], Avg: 218.0649 (0.426)
Ep: 282, Reward: 558.7887, Test: 516.9065 [246.03], Avg: 218.2515 (0.425)
Ep: 283, Reward: 483.8333, Test: 613.3542 [260.90], Avg: 218.7241 (0.423)
Ep: 284, Reward: 505.6955, Test: 538.6145 [302.72], Avg: 218.7843 (0.422)
Ep: 285, Reward: 561.7401, Test: 446.7870 [275.20], Avg: 218.6193 (0.421)
Ep: 286, Reward: 576.9218, Test: 640.4401 [180.19], Avg: 219.4612 (0.420)
Ep: 287, Reward: 597.6935, Test: 536.6730 [236.82], Avg: 219.7403 (0.418)
Ep: 288, Reward: 619.9637, Test: 442.8038 [154.25], Avg: 219.9785 (0.417)
Ep: 289, Reward: 619.1793, Test: 547.0200 [218.72], Avg: 220.3520 (0.416)
Ep: 290, Reward: 571.4140, Test: 622.7769 [217.23], Avg: 220.9884 (0.415)
Ep: 291, Reward: 441.2720, Test: 407.8097 [307.12], Avg: 220.5764 (0.413)
Ep: 292, Reward: 469.2247, Test: 350.2178 [207.60], Avg: 220.3103 (0.412)
Ep: 293, Reward: 474.0541, Test: 555.7965 [329.31], Avg: 220.3313 (0.411)
Ep: 294, Reward: 651.2975, Test: 661.1144 [219.13], Avg: 221.0827 (0.410)
Ep: 295, Reward: 562.0147, Test: 552.5611 [257.40], Avg: 221.3330 (0.408)
Ep: 296, Reward: 475.7989, Test: 568.9165 [270.00], Avg: 221.5942 (0.407)
Ep: 297, Reward: 598.7199, Test: 694.5876 [301.53], Avg: 222.1696 (0.406)
Ep: 298, Reward: 524.4502, Test: 513.4644 [246.09], Avg: 222.3208 (0.405)
Ep: 299, Reward: 492.1275, Test: 758.5905 [208.17], Avg: 223.4145 (0.404)
Ep: 300, Reward: 759.1124, Test: 552.4874 [300.35], Avg: 223.5099 (0.402)
Ep: 301, Reward: 581.8374, Test: 523.0380 [275.95], Avg: 223.5880 (0.401)
Ep: 302, Reward: 612.3031, Test: 511.9484 [230.42], Avg: 223.7792 (0.400)
Ep: 303, Reward: 620.3738, Test: 544.3409 [258.75], Avg: 223.9825 (0.399)
Ep: 304, Reward: 674.7866, Test: 608.3658 [237.20], Avg: 224.4651 (0.398)
Ep: 305, Reward: 558.4413, Test: 570.7090 [308.79], Avg: 224.5875 (0.396)
Ep: 306, Reward: 618.5068, Test: 689.1513 [311.51], Avg: 225.0860 (0.395)
Ep: 307, Reward: 691.4700, Test: 582.4789 [326.65], Avg: 225.1858 (0.394)
Ep: 308, Reward: 587.2918, Test: 700.5977 [274.78], Avg: 225.8351 (0.393)
Ep: 309, Reward: 636.1245, Test: 576.4941 [314.57], Avg: 225.9516 (0.392)
Ep: 310, Reward: 635.7915, Test: 720.2018 [249.27], Avg: 226.7393 (0.390)
Ep: 311, Reward: 632.9973, Test: 730.8863 [159.92], Avg: 227.8426 (0.389)
Ep: 312, Reward: 492.8081, Test: 652.8121 [213.38], Avg: 228.5185 (0.388)
Ep: 313, Reward: 784.5308, Test: 588.5976 [287.13], Avg: 228.7509 (0.387)
Ep: 314, Reward: 674.2197, Test: 587.7403 [284.12], Avg: 228.9886 (0.386)
Ep: 315, Reward: 568.1658, Test: 639.9857 [294.28], Avg: 229.3579 (0.385)
Ep: 316, Reward: 689.7261, Test: 681.0594 [292.34], Avg: 229.8606 (0.383)
Ep: 317, Reward: 625.7221, Test: 646.7226 [307.87], Avg: 230.2034 (0.382)
Ep: 318, Reward: 705.7370, Test: 798.4026 [145.59], Avg: 231.5282 (0.381)
Ep: 319, Reward: 767.2110, Test: 651.9840 [269.77], Avg: 231.9991 (0.380)
Ep: 320, Reward: 715.4479, Test: 578.6158 [328.33], Avg: 232.0560 (0.379)
Ep: 321, Reward: 814.1179, Test: 737.8483 [272.48], Avg: 232.7806 (0.378)
Ep: 322, Reward: 828.4639, Test: 687.4547 [226.54], Avg: 233.4869 (0.377)
Ep: 323, Reward: 734.7567, Test: 788.1391 [169.14], Avg: 234.6768 (0.376)
Ep: 324, Reward: 891.7063, Test: 651.3500 [223.98], Avg: 235.2697 (0.374)
Ep: 325, Reward: 798.5456, Test: 746.3142 [259.52], Avg: 236.0412 (0.373)
Ep: 326, Reward: 770.9892, Test: 654.9656 [250.51], Avg: 236.5562 (0.372)
Ep: 327, Reward: 719.3477, Test: 820.4956 [189.36], Avg: 237.7592 (0.371)
Ep: 328, Reward: 726.7217, Test: 813.8171 [163.46], Avg: 239.0133 (0.370)
Ep: 329, Reward: 521.2164, Test: 595.0438 [265.76], Avg: 239.2869 (0.369)
Ep: 330, Reward: 618.5433, Test: 501.0981 [309.30], Avg: 239.1434 (0.368)
Ep: 331, Reward: 715.7911, Test: 613.5405 [263.98], Avg: 239.4760 (0.367)
Ep: 332, Reward: 693.4112, Test: 573.1807 [264.63], Avg: 239.6834 (0.365)
Ep: 333, Reward: 441.0033, Test: 684.4373 [252.04], Avg: 240.2604 (0.364)
Ep: 334, Reward: 532.8090, Test: 692.2933 [252.66], Avg: 240.8556 (0.363)
Ep: 335, Reward: 720.3997, Test: 602.0370 [217.80], Avg: 241.2823 (0.362)
Ep: 336, Reward: 674.5385, Test: 687.2312 [238.08], Avg: 241.8991 (0.361)
Ep: 337, Reward: 655.1509, Test: 675.4789 [252.81], Avg: 242.4339 (0.360)
Ep: 338, Reward: 914.1351, Test: 742.6868 [256.50], Avg: 243.1530 (0.359)
Ep: 339, Reward: 683.0804, Test: 502.7815 [245.81], Avg: 243.1936 (0.358)
Ep: 340, Reward: 624.3790, Test: 726.5280 [158.24], Avg: 244.1470 (0.357)
Ep: 341, Reward: 445.1551, Test: 633.3068 [231.83], Avg: 244.6070 (0.356)
Ep: 342, Reward: 458.2180, Test: 737.6283 [140.44], Avg: 245.6349 (0.355)
Ep: 343, Reward: 734.5444, Test: 522.9504 [299.03], Avg: 245.5718 (0.354)
Ep: 344, Reward: 543.3182, Test: 766.3802 [190.17], Avg: 246.5302 (0.353)
Ep: 345, Reward: 582.0171, Test: 587.5951 [291.45], Avg: 246.6736 (0.351)
Ep: 346, Reward: 616.9832, Test: 691.1621 [248.47], Avg: 247.2384 (0.350)
Ep: 347, Reward: 644.0157, Test: 711.9525 [265.03], Avg: 247.8122 (0.349)
Ep: 348, Reward: 697.7678, Test: 638.9731 [266.02], Avg: 248.1708 (0.348)
Ep: 349, Reward: 607.2285, Test: 607.6839 [235.56], Avg: 248.5250 (0.347)
Ep: 350, Reward: 537.9794, Test: 683.3240 [233.08], Avg: 249.0997 (0.346)
Ep: 351, Reward: 650.5407, Test: 750.9269 [218.89], Avg: 249.9035 (0.345)
Ep: 352, Reward: 621.9981, Test: 611.2383 [185.44], Avg: 250.4017 (0.344)
Ep: 353, Reward: 716.7314, Test: 568.2054 [284.37], Avg: 250.4962 (0.343)
Ep: 354, Reward: 561.1278, Test: 593.9797 [264.53], Avg: 250.7186 (0.342)
Ep: 355, Reward: 587.6978, Test: 600.0353 [304.42], Avg: 250.8447 (0.341)
Ep: 356, Reward: 676.0289, Test: 526.7177 [250.46], Avg: 250.9159 (0.340)
Ep: 357, Reward: 596.8793, Test: 372.0002 [201.11], Avg: 250.6923 (0.339)
Ep: 358, Reward: 737.4177, Test: 474.8277 [277.93], Avg: 250.5425 (0.338)
Ep: 359, Reward: 601.2059, Test: 587.0639 [236.99], Avg: 250.8190 (0.337)
Ep: 360, Reward: 552.5198, Test: 595.4495 [302.06], Avg: 250.9369 (0.336)
Ep: 361, Reward: 588.8410, Test: 461.1902 [183.64], Avg: 251.0104 (0.335)
Ep: 362, Reward: 652.2702, Test: 693.5472 [192.84], Avg: 251.6983 (0.334)
Ep: 363, Reward: 687.3007, Test: 619.1001 [283.59], Avg: 251.9285 (0.333)
Ep: 364, Reward: 686.6605, Test: 680.9805 [198.09], Avg: 252.5613 (0.332)
Ep: 365, Reward: 669.2413, Test: 626.6685 [246.16], Avg: 252.9109 (0.331)
Ep: 366, Reward: 628.7604, Test: 537.3603 [239.90], Avg: 253.0323 (0.330)
Ep: 367, Reward: 635.7204, Test: 510.3713 [209.23], Avg: 253.1630 (0.329)
Ep: 368, Reward: 556.1589, Test: 730.3099 [224.03], Avg: 253.8490 (0.328)
Ep: 369, Reward: 610.9809, Test: 700.0861 [187.04], Avg: 254.5495 (0.327)
Ep: 370, Reward: 688.8305, Test: 668.7384 [197.42], Avg: 255.1338 (0.326)
Ep: 371, Reward: 590.8053, Test: 654.0149 [224.56], Avg: 255.6024 (0.325)
Ep: 372, Reward: 639.9244, Test: 513.3563 [179.71], Avg: 255.8116 (0.324)
Ep: 373, Reward: 612.7975, Test: 555.7588 [250.48], Avg: 255.9439 (0.323)
Ep: 374, Reward: 555.1960, Test: 618.7928 [232.10], Avg: 256.2925 (0.322)
Ep: 375, Reward: 806.8792, Test: 792.6267 [156.41], Avg: 257.3030 (0.321)
Ep: 376, Reward: 665.5302, Test: 735.3433 [196.66], Avg: 258.0494 (0.320)
Ep: 377, Reward: 785.2089, Test: 604.6961 [275.24], Avg: 258.2383 (0.319)
Ep: 378, Reward: 674.6886, Test: 533.0936 [235.02], Avg: 258.3434 (0.318)
Ep: 379, Reward: 664.7488, Test: 466.8330 [249.56], Avg: 258.2353 (0.317)
Ep: 380, Reward: 719.8717, Test: 664.6281 [183.18], Avg: 258.8212 (0.316)
Ep: 381, Reward: 686.7874, Test: 525.7222 [222.82], Avg: 258.9366 (0.315)
Ep: 382, Reward: 735.4038, Test: 695.0812 [263.17], Avg: 259.3882 (0.315)
Ep: 383, Reward: 701.2547, Test: 688.8242 [266.75], Avg: 259.8119 (0.314)
Ep: 384, Reward: 800.0351, Test: 651.9366 [265.98], Avg: 260.1395 (0.313)
Ep: 385, Reward: 662.2467, Test: 764.2684 [216.91], Avg: 260.8836 (0.312)
Ep: 386, Reward: 712.3827, Test: 840.1645 [131.91], Avg: 262.0396 (0.311)
Ep: 387, Reward: 686.9659, Test: 729.8599 [231.99], Avg: 262.6474 (0.310)
Ep: 388, Reward: 718.2378, Test: 739.6286 [188.64], Avg: 263.3886 (0.309)
Ep: 389, Reward: 717.3216, Test: 756.2606 [223.05], Avg: 264.0805 (0.308)
Ep: 390, Reward: 838.2013, Test: 645.9720 [257.92], Avg: 264.3975 (0.307)
Ep: 391, Reward: 811.0936, Test: 716.7617 [266.98], Avg: 264.8705 (0.306)
Ep: 392, Reward: 731.1545, Test: 766.7665 [159.85], Avg: 265.7408 (0.305)
Ep: 393, Reward: 804.1454, Test: 610.4708 [287.30], Avg: 265.8866 (0.304)
Ep: 394, Reward: 669.0348, Test: 710.2716 [209.21], Avg: 266.4820 (0.303)
Ep: 395, Reward: 753.0919, Test: 663.0948 [268.68], Avg: 266.8050 (0.302)
Ep: 396, Reward: 722.7474, Test: 750.3708 [200.46], Avg: 267.5181 (0.302)
Ep: 397, Reward: 797.4530, Test: 656.0844 [232.67], Avg: 267.9098 (0.301)
Ep: 398, Reward: 797.0260, Test: 690.7200 [223.13], Avg: 268.4103 (0.300)
Ep: 399, Reward: 645.1972, Test: 793.1873 [147.25], Avg: 269.3541 (0.299)
Ep: 400, Reward: 823.6525, Test: 726.9076 [165.87], Avg: 270.0815 (0.298)
Ep: 401, Reward: 774.0072, Test: 722.5006 [255.64], Avg: 270.5710 (0.297)
Ep: 402, Reward: 727.1181, Test: 681.3375 [268.41], Avg: 270.9242 (0.296)
Ep: 403, Reward: 754.1417, Test: 706.3401 [178.94], Avg: 271.5590 (0.295)
Ep: 404, Reward: 738.4169, Test: 662.0499 [255.14], Avg: 271.8932 (0.294)
Ep: 405, Reward: 703.6742, Test: 765.9696 [198.01], Avg: 272.6225 (0.294)
Ep: 406, Reward: 676.2060, Test: 627.6659 [235.01], Avg: 272.9174 (0.293)
Ep: 407, Reward: 747.5482, Test: 490.3201 [234.86], Avg: 272.8746 (0.292)
Ep: 408, Reward: 794.3523, Test: 701.4992 [208.15], Avg: 273.4137 (0.291)
Ep: 409, Reward: 781.3543, Test: 634.6619 [188.19], Avg: 273.8357 (0.290)
Ep: 410, Reward: 728.5334, Test: 819.9049 [110.19], Avg: 274.8963 (0.289)
Ep: 411, Reward: 620.6189, Test: 700.8140 [285.48], Avg: 275.2371 (0.288)
Ep: 412, Reward: 704.5914, Test: 674.8255 [249.07], Avg: 275.6016 (0.287)
Ep: 413, Reward: 836.5403, Test: 714.4335 [268.35], Avg: 276.0134 (0.287)
Ep: 414, Reward: 705.2059, Test: 752.7692 [254.21], Avg: 276.5496 (0.286)
Ep: 415, Reward: 628.5074, Test: 627.4218 [240.46], Avg: 276.8150 (0.285)
Ep: 416, Reward: 789.6216, Test: 590.9843 [247.33], Avg: 276.9753 (0.284)
Ep: 417, Reward: 775.7807, Test: 639.4345 [279.26], Avg: 277.1743 (0.283)
Ep: 418, Reward: 830.5002, Test: 653.7732 [287.28], Avg: 277.3875 (0.282)
Ep: 419, Reward: 885.9266, Test: 715.8540 [215.82], Avg: 277.9176 (0.281)
Ep: 420, Reward: 528.0705, Test: 637.2113 [315.22], Avg: 278.0223 (0.281)
Ep: 421, Reward: 711.1373, Test: 695.0179 [277.74], Avg: 278.3523 (0.280)
Ep: 422, Reward: 793.1694, Test: 556.8077 [301.28], Avg: 278.2983 (0.279)
Ep: 423, Reward: 750.2598, Test: 810.3633 [113.39], Avg: 279.2858 (0.278)
Ep: 424, Reward: 772.1350, Test: 738.7917 [177.47], Avg: 279.9494 (0.277)
Ep: 425, Reward: 800.4288, Test: 492.7683 [297.89], Avg: 279.7497 (0.276)
Ep: 426, Reward: 688.1369, Test: 552.6507 [285.49], Avg: 279.7202 (0.276)
Ep: 427, Reward: 706.6871, Test: 740.6826 [185.33], Avg: 280.3642 (0.275)
Ep: 428, Reward: 661.8586, Test: 746.3935 [157.04], Avg: 281.0845 (0.274)
Ep: 429, Reward: 692.3043, Test: 629.7259 [252.26], Avg: 281.3086 (0.273)
Ep: 430, Reward: 653.9453, Test: 700.8361 [245.78], Avg: 281.7117 (0.272)
Ep: 431, Reward: 683.0334, Test: 618.5705 [222.39], Avg: 281.9767 (0.271)
Ep: 432, Reward: 747.6117, Test: 739.2088 [218.35], Avg: 282.5284 (0.271)
Ep: 433, Reward: 771.2929, Test: 715.9212 [251.64], Avg: 282.9472 (0.270)
Ep: 434, Reward: 869.0849, Test: 698.5256 [307.46], Avg: 283.1957 (0.269)
Ep: 435, Reward: 805.5849, Test: 676.9794 [240.79], Avg: 283.5466 (0.268)
Ep: 436, Reward: 637.1178, Test: 712.1222 [266.13], Avg: 283.9183 (0.267)
Ep: 437, Reward: 825.6930, Test: 705.7903 [208.31], Avg: 284.4059 (0.267)
Ep: 438, Reward: 701.2422, Test: 718.4434 [165.83], Avg: 285.0169 (0.266)
Ep: 439, Reward: 834.5070, Test: 768.1674 [179.30], Avg: 285.7074 (0.265)
Ep: 440, Reward: 777.6650, Test: 667.1702 [225.78], Avg: 286.0605 (0.264)
Ep: 441, Reward: 749.8283, Test: 696.8046 [229.80], Avg: 286.4698 (0.263)
Ep: 442, Reward: 790.4228, Test: 849.3596 [64.21], Avg: 287.5955 (0.263)
Ep: 443, Reward: 847.3900, Test: 871.6860 [61.15], Avg: 288.7733 (0.262)
Ep: 444, Reward: 716.8704, Test: 695.8602 [226.13], Avg: 289.1799 (0.261)
Ep: 445, Reward: 873.6255, Test: 579.6090 [344.00], Avg: 289.0598 (0.260)
Ep: 446, Reward: 750.9612, Test: 757.7151 [196.38], Avg: 289.6689 (0.259)
Ep: 447, Reward: 877.4650, Test: 647.8241 [303.89], Avg: 289.7901 (0.259)
Ep: 448, Reward: 737.3366, Test: 789.9067 [120.21], Avg: 290.6362 (0.258)
Ep: 449, Reward: 730.1370, Test: 756.7744 [177.15], Avg: 291.2784 (0.257)
Ep: 450, Reward: 777.6517, Test: 758.4949 [200.67], Avg: 291.8694 (0.256)
Ep: 451, Reward: 821.0698, Test: 691.2738 [219.35], Avg: 292.2678 (0.256)
Ep: 452, Reward: 707.9513, Test: 801.0878 [172.47], Avg: 293.0102 (0.255)
Ep: 453, Reward: 755.2707, Test: 842.8926 [141.85], Avg: 293.9090 (0.254)
Ep: 454, Reward: 802.9016, Test: 841.2877 [154.09], Avg: 294.7733 (0.253)
Ep: 455, Reward: 800.7215, Test: 744.7504 [210.21], Avg: 295.2991 (0.253)
Ep: 456, Reward: 831.7835, Test: 864.5003 [44.57], Avg: 296.4471 (0.252)
Ep: 457, Reward: 788.4131, Test: 681.7679 [260.42], Avg: 296.7198 (0.251)
Ep: 458, Reward: 888.0818, Test: 833.4543 [85.95], Avg: 297.7019 (0.250)
Ep: 459, Reward: 827.0768, Test: 687.3037 [313.46], Avg: 297.8675 (0.250)
Ep: 460, Reward: 872.2442, Test: 804.6399 [149.48], Avg: 298.6425 (0.249)
Ep: 461, Reward: 800.6890, Test: 723.2365 [246.68], Avg: 299.0276 (0.248)
Ep: 462, Reward: 923.2922, Test: 806.0882 [133.24], Avg: 299.8350 (0.247)
Ep: 463, Reward: 747.5267, Test: 787.2101 [251.38], Avg: 300.3436 (0.247)
Ep: 464, Reward: 814.2900, Test: 866.4652 [69.44], Avg: 301.4117 (0.246)
Ep: 465, Reward: 784.2192, Test: 773.6425 [251.42], Avg: 301.8856 (0.245)
Ep: 466, Reward: 829.9673, Test: 748.6243 [155.36], Avg: 302.5095 (0.244)
Ep: 467, Reward: 740.2143, Test: 664.7870 [246.89], Avg: 302.7561 (0.244)
Ep: 468, Reward: 819.2517, Test: 762.5909 [250.27], Avg: 303.2029 (0.243)
Ep: 469, Reward: 872.8193, Test: 803.2286 [121.75], Avg: 304.0078 (0.242)
Ep: 470, Reward: 819.2154, Test: 787.1453 [221.37], Avg: 304.5635 (0.241)
Ep: 471, Reward: 829.7548, Test: 769.2951 [209.72], Avg: 305.1038 (0.241)
Ep: 472, Reward: 842.1809, Test: 704.4190 [202.60], Avg: 305.5197 (0.240)
Ep: 473, Reward: 849.8478, Test: 754.0734 [232.47], Avg: 305.9756 (0.239)
Ep: 474, Reward: 815.3624, Test: 728.0427 [179.03], Avg: 306.4872 (0.239)
Ep: 475, Reward: 742.7653, Test: 849.1312 [53.08], Avg: 307.5157 (0.238)
Ep: 476, Reward: 842.8636, Test: 816.7854 [187.01], Avg: 308.1913 (0.237)
Ep: 477, Reward: 868.3625, Test: 746.8856 [195.45], Avg: 308.7002 (0.236)
Ep: 478, Reward: 868.9363, Test: 683.8336 [208.00], Avg: 309.0491 (0.236)
Ep: 479, Reward: 880.8623, Test: 742.2250 [236.56], Avg: 309.4587 (0.235)
Ep: 480, Reward: 767.3394, Test: 812.1120 [137.57], Avg: 310.2178 (0.234)
Ep: 481, Reward: 855.2074, Test: 824.6533 [157.83], Avg: 310.9576 (0.234)
Ep: 482, Reward: 731.2743, Test: 815.6489 [171.50], Avg: 311.6474 (0.233)
Ep: 483, Reward: 667.7930, Test: 836.8173 [76.79], Avg: 312.5738 (0.232)
Ep: 484, Reward: 860.0839, Test: 835.6232 [126.98], Avg: 313.3905 (0.231)
Ep: 485, Reward: 867.5552, Test: 821.1309 [104.67], Avg: 314.2198 (0.231)
Ep: 486, Reward: 858.3207, Test: 799.2625 [207.60], Avg: 314.7895 (0.230)
Ep: 487, Reward: 848.1329, Test: 823.5115 [154.01], Avg: 315.5164 (0.229)
Ep: 488, Reward: 775.6948, Test: 824.3922 [114.50], Avg: 316.3229 (0.229)
Ep: 489, Reward: 801.5184, Test: 869.8002 [48.87], Avg: 317.3527 (0.228)
Ep: 490, Reward: 875.3457, Test: 839.1298 [154.79], Avg: 318.1001 (0.227)
Ep: 491, Reward: 828.9533, Test: 844.4214 [89.07], Avg: 318.9889 (0.227)
Ep: 492, Reward: 831.3913, Test: 810.6911 [159.92], Avg: 319.6618 (0.226)
Ep: 493, Reward: 865.0664, Test: 811.9164 [214.86], Avg: 320.2234 (0.225)
Ep: 494, Reward: 853.7033, Test: 751.3875 [223.97], Avg: 320.6419 (0.225)
Ep: 495, Reward: 798.2139, Test: 768.5431 [160.11], Avg: 321.2222 (0.224)
Ep: 496, Reward: 892.2587, Test: 821.3009 [135.80], Avg: 321.9551 (0.223)
Ep: 497, Reward: 736.9949, Test: 762.6073 [148.27], Avg: 322.5422 (0.223)
Ep: 498, Reward: 792.9559, Test: 785.8286 [203.92], Avg: 323.0620 (0.222)
Ep: 499, Reward: 836.8855, Test: 789.3339 [152.36], Avg: 323.6898 (0.221)
