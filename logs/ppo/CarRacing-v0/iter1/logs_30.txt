Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 16					# Number of samples to train on for each train step
PPO_EPOCHS = 1					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.02				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(PPO_EPOCHS):
				for i in range(0, len(self.replay_buffer), BATCH_SIZE):
					state, action, log_prob, target, advantage = self.replay_buffer.index(BATCH_SIZE, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -34.2102, Test: -17.4107 [20.48], Avg: -37.8887 (0.997)
Ep: 1, Reward: -20.9151, Test: -127.3290 [5.29], Avg: -85.2560 (0.994)
Ep: 2, Reward: -50.8416, Test: -118.5883 [27.37], Avg: -105.4896 (0.991)
Ep: 3, Reward: -54.1894, Test: -96.5772 [36.45], Avg: -112.3729 (0.988)
Ep: 4, Reward: -39.8159, Test: -93.2351 [33.66], Avg: -115.2764 (0.985)
Ep: 5, Reward: -49.3277, Test: -52.8052 [11.89], Avg: -106.8467 (0.982)
Ep: 6, Reward: -50.5814, Test: 98.4945 [111.61], Avg: -93.4567 (0.979)
Ep: 7, Reward: 15.5002, Test: 561.5586 [213.00], Avg: -38.2050 (0.976)
Ep: 8, Reward: 184.6006, Test: 218.7865 [155.80], Avg: -26.9618 (0.973)
Ep: 9, Reward: 276.6589, Test: 211.0841 [156.44], Avg: -18.8016 (0.970)
Ep: 10, Reward: 365.1768, Test: 155.7615 [147.73], Avg: -16.3618 (0.967)
Ep: 11, Reward: 365.5904, Test: 95.4797 [95.55], Avg: -15.0046 (0.965)
Ep: 12, Reward: 408.2486, Test: 66.9640 [89.34], Avg: -15.5715 (0.962)
Ep: 13, Reward: 475.1245, Test: 249.5025 [33.36], Avg: 0.9792 (0.959)
Ep: 14, Reward: 355.8426, Test: 61.3129 [57.99], Avg: 1.1357 (0.956)
Ep: 15, Reward: 393.5154, Test: 65.7207 [81.52], Avg: 0.0774 (0.953)
Ep: 16, Reward: 557.3488, Test: 119.2223 [89.72], Avg: 1.8080 (0.950)
Ep: 17, Reward: 373.1008, Test: 137.9624 [107.15], Avg: 3.4193 (0.947)
Ep: 18, Reward: 317.6665, Test: 46.8306 [50.66], Avg: 3.0375 (0.945)
Ep: 19, Reward: 264.5698, Test: 35.0972 [72.78], Avg: 1.0016 (0.942)
Ep: 20, Reward: 482.6725, Test: 109.7069 [103.19], Avg: 1.2640 (0.939)
Ep: 21, Reward: 464.0719, Test: 23.3751 [66.38], Avg: -0.7483 (0.936)
Ep: 22, Reward: 369.6734, Test: 40.0201 [52.88], Avg: -1.2749 (0.933)
Ep: 23, Reward: 457.5441, Test: 69.4477 [70.93], Avg: -1.2833 (0.930)
Ep: 24, Reward: 510.8720, Test: 24.2786 [26.97], Avg: -1.3395 (0.928)
Ep: 25, Reward: 478.8868, Test: 100.2732 [85.58], Avg: -0.7227 (0.925)
Ep: 26, Reward: 487.1503, Test: 84.3958 [76.22], Avg: -0.3931 (0.922)
Ep: 27, Reward: 508.4058, Test: 84.2996 [90.08], Avg: -0.5854 (0.919)
Ep: 28, Reward: 597.4447, Test: 185.6211 [79.62], Avg: 3.0900 (0.917)
Ep: 29, Reward: 714.2967, Test: 163.6936 [110.57], Avg: 4.7577 (0.914)
Ep: 30, Reward: 577.7156, Test: 209.1149 [120.44], Avg: 7.4647 (0.911)
Ep: 31, Reward: 628.1823, Test: 206.8911 [97.96], Avg: 10.6356 (0.908)
Ep: 32, Reward: 570.9796, Test: 175.2096 [75.97], Avg: 13.3207 (0.906)
Ep: 33, Reward: 539.5416, Test: 141.8600 [94.63], Avg: 14.3179 (0.903)
Ep: 34, Reward: 408.1178, Test: 219.0125 [72.35], Avg: 18.0992 (0.900)
Ep: 35, Reward: 418.0577, Test: 193.9174 [64.12], Avg: 21.2019 (0.897)
Ep: 36, Reward: 562.4817, Test: 169.2122 [109.18], Avg: 22.2514 (0.895)
Ep: 37, Reward: 465.1978, Test: 293.3849 [64.03], Avg: 27.7016 (0.892)
Ep: 38, Reward: 504.6651, Test: 245.4648 [29.64], Avg: 32.5252 (0.889)
Ep: 39, Reward: 575.9205, Test: 274.8229 [76.50], Avg: 36.6702 (0.887)
Ep: 40, Reward: 556.1416, Test: 233.1015 [121.34], Avg: 38.5016 (0.884)
Ep: 41, Reward: 561.3596, Test: 226.8133 [112.13], Avg: 40.3154 (0.881)
Ep: 42, Reward: 570.2501, Test: 315.0309 [118.23], Avg: 43.9545 (0.879)
Ep: 43, Reward: 555.5200, Test: 279.5972 [75.28], Avg: 47.5990 (0.876)
Ep: 44, Reward: 545.4766, Test: 353.9777 [87.21], Avg: 52.4695 (0.874)
Ep: 45, Reward: 607.2332, Test: 308.4732 [159.39], Avg: 54.5697 (0.871)
Ep: 46, Reward: 489.0826, Test: 365.1813 [126.18], Avg: 58.4937 (0.868)
Ep: 47, Reward: 530.9317, Test: 328.4433 [142.73], Avg: 61.1441 (0.866)
Ep: 48, Reward: 493.8181, Test: 394.9843 [237.91], Avg: 63.1019 (0.863)
Ep: 49, Reward: 669.8753, Test: 471.2437 [184.55], Avg: 67.5737 (0.861)
Ep: 50, Reward: 675.5508, Test: 440.0582 [189.37], Avg: 71.1642 (0.858)
Ep: 51, Reward: 621.2935, Test: 393.7488 [122.29], Avg: 75.0161 (0.855)
Ep: 52, Reward: 638.5767, Test: 363.7481 [225.55], Avg: 76.2083 (0.853)
Ep: 53, Reward: 636.4044, Test: 499.7746 [141.85], Avg: 81.4252 (0.850)
Ep: 54, Reward: 648.1366, Test: 317.4774 [134.39], Avg: 83.2736 (0.848)
Ep: 55, Reward: 581.9790, Test: 354.5439 [174.69], Avg: 84.9983 (0.845)
Ep: 56, Reward: 588.0573, Test: 541.0864 [182.96], Avg: 89.7900 (0.843)
Ep: 57, Reward: 626.5525, Test: 480.3714 [192.95], Avg: 93.1975 (0.840)
Ep: 58, Reward: 499.2183, Test: 270.8501 [95.44], Avg: 94.5909 (0.838)
Ep: 59, Reward: 553.9516, Test: 462.4514 [137.05], Avg: 98.4377 (0.835)
Ep: 60, Reward: 480.6134, Test: 329.2572 [204.94], Avg: 98.8619 (0.833)
Ep: 61, Reward: 566.8657, Test: 400.5224 [167.46], Avg: 101.0264 (0.830)
Ep: 62, Reward: 599.9943, Test: 378.2166 [218.75], Avg: 101.9541 (0.828)
Ep: 63, Reward: 619.1227, Test: 426.1186 [134.47], Avg: 104.9180 (0.825)
Ep: 64, Reward: 640.6699, Test: 321.6035 [164.35], Avg: 105.7231 (0.823)
Ep: 65, Reward: 595.6791, Test: 477.3929 [179.56], Avg: 108.6339 (0.820)
Ep: 66, Reward: 699.3072, Test: 407.0142 [129.81], Avg: 111.1498 (0.818)
Ep: 67, Reward: 606.4083, Test: 575.5672 [143.38], Avg: 115.8709 (0.815)
Ep: 68, Reward: 697.4593, Test: 548.6142 [133.63], Avg: 120.2059 (0.813)
Ep: 69, Reward: 705.3211, Test: 498.6185 [143.45], Avg: 123.5625 (0.810)
Ep: 70, Reward: 599.0268, Test: 627.6751 [134.66], Avg: 128.7661 (0.808)
Ep: 71, Reward: 673.0164, Test: 501.1507 [155.32], Avg: 131.7809 (0.805)
Ep: 72, Reward: 681.4560, Test: 583.7250 [148.98], Avg: 135.9311 (0.803)
Ep: 73, Reward: 714.7622, Test: 652.1917 [184.30], Avg: 140.4171 (0.801)
Ep: 74, Reward: 687.4265, Test: 625.4999 [178.19], Avg: 144.5090 (0.798)
Ep: 75, Reward: 643.3792, Test: 676.2966 [168.89], Avg: 149.2840 (0.796)
Ep: 76, Reward: 696.3279, Test: 630.3859 [148.45], Avg: 153.6041 (0.793)
Ep: 77, Reward: 729.2630, Test: 582.3547 [190.43], Avg: 156.6595 (0.791)
Ep: 78, Reward: 795.8124, Test: 646.4951 [144.40], Avg: 161.0321 (0.789)
Ep: 79, Reward: 702.2938, Test: 724.1054 [116.59], Avg: 166.6131 (0.786)
Ep: 80, Reward: 809.3691, Test: 597.2974 [143.28], Avg: 170.1613 (0.784)
Ep: 81, Reward: 771.3733, Test: 464.1363 [97.23], Avg: 172.5607 (0.782)
Ep: 82, Reward: 792.1800, Test: 625.5259 [93.07], Avg: 176.8968 (0.779)
Ep: 83, Reward: 729.6639, Test: 554.6015 [148.75], Avg: 179.6224 (0.777)
Ep: 84, Reward: 840.1597, Test: 626.1810 [126.08], Avg: 183.3927 (0.775)
Ep: 85, Reward: 802.7967, Test: 640.8382 [165.47], Avg: 186.7877 (0.772)
Ep: 86, Reward: 845.1808, Test: 727.4473 [72.65], Avg: 192.1672 (0.770)
Ep: 87, Reward: 816.1711, Test: 650.5422 [141.02], Avg: 195.7734 (0.768)
Ep: 88, Reward: 873.7494, Test: 611.7133 [129.92], Avg: 198.9871 (0.765)
Ep: 89, Reward: 837.9836, Test: 691.3395 [168.33], Avg: 202.5874 (0.763)
Ep: 90, Reward: 897.6350, Test: 724.9027 [120.91], Avg: 206.9984 (0.761)
Ep: 91, Reward: 844.0244, Test: 554.2170 [187.78], Avg: 208.7314 (0.758)
Ep: 92, Reward: 787.8213, Test: 621.0546 [169.98], Avg: 211.3373 (0.756)
Ep: 93, Reward: 897.9657, Test: 721.2227 [108.85], Avg: 215.6037 (0.754)
Ep: 94, Reward: 841.7643, Test: 692.6488 [147.44], Avg: 219.0732 (0.752)
Ep: 95, Reward: 845.9849, Test: 591.3270 [156.58], Avg: 221.3198 (0.749)
Ep: 96, Reward: 816.2584, Test: 577.9587 [162.93], Avg: 223.3168 (0.747)
Ep: 97, Reward: 755.7612, Test: 596.0930 [133.92], Avg: 225.7541 (0.745)
Ep: 98, Reward: 747.1365, Test: 471.9690 [181.14], Avg: 226.4114 (0.743)
Ep: 99, Reward: 733.2519, Test: 548.1028 [128.92], Avg: 228.3392 (0.740)
Ep: 100, Reward: 703.1375, Test: 479.1117 [84.03], Avg: 229.9901 (0.738)
Ep: 101, Reward: 717.4020, Test: 449.5530 [173.45], Avg: 230.4422 (0.736)
Ep: 102, Reward: 627.0838, Test: 458.3592 [128.72], Avg: 231.4052 (0.734)
Ep: 103, Reward: 763.2617, Test: 393.7975 [73.16], Avg: 232.2633 (0.732)
Ep: 104, Reward: 716.5963, Test: 560.3057 [205.41], Avg: 233.4312 (0.729)
Ep: 105, Reward: 736.6410, Test: 623.4421 [167.41], Avg: 235.5313 (0.727)
Ep: 106, Reward: 731.1053, Test: 597.4631 [189.70], Avg: 237.1409 (0.725)
Ep: 107, Reward: 698.5633, Test: 517.3243 [186.16], Avg: 238.0115 (0.723)
Ep: 108, Reward: 719.0063, Test: 468.5940 [143.76], Avg: 238.8080 (0.721)
Ep: 109, Reward: 850.4138, Test: 588.0232 [204.88], Avg: 240.1201 (0.719)
Ep: 110, Reward: 706.1677, Test: 511.8559 [153.71], Avg: 241.1834 (0.716)
Ep: 111, Reward: 766.2622, Test: 495.5792 [161.31], Avg: 242.0146 (0.714)
Ep: 112, Reward: 701.1508, Test: 484.8124 [121.64], Avg: 243.0868 (0.712)
Ep: 113, Reward: 753.8050, Test: 583.3483 [108.69], Avg: 245.1181 (0.710)
Ep: 114, Reward: 733.2344, Test: 511.7285 [214.73], Avg: 245.5693 (0.708)
Ep: 115, Reward: 712.9845, Test: 483.2964 [196.93], Avg: 245.9210 (0.706)
Ep: 116, Reward: 706.7419, Test: 465.2415 [173.72], Avg: 246.3107 (0.704)
Ep: 117, Reward: 732.8151, Test: 548.7917 [173.94], Avg: 247.4000 (0.702)
Ep: 118, Reward: 794.8901, Test: 464.5225 [130.34], Avg: 248.1293 (0.699)
Ep: 119, Reward: 766.2113, Test: 473.7697 [153.54], Avg: 248.7301 (0.697)
Ep: 120, Reward: 751.9869, Test: 504.8007 [177.93], Avg: 249.3759 (0.695)
Ep: 121, Reward: 740.0544, Test: 505.3023 [216.38], Avg: 249.7001 (0.693)
Ep: 122, Reward: 682.6830, Test: 518.4112 [198.80], Avg: 250.2684 (0.691)
Ep: 123, Reward: 649.8692, Test: 523.9981 [150.43], Avg: 251.2628 (0.689)
Ep: 124, Reward: 784.2449, Test: 571.3453 [186.01], Avg: 252.3353 (0.687)
Ep: 125, Reward: 850.4006, Test: 493.9752 [160.84], Avg: 252.9766 (0.685)
Ep: 126, Reward: 821.3709, Test: 561.3196 [161.81], Avg: 254.1304 (0.683)
Ep: 127, Reward: 791.7074, Test: 608.4904 [167.63], Avg: 255.5893 (0.681)
Ep: 128, Reward: 831.1954, Test: 628.7140 [211.21], Avg: 256.8444 (0.679)
Ep: 129, Reward: 883.5372, Test: 555.2803 [154.64], Avg: 257.9506 (0.677)
Ep: 130, Reward: 866.5739, Test: 584.7592 [143.94], Avg: 259.3465 (0.675)
Ep: 131, Reward: 851.1184, Test: 572.0802 [129.80], Avg: 260.7324 (0.673)
Ep: 132, Reward: 876.2003, Test: 668.3806 [139.34], Avg: 262.7498 (0.671)
Ep: 133, Reward: 858.8557, Test: 726.6857 [151.34], Avg: 265.0826 (0.669)
Ep: 134, Reward: 889.3347, Test: 750.8862 [113.12], Avg: 267.8432 (0.667)
Ep: 135, Reward: 861.0633, Test: 651.2261 [167.28], Avg: 269.4322 (0.665)
Ep: 136, Reward: 893.2971, Test: 738.2220 [147.18], Avg: 271.7798 (0.663)
Ep: 137, Reward: 890.3720, Test: 721.1620 [145.38], Avg: 273.9827 (0.661)
Ep: 138, Reward: 871.7161, Test: 682.0453 [162.82], Avg: 275.7470 (0.659)
Ep: 139, Reward: 901.1747, Test: 801.6762 [136.13], Avg: 278.5312 (0.657)
Ep: 140, Reward: 903.6434, Test: 798.2582 [121.73], Avg: 281.3539 (0.655)
Ep: 141, Reward: 904.9973, Test: 840.8844 [64.29], Avg: 284.8415 (0.653)
Ep: 142, Reward: 869.8018, Test: 718.3348 [176.52], Avg: 286.6385 (0.651)
Ep: 143, Reward: 875.6499, Test: 810.7276 [69.14], Avg: 289.7979 (0.649)
Ep: 144, Reward: 902.1990, Test: 678.9737 [174.75], Avg: 291.2767 (0.647)
Ep: 145, Reward: 829.4424, Test: 684.8602 [169.75], Avg: 292.8098 (0.645)
Ep: 146, Reward: 889.0798, Test: 665.4745 [194.82], Avg: 294.0196 (0.643)
Ep: 147, Reward: 868.4905, Test: 809.9948 [106.23], Avg: 296.7882 (0.641)
Ep: 148, Reward: 868.8163, Test: 719.6747 [136.91], Avg: 298.7074 (0.639)
Ep: 149, Reward: 848.4706, Test: 736.6965 [189.48], Avg: 300.3642 (0.637)
Ep: 150, Reward: 902.1560, Test: 735.1378 [162.89], Avg: 302.1648 (0.635)
Ep: 151, Reward: 866.1235, Test: 618.9570 [201.29], Avg: 302.9247 (0.633)
Ep: 152, Reward: 897.8862, Test: 746.7632 [160.92], Avg: 304.7738 (0.631)
Ep: 153, Reward: 767.7243, Test: 713.4687 [187.67], Avg: 306.2091 (0.630)
Ep: 154, Reward: 875.8016, Test: 640.8117 [152.85], Avg: 307.3817 (0.628)
Ep: 155, Reward: 860.5380, Test: 578.3793 [209.08], Avg: 307.7786 (0.626)
Ep: 156, Reward: 832.1468, Test: 623.0569 [200.11], Avg: 308.5121 (0.624)
Ep: 157, Reward: 764.1055, Test: 679.5326 [158.71], Avg: 309.8558 (0.622)
Ep: 158, Reward: 804.2610, Test: 770.8657 [99.02], Avg: 312.1325 (0.620)
Ep: 159, Reward: 775.1782, Test: 667.2661 [148.44], Avg: 313.4244 (0.618)
Ep: 160, Reward: 785.8151, Test: 636.4964 [154.31], Avg: 314.4726 (0.616)
Ep: 161, Reward: 786.1799, Test: 549.5115 [207.59], Avg: 314.6420 (0.615)
Ep: 162, Reward: 814.8004, Test: 632.1748 [127.45], Avg: 315.8082 (0.613)
Ep: 163, Reward: 722.4095, Test: 585.8880 [176.85], Avg: 316.3766 (0.611)
Ep: 164, Reward: 760.5827, Test: 520.0823 [128.86], Avg: 316.8303 (0.609)
Ep: 165, Reward: 689.8466, Test: 561.4145 [172.43], Avg: 317.2649 (0.607)
Ep: 166, Reward: 784.5792, Test: 619.2593 [182.02], Avg: 317.9833 (0.605)
Ep: 167, Reward: 779.1148, Test: 617.2373 [151.19], Avg: 318.8646 (0.604)
Ep: 168, Reward: 772.2866, Test: 545.3220 [141.82], Avg: 319.3655 (0.602)
Ep: 169, Reward: 794.3786, Test: 660.3746 [137.84], Avg: 320.5606 (0.600)
Ep: 170, Reward: 719.8298, Test: 612.6384 [184.29], Avg: 321.1909 (0.598)
Ep: 171, Reward: 797.8305, Test: 608.8195 [165.08], Avg: 321.9034 (0.596)
Ep: 172, Reward: 752.5838, Test: 645.2494 [174.39], Avg: 322.7644 (0.595)
Ep: 173, Reward: 698.5028, Test: 488.1093 [166.13], Avg: 322.7599 (0.593)
Ep: 174, Reward: 801.6550, Test: 621.7165 [168.83], Avg: 323.5035 (0.591)
Ep: 175, Reward: 810.4898, Test: 609.3424 [158.26], Avg: 324.2284 (0.589)
Ep: 176, Reward: 736.3044, Test: 615.4537 [145.01], Avg: 325.0544 (0.588)
Ep: 177, Reward: 724.7760, Test: 643.3184 [139.58], Avg: 326.0583 (0.586)
Ep: 178, Reward: 720.2098, Test: 683.5251 [149.44], Avg: 327.2204 (0.584)
Ep: 179, Reward: 800.6627, Test: 652.7182 [181.51], Avg: 328.0203 (0.582)
Ep: 180, Reward: 781.1362, Test: 610.7426 [180.88], Avg: 328.5830 (0.581)
Ep: 181, Reward: 787.8237, Test: 745.3653 [123.58], Avg: 330.1940 (0.579)
Ep: 182, Reward: 839.9758, Test: 707.4192 [150.64], Avg: 331.4322 (0.577)
Ep: 183, Reward: 838.4100, Test: 699.8782 [134.85], Avg: 332.7017 (0.575)
Ep: 184, Reward: 815.2418, Test: 635.4145 [180.07], Avg: 333.3647 (0.574)
Ep: 185, Reward: 786.2563, Test: 607.8531 [191.98], Avg: 333.8083 (0.572)
Ep: 186, Reward: 727.2305, Test: 659.0557 [93.30], Avg: 335.0486 (0.570)
Ep: 187, Reward: 643.2555, Test: 641.9217 [139.34], Avg: 335.9397 (0.568)
Ep: 188, Reward: 681.3554, Test: 654.9439 [166.05], Avg: 336.7490 (0.567)
Ep: 189, Reward: 770.6177, Test: 667.5723 [160.90], Avg: 337.6434 (0.565)
Ep: 190, Reward: 784.1770, Test: 586.4071 [199.20], Avg: 337.9029 (0.563)
Ep: 191, Reward: 773.8431, Test: 633.6173 [190.49], Avg: 338.4509 (0.562)
Ep: 192, Reward: 793.3892, Test: 587.6594 [136.58], Avg: 339.0345 (0.560)
Ep: 193, Reward: 714.6577, Test: 669.5338 [126.95], Avg: 340.0837 (0.558)
Ep: 194, Reward: 773.9851, Test: 775.6586 [56.48], Avg: 342.0277 (0.557)
Ep: 195, Reward: 739.7865, Test: 736.2308 [106.22], Avg: 343.4970 (0.555)
Ep: 196, Reward: 798.1285, Test: 739.0843 [139.26], Avg: 344.7982 (0.553)
Ep: 197, Reward: 721.4275, Test: 672.8872 [183.04], Avg: 345.5308 (0.552)
Ep: 198, Reward: 787.1935, Test: 673.4188 [151.02], Avg: 346.4196 (0.550)
Ep: 199, Reward: 754.7820, Test: 729.9112 [164.78], Avg: 347.5132 (0.548)
Ep: 200, Reward: 812.4906, Test: 718.6078 [160.33], Avg: 348.5617 (0.547)
Ep: 201, Reward: 843.3560, Test: 595.8132 [208.07], Avg: 348.7557 (0.545)
Ep: 202, Reward: 747.3195, Test: 596.0586 [209.76], Avg: 348.9406 (0.543)
Ep: 203, Reward: 706.4742, Test: 712.2200 [140.53], Avg: 350.0325 (0.542)
Ep: 204, Reward: 793.3225, Test: 814.4207 [65.23], Avg: 351.9797 (0.540)
Ep: 205, Reward: 800.4127, Test: 716.0008 [172.44], Avg: 352.9097 (0.539)
Ep: 206, Reward: 780.9449, Test: 697.5671 [160.07], Avg: 353.8014 (0.537)
Ep: 207, Reward: 706.0408, Test: 674.6877 [191.42], Avg: 354.4238 (0.535)
Ep: 208, Reward: 809.4397, Test: 761.4333 [83.05], Avg: 355.9738 (0.534)
Ep: 209, Reward: 818.9844, Test: 808.6410 [71.86], Avg: 357.7872 (0.532)
Ep: 210, Reward: 777.8798, Test: 738.6114 [164.54], Avg: 358.8122 (0.530)
Ep: 211, Reward: 755.9939, Test: 750.7462 [114.90], Avg: 360.1190 (0.529)
Ep: 212, Reward: 838.1796, Test: 709.5304 [146.55], Avg: 361.0714 (0.527)
Ep: 213, Reward: 830.5184, Test: 741.9167 [127.84], Avg: 362.2537 (0.526)
Ep: 214, Reward: 784.3911, Test: 682.1527 [189.35], Avg: 362.8609 (0.524)
Ep: 215, Reward: 766.7927, Test: 735.7514 [131.86], Avg: 363.9768 (0.523)
Ep: 216, Reward: 822.2027, Test: 787.6328 [50.85], Avg: 365.6948 (0.521)
Ep: 217, Reward: 817.7425, Test: 747.2801 [146.49], Avg: 366.7732 (0.519)
Ep: 218, Reward: 818.1142, Test: 761.2845 [148.27], Avg: 367.8976 (0.518)
Ep: 219, Reward: 780.2478, Test: 757.3671 [99.37], Avg: 369.2162 (0.516)
Ep: 220, Reward: 796.4545, Test: 790.8694 [86.25], Avg: 370.7339 (0.515)
Ep: 221, Reward: 855.4379, Test: 775.7470 [126.95], Avg: 371.9864 (0.513)
Ep: 222, Reward: 831.0285, Test: 788.1636 [131.68], Avg: 373.2622 (0.512)
Ep: 223, Reward: 884.8469, Test: 731.6346 [149.86], Avg: 374.1931 (0.510)
Ep: 224, Reward: 850.9733, Test: 712.6870 [152.46], Avg: 375.0199 (0.509)
Ep: 225, Reward: 843.0747, Test: 822.2921 [48.38], Avg: 376.7849 (0.507)
Ep: 226, Reward: 797.4107, Test: 767.6010 [113.65], Avg: 378.0059 (0.506)
Ep: 227, Reward: 808.2359, Test: 820.7596 [57.79], Avg: 379.6943 (0.504)
Ep: 228, Reward: 843.7927, Test: 781.4190 [131.58], Avg: 380.8740 (0.503)
Ep: 229, Reward: 828.9514, Test: 721.6867 [144.95], Avg: 381.7256 (0.501)
Ep: 230, Reward: 872.6716, Test: 832.4940 [52.52], Avg: 383.4496 (0.500)
Ep: 231, Reward: 838.0973, Test: 750.2988 [145.25], Avg: 384.4048 (0.498)
Ep: 232, Reward: 823.1738, Test: 795.7393 [112.01], Avg: 385.6894 (0.497)
Ep: 233, Reward: 854.2067, Test: 786.3328 [102.39], Avg: 386.9640 (0.495)
Ep: 234, Reward: 850.9970, Test: 816.1711 [130.56], Avg: 388.2348 (0.494)
Ep: 235, Reward: 865.1545, Test: 739.5827 [153.42], Avg: 389.0735 (0.492)
Ep: 236, Reward: 857.2079, Test: 731.7305 [172.06], Avg: 389.7934 (0.491)
Ep: 237, Reward: 924.3916, Test: 814.0086 [86.69], Avg: 391.2115 (0.489)
Ep: 238, Reward: 873.2286, Test: 751.9786 [156.45], Avg: 392.0664 (0.488)
Ep: 239, Reward: 848.9359, Test: 835.8453 [57.92], Avg: 393.6741 (0.486)
Ep: 240, Reward: 865.3101, Test: 834.7709 [43.62], Avg: 395.3234 (0.485)
Ep: 241, Reward: 875.1870, Test: 721.6965 [140.25], Avg: 396.0925 (0.483)
Ep: 242, Reward: 857.4074, Test: 797.4668 [121.94], Avg: 397.2425 (0.482)
Ep: 243, Reward: 866.6854, Test: 777.8914 [116.36], Avg: 398.3256 (0.480)
Ep: 244, Reward: 854.3839, Test: 812.1907 [116.07], Avg: 399.5411 (0.479)
Ep: 245, Reward: 884.8653, Test: 768.3742 [170.87], Avg: 400.3458 (0.478)
Ep: 246, Reward: 796.2272, Test: 800.8569 [118.48], Avg: 401.4876 (0.476)
Ep: 247, Reward: 883.2515, Test: 796.7138 [137.37], Avg: 402.5274 (0.475)
Ep: 248, Reward: 844.1440, Test: 762.5993 [112.18], Avg: 403.5229 (0.473)
Ep: 249, Reward: 850.3262, Test: 848.7574 [33.84], Avg: 405.1685 (0.472)
Ep: 250, Reward: 828.7893, Test: 753.2652 [200.54], Avg: 405.7564 (0.470)
Ep: 251, Reward: 863.1920, Test: 849.7850 [35.35], Avg: 407.3781 (0.469)
Ep: 252, Reward: 896.1899, Test: 769.7164 [165.65], Avg: 408.1555 (0.468)
Ep: 253, Reward: 871.4527, Test: 841.3605 [98.30], Avg: 409.4741 (0.466)
Ep: 254, Reward: 789.1492, Test: 824.4367 [116.36], Avg: 410.6450 (0.465)
Ep: 255, Reward: 888.9381, Test: 808.4526 [118.23], Avg: 411.7372 (0.463)
Ep: 256, Reward: 861.8738, Test: 840.3422 [57.32], Avg: 413.1818 (0.462)
Ep: 257, Reward: 822.0241, Test: 864.4214 [31.93], Avg: 414.8071 (0.461)
Ep: 258, Reward: 864.9136, Test: 820.5372 [73.58], Avg: 416.0895 (0.459)
Ep: 259, Reward: 759.8199, Test: 791.7620 [119.41], Avg: 417.0751 (0.458)
Ep: 260, Reward: 862.2276, Test: 835.3272 [97.35], Avg: 418.3047 (0.456)
Ep: 261, Reward: 869.2511, Test: 786.1114 [133.31], Avg: 419.1997 (0.455)
Ep: 262, Reward: 787.3936, Test: 825.3622 [143.88], Avg: 420.1970 (0.454)
Ep: 263, Reward: 855.5124, Test: 867.7083 [30.13], Avg: 421.7779 (0.452)
Ep: 264, Reward: 893.1741, Test: 800.6799 [127.97], Avg: 422.7249 (0.451)
Ep: 265, Reward: 876.0655, Test: 788.1612 [117.94], Avg: 423.6553 (0.450)
Ep: 266, Reward: 875.6698, Test: 833.3510 [42.92], Avg: 425.0290 (0.448)
Ep: 267, Reward: 884.8435, Test: 851.9760 [83.41], Avg: 426.3108 (0.447)
Ep: 268, Reward: 877.3605, Test: 788.9158 [114.29], Avg: 427.2339 (0.446)
Ep: 269, Reward: 867.1172, Test: 836.7494 [110.22], Avg: 428.3424 (0.444)
Ep: 270, Reward: 808.8872, Test: 814.6933 [128.34], Avg: 429.2945 (0.443)
Ep: 271, Reward: 899.8909, Test: 828.9553 [53.90], Avg: 430.5657 (0.442)
Ep: 272, Reward: 906.4239, Test: 813.6134 [177.61], Avg: 431.3182 (0.440)
Ep: 273, Reward: 923.5266, Test: 811.2649 [134.30], Avg: 432.2147 (0.439)
Ep: 274, Reward: 925.7097, Test: 850.0173 [35.99], Avg: 433.6031 (0.438)
Ep: 275, Reward: 898.9425, Test: 857.5533 [59.61], Avg: 434.9232 (0.436)
Ep: 276, Reward: 946.9199, Test: 891.6017 [27.86], Avg: 436.4713 (0.435)
Ep: 277, Reward: 898.1066, Test: 794.8289 [107.46], Avg: 437.3738 (0.434)
Ep: 278, Reward: 945.9532, Test: 851.9585 [38.20], Avg: 438.7228 (0.432)
Ep: 279, Reward: 898.4772, Test: 808.2613 [97.25], Avg: 439.6953 (0.431)
Ep: 280, Reward: 914.8156, Test: 832.5337 [95.18], Avg: 440.7546 (0.430)
Ep: 281, Reward: 902.5447, Test: 846.3474 [41.19], Avg: 442.0468 (0.429)
Ep: 282, Reward: 926.9220, Test: 866.0020 [32.33], Avg: 443.4306 (0.427)
Ep: 283, Reward: 911.8180, Test: 861.8169 [33.41], Avg: 444.7862 (0.426)
Ep: 284, Reward: 882.1071, Test: 862.4161 [15.44], Avg: 446.1974 (0.425)
Ep: 285, Reward: 880.6810, Test: 829.1424 [62.77], Avg: 447.3169 (0.423)
Ep: 286, Reward: 912.1694, Test: 815.3465 [135.16], Avg: 448.1282 (0.422)
Ep: 287, Reward: 925.9647, Test: 841.4637 [64.74], Avg: 449.2692 (0.421)
Ep: 288, Reward: 886.9327, Test: 836.7540 [95.07], Avg: 450.2810 (0.420)
Ep: 289, Reward: 872.2022, Test: 853.3492 [50.15], Avg: 451.4980 (0.418)
Ep: 290, Reward: 917.2932, Test: 865.0174 [42.65], Avg: 452.7725 (0.417)
Ep: 291, Reward: 880.8908, Test: 801.3117 [153.55], Avg: 453.4402 (0.416)
Ep: 292, Reward: 906.1396, Test: 854.1877 [44.63], Avg: 454.6556 (0.415)
Ep: 293, Reward: 871.1329, Test: 861.8173 [35.09], Avg: 455.9212 (0.413)
Ep: 294, Reward: 890.9763, Test: 853.9063 [47.33], Avg: 457.1099 (0.412)
Ep: 295, Reward: 892.5025, Test: 857.8625 [103.12], Avg: 458.1154 (0.411)
Ep: 296, Reward: 892.6349, Test: 819.7020 [78.75], Avg: 459.0677 (0.410)
Ep: 297, Reward: 927.9227, Test: 850.5598 [60.11], Avg: 460.1797 (0.408)
Ep: 298, Reward: 847.4342, Test: 855.3718 [53.41], Avg: 461.3228 (0.407)
Ep: 299, Reward: 847.8041, Test: 815.4463 [96.70], Avg: 462.1809 (0.406)
Ep: 300, Reward: 818.6459, Test: 712.0729 [169.04], Avg: 462.4495 (0.405)
Ep: 301, Reward: 916.9039, Test: 833.6382 [88.74], Avg: 463.3847 (0.404)
Ep: 302, Reward: 884.4662, Test: 844.2473 [89.36], Avg: 464.3468 (0.402)
Ep: 303, Reward: 843.1178, Test: 862.2558 [48.14], Avg: 465.4973 (0.401)
Ep: 304, Reward: 897.8383, Test: 864.4565 [67.41], Avg: 466.5844 (0.400)
Ep: 305, Reward: 884.4877, Test: 815.6679 [149.38], Avg: 467.2370 (0.399)
Ep: 306, Reward: 906.1118, Test: 789.1081 [178.66], Avg: 467.7035 (0.398)
Ep: 307, Reward: 863.0676, Test: 844.6930 [104.81], Avg: 468.5872 (0.396)
Ep: 308, Reward: 849.0820, Test: 865.7349 [38.15], Avg: 469.7490 (0.395)
Ep: 309, Reward: 879.0750, Test: 861.3081 [46.15], Avg: 470.8632 (0.394)
Ep: 310, Reward: 908.1047, Test: 866.0428 [11.44], Avg: 472.0971 (0.393)
Ep: 311, Reward: 986.9003, Test: 828.9868 [70.82], Avg: 473.0140 (0.392)
Ep: 312, Reward: 884.9604, Test: 801.3875 [171.32], Avg: 473.5158 (0.390)
Ep: 313, Reward: 922.7035, Test: 844.8908 [72.73], Avg: 474.4669 (0.389)
Ep: 314, Reward: 855.1273, Test: 845.9569 [64.70], Avg: 475.4408 (0.388)
Ep: 315, Reward: 883.6187, Test: 850.3818 [76.72], Avg: 476.3846 (0.387)
Ep: 316, Reward: 901.3510, Test: 874.9956 [25.91], Avg: 477.5603 (0.386)
Ep: 317, Reward: 906.9718, Test: 836.6826 [70.73], Avg: 478.4672 (0.385)
Ep: 318, Reward: 847.2257, Test: 869.2204 [23.33], Avg: 479.6189 (0.383)
Ep: 319, Reward: 889.0836, Test: 823.5589 [105.13], Avg: 480.3652 (0.382)
Ep: 320, Reward: 902.4674, Test: 813.3848 [90.97], Avg: 481.1193 (0.381)
Ep: 321, Reward: 905.7644, Test: 846.0418 [25.22], Avg: 482.1743 (0.380)
Ep: 322, Reward: 909.6439, Test: 803.4729 [125.13], Avg: 482.7816 (0.379)
Ep: 323, Reward: 864.1469, Test: 814.5556 [115.22], Avg: 483.4500 (0.378)
Ep: 324, Reward: 882.3289, Test: 862.9205 [44.34], Avg: 484.4811 (0.377)
Ep: 325, Reward: 888.8706, Test: 801.1640 [102.00], Avg: 485.1397 (0.376)
Ep: 326, Reward: 931.8995, Test: 823.2047 [87.60], Avg: 485.9056 (0.374)
Ep: 327, Reward: 841.4528, Test: 851.3750 [66.31], Avg: 486.8177 (0.373)
Ep: 328, Reward: 877.5262, Test: 851.8427 [61.94], Avg: 487.7390 (0.372)
Ep: 329, Reward: 880.4412, Test: 834.4352 [98.05], Avg: 488.4924 (0.371)
Ep: 330, Reward: 865.7326, Test: 842.9926 [66.24], Avg: 489.3633 (0.370)
Ep: 331, Reward: 854.7086, Test: 865.2681 [25.36], Avg: 490.4192 (0.369)
Ep: 332, Reward: 861.2183, Test: 842.7999 [89.46], Avg: 491.2087 (0.368)
Ep: 333, Reward: 872.1308, Test: 855.7164 [37.56], Avg: 492.1876 (0.367)
Ep: 334, Reward: 879.8505, Test: 781.8545 [124.41], Avg: 492.6809 (0.365)
Ep: 335, Reward: 915.1760, Test: 843.2611 [88.65], Avg: 493.4605 (0.364)
Ep: 336, Reward: 889.6024, Test: 809.5324 [117.48], Avg: 494.0498 (0.363)
Ep: 337, Reward: 877.5636, Test: 816.7064 [122.42], Avg: 494.6422 (0.362)
Ep: 338, Reward: 892.2157, Test: 827.2172 [79.58], Avg: 495.3885 (0.361)
Ep: 339, Reward: 866.4832, Test: 831.7423 [94.33], Avg: 496.1003 (0.360)
Ep: 340, Reward: 847.6293, Test: 790.9541 [111.89], Avg: 496.6368 (0.359)
Ep: 341, Reward: 912.8981, Test: 857.2720 [57.44], Avg: 497.5234 (0.358)
Ep: 342, Reward: 908.4835, Test: 825.3555 [100.41], Avg: 498.1864 (0.357)
Ep: 343, Reward: 875.8571, Test: 810.3761 [107.22], Avg: 498.7822 (0.356)
Ep: 344, Reward: 898.5202, Test: 805.0643 [94.48], Avg: 499.3962 (0.355)
Ep: 345, Reward: 838.8900, Test: 784.1518 [130.62], Avg: 499.8416 (0.354)
Ep: 346, Reward: 864.8189, Test: 798.8044 [105.11], Avg: 500.4003 (0.353)
Ep: 347, Reward: 901.2479, Test: 840.4134 [74.85], Avg: 501.1623 (0.351)
Ep: 348, Reward: 878.5255, Test: 886.1566 [27.52], Avg: 502.1865 (0.350)
Ep: 349, Reward: 905.2236, Test: 876.8222 [31.19], Avg: 503.1678 (0.349)
Ep: 350, Reward: 865.9579, Test: 870.4420 [23.66], Avg: 504.1468 (0.348)
Ep: 351, Reward: 934.7508, Test: 862.8561 [19.55], Avg: 505.1103 (0.347)
Ep: 352, Reward: 888.9374, Test: 853.2337 [56.24], Avg: 505.9371 (0.346)
Ep: 353, Reward: 888.7964, Test: 771.2868 [150.83], Avg: 506.2607 (0.345)
Ep: 354, Reward: 875.9594, Test: 855.3444 [27.45], Avg: 507.1667 (0.344)
Ep: 355, Reward: 883.5681, Test: 843.7491 [43.45], Avg: 507.9901 (0.343)
Ep: 356, Reward: 941.8250, Test: 857.7384 [75.82], Avg: 508.7574 (0.342)
Ep: 357, Reward: 904.3747, Test: 783.3399 [140.86], Avg: 509.1309 (0.341)
Ep: 358, Reward: 837.0665, Test: 821.1909 [114.56], Avg: 509.6810 (0.340)
Ep: 359, Reward: 919.6583, Test: 790.2771 [98.49], Avg: 510.1869 (0.339)
Ep: 360, Reward: 882.6138, Test: 798.2417 [154.08], Avg: 510.5580 (0.338)
Ep: 361, Reward: 880.3197, Test: 830.3338 [96.97], Avg: 511.1735 (0.337)
Ep: 362, Reward: 871.2770, Test: 825.8318 [98.68], Avg: 511.7685 (0.336)
Ep: 363, Reward: 920.2421, Test: 803.0763 [110.79], Avg: 512.2644 (0.335)
Ep: 364, Reward: 923.3712, Test: 784.5832 [135.11], Avg: 512.6403 (0.334)
Ep: 365, Reward: 884.7117, Test: 790.5842 [85.98], Avg: 513.1648 (0.333)
Ep: 366, Reward: 872.8294, Test: 778.1765 [145.69], Avg: 513.4900 (0.332)
Ep: 367, Reward: 915.1919, Test: 857.8519 [18.79], Avg: 514.3746 (0.331)
Ep: 368, Reward: 881.0622, Test: 837.6248 [84.81], Avg: 515.0208 (0.330)
Ep: 369, Reward: 904.8808, Test: 768.2383 [202.50], Avg: 515.1579 (0.329)
Ep: 370, Reward: 861.6443, Test: 788.2925 [141.75], Avg: 515.5120 (0.328)
Ep: 371, Reward: 887.7110, Test: 821.2978 [107.27], Avg: 516.0457 (0.327)
Ep: 372, Reward: 893.8029, Test: 844.6882 [80.57], Avg: 516.7108 (0.326)
Ep: 373, Reward: 919.9349, Test: 803.8970 [87.21], Avg: 517.2455 (0.325)
Ep: 374, Reward: 909.2957, Test: 840.0616 [58.73], Avg: 517.9497 (0.324)
Ep: 375, Reward: 921.0807, Test: 828.3974 [68.11], Avg: 518.5942 (0.323)
Ep: 376, Reward: 902.8689, Test: 850.6978 [19.70], Avg: 519.4229 (0.322)
Ep: 377, Reward: 877.0607, Test: 840.3725 [87.96], Avg: 520.0392 (0.321)
Ep: 378, Reward: 863.2419, Test: 851.4807 [38.43], Avg: 520.8124 (0.320)
Ep: 379, Reward: 876.5499, Test: 841.9591 [56.90], Avg: 521.5077 (0.319)
Ep: 380, Reward: 912.8350, Test: 831.3577 [65.17], Avg: 522.1499 (0.318)
Ep: 381, Reward: 940.5118, Test: 825.9087 [109.60], Avg: 522.6582 (0.317)
Ep: 382, Reward: 917.5711, Test: 833.6052 [58.95], Avg: 523.3162 (0.316)
Ep: 383, Reward: 814.8722, Test: 833.7392 [65.03], Avg: 523.9552 (0.315)
Ep: 384, Reward: 900.7322, Test: 789.6097 [133.65], Avg: 524.2981 (0.315)
Ep: 385, Reward: 902.7876, Test: 738.7207 [104.60], Avg: 524.5826 (0.314)
Ep: 386, Reward: 948.1946, Test: 792.0080 [120.58], Avg: 524.9620 (0.313)
Ep: 387, Reward: 902.8748, Test: 773.4669 [145.21], Avg: 525.2283 (0.312)
Ep: 388, Reward: 870.8684, Test: 764.3405 [149.65], Avg: 525.4583 (0.311)
Ep: 389, Reward: 816.3783, Test: 843.1139 [45.63], Avg: 526.1558 (0.310)
Ep: 390, Reward: 946.2936, Test: 837.1277 [82.93], Avg: 526.7390 (0.309)
Ep: 391, Reward: 899.7573, Test: 839.0282 [85.42], Avg: 527.3177 (0.308)
Ep: 392, Reward: 914.5272, Test: 798.9235 [111.28], Avg: 527.7257 (0.307)
Ep: 393, Reward: 863.0595, Test: 828.0012 [103.33], Avg: 528.2255 (0.306)
Ep: 394, Reward: 950.6441, Test: 792.1493 [119.01], Avg: 528.5924 (0.305)
Ep: 395, Reward: 925.3018, Test: 868.2022 [30.06], Avg: 529.3741 (0.304)
Ep: 396, Reward: 884.2269, Test: 838.6261 [81.88], Avg: 529.9468 (0.303)
Ep: 397, Reward: 897.2903, Test: 843.8325 [92.21], Avg: 530.5038 (0.302)
Ep: 398, Reward: 925.6221, Test: 796.7744 [74.63], Avg: 530.9841 (0.302)
Ep: 399, Reward: 932.9655, Test: 817.0947 [103.86], Avg: 531.4397 (0.301)
Ep: 400, Reward: 871.5521, Test: 846.2314 [61.28], Avg: 532.0719 (0.300)
Ep: 401, Reward: 924.6307, Test: 845.1979 [90.60], Avg: 532.6255 (0.299)
Ep: 402, Reward: 913.3378, Test: 840.4752 [67.58], Avg: 533.2216 (0.298)
Ep: 403, Reward: 905.5956, Test: 833.6070 [88.94], Avg: 533.7450 (0.297)
Ep: 404, Reward: 914.4390, Test: 822.7230 [142.62], Avg: 534.1064 (0.296)
Ep: 405, Reward: 942.9221, Test: 849.2095 [82.43], Avg: 534.6795 (0.295)
Ep: 406, Reward: 903.5563, Test: 864.3264 [28.50], Avg: 535.4194 (0.294)
Ep: 407, Reward: 977.4161, Test: 846.8188 [65.12], Avg: 536.0230 (0.294)
Ep: 408, Reward: 924.5391, Test: 858.2480 [10.94], Avg: 536.7841 (0.293)
Ep: 409, Reward: 936.3744, Test: 822.9394 [109.49], Avg: 537.2150 (0.292)
Ep: 410, Reward: 943.1560, Test: 869.0466 [15.87], Avg: 537.9838 (0.291)
Ep: 411, Reward: 929.5782, Test: 840.2949 [43.56], Avg: 538.6118 (0.290)
Ep: 412, Reward: 857.2824, Test: 811.2378 [101.90], Avg: 539.0252 (0.289)
Ep: 413, Reward: 918.6714, Test: 858.9934 [14.94], Avg: 539.7620 (0.288)
Ep: 414, Reward: 904.2148, Test: 802.8236 [107.67], Avg: 540.1364 (0.287)
Ep: 415, Reward: 946.5537, Test: 716.0428 [137.08], Avg: 540.2298 (0.287)
Ep: 416, Reward: 876.1793, Test: 802.0277 [78.86], Avg: 540.6684 (0.286)
Ep: 417, Reward: 863.8353, Test: 840.6283 [55.37], Avg: 541.2536 (0.285)
Ep: 418, Reward: 918.8583, Test: 843.4046 [73.79], Avg: 541.7986 (0.284)
Ep: 419, Reward: 901.0527, Test: 820.1663 [98.77], Avg: 542.2262 (0.283)
Ep: 420, Reward: 868.5389, Test: 804.4708 [82.03], Avg: 542.6543 (0.282)
Ep: 421, Reward: 890.9465, Test: 844.7500 [31.71], Avg: 543.2950 (0.281)
Ep: 422, Reward: 960.3564, Test: 825.2167 [80.73], Avg: 543.7707 (0.281)
Ep: 423, Reward: 869.4456, Test: 814.2558 [96.83], Avg: 544.1802 (0.280)
Ep: 424, Reward: 913.5718, Test: 852.3520 [33.70], Avg: 544.8260 (0.279)
Ep: 425, Reward: 973.4167, Test: 823.9834 [113.76], Avg: 545.2143 (0.278)
Ep: 426, Reward: 927.5206, Test: 852.0992 [55.71], Avg: 545.8025 (0.277)
Ep: 427, Reward: 939.1715, Test: 832.2506 [103.58], Avg: 546.2298 (0.276)
Ep: 428, Reward: 900.3516, Test: 819.5901 [110.07], Avg: 546.6104 (0.276)
Ep: 429, Reward: 874.6649, Test: 826.6394 [135.14], Avg: 546.9474 (0.275)
Ep: 430, Reward: 960.4896, Test: 860.9130 [23.54], Avg: 547.6212 (0.274)
Ep: 431, Reward: 911.5347, Test: 874.3980 [37.11], Avg: 548.2917 (0.273)
Ep: 432, Reward: 896.5591, Test: 842.1270 [41.46], Avg: 548.8746 (0.272)
Ep: 433, Reward: 878.0563, Test: 856.0603 [36.92], Avg: 549.4973 (0.271)
Ep: 434, Reward: 916.2252, Test: 839.0638 [46.36], Avg: 550.0564 (0.271)
Ep: 435, Reward: 944.0138, Test: 837.9782 [97.12], Avg: 550.4940 (0.270)
Ep: 436, Reward: 978.9949, Test: 853.8523 [26.09], Avg: 551.1285 (0.269)
Ep: 437, Reward: 916.1177, Test: 867.0972 [73.58], Avg: 551.6819 (0.268)
Ep: 438, Reward: 918.3897, Test: 864.3506 [26.63], Avg: 552.3335 (0.267)
Ep: 439, Reward: 925.0603, Test: 835.3914 [98.94], Avg: 552.7519 (0.267)
Ep: 440, Reward: 929.5609, Test: 815.4180 [104.83], Avg: 553.1099 (0.266)
Ep: 441, Reward: 871.1839, Test: 868.6808 [35.23], Avg: 553.7441 (0.265)
Ep: 442, Reward: 925.5862, Test: 843.6732 [90.41], Avg: 554.1945 (0.264)
Ep: 443, Reward: 926.5125, Test: 808.9234 [95.36], Avg: 554.5534 (0.263)
Ep: 444, Reward: 892.1603, Test: 820.2467 [75.85], Avg: 554.9800 (0.263)
Ep: 445, Reward: 892.9044, Test: 877.0758 [31.41], Avg: 555.6318 (0.262)
Ep: 446, Reward: 958.9678, Test: 848.8840 [20.06], Avg: 556.2430 (0.261)
Ep: 447, Reward: 879.6300, Test: 808.8053 [107.82], Avg: 556.5661 (0.260)
Ep: 448, Reward: 919.4908, Test: 849.7795 [83.55], Avg: 557.0330 (0.259)
Ep: 449, Reward: 926.1439, Test: 837.7388 [58.88], Avg: 557.5260 (0.259)
Ep: 450, Reward: 899.2137, Test: 812.0482 [105.50], Avg: 557.8564 (0.258)
Ep: 451, Reward: 880.2065, Test: 822.0002 [88.65], Avg: 558.2447 (0.257)
Ep: 452, Reward: 922.9299, Test: 865.1402 [21.06], Avg: 558.8756 (0.256)
Ep: 453, Reward: 926.4827, Test: 825.8574 [76.75], Avg: 559.2946 (0.256)
Ep: 454, Reward: 964.5105, Test: 844.4331 [58.21], Avg: 559.7934 (0.255)
Ep: 455, Reward: 852.2422, Test: 849.1944 [41.96], Avg: 560.3360 (0.254)
Ep: 456, Reward: 910.0429, Test: 825.3014 [80.19], Avg: 560.7404 (0.253)
Ep: 457, Reward: 906.3661, Test: 852.5132 [27.70], Avg: 561.3170 (0.253)
Ep: 458, Reward: 931.8556, Test: 776.2535 [146.64], Avg: 561.4658 (0.252)
Ep: 459, Reward: 883.0375, Test: 836.7663 [71.63], Avg: 561.9085 (0.251)
Ep: 460, Reward: 934.0945, Test: 829.8212 [110.23], Avg: 562.2506 (0.250)
Ep: 461, Reward: 967.3170, Test: 849.0529 [68.65], Avg: 562.7228 (0.250)
Ep: 462, Reward: 948.8285, Test: 831.3356 [77.97], Avg: 563.1345 (0.249)
Ep: 463, Reward: 944.2400, Test: 843.4784 [64.22], Avg: 563.6003 (0.248)
Ep: 464, Reward: 902.4631, Test: 805.7062 [129.84], Avg: 563.8417 (0.247)
Ep: 465, Reward: 912.0458, Test: 845.6195 [58.21], Avg: 564.3215 (0.247)
Ep: 466, Reward: 892.8060, Test: 759.1773 [146.38], Avg: 564.4253 (0.246)
Ep: 467, Reward: 920.7321, Test: 828.7873 [135.51], Avg: 564.7006 (0.245)
Ep: 468, Reward: 871.7024, Test: 866.1280 [32.86], Avg: 565.2732 (0.244)
Ep: 469, Reward: 945.4915, Test: 850.2645 [46.69], Avg: 565.7803 (0.244)
Ep: 470, Reward: 915.9439, Test: 832.0374 [73.40], Avg: 566.1897 (0.243)
Ep: 471, Reward: 945.0272, Test: 837.5576 [95.47], Avg: 566.5624 (0.242)
Ep: 472, Reward: 889.0788, Test: 843.6378 [45.43], Avg: 567.0521 (0.241)
Ep: 473, Reward: 904.8801, Test: 812.8213 [86.52], Avg: 567.3881 (0.241)
Ep: 474, Reward: 912.4731, Test: 849.5485 [69.74], Avg: 567.8353 (0.240)
Ep: 475, Reward: 946.4232, Test: 819.9543 [80.15], Avg: 568.1966 (0.239)
Ep: 476, Reward: 918.3355, Test: 750.2502 [143.96], Avg: 568.2765 (0.239)
Ep: 477, Reward: 881.2494, Test: 846.2068 [93.23], Avg: 568.6629 (0.238)
Ep: 478, Reward: 898.7367, Test: 841.5713 [86.66], Avg: 569.0517 (0.237)
Ep: 479, Reward: 893.0274, Test: 832.4568 [61.21], Avg: 569.4729 (0.236)
Ep: 480, Reward: 932.2168, Test: 838.0016 [75.90], Avg: 569.8734 (0.236)
Ep: 481, Reward: 919.9334, Test: 841.3112 [82.10], Avg: 570.2662 (0.235)
Ep: 482, Reward: 895.5420, Test: 865.0381 [76.91], Avg: 570.7173 (0.234)
Ep: 483, Reward: 908.5934, Test: 870.4691 [23.30], Avg: 571.2885 (0.234)
Ep: 484, Reward: 974.8524, Test: 844.9924 [61.03], Avg: 571.7270 (0.233)
Ep: 485, Reward: 896.9660, Test: 802.0929 [90.03], Avg: 572.0157 (0.232)
Ep: 486, Reward: 893.4366, Test: 806.6549 [165.77], Avg: 572.1571 (0.231)
Ep: 487, Reward: 914.3130, Test: 806.6219 [137.63], Avg: 572.3556 (0.231)
Ep: 488, Reward: 943.1053, Test: 865.1889 [61.31], Avg: 572.8290 (0.230)
Ep: 489, Reward: 946.2011, Test: 834.2320 [73.49], Avg: 573.2125 (0.229)
Ep: 490, Reward: 902.8739, Test: 802.1435 [110.23], Avg: 573.4543 (0.229)
Ep: 491, Reward: 935.1617, Test: 868.1863 [20.21], Avg: 574.0123 (0.228)
Ep: 492, Reward: 942.0482, Test: 850.5232 [47.64], Avg: 574.4765 (0.227)
Ep: 493, Reward: 967.7795, Test: 831.0522 [99.06], Avg: 574.7953 (0.227)
Ep: 494, Reward: 957.7012, Test: 857.1573 [60.86], Avg: 575.2428 (0.226)
Ep: 495, Reward: 926.6626, Test: 858.0229 [54.29], Avg: 575.7035 (0.225)
Ep: 496, Reward: 943.1850, Test: 828.3434 [86.42], Avg: 576.0379 (0.225)
Ep: 497, Reward: 869.8070, Test: 806.2115 [119.93], Avg: 576.2593 (0.224)
Ep: 498, Reward: 975.6518, Test: 859.5594 [66.20], Avg: 576.6944 (0.223)
Ep: 499, Reward: 913.4015, Test: 889.0517 [16.62], Avg: 577.2859 (0.223)
