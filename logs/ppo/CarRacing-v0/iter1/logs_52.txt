Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.2				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((len(self.replay_buffer)*PPO_EPOCHS)//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -56.7605, Test: -73.2384 [9.72], Avg: -82.9561 (0.997)
Ep: 1, Reward: -72.6023, Test: -67.6295 [3.67], Avg: -77.1284 (0.994)
Ep: 2, Reward: -71.1592, Test: -58.2667 [3.39], Avg: -71.9701 (0.991)
Ep: 3, Reward: -56.7683, Test: -59.6617 [17.33], Avg: -73.2247 (0.988)
Ep: 4, Reward: -63.2445, Test: -62.8606 [7.02], Avg: -72.5552 (0.985)
Ep: 5, Reward: -43.2217, Test: -62.7447 [34.87], Avg: -76.7323 (0.982)
Ep: 6, Reward: -52.0782, Test: -52.8494 [30.48], Avg: -77.6749 (0.979)
Ep: 7, Reward: 24.4295, Test: -24.3309 [24.66], Avg: -74.0895 (0.976)
Ep: 8, Reward: -40.2972, Test: -5.9683 [49.67], Avg: -72.0396 (0.973)
Ep: 9, Reward: 34.7327, Test: -38.4518 [19.78], Avg: -70.6583 (0.970)
Ep: 10, Reward: -38.6509, Test: -52.2501 [37.09], Avg: -72.3568 (0.967)
Ep: 11, Reward: -34.2002, Test: -21.5911 [31.78], Avg: -70.7745 (0.965)
Ep: 12, Reward: -13.3546, Test: -29.6932 [29.89], Avg: -69.9134 (0.962)
Ep: 13, Reward: -14.2459, Test: -1.6272 [14.16], Avg: -66.0470 (0.959)
Ep: 14, Reward: -23.6318, Test: 7.6753 [33.91], Avg: -63.3929 (0.956)
Ep: 15, Reward: 22.1677, Test: -21.8972 [35.11], Avg: -62.9940 (0.953)
Ep: 16, Reward: -18.9940, Test: -25.3756 [38.76], Avg: -63.0612 (0.950)
Ep: 17, Reward: -41.4855, Test: -34.0356 [29.08], Avg: -63.0642 (0.947)
Ep: 18, Reward: -34.8409, Test: -26.1856 [26.02], Avg: -62.4929 (0.945)
Ep: 19, Reward: -28.9986, Test: -44.5082 [21.03], Avg: -62.6453 (0.942)
Ep: 20, Reward: -22.6279, Test: -15.2964 [24.26], Avg: -61.5460 (0.939)
Ep: 21, Reward: -36.3916, Test: -43.1685 [21.70], Avg: -61.6972 (0.936)
Ep: 22, Reward: -32.7337, Test: -19.4393 [25.41], Avg: -60.9647 (0.933)
Ep: 23, Reward: 6.2127, Test: 45.8877 [58.12], Avg: -58.9343 (0.930)
Ep: 24, Reward: 36.5548, Test: 81.5024 [53.82], Avg: -55.4695 (0.928)
Ep: 25, Reward: 177.3126, Test: 45.8164 [38.46], Avg: -53.0530 (0.925)
Ep: 26, Reward: 110.8247, Test: 82.7175 [83.87], Avg: -51.1307 (0.922)
Ep: 27, Reward: 134.6476, Test: 110.3064 [97.61], Avg: -48.8512 (0.919)
Ep: 28, Reward: 135.4783, Test: 96.4465 [87.89], Avg: -46.8717 (0.917)
Ep: 29, Reward: 101.7626, Test: 51.7796 [57.12], Avg: -45.4875 (0.914)
Ep: 30, Reward: 78.5906, Test: 88.3111 [75.77], Avg: -43.6156 (0.911)
Ep: 31, Reward: 107.2764, Test: -2.3802 [37.81], Avg: -43.5085 (0.908)
Ep: 32, Reward: -8.2748, Test: -7.5301 [27.99], Avg: -43.2664 (0.906)
Ep: 33, Reward: -3.6413, Test: 29.2911 [36.69], Avg: -42.2114 (0.903)
Ep: 34, Reward: 32.1335, Test: 29.6833 [56.18], Avg: -41.7625 (0.900)
Ep: 35, Reward: 37.8745, Test: 2.6648 [29.92], Avg: -41.3594 (0.897)
Ep: 36, Reward: 41.7926, Test: 14.7668 [52.18], Avg: -41.2527 (0.895)
Ep: 37, Reward: 41.7945, Test: 162.1219 [77.13], Avg: -37.9304 (0.892)
Ep: 38, Reward: 173.8978, Test: 156.2898 [79.87], Avg: -34.9982 (0.889)
Ep: 39, Reward: 143.3978, Test: 197.4898 [76.62], Avg: -31.1016 (0.887)
Ep: 40, Reward: 194.8144, Test: 166.7578 [196.09], Avg: -31.0586 (0.884)
Ep: 41, Reward: 226.6149, Test: 333.4692 [210.60], Avg: -27.3936 (0.881)
Ep: 42, Reward: 401.2842, Test: 377.7547 [187.29], Avg: -22.3272 (0.879)
Ep: 43, Reward: 454.7327, Test: 422.2142 [285.05], Avg: -18.7025 (0.876)
Ep: 44, Reward: 538.4072, Test: 471.7293 [261.03], Avg: -13.6046 (0.874)
Ep: 45, Reward: 509.8681, Test: 288.4621 [161.84], Avg: -10.5561 (0.871)
Ep: 46, Reward: 334.7975, Test: 345.5574 [155.44], Avg: -6.2865 (0.868)
Ep: 47, Reward: 495.1009, Test: 296.7658 [270.56], Avg: -5.6096 (0.863)
Ep: 48, Reward: 377.4932, Test: 568.1464 [347.84], Avg: -0.9990 (0.861)
Ep: 49, Reward: 658.9294, Test: 729.0127 [165.45], Avg: 10.2923 (0.858)
Ep: 50, Reward: 624.9770, Test: 438.5894 [268.36], Avg: 13.4283 (0.855)
Ep: 51, Reward: 517.4524, Test: 654.0792 [136.26], Avg: 23.1280 (0.853)
Ep: 52, Reward: 584.1750, Test: 515.3394 [168.57], Avg: 29.2345 (0.850)
Ep: 53, Reward: 555.5602, Test: 588.7071 [160.26], Avg: 36.6272 (0.848)
Ep: 54, Reward: 440.7315, Test: 568.2406 [283.70], Avg: 41.1347 (0.845)
Ep: 55, Reward: 522.7179, Test: 563.4432 [243.17], Avg: 46.1193 (0.843)
Ep: 56, Reward: 620.1157, Test: 677.6880 [258.21], Avg: 52.6694 (0.840)
Ep: 57, Reward: 662.0265, Test: 551.5955 [230.71], Avg: 57.2937 (0.838)
Ep: 58, Reward: 525.1709, Test: 564.4833 [231.59], Avg: 61.9649 (0.835)
Ep: 59, Reward: 610.2063, Test: 636.3534 [224.55], Avg: 67.7956 (0.833)
Ep: 60, Reward: 609.7276, Test: 701.5076 [97.18], Avg: 76.5912 (0.830)
Ep: 61, Reward: 570.6279, Test: 557.1868 [229.03], Avg: 80.6487 (0.828)
Ep: 62, Reward: 545.5281, Test: 679.4718 [118.09], Avg: 88.2794 (0.825)
Ep: 63, Reward: 438.5912, Test: 458.6915 [231.89], Avg: 90.4438 (0.823)
Ep: 64, Reward: 459.8500, Test: 349.0531 [268.07], Avg: 90.2983 (0.820)
Ep: 65, Reward: 461.7317, Test: 350.8365 [250.66], Avg: 90.4479 (0.818)
Ep: 66, Reward: 325.5585, Test: 299.0234 [239.66], Avg: 89.9839 (0.815)
Ep: 67, Reward: 354.0598, Test: 425.3406 [175.32], Avg: 92.3375 (0.813)
Ep: 68, Reward: 529.0776, Test: 438.0552 [256.29], Avg: 93.6336 (0.810)
Ep: 69, Reward: 320.6468, Test: 384.3764 [181.18], Avg: 95.1988 (0.808)
Ep: 70, Reward: 273.6760, Test: 327.2884 [243.17], Avg: 95.0427 (0.805)
Ep: 71, Reward: 293.8338, Test: 284.9789 [210.37], Avg: 94.7589 (0.803)
Ep: 72, Reward: 318.1521, Test: 241.1642 [147.95], Avg: 94.7377 (0.801)
Ep: 73, Reward: 435.3271, Test: 527.6760 [199.90], Avg: 97.8868 (0.798)
Ep: 74, Reward: 612.7757, Test: 437.9888 [220.19], Avg: 99.4856 (0.796)
Ep: 75, Reward: 504.5077, Test: 625.6518 [293.22], Avg: 102.5507 (0.793)
Ep: 76, Reward: 624.1836, Test: 635.6064 [285.90], Avg: 105.7606 (0.791)
Ep: 77, Reward: 473.5601, Test: 451.9894 [307.96], Avg: 106.2512 (0.789)
Ep: 78, Reward: 509.2032, Test: 407.3449 [242.46], Avg: 106.9934 (0.786)
Ep: 79, Reward: 555.7978, Test: 385.3503 [241.16], Avg: 107.4583 (0.784)
Ep: 80, Reward: 250.1358, Test: 246.1415 [92.62], Avg: 108.0269 (0.782)
Ep: 81, Reward: 248.7428, Test: 172.3064 [79.00], Avg: 107.8475 (0.779)
Ep: 82, Reward: 220.4730, Test: 239.6806 [102.63], Avg: 108.1993 (0.777)
Ep: 83, Reward: 282.9797, Test: 229.6107 [124.36], Avg: 108.1642 (0.775)
Ep: 84, Reward: 234.8101, Test: 229.3788 [88.99], Avg: 108.5433 (0.772)
Ep: 85, Reward: 229.7116, Test: 158.0162 [81.13], Avg: 108.1752 (0.770)
Ep: 86, Reward: 320.3033, Test: 221.6105 [74.34], Avg: 108.6246 (0.768)
Ep: 87, Reward: 196.0499, Test: 137.3986 [134.06], Avg: 107.4282 (0.765)
Ep: 88, Reward: 229.4792, Test: 152.1034 [113.03], Avg: 106.6601 (0.763)
Ep: 89, Reward: 143.1271, Test: 219.3319 [106.93], Avg: 106.7240 (0.761)
Ep: 90, Reward: 121.1092, Test: 198.1274 [101.23], Avg: 106.6160 (0.758)
Ep: 91, Reward: 179.2617, Test: 166.1305 [137.24], Avg: 105.7712 (0.756)
Ep: 92, Reward: 160.2654, Test: 98.8194 [82.84], Avg: 104.8057 (0.754)
Ep: 93, Reward: 125.2056, Test: 76.3251 [110.24], Avg: 103.3299 (0.752)
Ep: 94, Reward: 166.2695, Test: 167.3382 [132.18], Avg: 102.6124 (0.749)
Ep: 95, Reward: 154.9319, Test: 176.9017 [104.79], Avg: 102.2946 (0.747)
Ep: 96, Reward: 166.0833, Test: 35.0503 [108.32], Avg: 100.4846 (0.745)
Ep: 97, Reward: 70.7779, Test: 146.4338 [99.85], Avg: 99.9346 (0.743)
Ep: 98, Reward: 78.5447, Test: 143.6725 [75.60], Avg: 99.6128 (0.740)
Ep: 99, Reward: 94.4285, Test: 139.0210 [130.26], Avg: 98.7043 (0.738)
Ep: 100, Reward: 163.8122, Test: 96.5122 [112.09], Avg: 97.5728 (0.736)
Ep: 101, Reward: 26.3005, Test: 244.5948 [71.34], Avg: 98.3147 (0.734)
Ep: 102, Reward: 232.9039, Test: 408.7662 [291.94], Avg: 98.4945 (0.732)
Ep: 103, Reward: 258.7848, Test: 259.6090 [115.38], Avg: 98.9342 (0.729)
Ep: 104, Reward: 302.7584, Test: 345.2163 [235.74], Avg: 99.0346 (0.727)
Ep: 105, Reward: 226.8275, Test: 145.7203 [118.11], Avg: 98.3607 (0.725)
Ep: 106, Reward: 127.5554, Test: 249.2550 [113.41], Avg: 98.7111 (0.723)
Ep: 107, Reward: 176.2032, Test: 195.2305 [134.76], Avg: 98.3570 (0.721)
Ep: 108, Reward: 168.4686, Test: 160.4502 [165.72], Avg: 97.4063 (0.719)
Ep: 109, Reward: 196.8613, Test: 245.2022 [124.28], Avg: 97.6201 (0.716)
Ep: 110, Reward: 374.5923, Test: 374.1729 [201.22], Avg: 98.2988 (0.714)
Ep: 111, Reward: 337.1394, Test: 313.1840 [174.96], Avg: 98.6553 (0.712)
Ep: 112, Reward: 278.7969, Test: 327.1101 [195.69], Avg: 98.9452 (0.710)
Ep: 113, Reward: 336.7058, Test: 357.9192 [146.25], Avg: 99.9340 (0.708)
Ep: 114, Reward: 254.2254, Test: 251.3661 [71.67], Avg: 100.6276 (0.706)
Ep: 115, Reward: 249.8572, Test: 206.3473 [86.99], Avg: 100.7890 (0.704)
Ep: 116, Reward: 231.9021, Test: 174.2046 [104.82], Avg: 100.5206 (0.702)
Ep: 117, Reward: 173.1613, Test: 190.9713 [85.03], Avg: 100.5665 (0.699)
Ep: 118, Reward: 210.6583, Test: 209.2686 [109.22], Avg: 100.5622 (0.697)
Ep: 119, Reward: 190.4677, Test: 191.9984 [93.34], Avg: 100.5463 (0.695)
Ep: 120, Reward: 200.6931, Test: 220.0794 [78.49], Avg: 100.8855 (0.693)
Ep: 121, Reward: 169.8230, Test: 206.6939 [83.82], Avg: 101.0657 (0.691)
Ep: 122, Reward: 221.7563, Test: 223.7879 [85.93], Avg: 101.3649 (0.689)
Ep: 123, Reward: 209.1280, Test: 185.8188 [96.48], Avg: 101.2679 (0.687)
Ep: 124, Reward: 240.6227, Test: 211.8216 [119.53], Avg: 101.1961 (0.685)
Ep: 125, Reward: 198.3853, Test: 230.6934 [110.11], Avg: 101.3499 (0.683)
Ep: 126, Reward: 156.4250, Test: 210.2043 [152.78], Avg: 101.0041 (0.681)
Ep: 127, Reward: 223.3521, Test: 272.6584 [149.30], Avg: 101.1787 (0.679)
Ep: 128, Reward: 227.2530, Test: 326.9090 [99.55], Avg: 102.1568 (0.677)
Ep: 129, Reward: 305.0049, Test: 401.7456 [228.02], Avg: 102.7073 (0.675)
Ep: 130, Reward: 408.1385, Test: 250.5668 [119.53], Avg: 102.9236 (0.673)
Ep: 131, Reward: 350.3228, Test: 507.3211 [332.51], Avg: 103.4682 (0.671)
Ep: 132, Reward: 292.9462, Test: 599.5434 [297.03], Avg: 104.9648 (0.669)
Ep: 133, Reward: 358.6851, Test: 480.8788 [180.41], Avg: 106.4238 (0.667)
Ep: 134, Reward: 451.9117, Test: 385.7200 [242.79], Avg: 106.6942 (0.665)
Ep: 135, Reward: 568.4968, Test: 443.2160 [237.77], Avg: 107.4203 (0.663)
Ep: 136, Reward: 382.0198, Test: 432.3286 [310.92], Avg: 107.5224 (0.661)
Ep: 137, Reward: 403.3981, Test: 281.0010 [144.27], Avg: 107.7341 (0.659)
Ep: 138, Reward: 332.3495, Test: 359.2560 [167.70], Avg: 108.3371 (0.657)
Ep: 139, Reward: 340.3930, Test: 266.7041 [162.39], Avg: 108.3084 (0.655)
Ep: 140, Reward: 400.1631, Test: 539.7975 [167.06], Avg: 110.1838 (0.653)
Ep: 141, Reward: 336.8963, Test: 295.5317 [231.81], Avg: 109.8566 (0.651)
Ep: 142, Reward: 341.6360, Test: 248.6432 [102.02], Avg: 110.1137 (0.649)
Ep: 143, Reward: 319.4357, Test: 253.8615 [91.28], Avg: 110.4780 (0.647)
Ep: 144, Reward: 195.5472, Test: 360.5654 [229.22], Avg: 110.6220 (0.645)
Ep: 145, Reward: 254.9310, Test: 490.6848 [297.91], Avg: 111.1846 (0.643)
Ep: 146, Reward: 357.3007, Test: 356.3851 [206.99], Avg: 111.4445 (0.641)
Ep: 147, Reward: 384.6625, Test: 438.4344 [223.98], Avg: 112.1406 (0.639)
Ep: 148, Reward: 315.9950, Test: 477.3898 [257.15], Avg: 112.8661 (0.637)
Ep: 149, Reward: 553.5466, Test: 549.6492 [283.11], Avg: 113.8906 (0.635)
Ep: 150, Reward: 463.4197, Test: 414.1820 [303.46], Avg: 113.8696 (0.633)
Ep: 151, Reward: 537.2837, Test: 404.2537 [201.59], Avg: 114.4538 (0.631)
Ep: 152, Reward: 496.5429, Test: 289.0387 [226.19], Avg: 114.1165 (0.630)
Ep: 153, Reward: 291.7306, Test: 358.1771 [228.41], Avg: 114.2182 (0.628)
Ep: 154, Reward: 326.8194, Test: 313.8378 [241.68], Avg: 113.9468 (0.626)
Ep: 155, Reward: 315.0587, Test: 532.3617 [213.69], Avg: 115.2591 (0.624)
Ep: 156, Reward: 285.4263, Test: 658.8976 [255.15], Avg: 117.0966 (0.622)
Ep: 157, Reward: 692.0828, Test: 523.6057 [292.00], Avg: 117.8214 (0.620)
Ep: 158, Reward: 580.2206, Test: 602.9309 [313.63], Avg: 118.8999 (0.618)
Ep: 159, Reward: 565.5860, Test: 611.0025 [229.22], Avg: 120.5429 (0.616)
Ep: 160, Reward: 524.6976, Test: 588.1351 [272.28], Avg: 121.7561 (0.615)
Ep: 161, Reward: 615.4667, Test: 553.0927 [229.82], Avg: 123.0000 (0.613)
Ep: 162, Reward: 680.5009, Test: 603.2431 [311.42], Avg: 124.0357 (0.611)
Ep: 163, Reward: 9.8533, Test: 59.1728 [158.51], Avg: 122.6737 (0.609)
Ep: 164, Reward: 60.0688, Test: 37.1066 [69.05], Avg: 121.7366 (0.607)
Ep: 165, Reward: 161.5254, Test: 126.0744 [160.47], Avg: 120.7960 (0.605)
Ep: 166, Reward: 168.5376, Test: 365.0624 [247.73], Avg: 120.7753 (0.604)
Ep: 167, Reward: 277.9386, Test: 427.8140 [238.85], Avg: 121.1812 (0.602)
Ep: 168, Reward: 423.9467, Test: 474.2129 [263.71], Avg: 121.7097 (0.600)
Ep: 169, Reward: 532.3916, Test: 595.4236 [311.71], Avg: 122.6627 (0.598)
Ep: 170, Reward: 532.2586, Test: 386.2647 [248.13], Avg: 122.7531 (0.596)
Ep: 171, Reward: 433.8381, Test: 475.8929 [206.31], Avg: 123.6068 (0.595)
Ep: 172, Reward: 354.8778, Test: 488.1897 [341.51], Avg: 123.7402 (0.593)
Ep: 173, Reward: 290.9712, Test: 277.6702 [238.28], Avg: 123.2554 (0.591)
Ep: 174, Reward: 226.1801, Test: 110.2658 [126.63], Avg: 122.4576 (0.589)
Ep: 175, Reward: 133.6477, Test: 322.7436 [264.42], Avg: 122.0932 (0.588)
Ep: 176, Reward: 366.5863, Test: 529.9589 [305.99], Avg: 122.6687 (0.586)
Ep: 177, Reward: 432.6236, Test: 229.5304 [189.23], Avg: 122.2060 (0.584)
Ep: 178, Reward: 236.4151, Test: 411.1596 [343.18], Avg: 121.9031 (0.582)
Ep: 179, Reward: 308.6429, Test: 429.0620 [220.98], Avg: 122.3818 (0.581)
Ep: 180, Reward: 365.9003, Test: 215.0672 [260.42], Avg: 121.4551 (0.579)
Ep: 181, Reward: 70.8022, Test: 125.9791 [133.87], Avg: 120.7444 (0.577)
Ep: 182, Reward: 115.3689, Test: 268.8857 [231.06], Avg: 120.2913 (0.575)
Ep: 183, Reward: 231.1842, Test: 380.9712 [219.22], Avg: 120.5166 (0.574)
Ep: 184, Reward: 246.4862, Test: 492.7081 [265.13], Avg: 121.0953 (0.572)
Ep: 185, Reward: 311.1522, Test: 312.7718 [288.63], Avg: 120.5741 (0.570)
Ep: 186, Reward: 315.6285, Test: 126.3231 [175.20], Avg: 119.6679 (0.568)
Ep: 187, Reward: 231.5043, Test: 360.2621 [318.31], Avg: 119.2545 (0.567)
Ep: 188, Reward: 364.8854, Test: 219.9289 [169.86], Avg: 118.8884 (0.565)
Ep: 189, Reward: 236.9558, Test: 158.5212 [174.49], Avg: 118.1787 (0.563)
Ep: 190, Reward: 236.2880, Test: 210.0285 [196.15], Avg: 117.6326 (0.562)
Ep: 191, Reward: 240.2156, Test: 311.6168 [216.57], Avg: 117.5150 (0.560)
Ep: 192, Reward: 322.0089, Test: 400.4863 [173.86], Avg: 118.0803 (0.558)
Ep: 193, Reward: 311.3748, Test: 215.2873 [249.26], Avg: 117.2966 (0.557)
Ep: 194, Reward: 423.3571, Test: 254.0443 [220.67], Avg: 116.8662 (0.555)
Ep: 195, Reward: 260.5467, Test: 522.8012 [230.49], Avg: 117.7614 (0.553)
Ep: 196, Reward: 403.2967, Test: 161.9361 [150.54], Avg: 117.2215 (0.552)
Ep: 197, Reward: 259.0510, Test: 397.0062 [183.50], Avg: 117.7077 (0.550)
Ep: 198, Reward: 283.7624, Test: 447.6349 [249.62], Avg: 118.1113 (0.548)
Ep: 199, Reward: 397.0219, Test: 467.4747 [263.06], Avg: 118.5428 (0.547)
Ep: 200, Reward: 523.4108, Test: 219.4662 [210.55], Avg: 117.9974 (0.545)
Ep: 201, Reward: 313.4605, Test: 326.1217 [250.61], Avg: 117.7871 (0.543)
Ep: 202, Reward: 355.9523, Test: 390.9116 [290.73], Avg: 117.7004 (0.542)
Ep: 203, Reward: 298.9947, Test: 321.3710 [99.00], Avg: 118.2134 (0.540)
Ep: 204, Reward: 326.8271, Test: 320.7995 [121.67], Avg: 118.6082 (0.539)
Ep: 205, Reward: 315.4512, Test: 164.3773 [164.74], Avg: 118.0306 (0.537)
Ep: 206, Reward: 398.8812, Test: 413.5097 [334.42], Avg: 117.8425 (0.535)
Ep: 207, Reward: 378.3143, Test: 376.9867 [308.04], Avg: 117.6074 (0.534)
Ep: 208, Reward: 399.3223, Test: 334.3058 [217.40], Avg: 117.6041 (0.532)
Ep: 209, Reward: 407.9876, Test: 279.7990 [138.51], Avg: 117.7169 (0.530)
Ep: 210, Reward: 430.0863, Test: 310.9500 [227.41], Avg: 117.5549 (0.529)
Ep: 211, Reward: 323.0407, Test: 247.0625 [184.10], Avg: 117.2974 (0.527)
Ep: 212, Reward: 389.0990, Test: 375.0140 [261.14], Avg: 117.2813 (0.526)
Ep: 213, Reward: 472.6897, Test: 349.7324 [280.16], Avg: 117.0584 (0.524)
Ep: 214, Reward: 419.8889, Test: 289.6569 [265.57], Avg: 116.6259 (0.523)
Ep: 215, Reward: 456.0992, Test: 347.2208 [195.29], Avg: 116.7893 (0.521)
Ep: 216, Reward: 499.6517, Test: 290.4990 [238.51], Avg: 116.4907 (0.519)
Ep: 217, Reward: 423.8753, Test: 389.4826 [233.43], Avg: 116.6722 (0.518)
Ep: 218, Reward: 340.9009, Test: 225.4913 [241.43], Avg: 116.0667 (0.516)
Ep: 219, Reward: 480.7374, Test: 448.2432 [345.68], Avg: 116.0053 (0.515)
Ep: 220, Reward: 447.6542, Test: 529.9315 [276.37], Avg: 116.6277 (0.513)
Ep: 221, Reward: 441.5350, Test: 363.4676 [346.92], Avg: 116.1769 (0.512)
Ep: 222, Reward: 379.1624, Test: 317.2301 [232.96], Avg: 116.0338 (0.510)
Ep: 223, Reward: 395.5190, Test: 478.6984 [245.73], Avg: 116.5559 (0.509)
Ep: 224, Reward: 386.3786, Test: 507.9821 [259.35], Avg: 117.1429 (0.507)
Ep: 225, Reward: 361.0106, Test: 521.0935 [300.00], Avg: 117.6028 (0.506)
Ep: 226, Reward: 490.1592, Test: 469.0965 [332.79], Avg: 117.6852 (0.504)
Ep: 227, Reward: 429.4868, Test: 332.9897 [256.83], Avg: 117.5031 (0.503)
Ep: 228, Reward: 417.3278, Test: 275.5152 [259.91], Avg: 117.0581 (0.501)
Ep: 229, Reward: 373.0086, Test: 357.8081 [276.90], Avg: 116.9009 (0.500)
Ep: 230, Reward: 286.9798, Test: 350.1560 [270.13], Avg: 116.7413 (0.498)
Ep: 231, Reward: 496.0664, Test: 453.2357 [209.07], Avg: 117.2905 (0.497)
Ep: 232, Reward: 501.0564, Test: 453.9590 [235.71], Avg: 117.7238 (0.495)
Ep: 233, Reward: 402.8020, Test: 645.0447 [273.47], Avg: 118.8086 (0.494)
Ep: 234, Reward: 408.9780, Test: 276.7584 [259.13], Avg: 118.3781 (0.492)
Ep: 235, Reward: 387.6328, Test: 511.0840 [309.35], Avg: 118.7313 (0.491)
Ep: 236, Reward: 480.2368, Test: 475.3069 [240.32], Avg: 119.2218 (0.489)
Ep: 237, Reward: 469.3841, Test: 515.4927 [338.76], Avg: 119.4635 (0.488)
Ep: 238, Reward: 496.7989, Test: 410.8056 [339.56], Avg: 119.2618 (0.486)
Ep: 239, Reward: 426.3242, Test: 628.5666 [198.16], Avg: 120.5582 (0.485)
Ep: 240, Reward: 420.6358, Test: 453.5866 [342.01], Avg: 120.5209 (0.483)
Ep: 241, Reward: 442.6559, Test: 578.8127 [318.92], Avg: 121.0968 (0.482)
Ep: 242, Reward: 485.6857, Test: 409.9312 [255.48], Avg: 121.2341 (0.480)
Ep: 243, Reward: 644.3014, Test: 543.8484 [301.37], Avg: 121.7310 (0.479)
Ep: 244, Reward: 583.4935, Test: 599.2377 [254.62], Avg: 122.6407 (0.478)
Ep: 245, Reward: 756.9314, Test: 703.1848 [155.92], Avg: 124.3668 (0.476)
Ep: 246, Reward: 546.7973, Test: 526.2799 [310.14], Avg: 124.7384 (0.475)
Ep: 247, Reward: 681.6792, Test: 658.1268 [287.94], Avg: 125.7281 (0.473)
Ep: 248, Reward: 516.8478, Test: 756.3904 [251.14], Avg: 127.2523 (0.472)
Ep: 249, Reward: 571.5648, Test: 610.9211 [306.81], Avg: 127.9597 (0.470)
Ep: 250, Reward: 530.0018, Test: 566.2916 [290.46], Avg: 128.5489 (0.469)
Ep: 251, Reward: 647.2964, Test: 662.7090 [255.11], Avg: 129.6562 (0.468)
Ep: 252, Reward: 734.9634, Test: 735.4550 [175.38], Avg: 131.3575 (0.466)
Ep: 253, Reward: 630.6744, Test: 553.2995 [286.01], Avg: 131.8926 (0.465)
Ep: 254, Reward: 701.4741, Test: 441.6686 [326.14], Avg: 131.8285 (0.463)
Ep: 255, Reward: 803.0377, Test: 472.8049 [340.10], Avg: 131.8319 (0.462)
Ep: 256, Reward: 507.5166, Test: 635.6436 [204.70], Avg: 132.9957 (0.461)
Ep: 257, Reward: 567.7497, Test: 431.2894 [292.53], Avg: 133.0181 (0.459)
Ep: 258, Reward: 581.2423, Test: 293.3885 [232.07], Avg: 132.7412 (0.458)
Ep: 259, Reward: 396.2778, Test: 483.7098 [290.95], Avg: 132.9721 (0.456)
Ep: 260, Reward: 557.6708, Test: 425.1625 [306.69], Avg: 132.9165 (0.455)
Ep: 261, Reward: 493.5557, Test: 582.2795 [266.10], Avg: 133.6160 (0.454)
Ep: 262, Reward: 487.4367, Test: 515.2344 [306.78], Avg: 133.9006 (0.452)
Ep: 263, Reward: 608.1979, Test: 356.6827 [311.35], Avg: 133.5651 (0.451)
Ep: 264, Reward: 678.6828, Test: 500.2213 [325.29], Avg: 133.7212 (0.450)
Ep: 265, Reward: 559.7037, Test: 582.0226 [218.54], Avg: 134.5850 (0.448)
Ep: 266, Reward: 651.9666, Test: 724.4986 [145.15], Avg: 136.2508 (0.447)
Ep: 267, Reward: 321.0278, Test: 449.3356 [349.37], Avg: 136.1154 (0.446)
Ep: 268, Reward: 673.3645, Test: 578.8307 [199.40], Avg: 137.0199 (0.444)
Ep: 269, Reward: 394.3680, Test: 531.8379 [304.99], Avg: 137.3526 (0.443)
Ep: 270, Reward: 442.1985, Test: 740.7137 [224.54], Avg: 138.7505 (0.442)
Ep: 271, Reward: 625.8720, Test: 578.3148 [349.41], Avg: 139.0819 (0.440)
Ep: 272, Reward: 566.7073, Test: 505.1799 [271.52], Avg: 139.4284 (0.439)
Ep: 273, Reward: 573.7292, Test: 430.6829 [252.00], Avg: 139.5717 (0.438)
Ep: 274, Reward: 679.2860, Test: 557.9991 [276.28], Avg: 140.0886 (0.436)
Ep: 275, Reward: 582.9860, Test: 528.5332 [305.78], Avg: 140.3881 (0.435)
Ep: 276, Reward: 553.4889, Test: 548.2692 [303.48], Avg: 140.7649 (0.434)
Ep: 277, Reward: 585.8701, Test: 516.4472 [286.37], Avg: 141.0862 (0.432)
Ep: 278, Reward: 550.4368, Test: 594.4929 [199.06], Avg: 141.9978 (0.431)
Ep: 279, Reward: 688.9266, Test: 492.3101 [341.71], Avg: 142.0286 (0.430)
Ep: 280, Reward: 491.3763, Test: 475.4806 [315.49], Avg: 142.0925 (0.429)
Ep: 281, Reward: 532.8228, Test: 560.2409 [281.82], Avg: 142.5759 (0.427)
Ep: 282, Reward: 440.1127, Test: 635.2417 [240.87], Avg: 143.4657 (0.426)
Ep: 283, Reward: 318.8719, Test: 430.8032 [307.50], Avg: 143.3947 (0.425)
Ep: 284, Reward: 380.5237, Test: 343.9790 [316.82], Avg: 142.9868 (0.423)
Ep: 285, Reward: 348.2025, Test: 465.5897 [289.26], Avg: 143.1034 (0.422)
Ep: 286, Reward: 379.7199, Test: 423.8027 [334.96], Avg: 142.9144 (0.421)
Ep: 287, Reward: 393.2634, Test: 547.8611 [336.94], Avg: 143.1505 (0.420)
Ep: 288, Reward: 347.2044, Test: 472.4262 [308.44], Avg: 143.2226 (0.418)
Ep: 289, Reward: 521.6389, Test: 471.7793 [336.05], Avg: 143.1967 (0.417)
Ep: 290, Reward: 521.0364, Test: 431.5704 [273.81], Avg: 143.2468 (0.416)
Ep: 291, Reward: 420.6853, Test: 256.2375 [310.09], Avg: 142.5718 (0.415)
Ep: 292, Reward: 335.3319, Test: 215.7870 [208.49], Avg: 142.1101 (0.413)
Ep: 293, Reward: 457.1878, Test: 505.3581 [292.10], Avg: 142.3521 (0.412)
Ep: 294, Reward: 337.0868, Test: 565.9545 [213.22], Avg: 143.0652 (0.411)
Ep: 295, Reward: 325.8179, Test: 425.6393 [226.48], Avg: 143.2547 (0.410)
Ep: 296, Reward: 414.9533, Test: 425.3650 [292.30], Avg: 143.2204 (0.408)
Ep: 297, Reward: 415.6274, Test: 225.8045 [187.53], Avg: 142.8683 (0.407)
Ep: 298, Reward: 366.9323, Test: 369.4787 [178.22], Avg: 143.0301 (0.406)
Ep: 299, Reward: 371.1146, Test: 528.3778 [264.48], Avg: 143.4330 (0.405)
Ep: 300, Reward: 353.3589, Test: 426.9523 [278.49], Avg: 143.4497 (0.404)
Ep: 301, Reward: 403.7780, Test: 656.6375 [275.77], Avg: 144.2359 (0.402)
Ep: 302, Reward: 391.7590, Test: 544.7048 [283.95], Avg: 144.6204 (0.401)
Ep: 303, Reward: 440.3480, Test: 435.3265 [232.49], Avg: 144.8119 (0.400)
Ep: 304, Reward: 498.0311, Test: 488.6504 [397.73], Avg: 144.6352 (0.399)
Ep: 305, Reward: 635.7050, Test: 325.3584 [166.15], Avg: 144.6828 (0.398)
Ep: 306, Reward: 286.9980, Test: 237.8596 [319.10], Avg: 143.9469 (0.396)
Ep: 307, Reward: 345.9170, Test: 229.9424 [207.83], Avg: 143.5513 (0.395)
Ep: 308, Reward: 247.0418, Test: 329.4812 [302.72], Avg: 143.1734 (0.394)
Ep: 309, Reward: 372.2540, Test: 262.5355 [235.05], Avg: 142.8002 (0.393)
Ep: 310, Reward: 348.0694, Test: 172.5463 [136.40], Avg: 142.4573 (0.392)
Ep: 311, Reward: 167.6424, Test: 294.8487 [229.73], Avg: 142.2094 (0.390)
Ep: 312, Reward: 245.3927, Test: 336.9239 [184.45], Avg: 142.2422 (0.389)
Ep: 313, Reward: 396.8183, Test: 264.8061 [223.66], Avg: 141.9202 (0.388)
Ep: 314, Reward: 359.2616, Test: 297.8146 [231.44], Avg: 141.6804 (0.387)
Ep: 315, Reward: 315.4991, Test: 278.4407 [210.40], Avg: 141.4473 (0.386)
Ep: 316, Reward: 361.5041, Test: 326.7915 [322.98], Avg: 141.0131 (0.385)
Ep: 317, Reward: 342.1535, Test: 395.7440 [306.54], Avg: 140.8502 (0.383)
Ep: 318, Reward: 580.7679, Test: 481.9851 [350.56], Avg: 140.8207 (0.382)
Ep: 319, Reward: 339.9309, Test: 457.2317 [285.74], Avg: 140.9165 (0.381)
Ep: 320, Reward: 478.5758, Test: 451.9657 [320.12], Avg: 140.8883 (0.380)
Ep: 321, Reward: 398.6467, Test: 367.5494 [335.96], Avg: 140.5488 (0.379)
Ep: 322, Reward: 436.0099, Test: 441.2074 [270.66], Avg: 140.6417 (0.378)
Ep: 323, Reward: 359.6520, Test: 428.9220 [274.84], Avg: 140.6832 (0.377)
Ep: 324, Reward: 524.2282, Test: 440.6341 [259.55], Avg: 140.8075 (0.376)
Ep: 325, Reward: 555.4289, Test: 393.7758 [296.32], Avg: 140.6745 (0.374)
Ep: 326, Reward: 430.9461, Test: 380.9464 [235.04], Avg: 140.6905 (0.373)
Ep: 327, Reward: 373.5172, Test: 458.6703 [290.88], Avg: 140.7731 (0.372)
Ep: 328, Reward: 520.6468, Test: 449.6391 [264.79], Avg: 140.9071 (0.371)
Ep: 329, Reward: 436.9850, Test: 386.4825 [295.12], Avg: 140.7569 (0.370)
Ep: 330, Reward: 440.6528, Test: 484.4119 [273.47], Avg: 140.9690 (0.369)
Ep: 331, Reward: 633.1149, Test: 466.7080 [258.84], Avg: 141.1705 (0.368)
Ep: 332, Reward: 538.4014, Test: 471.0921 [264.79], Avg: 141.3661 (0.367)
Ep: 333, Reward: 393.3334, Test: 684.7661 [260.52], Avg: 142.2130 (0.365)
Ep: 334, Reward: 541.8553, Test: 571.2461 [297.62], Avg: 142.6053 (0.364)
Ep: 335, Reward: 620.6970, Test: 584.9577 [312.00], Avg: 142.9932 (0.363)
Ep: 336, Reward: 615.8001, Test: 525.8109 [268.86], Avg: 143.3314 (0.362)
Ep: 337, Reward: 406.2305, Test: 312.1378 [278.18], Avg: 143.0078 (0.361)
Ep: 338, Reward: 264.9465, Test: 251.8331 [191.75], Avg: 142.7632 (0.360)
Ep: 339, Reward: 322.1791, Test: 538.8609 [245.98], Avg: 143.2047 (0.359)
Ep: 340, Reward: 497.8960, Test: 375.0809 [258.20], Avg: 143.1275 (0.358)
Ep: 341, Reward: 380.3083, Test: 640.7261 [291.57], Avg: 143.7299 (0.357)
Ep: 342, Reward: 646.0202, Test: 543.3362 [292.53], Avg: 144.0421 (0.356)
Ep: 343, Reward: 698.5799, Test: 525.5765 [340.91], Avg: 144.1602 (0.355)
Ep: 344, Reward: 473.8488, Test: 642.3296 [244.03], Avg: 144.8968 (0.354)
Ep: 345, Reward: 684.9636, Test: 793.0254 [158.43], Avg: 146.3121 (0.353)
Ep: 346, Reward: 624.8247, Test: 584.2622 [336.41], Avg: 146.6048 (0.351)
Ep: 347, Reward: 739.5432, Test: 403.7505 [313.37], Avg: 146.4432 (0.350)
Ep: 348, Reward: 518.8349, Test: 503.8726 [274.35], Avg: 146.6813 (0.349)
Ep: 349, Reward: 449.9886, Test: 495.3495 [279.78], Avg: 146.8781 (0.348)
Ep: 350, Reward: 521.7507, Test: 538.6236 [367.78], Avg: 146.9464 (0.347)
Ep: 351, Reward: 447.5159, Test: 549.3856 [287.53], Avg: 147.2728 (0.346)
Ep: 352, Reward: 444.7271, Test: 465.7711 [344.19], Avg: 147.2001 (0.345)
Ep: 353, Reward: 646.3493, Test: 553.4797 [254.61], Avg: 147.6285 (0.344)
Ep: 354, Reward: 573.0930, Test: 224.2360 [257.64], Avg: 147.1186 (0.343)
Ep: 355, Reward: 502.4620, Test: 621.6211 [217.94], Avg: 147.8392 (0.342)
Ep: 356, Reward: 430.2910, Test: 497.1040 [322.84], Avg: 147.9133 (0.341)
Ep: 357, Reward: 509.4494, Test: 552.2117 [237.38], Avg: 148.3795 (0.340)
Ep: 358, Reward: 527.8712, Test: 338.2084 [249.31], Avg: 148.2139 (0.339)
Ep: 359, Reward: 465.5400, Test: 575.1554 [294.35], Avg: 148.5822 (0.338)
Ep: 360, Reward: 520.7929, Test: 458.4134 [321.00], Avg: 148.5512 (0.337)
Ep: 361, Reward: 433.4563, Test: 486.9447 [327.30], Avg: 148.5819 (0.336)
Ep: 362, Reward: 587.0807, Test: 416.3277 [334.90], Avg: 148.3969 (0.335)
Ep: 363, Reward: 532.6784, Test: 482.5579 [353.72], Avg: 148.3431 (0.334)
Ep: 364, Reward: 472.4238, Test: 602.1903 [322.79], Avg: 148.7022 (0.333)
Ep: 365, Reward: 474.9769, Test: 555.1462 [354.76], Avg: 148.8434 (0.332)
Ep: 366, Reward: 645.2247, Test: 378.3749 [272.17], Avg: 148.7272 (0.331)
Ep: 367, Reward: 539.5477, Test: 439.5159 [278.92], Avg: 148.7595 (0.330)
Ep: 368, Reward: 540.9122, Test: 610.6635 [306.83], Avg: 149.1797 (0.329)
Ep: 369, Reward: 457.5590, Test: 598.2408 [296.19], Avg: 149.5929 (0.328)
Ep: 370, Reward: 462.5728, Test: 444.5034 [289.82], Avg: 149.6066 (0.327)
Ep: 371, Reward: 567.6262, Test: 440.5089 [261.57], Avg: 149.6854 (0.326)
Ep: 372, Reward: 684.0873, Test: 478.5237 [246.26], Avg: 149.9068 (0.325)
Ep: 373, Reward: 576.2839, Test: 574.2010 [323.35], Avg: 150.1767 (0.324)
Ep: 374, Reward: 655.3599, Test: 578.1269 [187.07], Avg: 150.8191 (0.323)
Ep: 375, Reward: 520.4811, Test: 462.0599 [287.99], Avg: 150.8809 (0.322)
Ep: 376, Reward: 608.6975, Test: 593.7180 [312.59], Avg: 151.2264 (0.321)
Ep: 377, Reward: 507.5911, Test: 290.2531 [192.07], Avg: 151.0861 (0.320)
Ep: 378, Reward: 579.8596, Test: 461.3333 [295.77], Avg: 151.1243 (0.319)
Ep: 379, Reward: 636.6659, Test: 466.4955 [295.03], Avg: 151.1778 (0.318)
Ep: 380, Reward: 666.8916, Test: 656.3103 [207.59], Avg: 151.9587 (0.317)
Ep: 381, Reward: 464.0692, Test: 525.9374 [307.58], Avg: 152.1326 (0.316)
Ep: 382, Reward: 602.4171, Test: 487.6925 [344.08], Avg: 152.1103 (0.315)
Ep: 383, Reward: 632.2317, Test: 571.4732 [214.09], Avg: 152.6449 (0.315)
Ep: 384, Reward: 546.5885, Test: 532.3974 [317.92], Avg: 152.8055 (0.314)
Ep: 385, Reward: 496.6001, Test: 466.1237 [309.74], Avg: 152.8148 (0.313)
Ep: 386, Reward: 578.7747, Test: 390.1650 [298.36], Avg: 152.6571 (0.312)
Ep: 387, Reward: 532.8200, Test: 438.4101 [330.08], Avg: 152.5429 (0.311)
Ep: 388, Reward: 463.4053, Test: 520.3123 [303.23], Avg: 152.7088 (0.310)
Ep: 389, Reward: 518.3173, Test: 612.6481 [280.92], Avg: 153.1678 (0.309)
Ep: 390, Reward: 598.7660, Test: 614.8034 [273.70], Avg: 153.6485 (0.308)
Ep: 391, Reward: 612.3759, Test: 445.3599 [305.33], Avg: 153.6137 (0.307)
Ep: 392, Reward: 539.2064, Test: 571.9153 [336.62], Avg: 153.8216 (0.306)
Ep: 393, Reward: 615.3279, Test: 458.1896 [317.94], Avg: 153.7871 (0.305)
Ep: 394, Reward: 601.7431, Test: 576.7362 [296.77], Avg: 154.1065 (0.304)
Ep: 395, Reward: 709.8099, Test: 336.4917 [344.34], Avg: 153.6976 (0.303)
Ep: 396, Reward: 710.4844, Test: 678.4762 [343.38], Avg: 154.1545 (0.302)
Ep: 397, Reward: 634.5787, Test: 501.3369 [330.08], Avg: 154.1975 (0.302)
Ep: 398, Reward: 536.7779, Test: 483.9860 [388.33], Avg: 154.0507 (0.301)
Ep: 399, Reward: 595.3779, Test: 623.6164 [287.70], Avg: 154.5054 (0.300)
Ep: 400, Reward: 657.4314, Test: 634.8423 [292.91], Avg: 154.9728 (0.299)
Ep: 401, Reward: 633.0375, Test: 612.1354 [344.99], Avg: 155.2518 (0.298)
Ep: 402, Reward: 643.6636, Test: 483.2524 [340.12], Avg: 155.2218 (0.297)
Ep: 403, Reward: 677.0924, Test: 442.5265 [355.28], Avg: 155.0535 (0.296)
Ep: 404, Reward: 599.1157, Test: 574.5812 [276.06], Avg: 155.4077 (0.295)
Ep: 405, Reward: 721.7286, Test: 469.7374 [242.96], Avg: 155.5835 (0.294)
Ep: 406, Reward: 595.6982, Test: 689.1683 [248.53], Avg: 156.2839 (0.294)
Ep: 407, Reward: 515.9278, Test: 482.7596 [329.10], Avg: 156.2775 (0.293)
Ep: 408, Reward: 684.4977, Test: 717.9183 [205.16], Avg: 157.1491 (0.292)
Ep: 409, Reward: 631.9693, Test: 662.3516 [257.78], Avg: 157.7525 (0.291)
Ep: 410, Reward: 639.9721, Test: 622.5717 [282.52], Avg: 158.1961 (0.290)
Ep: 411, Reward: 490.1309, Test: 522.5470 [359.42], Avg: 158.2081 (0.289)
Ep: 412, Reward: 721.1656, Test: 582.6648 [317.95], Avg: 158.4659 (0.288)
Ep: 413, Reward: 588.0210, Test: 551.1258 [305.03], Avg: 158.6776 (0.287)
Ep: 414, Reward: 623.6621, Test: 616.3829 [330.56], Avg: 158.9840 (0.287)
Ep: 415, Reward: 660.3437, Test: 341.0536 [331.20], Avg: 158.6255 (0.286)
Ep: 416, Reward: 634.9091, Test: 666.0797 [319.11], Avg: 159.0772 (0.285)
Ep: 417, Reward: 534.7596, Test: 411.3087 [333.89], Avg: 158.8818 (0.284)
Ep: 418, Reward: 456.3611, Test: 611.7622 [262.87], Avg: 159.3353 (0.283)
Ep: 419, Reward: 595.8581, Test: 290.5730 [300.44], Avg: 158.9324 (0.282)
Ep: 420, Reward: 599.1899, Test: 440.7796 [338.59], Avg: 158.7977 (0.281)
Ep: 421, Reward: 636.6150, Test: 547.2330 [293.41], Avg: 159.0228 (0.281)
Ep: 422, Reward: 576.2720, Test: 545.9323 [266.66], Avg: 159.3071 (0.280)
Ep: 423, Reward: 553.3396, Test: 439.3400 [301.53], Avg: 159.2564 (0.279)
Ep: 424, Reward: 491.1260, Test: 566.4444 [269.44], Avg: 159.5805 (0.278)
Ep: 425, Reward: 449.6338, Test: 478.4571 [349.46], Avg: 159.5087 (0.277)
Ep: 426, Reward: 501.8748, Test: 624.2702 [306.95], Avg: 159.8783 (0.276)
Ep: 427, Reward: 498.6759, Test: 487.0607 [355.11], Avg: 159.8130 (0.276)
Ep: 428, Reward: 537.8002, Test: 611.6241 [329.82], Avg: 160.0974 (0.275)
Ep: 429, Reward: 523.6003, Test: 523.5652 [372.87], Avg: 160.0755 (0.274)
Ep: 430, Reward: 541.7850, Test: 438.4502 [379.94], Avg: 159.8399 (0.273)
Ep: 431, Reward: 417.5517, Test: 415.4318 [329.03], Avg: 159.6699 (0.272)
Ep: 432, Reward: 574.8008, Test: 393.9134 [322.95], Avg: 159.4650 (0.271)
Ep: 433, Reward: 456.2403, Test: 558.9237 [352.51], Avg: 159.5732 (0.271)
Ep: 434, Reward: 523.9397, Test: 608.2443 [236.85], Avg: 160.0601 (0.270)
Ep: 435, Reward: 623.7410, Test: 494.5672 [298.48], Avg: 160.1428 (0.269)
Ep: 436, Reward: 676.0851, Test: 516.9071 [305.79], Avg: 160.2594 (0.268)
Ep: 437, Reward: 684.4616, Test: 574.8686 [252.56], Avg: 160.6294 (0.267)
Ep: 438, Reward: 520.6286, Test: 441.0274 [399.13], Avg: 160.3589 (0.267)
Ep: 439, Reward: 587.1103, Test: 237.6964 [314.70], Avg: 159.8195 (0.266)
Ep: 440, Reward: 581.4874, Test: 372.5575 [295.47], Avg: 159.6319 (0.265)
Ep: 441, Reward: 528.8485, Test: 493.1038 [306.27], Avg: 159.6934 (0.264)
Ep: 442, Reward: 605.6541, Test: 585.1234 [323.39], Avg: 159.9237 (0.263)
Ep: 443, Reward: 669.7101, Test: 604.3435 [327.74], Avg: 160.1865 (0.263)
Ep: 444, Reward: 665.3264, Test: 632.2851 [272.53], Avg: 160.6350 (0.262)
Ep: 445, Reward: 678.0350, Test: 414.6234 [361.72], Avg: 160.3935 (0.261)
Ep: 446, Reward: 467.0790, Test: 627.3861 [285.96], Avg: 160.7984 (0.260)
Ep: 447, Reward: 492.1112, Test: 552.9831 [277.76], Avg: 161.0539 (0.259)
Ep: 448, Reward: 607.6193, Test: 508.7818 [323.65], Avg: 161.1075 (0.259)
Ep: 449, Reward: 535.8796, Test: 664.6237 [286.31], Avg: 161.5902 (0.258)
Ep: 450, Reward: 545.7608, Test: 633.0943 [293.63], Avg: 161.9846 (0.257)
Ep: 451, Reward: 634.3883, Test: 637.1108 [309.07], Avg: 162.3520 (0.256)
Ep: 452, Reward: 680.0643, Test: 474.0720 [302.00], Avg: 162.3734 (0.256)
Ep: 453, Reward: 627.5226, Test: 627.3709 [263.44], Avg: 162.8174 (0.255)
Ep: 454, Reward: 751.7711, Test: 604.3177 [262.38], Avg: 163.2110 (0.254)
Ep: 455, Reward: 636.8966, Test: 571.9397 [346.99], Avg: 163.3464 (0.253)
Ep: 456, Reward: 603.5969, Test: 642.2858 [294.37], Avg: 163.7503 (0.253)
Ep: 457, Reward: 665.7025, Test: 603.2215 [364.21], Avg: 163.9147 (0.252)
Ep: 458, Reward: 628.6031, Test: 659.1152 [250.66], Avg: 164.4474 (0.251)
Ep: 459, Reward: 591.1314, Test: 762.1899 [277.57], Avg: 165.1435 (0.250)
Ep: 460, Reward: 543.8036, Test: 471.1030 [258.70], Avg: 165.2460 (0.250)
Ep: 461, Reward: 661.0008, Test: 485.0688 [362.24], Avg: 165.1542 (0.249)
Ep: 462, Reward: 538.8694, Test: 629.6947 [300.98], Avg: 165.5074 (0.248)
Ep: 463, Reward: 582.8424, Test: 384.9740 [342.48], Avg: 165.2423 (0.247)
Ep: 464, Reward: 551.0795, Test: 809.6091 [194.72], Avg: 166.2093 (0.247)
Ep: 465, Reward: 681.6040, Test: 600.6438 [267.90], Avg: 166.5667 (0.246)
Ep: 466, Reward: 729.9360, Test: 500.9893 [329.75], Avg: 166.5767 (0.245)
Ep: 467, Reward: 665.1132, Test: 562.7085 [350.52], Avg: 166.6742 (0.244)
Ep: 468, Reward: 622.5006, Test: 737.0327 [228.31], Avg: 167.4035 (0.244)
Ep: 469, Reward: 742.1258, Test: 703.0938 [257.31], Avg: 167.9958 (0.243)
Ep: 470, Reward: 642.1389, Test: 662.9926 [242.99], Avg: 168.5308 (0.242)
Ep: 471, Reward: 695.4274, Test: 576.2861 [316.02], Avg: 168.7252 (0.241)
Ep: 472, Reward: 733.5623, Test: 559.9198 [314.05], Avg: 168.8883 (0.241)
Ep: 473, Reward: 469.4607, Test: 482.9010 [292.12], Avg: 168.9345 (0.240)
Ep: 474, Reward: 742.3610, Test: 634.2726 [287.43], Avg: 169.3090 (0.239)
Ep: 475, Reward: 756.3071, Test: 774.5688 [198.77], Avg: 170.1630 (0.239)
Ep: 476, Reward: 719.0945, Test: 519.6177 [304.92], Avg: 170.2564 (0.238)
Ep: 477, Reward: 639.0507, Test: 721.8631 [202.78], Avg: 170.9861 (0.237)
Ep: 478, Reward: 736.4137, Test: 553.8281 [380.21], Avg: 170.9916 (0.236)
Ep: 479, Reward: 494.0000, Test: 613.3267 [356.87], Avg: 171.1697 (0.236)
Ep: 480, Reward: 720.1675, Test: 629.8555 [385.91], Avg: 171.3210 (0.235)
Ep: 481, Reward: 704.0514, Test: 634.8834 [326.40], Avg: 171.6055 (0.234)
Ep: 482, Reward: 692.6408, Test: 643.2451 [221.69], Avg: 172.1230 (0.234)
Ep: 483, Reward: 587.3647, Test: 533.9631 [351.38], Avg: 172.1446 (0.233)
Ep: 484, Reward: 770.6089, Test: 695.4497 [305.12], Avg: 172.5945 (0.232)
Ep: 485, Reward: 576.1549, Test: 702.3127 [273.16], Avg: 173.1224 (0.231)
Ep: 486, Reward: 655.7418, Test: 570.0401 [244.37], Avg: 173.4356 (0.231)
Ep: 487, Reward: 578.3904, Test: 769.8243 [136.53], Avg: 174.3780 (0.230)
Ep: 488, Reward: 703.6519, Test: 594.2890 [303.17], Avg: 174.6167 (0.229)
Ep: 489, Reward: 659.1962, Test: 496.3536 [338.28], Avg: 174.5829 (0.229)
Ep: 490, Reward: 594.3548, Test: 637.1455 [313.87], Avg: 174.8858 (0.228)
Ep: 491, Reward: 719.3116, Test: 666.9768 [280.91], Avg: 175.3150 (0.227)
Ep: 492, Reward: 592.5433, Test: 713.5107 [241.76], Avg: 175.9163 (0.227)
Ep: 493, Reward: 708.1117, Test: 604.3522 [167.01], Avg: 176.4455 (0.226)
Ep: 494, Reward: 783.0179, Test: 648.9177 [333.41], Avg: 176.7264 (0.225)
Ep: 495, Reward: 833.5192, Test: 580.2462 [298.22], Avg: 176.9387 (0.225)
Ep: 496, Reward: 683.4955, Test: 643.2818 [294.81], Avg: 177.2838 (0.224)
Ep: 497, Reward: 670.1987, Test: 625.6765 [347.50], Avg: 177.4864 (0.223)
Ep: 498, Reward: 631.3618, Test: 735.5162 [237.00], Avg: 178.1298 (0.223)
Ep: 499, Reward: 746.6806, Test: 632.0547 [322.08], Avg: 178.3935 (0.222)
