Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.05				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((PPO_EPOCHS*len(self.replay_buffer))//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -28.6475, Test: -40.7860 [11.87], Avg: -52.6518 (0.997)
Ep: 1, Reward: -52.6117, Test: -45.1818 [14.63], Avg: -56.2305 (0.994)
Ep: 2, Reward: -63.4522, Test: -61.8510 [17.48], Avg: -63.9306 (0.991)
Ep: 3, Reward: -68.8300, Test: -91.6667 [39.00], Avg: -80.6148 (0.988)
Ep: 4, Reward: -81.8133, Test: -74.3056 [38.30], Avg: -87.0125 (0.985)
Ep: 5, Reward: -24.9407, Test: -60.1846 [6.24], Avg: -83.5807 (0.982)
Ep: 6, Reward: -47.6319, Test: 28.0861 [46.02], Avg: -74.2032 (0.979)
Ep: 7, Reward: 138.2920, Test: 333.0296 [85.67], Avg: -34.0073 (0.976)
Ep: 8, Reward: 335.4143, Test: 416.2725 [128.63], Avg: 1.7320 (0.973)
Ep: 9, Reward: 382.6424, Test: 329.7079 [201.12], Avg: 14.4171 (0.970)
Ep: 10, Reward: 456.8589, Test: 577.1598 [148.78], Avg: 52.0502 (0.967)
Ep: 11, Reward: 508.3170, Test: 562.0653 [177.94], Avg: 79.7230 (0.965)
Ep: 12, Reward: 534.9545, Test: 528.9046 [276.54], Avg: 93.0034 (0.962)
Ep: 13, Reward: 640.4858, Test: 682.0601 [255.15], Avg: 116.8541 (0.959)
Ep: 14, Reward: 659.1606, Test: 709.5771 [114.22], Avg: 148.7543 (0.956)
Ep: 15, Reward: 705.7963, Test: 790.5249 [87.42], Avg: 183.4013 (0.953)
Ep: 16, Reward: 487.6283, Test: 707.5141 [187.12], Avg: 203.2245 (0.950)
Ep: 17, Reward: 727.6223, Test: 582.5711 [207.45], Avg: 212.7742 (0.947)
Ep: 18, Reward: 778.3325, Test: 693.9811 [183.50], Avg: 228.4429 (0.945)
Ep: 19, Reward: 754.0457, Test: 771.8505 [185.01], Avg: 246.3629 (0.942)
Ep: 20, Reward: 881.9816, Test: 734.0280 [185.53], Avg: 260.7501 (0.939)
Ep: 21, Reward: 724.8162, Test: 661.6387 [186.37], Avg: 270.5011 (0.936)
Ep: 22, Reward: 671.3563, Test: 626.3649 [197.42], Avg: 277.3901 (0.933)
Ep: 23, Reward: 597.5691, Test: 615.1029 [223.32], Avg: 282.1565 (0.930)
Ep: 24, Reward: 558.9659, Test: 524.2464 [194.41], Avg: 284.0639 (0.928)
Ep: 25, Reward: 605.5729, Test: 644.4065 [193.11], Avg: 290.4959 (0.925)
Ep: 26, Reward: 701.4227, Test: 702.1844 [159.40], Avg: 299.8399 (0.922)
Ep: 27, Reward: 694.5797, Test: 783.1763 [118.28], Avg: 312.8777 (0.919)
Ep: 28, Reward: 761.4712, Test: 768.6022 [193.73], Avg: 321.9120 (0.917)
Ep: 29, Reward: 688.9503, Test: 750.9774 [189.81], Avg: 329.8873 (0.914)
Ep: 30, Reward: 717.3465, Test: 807.9229 [136.03], Avg: 340.9199 (0.911)
Ep: 31, Reward: 722.7073, Test: 771.4978 [177.80], Avg: 348.8192 (0.908)
Ep: 32, Reward: 653.9122, Test: 714.8766 [173.24], Avg: 354.6622 (0.906)
Ep: 33, Reward: 843.2776, Test: 770.8048 [126.87], Avg: 363.1702 (0.903)
Ep: 34, Reward: 786.5627, Test: 707.6158 [176.76], Avg: 367.9611 (0.900)
Ep: 35, Reward: 746.5971, Test: 846.7082 [61.44], Avg: 379.5529 (0.897)
Ep: 36, Reward: 784.0625, Test: 584.0778 [217.76], Avg: 379.1951 (0.895)
Ep: 37, Reward: 662.8108, Test: 469.2610 [182.89], Avg: 376.7524 (0.892)
Ep: 38, Reward: 429.2684, Test: 412.8198 [223.11], Avg: 371.9565 (0.889)
Ep: 39, Reward: 418.3077, Test: 598.7636 [192.48], Avg: 372.8148 (0.887)
Ep: 40, Reward: 641.8720, Test: 626.4646 [167.75], Avg: 374.9099 (0.884)
Ep: 41, Reward: 659.7010, Test: 644.2643 [243.90], Avg: 375.5160 (0.881)
Ep: 42, Reward: 655.3900, Test: 590.6509 [211.07], Avg: 375.6107 (0.879)
Ep: 43, Reward: 607.3346, Test: 464.8825 [239.14], Avg: 372.2045 (0.876)
Ep: 44, Reward: 563.9032, Test: 590.1243 [231.17], Avg: 371.9100 (0.874)
Ep: 45, Reward: 519.9634, Test: 578.8751 [154.59], Avg: 373.0486 (0.871)
Ep: 46, Reward: 491.7245, Test: 530.9260 [180.92], Avg: 372.5584 (0.868)
Ep: 47, Reward: 476.5586, Test: 392.2474 [224.29], Avg: 368.2960 (0.866)
Ep: 48, Reward: 412.4296, Test: 545.3844 [164.39], Avg: 368.5551 (0.863)
Ep: 49, Reward: 521.8960, Test: 473.1221 [204.45], Avg: 366.5575 (0.861)
Ep: 50, Reward: 518.6530, Test: 557.6134 [200.62], Avg: 366.3699 (0.858)
Ep: 51, Reward: 571.8982, Test: 443.5056 [125.09], Avg: 365.4477 (0.855)
Ep: 52, Reward: 523.4886, Test: 481.0560 [148.76], Avg: 364.8223 (0.853)
Ep: 53, Reward: 461.0020, Test: 591.1452 [186.92], Avg: 365.5519 (0.850)
Ep: 54, Reward: 477.2323, Test: 531.4111 [140.46], Avg: 366.0137 (0.848)
Ep: 55, Reward: 554.2165, Test: 405.4004 [167.45], Avg: 363.7268 (0.845)
Ep: 56, Reward: 479.6590, Test: 434.0475 [203.07], Avg: 361.3978 (0.843)
Ep: 57, Reward: 440.2020, Test: 450.3244 [186.15], Avg: 359.7216 (0.840)
Ep: 58, Reward: 482.6846, Test: 479.5583 [202.85], Avg: 358.3147 (0.838)
Ep: 59, Reward: 416.0667, Test: 304.2417 [140.07], Avg: 355.0790 (0.835)
Ep: 60, Reward: 368.0418, Test: 337.6596 [150.82], Avg: 352.3210 (0.833)
Ep: 61, Reward: 438.7304, Test: 411.8057 [158.66], Avg: 350.7214 (0.830)
Ep: 62, Reward: 505.7241, Test: 488.1977 [158.64], Avg: 350.3856 (0.828)
Ep: 63, Reward: 586.3069, Test: 444.0461 [106.19], Avg: 350.1898 (0.825)
Ep: 64, Reward: 496.3155, Test: 468.0246 [178.99], Avg: 349.2489 (0.823)
Ep: 65, Reward: 467.9721, Test: 379.7955 [132.44], Avg: 347.7050 (0.820)
Ep: 66, Reward: 464.2316, Test: 450.4871 [136.03], Avg: 347.2088 (0.818)
Ep: 67, Reward: 430.5325, Test: 366.9752 [179.29], Avg: 344.8628 (0.815)
Ep: 68, Reward: 473.3532, Test: 413.7585 [134.77], Avg: 343.9081 (0.813)
Ep: 69, Reward: 550.0672, Test: 493.1950 [195.04], Avg: 343.2545 (0.810)
Ep: 70, Reward: 563.8777, Test: 588.1056 [228.73], Avg: 343.4815 (0.808)
Ep: 71, Reward: 533.0639, Test: 655.1645 [146.80], Avg: 345.7716 (0.805)
Ep: 72, Reward: 571.4767, Test: 590.0860 [175.72], Avg: 346.7112 (0.803)
Ep: 73, Reward: 628.3715, Test: 559.5475 [180.30], Avg: 347.1510 (0.801)
Ep: 74, Reward: 477.0388, Test: 504.9487 [193.96], Avg: 346.6688 (0.798)
Ep: 75, Reward: 596.0502, Test: 525.1965 [231.37], Avg: 345.9735 (0.796)
Ep: 76, Reward: 647.9553, Test: 536.3210 [228.35], Avg: 345.4800 (0.793)
Ep: 77, Reward: 680.5967, Test: 741.0610 [207.22], Avg: 347.8948 (0.791)
Ep: 78, Reward: 732.9129, Test: 631.4684 [180.10], Avg: 349.2046 (0.789)
Ep: 79, Reward: 693.8655, Test: 667.9379 [196.09], Avg: 350.7377 (0.786)
Ep: 80, Reward: 727.6507, Test: 723.7801 [200.94], Avg: 352.8625 (0.784)
Ep: 81, Reward: 633.0632, Test: 627.5571 [148.97], Avg: 354.3956 (0.782)
Ep: 82, Reward: 753.0794, Test: 632.3700 [159.37], Avg: 355.8246 (0.779)
Ep: 83, Reward: 758.6281, Test: 658.3354 [216.64], Avg: 356.8470 (0.777)
Ep: 84, Reward: 649.5781, Test: 609.2445 [166.50], Avg: 357.8576 (0.775)
Ep: 85, Reward: 565.3057, Test: 498.4425 [231.94], Avg: 356.7953 (0.772)
Ep: 86, Reward: 580.6833, Test: 622.7677 [265.37], Avg: 356.8022 (0.770)
Ep: 87, Reward: 590.5207, Test: 581.5124 [195.89], Avg: 357.1298 (0.768)
Ep: 88, Reward: 487.9295, Test: 502.4800 [163.20], Avg: 356.9293 (0.765)
Ep: 89, Reward: 547.5258, Test: 458.3825 [126.73], Avg: 356.6484 (0.763)
Ep: 90, Reward: 535.4681, Test: 597.6647 [173.87], Avg: 357.3863 (0.761)
Ep: 91, Reward: 481.8358, Test: 431.1371 [108.02], Avg: 357.0138 (0.758)
Ep: 92, Reward: 409.7383, Test: 412.9291 [140.42], Avg: 356.1052 (0.756)
Ep: 93, Reward: 444.4167, Test: 405.9320 [149.19], Avg: 355.0481 (0.754)
Ep: 94, Reward: 482.8302, Test: 390.3901 [155.73], Avg: 353.7808 (0.752)
Ep: 95, Reward: 446.2681, Test: 432.3300 [199.14], Avg: 352.5246 (0.749)
Ep: 96, Reward: 401.2172, Test: 371.4468 [202.45], Avg: 350.6326 (0.747)
Ep: 97, Reward: 429.8128, Test: 466.7845 [160.68], Avg: 350.1782 (0.745)
Ep: 98, Reward: 405.6996, Test: 376.8796 [125.05], Avg: 349.1848 (0.743)
Ep: 99, Reward: 411.4089, Test: 271.8383 [162.77], Avg: 346.7837 (0.740)
Ep: 100, Reward: 355.8868, Test: 355.1967 [102.33], Avg: 345.8538 (0.738)
Ep: 101, Reward: 354.4237, Test: 454.6395 [258.38], Avg: 344.3871 (0.736)
Ep: 102, Reward: 459.3307, Test: 316.0807 [61.02], Avg: 343.5198 (0.734)
Ep: 103, Reward: 370.8536, Test: 387.0118 [200.75], Avg: 342.0077 (0.732)
Ep: 104, Reward: 416.4522, Test: 400.0288 [178.84], Avg: 340.8571 (0.729)
Ep: 105, Reward: 400.7369, Test: 339.3806 [262.29], Avg: 338.3687 (0.727)
Ep: 106, Reward: 477.0147, Test: 377.2199 [138.81], Avg: 337.4345 (0.725)
Ep: 107, Reward: 517.2079, Test: 336.7268 [154.14], Avg: 336.0007 (0.723)
Ep: 108, Reward: 443.5151, Test: 416.6591 [159.13], Avg: 335.2808 (0.721)
Ep: 109, Reward: 415.9622, Test: 333.3513 [141.50], Avg: 333.9769 (0.719)
Ep: 110, Reward: 371.5019, Test: 416.2974 [163.28], Avg: 333.2475 (0.716)
Ep: 111, Reward: 432.0411, Test: 395.7641 [104.78], Avg: 332.8702 (0.714)
Ep: 112, Reward: 377.0781, Test: 320.8161 [201.25], Avg: 330.9825 (0.712)
Ep: 113, Reward: 513.5657, Test: 437.7166 [168.02], Avg: 330.4449 (0.710)
Ep: 114, Reward: 460.3859, Test: 389.6838 [160.40], Avg: 329.5652 (0.708)
Ep: 115, Reward: 389.5371, Test: 459.4318 [156.10], Avg: 329.3390 (0.706)
Ep: 116, Reward: 363.2861, Test: 451.8023 [219.59], Avg: 328.5089 (0.704)
Ep: 117, Reward: 422.3963, Test: 398.9637 [154.59], Avg: 327.7959 (0.702)
Ep: 118, Reward: 379.3015, Test: 422.5836 [203.64], Avg: 326.8812 (0.699)
Ep: 119, Reward: 449.2542, Test: 404.2895 [205.71], Avg: 325.8120 (0.697)
Ep: 120, Reward: 401.1045, Test: 479.3357 [201.79], Avg: 325.4131 (0.695)
Ep: 121, Reward: 512.9211, Test: 298.1249 [223.13], Avg: 323.3605 (0.693)
Ep: 122, Reward: 311.7340, Test: 404.0392 [182.61], Avg: 322.5318 (0.691)
Ep: 123, Reward: 454.3961, Test: 407.9798 [152.78], Avg: 321.9888 (0.689)
Ep: 124, Reward: 401.1047, Test: 427.2328 [202.61], Avg: 321.2099 (0.687)
Ep: 125, Reward: 421.4605, Test: 486.0958 [181.47], Avg: 321.0783 (0.685)
Ep: 126, Reward: 418.8882, Test: 348.0346 [210.56], Avg: 319.6326 (0.683)
Ep: 127, Reward: 326.3873, Test: 492.2290 [157.95], Avg: 319.7470 (0.681)
Ep: 128, Reward: 303.8512, Test: 482.1739 [216.40], Avg: 319.3286 (0.679)
Ep: 129, Reward: 456.9694, Test: 418.0878 [170.57], Avg: 318.7762 (0.677)
Ep: 130, Reward: 360.5662, Test: 407.7225 [128.71], Avg: 318.4726 (0.675)
Ep: 131, Reward: 378.1845, Test: 405.4542 [252.98], Avg: 317.2151 (0.673)
Ep: 132, Reward: 408.5245, Test: 286.0468 [176.49], Avg: 315.6537 (0.671)
Ep: 133, Reward: 374.6010, Test: 254.8346 [172.60], Avg: 313.9118 (0.669)
Ep: 134, Reward: 368.6719, Test: 346.9681 [184.21], Avg: 312.7921 (0.663)
Ep: 135, Reward: 339.5484, Test: 301.9627 [188.65], Avg: 311.3253 (0.661)
Ep: 136, Reward: 424.8890, Test: 310.1805 [179.05], Avg: 310.0101 (0.659)
Ep: 137, Reward: 337.6191, Test: 348.6698 [205.24], Avg: 308.8029 (0.657)
Ep: 138, Reward: 344.2883, Test: 324.7362 [218.06], Avg: 307.3488 (0.655)
Ep: 139, Reward: 298.3745, Test: 281.5732 [175.62], Avg: 305.9102 (0.653)
Ep: 140, Reward: 399.6495, Test: 367.9939 [192.85], Avg: 304.9828 (0.651)
Ep: 141, Reward: 319.9731, Test: 319.2256 [169.57], Avg: 303.8890 (0.649)
Ep: 142, Reward: 369.2767, Test: 377.6190 [194.14], Avg: 303.0470 (0.647)
Ep: 143, Reward: 322.4834, Test: 299.4130 [107.00], Avg: 302.2787 (0.645)
Ep: 144, Reward: 378.1986, Test: 311.9815 [135.45], Avg: 301.4115 (0.643)
Ep: 145, Reward: 445.0484, Test: 413.1991 [200.36], Avg: 300.8048 (0.641)
Ep: 146, Reward: 409.4048, Test: 354.6433 [93.39], Avg: 300.5358 (0.639)
Ep: 147, Reward: 436.9557, Test: 385.0684 [197.81], Avg: 299.7703 (0.637)
Ep: 148, Reward: 500.9538, Test: 321.5856 [174.14], Avg: 298.7481 (0.635)
Ep: 149, Reward: 409.0856, Test: 370.3206 [203.81], Avg: 297.8664 (0.633)
Ep: 150, Reward: 434.8038, Test: 309.3958 [200.31], Avg: 296.6162 (0.631)
Ep: 151, Reward: 409.4845, Test: 437.2741 [217.48], Avg: 296.1108 (0.630)
Ep: 152, Reward: 386.5062, Test: 419.9285 [208.71], Avg: 295.5560 (0.628)
Ep: 153, Reward: 374.1953, Test: 480.9946 [191.22], Avg: 295.5185 (0.626)
Ep: 154, Reward: 388.4736, Test: 480.0068 [192.67], Avg: 295.4657 (0.624)
Ep: 155, Reward: 561.7918, Test: 523.9037 [203.86], Avg: 295.6232 (0.622)
Ep: 156, Reward: 491.1875, Test: 454.0648 [224.33], Avg: 295.2036 (0.620)
Ep: 157, Reward: 536.7508, Test: 390.7997 [170.10], Avg: 294.7320 (0.618)
Ep: 158, Reward: 446.0538, Test: 528.1884 [205.62], Avg: 294.9071 (0.616)
Ep: 159, Reward: 408.3454, Test: 527.8689 [250.07], Avg: 294.8001 (0.615)
Ep: 160, Reward: 540.9737, Test: 505.7068 [225.77], Avg: 294.7078 (0.613)
Ep: 161, Reward: 429.5237, Test: 448.4503 [254.32], Avg: 294.0869 (0.611)
Ep: 162, Reward: 470.3191, Test: 497.7352 [189.07], Avg: 294.1764 (0.609)
Ep: 163, Reward: 375.3565, Test: 489.6801 [185.72], Avg: 294.2360 (0.607)
Ep: 164, Reward: 550.6780, Test: 528.7544 [183.58], Avg: 294.5448 (0.605)
Ep: 165, Reward: 480.3936, Test: 501.7655 [124.94], Avg: 295.0405 (0.604)
Ep: 166, Reward: 548.6905, Test: 503.4549 [191.27], Avg: 295.1431 (0.602)
Ep: 167, Reward: 460.6404, Test: 624.4353 [166.73], Avg: 296.1107 (0.600)
Ep: 168, Reward: 523.9822, Test: 507.2144 [199.53], Avg: 296.1793 (0.598)
Ep: 169, Reward: 664.2015, Test: 436.4526 [138.55], Avg: 296.1894 (0.596)
Ep: 170, Reward: 553.6640, Test: 608.6010 [197.13], Avg: 296.8635 (0.595)
Ep: 171, Reward: 487.5592, Test: 593.8569 [262.59], Avg: 297.0636 (0.593)
Ep: 172, Reward: 510.9370, Test: 430.2088 [229.98], Avg: 296.5038 (0.591)
Ep: 173, Reward: 537.6539, Test: 604.5572 [205.83], Avg: 297.0913 (0.589)
Ep: 174, Reward: 487.3395, Test: 473.9944 [166.43], Avg: 297.1512 (0.588)
Ep: 175, Reward: 505.9319, Test: 472.8177 [223.10], Avg: 296.8816 (0.586)
Ep: 176, Reward: 524.8258, Test: 486.2614 [180.38], Avg: 296.9325 (0.584)
Ep: 177, Reward: 534.7990, Test: 632.4001 [192.09], Avg: 297.7380 (0.582)
Ep: 178, Reward: 421.5104, Test: 628.1186 [169.18], Avg: 298.6385 (0.581)
Ep: 179, Reward: 518.3499, Test: 526.7476 [208.38], Avg: 298.7481 (0.579)
Ep: 180, Reward: 552.8739, Test: 548.1264 [173.55], Avg: 299.1671 (0.577)
Ep: 181, Reward: 577.8304, Test: 478.1902 [198.14], Avg: 299.0620 (0.575)
Ep: 182, Reward: 538.1602, Test: 605.4304 [195.55], Avg: 299.6676 (0.574)
Ep: 183, Reward: 611.0230, Test: 507.7405 [204.27], Avg: 299.6883 (0.572)
Ep: 184, Reward: 495.6741, Test: 514.0425 [191.90], Avg: 299.8097 (0.570)
Ep: 185, Reward: 593.7094, Test: 540.1696 [227.81], Avg: 299.8771 (0.568)
Ep: 186, Reward: 568.9459, Test: 493.4934 [143.77], Avg: 300.1437 (0.567)
Ep: 187, Reward: 528.9958, Test: 541.4151 [172.15], Avg: 300.5114 (0.565)
Ep: 188, Reward: 543.3302, Test: 498.2608 [167.97], Avg: 300.6690 (0.563)
Ep: 189, Reward: 563.3048, Test: 400.2877 [227.30], Avg: 299.9970 (0.562)
Ep: 190, Reward: 462.2648, Test: 444.3984 [137.26], Avg: 300.0344 (0.560)
Ep: 191, Reward: 484.0217, Test: 430.1998 [215.56], Avg: 299.5896 (0.558)
Ep: 192, Reward: 366.9231, Test: 534.1783 [172.36], Avg: 299.9120 (0.557)
Ep: 193, Reward: 566.1367, Test: 542.8381 [245.15], Avg: 299.9005 (0.555)
Ep: 194, Reward: 485.1463, Test: 600.4283 [178.80], Avg: 300.5248 (0.553)
Ep: 195, Reward: 546.2850, Test: 462.9722 [238.26], Avg: 300.1380 (0.552)
Ep: 196, Reward: 480.0185, Test: 505.1867 [160.38], Avg: 300.3648 (0.550)
Ep: 197, Reward: 471.0563, Test: 454.1607 [247.72], Avg: 299.8904 (0.548)
Ep: 198, Reward: 382.7174, Test: 489.8764 [196.02], Avg: 299.8601 (0.547)
Ep: 199, Reward: 493.9732, Test: 533.7363 [210.84], Avg: 299.9753 (0.545)
Ep: 200, Reward: 500.9807, Test: 569.5781 [250.61], Avg: 300.0698 (0.543)
Ep: 201, Reward: 552.5935, Test: 416.8159 [160.09], Avg: 299.8552 (0.542)
Ep: 202, Reward: 460.6967, Test: 394.8237 [213.05], Avg: 299.2735 (0.540)
Ep: 203, Reward: 447.7146, Test: 399.1977 [182.39], Avg: 298.8693 (0.539)
Ep: 204, Reward: 499.7281, Test: 471.1791 [244.85], Avg: 298.5154 (0.537)
Ep: 205, Reward: 500.4118, Test: 388.0666 [129.75], Avg: 298.3202 (0.535)
Ep: 206, Reward: 514.5955, Test: 425.7989 [176.07], Avg: 298.0855 (0.534)
Ep: 207, Reward: 418.5154, Test: 345.0334 [193.96], Avg: 297.3787 (0.532)
Ep: 208, Reward: 463.6835, Test: 514.7447 [231.60], Avg: 297.3106 (0.530)
Ep: 209, Reward: 467.8760, Test: 345.5384 [187.43], Avg: 296.6478 (0.529)
Ep: 210, Reward: 402.1620, Test: 472.3149 [229.68], Avg: 296.3918 (0.527)
Ep: 211, Reward: 495.6067, Test: 490.1101 [160.58], Avg: 296.5481 (0.526)
Ep: 212, Reward: 494.7098, Test: 496.3398 [226.84], Avg: 296.4211 (0.524)
Ep: 213, Reward: 420.7809, Test: 447.8882 [184.86], Avg: 296.2651 (0.523)
Ep: 214, Reward: 471.5384, Test: 496.0407 [221.33], Avg: 296.1648 (0.521)
Ep: 215, Reward: 521.5519, Test: 496.0320 [246.78], Avg: 295.9477 (0.519)
Ep: 216, Reward: 452.9579, Test: 556.9819 [178.53], Avg: 296.3279 (0.518)
Ep: 217, Reward: 579.9215, Test: 436.9504 [178.71], Avg: 296.1531 (0.516)
Ep: 218, Reward: 495.2694, Test: 366.6201 [225.81], Avg: 295.4438 (0.515)
Ep: 219, Reward: 455.1895, Test: 520.5830 [183.76], Avg: 295.6319 (0.513)
Ep: 220, Reward: 462.9289, Test: 472.9543 [181.45], Avg: 295.6132 (0.512)
Ep: 221, Reward: 586.5019, Test: 530.4038 [216.85], Avg: 295.6941 (0.510)
Ep: 222, Reward: 441.5148, Test: 517.0241 [196.94], Avg: 295.8034 (0.509)
Ep: 223, Reward: 549.5018, Test: 522.1310 [257.00], Avg: 295.6665 (0.507)
Ep: 224, Reward: 556.0805, Test: 599.5989 [134.40], Avg: 296.4200 (0.506)
Ep: 225, Reward: 501.1330, Test: 521.2472 [286.96], Avg: 296.1451 (0.504)
Ep: 226, Reward: 566.1873, Test: 378.7994 [129.57], Avg: 295.9384 (0.503)
Ep: 227, Reward: 420.9173, Test: 411.0409 [201.35], Avg: 295.5601 (0.501)
Ep: 228, Reward: 543.8268, Test: 613.1454 [196.57], Avg: 296.0886 (0.500)
Ep: 229, Reward: 542.5104, Test: 510.5816 [172.52], Avg: 296.2711 (0.498)
Ep: 230, Reward: 616.8935, Test: 495.7899 [180.45], Avg: 296.3536 (0.497)
Ep: 231, Reward: 434.8117, Test: 448.4145 [176.90], Avg: 296.2465 (0.495)
Ep: 232, Reward: 446.1507, Test: 403.8927 [211.29], Avg: 295.8017 (0.494)
Ep: 233, Reward: 521.8457, Test: 524.9856 [234.28], Avg: 295.7799 (0.492)
Ep: 234, Reward: 498.0750, Test: 455.1164 [174.88], Avg: 295.7138 (0.491)
Ep: 235, Reward: 446.4491, Test: 408.4895 [105.68], Avg: 295.7439 (0.489)
Ep: 236, Reward: 586.6265, Test: 584.9577 [160.91], Avg: 296.2852 (0.488)
Ep: 237, Reward: 523.7376, Test: 458.3024 [258.33], Avg: 295.8806 (0.486)
Ep: 238, Reward: 534.4072, Test: 478.2174 [191.79], Avg: 295.8410 (0.485)
Ep: 239, Reward: 480.6991, Test: 434.6589 [155.90], Avg: 295.7699 (0.483)
Ep: 240, Reward: 520.2366, Test: 484.2157 [187.42], Avg: 295.7741 (0.482)
Ep: 241, Reward: 483.0385, Test: 527.8904 [158.08], Avg: 296.0801 (0.480)
Ep: 242, Reward: 491.1838, Test: 504.4209 [194.80], Avg: 296.1358 (0.479)
Ep: 243, Reward: 655.4729, Test: 562.7986 [192.18], Avg: 296.4410 (0.478)
Ep: 244, Reward: 499.3884, Test: 587.5638 [152.14], Avg: 297.0083 (0.476)
Ep: 245, Reward: 634.9152, Test: 457.0209 [138.66], Avg: 297.0951 (0.475)
Ep: 246, Reward: 518.1871, Test: 390.7468 [160.44], Avg: 296.8247 (0.473)
Ep: 247, Reward: 464.1645, Test: 485.6872 [122.04], Avg: 297.0941 (0.472)
Ep: 248, Reward: 518.0349, Test: 404.2214 [165.23], Avg: 296.8607 (0.470)
Ep: 249, Reward: 437.0375, Test: 488.1908 [160.66], Avg: 296.9834 (0.469)
Ep: 250, Reward: 453.6609, Test: 454.4997 [227.47], Avg: 296.7047 (0.468)
Ep: 251, Reward: 542.8233, Test: 550.7155 [112.70], Avg: 297.2655 (0.466)
Ep: 252, Reward: 541.6955, Test: 462.1450 [171.35], Avg: 297.2399 (0.465)
Ep: 253, Reward: 563.3488, Test: 451.9982 [153.04], Avg: 297.2467 (0.463)
Ep: 254, Reward: 497.4305, Test: 443.8730 [84.85], Avg: 297.4890 (0.462)
Ep: 255, Reward: 494.8855, Test: 572.5475 [153.13], Avg: 297.9653 (0.461)
Ep: 256, Reward: 444.7196, Test: 488.6519 [259.22], Avg: 297.6986 (0.459)
Ep: 257, Reward: 501.2227, Test: 531.3433 [244.22], Avg: 297.6576 (0.458)
Ep: 258, Reward: 440.7811, Test: 513.0325 [171.34], Avg: 297.8277 (0.456)
Ep: 259, Reward: 582.3379, Test: 372.5434 [178.54], Avg: 297.4283 (0.455)
Ep: 260, Reward: 449.1669, Test: 381.4591 [187.03], Avg: 297.0337 (0.454)
Ep: 261, Reward: 449.1742, Test: 432.4289 [137.38], Avg: 297.0261 (0.452)
Ep: 262, Reward: 528.6191, Test: 407.8339 [80.65], Avg: 297.1408 (0.451)
Ep: 263, Reward: 473.9055, Test: 445.4614 [200.12], Avg: 296.9446 (0.450)
Ep: 264, Reward: 530.9818, Test: 446.8937 [214.09], Avg: 296.7026 (0.448)
Ep: 265, Reward: 411.8745, Test: 310.5125 [160.18], Avg: 296.1523 (0.446)
Ep: 266, Reward: 398.9729, Test: 287.1316 [159.28], Avg: 295.5219 (0.444)
Ep: 267, Reward: 428.3464, Test: 269.5117 [295.41], Avg: 294.3226 (0.443)
Ep: 268, Reward: 377.4115, Test: 377.3079 [239.31], Avg: 293.7415 (0.442)
Ep: 269, Reward: 413.6308, Test: 392.3640 [166.88], Avg: 293.4887 (0.440)
Ep: 270, Reward: 379.6389, Test: 444.0168 [206.85], Avg: 293.2809 (0.439)
Ep: 271, Reward: 394.4369, Test: 414.4626 [213.32], Avg: 292.9421 (0.438)
Ep: 272, Reward: 361.3763, Test: 328.2487 [180.29], Avg: 292.4110 (0.436)
Ep: 273, Reward: 308.1891, Test: 350.9470 [237.59], Avg: 291.7575 (0.435)
Ep: 274, Reward: 377.0114, Test: 376.1897 [178.60], Avg: 291.4151 (0.434)
Ep: 275, Reward: 395.9420, Test: 401.7977 [96.67], Avg: 291.4648 (0.432)
Ep: 276, Reward: 369.4208, Test: 439.7205 [232.19], Avg: 291.1618 (0.431)
Ep: 277, Reward: 393.2753, Test: 341.2402 [219.68], Avg: 290.5517 (0.430)
Ep: 278, Reward: 380.5521, Test: 358.5438 [255.24], Avg: 289.8806 (0.429)
Ep: 279, Reward: 370.5339, Test: 454.5388 [232.12], Avg: 289.6397 (0.427)
Ep: 280, Reward: 489.3555, Test: 230.3655 [160.72], Avg: 288.8568 (0.426)
Ep: 281, Reward: 351.8017, Test: 441.0482 [227.64], Avg: 288.5892 (0.425)
Ep: 282, Reward: 311.7871, Test: 398.0752 [202.44], Avg: 288.2607 (0.423)
Ep: 283, Reward: 411.2208, Test: 344.4434 [152.30], Avg: 287.9223 (0.422)
Ep: 284, Reward: 495.1333, Test: 333.1910 [180.44], Avg: 287.4480 (0.421)
Ep: 285, Reward: 395.8388, Test: 400.0841 [175.01], Avg: 287.2300 (0.420)
Ep: 286, Reward: 345.9781, Test: 392.3268 [182.66], Avg: 286.9597 (0.418)
Ep: 287, Reward: 303.5209, Test: 135.3326 [124.58], Avg: 286.0007 (0.417)
Ep: 288, Reward: 326.5267, Test: 293.8436 [219.75], Avg: 285.2674 (0.416)
Ep: 289, Reward: 362.1697, Test: 254.1709 [157.10], Avg: 284.6185 (0.415)
Ep: 290, Reward: 358.0694, Test: 304.1454 [186.05], Avg: 284.0462 (0.413)
Ep: 291, Reward: 404.8166, Test: 302.6158 [154.28], Avg: 283.5815 (0.412)
Ep: 292, Reward: 436.6869, Test: 340.1098 [269.29], Avg: 282.8553 (0.411)
Ep: 293, Reward: 397.1427, Test: 382.6173 [194.68], Avg: 282.5325 (0.410)
Ep: 294, Reward: 300.0342, Test: 315.4380 [76.86], Avg: 282.3835 (0.408)
Ep: 295, Reward: 339.9426, Test: 276.5715 [201.58], Avg: 281.6828 (0.407)
Ep: 296, Reward: 374.9974, Test: 455.7574 [255.04], Avg: 281.4102 (0.406)
Ep: 297, Reward: 392.4562, Test: 299.1998 [196.95], Avg: 280.8090 (0.405)
Ep: 298, Reward: 422.5541, Test: 340.0204 [247.85], Avg: 280.1781 (0.404)
Ep: 299, Reward: 374.0715, Test: 333.6378 [92.21], Avg: 280.0490 (0.402)
Ep: 300, Reward: 434.4226, Test: 373.9599 [182.21], Avg: 279.7556 (0.401)
Ep: 301, Reward: 395.7925, Test: 358.8113 [244.86], Avg: 279.2066 (0.400)
Ep: 302, Reward: 429.0416, Test: 282.6018 [196.78], Avg: 278.5683 (0.399)
Ep: 303, Reward: 395.1083, Test: 316.1328 [115.72], Avg: 278.3113 (0.398)
Ep: 304, Reward: 457.0956, Test: 378.7431 [195.29], Avg: 278.0002 (0.396)
Ep: 305, Reward: 391.7076, Test: 375.7260 [243.99], Avg: 277.5222 (0.395)
Ep: 306, Reward: 398.7970, Test: 372.6931 [179.02], Avg: 277.2491 (0.394)
Ep: 307, Reward: 390.9254, Test: 457.3468 [142.70], Avg: 277.3705 (0.393)
Ep: 308, Reward: 380.9890, Test: 381.8086 [232.44], Avg: 276.9563 (0.392)
Ep: 309, Reward: 337.5351, Test: 296.5360 [232.64], Avg: 276.2690 (0.390)
Ep: 310, Reward: 370.9739, Test: 249.4014 [75.58], Avg: 275.9396 (0.389)
Ep: 311, Reward: 348.8756, Test: 509.8082 [185.60], Avg: 276.0943 (0.388)
Ep: 312, Reward: 378.4785, Test: 434.2784 [242.61], Avg: 275.8245 (0.387)
Ep: 313, Reward: 460.5325, Test: 445.9749 [175.76], Avg: 275.8067 (0.386)
Ep: 314, Reward: 463.2461, Test: 403.7761 [164.26], Avg: 275.6915 (0.385)
Ep: 315, Reward: 453.4193, Test: 322.6350 [217.37], Avg: 275.1522 (0.383)
Ep: 316, Reward: 450.1665, Test: 393.4683 [238.85], Avg: 274.7719 (0.382)
Ep: 317, Reward: 474.1309, Test: 380.0685 [255.65], Avg: 274.2991 (0.381)
Ep: 318, Reward: 423.0887, Test: 462.1293 [270.50], Avg: 274.0400 (0.380)
Ep: 319, Reward: 419.3961, Test: 399.6408 [210.66], Avg: 273.7742 (0.379)
Ep: 320, Reward: 368.8006, Test: 546.4277 [158.82], Avg: 274.1288 (0.378)
Ep: 321, Reward: 368.0703, Test: 445.9979 [179.28], Avg: 274.1058 (0.377)
Ep: 322, Reward: 496.0770, Test: 291.4338 [144.90], Avg: 273.7109 (0.376)
Ep: 323, Reward: 456.0306, Test: 396.7336 [196.54], Avg: 273.4839 (0.374)
Ep: 324, Reward: 450.5441, Test: 417.1859 [171.05], Avg: 273.3998 (0.373)
Ep: 325, Reward: 532.0106, Test: 397.6543 [198.50], Avg: 273.1721 (0.372)
Ep: 326, Reward: 450.5399, Test: 458.7871 [264.32], Avg: 272.9314 (0.371)
Ep: 327, Reward: 407.9580, Test: 389.0600 [200.84], Avg: 272.6731 (0.370)
Ep: 328, Reward: 416.1602, Test: 347.7162 [212.13], Avg: 272.2564 (0.369)
Ep: 329, Reward: 325.0338, Test: 359.7736 [86.04], Avg: 272.2609 (0.368)
Ep: 330, Reward: 407.8803, Test: 239.2199 [90.57], Avg: 271.8875 (0.367)
Ep: 331, Reward: 326.7105, Test: 289.2688 [166.03], Avg: 271.4397 (0.365)
Ep: 332, Reward: 373.9171, Test: 346.1207 [190.29], Avg: 271.0926 (0.364)
Ep: 333, Reward: 452.6999, Test: 403.2468 [159.75], Avg: 271.0099 (0.363)
Ep: 334, Reward: 402.7206, Test: 409.5140 [119.47], Avg: 271.0668 (0.362)
Ep: 335, Reward: 342.9286, Test: 417.7554 [164.26], Avg: 271.0145 (0.361)
Ep: 336, Reward: 430.6030, Test: 347.2628 [171.90], Avg: 270.7306 (0.360)
Ep: 337, Reward: 335.7388, Test: 421.7828 [135.54], Avg: 270.7765 (0.359)
Ep: 338, Reward: 419.8116, Test: 415.6090 [151.09], Avg: 270.7581 (0.358)
Ep: 339, Reward: 340.0951, Test: 329.9513 [225.07], Avg: 270.2702 (0.357)
Ep: 340, Reward: 365.3296, Test: 335.8566 [287.66], Avg: 269.6190 (0.356)
Ep: 341, Reward: 420.7068, Test: 320.6602 [132.71], Avg: 269.3802 (0.355)
Ep: 342, Reward: 409.5143, Test: 430.4973 [257.41], Avg: 269.0995 (0.354)
Ep: 343, Reward: 381.1420, Test: 364.4857 [221.86], Avg: 268.7318 (0.353)
Ep: 344, Reward: 268.9244, Test: 369.0882 [264.05], Avg: 268.2573 (0.351)
Ep: 345, Reward: 375.0116, Test: 347.9311 [204.18], Avg: 267.8975 (0.350)
Ep: 346, Reward: 414.5727, Test: 290.0012 [180.85], Avg: 267.4400 (0.349)
Ep: 347, Reward: 440.6616, Test: 408.1241 [88.34], Avg: 267.5904 (0.347)
Ep: 348, Reward: 385.9417, Test: 347.9254 [222.46], Avg: 267.1832 (0.346)
Ep: 349, Reward: 372.5201, Test: 377.8051 [260.75], Avg: 266.7543 (0.345)
Ep: 350, Reward: 352.7466, Test: 356.2773 [166.06], Avg: 266.5362 (0.344)
Ep: 351, Reward: 322.5703, Test: 444.0388 [141.37], Avg: 266.6389 (0.343)
Ep: 352, Reward: 309.3649, Test: 364.8916 [241.30], Avg: 266.2337 (0.342)
Ep: 353, Reward: 422.6415, Test: 367.9105 [301.60], Avg: 265.6689 (0.341)
Ep: 354, Reward: 297.1623, Test: 312.4631 [224.48], Avg: 265.1684 (0.340)
Ep: 355, Reward: 430.3305, Test: 384.6845 [166.03], Avg: 265.0377 (0.339)
Ep: 356, Reward: 370.2089, Test: 356.4444 [209.23], Avg: 264.7077 (0.338)
Ep: 357, Reward: 426.4844, Test: 383.8962 [187.97], Avg: 264.5156 (0.337)
Ep: 358, Reward: 407.1622, Test: 364.3199 [191.37], Avg: 264.2605 (0.336)
Ep: 359, Reward: 421.8688, Test: 402.2110 [103.90], Avg: 264.3551 (0.335)
Ep: 360, Reward: 305.2805, Test: 391.8881 [287.77], Avg: 263.9112 (0.334)
Ep: 361, Reward: 378.3907, Test: 333.9847 [276.22], Avg: 263.3417 (0.333)
Ep: 362, Reward: 340.3511, Test: 278.3320 [162.39], Avg: 262.9357 (0.332)
Ep: 363, Reward: 416.1614, Test: 530.2974 [162.52], Avg: 263.2237 (0.331)
Ep: 364, Reward: 417.1853, Test: 282.4108 [142.73], Avg: 262.8853 (0.330)
Ep: 365, Reward: 437.7034, Test: 469.3551 [224.34], Avg: 262.8364 (0.329)
Ep: 366, Reward: 492.8116, Test: 368.8028 [160.37], Avg: 262.6882 (0.328)
Ep: 367, Reward: 404.9507, Test: 386.9877 [225.44], Avg: 262.4134 (0.327)
Ep: 368, Reward: 500.1404, Test: 335.2568 [252.47], Avg: 261.9266 (0.326)
Ep: 369, Reward: 381.8136, Test: 330.4724 [244.79], Avg: 261.4502 (0.325)
Ep: 370, Reward: 364.1092, Test: 244.9949 [188.18], Avg: 260.8987 (0.324)
Ep: 371, Reward: 358.6640, Test: 474.5853 [301.70], Avg: 260.6620 (0.323)
Ep: 372, Reward: 471.0803, Test: 426.0998 [235.85], Avg: 260.4733 (0.322)
Ep: 373, Reward: 372.8477, Test: 413.9213 [233.15], Avg: 260.2602 (0.321)
Ep: 374, Reward: 453.3370, Test: 377.9872 [184.41], Avg: 260.0823 (0.320)
Ep: 375, Reward: 384.7503, Test: 416.3072 [177.63], Avg: 260.0254 (0.319)
Ep: 376, Reward: 484.5470, Test: 390.4736 [226.95], Avg: 259.7694 (0.318)
Ep: 377, Reward: 436.5205, Test: 382.3929 [266.07], Avg: 259.3900 (0.317)
Ep: 378, Reward: 421.2389, Test: 416.6633 [239.38], Avg: 259.1733 (0.316)
Ep: 379, Reward: 449.3933, Test: 523.9858 [236.95], Avg: 259.2467 (0.315)
Ep: 380, Reward: 447.9083, Test: 479.9541 [229.64], Avg: 259.2232 (0.315)
Ep: 381, Reward: 515.4026, Test: 325.2878 [198.99], Avg: 258.8752 (0.314)
Ep: 382, Reward: 437.1887, Test: 535.5491 [164.97], Avg: 259.1669 (0.313)
Ep: 383, Reward: 467.8337, Test: 456.7007 [280.90], Avg: 258.9498 (0.312)
Ep: 384, Reward: 454.7021, Test: 404.4728 [244.28], Avg: 258.6933 (0.311)
Ep: 385, Reward: 404.8741, Test: 404.1891 [195.95], Avg: 258.5626 (0.310)
Ep: 386, Reward: 519.8081, Test: 410.5281 [176.46], Avg: 258.4993 (0.309)
Ep: 387, Reward: 518.7786, Test: 304.1219 [218.31], Avg: 258.0542 (0.308)
Ep: 388, Reward: 497.2453, Test: 497.8864 [177.51], Avg: 258.2145 (0.307)
Ep: 389, Reward: 550.7182, Test: 449.9566 [246.79], Avg: 258.0733 (0.306)
Ep: 390, Reward: 425.0444, Test: 349.6941 [136.80], Avg: 257.9578 (0.305)
Ep: 391, Reward: 595.2901, Test: 464.9270 [220.83], Avg: 257.9224 (0.304)
Ep: 392, Reward: 536.6234, Test: 459.9374 [217.40], Avg: 257.8833 (0.303)
Ep: 393, Reward: 505.4114, Test: 328.7763 [174.90], Avg: 257.6193 (0.302)
Ep: 394, Reward: 553.8756, Test: 304.7456 [250.80], Avg: 257.1037 (0.302)
Ep: 395, Reward: 471.4157, Test: 264.6846 [207.48], Avg: 256.5989 (0.301)
Ep: 396, Reward: 524.6768, Test: 361.0872 [205.33], Avg: 256.3449 (0.300)
Ep: 397, Reward: 454.5202, Test: 542.9167 [181.70], Avg: 256.6084 (0.299)
Ep: 398, Reward: 323.9766, Test: 464.7506 [236.33], Avg: 256.5377 (0.298)
Ep: 399, Reward: 524.2789, Test: 499.2786 [132.07], Avg: 256.8144 (0.297)
Ep: 400, Reward: 496.6555, Test: 448.6047 [128.53], Avg: 256.9721 (0.296)
Ep: 401, Reward: 454.2055, Test: 545.7398 [236.16], Avg: 257.1030 (0.295)
Ep: 402, Reward: 373.6368, Test: 468.0985 [163.26], Avg: 257.2215 (0.294)
Ep: 403, Reward: 418.9487, Test: 438.5362 [231.41], Avg: 257.0975 (0.294)
Ep: 404, Reward: 560.2034, Test: 364.4473 [186.78], Avg: 256.9014 (0.293)
Ep: 405, Reward: 613.4897, Test: 444.7666 [293.78], Avg: 256.6405 (0.292)
Ep: 406, Reward: 538.8623, Test: 368.0954 [229.48], Avg: 256.3505 (0.291)
Ep: 407, Reward: 515.2068, Test: 359.8521 [220.11], Avg: 256.0647 (0.290)
Ep: 408, Reward: 398.1006, Test: 395.7869 [228.15], Avg: 255.8485 (0.289)
Ep: 409, Reward: 465.7333, Test: 361.3011 [129.27], Avg: 255.7904 (0.288)
Ep: 410, Reward: 510.5711, Test: 358.9664 [250.89], Avg: 255.4310 (0.287)
Ep: 411, Reward: 365.9169, Test: 405.2420 [264.14], Avg: 255.1535 (0.287)
Ep: 412, Reward: 526.3099, Test: 456.0489 [132.29], Avg: 255.3196 (0.286)
Ep: 413, Reward: 476.8538, Test: 332.8367 [121.59], Avg: 255.2132 (0.285)
Ep: 414, Reward: 524.7481, Test: 514.4402 [290.84], Avg: 255.1370 (0.284)
Ep: 415, Reward: 404.1834, Test: 575.9571 [184.03], Avg: 255.4658 (0.283)
Ep: 416, Reward: 412.2925, Test: 356.9161 [227.80], Avg: 255.1628 (0.282)
Ep: 417, Reward: 455.9261, Test: 370.9801 [228.03], Avg: 254.8944 (0.281)
Ep: 418, Reward: 564.0032, Test: 508.2366 [245.55], Avg: 254.9130 (0.281)
Ep: 419, Reward: 485.3300, Test: 424.3998 [199.76], Avg: 254.8409 (0.280)
Ep: 420, Reward: 561.6371, Test: 519.8744 [214.75], Avg: 254.9604 (0.279)
Ep: 421, Reward: 432.5092, Test: 410.1440 [215.51], Avg: 254.8174 (0.278)
Ep: 422, Reward: 571.9735, Test: 505.3712 [174.83], Avg: 254.9964 (0.277)
Ep: 423, Reward: 443.5197, Test: 500.7803 [261.11], Avg: 254.9603 (0.276)
Ep: 424, Reward: 525.7970, Test: 524.5148 [205.04], Avg: 255.1120 (0.276)
Ep: 425, Reward: 470.8558, Test: 419.0138 [220.51], Avg: 254.9791 (0.275)
Ep: 426, Reward: 403.6947, Test: 384.7171 [257.78], Avg: 254.6793 (0.274)
Ep: 427, Reward: 518.0618, Test: 466.6154 [221.43], Avg: 254.6571 (0.273)
Ep: 428, Reward: 547.9406, Test: 427.9009 [205.15], Avg: 254.5828 (0.272)
Ep: 429, Reward: 552.8502, Test: 487.5135 [211.08], Avg: 254.6336 (0.271)
Ep: 430, Reward: 532.1633, Test: 395.6021 [276.91], Avg: 254.3182 (0.271)
Ep: 431, Reward: 518.4681, Test: 448.1928 [287.68], Avg: 254.1010 (0.270)
Ep: 432, Reward: 485.4022, Test: 426.5800 [263.93], Avg: 253.8898 (0.269)
Ep: 433, Reward: 480.9278, Test: 426.4916 [258.09], Avg: 253.6928 (0.268)
Ep: 434, Reward: 429.2254, Test: 464.3696 [303.74], Avg: 253.4789 (0.267)
Ep: 435, Reward: 450.2122, Test: 432.0861 [213.50], Avg: 253.3989 (0.267)
Ep: 436, Reward: 604.0183, Test: 590.6231 [206.70], Avg: 253.6975 (0.266)
Ep: 437, Reward: 539.3151, Test: 616.8798 [197.99], Avg: 254.0747 (0.265)
Ep: 438, Reward: 531.4426, Test: 594.8821 [208.25], Avg: 254.3767 (0.264)
Ep: 439, Reward: 539.3059, Test: 432.0919 [219.16], Avg: 254.2825 (0.263)
Ep: 440, Reward: 547.9706, Test: 319.8603 [237.58], Avg: 253.8924 (0.263)
Ep: 441, Reward: 501.4329, Test: 516.4968 [131.21], Avg: 254.1897 (0.262)
Ep: 442, Reward: 523.4125, Test: 407.7608 [228.49], Avg: 254.0206 (0.261)
Ep: 443, Reward: 501.3097, Test: 426.6218 [242.67], Avg: 253.8628 (0.260)
Ep: 444, Reward: 548.7835, Test: 312.7809 [224.38], Avg: 253.4910 (0.259)
Ep: 445, Reward: 368.0240, Test: 433.0798 [292.50], Avg: 253.2378 (0.259)
Ep: 446, Reward: 434.4597, Test: 472.5393 [192.12], Avg: 253.2986 (0.258)
Ep: 447, Reward: 474.0986, Test: 411.2548 [229.19], Avg: 253.1396 (0.257)
Ep: 448, Reward: 563.1312, Test: 550.8790 [281.17], Avg: 253.1765 (0.256)
Ep: 449, Reward: 556.1405, Test: 511.0717 [276.95], Avg: 253.1342 (0.256)
Ep: 450, Reward: 466.5125, Test: 491.2134 [218.02], Avg: 253.1786 (0.255)
Ep: 451, Reward: 556.1607, Test: 441.9276 [257.45], Avg: 253.0267 (0.254)
Ep: 452, Reward: 511.7048, Test: 373.2680 [211.03], Avg: 252.8262 (0.253)
Ep: 453, Reward: 524.6709, Test: 499.2948 [176.72], Avg: 252.9799 (0.253)
Ep: 454, Reward: 611.9057, Test: 511.8290 [183.38], Avg: 253.1457 (0.252)
Ep: 455, Reward: 475.9886, Test: 419.7142 [211.68], Avg: 253.0468 (0.251)
Ep: 456, Reward: 424.5431, Test: 526.5380 [261.53], Avg: 253.0730 (0.250)
Ep: 457, Reward: 410.8298, Test: 364.2546 [226.18], Avg: 252.8219 (0.250)
Ep: 458, Reward: 493.6806, Test: 454.9737 [213.96], Avg: 252.7962 (0.249)
Ep: 459, Reward: 532.3451, Test: 362.0396 [299.13], Avg: 252.3834 (0.248)
Ep: 460, Reward: 536.1299, Test: 496.4953 [261.33], Avg: 252.3460 (0.247)
Ep: 461, Reward: 521.1998, Test: 554.2763 [195.60], Avg: 252.5762 (0.247)
Ep: 462, Reward: 490.4142, Test: 403.7124 [227.40], Avg: 252.4115 (0.246)
Ep: 463, Reward: 613.9361, Test: 422.0424 [229.25], Avg: 252.2830 (0.245)
Ep: 464, Reward: 665.0496, Test: 366.8915 [194.83], Avg: 252.1104 (0.244)
Ep: 465, Reward: 470.6057, Test: 372.6068 [309.55], Avg: 251.7048 (0.244)
Ep: 466, Reward: 562.6433, Test: 340.8728 [81.88], Avg: 251.7204 (0.243)
Ep: 467, Reward: 459.4710, Test: 507.8831 [135.02], Avg: 251.9792 (0.242)
Ep: 468, Reward: 527.8336, Test: 328.8665 [215.32], Avg: 251.6841 (0.241)
Ep: 469, Reward: 482.7067, Test: 471.2844 [188.93], Avg: 251.7493 (0.241)
Ep: 470, Reward: 490.9516, Test: 627.9355 [188.44], Avg: 252.1479 (0.240)
Ep: 471, Reward: 423.3598, Test: 324.0455 [103.00], Avg: 252.0820 (0.239)
Ep: 472, Reward: 416.3784, Test: 460.6313 [202.81], Avg: 252.0942 (0.239)
Ep: 473, Reward: 370.5064, Test: 451.2550 [199.51], Avg: 252.0934 (0.238)
Ep: 474, Reward: 444.0472, Test: 443.4835 [261.51], Avg: 251.9458 (0.237)
Ep: 475, Reward: 517.1495, Test: 377.6211 [169.42], Avg: 251.8539 (0.236)
Ep: 476, Reward: 432.6357, Test: 435.2071 [228.68], Avg: 251.7589 (0.236)
Ep: 477, Reward: 458.5274, Test: 522.6652 [237.19], Avg: 251.8294 (0.235)
Ep: 478, Reward: 424.7501, Test: 314.6455 [268.05], Avg: 251.4010 (0.234)
Ep: 479, Reward: 357.6364, Test: 536.3425 [202.59], Avg: 251.5725 (0.234)
Ep: 480, Reward: 513.1310, Test: 326.9802 [252.57], Avg: 251.2042 (0.233)
Ep: 481, Reward: 513.0377, Test: 459.1678 [178.03], Avg: 251.2663 (0.232)
Ep: 482, Reward: 476.2130, Test: 504.3206 [231.06], Avg: 251.3119 (0.231)
Ep: 483, Reward: 602.0456, Test: 447.4380 [200.04], Avg: 251.3038 (0.231)
Ep: 484, Reward: 484.0664, Test: 455.0044 [154.45], Avg: 251.4053 (0.230)
Ep: 485, Reward: 392.4138, Test: 470.6430 [241.85], Avg: 251.3588 (0.229)
Ep: 486, Reward: 495.3761, Test: 428.8153 [205.34], Avg: 251.3016 (0.229)
Ep: 487, Reward: 511.5387, Test: 396.7340 [277.19], Avg: 251.0316 (0.228)
Ep: 488, Reward: 415.2406, Test: 359.7048 [246.44], Avg: 250.7498 (0.227)
Ep: 489, Reward: 488.3915, Test: 418.8876 [241.86], Avg: 250.5994 (0.227)
Ep: 490, Reward: 476.6635, Test: 368.3125 [208.39], Avg: 250.4147 (0.226)
Ep: 491, Reward: 510.6007, Test: 394.5788 [259.05], Avg: 250.1812 (0.225)
Ep: 492, Reward: 440.3405, Test: 493.8294 [204.40], Avg: 250.2608 (0.225)
Ep: 493, Reward: 519.3121, Test: 431.0306 [252.68], Avg: 250.1152 (0.224)
Ep: 494, Reward: 568.3481, Test: 525.9077 [298.79], Avg: 250.0688 (0.223)
Ep: 495, Reward: 557.9393, Test: 468.9129 [247.10], Avg: 250.0118 (0.223)
Ep: 496, Reward: 498.7686, Test: 463.3099 [216.94], Avg: 250.0045 (0.222)
Ep: 497, Reward: 580.8598, Test: 664.6426 [153.72], Avg: 250.5284 (0.221)
Ep: 498, Reward: 449.2248, Test: 390.5233 [225.35], Avg: 250.3573 (0.220)
Ep: 499, Reward: 391.8910, Test: 497.2798 [311.78], Avg: 250.2276 (0.219)
