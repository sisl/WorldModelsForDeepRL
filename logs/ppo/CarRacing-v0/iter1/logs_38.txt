Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.100                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.01				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(PPO_EPOCHS):
				for i in range(0, len(self.replay_buffer), BATCH_SIZE):
					state, action, log_prob, target, advantage = self.replay_buffer.index(BATCH_SIZE, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -44.1924, Test: -44.9328 [3.56], Avg: -48.4907 (0.997)
Ep: 1, Reward: -42.4149, Test: -38.3456 [5.35], Avg: -46.0952 (0.994)
Ep: 2, Reward: -33.5772, Test: -21.5807 [10.18], Avg: -41.3165 (0.991)
Ep: 3, Reward: -26.8151, Test: -30.0105 [11.38], Avg: -41.3352 (0.988)
Ep: 4, Reward: -26.2747, Test: -28.0474 [8.08], Avg: -40.2938 (0.985)
Ep: 5, Reward: -32.0622, Test: -44.1028 [8.30], Avg: -42.3120 (0.982)
Ep: 6, Reward: -50.5631, Test: -52.5073 [4.83], Avg: -44.4582 (0.979)
Ep: 7, Reward: -44.6165, Test: -50.8290 [9.06], Avg: -46.3869 (0.976)
Ep: 8, Reward: -51.5062, Test: -45.8315 [12.43], Avg: -47.7064 (0.973)
Ep: 9, Reward: -47.1472, Test: -31.0423 [10.09], Avg: -47.0487 (0.970)
Ep: 10, Reward: -20.4881, Test: -10.0002 [27.15], Avg: -46.1488 (0.967)
Ep: 11, Reward: -3.9171, Test: -26.5468 [36.51], Avg: -47.5577 (0.965)
Ep: 12, Reward: 7.9561, Test: 127.7014 [83.05], Avg: -40.4650 (0.962)
Ep: 13, Reward: 119.5498, Test: 215.7765 [112.66], Avg: -30.2091 (0.959)
Ep: 14, Reward: 322.4701, Test: 317.1458 [188.84], Avg: -19.6415 (0.956)
Ep: 15, Reward: 352.0797, Test: 519.3538 [228.07], Avg: -0.2088 (0.953)
Ep: 16, Reward: 344.2537, Test: 457.7912 [180.30], Avg: 16.1263 (0.950)
Ep: 17, Reward: 459.2527, Test: 596.8724 [244.28], Avg: 34.8191 (0.947)
Ep: 18, Reward: 528.5414, Test: 461.7277 [160.78], Avg: 48.8261 (0.945)
Ep: 19, Reward: 471.6389, Test: 463.4599 [318.84], Avg: 53.6159 (0.942)
Ep: 20, Reward: 469.8645, Test: 458.1470 [261.56], Avg: 60.4242 (0.939)
Ep: 21, Reward: 599.2596, Test: 605.3730 [292.50], Avg: 71.8993 (0.936)
Ep: 22, Reward: 646.6764, Test: 571.9221 [276.10], Avg: 81.6352 (0.933)
Ep: 23, Reward: 671.4514, Test: 417.0443 [309.20], Avg: 82.7274 (0.930)
Ep: 24, Reward: 554.3455, Test: 651.7102 [279.99], Avg: 94.2871 (0.928)
Ep: 25, Reward: 660.3193, Test: 682.4830 [208.56], Avg: 108.8886 (0.925)
Ep: 26, Reward: 696.0776, Test: 640.7384 [270.17], Avg: 118.5805 (0.922)
Ep: 27, Reward: 576.3143, Test: 478.0149 [220.96], Avg: 123.5260 (0.919)
Ep: 28, Reward: 426.6305, Test: 626.4847 [282.72], Avg: 131.1204 (0.917)
Ep: 29, Reward: 511.1497, Test: 463.2556 [214.73], Avg: 135.0340 (0.914)
Ep: 30, Reward: 545.6015, Test: 477.4095 [211.83], Avg: 139.2451 (0.911)
Ep: 31, Reward: 541.4942, Test: 563.3081 [215.91], Avg: 145.7499 (0.908)
Ep: 32, Reward: 606.9594, Test: 583.0682 [269.17], Avg: 150.8452 (0.906)
Ep: 33, Reward: 688.2147, Test: 816.8140 [108.59], Avg: 167.2388 (0.903)
Ep: 34, Reward: 797.7798, Test: 702.3435 [140.26], Avg: 178.5201 (0.900)
Ep: 35, Reward: 732.9489, Test: 823.6522 [76.24], Avg: 194.3227 (0.897)
Ep: 36, Reward: 749.0016, Test: 837.9091 [86.23], Avg: 209.3864 (0.895)
Ep: 37, Reward: 760.7269, Test: 846.8949 [93.23], Avg: 223.7096 (0.892)
Ep: 38, Reward: 857.6722, Test: 806.2057 [202.69], Avg: 233.4483 (0.889)
Ep: 39, Reward: 811.7530, Test: 819.2754 [141.55], Avg: 244.5552 (0.887)
Ep: 40, Reward: 778.3572, Test: 798.4806 [88.18], Avg: 255.9148 (0.884)
Ep: 41, Reward: 754.4763, Test: 741.0501 [186.40], Avg: 263.0275 (0.881)
Ep: 42, Reward: 847.4375, Test: 832.5129 [79.69], Avg: 274.4180 (0.879)
Ep: 43, Reward: 800.7225, Test: 796.0902 [83.74], Avg: 284.3711 (0.876)
Ep: 44, Reward: 845.4390, Test: 885.8748 [27.62], Avg: 297.1241 (0.874)
Ep: 45, Reward: 838.8248, Test: 855.9338 [111.63], Avg: 306.8453 (0.871)
Ep: 46, Reward: 777.3667, Test: 759.7657 [226.37], Avg: 311.6655 (0.868)
Ep: 47, Reward: 809.6798, Test: 875.1890 [35.05], Avg: 322.6753 (0.866)
Ep: 48, Reward: 893.0015, Test: 873.7475 [45.20], Avg: 332.9993 (0.863)
Ep: 49, Reward: 853.5835, Test: 818.7093 [157.99], Avg: 339.5537 (0.861)
Ep: 50, Reward: 586.0481, Test: 753.7278 [184.74], Avg: 344.0524 (0.858)
Ep: 51, Reward: 750.3459, Test: 813.6569 [150.02], Avg: 350.1982 (0.855)
Ep: 52, Reward: 687.5239, Test: 606.3137 [225.73], Avg: 350.7715 (0.853)
Ep: 53, Reward: 677.6357, Test: 580.6309 [370.74], Avg: 348.1625 (0.850)
Ep: 54, Reward: 646.5983, Test: 597.6242 [378.54], Avg: 345.8157 (0.848)
Ep: 55, Reward: 738.7085, Test: 795.7719 [115.22], Avg: 351.7931 (0.845)
Ep: 56, Reward: 766.7433, Test: 709.6148 [320.23], Avg: 352.4527 (0.843)
Ep: 57, Reward: 866.7696, Test: 763.4820 [206.94], Avg: 355.9714 (0.840)
Ep: 58, Reward: 633.9235, Test: 777.9431 [157.48], Avg: 360.4544 (0.838)
Ep: 59, Reward: 551.1943, Test: 702.6530 [169.67], Avg: 363.3299 (0.835)
Ep: 60, Reward: 579.3968, Test: 515.1696 [287.26], Avg: 361.1099 (0.833)
Ep: 61, Reward: 736.8466, Test: 568.5150 [220.20], Avg: 360.9036 (0.830)
Ep: 62, Reward: 774.7585, Test: 693.6633 [231.51], Avg: 362.5107 (0.828)
Ep: 63, Reward: 843.4785, Test: 668.6637 [212.85], Avg: 363.9686 (0.825)
Ep: 64, Reward: 703.2649, Test: 540.4922 [349.50], Avg: 361.3074 (0.823)
Ep: 65, Reward: 738.1364, Test: 814.7969 [197.85], Avg: 365.1807 (0.820)
Ep: 66, Reward: 664.0211, Test: 453.7457 [283.92], Avg: 362.2650 (0.818)
Ep: 67, Reward: 664.4923, Test: 603.3241 [336.86], Avg: 360.8562 (0.815)
Ep: 68, Reward: 630.4311, Test: 599.2599 [294.25], Avg: 360.0469 (0.813)
Ep: 69, Reward: 569.0255, Test: 493.9759 [303.89], Avg: 357.6189 (0.810)
Ep: 70, Reward: 656.7521, Test: 476.6557 [287.86], Avg: 355.2411 (0.808)
Ep: 71, Reward: 650.1806, Test: 615.7001 [235.20], Avg: 355.5919 (0.805)
Ep: 72, Reward: 585.5771, Test: 687.5635 [226.02], Avg: 357.0433 (0.803)
Ep: 73, Reward: 653.4670, Test: 445.8718 [255.16], Avg: 354.7955 (0.801)
Ep: 74, Reward: 695.2963, Test: 550.7453 [308.85], Avg: 353.2902 (0.798)
Ep: 75, Reward: 645.4540, Test: 575.7735 [226.21], Avg: 353.2412 (0.796)
Ep: 76, Reward: 736.0901, Test: 635.9114 [200.44], Avg: 354.3091 (0.793)
Ep: 77, Reward: 679.1350, Test: 659.0891 [217.60], Avg: 355.4267 (0.791)
Ep: 78, Reward: 697.7833, Test: 734.1357 [110.62], Avg: 358.8203 (0.789)
Ep: 79, Reward: 792.6717, Test: 654.7671 [265.93], Avg: 359.1956 (0.786)
Ep: 80, Reward: 703.9165, Test: 653.5568 [193.16], Avg: 360.4450 (0.784)
Ep: 81, Reward: 554.9002, Test: 682.9025 [178.95], Avg: 362.1950 (0.782)
Ep: 82, Reward: 634.0421, Test: 539.4382 [171.07], Avg: 362.2694 (0.779)
Ep: 83, Reward: 508.2755, Test: 683.4395 [132.79], Avg: 364.5121 (0.777)
Ep: 84, Reward: 506.2597, Test: 389.5541 [147.71], Avg: 363.0689 (0.775)
Ep: 85, Reward: 462.8711, Test: 462.2542 [209.19], Avg: 361.7899 (0.772)
Ep: 86, Reward: 432.2044, Test: 471.3502 [182.70], Avg: 360.9492 (0.770)
Ep: 87, Reward: 538.1325, Test: 464.2005 [109.49], Avg: 360.8783 (0.768)
Ep: 88, Reward: 443.6953, Test: 497.2833 [172.69], Avg: 360.4706 (0.765)
Ep: 89, Reward: 396.3894, Test: 425.3386 [181.59], Avg: 359.1737 (0.763)
Ep: 90, Reward: 483.6103, Test: 446.6885 [185.84], Avg: 358.0931 (0.761)
Ep: 91, Reward: 427.8184, Test: 424.5663 [144.31], Avg: 357.2471 (0.758)
Ep: 92, Reward: 445.7071, Test: 386.1166 [171.15], Avg: 355.7172 (0.756)
Ep: 93, Reward: 418.1827, Test: 393.5413 [155.53], Avg: 354.4650 (0.754)
Ep: 94, Reward: 328.8410, Test: 308.0248 [198.96], Avg: 351.8818 (0.752)
Ep: 95, Reward: 318.7834, Test: 364.9350 [224.00], Avg: 349.6845 (0.749)
Ep: 96, Reward: 375.6818, Test: 251.7584 [151.46], Avg: 347.1135 (0.747)
Ep: 97, Reward: 334.4308, Test: 410.1696 [205.07], Avg: 345.6644 (0.745)
Ep: 98, Reward: 375.5579, Test: 510.6061 [141.51], Avg: 345.9011 (0.743)
Ep: 99, Reward: 403.2931, Test: 269.1322 [193.96], Avg: 343.1939 (0.740)
Ep: 100, Reward: 354.3718, Test: 417.1072 [197.36], Avg: 341.9716 (0.738)
Ep: 101, Reward: 374.0114, Test: 381.1763 [198.48], Avg: 340.4101 (0.736)
Ep: 102, Reward: 367.7905, Test: 407.1047 [148.69], Avg: 339.6140 (0.734)
Ep: 103, Reward: 417.0424, Test: 371.2461 [161.10], Avg: 338.3691 (0.732)
Ep: 104, Reward: 378.6017, Test: 307.7334 [183.16], Avg: 336.3330 (0.729)
Ep: 105, Reward: 347.0817, Test: 300.8358 [106.04], Avg: 334.9978 (0.727)
Ep: 106, Reward: 294.5268, Test: 290.0131 [175.03], Avg: 332.9416 (0.725)
Ep: 107, Reward: 200.3364, Test: 145.3341 [106.90], Avg: 330.2147 (0.723)
Ep: 108, Reward: 253.6781, Test: 153.7313 [118.53], Avg: 327.5082 (0.721)
Ep: 109, Reward: 195.3098, Test: 213.1259 [134.81], Avg: 325.2428 (0.719)
Ep: 110, Reward: 259.6868, Test: 235.7264 [143.40], Avg: 323.1445 (0.716)
Ep: 111, Reward: 233.0455, Test: 263.2831 [122.41], Avg: 321.5170 (0.714)
Ep: 112, Reward: 146.0425, Test: 175.4814 [130.60], Avg: 319.0689 (0.712)
Ep: 113, Reward: 243.9286, Test: 130.9875 [105.93], Avg: 316.4899 (0.710)
Ep: 114, Reward: 232.1096, Test: 210.3428 [141.15], Avg: 314.3395 (0.708)
Ep: 115, Reward: 248.6933, Test: 317.1733 [146.33], Avg: 313.1024 (0.706)
Ep: 116, Reward: 291.7863, Test: 190.8300 [182.46], Avg: 310.4978 (0.704)
Ep: 117, Reward: 309.9382, Test: 241.0003 [179.52], Avg: 308.3875 (0.702)
Ep: 118, Reward: 218.9330, Test: 189.7427 [141.06], Avg: 306.2052 (0.699)
Ep: 119, Reward: 157.8911, Test: 195.8418 [91.50], Avg: 304.5230 (0.697)
Ep: 120, Reward: 180.2847, Test: 224.5875 [133.94], Avg: 302.7554 (0.695)
Ep: 121, Reward: 126.3987, Test: 74.2930 [109.61], Avg: 299.9843 (0.693)
Ep: 122, Reward: 163.9758, Test: 105.3690 [120.30], Avg: 297.4240 (0.691)
Ep: 123, Reward: 90.2321, Test: 129.4383 [115.95], Avg: 295.1342 (0.689)
Ep: 124, Reward: 77.6148, Test: 107.8643 [89.07], Avg: 292.9236 (0.687)
Ep: 125, Reward: 136.8106, Test: 191.4751 [153.82], Avg: 290.8976 (0.685)
Ep: 126, Reward: 124.0362, Test: 128.9999 [139.79], Avg: 288.5221 (0.683)
Ep: 127, Reward: 94.4521, Test: 112.5084 [107.20], Avg: 286.3095 (0.681)
Ep: 128, Reward: 85.5177, Test: 91.3669 [102.46], Avg: 284.0040 (0.679)
Ep: 129, Reward: 170.8534, Test: 116.2860 [113.47], Avg: 281.8410 (0.677)
Ep: 130, Reward: 177.6389, Test: 204.6104 [122.12], Avg: 280.3192 (0.675)
Ep: 131, Reward: 237.7454, Test: 182.9697 [104.29], Avg: 278.7917 (0.673)
Ep: 132, Reward: 178.5107, Test: 202.4871 [141.76], Avg: 277.1521 (0.671)
Ep: 133, Reward: 209.4983, Test: 151.1476 [125.93], Avg: 275.2720 (0.669)
Ep: 134, Reward: 186.4554, Test: 219.9553 [166.34], Avg: 273.6301 (0.667)
Ep: 135, Reward: 203.0545, Test: 184.6013 [197.68], Avg: 271.5220 (0.665)
Ep: 136, Reward: 136.6969, Test: 251.2658 [150.51], Avg: 270.2755 (0.663)
Ep: 137, Reward: 214.2065, Test: 253.3830 [96.21], Avg: 269.4559 (0.661)
Ep: 138, Reward: 196.8041, Test: 92.7678 [112.55], Avg: 267.3751 (0.659)
Ep: 139, Reward: 208.0293, Test: 155.4947 [133.97], Avg: 265.6190 (0.657)
Ep: 140, Reward: 204.3233, Test: 172.1665 [110.13], Avg: 264.1751 (0.655)
Ep: 141, Reward: 283.0448, Test: 213.3423 [87.22], Avg: 263.2029 (0.653)
Ep: 142, Reward: 216.4131, Test: 215.3066 [138.48], Avg: 261.8995 (0.651)
Ep: 143, Reward: 263.3985, Test: 233.5192 [137.39], Avg: 260.7483 (0.649)
Ep: 144, Reward: 266.6144, Test: 236.2546 [113.16], Avg: 259.7990 (0.647)
Ep: 145, Reward: 275.5614, Test: 291.2081 [124.61], Avg: 259.1606 (0.645)
Ep: 146, Reward: 285.2627, Test: 240.3471 [90.50], Avg: 258.4170 (0.643)
Ep: 147, Reward: 281.2120, Test: 274.9602 [114.33], Avg: 257.7563 (0.641)
Ep: 148, Reward: 258.1633, Test: 236.8499 [145.00], Avg: 256.6428 (0.639)
Ep: 149, Reward: 279.3891, Test: 172.7366 [160.97], Avg: 255.0103 (0.637)
Ep: 150, Reward: 212.4791, Test: 213.0292 [111.98], Avg: 253.9907 (0.635)
Ep: 151, Reward: 356.4892, Test: 214.6535 [117.21], Avg: 252.9608 (0.633)
Ep: 152, Reward: 255.7063, Test: 143.0518 [81.69], Avg: 251.7085 (0.631)
Ep: 153, Reward: 279.3170, Test: 194.4731 [99.97], Avg: 250.6877 (0.630)
Ep: 154, Reward: 184.6680, Test: 208.0081 [132.95], Avg: 249.5546 (0.628)
Ep: 155, Reward: 246.9755, Test: 319.0464 [132.95], Avg: 249.1478 (0.626)
Ep: 156, Reward: 274.9515, Test: 296.1020 [82.88], Avg: 248.9189 (0.624)
Ep: 157, Reward: 260.6524, Test: 222.9320 [171.10], Avg: 247.6715 (0.622)
Ep: 158, Reward: 334.2859, Test: 325.1590 [156.39], Avg: 247.1753 (0.620)
Ep: 159, Reward: 173.0720, Test: 220.0294 [94.70], Avg: 246.4137 (0.618)
Ep: 160, Reward: 274.0292, Test: 223.9023 [160.39], Avg: 245.2777 (0.616)
Ep: 161, Reward: 273.6987, Test: 160.0602 [111.56], Avg: 244.0630 (0.615)
Ep: 162, Reward: 309.6367, Test: 244.4422 [97.54], Avg: 243.4669 (0.613)
Ep: 163, Reward: 334.9334, Test: 329.3982 [99.87], Avg: 243.3819 (0.611)
Ep: 164, Reward: 246.3150, Test: 277.0211 [138.74], Avg: 242.7450 (0.609)
Ep: 165, Reward: 265.4892, Test: 338.2485 [160.79], Avg: 242.3517 (0.607)
Ep: 166, Reward: 237.4632, Test: 247.9721 [100.33], Avg: 241.7846 (0.605)
Ep: 167, Reward: 250.8370, Test: 273.5575 [172.67], Avg: 240.9459 (0.604)
Ep: 168, Reward: 310.4654, Test: 330.7153 [229.58], Avg: 240.1186 (0.602)
Ep: 169, Reward: 313.7854, Test: 355.6848 [147.68], Avg: 239.9297 (0.600)
Ep: 170, Reward: 302.0064, Test: 333.9611 [140.53], Avg: 239.6578 (0.598)
Ep: 171, Reward: 320.8584, Test: 259.8475 [185.24], Avg: 238.6982 (0.596)
Ep: 172, Reward: 347.7231, Test: 260.1049 [163.98], Avg: 237.8741 (0.595)
Ep: 173, Reward: 280.3623, Test: 260.2551 [81.07], Avg: 237.5368 (0.593)
Ep: 174, Reward: 226.2310, Test: 288.1300 [168.94], Avg: 236.8605 (0.591)
Ep: 175, Reward: 342.6321, Test: 340.0955 [161.25], Avg: 236.5309 (0.589)
Ep: 176, Reward: 275.1660, Test: 277.8735 [119.94], Avg: 236.0869 (0.588)
Ep: 177, Reward: 222.4593, Test: 290.5581 [202.30], Avg: 235.2564 (0.586)
Ep: 178, Reward: 355.9770, Test: 248.4925 [210.29], Avg: 234.1555 (0.584)
Ep: 179, Reward: 298.3231, Test: 239.2194 [164.25], Avg: 233.2712 (0.582)
Ep: 180, Reward: 289.4947, Test: 379.2971 [168.03], Avg: 233.1496 (0.581)
Ep: 181, Reward: 359.5435, Test: 272.3066 [124.18], Avg: 232.6824 (0.579)
Ep: 182, Reward: 349.2297, Test: 318.6296 [139.84], Avg: 232.3880 (0.577)
Ep: 183, Reward: 455.6883, Test: 294.2259 [123.67], Avg: 232.0519 (0.575)
Ep: 184, Reward: 409.5863, Test: 313.3133 [124.69], Avg: 231.8172 (0.574)
Ep: 185, Reward: 296.7133, Test: 267.4769 [156.18], Avg: 231.1692 (0.572)
Ep: 186, Reward: 280.2451, Test: 288.1119 [95.03], Avg: 230.9655 (0.570)
Ep: 187, Reward: 233.3129, Test: 385.8998 [163.07], Avg: 230.9222 (0.568)
Ep: 188, Reward: 291.5643, Test: 235.5689 [126.34], Avg: 230.2784 (0.567)
Ep: 189, Reward: 380.1321, Test: 260.6738 [113.67], Avg: 229.8401 (0.565)
Ep: 190, Reward: 425.2005, Test: 311.9325 [158.47], Avg: 229.4402 (0.563)
Ep: 191, Reward: 333.2863, Test: 326.7117 [200.45], Avg: 228.9028 (0.562)
Ep: 192, Reward: 381.2305, Test: 329.3054 [128.50], Avg: 228.7572 (0.560)
Ep: 193, Reward: 286.9450, Test: 310.9208 [210.50], Avg: 228.0957 (0.558)
Ep: 194, Reward: 324.8329, Test: 230.7337 [173.11], Avg: 227.2215 (0.557)
Ep: 195, Reward: 340.7279, Test: 324.1420 [172.40], Avg: 226.8364 (0.555)
Ep: 196, Reward: 372.2917, Test: 452.4536 [163.45], Avg: 227.1519 (0.553)
Ep: 197, Reward: 298.7840, Test: 332.9249 [158.71], Avg: 226.8845 (0.552)
Ep: 198, Reward: 333.8336, Test: 278.9480 [101.98], Avg: 226.6337 (0.550)
Ep: 199, Reward: 321.2020, Test: 341.5566 [128.14], Avg: 226.5677 (0.548)
Ep: 200, Reward: 377.6868, Test: 203.4631 [157.06], Avg: 225.6713 (0.547)
Ep: 201, Reward: 257.6373, Test: 247.4683 [172.42], Avg: 224.9257 (0.545)
Ep: 202, Reward: 253.4809, Test: 258.9570 [198.11], Avg: 224.1174 (0.543)
Ep: 203, Reward: 309.8404, Test: 173.5413 [154.54], Avg: 223.1120 (0.542)
Ep: 204, Reward: 242.5747, Test: 242.6651 [190.14], Avg: 222.2798 (0.540)
Ep: 205, Reward: 238.1594, Test: 275.0191 [167.69], Avg: 221.7218 (0.539)
Ep: 206, Reward: 352.7543, Test: 260.9520 [184.28], Avg: 221.0211 (0.537)
Ep: 207, Reward: 224.5962, Test: 389.0012 [167.58], Avg: 221.0230 (0.535)
Ep: 208, Reward: 328.1746, Test: 342.8878 [208.44], Avg: 220.6088 (0.534)
Ep: 209, Reward: 308.8235, Test: 295.0957 [174.28], Avg: 220.1336 (0.532)
Ep: 210, Reward: 415.8819, Test: 433.4891 [161.58], Avg: 220.3789 (0.530)
Ep: 211, Reward: 429.5097, Test: 502.8234 [152.82], Avg: 220.9904 (0.529)
Ep: 212, Reward: 327.1205, Test: 384.6789 [170.00], Avg: 220.9608 (0.527)
Ep: 213, Reward: 373.5786, Test: 466.3878 [136.30], Avg: 221.4707 (0.526)
Ep: 214, Reward: 444.6142, Test: 364.1310 [206.76], Avg: 221.1726 (0.524)
Ep: 215, Reward: 319.8412, Test: 334.0368 [195.70], Avg: 220.7891 (0.523)
Ep: 216, Reward: 368.0917, Test: 377.6689 [198.36], Avg: 220.5979 (0.521)
Ep: 217, Reward: 461.6519, Test: 278.4725 [192.06], Avg: 219.9824 (0.519)
Ep: 218, Reward: 465.1896, Test: 471.0840 [180.90], Avg: 220.3029 (0.518)
Ep: 219, Reward: 327.2880, Test: 324.0812 [112.27], Avg: 220.2643 (0.516)
Ep: 220, Reward: 380.5913, Test: 370.7106 [224.88], Avg: 219.9275 (0.515)
Ep: 221, Reward: 407.1295, Test: 355.8823 [272.73], Avg: 219.3114 (0.513)
Ep: 222, Reward: 471.4842, Test: 432.4450 [179.12], Avg: 219.4639 (0.512)
Ep: 223, Reward: 391.9664, Test: 452.8905 [193.44], Avg: 219.6425 (0.510)
Ep: 224, Reward: 517.4348, Test: 378.7542 [197.73], Avg: 219.4708 (0.509)
Ep: 225, Reward: 412.4087, Test: 334.1726 [160.06], Avg: 219.2701 (0.507)
Ep: 226, Reward: 484.7499, Test: 530.9477 [204.22], Avg: 219.7435 (0.506)
Ep: 227, Reward: 394.0422, Test: 472.5367 [167.94], Avg: 220.1157 (0.504)
Ep: 228, Reward: 435.8800, Test: 447.9153 [170.22], Avg: 220.3672 (0.503)
Ep: 229, Reward: 477.1997, Test: 423.9360 [144.70], Avg: 220.6231 (0.501)
Ep: 230, Reward: 317.2970, Test: 408.9657 [153.23], Avg: 220.7751 (0.500)
Ep: 231, Reward: 430.5101, Test: 266.5992 [199.10], Avg: 220.1144 (0.498)
Ep: 232, Reward: 436.6857, Test: 329.5733 [152.85], Avg: 219.9282 (0.497)
Ep: 233, Reward: 494.8408, Test: 388.7521 [221.71], Avg: 219.7021 (0.495)
Ep: 234, Reward: 448.4297, Test: 427.7924 [148.33], Avg: 219.9564 (0.494)
Ep: 235, Reward: 566.4461, Test: 475.6016 [165.26], Avg: 220.3394 (0.492)
Ep: 236, Reward: 469.6969, Test: 416.5049 [125.88], Avg: 220.6360 (0.491)
Ep: 237, Reward: 499.8332, Test: 488.4271 [200.57], Avg: 220.9184 (0.489)
Ep: 238, Reward: 456.6947, Test: 412.1577 [93.92], Avg: 221.3256 (0.488)
Ep: 239, Reward: 487.6896, Test: 361.4834 [193.25], Avg: 221.1044 (0.486)
Ep: 240, Reward: 451.0089, Test: 414.7986 [179.35], Avg: 221.1639 (0.485)
Ep: 241, Reward: 510.5390, Test: 336.8844 [182.19], Avg: 220.8893 (0.483)
Ep: 242, Reward: 441.9879, Test: 394.9925 [174.98], Avg: 220.8857 (0.482)
Ep: 243, Reward: 440.6492, Test: 392.8093 [165.85], Avg: 220.9106 (0.480)
Ep: 244, Reward: 364.0605, Test: 449.0986 [169.45], Avg: 221.1503 (0.479)
Ep: 245, Reward: 395.4485, Test: 355.7175 [150.37], Avg: 221.0861 (0.478)
Ep: 246, Reward: 299.4152, Test: 363.9406 [127.74], Avg: 221.1473 (0.476)
Ep: 247, Reward: 434.1121, Test: 382.4483 [174.11], Avg: 221.0956 (0.475)
Ep: 248, Reward: 419.7446, Test: 392.0707 [192.83], Avg: 221.0079 (0.473)
Ep: 249, Reward: 429.1656, Test: 442.3397 [122.38], Avg: 221.4037 (0.472)
Ep: 250, Reward: 457.1807, Test: 410.8133 [173.26], Avg: 221.4680 (0.470)
Ep: 251, Reward: 543.1772, Test: 346.7874 [212.64], Avg: 221.1215 (0.469)
Ep: 252, Reward: 378.4396, Test: 371.5394 [172.52], Avg: 221.0342 (0.468)
Ep: 253, Reward: 475.4951, Test: 514.4086 [154.25], Avg: 221.5819 (0.466)
Ep: 254, Reward: 455.0948, Test: 412.9900 [156.67], Avg: 221.7181 (0.465)
Ep: 255, Reward: 491.5527, Test: 354.0476 [197.50], Avg: 221.4636 (0.463)
Ep: 256, Reward: 417.5714, Test: 513.1915 [109.43], Avg: 222.1729 (0.462)
Ep: 257, Reward: 419.1349, Test: 360.0415 [200.54], Avg: 221.9300 (0.461)
Ep: 258, Reward: 389.8901, Test: 453.3672 [177.57], Avg: 222.1380 (0.459)
Ep: 259, Reward: 485.9919, Test: 389.7455 [185.57], Avg: 222.0689 (0.458)
Ep: 260, Reward: 472.7751, Test: 473.0971 [181.05], Avg: 222.3370 (0.456)
Ep: 261, Reward: 393.4298, Test: 468.3021 [126.25], Avg: 222.7939 (0.455)
Ep: 262, Reward: 373.6278, Test: 404.9611 [143.04], Avg: 222.9427 (0.454)
Ep: 263, Reward: 361.3704, Test: 415.3919 [165.29], Avg: 223.0456 (0.452)
Ep: 264, Reward: 436.6477, Test: 423.8408 [182.70], Avg: 223.1139 (0.451)
Ep: 265, Reward: 436.9830, Test: 514.2061 [100.70], Avg: 223.8296 (0.450)
Ep: 266, Reward: 439.1271, Test: 477.7582 [112.02], Avg: 224.3611 (0.448)
Ep: 267, Reward: 435.4301, Test: 507.9766 [153.19], Avg: 224.8478 (0.447)
Ep: 268, Reward: 476.0658, Test: 372.9843 [171.81], Avg: 224.7598 (0.446)
Ep: 269, Reward: 450.3128, Test: 341.0573 [153.70], Avg: 224.6212 (0.444)
Ep: 270, Reward: 459.4806, Test: 453.6837 [163.18], Avg: 224.8644 (0.443)
Ep: 271, Reward: 456.1619, Test: 534.5325 [185.72], Avg: 225.3201 (0.442)
Ep: 272, Reward: 392.9811, Test: 435.2601 [263.06], Avg: 225.1255 (0.440)
Ep: 273, Reward: 395.5117, Test: 352.6843 [258.01], Avg: 224.6494 (0.439)
Ep: 274, Reward: 509.6437, Test: 488.9257 [176.21], Avg: 224.9696 (0.438)
Ep: 275, Reward: 465.3671, Test: 406.0897 [197.13], Avg: 224.9116 (0.436)
Ep: 276, Reward: 475.3598, Test: 436.4227 [158.50], Avg: 225.1030 (0.435)
Ep: 277, Reward: 482.7040, Test: 396.3562 [162.08], Avg: 225.1360 (0.434)
Ep: 278, Reward: 430.3931, Test: 418.8359 [218.60], Avg: 225.0467 (0.432)
Ep: 279, Reward: 438.9243, Test: 487.5658 [154.63], Avg: 225.4321 (0.431)
Ep: 280, Reward: 451.4952, Test: 568.1287 [159.66], Avg: 226.0834 (0.430)
Ep: 281, Reward: 465.1551, Test: 462.2863 [209.97], Avg: 226.1765 (0.429)
Ep: 282, Reward: 412.1975, Test: 378.2339 [208.26], Avg: 225.9779 (0.427)
Ep: 283, Reward: 539.9374, Test: 330.0917 [265.95], Avg: 225.4080 (0.426)
Ep: 284, Reward: 423.8361, Test: 532.1209 [192.97], Avg: 225.8071 (0.425)
Ep: 285, Reward: 465.6642, Test: 371.3415 [210.40], Avg: 225.5803 (0.423)
Ep: 286, Reward: 452.4913, Test: 465.4435 [234.85], Avg: 225.5978 (0.422)
Ep: 287, Reward: 521.5853, Test: 485.3820 [209.06], Avg: 225.7739 (0.421)
Ep: 288, Reward: 457.7482, Test: 483.1667 [224.12], Avg: 225.8891 (0.420)
Ep: 289, Reward: 541.6267, Test: 453.9570 [174.97], Avg: 226.0722 (0.418)
Ep: 290, Reward: 475.2867, Test: 524.2379 [149.76], Avg: 226.5822 (0.417)
Ep: 291, Reward: 520.0927, Test: 455.6858 [286.19], Avg: 226.3866 (0.416)
Ep: 292, Reward: 541.8795, Test: 548.5467 [152.51], Avg: 226.9657 (0.415)
Ep: 293, Reward: 445.3044, Test: 582.9609 [257.83], Avg: 227.2996 (0.413)
Ep: 294, Reward: 595.3888, Test: 537.1214 [109.70], Avg: 227.9779 (0.412)
Ep: 295, Reward: 514.6397, Test: 441.1078 [270.88], Avg: 227.7829 (0.411)
Ep: 296, Reward: 502.5626, Test: 592.7490 [85.52], Avg: 228.7237 (0.410)
Ep: 297, Reward: 434.7234, Test: 442.9236 [180.93], Avg: 228.8354 (0.408)
Ep: 298, Reward: 501.5835, Test: 521.1395 [182.55], Avg: 229.2025 (0.407)
Ep: 299, Reward: 446.3470, Test: 582.1474 [229.66], Avg: 229.6134 (0.406)
Ep: 300, Reward: 431.3691, Test: 435.5819 [214.47], Avg: 229.5852 (0.405)
Ep: 301, Reward: 457.2916, Test: 523.9682 [160.03], Avg: 230.0300 (0.404)
Ep: 302, Reward: 551.3725, Test: 475.7554 [165.69], Avg: 230.2942 (0.402)
Ep: 303, Reward: 467.6111, Test: 513.5680 [254.77], Avg: 230.3879 (0.401)
Ep: 304, Reward: 502.5662, Test: 534.0307 [152.68], Avg: 230.8829 (0.400)
Ep: 305, Reward: 451.2085, Test: 518.7171 [185.23], Avg: 231.2182 (0.399)
Ep: 306, Reward: 578.5150, Test: 467.5242 [131.85], Avg: 231.5584 (0.398)
Ep: 307, Reward: 565.8155, Test: 552.6262 [236.20], Avg: 231.8340 (0.396)
Ep: 308, Reward: 568.8115, Test: 539.2294 [192.28], Avg: 232.2065 (0.395)
Ep: 309, Reward: 519.6585, Test: 561.7908 [155.54], Avg: 232.7679 (0.394)
Ep: 310, Reward: 511.9990, Test: 606.0355 [143.71], Avg: 233.5061 (0.393)
Ep: 311, Reward: 554.8781, Test: 675.5040 [112.58], Avg: 234.5619 (0.392)
Ep: 312, Reward: 563.4774, Test: 462.8496 [216.99], Avg: 234.5980 (0.390)
Ep: 313, Reward: 581.0934, Test: 520.8175 [218.37], Avg: 234.8141 (0.389)
Ep: 314, Reward: 498.1703, Test: 590.7876 [138.59], Avg: 235.5042 (0.388)
Ep: 315, Reward: 584.5058, Test: 499.5424 [196.51], Avg: 235.7179 (0.387)
Ep: 316, Reward: 617.2911, Test: 563.5593 [202.55], Avg: 236.1131 (0.386)
Ep: 317, Reward: 512.5606, Test: 653.7420 [147.32], Avg: 236.9632 (0.385)
Ep: 318, Reward: 599.7897, Test: 546.2891 [149.42], Avg: 237.4644 (0.383)
Ep: 319, Reward: 527.1879, Test: 543.3100 [219.86], Avg: 237.7331 (0.382)
Ep: 320, Reward: 616.6439, Test: 613.3037 [110.90], Avg: 238.5577 (0.381)
Ep: 321, Reward: 532.1966, Test: 641.1804 [167.96], Avg: 239.2864 (0.380)
Ep: 322, Reward: 675.9221, Test: 583.3683 [126.50], Avg: 239.9600 (0.379)
Ep: 323, Reward: 652.4485, Test: 575.5845 [189.52], Avg: 240.4110 (0.378)
Ep: 324, Reward: 616.1606, Test: 592.0596 [146.57], Avg: 241.0420 (0.377)
Ep: 325, Reward: 574.1307, Test: 633.5816 [143.77], Avg: 241.8051 (0.376)
Ep: 326, Reward: 545.6538, Test: 577.7456 [184.93], Avg: 242.2669 (0.374)
Ep: 327, Reward: 525.9439, Test: 537.3529 [162.37], Avg: 242.6715 (0.373)
Ep: 328, Reward: 593.5284, Test: 628.9887 [111.62], Avg: 243.5065 (0.372)
Ep: 329, Reward: 591.1204, Test: 580.1339 [138.11], Avg: 244.1080 (0.371)
Ep: 330, Reward: 569.5310, Test: 552.7737 [140.10], Avg: 244.6173 (0.370)
Ep: 331, Reward: 560.1442, Test: 603.6202 [132.02], Avg: 245.3010 (0.369)
Ep: 332, Reward: 506.6684, Test: 516.0384 [178.71], Avg: 245.5773 (0.368)
Ep: 333, Reward: 555.9840, Test: 553.9565 [136.89], Avg: 246.0908 (0.367)
Ep: 334, Reward: 622.6262, Test: 541.6954 [119.01], Avg: 246.6179 (0.365)
Ep: 335, Reward: 508.3134, Test: 526.1737 [184.04], Avg: 246.9022 (0.364)
Ep: 336, Reward: 600.8025, Test: 469.9136 [216.61], Avg: 246.9212 (0.363)
Ep: 337, Reward: 651.9597, Test: 472.9211 [206.02], Avg: 246.9803 (0.362)
Ep: 338, Reward: 486.2766, Test: 588.8901 [124.78], Avg: 247.6208 (0.361)
Ep: 339, Reward: 532.7831, Test: 630.0307 [116.78], Avg: 248.4020 (0.360)
Ep: 340, Reward: 580.2992, Test: 561.1064 [138.85], Avg: 248.9119 (0.359)
Ep: 341, Reward: 555.2331, Test: 482.3741 [178.70], Avg: 249.0720 (0.358)
Ep: 342, Reward: 650.0871, Test: 643.0309 [96.49], Avg: 249.9392 (0.357)
Ep: 343, Reward: 530.8585, Test: 612.8075 [156.71], Avg: 250.5385 (0.356)
Ep: 344, Reward: 678.4263, Test: 558.9878 [114.26], Avg: 251.1014 (0.355)
Ep: 345, Reward: 588.3655, Test: 621.8255 [102.70], Avg: 251.8760 (0.354)
Ep: 346, Reward: 570.3945, Test: 555.4561 [161.93], Avg: 252.2843 (0.353)
Ep: 347, Reward: 604.4136, Test: 535.8011 [99.25], Avg: 252.8138 (0.351)
Ep: 348, Reward: 623.4682, Test: 576.9119 [103.52], Avg: 253.4458 (0.350)
Ep: 349, Reward: 605.9910, Test: 519.6735 [153.89], Avg: 253.7668 (0.349)
Ep: 350, Reward: 547.1761, Test: 525.6535 [189.54], Avg: 254.0014 (0.348)
Ep: 351, Reward: 492.0533, Test: 607.9901 [139.29], Avg: 254.6113 (0.347)
Ep: 352, Reward: 628.9362, Test: 547.2215 [149.14], Avg: 255.0178 (0.346)
Ep: 353, Reward: 601.7558, Test: 586.4482 [160.40], Avg: 255.5009 (0.345)
Ep: 354, Reward: 525.0803, Test: 484.5651 [155.41], Avg: 255.7084 (0.344)
Ep: 355, Reward: 458.1569, Test: 552.1718 [129.98], Avg: 256.1760 (0.343)
Ep: 356, Reward: 632.2746, Test: 493.6350 [143.23], Avg: 256.4400 (0.342)
Ep: 357, Reward: 575.8173, Test: 644.4689 [121.75], Avg: 257.1838 (0.341)
Ep: 358, Reward: 508.8958, Test: 565.7973 [185.87], Avg: 257.5257 (0.340)
Ep: 359, Reward: 565.3598, Test: 504.6909 [199.36], Avg: 257.6584 (0.339)
Ep: 360, Reward: 565.5410, Test: 539.9911 [146.94], Avg: 258.0335 (0.338)
Ep: 361, Reward: 608.8341, Test: 591.7035 [197.19], Avg: 258.4105 (0.337)
Ep: 362, Reward: 612.5840, Test: 496.9963 [188.99], Avg: 258.5471 (0.336)
Ep: 363, Reward: 613.8640, Test: 565.0994 [126.18], Avg: 259.0427 (0.335)
Ep: 364, Reward: 532.8796, Test: 574.9079 [82.35], Avg: 259.6824 (0.334)
Ep: 365, Reward: 540.7335, Test: 527.0065 [210.76], Avg: 259.8370 (0.333)
Ep: 366, Reward: 613.2678, Test: 602.0108 [140.56], Avg: 260.3863 (0.332)
Ep: 367, Reward: 553.8585, Test: 616.8340 [126.94], Avg: 261.0100 (0.331)
Ep: 368, Reward: 573.8805, Test: 584.6914 [104.90], Avg: 261.6029 (0.330)
Ep: 369, Reward: 588.0412, Test: 524.7478 [201.15], Avg: 261.7704 (0.329)
Ep: 370, Reward: 613.5251, Test: 458.4861 [219.51], Avg: 261.7090 (0.328)
Ep: 371, Reward: 551.6648, Test: 475.9689 [163.39], Avg: 261.8458 (0.327)
Ep: 372, Reward: 535.1578, Test: 566.0627 [116.45], Avg: 262.3491 (0.326)
Ep: 373, Reward: 626.1788, Test: 614.7268 [106.23], Avg: 263.0073 (0.325)
Ep: 374, Reward: 552.1843, Test: 547.9015 [216.42], Avg: 263.1899 (0.324)
Ep: 375, Reward: 705.6412, Test: 612.7560 [165.69], Avg: 263.6789 (0.323)
Ep: 376, Reward: 634.6204, Test: 613.1090 [158.52], Avg: 264.1853 (0.322)
Ep: 377, Reward: 612.6036, Test: 620.8822 [167.68], Avg: 264.6854 (0.321)
Ep: 378, Reward: 578.1573, Test: 613.5763 [85.17], Avg: 265.3812 (0.320)
Ep: 379, Reward: 683.2248, Test: 698.9638 [115.87], Avg: 266.2173 (0.319)
Ep: 380, Reward: 619.0071, Test: 605.3043 [165.65], Avg: 266.6725 (0.318)
Ep: 381, Reward: 655.4950, Test: 701.9136 [78.16], Avg: 267.6073 (0.317)
Ep: 382, Reward: 636.3158, Test: 599.0445 [144.27], Avg: 268.0960 (0.316)
Ep: 383, Reward: 637.1010, Test: 624.3831 [136.79], Avg: 268.6676 (0.315)
Ep: 384, Reward: 687.2951, Test: 670.4289 [55.16], Avg: 269.5678 (0.315)
Ep: 385, Reward: 617.9789, Test: 665.4703 [148.12], Avg: 270.2098 (0.314)
Ep: 386, Reward: 635.8360, Test: 588.9233 [173.22], Avg: 270.5857 (0.313)
Ep: 387, Reward: 662.6171, Test: 640.5541 [111.67], Avg: 271.2514 (0.312)
Ep: 388, Reward: 623.1959, Test: 661.8661 [149.27], Avg: 271.8719 (0.311)
Ep: 389, Reward: 575.8711, Test: 606.7464 [157.24], Avg: 272.3273 (0.310)
Ep: 390, Reward: 597.7470, Test: 640.3503 [117.50], Avg: 272.9681 (0.309)
Ep: 391, Reward: 619.1596, Test: 675.0050 [126.17], Avg: 273.6718 (0.308)
Ep: 392, Reward: 581.0502, Test: 562.0629 [161.66], Avg: 273.9943 (0.307)
Ep: 393, Reward: 608.7797, Test: 660.9435 [83.28], Avg: 274.7650 (0.306)
Ep: 394, Reward: 601.8992, Test: 520.2069 [158.35], Avg: 274.9855 (0.305)
Ep: 395, Reward: 617.2197, Test: 625.8933 [141.08], Avg: 275.5154 (0.304)
Ep: 396, Reward: 619.6794, Test: 640.7974 [96.33], Avg: 276.1929 (0.303)
Ep: 397, Reward: 550.6379, Test: 492.3267 [224.19], Avg: 276.1726 (0.302)
Ep: 398, Reward: 598.5842, Test: 595.5716 [159.88], Avg: 276.5724 (0.302)
Ep: 399, Reward: 625.7172, Test: 630.0611 [151.36], Avg: 277.0777 (0.301)
Ep: 400, Reward: 655.1421, Test: 517.9343 [175.44], Avg: 277.2409 (0.300)
Ep: 401, Reward: 614.7071, Test: 692.8090 [84.30], Avg: 278.0649 (0.299)
Ep: 402, Reward: 629.3000, Test: 600.0708 [190.24], Avg: 278.3919 (0.298)
Ep: 403, Reward: 585.6571, Test: 569.8879 [141.89], Avg: 278.7622 (0.297)
Ep: 404, Reward: 594.4490, Test: 550.5655 [175.84], Avg: 278.9991 (0.296)
Ep: 405, Reward: 578.2752, Test: 562.0044 [175.12], Avg: 279.2649 (0.295)
Ep: 406, Reward: 612.2325, Test: 618.0822 [161.49], Avg: 279.7006 (0.294)
Ep: 407, Reward: 602.6623, Test: 490.6166 [215.96], Avg: 279.6882 (0.294)
Ep: 408, Reward: 542.0063, Test: 660.0538 [117.92], Avg: 280.3299 (0.293)
Ep: 409, Reward: 639.2744, Test: 604.9224 [160.70], Avg: 280.7296 (0.292)
Ep: 410, Reward: 619.8114, Test: 583.8898 [154.38], Avg: 281.0916 (0.291)
Ep: 411, Reward: 560.1347, Test: 661.7535 [99.94], Avg: 281.7730 (0.290)
Ep: 412, Reward: 626.2468, Test: 593.1342 [98.68], Avg: 282.2879 (0.289)
Ep: 413, Reward: 613.7176, Test: 601.5081 [148.45], Avg: 282.7004 (0.288)
Ep: 414, Reward: 526.2013, Test: 615.7083 [103.77], Avg: 283.2528 (0.287)
Ep: 415, Reward: 606.2835, Test: 570.7268 [130.06], Avg: 283.6312 (0.287)
Ep: 416, Reward: 570.0716, Test: 512.5626 [178.04], Avg: 283.7532 (0.286)
Ep: 417, Reward: 655.6324, Test: 661.7034 [81.43], Avg: 284.4626 (0.285)
Ep: 418, Reward: 706.6503, Test: 549.9037 [112.07], Avg: 284.8286 (0.284)
Ep: 419, Reward: 669.3160, Test: 643.4012 [58.26], Avg: 285.5437 (0.283)
Ep: 420, Reward: 690.0656, Test: 618.2180 [126.92], Avg: 286.0324 (0.282)
Ep: 421, Reward: 651.9398, Test: 674.2339 [112.18], Avg: 286.6865 (0.281)
Ep: 422, Reward: 644.4006, Test: 608.1878 [97.97], Avg: 287.2149 (0.281)
Ep: 423, Reward: 671.8574, Test: 675.2530 [136.51], Avg: 287.8081 (0.280)
Ep: 424, Reward: 689.4032, Test: 674.8663 [98.53], Avg: 288.4870 (0.279)
Ep: 425, Reward: 579.7631, Test: 639.7651 [201.28], Avg: 288.8391 (0.278)
Ep: 426, Reward: 672.3823, Test: 616.0894 [216.48], Avg: 289.0985 (0.277)
Ep: 427, Reward: 689.7467, Test: 638.6329 [65.90], Avg: 289.7612 (0.276)
Ep: 428, Reward: 621.2814, Test: 663.5733 [98.06], Avg: 290.4040 (0.276)
Ep: 429, Reward: 661.0244, Test: 572.9058 [175.34], Avg: 290.6532 (0.275)
Ep: 430, Reward: 671.7614, Test: 614.2055 [136.84], Avg: 291.0864 (0.274)
Ep: 431, Reward: 602.4874, Test: 655.2799 [66.83], Avg: 291.7747 (0.273)
Ep: 432, Reward: 622.6398, Test: 589.9720 [133.64], Avg: 292.1548 (0.272)
Ep: 433, Reward: 644.7889, Test: 677.4544 [73.77], Avg: 292.8726 (0.271)
Ep: 434, Reward: 561.5485, Test: 690.8322 [44.23], Avg: 293.6857 (0.271)
Ep: 435, Reward: 609.4391, Test: 610.4204 [136.44], Avg: 294.0993 (0.270)
Ep: 436, Reward: 658.2162, Test: 657.9645 [129.59], Avg: 294.6354 (0.269)
Ep: 437, Reward: 600.7417, Test: 714.1941 [51.85], Avg: 295.4749 (0.268)
Ep: 438, Reward: 600.4823, Test: 650.6479 [119.99], Avg: 296.0106 (0.267)
Ep: 439, Reward: 691.5299, Test: 629.5942 [109.16], Avg: 296.5207 (0.267)
Ep: 440, Reward: 662.0489, Test: 680.1884 [46.70], Avg: 297.2848 (0.266)
Ep: 441, Reward: 634.0717, Test: 689.5816 [121.61], Avg: 297.8972 (0.265)
Ep: 442, Reward: 621.2368, Test: 683.3124 [82.40], Avg: 298.5812 (0.264)
Ep: 443, Reward: 668.4217, Test: 678.2874 [147.61], Avg: 299.1040 (0.263)
Ep: 444, Reward: 690.7480, Test: 636.2752 [133.99], Avg: 299.5605 (0.263)
Ep: 445, Reward: 702.8251, Test: 526.2527 [196.02], Avg: 299.6293 (0.262)
Ep: 446, Reward: 640.1571, Test: 662.5656 [59.38], Avg: 300.3084 (0.261)
Ep: 447, Reward: 670.6665, Test: 621.2060 [167.57], Avg: 300.6507 (0.260)
Ep: 448, Reward: 649.2212, Test: 634.7616 [115.55], Avg: 301.1375 (0.259)
Ep: 449, Reward: 646.9213, Test: 637.7746 [101.03], Avg: 301.6610 (0.259)
Ep: 450, Reward: 689.5467, Test: 643.7979 [108.06], Avg: 302.1800 (0.258)
Ep: 451, Reward: 621.5201, Test: 673.3198 [89.74], Avg: 302.8026 (0.257)
Ep: 452, Reward: 571.1730, Test: 671.3831 [73.48], Avg: 303.4540 (0.256)
Ep: 453, Reward: 643.7526, Test: 620.4258 [152.76], Avg: 303.8158 (0.256)
Ep: 454, Reward: 637.6023, Test: 670.0999 [111.69], Avg: 304.3753 (0.255)
Ep: 455, Reward: 685.5154, Test: 652.8996 [104.74], Avg: 304.9099 (0.254)
Ep: 456, Reward: 599.5623, Test: 678.6337 [105.59], Avg: 305.4966 (0.253)
Ep: 457, Reward: 700.1298, Test: 659.8466 [167.74], Avg: 305.9041 (0.253)
Ep: 458, Reward: 642.9254, Test: 695.9403 [60.82], Avg: 306.6213 (0.252)
Ep: 459, Reward: 608.3564, Test: 577.2819 [158.15], Avg: 306.8659 (0.251)
Ep: 460, Reward: 593.1374, Test: 582.7503 [132.39], Avg: 307.1772 (0.250)
Ep: 461, Reward: 622.3743, Test: 624.6365 [103.05], Avg: 307.6413 (0.250)
Ep: 462, Reward: 627.6681, Test: 659.2889 [230.10], Avg: 307.9038 (0.249)
Ep: 463, Reward: 661.3338, Test: 573.9241 [148.81], Avg: 308.1564 (0.248)
Ep: 464, Reward: 715.6663, Test: 638.2928 [156.47], Avg: 308.5299 (0.247)
Ep: 465, Reward: 676.0893, Test: 628.1726 [189.01], Avg: 308.8102 (0.247)
Ep: 466, Reward: 614.1422, Test: 662.4443 [60.22], Avg: 309.4385 (0.246)
Ep: 467, Reward: 674.1329, Test: 661.2550 [157.38], Avg: 309.8540 (0.245)
Ep: 468, Reward: 598.2143, Test: 628.1010 [87.18], Avg: 310.3467 (0.244)
Ep: 469, Reward: 672.8620, Test: 673.5996 [90.89], Avg: 310.9261 (0.244)
Ep: 470, Reward: 641.3729, Test: 695.3800 [117.60], Avg: 311.4927 (0.243)
Ep: 471, Reward: 622.0262, Test: 595.2004 [132.87], Avg: 311.8123 (0.242)
Ep: 472, Reward: 669.3195, Test: 699.0646 [123.10], Avg: 312.3708 (0.241)
Ep: 473, Reward: 634.1090, Test: 695.7726 [133.04], Avg: 312.8989 (0.241)
Ep: 474, Reward: 584.1090, Test: 672.4763 [91.49], Avg: 313.4633 (0.240)
Ep: 475, Reward: 673.9949, Test: 639.2218 [158.99], Avg: 313.8137 (0.239)
Ep: 476, Reward: 631.3378, Test: 660.7167 [113.30], Avg: 314.3034 (0.239)
Ep: 477, Reward: 627.3492, Test: 654.3673 [196.76], Avg: 314.6032 (0.238)
Ep: 478, Reward: 681.0174, Test: 591.5214 [121.73], Avg: 314.9272 (0.237)
Ep: 479, Reward: 665.0615, Test: 708.3853 [72.01], Avg: 315.5969 (0.236)
Ep: 480, Reward: 691.6730, Test: 591.1306 [239.05], Avg: 315.6727 (0.236)
Ep: 481, Reward: 589.5631, Test: 618.0026 [246.52], Avg: 315.7885 (0.235)
Ep: 482, Reward: 660.0337, Test: 621.1038 [123.95], Avg: 316.1640 (0.234)
Ep: 483, Reward: 678.9802, Test: 728.5971 [65.48], Avg: 316.8809 (0.234)
Ep: 484, Reward: 715.5895, Test: 561.0306 [211.64], Avg: 316.9479 (0.233)
Ep: 485, Reward: 614.6439, Test: 615.1043 [130.00], Avg: 317.2939 (0.232)
Ep: 486, Reward: 718.2812, Test: 697.9604 [93.20], Avg: 317.8842 (0.231)
Ep: 487, Reward: 698.2180, Test: 702.4182 [107.16], Avg: 318.4526 (0.231)
Ep: 488, Reward: 685.3642, Test: 709.5963 [61.64], Avg: 319.1264 (0.230)
Ep: 489, Reward: 689.8740, Test: 691.2591 [83.26], Avg: 319.7159 (0.229)
Ep: 490, Reward: 724.0589, Test: 661.4334 [120.25], Avg: 320.1670 (0.229)
Ep: 491, Reward: 669.0022, Test: 650.0147 [93.43], Avg: 320.6475 (0.228)
Ep: 492, Reward: 663.1850, Test: 609.8352 [145.42], Avg: 320.9392 (0.227)
Ep: 493, Reward: 647.3034, Test: 665.3306 [167.38], Avg: 321.2975 (0.227)
Ep: 494, Reward: 651.7887, Test: 676.3027 [103.68], Avg: 321.8052 (0.226)
Ep: 495, Reward: 705.1746, Test: 704.2568 [58.29], Avg: 322.4588 (0.225)
Ep: 496, Reward: 673.3911, Test: 670.4992 [95.51], Avg: 322.9669 (0.225)
Ep: 497, Reward: 626.1269, Test: 627.5405 [185.12], Avg: 323.2067 (0.224)
Ep: 498, Reward: 628.9222, Test: 634.1340 [137.28], Avg: 323.5547 (0.223)
Ep: 499, Reward: 700.6653, Test: 599.8202 [187.62], Avg: 323.7320 (0.223)
