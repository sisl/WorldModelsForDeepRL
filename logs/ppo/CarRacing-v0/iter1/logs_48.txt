Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.05				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((len(self.replay_buffer)*PPO_EPOCHS)//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -29.1046, Test: -63.4911 [3.37], Avg: -66.8594 (0.997)
Ep: 1, Reward: -71.3946, Test: -74.6816 [10.23], Avg: -75.8837 (0.994)
Ep: 2, Reward: -74.0784, Test: -60.6050 [16.77], Avg: -76.3816 (0.991)
Ep: 3, Reward: -36.7697, Test: 123.0724 [88.18], Avg: -48.5643 (0.988)
Ep: 4, Reward: 79.9586, Test: 110.5489 [82.77], Avg: -33.2963 (0.985)
Ep: 5, Reward: 238.7660, Test: 231.0251 [175.21], Avg: -18.4447 (0.982)
Ep: 6, Reward: 234.0198, Test: 488.8873 [134.52], Avg: 34.8143 (0.979)
Ep: 7, Reward: 453.7195, Test: 717.8829 [153.65], Avg: 100.9914 (0.976)
Ep: 8, Reward: 726.8927, Test: 740.3833 [139.66], Avg: 156.5173 (0.973)
Ep: 9, Reward: 441.1653, Test: 504.4729 [192.22], Avg: 172.0911 (0.970)
Ep: 10, Reward: 347.2524, Test: 759.8529 [103.66], Avg: 216.1007 (0.967)
Ep: 11, Reward: 668.4171, Test: 487.1734 [188.19], Avg: 223.0077 (0.965)
Ep: 12, Reward: 674.5504, Test: 602.8525 [234.62], Avg: 234.1785 (0.962)
Ep: 13, Reward: 483.7744, Test: 463.9403 [155.60], Avg: 239.4755 (0.959)
Ep: 14, Reward: 631.2626, Test: 671.8667 [148.36], Avg: 258.4108 (0.956)
Ep: 15, Reward: 315.5433, Test: 563.3872 [160.00], Avg: 267.4719 (0.953)
Ep: 16, Reward: 507.8316, Test: 376.1468 [203.25], Avg: 261.9089 (0.950)
Ep: 17, Reward: 513.1766, Test: 441.7392 [172.10], Avg: 262.3381 (0.947)
Ep: 18, Reward: 508.1101, Test: 389.0380 [217.43], Avg: 257.5630 (0.945)
Ep: 19, Reward: 462.8364, Test: 391.7644 [138.86], Avg: 257.3301 (0.942)
Ep: 20, Reward: 478.9277, Test: 484.1041 [214.51], Avg: 257.9140 (0.939)
Ep: 21, Reward: 351.4824, Test: 490.2756 [148.78], Avg: 261.7134 (0.936)
Ep: 22, Reward: 436.9700, Test: 336.7886 [258.88], Avg: 253.7221 (0.933)
Ep: 23, Reward: 427.9049, Test: 203.9255 [133.23], Avg: 246.0959 (0.928)
Ep: 24, Reward: 471.4161, Test: 343.7693 [166.52], Avg: 243.3420 (0.925)
Ep: 25, Reward: 404.4006, Test: 460.0687 [218.77], Avg: 243.2634 (0.922)
Ep: 26, Reward: 432.4842, Test: 407.4039 [217.05], Avg: 241.3037 (0.919)
Ep: 27, Reward: 707.8714, Test: 774.3967 [93.22], Avg: 257.0134 (0.917)
Ep: 28, Reward: 710.0326, Test: 597.3211 [198.65], Avg: 261.8981 (0.914)
Ep: 29, Reward: 725.1244, Test: 584.1703 [198.00], Avg: 266.0405 (0.911)
Ep: 30, Reward: 727.5730, Test: 810.3605 [111.08], Avg: 280.0159 (0.908)
Ep: 31, Reward: 732.3283, Test: 546.0457 [325.87], Avg: 278.1460 (0.906)
Ep: 32, Reward: 711.8866, Test: 645.6435 [272.23], Avg: 281.0330 (0.903)
Ep: 33, Reward: 686.0713, Test: 821.2093 [86.81], Avg: 294.3672 (0.900)
Ep: 34, Reward: 764.9116, Test: 763.6926 [261.87], Avg: 300.2944 (0.897)
Ep: 35, Reward: 837.1906, Test: 815.5192 [116.65], Avg: 311.3660 (0.895)
Ep: 36, Reward: 802.1522, Test: 823.5141 [72.40], Avg: 323.2511 (0.892)
Ep: 37, Reward: 790.8949, Test: 553.8727 [249.21], Avg: 322.7618 (0.889)
Ep: 38, Reward: 726.5435, Test: 701.2457 [163.35], Avg: 328.2780 (0.887)
Ep: 39, Reward: 426.3724, Test: 421.3905 [247.60], Avg: 324.4159 (0.884)
Ep: 40, Reward: 554.8470, Test: 380.5877 [162.85], Avg: 321.8139 (0.881)
Ep: 41, Reward: 391.6784, Test: 251.2527 [89.15], Avg: 318.0113 (0.879)
Ep: 42, Reward: 414.1847, Test: 354.8802 [190.64], Avg: 314.4352 (0.876)
Ep: 43, Reward: 303.6957, Test: 303.2903 [142.02], Avg: 310.9542 (0.874)
Ep: 44, Reward: 289.5860, Test: 305.6683 [164.71], Avg: 307.1764 (0.871)
Ep: 45, Reward: 445.5862, Test: 599.9763 [154.69], Avg: 310.1787 (0.868)
Ep: 46, Reward: 518.1445, Test: 570.7793 [198.77], Avg: 311.4942 (0.866)
Ep: 47, Reward: 467.0281, Test: 485.1062 [250.82], Avg: 309.8858 (0.863)
Ep: 48, Reward: 603.6600, Test: 713.7936 [169.70], Avg: 314.6655 (0.861)
Ep: 49, Reward: 616.2662, Test: 598.0238 [250.87], Avg: 315.3153 (0.858)
Ep: 50, Reward: 726.1427, Test: 538.8727 [219.03], Avg: 315.4040 (0.855)
Ep: 51, Reward: 722.4853, Test: 715.6206 [199.21], Avg: 319.2695 (0.853)
Ep: 52, Reward: 599.2627, Test: 740.6884 [232.08], Avg: 322.8420 (0.850)
Ep: 53, Reward: 646.9089, Test: 571.1819 [239.76], Avg: 323.0009 (0.848)
Ep: 54, Reward: 440.6593, Test: 516.3143 [260.90], Avg: 321.7720 (0.845)
Ep: 55, Reward: 512.7297, Test: 511.8396 [171.53], Avg: 322.1031 (0.843)
Ep: 56, Reward: 547.2195, Test: 712.0971 [151.99], Avg: 326.2786 (0.840)
Ep: 57, Reward: 692.2992, Test: 515.7099 [277.61], Avg: 324.7582 (0.838)
Ep: 58, Reward: 500.2626, Test: 548.9475 [154.56], Avg: 325.9384 (0.835)
Ep: 59, Reward: 586.4810, Test: 625.2484 [145.13], Avg: 328.5080 (0.833)
Ep: 60, Reward: 624.5477, Test: 546.7926 [235.65], Avg: 328.2234 (0.830)
Ep: 61, Reward: 633.0968, Test: 623.6596 [219.82], Avg: 329.4430 (0.828)
Ep: 62, Reward: 655.7539, Test: 561.8491 [212.79], Avg: 329.7543 (0.825)
Ep: 63, Reward: 588.2176, Test: 590.5835 [290.12], Avg: 329.2966 (0.823)
Ep: 64, Reward: 578.8152, Test: 573.6161 [228.57], Avg: 329.5388 (0.820)
Ep: 65, Reward: 727.4859, Test: 630.8746 [304.04], Avg: 329.4978 (0.818)
Ep: 66, Reward: 614.4406, Test: 565.5332 [202.87], Avg: 329.9929 (0.815)
Ep: 67, Reward: 626.5805, Test: 754.0652 [115.56], Avg: 334.5298 (0.813)
Ep: 68, Reward: 558.5301, Test: 649.8651 [211.72], Avg: 336.0315 (0.810)
Ep: 69, Reward: 619.2192, Test: 625.4916 [203.14], Avg: 337.2647 (0.808)
Ep: 70, Reward: 579.8991, Test: 598.8813 [299.60], Avg: 336.7297 (0.805)
Ep: 71, Reward: 456.0647, Test: 514.0861 [245.86], Avg: 335.7782 (0.803)
Ep: 72, Reward: 675.0586, Test: 617.9339 [265.83], Avg: 336.0019 (0.801)
Ep: 73, Reward: 642.7887, Test: 495.7329 [245.10], Avg: 334.8482 (0.798)
Ep: 74, Reward: 622.3304, Test: 514.5368 [294.28], Avg: 333.3204 (0.796)
Ep: 75, Reward: 550.9221, Test: 504.3496 [191.29], Avg: 333.0538 (0.793)
Ep: 76, Reward: 489.0798, Test: 367.1613 [181.36], Avg: 331.1414 (0.791)
Ep: 77, Reward: 554.4969, Test: 398.9024 [319.77], Avg: 327.9106 (0.789)
Ep: 78, Reward: 471.3040, Test: 375.8512 [169.89], Avg: 326.3669 (0.786)
Ep: 79, Reward: 396.0164, Test: 398.1453 [178.54], Avg: 325.0323 (0.784)
Ep: 80, Reward: 471.3984, Test: 452.8886 [247.71], Avg: 323.5527 (0.782)
Ep: 81, Reward: 387.5180, Test: 342.8033 [161.45], Avg: 321.8185 (0.779)
Ep: 82, Reward: 466.7034, Test: 320.7333 [183.43], Avg: 319.5954 (0.777)
Ep: 83, Reward: 514.7134, Test: 356.3921 [216.31], Avg: 317.4583 (0.775)
Ep: 84, Reward: 528.7307, Test: 511.6638 [202.42], Avg: 317.3617 (0.772)
Ep: 85, Reward: 466.2075, Test: 291.0179 [183.86], Avg: 314.9175 (0.770)
Ep: 86, Reward: 514.3334, Test: 353.1254 [162.64], Avg: 313.4872 (0.768)
Ep: 87, Reward: 544.5915, Test: 565.3096 [246.59], Avg: 313.5466 (0.765)
Ep: 88, Reward: 553.2527, Test: 523.5167 [234.75], Avg: 313.2682 (0.763)
Ep: 89, Reward: 661.5169, Test: 630.1094 [266.54], Avg: 313.8271 (0.761)
Ep: 90, Reward: 539.8221, Test: 752.9206 [153.35], Avg: 316.9672 (0.758)
Ep: 91, Reward: 704.5978, Test: 675.0932 [125.10], Avg: 319.5001 (0.756)
Ep: 92, Reward: 670.0816, Test: 578.7064 [298.13], Avg: 319.0816 (0.754)
Ep: 93, Reward: 614.0062, Test: 644.8800 [155.34], Avg: 320.8949 (0.752)
Ep: 94, Reward: 560.8664, Test: 633.6239 [300.63], Avg: 321.0223 (0.749)
Ep: 95, Reward: 613.9729, Test: 504.5370 [262.46], Avg: 320.1999 (0.747)
Ep: 96, Reward: 565.2773, Test: 499.2483 [250.71], Avg: 319.4611 (0.745)
Ep: 97, Reward: 574.6541, Test: 712.0281 [145.59], Avg: 321.9813 (0.743)
Ep: 98, Reward: 696.3012, Test: 738.8187 [154.51], Avg: 324.6310 (0.740)
Ep: 99, Reward: 660.1932, Test: 626.7377 [222.54], Avg: 325.4267 (0.738)
Ep: 100, Reward: 658.8624, Test: 708.4069 [186.98], Avg: 327.3673 (0.736)
Ep: 101, Reward: 629.6329, Test: 699.2796 [147.44], Avg: 329.5680 (0.734)
Ep: 102, Reward: 549.7998, Test: 722.1818 [150.79], Avg: 331.9159 (0.732)
Ep: 103, Reward: 725.2850, Test: 642.0321 [169.19], Avg: 333.2709 (0.729)
Ep: 104, Reward: 698.5905, Test: 608.6320 [280.31], Avg: 333.2238 (0.727)
Ep: 105, Reward: 686.5833, Test: 632.7693 [195.73], Avg: 334.2032 (0.725)
Ep: 106, Reward: 575.6707, Test: 509.7616 [252.53], Avg: 333.4839 (0.723)
Ep: 107, Reward: 604.0985, Test: 743.1144 [155.44], Avg: 335.8375 (0.721)
Ep: 108, Reward: 602.8376, Test: 554.5275 [232.19], Avg: 335.7136 (0.719)
Ep: 109, Reward: 617.2681, Test: 721.1323 [189.02], Avg: 337.4991 (0.716)
Ep: 110, Reward: 676.1842, Test: 655.2909 [220.17], Avg: 338.3785 (0.714)
Ep: 111, Reward: 703.9096, Test: 713.3529 [131.14], Avg: 340.5556 (0.712)
Ep: 112, Reward: 731.9817, Test: 646.5220 [201.68], Avg: 341.4785 (0.710)
Ep: 113, Reward: 777.8926, Test: 727.8510 [167.44], Avg: 343.3989 (0.708)
Ep: 114, Reward: 707.9478, Test: 742.6709 [122.80], Avg: 345.8030 (0.706)
Ep: 115, Reward: 696.4828, Test: 689.4697 [139.65], Avg: 347.5617 (0.704)
Ep: 116, Reward: 667.4727, Test: 669.3878 [193.77], Avg: 348.6563 (0.702)
Ep: 117, Reward: 683.5620, Test: 608.2434 [235.34], Avg: 348.8617 (0.699)
Ep: 118, Reward: 758.3454, Test: 766.0530 [102.75], Avg: 351.5041 (0.697)
Ep: 119, Reward: 731.5373, Test: 732.2893 [134.06], Avg: 353.5601 (0.695)
Ep: 120, Reward: 738.4645, Test: 668.6978 [191.99], Avg: 354.5779 (0.693)
Ep: 121, Reward: 735.7858, Test: 611.1766 [287.51], Avg: 354.3245 (0.691)
Ep: 122, Reward: 637.1860, Test: 628.2213 [138.43], Avg: 355.4258 (0.689)
Ep: 123, Reward: 592.8860, Test: 631.0069 [103.26], Avg: 356.8155 (0.687)
Ep: 124, Reward: 670.4522, Test: 694.5003 [74.56], Avg: 358.9205 (0.685)
Ep: 125, Reward: 725.3933, Test: 614.9575 [168.99], Avg: 359.6114 (0.683)
Ep: 126, Reward: 583.0506, Test: 704.6909 [103.15], Avg: 361.5163 (0.681)
Ep: 127, Reward: 673.5553, Test: 728.3802 [116.73], Avg: 363.4706 (0.679)
Ep: 128, Reward: 651.2727, Test: 565.2115 [188.79], Avg: 363.5710 (0.677)
Ep: 129, Reward: 688.9636, Test: 602.0499 [170.32], Avg: 364.0953 (0.675)
Ep: 130, Reward: 606.9678, Test: 657.0220 [66.78], Avg: 365.8216 (0.673)
Ep: 131, Reward: 638.6532, Test: 607.9126 [90.92], Avg: 366.9669 (0.671)
Ep: 132, Reward: 620.0859, Test: 625.9567 [81.64], Avg: 368.3003 (0.669)
Ep: 133, Reward: 602.1849, Test: 670.9628 [61.46], Avg: 370.1003 (0.667)
Ep: 134, Reward: 630.4983, Test: 700.6447 [83.94], Avg: 371.9270 (0.665)
Ep: 135, Reward: 670.1850, Test: 694.5896 [123.52], Avg: 373.3913 (0.663)
Ep: 136, Reward: 671.7383, Test: 691.9839 [72.63], Avg: 375.1867 (0.661)
Ep: 137, Reward: 644.3808, Test: 662.9576 [82.59], Avg: 376.6735 (0.659)
Ep: 138, Reward: 685.1990, Test: 705.0997 [101.34], Avg: 378.3072 (0.657)
Ep: 139, Reward: 707.9322, Test: 641.8548 [202.49], Avg: 378.7433 (0.655)
Ep: 140, Reward: 678.4838, Test: 700.7972 [78.98], Avg: 380.4672 (0.653)
Ep: 141, Reward: 716.8778, Test: 779.5739 [51.36], Avg: 382.9162 (0.651)
Ep: 142, Reward: 761.8511, Test: 778.0679 [73.89], Avg: 385.1628 (0.649)
Ep: 143, Reward: 683.6781, Test: 650.3093 [159.65], Avg: 385.8954 (0.647)
Ep: 144, Reward: 596.4758, Test: 710.5488 [91.84], Avg: 387.5010 (0.645)
Ep: 145, Reward: 640.3725, Test: 562.9337 [145.70], Avg: 387.7046 (0.643)
Ep: 146, Reward: 617.2947, Test: 683.6543 [83.83], Avg: 389.1476 (0.641)
Ep: 147, Reward: 592.2434, Test: 650.4518 [155.87], Avg: 389.8600 (0.639)
Ep: 148, Reward: 623.5423, Test: 574.4498 [178.90], Avg: 389.8982 (0.637)
Ep: 149, Reward: 605.6636, Test: 547.6672 [207.51], Avg: 389.5665 (0.635)
Ep: 150, Reward: 603.4753, Test: 534.4232 [112.54], Avg: 389.7806 (0.633)
Ep: 151, Reward: 370.7966, Test: 308.5343 [76.44], Avg: 388.7431 (0.631)
Ep: 152, Reward: 331.9755, Test: 358.3826 [64.99], Avg: 388.1199 (0.630)
Ep: 153, Reward: 287.8982, Test: 311.9914 [114.54], Avg: 386.8818 (0.628)
Ep: 154, Reward: 340.3453, Test: 365.2305 [125.37], Avg: 385.9333 (0.626)
Ep: 155, Reward: 335.5610, Test: 320.0520 [140.99], Avg: 384.6071 (0.624)
Ep: 156, Reward: 298.4335, Test: 395.8806 [102.99], Avg: 384.0230 (0.622)
Ep: 157, Reward: 314.9374, Test: 322.9265 [108.45], Avg: 382.9499 (0.620)
Ep: 158, Reward: 338.8116, Test: 367.3881 [82.82], Avg: 382.3311 (0.618)
Ep: 159, Reward: 356.3325, Test: 275.4783 [119.72], Avg: 380.9151 (0.616)
Ep: 160, Reward: 304.3277, Test: 317.6761 [57.74], Avg: 380.1637 (0.615)
Ep: 161, Reward: 311.3844, Test: 323.0724 [60.41], Avg: 379.4384 (0.613)
Ep: 162, Reward: 321.5576, Test: 346.9881 [119.93], Avg: 378.5035 (0.611)
Ep: 163, Reward: 330.7520, Test: 267.6125 [92.06], Avg: 377.2660 (0.609)
Ep: 164, Reward: 300.0963, Test: 284.1346 [123.34], Avg: 375.9540 (0.607)
Ep: 165, Reward: 273.5313, Test: 277.0375 [105.52], Avg: 374.7225 (0.605)
Ep: 166, Reward: 336.6304, Test: 320.0966 [141.89], Avg: 373.5457 (0.604)
Ep: 167, Reward: 340.5415, Test: 334.2045 [114.11], Avg: 372.6324 (0.602)
Ep: 168, Reward: 327.9614, Test: 372.5905 [112.44], Avg: 371.9668 (0.600)
Ep: 169, Reward: 324.1092, Test: 332.2508 [166.23], Avg: 370.7553 (0.598)
Ep: 170, Reward: 381.2856, Test: 403.9247 [139.22], Avg: 370.1351 (0.596)
Ep: 171, Reward: 386.2079, Test: 375.8490 [98.89], Avg: 369.5934 (0.595)
Ep: 172, Reward: 277.3721, Test: 308.0901 [151.32], Avg: 368.3632 (0.593)
Ep: 173, Reward: 407.8778, Test: 363.3285 [124.24], Avg: 367.6202 (0.591)
Ep: 174, Reward: 381.0809, Test: 433.4395 [66.91], Avg: 367.6140 (0.589)
Ep: 175, Reward: 351.7103, Test: 239.7879 [120.86], Avg: 366.2010 (0.588)
Ep: 176, Reward: 369.0357, Test: 320.1963 [100.52], Avg: 365.3732 (0.586)
Ep: 177, Reward: 325.1139, Test: 423.1244 [51.81], Avg: 365.4065 (0.584)
Ep: 178, Reward: 345.7536, Test: 315.3942 [80.88], Avg: 364.6753 (0.582)
Ep: 179, Reward: 352.3227, Test: 342.0179 [63.21], Avg: 364.1983 (0.581)
Ep: 180, Reward: 356.8417, Test: 340.7022 [48.75], Avg: 363.7991 (0.579)
Ep: 181, Reward: 337.1189, Test: 361.1359 [91.43], Avg: 363.2822 (0.577)
Ep: 182, Reward: 400.4619, Test: 325.7779 [96.38], Avg: 362.5506 (0.575)
Ep: 183, Reward: 398.3599, Test: 347.3221 [113.80], Avg: 361.8493 (0.574)
Ep: 184, Reward: 381.1075, Test: 403.9384 [67.90], Avg: 361.7098 (0.572)
Ep: 185, Reward: 366.7616, Test: 429.5398 [107.87], Avg: 361.4946 (0.570)
Ep: 186, Reward: 365.9325, Test: 336.0493 [96.27], Avg: 360.8437 (0.568)
Ep: 187, Reward: 367.7233, Test: 393.6141 [102.14], Avg: 360.4747 (0.567)
Ep: 188, Reward: 381.8258, Test: 358.3241 [133.36], Avg: 359.7577 (0.565)
Ep: 189, Reward: 404.5818, Test: 377.3664 [132.81], Avg: 359.1514 (0.563)
Ep: 190, Reward: 364.0911, Test: 444.1052 [54.74], Avg: 359.3096 (0.562)
Ep: 191, Reward: 389.0912, Test: 470.4121 [73.99], Avg: 359.5028 (0.560)
Ep: 192, Reward: 448.5921, Test: 397.6816 [115.80], Avg: 359.1007 (0.558)
Ep: 193, Reward: 511.7602, Test: 410.1694 [106.78], Avg: 358.8135 (0.557)
Ep: 194, Reward: 366.5163, Test: 375.7197 [64.13], Avg: 358.5713 (0.555)
Ep: 195, Reward: 417.4252, Test: 391.5216 [56.48], Avg: 358.4513 (0.553)
Ep: 196, Reward: 354.1953, Test: 334.4349 [118.47], Avg: 357.7280 (0.552)
Ep: 197, Reward: 390.1516, Test: 342.0310 [84.09], Avg: 357.2241 (0.550)
Ep: 198, Reward: 363.9832, Test: 347.2469 [110.53], Avg: 356.6185 (0.548)
Ep: 199, Reward: 374.2197, Test: 382.0940 [86.40], Avg: 356.3138 (0.547)
Ep: 200, Reward: 396.2653, Test: 402.3537 [88.51], Avg: 356.1025 (0.545)
Ep: 201, Reward: 408.3666, Test: 346.5479 [102.26], Avg: 355.5490 (0.543)
Ep: 202, Reward: 418.4453, Test: 419.2644 [94.99], Avg: 355.3949 (0.542)
Ep: 203, Reward: 416.9540, Test: 455.9259 [103.24], Avg: 355.3817 (0.540)
Ep: 204, Reward: 327.4085, Test: 348.6523 [152.80], Avg: 354.6035 (0.539)
Ep: 205, Reward: 350.3332, Test: 440.4694 [76.79], Avg: 354.6475 (0.537)
Ep: 206, Reward: 437.8934, Test: 401.9699 [158.71], Avg: 354.1095 (0.535)
Ep: 207, Reward: 377.5031, Test: 425.7400 [69.04], Avg: 354.1219 (0.534)
Ep: 208, Reward: 488.5536, Test: 490.5895 [116.51], Avg: 354.2174 (0.532)
Ep: 209, Reward: 415.1910, Test: 426.9745 [143.50], Avg: 353.8806 (0.530)
Ep: 210, Reward: 437.0543, Test: 432.6636 [102.48], Avg: 353.7683 (0.529)
Ep: 211, Reward: 479.2126, Test: 467.8803 [158.48], Avg: 353.5590 (0.527)
Ep: 212, Reward: 447.5408, Test: 435.8254 [105.54], Avg: 353.4497 (0.526)
Ep: 213, Reward: 418.3997, Test: 389.2566 [88.40], Avg: 353.2039 (0.524)
Ep: 214, Reward: 400.6060, Test: 425.0086 [176.20], Avg: 352.7184 (0.523)
Ep: 215, Reward: 432.4973, Test: 439.1009 [125.39], Avg: 352.5378 (0.521)
Ep: 216, Reward: 345.1174, Test: 409.8016 [92.02], Avg: 352.3776 (0.519)
Ep: 217, Reward: 326.9714, Test: 343.5424 [109.43], Avg: 351.8351 (0.518)
Ep: 218, Reward: 344.0534, Test: 322.2321 [138.05], Avg: 351.0696 (0.516)
Ep: 219, Reward: 306.9200, Test: 247.2822 [96.72], Avg: 350.1582 (0.515)
Ep: 220, Reward: 337.7939, Test: 396.6493 [157.16], Avg: 349.6574 (0.513)
Ep: 221, Reward: 361.3756, Test: 329.9921 [129.18], Avg: 348.9869 (0.512)
Ep: 222, Reward: 293.0276, Test: 316.3644 [171.75], Avg: 348.0704 (0.510)
Ep: 223, Reward: 394.2516, Test: 373.4964 [96.85], Avg: 347.7516 (0.509)
Ep: 224, Reward: 394.3988, Test: 394.0062 [112.34], Avg: 347.4578 (0.507)
Ep: 225, Reward: 342.4945, Test: 298.1279 [157.16], Avg: 346.5442 (0.506)
Ep: 226, Reward: 402.5163, Test: 347.6004 [158.96], Avg: 345.8486 (0.504)
Ep: 227, Reward: 437.3515, Test: 361.1668 [154.95], Avg: 345.2362 (0.503)
Ep: 228, Reward: 423.4303, Test: 401.6474 [96.73], Avg: 345.0601 (0.501)
Ep: 229, Reward: 444.1461, Test: 262.6151 [117.55], Avg: 344.1906 (0.500)
Ep: 230, Reward: 378.1080, Test: 379.2024 [107.34], Avg: 343.8775 (0.498)
Ep: 231, Reward: 440.4426, Test: 457.6556 [78.54], Avg: 344.0294 (0.497)
Ep: 232, Reward: 457.2034, Test: 460.5893 [142.81], Avg: 343.9167 (0.495)
Ep: 233, Reward: 478.7501, Test: 475.6703 [118.53], Avg: 343.9732 (0.494)
Ep: 234, Reward: 499.9119, Test: 532.3648 [120.88], Avg: 344.2605 (0.492)
Ep: 235, Reward: 475.7525, Test: 478.4833 [97.65], Avg: 344.4155 (0.491)
Ep: 236, Reward: 491.1067, Test: 541.1435 [167.91], Avg: 344.5371 (0.489)
Ep: 237, Reward: 505.0323, Test: 543.0121 [98.49], Avg: 344.9572 (0.488)
Ep: 238, Reward: 513.9213, Test: 451.4588 [113.27], Avg: 344.9289 (0.486)
Ep: 239, Reward: 503.2965, Test: 550.2591 [96.95], Avg: 345.3804 (0.485)
Ep: 240, Reward: 483.1197, Test: 499.2445 [119.20], Avg: 345.5242 (0.483)
Ep: 241, Reward: 471.0948, Test: 506.0639 [172.94], Avg: 345.4730 (0.482)
Ep: 242, Reward: 545.9987, Test: 584.7945 [123.41], Avg: 345.9500 (0.480)
Ep: 243, Reward: 483.1304, Test: 632.7533 [117.27], Avg: 346.6448 (0.479)
Ep: 244, Reward: 495.7545, Test: 466.3879 [172.04], Avg: 346.4314 (0.478)
Ep: 245, Reward: 512.2741, Test: 493.0109 [104.86], Avg: 346.6010 (0.476)
Ep: 246, Reward: 529.4968, Test: 545.3088 [99.43], Avg: 347.0029 (0.475)
Ep: 247, Reward: 540.5215, Test: 440.3488 [189.64], Avg: 346.6146 (0.473)
Ep: 248, Reward: 500.3603, Test: 533.9069 [100.94], Avg: 346.9614 (0.472)
Ep: 249, Reward: 511.4630, Test: 581.3913 [131.15], Avg: 347.3745 (0.470)
Ep: 250, Reward: 545.6317, Test: 531.2416 [194.93], Avg: 347.3305 (0.469)
Ep: 251, Reward: 551.7050, Test: 500.6750 [156.37], Avg: 347.3185 (0.468)
Ep: 252, Reward: 572.8280, Test: 563.4640 [177.79], Avg: 347.4701 (0.466)
Ep: 253, Reward: 538.1069, Test: 567.0437 [145.22], Avg: 347.7628 (0.465)
Ep: 254, Reward: 571.5420, Test: 510.9570 [170.00], Avg: 347.7361 (0.463)
Ep: 255, Reward: 579.9570, Test: 554.0997 [150.03], Avg: 347.9561 (0.462)
Ep: 256, Reward: 554.3452, Test: 462.6048 [218.81], Avg: 347.5508 (0.461)
Ep: 257, Reward: 520.4551, Test: 627.4176 [112.71], Avg: 348.1987 (0.459)
Ep: 258, Reward: 582.0582, Test: 620.7123 [75.33], Avg: 348.9601 (0.458)
Ep: 259, Reward: 512.5150, Test: 545.4738 [152.81], Avg: 349.1282 (0.456)
Ep: 260, Reward: 570.9793, Test: 590.7567 [147.59], Avg: 349.4885 (0.455)
Ep: 261, Reward: 588.0306, Test: 531.1079 [158.59], Avg: 349.5764 (0.454)
Ep: 262, Reward: 546.1737, Test: 566.0793 [109.60], Avg: 349.9829 (0.452)
Ep: 263, Reward: 468.2566, Test: 547.7567 [72.12], Avg: 350.4588 (0.451)
Ep: 264, Reward: 580.5223, Test: 486.1901 [186.51], Avg: 350.2672 (0.450)
Ep: 265, Reward: 541.7657, Test: 530.8547 [126.05], Avg: 350.4722 (0.448)
Ep: 266, Reward: 602.7371, Test: 544.6614 [166.47], Avg: 350.5760 (0.447)
Ep: 267, Reward: 563.7015, Test: 629.2871 [149.99], Avg: 351.0563 (0.446)
Ep: 268, Reward: 488.7304, Test: 552.7215 [186.07], Avg: 351.1143 (0.444)
Ep: 269, Reward: 587.1321, Test: 635.2414 [60.35], Avg: 351.9431 (0.443)
Ep: 270, Reward: 630.5884, Test: 600.0607 [119.40], Avg: 352.4181 (0.442)
Ep: 271, Reward: 608.9966, Test: 645.7098 [128.73], Avg: 353.0231 (0.440)
Ep: 272, Reward: 600.9750, Test: 645.8945 [74.13], Avg: 353.8243 (0.439)
Ep: 273, Reward: 502.3923, Test: 654.2264 [118.28], Avg: 354.4890 (0.438)
Ep: 274, Reward: 590.8068, Test: 604.0144 [182.35], Avg: 354.7333 (0.436)
Ep: 275, Reward: 624.2380, Test: 649.6488 [91.63], Avg: 355.4698 (0.435)
Ep: 276, Reward: 622.8033, Test: 591.8640 [112.87], Avg: 355.9157 (0.434)
Ep: 277, Reward: 593.3531, Test: 551.8075 [142.40], Avg: 356.1082 (0.432)
Ep: 278, Reward: 567.5153, Test: 583.5180 [131.86], Avg: 356.4506 (0.431)
Ep: 279, Reward: 624.8215, Test: 563.2526 [156.21], Avg: 356.6313 (0.430)
Ep: 280, Reward: 611.5014, Test: 580.0177 [156.07], Avg: 356.8709 (0.429)
Ep: 281, Reward: 638.4154, Test: 573.3490 [147.23], Avg: 357.1164 (0.427)
Ep: 282, Reward: 598.5861, Test: 578.6184 [84.50], Avg: 357.6005 (0.426)
Ep: 283, Reward: 564.3355, Test: 635.3665 [72.58], Avg: 358.3230 (0.425)
Ep: 284, Reward: 650.3988, Test: 534.9395 [165.08], Avg: 358.3635 (0.423)
Ep: 285, Reward: 542.2197, Test: 616.3832 [130.20], Avg: 358.8104 (0.422)
Ep: 286, Reward: 543.4429, Test: 502.6888 [187.56], Avg: 358.6582 (0.421)
Ep: 287, Reward: 530.3635, Test: 604.1012 [160.53], Avg: 358.9531 (0.420)
Ep: 288, Reward: 581.2535, Test: 503.7069 [179.96], Avg: 358.8312 (0.418)
Ep: 289, Reward: 624.9274, Test: 461.3028 [161.16], Avg: 358.6289 (0.417)
Ep: 290, Reward: 612.5833, Test: 531.4646 [209.43], Avg: 358.5031 (0.416)
Ep: 291, Reward: 496.9317, Test: 590.8515 [155.49], Avg: 358.7663 (0.415)
Ep: 292, Reward: 593.0777, Test: 574.7033 [121.33], Avg: 359.0892 (0.413)
Ep: 293, Reward: 601.4348, Test: 574.9220 [85.17], Avg: 359.5337 (0.412)
Ep: 294, Reward: 614.3436, Test: 601.4307 [103.68], Avg: 360.0022 (0.411)
Ep: 295, Reward: 605.6856, Test: 501.0348 [112.07], Avg: 360.1000 (0.410)
Ep: 296, Reward: 544.6127, Test: 595.9349 [141.16], Avg: 360.4188 (0.408)
Ep: 297, Reward: 555.0469, Test: 637.7745 [67.96], Avg: 361.1215 (0.407)
Ep: 298, Reward: 610.6332, Test: 555.7771 [165.62], Avg: 361.2186 (0.406)
Ep: 299, Reward: 563.4447, Test: 540.6739 [176.35], Avg: 361.2289 (0.405)
Ep: 300, Reward: 629.8330, Test: 618.7333 [133.56], Avg: 361.6407 (0.404)
Ep: 301, Reward: 532.2447, Test: 566.2052 [213.72], Avg: 361.6104 (0.402)
Ep: 302, Reward: 575.5718, Test: 612.7630 [74.76], Avg: 362.1925 (0.401)
Ep: 303, Reward: 627.9218, Test: 556.3688 [168.12], Avg: 362.2782 (0.400)
Ep: 304, Reward: 554.6759, Test: 707.2282 [29.40], Avg: 363.3128 (0.399)
Ep: 305, Reward: 617.8755, Test: 553.7911 [236.88], Avg: 363.1612 (0.398)
Ep: 306, Reward: 614.8858, Test: 556.0462 [189.47], Avg: 363.1723 (0.396)
Ep: 307, Reward: 605.4133, Test: 568.4426 [137.54], Avg: 363.3922 (0.395)
Ep: 308, Reward: 620.9455, Test: 646.2753 [137.27], Avg: 363.8635 (0.394)
Ep: 309, Reward: 664.7328, Test: 647.7905 [126.37], Avg: 364.3717 (0.393)
Ep: 310, Reward: 598.9764, Test: 517.3398 [167.50], Avg: 364.3250 (0.392)
Ep: 311, Reward: 569.3796, Test: 716.7693 [89.87], Avg: 365.1666 (0.390)
Ep: 312, Reward: 620.7342, Test: 620.9655 [161.72], Avg: 365.4671 (0.389)
Ep: 313, Reward: 604.2152, Test: 592.2016 [147.99], Avg: 365.7179 (0.388)
Ep: 314, Reward: 635.8940, Test: 503.3202 [206.56], Avg: 365.4990 (0.387)
Ep: 315, Reward: 562.7455, Test: 640.6203 [101.98], Avg: 366.0469 (0.386)
Ep: 316, Reward: 580.8391, Test: 638.5928 [116.96], Avg: 366.5377 (0.385)
Ep: 317, Reward: 560.0861, Test: 655.2142 [110.05], Avg: 367.0994 (0.383)
Ep: 318, Reward: 616.4063, Test: 623.1009 [166.52], Avg: 367.3799 (0.382)
Ep: 319, Reward: 653.3724, Test: 587.3926 [127.71], Avg: 367.6684 (0.381)
Ep: 320, Reward: 634.1341, Test: 716.6476 [92.97], Avg: 368.4659 (0.380)
Ep: 321, Reward: 611.4351, Test: 662.2591 [111.74], Avg: 369.0313 (0.379)
Ep: 322, Reward: 547.1563, Test: 693.3094 [101.05], Avg: 369.7224 (0.378)
Ep: 323, Reward: 629.9990, Test: 634.0076 [124.87], Avg: 370.1527 (0.377)
Ep: 324, Reward: 660.9790, Test: 643.4742 [135.11], Avg: 370.5780 (0.376)
Ep: 325, Reward: 674.4864, Test: 652.2616 [132.64], Avg: 371.0352 (0.374)
Ep: 326, Reward: 586.1696, Test: 682.6927 [128.55], Avg: 371.5952 (0.373)
Ep: 327, Reward: 554.0158, Test: 631.9414 [123.68], Avg: 372.0118 (0.372)
Ep: 328, Reward: 663.5965, Test: 691.0304 [130.26], Avg: 372.5856 (0.371)
Ep: 329, Reward: 586.4020, Test: 575.1632 [156.86], Avg: 372.7241 (0.370)
Ep: 330, Reward: 577.7346, Test: 683.7235 [89.06], Avg: 373.3946 (0.369)
Ep: 331, Reward: 580.3682, Test: 641.2870 [95.32], Avg: 373.9144 (0.368)
Ep: 332, Reward: 633.6536, Test: 665.9478 [97.91], Avg: 374.4973 (0.367)
Ep: 333, Reward: 577.9241, Test: 554.7478 [172.27], Avg: 374.5212 (0.365)
Ep: 334, Reward: 578.9175, Test: 561.3945 [157.96], Avg: 374.6075 (0.364)
Ep: 335, Reward: 639.6829, Test: 658.9948 [136.19], Avg: 375.0486 (0.363)
Ep: 336, Reward: 526.4939, Test: 601.5864 [155.40], Avg: 375.2597 (0.362)
Ep: 337, Reward: 559.5215, Test: 637.2300 [149.39], Avg: 375.5927 (0.361)
Ep: 338, Reward: 596.7977, Test: 598.8820 [248.21], Avg: 375.5192 (0.360)
Ep: 339, Reward: 589.5921, Test: 572.5616 [205.24], Avg: 375.4951 (0.359)
Ep: 340, Reward: 620.8414, Test: 514.8886 [150.65], Avg: 375.4621 (0.358)
Ep: 341, Reward: 644.4093, Test: 668.0912 [94.89], Avg: 376.0403 (0.357)
Ep: 342, Reward: 624.5843, Test: 586.6770 [162.86], Avg: 376.1796 (0.356)
Ep: 343, Reward: 579.6648, Test: 693.2927 [95.79], Avg: 376.8229 (0.355)
Ep: 344, Reward: 654.4059, Test: 690.2394 [124.91], Avg: 377.3693 (0.354)
Ep: 345, Reward: 675.5088, Test: 702.8240 [73.63], Avg: 378.0972 (0.353)
Ep: 346, Reward: 646.6517, Test: 615.4369 [167.41], Avg: 378.2987 (0.351)
Ep: 347, Reward: 642.1325, Test: 610.1933 [188.26], Avg: 378.4241 (0.350)
Ep: 348, Reward: 626.5460, Test: 584.5445 [166.18], Avg: 378.5385 (0.349)
Ep: 349, Reward: 703.7579, Test: 533.5827 [224.00], Avg: 378.3415 (0.348)
Ep: 350, Reward: 635.4331, Test: 712.3553 [103.24], Avg: 378.9990 (0.347)
Ep: 351, Reward: 669.8658, Test: 587.4119 [122.30], Avg: 379.2436 (0.346)
Ep: 352, Reward: 656.1059, Test: 579.6252 [233.18], Avg: 379.1507 (0.345)
Ep: 353, Reward: 668.5988, Test: 598.7617 [168.31], Avg: 379.2957 (0.344)
Ep: 354, Reward: 657.3075, Test: 651.4225 [168.78], Avg: 379.5868 (0.343)
Ep: 355, Reward: 577.7508, Test: 732.4639 [53.48], Avg: 380.4278 (0.342)
Ep: 356, Reward: 605.4677, Test: 672.3817 [85.28], Avg: 381.0067 (0.341)
Ep: 357, Reward: 581.9407, Test: 698.8944 [111.96], Avg: 381.5819 (0.340)
Ep: 358, Reward: 687.3046, Test: 714.5672 [85.71], Avg: 382.2707 (0.339)
Ep: 359, Reward: 621.1096, Test: 600.8348 [150.79], Avg: 382.4590 (0.338)
Ep: 360, Reward: 620.2573, Test: 607.5225 [171.73], Avg: 382.6067 (0.337)
Ep: 361, Reward: 606.0300, Test: 599.8382 [206.54], Avg: 382.6363 (0.336)
Ep: 362, Reward: 640.5183, Test: 748.7974 [52.25], Avg: 383.5010 (0.335)
Ep: 363, Reward: 613.7988, Test: 615.7881 [241.03], Avg: 383.4770 (0.334)
Ep: 364, Reward: 667.4649, Test: 609.5623 [148.96], Avg: 383.6884 (0.333)
Ep: 365, Reward: 538.6168, Test: 680.0059 [66.12], Avg: 384.3173 (0.332)
Ep: 366, Reward: 648.1058, Test: 622.2672 [234.29], Avg: 384.3273 (0.331)
Ep: 367, Reward: 662.9637, Test: 689.0423 [134.47], Avg: 384.7899 (0.330)
Ep: 368, Reward: 618.2460, Test: 666.8209 [131.64], Avg: 385.1975 (0.329)
Ep: 369, Reward: 642.5196, Test: 677.2863 [170.28], Avg: 385.5267 (0.328)
Ep: 370, Reward: 654.6095, Test: 618.0297 [110.33], Avg: 385.8560 (0.327)
Ep: 371, Reward: 675.4084, Test: 542.4008 [200.63], Avg: 385.7375 (0.326)
Ep: 372, Reward: 667.0546, Test: 637.9651 [108.78], Avg: 386.1221 (0.325)
Ep: 373, Reward: 616.2853, Test: 509.7666 [253.34], Avg: 385.7753 (0.324)
Ep: 374, Reward: 622.5059, Test: 704.1961 [132.71], Avg: 386.2705 (0.323)
Ep: 375, Reward: 648.2297, Test: 645.4023 [194.24], Avg: 386.4431 (0.322)
Ep: 376, Reward: 681.3116, Test: 588.4677 [168.71], Avg: 386.5314 (0.321)
Ep: 377, Reward: 641.8461, Test: 672.5444 [145.94], Avg: 386.9020 (0.320)
Ep: 378, Reward: 673.6211, Test: 676.7761 [85.03], Avg: 387.4425 (0.319)
Ep: 379, Reward: 714.0120, Test: 652.2586 [161.22], Avg: 387.7151 (0.318)
Ep: 380, Reward: 637.7465, Test: 648.2330 [106.57], Avg: 388.1192 (0.317)
Ep: 381, Reward: 685.5934, Test: 692.5074 [86.24], Avg: 388.6903 (0.316)
Ep: 382, Reward: 682.3317, Test: 652.0572 [122.53], Avg: 389.0580 (0.315)
Ep: 383, Reward: 623.5903, Test: 555.5252 [229.98], Avg: 388.8926 (0.315)
Ep: 384, Reward: 673.6519, Test: 605.7633 [166.59], Avg: 389.0232 (0.314)
Ep: 385, Reward: 655.3503, Test: 631.7034 [140.50], Avg: 389.2879 (0.313)
Ep: 386, Reward: 630.6528, Test: 659.4565 [101.18], Avg: 389.7246 (0.312)
Ep: 387, Reward: 675.7922, Test: 683.7848 [128.72], Avg: 390.1507 (0.311)
Ep: 388, Reward: 644.9188, Test: 648.3404 [125.16], Avg: 390.4927 (0.310)
Ep: 389, Reward: 705.0569, Test: 669.9570 [148.22], Avg: 390.8292 (0.309)
Ep: 390, Reward: 656.8838, Test: 703.6657 [117.72], Avg: 391.3282 (0.308)
Ep: 391, Reward: 677.3473, Test: 688.4577 [116.87], Avg: 391.7881 (0.307)
Ep: 392, Reward: 660.5498, Test: 737.6536 [39.48], Avg: 392.5677 (0.306)
Ep: 393, Reward: 660.8546, Test: 685.7077 [129.71], Avg: 392.9825 (0.305)
Ep: 394, Reward: 686.3454, Test: 643.7216 [103.62], Avg: 393.3550 (0.304)
Ep: 395, Reward: 653.4032, Test: 669.4208 [183.55], Avg: 393.5886 (0.303)
Ep: 396, Reward: 637.8353, Test: 660.4460 [69.74], Avg: 394.0851 (0.302)
Ep: 397, Reward: 688.3638, Test: 637.4472 [161.51], Avg: 394.2908 (0.302)
Ep: 398, Reward: 629.3265, Test: 645.9708 [186.74], Avg: 394.4535 (0.301)
Ep: 399, Reward: 671.6048, Test: 644.5955 [168.14], Avg: 394.6585 (0.300)
Ep: 400, Reward: 726.6738, Test: 660.8603 [167.71], Avg: 394.9041 (0.299)
Ep: 401, Reward: 642.5019, Test: 718.3330 [90.05], Avg: 395.4847 (0.298)
Ep: 402, Reward: 648.6021, Test: 682.0285 [108.96], Avg: 395.9253 (0.297)
Ep: 403, Reward: 702.3526, Test: 699.8543 [80.50], Avg: 396.4784 (0.296)
Ep: 404, Reward: 712.6498, Test: 733.5764 [50.88], Avg: 397.1851 (0.295)
Ep: 405, Reward: 672.4596, Test: 689.9688 [119.13], Avg: 397.6128 (0.294)
Ep: 406, Reward: 618.7533, Test: 724.1368 [66.42], Avg: 398.2519 (0.294)
Ep: 407, Reward: 714.9211, Test: 730.7350 [73.40], Avg: 398.8869 (0.293)
Ep: 408, Reward: 688.6397, Test: 675.9673 [143.23], Avg: 399.2141 (0.292)
Ep: 409, Reward: 686.3249, Test: 697.5135 [238.07], Avg: 399.3610 (0.291)
Ep: 410, Reward: 716.9439, Test: 757.4567 [95.91], Avg: 399.9989 (0.290)
Ep: 411, Reward: 652.7568, Test: 733.4173 [130.06], Avg: 400.4925 (0.289)
Ep: 412, Reward: 666.3106, Test: 713.7424 [124.91], Avg: 400.9485 (0.288)
Ep: 413, Reward: 678.3994, Test: 685.9151 [124.34], Avg: 401.3365 (0.287)
Ep: 414, Reward: 676.8556, Test: 747.6759 [41.43], Avg: 402.0713 (0.287)
Ep: 415, Reward: 669.0240, Test: 712.9923 [126.26], Avg: 402.5151 (0.286)
Ep: 416, Reward: 649.3377, Test: 671.0578 [100.29], Avg: 402.9186 (0.285)
Ep: 417, Reward: 682.9683, Test: 745.8584 [73.40], Avg: 403.5635 (0.284)
Ep: 418, Reward: 716.2270, Test: 711.8993 [102.25], Avg: 404.0553 (0.283)
Ep: 419, Reward: 644.6252, Test: 717.1580 [79.86], Avg: 404.6107 (0.282)
Ep: 420, Reward: 671.7436, Test: 703.5041 [82.21], Avg: 405.1254 (0.281)
Ep: 421, Reward: 763.9485, Test: 681.8697 [72.88], Avg: 405.6085 (0.281)
Ep: 422, Reward: 666.8864, Test: 655.9801 [216.94], Avg: 405.6875 (0.280)
Ep: 423, Reward: 595.5582, Test: 710.7086 [56.56], Avg: 406.2735 (0.279)
Ep: 424, Reward: 681.0245, Test: 759.3955 [34.25], Avg: 407.0238 (0.278)
Ep: 425, Reward: 659.4621, Test: 737.4978 [46.95], Avg: 407.6893 (0.277)
Ep: 426, Reward: 671.9045, Test: 620.8880 [182.22], Avg: 407.7619 (0.276)
Ep: 427, Reward: 695.0903, Test: 683.3319 [87.73], Avg: 408.2008 (0.276)
Ep: 428, Reward: 711.1697, Test: 644.5035 [140.68], Avg: 408.4236 (0.275)
Ep: 429, Reward: 685.4875, Test: 688.6405 [108.79], Avg: 408.8223 (0.274)
Ep: 430, Reward: 679.0012, Test: 671.1390 [51.27], Avg: 409.3120 (0.273)
Ep: 431, Reward: 690.2234, Test: 754.9279 [33.11], Avg: 410.0354 (0.272)
Ep: 432, Reward: 652.9214, Test: 629.7833 [134.94], Avg: 410.2312 (0.271)
Ep: 433, Reward: 657.3617, Test: 698.3089 [75.99], Avg: 410.7199 (0.271)
Ep: 434, Reward: 658.9865, Test: 622.5201 [164.40], Avg: 410.8289 (0.270)
Ep: 435, Reward: 655.4986, Test: 660.8756 [103.94], Avg: 411.1640 (0.269)
Ep: 436, Reward: 702.6305, Test: 663.4344 [134.06], Avg: 411.4345 (0.268)
Ep: 437, Reward: 681.6281, Test: 614.2286 [210.58], Avg: 411.4167 (0.267)
Ep: 438, Reward: 660.5167, Test: 673.7474 [159.32], Avg: 411.6514 (0.267)
Ep: 439, Reward: 639.8366, Test: 693.2233 [79.08], Avg: 412.1116 (0.266)
Ep: 440, Reward: 684.0563, Test: 648.7433 [150.19], Avg: 412.3076 (0.265)
Ep: 441, Reward: 676.3529, Test: 661.5411 [142.26], Avg: 412.5496 (0.264)
Ep: 442, Reward: 701.0112, Test: 726.5294 [61.16], Avg: 413.1203 (0.263)
Ep: 443, Reward: 657.8756, Test: 748.9596 [54.49], Avg: 413.7539 (0.263)
Ep: 444, Reward: 749.4153, Test: 705.6491 [119.85], Avg: 414.1406 (0.262)
Ep: 445, Reward: 692.6890, Test: 687.4759 [145.45], Avg: 414.4273 (0.261)
Ep: 446, Reward: 673.6906, Test: 691.5335 [140.57], Avg: 414.7328 (0.260)
Ep: 447, Reward: 688.0290, Test: 721.5266 [99.14], Avg: 415.1963 (0.259)
Ep: 448, Reward: 682.7534, Test: 697.5654 [132.47], Avg: 415.5301 (0.259)
Ep: 449, Reward: 703.0548, Test: 654.7553 [85.30], Avg: 415.8722 (0.258)
Ep: 450, Reward: 674.1590, Test: 714.0830 [73.22], Avg: 416.3710 (0.257)
Ep: 451, Reward: 672.1066, Test: 717.9556 [81.84], Avg: 416.8572 (0.256)
Ep: 452, Reward: 645.9220, Test: 751.3879 [49.13], Avg: 417.4872 (0.256)
Ep: 453, Reward: 653.4120, Test: 633.0635 [157.73], Avg: 417.6146 (0.255)
Ep: 454, Reward: 667.5755, Test: 727.7831 [34.85], Avg: 418.2197 (0.254)
Ep: 455, Reward: 624.8718, Test: 718.1348 [87.79], Avg: 418.6849 (0.253)
Ep: 456, Reward: 697.2374, Test: 740.8162 [63.11], Avg: 419.2517 (0.253)
Ep: 457, Reward: 672.7141, Test: 615.8309 [187.36], Avg: 419.2718 (0.252)
Ep: 458, Reward: 656.5765, Test: 652.9957 [175.33], Avg: 419.3991 (0.251)
Ep: 459, Reward: 687.9431, Test: 686.6100 [121.96], Avg: 419.7148 (0.250)
Ep: 460, Reward: 703.9392, Test: 672.2079 [143.99], Avg: 419.9502 (0.250)
Ep: 461, Reward: 659.2728, Test: 657.5889 [137.64], Avg: 420.1666 (0.249)
Ep: 462, Reward: 666.4446, Test: 726.5565 [82.73], Avg: 420.6497 (0.248)
Ep: 463, Reward: 663.1065, Test: 611.7677 [187.33], Avg: 420.6579 (0.247)
Ep: 464, Reward: 694.7654, Test: 638.9196 [156.55], Avg: 420.7906 (0.247)
Ep: 465, Reward: 690.5975, Test: 756.6342 [42.70], Avg: 421.4196 (0.246)
Ep: 466, Reward: 743.5433, Test: 662.8979 [132.00], Avg: 421.6541 (0.245)
Ep: 467, Reward: 654.1259, Test: 664.1030 [170.77], Avg: 421.8072 (0.244)
Ep: 468, Reward: 656.0713, Test: 768.9702 [42.37], Avg: 422.4571 (0.244)
Ep: 469, Reward: 673.7356, Test: 696.3759 [141.59], Avg: 422.7386 (0.243)
Ep: 470, Reward: 658.5643, Test: 695.0771 [79.53], Avg: 423.1480 (0.242)
Ep: 471, Reward: 690.8747, Test: 672.0534 [111.17], Avg: 423.4398 (0.241)
Ep: 472, Reward: 653.5089, Test: 620.2431 [184.69], Avg: 423.4654 (0.241)
Ep: 473, Reward: 690.2211, Test: 766.5718 [55.88], Avg: 424.0714 (0.240)
Ep: 474, Reward: 712.7187, Test: 727.8275 [81.28], Avg: 424.5397 (0.239)
Ep: 475, Reward: 670.3499, Test: 663.7622 [127.92], Avg: 424.7736 (0.239)
Ep: 476, Reward: 699.5383, Test: 703.9479 [117.62], Avg: 425.1123 (0.238)
Ep: 477, Reward: 711.7364, Test: 679.8624 [129.72], Avg: 425.3738 (0.237)
Ep: 478, Reward: 736.7841, Test: 629.9799 [174.62], Avg: 425.4364 (0.236)
Ep: 479, Reward: 749.4187, Test: 722.7190 [66.55], Avg: 425.9171 (0.236)
Ep: 480, Reward: 700.1663, Test: 666.9304 [167.98], Avg: 426.0690 (0.235)
Ep: 481, Reward: 688.6754, Test: 655.2872 [137.00], Avg: 426.2603 (0.234)
Ep: 482, Reward: 683.9255, Test: 707.7911 [100.44], Avg: 426.6352 (0.234)
Ep: 483, Reward: 618.9400, Test: 589.5787 [208.40], Avg: 426.5413 (0.233)
Ep: 484, Reward: 691.1970, Test: 709.4773 [61.14], Avg: 426.9986 (0.232)
Ep: 485, Reward: 744.8402, Test: 730.6435 [43.09], Avg: 427.5347 (0.231)
Ep: 486, Reward: 742.2851, Test: 741.2525 [92.03], Avg: 427.9899 (0.231)
Ep: 487, Reward: 734.2037, Test: 729.6056 [85.33], Avg: 428.4331 (0.230)
Ep: 488, Reward: 664.6901, Test: 657.9126 [122.28], Avg: 428.6523 (0.229)
Ep: 489, Reward: 748.8918, Test: 631.5335 [138.74], Avg: 428.7832 (0.229)
Ep: 490, Reward: 737.6158, Test: 692.6773 [154.31], Avg: 429.0064 (0.228)
Ep: 491, Reward: 701.5054, Test: 698.6052 [100.88], Avg: 429.3493 (0.227)
Ep: 492, Reward: 705.2587, Test: 655.8940 [168.97], Avg: 429.4661 (0.227)
Ep: 493, Reward: 755.7211, Test: 687.9206 [150.01], Avg: 429.6856 (0.226)
Ep: 494, Reward: 718.4106, Test: 701.9705 [123.41], Avg: 429.9864 (0.225)
Ep: 495, Reward: 632.0366, Test: 630.2014 [183.14], Avg: 430.0208 (0.225)
Ep: 496, Reward: 639.6663, Test: 691.0072 [132.45], Avg: 430.2795 (0.224)
Ep: 497, Reward: 732.5364, Test: 727.8543 [145.63], Avg: 430.5846 (0.223)
Ep: 498, Reward: 698.0377, Test: 734.3448 [90.16], Avg: 431.0126 (0.223)
Ep: 499, Reward: 699.5421, Test: 702.8573 [168.12], Avg: 431.2201 (0.222)
