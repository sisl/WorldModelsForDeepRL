Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.1				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages) + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss.mean())
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((len(self.replay_buffer)*PPO_EPOCHS)//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=4*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -28.9450, Test: -33.7673 [18.68], Avg: -52.4425 (0.997)
Ep: 1, Reward: -38.6982, Test: -72.3359 [4.42], Avg: -64.6012 (0.994)
Ep: 2, Reward: -73.3383, Test: -63.6950 [3.48], Avg: -65.4585 (0.991)
Ep: 3, Reward: -65.0423, Test: -75.7265 [4.15], Avg: -69.0637 (0.988)
Ep: 4, Reward: -70.4442, Test: -71.5991 [3.36], Avg: -70.2430 (0.985)
Ep: 5, Reward: -73.3773, Test: -48.2279 [16.68], Avg: -69.3539 (0.982)
Ep: 6, Reward: -58.0412, Test: -66.9393 [3.44], Avg: -69.5002 (0.979)
Ep: 7, Reward: -71.1559, Test: -71.4823 [3.32], Avg: -70.1628 (0.976)
Ep: 8, Reward: -73.0785, Test: -68.9585 [4.60], Avg: -70.5400 (0.973)
Ep: 9, Reward: -69.0511, Test: -71.4024 [4.52], Avg: -71.0784 (0.970)
Ep: 10, Reward: -69.3292, Test: -66.7863 [4.68], Avg: -71.1135 (0.967)
Ep: 11, Reward: -66.8093, Test: -70.7487 [3.24], Avg: -71.3530 (0.965)
Ep: 12, Reward: -67.3690, Test: -70.7856 [7.54], Avg: -71.8894 (0.962)
Ep: 13, Reward: -65.8563, Test: -68.2910 [7.53], Avg: -72.1699 (0.959)
Ep: 14, Reward: -58.2040, Test: -54.4947 [3.52], Avg: -71.2260 (0.956)
Ep: 15, Reward: -57.9798, Test: -64.2862 [6.60], Avg: -71.2049 (0.953)
Ep: 16, Reward: -69.4816, Test: -54.2996 [12.51], Avg: -70.9464 (0.950)
Ep: 17, Reward: -54.0802, Test: -59.0640 [4.32], Avg: -70.5263 (0.947)
Ep: 18, Reward: -53.2144, Test: -69.6636 [6.48], Avg: -70.8220 (0.945)
Ep: 19, Reward: -63.3343, Test: -67.2364 [9.76], Avg: -71.1306 (0.942)
Ep: 20, Reward: -67.8165, Test: -67.3320 [7.65], Avg: -71.3139 (0.939)
Ep: 21, Reward: -66.2691, Test: -67.4777 [7.33], Avg: -71.4725 (0.936)
Ep: 22, Reward: -67.4705, Test: -69.3813 [5.55], Avg: -71.6228 (0.933)
Ep: 23, Reward: -58.2726, Test: -63.8842 [9.54], Avg: -71.6979 (0.930)
Ep: 24, Reward: -63.9775, Test: -60.7701 [9.07], Avg: -71.6235 (0.928)
Ep: 25, Reward: -65.7304, Test: -64.8376 [5.69], Avg: -71.5812 (0.925)
Ep: 26, Reward: -67.2983, Test: -63.0444 [12.54], Avg: -71.7296 (0.922)
Ep: 27, Reward: -65.1133, Test: -65.8151 [8.94], Avg: -71.8377 (0.919)
Ep: 28, Reward: -68.5994, Test: -67.1501 [2.42], Avg: -71.7594 (0.917)
Ep: 29, Reward: -67.8269, Test: -66.3316 [4.94], Avg: -71.7433 (0.914)
Ep: 30, Reward: -68.4112, Test: -65.2506 [5.58], Avg: -71.7139 (0.911)
Ep: 31, Reward: -67.0681, Test: -63.0920 [4.41], Avg: -71.5822 (0.908)
Ep: 32, Reward: -66.0579, Test: -69.0575 [7.43], Avg: -71.7308 (0.906)
Ep: 33, Reward: -63.8805, Test: -54.4549 [21.11], Avg: -71.8435 (0.903)
Ep: 34, Reward: -24.4257, Test: -24.5187 [29.94], Avg: -71.3468 (0.900)
Ep: 35, Reward: -32.4387, Test: -9.4831 [68.76], Avg: -71.5385 (0.897)
Ep: 36, Reward: -20.8310, Test: -39.8006 [23.55], Avg: -71.3172 (0.895)
Ep: 37, Reward: -18.2890, Test: 68.9545 [49.80], Avg: -68.9363 (0.892)
Ep: 38, Reward: 101.6319, Test: 28.1747 [97.46], Avg: -68.9452 (0.889)
Ep: 39, Reward: 62.9351, Test: -10.5793 [35.21], Avg: -68.3664 (0.887)
Ep: 40, Reward: -16.6126, Test: 46.7876 [86.22], Avg: -67.6606 (0.884)
Ep: 41, Reward: 4.5838, Test: -11.0794 [31.17], Avg: -67.0556 (0.881)
Ep: 42, Reward: 46.9559, Test: 114.8876 [82.38], Avg: -64.7401 (0.879)
Ep: 43, Reward: 122.6274, Test: 6.6174 [37.26], Avg: -63.9652 (0.876)
Ep: 44, Reward: 16.4450, Test: 12.5729 [50.31], Avg: -63.3824 (0.874)
Ep: 45, Reward: 5.6689, Test: 78.0052 [48.73], Avg: -61.3681 (0.871)
Ep: 46, Reward: 109.4922, Test: 46.4871 [81.35], Avg: -60.8042 (0.868)
Ep: 47, Reward: 67.8415, Test: 0.0219 [38.24], Avg: -60.3336 (0.866)
Ep: 48, Reward: 5.2486, Test: 71.8293 [82.17], Avg: -59.3133 (0.863)
Ep: 49, Reward: 60.7860, Test: 168.1417 [59.73], Avg: -55.9588 (0.861)
Ep: 50, Reward: 123.6885, Test: 113.9132 [84.53], Avg: -54.2854 (0.858)
Ep: 51, Reward: 71.2652, Test: 84.0181 [117.71], Avg: -53.8894 (0.855)
Ep: 52, Reward: 103.8653, Test: 160.7035 [143.98], Avg: -52.5572 (0.853)
Ep: 53, Reward: 194.6053, Test: 211.5958 [98.59], Avg: -49.4912 (0.850)
Ep: 54, Reward: 237.3179, Test: 228.1590 [181.58], Avg: -47.7445 (0.848)
Ep: 55, Reward: 221.0961, Test: 315.6861 [201.84], Avg: -44.8588 (0.845)
Ep: 56, Reward: 264.1847, Test: 183.8305 [203.95], Avg: -44.4248 (0.843)
Ep: 57, Reward: 246.0592, Test: 186.3831 [178.10], Avg: -43.5161 (0.840)
Ep: 58, Reward: 210.5831, Test: 245.9715 [264.70], Avg: -43.0959 (0.838)
Ep: 59, Reward: 209.7639, Test: 228.9638 [237.65], Avg: -42.5224 (0.835)
Ep: 60, Reward: 193.9297, Test: 99.2853 [118.27], Avg: -42.1366 (0.833)
Ep: 61, Reward: 97.5353, Test: 185.6445 [131.61], Avg: -40.5855 (0.830)
Ep: 62, Reward: 137.8414, Test: 144.0923 [107.38], Avg: -39.3585 (0.828)
Ep: 63, Reward: 176.7470, Test: 121.2913 [174.75], Avg: -39.5788 (0.825)
Ep: 64, Reward: 70.8679, Test: 205.4800 [127.03], Avg: -37.7629 (0.823)
Ep: 65, Reward: 260.1851, Test: 192.6885 [252.10], Avg: -38.0909 (0.820)
Ep: 66, Reward: 163.1081, Test: 189.6456 [132.02], Avg: -36.6624 (0.818)
Ep: 67, Reward: 132.2923, Test: 39.7721 [115.37], Avg: -37.2350 (0.815)
Ep: 68, Reward: 17.7586, Test: 93.9720 [75.26], Avg: -36.4241 (0.813)
Ep: 69, Reward: 92.1271, Test: 101.0806 [111.55], Avg: -36.0533 (0.810)
Ep: 70, Reward: 122.6250, Test: 118.5099 [87.91], Avg: -35.1146 (0.808)
Ep: 71, Reward: 161.3987, Test: 112.0063 [97.20], Avg: -34.4213 (0.805)
Ep: 72, Reward: 166.1780, Test: 163.7236 [147.90], Avg: -33.7329 (0.803)
Ep: 73, Reward: 150.5534, Test: 157.9206 [134.75], Avg: -32.9639 (0.801)
Ep: 74, Reward: 171.1419, Test: 194.0008 [107.22], Avg: -31.3672 (0.798)
Ep: 75, Reward: 175.0001, Test: 121.8261 [83.13], Avg: -30.4454 (0.796)
Ep: 76, Reward: 116.9707, Test: 106.5080 [112.59], Avg: -30.1291 (0.793)
Ep: 77, Reward: 89.6423, Test: 200.5660 [74.60], Avg: -28.1278 (0.791)
Ep: 78, Reward: 203.2650, Test: 181.1363 [93.56], Avg: -26.6631 (0.789)
Ep: 79, Reward: 146.0127, Test: 172.1045 [104.42], Avg: -25.4838 (0.786)
Ep: 80, Reward: 223.3719, Test: 171.6819 [91.30], Avg: -24.1768 (0.784)
Ep: 81, Reward: 163.6060, Test: 126.1591 [85.05], Avg: -23.3807 (0.782)
Ep: 82, Reward: 240.3769, Test: 207.9107 [108.58], Avg: -21.9022 (0.779)
Ep: 83, Reward: 250.9388, Test: 134.7704 [88.87], Avg: -21.0951 (0.777)
Ep: 84, Reward: 254.9414, Test: 220.1827 [97.04], Avg: -19.3981 (0.775)
Ep: 85, Reward: 189.4610, Test: 224.7309 [78.54], Avg: -17.4726 (0.772)
Ep: 86, Reward: 239.5389, Test: 157.5083 [98.96], Avg: -16.5988 (0.770)
Ep: 87, Reward: 230.9637, Test: 205.2683 [86.34], Avg: -15.0587 (0.768)
Ep: 88, Reward: 282.1401, Test: 307.4742 [130.04], Avg: -12.8959 (0.765)
Ep: 89, Reward: 262.2723, Test: 277.4388 [139.61], Avg: -11.2211 (0.763)
Ep: 90, Reward: 224.1723, Test: 210.3093 [103.68], Avg: -9.9261 (0.761)
Ep: 91, Reward: 192.8470, Test: 201.5321 [142.39], Avg: -9.1753 (0.758)
Ep: 92, Reward: 235.3348, Test: 224.7015 [80.96], Avg: -7.5311 (0.756)
Ep: 93, Reward: 165.7020, Test: 185.7859 [105.37], Avg: -6.5955 (0.754)
Ep: 94, Reward: 206.1558, Test: 178.1534 [144.33], Avg: -6.1701 (0.752)
Ep: 95, Reward: 175.8785, Test: 180.9271 [108.72], Avg: -5.3537 (0.749)
Ep: 96, Reward: 261.5940, Test: 233.8343 [123.34], Avg: -4.1594 (0.747)
Ep: 97, Reward: 268.1739, Test: 228.2273 [100.06], Avg: -2.8091 (0.745)
Ep: 98, Reward: 261.4161, Test: 299.5436 [136.10], Avg: -1.1298 (0.743)
Ep: 99, Reward: 318.0230, Test: 328.9138 [242.50], Avg: -0.2544 (0.740)
Ep: 100, Reward: 311.3949, Test: 304.9336 [204.36], Avg: 0.7439 (0.738)
Ep: 101, Reward: 401.9792, Test: 177.3363 [172.92], Avg: 0.7799 (0.736)
Ep: 102, Reward: 421.5553, Test: 329.6375 [236.55], Avg: 1.6761 (0.734)
Ep: 103, Reward: 268.4931, Test: 286.0036 [163.49], Avg: 2.8380 (0.732)
Ep: 104, Reward: 362.5560, Test: 259.7695 [192.88], Avg: 3.4479 (0.729)
Ep: 105, Reward: 322.2940, Test: 186.6766 [159.77], Avg: 3.6692 (0.727)
Ep: 106, Reward: 266.9386, Test: 265.1374 [241.96], Avg: 3.8516 (0.725)
Ep: 107, Reward: 309.2652, Test: 405.1482 [298.14], Avg: 4.8067 (0.723)
Ep: 108, Reward: 349.0499, Test: 261.2573 [259.51], Avg: 4.7787 (0.721)
Ep: 109, Reward: 327.8360, Test: 314.3203 [231.96], Avg: 5.4839 (0.719)
Ep: 110, Reward: 415.2210, Test: 322.9630 [184.68], Avg: 6.6804 (0.716)
Ep: 111, Reward: 373.6261, Test: 476.6276 [229.95], Avg: 8.8232 (0.714)
Ep: 112, Reward: 275.9758, Test: 316.3464 [236.85], Avg: 9.4486 (0.712)
Ep: 113, Reward: 260.2030, Test: 283.1963 [140.19], Avg: 10.6201 (0.710)
Ep: 114, Reward: 278.3558, Test: 319.2565 [178.28], Avg: 11.7537 (0.708)
Ep: 115, Reward: 247.6233, Test: 244.4841 [246.00], Avg: 11.6392 (0.706)
Ep: 116, Reward: 377.4080, Test: 405.5605 [306.49], Avg: 12.3865 (0.704)
Ep: 117, Reward: 253.0816, Test: 255.9901 [140.94], Avg: 13.2565 (0.702)
Ep: 118, Reward: 214.0864, Test: 300.8242 [109.60], Avg: 14.7520 (0.699)
Ep: 119, Reward: 208.7397, Test: 343.3525 [236.59], Avg: 15.5188 (0.697)
Ep: 120, Reward: 382.5117, Test: 395.3759 [265.71], Avg: 16.4621 (0.695)
Ep: 121, Reward: 344.0640, Test: 281.4262 [218.54], Avg: 16.8426 (0.693)
Ep: 122, Reward: 256.0110, Test: 225.3480 [134.02], Avg: 17.4482 (0.691)
Ep: 123, Reward: 456.6435, Test: 448.6227 [229.11], Avg: 19.0778 (0.689)
Ep: 124, Reward: 417.9366, Test: 376.7344 [299.38], Avg: 19.5440 (0.687)
Ep: 125, Reward: 403.5871, Test: 382.1034 [223.66], Avg: 20.6464 (0.685)
Ep: 126, Reward: 481.3874, Test: 411.3607 [160.98], Avg: 22.4553 (0.683)
Ep: 127, Reward: 348.7397, Test: 493.2576 [215.18], Avg: 24.4524 (0.681)
Ep: 128, Reward: 481.6726, Test: 352.1918 [257.65], Avg: 24.9957 (0.679)
Ep: 129, Reward: 528.9705, Test: 544.7971 [263.13], Avg: 26.9701 (0.677)
Ep: 130, Reward: 472.5286, Test: 277.7772 [253.83], Avg: 26.9470 (0.675)
Ep: 131, Reward: 469.5305, Test: 480.3625 [264.65], Avg: 28.3770 (0.673)
Ep: 132, Reward: 503.4528, Test: 278.7067 [203.30], Avg: 28.7307 (0.671)
Ep: 133, Reward: 471.9314, Test: 473.2753 [278.00], Avg: 29.9735 (0.667)
Ep: 134, Reward: 475.7107, Test: 495.0764 [244.76], Avg: 31.6057 (0.665)
Ep: 135, Reward: 513.7872, Test: 343.0781 [251.74], Avg: 32.0449 (0.663)
Ep: 136, Reward: 362.8671, Test: 408.4029 [238.60], Avg: 33.0505 (0.661)
Ep: 137, Reward: 494.0060, Test: 510.4044 [268.58], Avg: 34.5633 (0.659)
Ep: 138, Reward: 472.2314, Test: 403.5175 [241.24], Avg: 35.4822 (0.657)
Ep: 139, Reward: 509.7056, Test: 316.4934 [167.84], Avg: 36.2905 (0.655)
Ep: 140, Reward: 506.7900, Test: 554.7686 [214.05], Avg: 38.4496 (0.653)
Ep: 141, Reward: 614.8252, Test: 637.1674 [154.62], Avg: 41.5770 (0.651)
Ep: 142, Reward: 514.7539, Test: 651.3465 [288.69], Avg: 43.8223 (0.649)
Ep: 143, Reward: 459.6990, Test: 413.2628 [197.44], Avg: 45.0168 (0.647)
Ep: 144, Reward: 387.8781, Test: 588.8041 [274.80], Avg: 46.8719 (0.645)
Ep: 145, Reward: 458.4217, Test: 607.6250 [261.14], Avg: 48.9240 (0.643)
Ep: 146, Reward: 452.0312, Test: 529.6527 [221.54], Avg: 50.6872 (0.641)
Ep: 147, Reward: 493.2326, Test: 600.2231 [218.44], Avg: 52.9243 (0.639)
Ep: 148, Reward: 459.6492, Test: 616.0682 [266.86], Avg: 54.9128 (0.637)
Ep: 149, Reward: 464.9794, Test: 582.6319 [215.45], Avg: 56.9945 (0.635)
Ep: 150, Reward: 469.8274, Test: 342.5395 [234.62], Avg: 57.3318 (0.633)
Ep: 151, Reward: 468.1637, Test: 506.4951 [227.03], Avg: 58.7933 (0.631)
Ep: 152, Reward: 345.5846, Test: 673.3975 [229.94], Avg: 61.3074 (0.630)
Ep: 153, Reward: 493.7490, Test: 465.0204 [258.47], Avg: 62.2505 (0.628)
Ep: 154, Reward: 572.8129, Test: 402.7298 [159.26], Avg: 63.4196 (0.626)
Ep: 155, Reward: 419.9673, Test: 426.9493 [255.30], Avg: 64.1134 (0.624)
Ep: 156, Reward: 420.1527, Test: 305.5522 [242.64], Avg: 64.1057 (0.622)
Ep: 157, Reward: 341.8577, Test: 477.7947 [186.20], Avg: 65.5455 (0.620)
Ep: 158, Reward: 394.5997, Test: 458.9213 [229.92], Avg: 66.5735 (0.618)
Ep: 159, Reward: 308.8968, Test: 435.2442 [228.41], Avg: 67.4501 (0.616)
Ep: 160, Reward: 386.9926, Test: 375.0553 [177.67], Avg: 68.2571 (0.615)
Ep: 161, Reward: 483.3980, Test: 510.2961 [197.51], Avg: 69.7666 (0.613)
Ep: 162, Reward: 356.6578, Test: 548.5031 [257.02], Avg: 71.1268 (0.611)
Ep: 163, Reward: 450.7584, Test: 518.9542 [212.05], Avg: 72.5645 (0.609)
Ep: 164, Reward: 478.8612, Test: 470.5857 [207.51], Avg: 73.7191 (0.607)
Ep: 165, Reward: 425.1704, Test: 482.1078 [219.97], Avg: 74.8541 (0.605)
Ep: 166, Reward: 400.8011, Test: 597.0489 [227.00], Avg: 76.6218 (0.604)
Ep: 167, Reward: 398.2960, Test: 425.0172 [142.45], Avg: 77.8477 (0.602)
Ep: 168, Reward: 420.5523, Test: 409.3244 [192.46], Avg: 78.6703 (0.600)
Ep: 169, Reward: 358.9318, Test: 454.2310 [231.47], Avg: 79.5179 (0.598)
Ep: 170, Reward: 413.6641, Test: 439.1132 [241.99], Avg: 80.2056 (0.596)
Ep: 171, Reward: 430.2292, Test: 348.6286 [163.07], Avg: 80.8181 (0.595)
Ep: 172, Reward: 419.0085, Test: 276.2098 [246.87], Avg: 80.5206 (0.593)
Ep: 173, Reward: 403.8246, Test: 323.9270 [138.77], Avg: 81.1219 (0.591)
Ep: 174, Reward: 421.6753, Test: 349.6432 [155.27], Avg: 81.7691 (0.589)
Ep: 175, Reward: 328.8815, Test: 335.6678 [169.73], Avg: 82.2473 (0.588)
Ep: 176, Reward: 424.7936, Test: 338.5387 [181.25], Avg: 82.6713 (0.586)
Ep: 177, Reward: 395.8287, Test: 488.6874 [282.70], Avg: 83.3641 (0.584)
Ep: 178, Reward: 444.0122, Test: 310.3760 [218.25], Avg: 83.4130 (0.582)
Ep: 179, Reward: 460.5778, Test: 441.0748 [143.55], Avg: 84.6025 (0.581)
Ep: 180, Reward: 411.7271, Test: 553.2413 [185.87], Avg: 86.1648 (0.579)
Ep: 181, Reward: 419.7428, Test: 493.4662 [171.04], Avg: 87.4629 (0.577)
Ep: 182, Reward: 525.2623, Test: 346.4754 [226.15], Avg: 87.6425 (0.575)
Ep: 183, Reward: 510.1943, Test: 512.5449 [236.98], Avg: 88.6638 (0.574)
Ep: 184, Reward: 494.1642, Test: 387.2368 [241.96], Avg: 88.9698 (0.572)
Ep: 185, Reward: 491.9916, Test: 516.4532 [203.93], Avg: 90.1717 (0.570)
Ep: 186, Reward: 540.3095, Test: 499.0384 [176.80], Avg: 91.4126 (0.568)
Ep: 187, Reward: 510.6324, Test: 462.2952 [165.34], Avg: 92.5060 (0.567)
Ep: 188, Reward: 478.2509, Test: 560.7195 [266.69], Avg: 93.5722 (0.565)
Ep: 189, Reward: 482.6037, Test: 562.1741 [168.99], Avg: 95.1491 (0.563)
Ep: 190, Reward: 482.6240, Test: 486.5475 [311.68], Avg: 95.5665 (0.562)
Ep: 191, Reward: 485.2667, Test: 497.8308 [233.31], Avg: 96.4465 (0.560)
Ep: 192, Reward: 614.0377, Test: 440.6202 [215.83], Avg: 97.1115 (0.558)
Ep: 193, Reward: 518.0272, Test: 596.5510 [256.02], Avg: 98.3662 (0.557)
Ep: 194, Reward: 611.4151, Test: 416.8699 [161.48], Avg: 99.1715 (0.555)
Ep: 195, Reward: 539.6517, Test: 621.3300 [234.09], Avg: 100.6412 (0.553)
Ep: 196, Reward: 536.3691, Test: 479.3531 [172.25], Avg: 101.6892 (0.552)
Ep: 197, Reward: 617.0290, Test: 619.3944 [145.70], Avg: 103.5680 (0.550)
Ep: 198, Reward: 598.1416, Test: 606.5936 [203.79], Avg: 105.0717 (0.548)
Ep: 199, Reward: 580.2479, Test: 543.0038 [178.01], Avg: 106.3713 (0.547)
Ep: 200, Reward: 573.3354, Test: 537.3551 [194.94], Avg: 107.5457 (0.545)
Ep: 201, Reward: 554.9843, Test: 482.2096 [282.15], Avg: 108.0037 (0.543)
Ep: 202, Reward: 609.0492, Test: 666.5738 [217.85], Avg: 109.6821 (0.542)
Ep: 203, Reward: 579.5016, Test: 614.5301 [241.81], Avg: 110.9715 (0.540)
Ep: 204, Reward: 656.3777, Test: 690.3203 [134.19], Avg: 113.1430 (0.539)
Ep: 205, Reward: 606.5423, Test: 626.3227 [161.26], Avg: 114.8514 (0.537)
Ep: 206, Reward: 597.9381, Test: 590.9261 [162.81], Avg: 116.3647 (0.535)
Ep: 207, Reward: 553.5570, Test: 566.8266 [183.14], Avg: 117.6499 (0.534)
Ep: 208, Reward: 543.3258, Test: 632.7604 [214.23], Avg: 119.0895 (0.532)
Ep: 209, Reward: 566.3652, Test: 519.7525 [188.13], Avg: 120.1016 (0.530)
Ep: 210, Reward: 611.9770, Test: 503.1310 [223.41], Avg: 120.8581 (0.529)
Ep: 211, Reward: 509.3645, Test: 535.0402 [200.09], Avg: 121.8680 (0.527)
Ep: 212, Reward: 557.0031, Test: 577.6409 [166.01], Avg: 123.2283 (0.526)
Ep: 213, Reward: 532.3938, Test: 526.7201 [195.37], Avg: 124.2009 (0.524)
Ep: 214, Reward: 441.6671, Test: 542.9075 [165.37], Avg: 125.3792 (0.523)
Ep: 215, Reward: 600.4866, Test: 421.7718 [191.00], Avg: 125.8671 (0.521)
Ep: 216, Reward: 578.8900, Test: 541.5416 [209.35], Avg: 126.8179 (0.519)
Ep: 217, Reward: 517.0478, Test: 546.6248 [190.91], Avg: 127.8679 (0.518)
Ep: 218, Reward: 574.0573, Test: 633.1171 [125.82], Avg: 129.6005 (0.516)
Ep: 219, Reward: 683.9915, Test: 576.9015 [202.23], Avg: 130.7144 (0.515)
Ep: 220, Reward: 559.6335, Test: 509.3969 [209.70], Avg: 131.4791 (0.513)
Ep: 221, Reward: 629.2780, Test: 549.4250 [196.59], Avg: 132.4762 (0.512)
Ep: 222, Reward: 552.8797, Test: 519.5696 [227.39], Avg: 133.1923 (0.510)
Ep: 223, Reward: 591.4858, Test: 565.5204 [300.76], Avg: 133.7797 (0.509)
Ep: 224, Reward: 564.8828, Test: 679.1714 [166.20], Avg: 135.4650 (0.507)
Ep: 225, Reward: 549.0154, Test: 712.3011 [168.59], Avg: 137.2714 (0.506)
Ep: 226, Reward: 562.3699, Test: 676.3743 [173.83], Avg: 138.8805 (0.504)
Ep: 227, Reward: 597.9530, Test: 634.7945 [129.36], Avg: 140.4882 (0.503)
Ep: 228, Reward: 664.8953, Test: 535.1779 [180.25], Avg: 141.4246 (0.501)
Ep: 229, Reward: 585.9895, Test: 675.0455 [188.90], Avg: 142.9234 (0.500)
Ep: 230, Reward: 521.7804, Test: 526.1422 [254.06], Avg: 143.4826 (0.498)
Ep: 231, Reward: 668.8797, Test: 558.6681 [232.64], Avg: 144.2694 (0.497)
Ep: 232, Reward: 684.3903, Test: 736.2916 [164.96], Avg: 146.1023 (0.495)
Ep: 233, Reward: 635.4884, Test: 639.3905 [177.54], Avg: 147.4516 (0.494)
Ep: 234, Reward: 636.0735, Test: 668.8206 [226.98], Avg: 148.7043 (0.492)
Ep: 235, Reward: 610.8866, Test: 706.4929 [96.65], Avg: 150.6583 (0.491)
Ep: 236, Reward: 604.7327, Test: 787.6221 [104.83], Avg: 152.9036 (0.489)
Ep: 237, Reward: 656.9634, Test: 623.6583 [245.25], Avg: 153.8511 (0.488)
Ep: 238, Reward: 699.7702, Test: 629.4619 [251.16], Avg: 154.7902 (0.486)
Ep: 239, Reward: 700.4399, Test: 669.5173 [162.52], Avg: 156.2578 (0.485)
Ep: 240, Reward: 605.7341, Test: 543.2353 [141.69], Avg: 157.2756 (0.483)
Ep: 241, Reward: 623.1219, Test: 544.2367 [221.68], Avg: 157.9585 (0.482)
Ep: 242, Reward: 680.4954, Test: 610.0378 [213.40], Avg: 158.9407 (0.480)
Ep: 243, Reward: 654.4179, Test: 601.5555 [168.46], Avg: 160.0643 (0.479)
Ep: 244, Reward: 643.0507, Test: 660.9945 [193.78], Avg: 161.3180 (0.478)
Ep: 245, Reward: 686.5644, Test: 657.1026 [162.82], Avg: 162.6715 (0.476)
Ep: 246, Reward: 621.9647, Test: 626.1581 [219.86], Avg: 163.6579 (0.475)
Ep: 247, Reward: 658.4414, Test: 696.2167 [184.47], Avg: 165.0614 (0.473)
Ep: 248, Reward: 654.8832, Test: 617.1186 [170.34], Avg: 166.1928 (0.472)
Ep: 249, Reward: 737.3377, Test: 605.1720 [127.68], Avg: 167.4380 (0.470)
Ep: 250, Reward: 608.7879, Test: 585.4660 [133.74], Avg: 168.5706 (0.469)
Ep: 251, Reward: 703.1490, Test: 627.0170 [163.94], Avg: 169.7393 (0.468)
Ep: 252, Reward: 637.3036, Test: 576.4092 [195.71], Avg: 170.5731 (0.466)
Ep: 253, Reward: 571.7231, Test: 604.3097 [182.03], Avg: 171.5641 (0.465)
Ep: 254, Reward: 620.9971, Test: 587.0446 [180.75], Avg: 172.4846 (0.463)
Ep: 255, Reward: 550.6672, Test: 624.3755 [172.21], Avg: 173.5771 (0.462)
Ep: 256, Reward: 700.6173, Test: 626.1153 [197.43], Avg: 174.5697 (0.461)
Ep: 257, Reward: 587.3172, Test: 517.0169 [186.11], Avg: 175.1757 (0.459)
Ep: 258, Reward: 466.6932, Test: 458.1679 [153.56], Avg: 175.6754 (0.458)
Ep: 259, Reward: 460.5556, Test: 508.3468 [201.68], Avg: 176.1792 (0.456)
Ep: 260, Reward: 361.7516, Test: 545.7713 [228.22], Avg: 176.7209 (0.455)
Ep: 261, Reward: 341.9359, Test: 604.9871 [130.02], Avg: 177.8593 (0.454)
Ep: 262, Reward: 388.4128, Test: 504.2766 [262.75], Avg: 178.1014 (0.452)
Ep: 263, Reward: 433.8634, Test: 498.7664 [188.13], Avg: 178.6034 (0.451)
Ep: 264, Reward: 548.8294, Test: 641.4129 [198.09], Avg: 179.6023 (0.450)
Ep: 265, Reward: 588.5289, Test: 483.1331 [221.35], Avg: 179.9113 (0.448)
Ep: 266, Reward: 524.0260, Test: 554.4494 [186.81], Avg: 180.6144 (0.447)
Ep: 267, Reward: 631.9062, Test: 648.3410 [208.80], Avg: 181.5806 (0.446)
Ep: 268, Reward: 627.6475, Test: 502.9521 [156.72], Avg: 182.1927 (0.444)
Ep: 269, Reward: 620.0881, Test: 548.6751 [208.49], Avg: 182.7778 (0.443)
Ep: 270, Reward: 470.1429, Test: 545.8871 [204.92], Avg: 183.3615 (0.442)
Ep: 271, Reward: 550.2655, Test: 542.6625 [202.23], Avg: 183.9390 (0.440)
Ep: 272, Reward: 407.7612, Test: 382.7112 [140.32], Avg: 184.1531 (0.439)
Ep: 273, Reward: 441.7180, Test: 370.1579 [160.48], Avg: 184.2462 (0.438)
Ep: 274, Reward: 350.8017, Test: 337.4838 [144.06], Avg: 184.2796 (0.436)
Ep: 275, Reward: 381.4338, Test: 465.3992 [127.19], Avg: 184.8373 (0.435)
Ep: 276, Reward: 524.0752, Test: 369.8478 [136.74], Avg: 185.0116 (0.434)
Ep: 277, Reward: 443.4300, Test: 413.5424 [206.29], Avg: 185.0916 (0.432)
Ep: 278, Reward: 466.3599, Test: 434.4490 [164.85], Avg: 185.3945 (0.431)
Ep: 279, Reward: 500.5210, Test: 425.9651 [170.73], Avg: 185.6439 (0.430)
Ep: 280, Reward: 373.5156, Test: 382.0579 [140.62], Avg: 185.8425 (0.429)
Ep: 281, Reward: 471.8972, Test: 429.0053 [135.29], Avg: 186.2250 (0.427)
Ep: 282, Reward: 484.6283, Test: 423.8683 [135.64], Avg: 186.5854 (0.426)
Ep: 283, Reward: 452.5823, Test: 399.6664 [134.56], Avg: 186.8619 (0.425)
Ep: 284, Reward: 351.6299, Test: 395.5437 [172.03], Avg: 186.9905 (0.423)
Ep: 285, Reward: 456.4606, Test: 423.0336 [120.14], Avg: 187.3958 (0.422)
Ep: 286, Reward: 424.0639, Test: 252.5313 [82.74], Avg: 187.3344 (0.421)
Ep: 287, Reward: 338.1623, Test: 359.8348 [197.48], Avg: 187.2477 (0.420)
Ep: 288, Reward: 355.4114, Test: 392.5112 [136.40], Avg: 187.4860 (0.418)
Ep: 289, Reward: 295.3455, Test: 307.0766 [202.58], Avg: 187.1998 (0.417)
Ep: 290, Reward: 330.6014, Test: 281.6976 [201.38], Avg: 186.8325 (0.416)
Ep: 291, Reward: 407.7661, Test: 402.4632 [188.10], Avg: 186.9268 (0.415)
Ep: 292, Reward: 461.0573, Test: 491.7659 [195.81], Avg: 187.2989 (0.413)
Ep: 293, Reward: 433.0640, Test: 354.6858 [177.43], Avg: 187.2647 (0.412)
Ep: 294, Reward: 469.9846, Test: 441.3758 [114.95], Avg: 187.7365 (0.411)
Ep: 295, Reward: 465.0050, Test: 539.5102 [101.50], Avg: 188.5820 (0.410)
Ep: 296, Reward: 503.9930, Test: 464.1814 [210.78], Avg: 188.8003 (0.408)
Ep: 297, Reward: 562.1717, Test: 534.7697 [182.16], Avg: 189.3500 (0.407)
Ep: 298, Reward: 449.2889, Test: 497.7739 [179.72], Avg: 189.7804 (0.406)
Ep: 299, Reward: 508.4591, Test: 420.8406 [193.76], Avg: 189.9047 (0.405)
Ep: 300, Reward: 398.8668, Test: 453.2137 [147.34], Avg: 190.2900 (0.404)
Ep: 301, Reward: 411.0228, Test: 394.5746 [153.34], Avg: 190.4587 (0.402)
Ep: 302, Reward: 340.5993, Test: 407.6275 [166.21], Avg: 190.6269 (0.401)
Ep: 303, Reward: 392.0526, Test: 350.9786 [145.39], Avg: 190.6761 (0.400)
Ep: 304, Reward: 336.3201, Test: 284.7715 [117.21], Avg: 190.6003 (0.399)
Ep: 305, Reward: 265.3151, Test: 284.2080 [161.00], Avg: 190.3801 (0.398)
Ep: 306, Reward: 364.5744, Test: 222.8928 [123.71], Avg: 190.0830 (0.396)
Ep: 307, Reward: 255.3642, Test: 258.4392 [73.13], Avg: 190.0675 (0.395)
Ep: 308, Reward: 233.6843, Test: 356.4834 [192.76], Avg: 189.9823 (0.394)
Ep: 309, Reward: 305.3688, Test: 246.1358 [124.43], Avg: 189.7620 (0.393)
Ep: 310, Reward: 407.3007, Test: 316.3593 [217.56], Avg: 189.4695 (0.392)
Ep: 311, Reward: 385.9129, Test: 192.8694 [177.10], Avg: 188.9128 (0.390)
Ep: 312, Reward: 310.0573, Test: 389.9631 [200.31], Avg: 188.9152 (0.389)
Ep: 313, Reward: 355.2541, Test: 195.0112 [96.58], Avg: 188.6270 (0.388)
Ep: 314, Reward: 259.7535, Test: 223.2399 [150.94], Avg: 188.2577 (0.387)
Ep: 315, Reward: 327.3512, Test: 346.0586 [147.10], Avg: 188.2916 (0.386)
Ep: 316, Reward: 360.5912, Test: 245.2805 [203.96], Avg: 187.8279 (0.385)
Ep: 317, Reward: 329.2428, Test: 246.2682 [125.55], Avg: 187.6169 (0.383)
Ep: 318, Reward: 348.3320, Test: 387.5959 [143.69], Avg: 187.7933 (0.382)
Ep: 319, Reward: 367.8261, Test: 419.1094 [117.32], Avg: 188.1496 (0.381)
Ep: 320, Reward: 340.8589, Test: 282.1833 [163.75], Avg: 187.9324 (0.380)
Ep: 321, Reward: 423.6726, Test: 396.6954 [198.65], Avg: 187.9638 (0.379)
Ep: 322, Reward: 394.7342, Test: 378.1701 [158.45], Avg: 188.0621 (0.378)
Ep: 323, Reward: 625.2057, Test: 636.5391 [191.97], Avg: 188.8538 (0.377)
Ep: 324, Reward: 599.8788, Test: 623.2009 [206.61], Avg: 189.5546 (0.376)
Ep: 325, Reward: 399.0342, Test: 344.6114 [146.57], Avg: 189.5806 (0.374)
Ep: 326, Reward: 47.1403, Test: -57.0460 [50.31], Avg: 188.6725 (0.373)
Ep: 327, Reward: -70.4158, Test: -85.3003 [2.93], Avg: 187.8283 (0.372)
Ep: 328, Reward: -85.7418, Test: -87.4356 [1.61], Avg: 186.9867 (0.371)
Ep: 329, Reward: -73.2941, Test: -65.2062 [31.47], Avg: 186.1271 (0.370)
Ep: 330, Reward: -77.8970, Test: -65.1704 [33.66], Avg: 185.2663 (0.369)
Ep: 331, Reward: -73.8387, Test: -83.7233 [3.35], Avg: 184.4459 (0.368)
Ep: 332, Reward: -64.6951, Test: -77.2615 [15.54], Avg: 183.6134 (0.367)
Ep: 333, Reward: -74.9032, Test: -74.8043 [23.99], Avg: 182.7678 (0.365)
Ep: 334, Reward: -74.8026, Test: -78.0478 [13.75], Avg: 181.9482 (0.364)
Ep: 335, Reward: -81.2365, Test: -75.9677 [26.72], Avg: 181.1011 (0.363)
Ep: 336, Reward: -78.7061, Test: -75.9184 [25.20], Avg: 180.2637 (0.362)
Ep: 337, Reward: -84.4825, Test: -85.9632 [1.01], Avg: 179.4730 (0.361)
Ep: 338, Reward: -84.4811, Test: -82.0325 [5.87], Avg: 178.6843 (0.360)
Ep: 339, Reward: -67.4483, Test: -73.1685 [35.02], Avg: 177.8406 (0.359)
Ep: 340, Reward: -75.2215, Test: -57.2370 [36.03], Avg: 177.0456 (0.358)
Ep: 341, Reward: -77.3175, Test: -72.8933 [27.52], Avg: 176.2343 (0.357)
Ep: 342, Reward: -74.7864, Test: -76.8086 [11.07], Avg: 175.4643 (0.356)
Ep: 343, Reward: -56.4287, Test: -49.5213 [46.12], Avg: 174.6762 (0.355)
Ep: 344, Reward: -54.2843, Test: -44.2103 [45.16], Avg: 173.9108 (0.354)
Ep: 345, Reward: -47.1813, Test: -42.8984 [36.63], Avg: 173.1783 (0.353)
Ep: 346, Reward: -50.1001, Test: -70.6806 [36.43], Avg: 172.3706 (0.351)
Ep: 347, Reward: -54.4438, Test: -52.6689 [30.95], Avg: 171.6350 (0.350)
Ep: 348, Reward: -32.8753, Test: -64.9292 [28.15], Avg: 170.8765 (0.349)
Ep: 349, Reward: -29.5272, Test: -46.6708 [41.00], Avg: 170.1378 (0.348)
Ep: 350, Reward: -78.2972, Test: -77.0823 [20.90], Avg: 169.3739 (0.347)
Ep: 351, Reward: -85.8193, Test: -77.8822 [25.51], Avg: 168.5990 (0.346)
Ep: 352, Reward: -84.7328, Test: -88.2744 [2.11], Avg: 167.8654 (0.345)
Ep: 353, Reward: -88.6009, Test: -87.3337 [2.28], Avg: 167.1380 (0.344)
Ep: 354, Reward: -87.1511, Test: -88.1395 [2.24], Avg: 166.4126 (0.343)
Ep: 355, Reward: -88.3648, Test: -88.2167 [1.27], Avg: 165.6938 (0.342)
Ep: 356, Reward: -88.6608, Test: -87.5091 [3.85], Avg: 164.9738 (0.341)
Ep: 357, Reward: -88.5079, Test: -87.6312 [1.65], Avg: 164.2636 (0.340)
Ep: 358, Reward: -88.0024, Test: -86.3383 [3.30], Avg: 163.5563 (0.339)
Ep: 359, Reward: -87.9088, Test: -88.5684 [2.70], Avg: 162.8485 (0.338)
Ep: 360, Reward: -87.4344, Test: -86.2279 [2.47], Avg: 162.1517 (0.337)
Ep: 361, Reward: -86.7391, Test: -82.9947 [21.50], Avg: 161.4151 (0.336)
Ep: 362, Reward: -88.0465, Test: -86.1491 [2.45], Avg: 160.7263 (0.335)
Ep: 363, Reward: -87.2922, Test: -86.9501 [3.01], Avg: 160.0377 (0.334)
Ep: 364, Reward: -87.7953, Test: -89.3449 [1.42], Avg: 159.3505 (0.333)
Ep: 365, Reward: -88.5735, Test: -86.9392 [3.68], Avg: 158.6676 (0.332)
Ep: 366, Reward: -87.3766, Test: -87.4925 [2.42], Avg: 157.9902 (0.331)
Ep: 367, Reward: -79.2820, Test: -86.6081 [1.49], Avg: 157.3215 (0.330)
Ep: 368, Reward: -84.4972, Test: -85.6232 [3.57], Avg: 156.6534 (0.329)
Ep: 369, Reward: -85.1316, Test: -84.4691 [3.36], Avg: 155.9927 (0.328)
Ep: 370, Reward: -86.6217, Test: -84.9604 [4.01], Avg: 155.3324 (0.327)
Ep: 371, Reward: -87.1210, Test: -88.1863 [1.80], Avg: 154.6729 (0.326)
Ep: 372, Reward: -87.0187, Test: -86.3630 [2.84], Avg: 154.0191 (0.325)
Ep: 373, Reward: -84.3174, Test: -87.4988 [1.65], Avg: 153.3689 (0.324)
Ep: 374, Reward: -85.4846, Test: -85.5783 [2.25], Avg: 152.7258 (0.323)
Ep: 375, Reward: -87.0288, Test: -85.0212 [4.30], Avg: 152.0820 (0.322)
Ep: 376, Reward: -84.5373, Test: -85.4761 [2.97], Avg: 151.4440 (0.321)
Ep: 377, Reward: -84.1350, Test: -84.8109 [4.49], Avg: 150.8071 (0.320)
Ep: 378, Reward: -84.5398, Test: -87.4820 [1.22], Avg: 150.1751 (0.319)
Ep: 379, Reward: -82.2248, Test: -84.8971 [3.99], Avg: 149.5460 (0.318)
Ep: 380, Reward: -84.4225, Test: -73.3861 [22.76], Avg: 148.9012 (0.317)
Ep: 381, Reward: -79.6673, Test: -78.2644 [20.22], Avg: 148.2536 (0.316)
Ep: 382, Reward: -85.1285, Test: -83.9472 [3.04], Avg: 147.6394 (0.315)
Ep: 383, Reward: -80.4251, Test: -85.7151 [3.90], Avg: 147.0215 (0.315)
Ep: 384, Reward: -77.2341, Test: -84.6414 [3.43], Avg: 146.4109 (0.314)
Ep: 385, Reward: -81.7670, Test: -86.3544 [2.81], Avg: 145.8006 (0.313)
Ep: 386, Reward: -84.3495, Test: -85.9865 [1.54], Avg: 145.1977 (0.312)
Ep: 387, Reward: -84.9061, Test: -82.6473 [9.04], Avg: 144.5872 (0.311)
Ep: 388, Reward: -83.7262, Test: -83.1003 [7.98], Avg: 143.9813 (0.310)
Ep: 389, Reward: -86.0305, Test: -83.2054 [4.93], Avg: 143.3862 (0.309)
Ep: 390, Reward: -86.0463, Test: -85.9988 [3.18], Avg: 142.7914 (0.308)
Ep: 391, Reward: -81.4293, Test: -83.7796 [9.71], Avg: 142.1886 (0.307)
Ep: 392, Reward: -82.6579, Test: -83.2185 [8.77], Avg: 141.5927 (0.306)
Ep: 393, Reward: -82.5581, Test: -86.1263 [2.84], Avg: 141.0076 (0.305)
Ep: 394, Reward: -66.9654, Test: -84.0796 [4.60], Avg: 140.4261 (0.304)
Ep: 395, Reward: -83.9906, Test: -86.4940 [2.18], Avg: 139.8475 (0.303)
Ep: 396, Reward: -83.3812, Test: -79.0814 [20.64], Avg: 139.2441 (0.302)
Ep: 397, Reward: -77.1539, Test: -86.4026 [2.26], Avg: 138.6715 (0.302)
Ep: 398, Reward: -76.5521, Test: -66.2707 [30.94], Avg: 138.0803 (0.301)
Ep: 399, Reward: -68.5530, Test: -79.3054 [14.12], Avg: 137.5015 (0.300)
Ep: 400, Reward: -81.0201, Test: -75.4512 [21.05], Avg: 136.9180 (0.299)
Ep: 401, Reward: -78.7054, Test: -84.7597 [3.22], Avg: 136.3585 (0.298)
Ep: 402, Reward: -83.6595, Test: -75.8302 [19.86], Avg: 135.7827 (0.297)
Ep: 403, Reward: -68.7052, Test: -60.0974 [33.83], Avg: 135.2142 (0.296)
Ep: 404, Reward: -64.0219, Test: -71.1749 [18.27], Avg: 134.6595 (0.295)
Ep: 405, Reward: -65.7572, Test: -79.8576 [9.17], Avg: 134.1085 (0.294)
Ep: 406, Reward: -71.7228, Test: -63.9496 [38.72], Avg: 133.5267 (0.294)
Ep: 407, Reward: -75.0755, Test: -79.7189 [14.79], Avg: 132.9678 (0.293)
Ep: 408, Reward: -71.5874, Test: -64.6542 [33.53], Avg: 132.4027 (0.292)
Ep: 409, Reward: -62.7697, Test: -66.9672 [24.53], Avg: 131.8566 (0.291)
Ep: 410, Reward: -64.5941, Test: -49.3763 [36.28], Avg: 131.3273 (0.290)
Ep: 411, Reward: -70.5627, Test: -76.6222 [9.74], Avg: 130.7989 (0.289)
Ep: 412, Reward: -68.1955, Test: -70.8973 [24.16], Avg: 130.2521 (0.288)
Ep: 413, Reward: -57.0493, Test: -50.4909 [33.48], Avg: 129.7346 (0.287)
Ep: 414, Reward: -52.7108, Test: -72.3988 [24.18], Avg: 129.1893 (0.287)
Ep: 415, Reward: -60.6477, Test: -74.1416 [25.12], Avg: 128.6401 (0.286)
Ep: 416, Reward: -53.7285, Test: -41.6269 [41.34], Avg: 128.1327 (0.285)
Ep: 417, Reward: -51.4501, Test: -30.5216 [35.79], Avg: 127.6675 (0.284)
Ep: 418, Reward: -39.8435, Test: -51.3674 [36.24], Avg: 127.1537 (0.283)
Ep: 419, Reward: -57.1672, Test: -27.1519 [34.45], Avg: 126.7043 (0.282)
Ep: 420, Reward: -55.2815, Test: -49.0471 [38.84], Avg: 126.1946 (0.281)
Ep: 421, Reward: -51.3844, Test: -67.8890 [30.17], Avg: 125.6632 (0.281)
Ep: 422, Reward: -47.4269, Test: -49.2703 [34.03], Avg: 125.1692 (0.280)
Ep: 423, Reward: -46.1589, Test: -56.7295 [35.97], Avg: 124.6553 (0.279)
Ep: 424, Reward: -46.9598, Test: -41.0087 [38.81], Avg: 124.1742 (0.278)
Ep: 425, Reward: -47.2122, Test: -36.8591 [38.99], Avg: 123.7047 (0.277)
Ep: 426, Reward: -38.4634, Test: -42.1276 [44.47], Avg: 123.2121 (0.276)
Ep: 427, Reward: -45.2473, Test: -35.2982 [47.40], Avg: 122.7310 (0.276)
Ep: 428, Reward: -40.2928, Test: -41.8018 [38.51], Avg: 122.2578 (0.275)
Ep: 429, Reward: -38.8568, Test: -55.9855 [41.72], Avg: 121.7462 (0.274)
Ep: 430, Reward: -45.4609, Test: -14.9978 [39.36], Avg: 121.3376 (0.273)
Ep: 431, Reward: -31.4251, Test: -45.1656 [47.63], Avg: 120.8420 (0.272)
Ep: 432, Reward: -24.0112, Test: -32.0208 [52.97], Avg: 120.3666 (0.271)
Ep: 433, Reward: -25.8718, Test: -30.0123 [45.05], Avg: 119.9163 (0.271)
Ep: 434, Reward: -33.6368, Test: -33.8642 [48.50], Avg: 119.4513 (0.270)
Ep: 435, Reward: -24.7884, Test: -36.0375 [37.17], Avg: 119.0094 (0.269)
Ep: 436, Reward: -28.7173, Test: -39.4789 [43.60], Avg: 118.5470 (0.268)
Ep: 437, Reward: -24.1504, Test: -13.9561 [40.60], Avg: 118.1518 (0.267)
Ep: 438, Reward: -26.1183, Test: -42.1554 [51.24], Avg: 117.6699 (0.267)
Ep: 439, Reward: -24.4388, Test: -49.6738 [40.51], Avg: 117.1975 (0.266)
Ep: 440, Reward: -15.7582, Test: -0.4593 [49.21], Avg: 116.8191 (0.265)
Ep: 441, Reward: -30.3793, Test: -33.4131 [46.84], Avg: 116.3732 (0.264)
Ep: 442, Reward: -44.8891, Test: -51.1642 [44.83], Avg: 115.8938 (0.263)
Ep: 443, Reward: -17.9116, Test: -42.8880 [50.92], Avg: 115.4215 (0.263)
Ep: 444, Reward: -22.8180, Test: -57.5631 [40.95], Avg: 114.9408 (0.262)
Ep: 445, Reward: -8.3700, Test: -27.5348 [42.23], Avg: 114.5266 (0.261)
Ep: 446, Reward: -18.3290, Test: -27.3261 [44.80], Avg: 114.1091 (0.260)
Ep: 447, Reward: -11.2627, Test: -14.0091 [38.09], Avg: 113.7381 (0.259)
Ep: 448, Reward: -8.3535, Test: -13.7065 [39.42], Avg: 113.3664 (0.259)
Ep: 449, Reward: -14.5184, Test: -44.7600 [39.75], Avg: 112.9267 (0.258)
Ep: 450, Reward: -11.0953, Test: -14.9067 [43.56], Avg: 112.5467 (0.257)
Ep: 451, Reward: -32.7593, Test: -40.7135 [45.51], Avg: 112.1069 (0.256)
Ep: 452, Reward: -9.1608, Test: 3.9551 [29.88], Avg: 111.8022 (0.256)
Ep: 453, Reward: -36.1438, Test: -20.4175 [46.67], Avg: 111.4082 (0.255)
Ep: 454, Reward: -7.7124, Test: -34.1731 [42.13], Avg: 110.9956 (0.254)
Ep: 455, Reward: -42.2456, Test: -22.4020 [49.97], Avg: 110.5935 (0.253)
Ep: 456, Reward: -27.1008, Test: -12.4573 [47.56], Avg: 110.2201 (0.253)
Ep: 457, Reward: -21.1468, Test: -14.2107 [49.34], Avg: 109.8407 (0.252)
Ep: 458, Reward: -18.8558, Test: -35.3755 [36.82], Avg: 109.4441 (0.251)
Ep: 459, Reward: -35.7358, Test: -6.4392 [35.17], Avg: 109.1158 (0.250)
Ep: 460, Reward: -23.4076, Test: -45.1869 [42.71], Avg: 108.6884 (0.250)
Ep: 461, Reward: -37.8833, Test: -30.5697 [39.30], Avg: 108.3019 (0.249)
Ep: 462, Reward: -30.2086, Test: -14.4549 [59.05], Avg: 107.9092 (0.248)
Ep: 463, Reward: -20.8490, Test: -7.8731 [47.53], Avg: 107.5572 (0.247)
Ep: 464, Reward: -10.5571, Test: -2.3680 [49.57], Avg: 107.2142 (0.247)
Ep: 465, Reward: -7.4668, Test: -4.4479 [47.50], Avg: 106.8727 (0.246)
Ep: 466, Reward: 14.0339, Test: -36.6799 [50.81], Avg: 106.4565 (0.245)
Ep: 467, Reward: -0.3448, Test: -28.6426 [53.21], Avg: 106.0541 (0.244)
Ep: 468, Reward: -8.6950, Test: -29.8944 [48.99], Avg: 105.6598 (0.244)
Ep: 469, Reward: -8.5094, Test: -2.2552 [32.52], Avg: 105.3610 (0.243)
Ep: 470, Reward: 8.0562, Test: -10.3548 [52.84], Avg: 105.0031 (0.242)
Ep: 471, Reward: -25.4244, Test: -16.9207 [52.66], Avg: 104.6332 (0.241)
Ep: 472, Reward: -23.9024, Test: -11.2301 [55.07], Avg: 104.2719 (0.241)
Ep: 473, Reward: -18.5970, Test: 29.1705 [31.90], Avg: 104.0461 (0.240)
Ep: 474, Reward: 4.7722, Test: 4.3620 [44.40], Avg: 103.7428 (0.239)
Ep: 475, Reward: 3.2677, Test: 6.0033 [56.20], Avg: 103.4194 (0.239)
Ep: 476, Reward: -4.0496, Test: -9.8852 [68.60], Avg: 103.0380 (0.238)
Ep: 477, Reward: -22.9912, Test: 0.9949 [38.31], Avg: 102.7444 (0.237)
Ep: 478, Reward: 6.1843, Test: -8.7848 [51.03], Avg: 102.4050 (0.236)
Ep: 479, Reward: -21.8613, Test: -3.1987 [46.97], Avg: 102.0872 (0.236)
Ep: 480, Reward: 3.8274, Test: -18.0317 [58.32], Avg: 101.7162 (0.235)
Ep: 481, Reward: -5.9161, Test: -21.8384 [56.03], Avg: 101.3436 (0.234)
Ep: 482, Reward: -22.9304, Test: 8.6936 [55.98], Avg: 101.0359 (0.234)
Ep: 483, Reward: 15.9701, Test: -10.8259 [48.19], Avg: 100.7052 (0.233)
Ep: 484, Reward: -9.4244, Test: 4.9629 [39.57], Avg: 100.4262 (0.232)
Ep: 485, Reward: -3.0369, Test: -9.9884 [46.74], Avg: 100.1029 (0.231)
Ep: 486, Reward: -20.9333, Test: -8.8256 [60.81], Avg: 99.7543 (0.231)
Ep: 487, Reward: 12.9333, Test: -11.1782 [45.80], Avg: 99.4332 (0.230)
Ep: 488, Reward: -30.4905, Test: -30.1160 [49.08], Avg: 99.0679 (0.229)
Ep: 489, Reward: -32.4305, Test: -13.2201 [54.04], Avg: 98.7284 (0.229)
Ep: 490, Reward: -15.5037, Test: -15.4801 [47.42], Avg: 98.3992 (0.228)
Ep: 491, Reward: -33.7678, Test: -0.6769 [40.66], Avg: 98.1152 (0.227)
Ep: 492, Reward: 3.1268, Test: -23.4227 [38.65], Avg: 97.7903 (0.227)
Ep: 493, Reward: -14.3427, Test: -32.3247 [46.43], Avg: 97.4329 (0.226)
Ep: 494, Reward: -18.9335, Test: -36.1182 [51.81], Avg: 97.0585 (0.225)
Ep: 495, Reward: -2.3102, Test: -27.1300 [50.14], Avg: 96.7070 (0.225)
Ep: 496, Reward: -9.8540, Test: 1.4659 [33.66], Avg: 96.4476 (0.224)
Ep: 497, Reward: -14.8474, Test: -17.5150 [40.66], Avg: 96.1371 (0.223)
Ep: 498, Reward: -22.2124, Test: -27.8731 [43.68], Avg: 95.8011 (0.223)
Ep: 499, Reward: -23.5039, Test: 5.3924 [22.38], Avg: 95.5755 (0.222)
