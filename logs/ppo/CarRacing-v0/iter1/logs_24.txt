Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.998             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 4					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.005				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) + critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(zip(states, actions, log_probs, targets, advantages))
			for _ in range(PPO_EPOCHS):
				for i in range(0, len(self.replay_buffer), BATCH_SIZE):
					state, action, log_prob, target, advantage = self.replay_buffer.index(BATCH_SIZE, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, e_weight=self.eps*ENTROPY_WEIGHT, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -37.0277, Test: -24.5542 [13.18], Avg: -37.7354 (0.998)
Ep: 1, Reward: -38.1705, Test: -19.1665 [23.95], Avg: -40.4269 (0.996)
Ep: 2, Reward: -43.7616, Test: -32.2846 [14.33], Avg: -42.4879 (0.994)
Ep: 3, Reward: -53.2950, Test: -101.8927 [33.77], Avg: -65.7822 (0.992)
Ep: 4, Reward: -60.7861, Test: -79.1202 [3.33], Avg: -69.1157 (0.990)
Ep: 5, Reward: -68.2660, Test: -83.0173 [1.03], Avg: -71.6037 (0.988)
Ep: 6, Reward: -74.7009, Test: -82.3559 [1.85], Avg: -73.4033 (0.986)
Ep: 7, Reward: -77.1809, Test: -83.5200 [3.99], Avg: -75.1665 (0.984)
Ep: 8, Reward: -72.0767, Test: -85.8168 [2.35], Avg: -76.6110 (0.982)
Ep: 9, Reward: -72.8966, Test: -86.0460 [1.98], Avg: -77.7528 (0.980)
Ep: 10, Reward: -75.2434, Test: -85.7164 [2.31], Avg: -78.6865 (0.978)
Ep: 11, Reward: -74.6941, Test: -85.6628 [2.06], Avg: -79.4392 (0.976)
Ep: 12, Reward: -74.6756, Test: -85.8113 [1.59], Avg: -80.0517 (0.974)
Ep: 13, Reward: -76.4741, Test: -86.3696 [1.37], Avg: -80.6007 (0.972)
Ep: 14, Reward: -77.3089, Test: -85.4533 [1.29], Avg: -81.0104 (0.970)
Ep: 15, Reward: -76.9334, Test: -85.9731 [1.83], Avg: -81.4348 (0.968)
Ep: 16, Reward: -74.8790, Test: -86.1269 [1.73], Avg: -81.8124 (0.967)
Ep: 17, Reward: -76.6959, Test: -86.2755 [1.22], Avg: -82.1280 (0.965)
Ep: 18, Reward: -75.5565, Test: -84.7546 [2.55], Avg: -82.4005 (0.963)
Ep: 19, Reward: -74.3238, Test: -83.0869 [1.40], Avg: -82.5046 (0.961)
Ep: 20, Reward: -78.1839, Test: -84.2395 [1.35], Avg: -82.6517 (0.959)
Ep: 21, Reward: -75.1375, Test: -83.5491 [2.47], Avg: -82.8048 (0.957)
Ep: 22, Reward: -77.0374, Test: -83.6745 [1.46], Avg: -82.9062 (0.955)
Ep: 23, Reward: -75.9770, Test: -83.3111 [1.09], Avg: -82.9686 (0.953)
Ep: 24, Reward: -76.9784, Test: -82.6731 [1.33], Avg: -83.0099 (0.951)
Ep: 25, Reward: -74.9184, Test: -83.1072 [1.06], Avg: -83.0543 (0.949)
Ep: 26, Reward: -74.5747, Test: -82.8640 [1.43], Avg: -83.1003 (0.947)
Ep: 27, Reward: -74.0162, Test: -82.3465 [1.33], Avg: -83.1210 (0.945)
Ep: 28, Reward: -73.3754, Test: -82.4483 [1.27], Avg: -83.1416 (0.944)
Ep: 29, Reward: -73.1026, Test: -82.1640 [0.99], Avg: -83.1420 (0.942)
Ep: 30, Reward: -75.2744, Test: -83.0739 [1.07], Avg: -83.1744 (0.940)
Ep: 31, Reward: -71.8260, Test: -83.3688 [1.31], Avg: -83.2215 (0.938)
Ep: 32, Reward: -76.1484, Test: -82.9383 [1.46], Avg: -83.2572 (0.936)
Ep: 33, Reward: -74.3353, Test: -81.9514 [1.41], Avg: -83.2603 (0.934)
Ep: 34, Reward: -74.0385, Test: -82.8997 [0.92], Avg: -83.2762 (0.932)
Ep: 35, Reward: -76.1507, Test: -83.5452 [1.88], Avg: -83.3359 (0.930)
Ep: 36, Reward: -75.6934, Test: -83.1199 [1.02], Avg: -83.3576 (0.929)
Ep: 37, Reward: -78.5789, Test: -83.3362 [1.52], Avg: -83.3970 (0.927)
Ep: 38, Reward: -78.2432, Test: -83.1849 [1.17], Avg: -83.4215 (0.925)
Ep: 39, Reward: -75.9848, Test: -82.8004 [1.85], Avg: -83.4521 (0.923)
Ep: 40, Reward: -76.6866, Test: -82.6531 [1.33], Avg: -83.4650 (0.921)
Ep: 41, Reward: -77.2063, Test: -82.6163 [0.91], Avg: -83.4665 (0.919)
Ep: 42, Reward: -78.4789, Test: -83.0276 [1.14], Avg: -83.4828 (0.918)
Ep: 43, Reward: -71.1616, Test: -82.6884 [0.89], Avg: -83.4849 (0.916)
Ep: 44, Reward: -73.3779, Test: -82.8629 [1.11], Avg: -83.4957 (0.914)
Ep: 45, Reward: -60.6222, Test: -82.6747 [1.43], Avg: -83.5089 (0.912)
Ep: 46, Reward: -59.0793, Test: -82.5307 [1.38], Avg: -83.5174 (0.910)
Ep: 47, Reward: -36.7813, Test: -82.7784 [1.31], Avg: -83.5292 (0.908)
Ep: 48, Reward: -28.6700, Test: -83.1049 [1.62], Avg: -83.5537 (0.907)
Ep: 49, Reward: -31.3163, Test: -83.5994 [2.11], Avg: -83.5967 (0.905)
Ep: 50, Reward: -34.1328, Test: -82.9820 [1.63], Avg: -83.6167 (0.903)
Ep: 51, Reward: 2.5576, Test: -76.0830 [10.97], Avg: -83.6827 (0.901)
Ep: 52, Reward: 13.1604, Test: -77.1420 [10.70], Avg: -83.7612 (0.899)
Ep: 53, Reward: 5.7755, Test: -65.3062 [15.99], Avg: -83.7155 (0.898)
Ep: 54, Reward: 29.5472, Test: -55.6738 [8.53], Avg: -83.3607 (0.896)
Ep: 55, Reward: 39.8388, Test: -63.4045 [9.79], Avg: -83.1792 (0.894)
Ep: 56, Reward: 80.0499, Test: -63.0623 [15.95], Avg: -83.1061 (0.892)
Ep: 57, Reward: 71.2633, Test: -70.3842 [8.27], Avg: -83.0294 (0.890)
Ep: 58, Reward: 97.9645, Test: -74.5641 [5.35], Avg: -82.9766 (0.889)
Ep: 59, Reward: 109.0763, Test: -74.8577 [4.65], Avg: -82.9187 (0.887)
Ep: 60, Reward: 117.1811, Test: -76.9724 [1.47], Avg: -82.8454 (0.885)
Ep: 61, Reward: 142.0094, Test: -71.8257 [6.93], Avg: -82.7795 (0.883)
Ep: 62, Reward: 149.5840, Test: -75.4811 [1.82], Avg: -82.6926 (0.882)
Ep: 63, Reward: 130.8640, Test: -73.7620 [7.29], Avg: -82.6669 (0.880)
Ep: 64, Reward: 135.5816, Test: -72.7344 [9.96], Avg: -82.6673 (0.878)
Ep: 65, Reward: 147.6184, Test: -72.2408 [6.84], Avg: -82.6129 (0.876)
Ep: 66, Reward: 152.9102, Test: -69.0713 [8.19], Avg: -82.5331 (0.874)
Ep: 67, Reward: 196.0010, Test: -70.5520 [9.71], Avg: -82.4997 (0.873)
Ep: 68, Reward: 181.3172, Test: -72.4176 [3.97], Avg: -82.4111 (0.871)
Ep: 69, Reward: 176.0637, Test: -72.2129 [10.24], Avg: -82.4117 (0.869)
Ep: 70, Reward: 160.6544, Test: -70.4211 [6.32], Avg: -82.3318 (0.867)
Ep: 71, Reward: 166.3992, Test: -70.0896 [6.37], Avg: -82.2502 (0.866)
Ep: 72, Reward: 181.0578, Test: -72.5891 [5.27], Avg: -82.1902 (0.864)
Ep: 73, Reward: 192.7106, Test: -69.7602 [7.39], Avg: -82.1220 (0.862)
Ep: 74, Reward: 194.8675, Test: -70.8448 [6.03], Avg: -82.0520 (0.861)
Ep: 75, Reward: 157.5612, Test: -73.0148 [4.39], Avg: -81.9909 (0.859)
Ep: 76, Reward: 182.5184, Test: -67.7838 [9.96], Avg: -81.9357 (0.857)
Ep: 77, Reward: 163.4772, Test: -68.3526 [7.58], Avg: -81.8587 (0.855)
Ep: 78, Reward: 200.2874, Test: -69.9226 [6.84], Avg: -81.7942 (0.854)
Ep: 79, Reward: 160.9719, Test: -69.4320 [6.97], Avg: -81.7268 (0.852)
Ep: 80, Reward: 175.5279, Test: -71.0816 [8.66], Avg: -81.7023 (0.850)
Ep: 81, Reward: 217.1429, Test: -66.8246 [7.21], Avg: -81.6088 (0.849)
Ep: 82, Reward: 198.9726, Test: -72.0751 [4.97], Avg: -81.5539 (0.847)
Ep: 83, Reward: 185.5855, Test: -63.9254 [10.83], Avg: -81.4730 (0.845)
Ep: 84, Reward: 225.9132, Test: -62.9470 [16.25], Avg: -81.4462 (0.844)
Ep: 85, Reward: 212.4040, Test: -65.3646 [7.76], Avg: -81.3494 (0.842)
Ep: 86, Reward: 151.0676, Test: -64.6714 [5.63], Avg: -81.2225 (0.840)
Ep: 87, Reward: 172.4449, Test: -64.7529 [9.53], Avg: -81.1436 (0.838)
Ep: 88, Reward: 162.9105, Test: -63.6315 [6.60], Avg: -81.0210 (0.837)
Ep: 89, Reward: 178.4394, Test: -69.3463 [4.57], Avg: -80.9420 (0.835)
Ep: 90, Reward: 160.8331, Test: -68.7365 [9.74], Avg: -80.9149 (0.833)
Ep: 91, Reward: 194.6364, Test: -66.0686 [6.83], Avg: -80.8278 (0.832)
Ep: 92, Reward: 141.4233, Test: -63.5306 [6.63], Avg: -80.7131 (0.830)
Ep: 93, Reward: 139.0590, Test: -63.6115 [7.67], Avg: -80.6127 (0.828)
Ep: 94, Reward: 134.7997, Test: -65.2086 [7.28], Avg: -80.5272 (0.827)
Ep: 95, Reward: 139.7784, Test: -64.2019 [9.81], Avg: -80.4593 (0.825)
Ep: 96, Reward: 177.4095, Test: -59.4636 [12.74], Avg: -80.3742 (0.823)
Ep: 97, Reward: 127.8369, Test: -66.7193 [8.11], Avg: -80.3176 (0.822)
Ep: 98, Reward: 142.4042, Test: -64.1944 [6.00], Avg: -80.2153 (0.820)
Ep: 99, Reward: 175.7374, Test: -65.2120 [8.37], Avg: -80.1490 (0.819)
Ep: 100, Reward: 167.3012, Test: -67.2278 [4.40], Avg: -80.0647 (0.817)
Ep: 101, Reward: 217.5028, Test: -65.8349 [7.48], Avg: -79.9985 (0.815)
Ep: 102, Reward: 176.6711, Test: -54.2504 [12.67], Avg: -79.8715 (0.814)
Ep: 103, Reward: 179.7576, Test: -53.6670 [14.19], Avg: -79.7560 (0.812)
Ep: 104, Reward: 223.1705, Test: -62.9846 [8.09], Avg: -79.6733 (0.810)
Ep: 105, Reward: 196.7917, Test: -60.6801 [9.79], Avg: -79.5864 (0.809)
Ep: 106, Reward: 219.2305, Test: -63.3201 [11.31], Avg: -79.5401 (0.807)
Ep: 107, Reward: 230.5789, Test: -60.4874 [8.83], Avg: -79.4454 (0.806)
Ep: 108, Reward: 184.1568, Test: -66.3894 [6.42], Avg: -79.3845 (0.804)
Ep: 109, Reward: 212.3116, Test: -53.8461 [13.89], Avg: -79.2786 (0.802)
Ep: 110, Reward: 236.6204, Test: -43.3851 [25.40], Avg: -79.1840 (0.801)
Ep: 111, Reward: 198.7323, Test: -54.3975 [7.61], Avg: -79.0307 (0.799)
Ep: 112, Reward: 257.3637, Test: -54.9059 [8.67], Avg: -78.8939 (0.798)
Ep: 113, Reward: 170.9719, Test: -39.7255 [13.73], Avg: -78.6708 (0.796)
Ep: 114, Reward: 175.1746, Test: -41.1522 [18.73], Avg: -78.5074 (0.794)
Ep: 115, Reward: 185.9387, Test: -55.9797 [6.12], Avg: -78.3660 (0.793)
Ep: 116, Reward: 222.2664, Test: -46.7910 [18.93], Avg: -78.2579 (0.791)
Ep: 117, Reward: 201.0449, Test: -52.2881 [17.94], Avg: -78.1899 (0.790)
Ep: 118, Reward: 220.3190, Test: -46.6222 [16.60], Avg: -78.0641 (0.788)
Ep: 119, Reward: 227.0102, Test: -56.3428 [12.50], Avg: -77.9873 (0.786)
Ep: 120, Reward: 220.4316, Test: -38.6279 [20.65], Avg: -77.8327 (0.785)
Ep: 121, Reward: 277.4753, Test: -55.1406 [11.74], Avg: -77.7429 (0.783)
Ep: 122, Reward: 299.7495, Test: -51.5490 [18.17], Avg: -77.6776 (0.782)
Ep: 123, Reward: 287.3258, Test: -46.1898 [14.85], Avg: -77.5434 (0.780)
Ep: 124, Reward: 235.6797, Test: -56.0024 [10.20], Avg: -77.4527 (0.779)
Ep: 125, Reward: 253.2969, Test: -45.5654 [25.06], Avg: -77.3985 (0.777)
Ep: 126, Reward: 244.5136, Test: -58.3774 [13.70], Avg: -77.3566 (0.775)
Ep: 127, Reward: 261.1598, Test: -44.2861 [19.13], Avg: -77.2477 (0.774)
Ep: 128, Reward: 258.0237, Test: -53.6591 [10.41], Avg: -77.1455 (0.772)
Ep: 129, Reward: 293.4398, Test: -44.8186 [19.19], Avg: -77.0445 (0.771)
Ep: 130, Reward: 274.6455, Test: -30.4862 [32.83], Avg: -76.9397 (0.769)
Ep: 131, Reward: 228.2268, Test: -43.1347 [11.75], Avg: -76.7726 (0.768)
Ep: 132, Reward: 231.8875, Test: -52.2769 [17.18], Avg: -76.7176 (0.766)
Ep: 133, Reward: 259.5411, Test: -33.4833 [34.56], Avg: -76.6529 (0.765)
Ep: 134, Reward: 237.8392, Test: -38.7739 [15.21], Avg: -76.4849 (0.763)
Ep: 135, Reward: 175.7861, Test: -48.1616 [21.33], Avg: -76.4335 (0.762)
Ep: 136, Reward: 256.0291, Test: -34.9345 [29.25], Avg: -76.3441 (0.760)
Ep: 137, Reward: 233.3164, Test: -32.1076 [37.81], Avg: -76.2976 (0.759)
Ep: 138, Reward: 230.5007, Test: -38.2012 [24.64], Avg: -76.2008 (0.757)
Ep: 139, Reward: 205.0294, Test: -42.2773 [23.89], Avg: -76.1291 (0.756)
Ep: 140, Reward: 185.1527, Test: -40.8146 [21.21], Avg: -76.0291 (0.754)
Ep: 141, Reward: 202.5425, Test: -10.4058 [34.23], Avg: -75.8080 (0.753)
Ep: 142, Reward: 199.8061, Test: -32.0779 [27.52], Avg: -75.6946 (0.751)
Ep: 143, Reward: 223.4206, Test: -35.0233 [23.45], Avg: -75.5750 (0.750)
Ep: 144, Reward: 195.1764, Test: -36.4068 [32.00], Avg: -75.5256 (0.748)
Ep: 145, Reward: 216.5544, Test: -36.3491 [21.76], Avg: -75.4063 (0.747)
Ep: 146, Reward: 228.6565, Test: -20.6687 [57.39], Avg: -75.4244 (0.745)
Ep: 147, Reward: 225.8300, Test: -42.6076 [14.76], Avg: -75.3023 (0.744)
Ep: 148, Reward: 208.1444, Test: -14.8672 [35.82], Avg: -75.1371 (0.742)
Ep: 149, Reward: 226.0488, Test: -6.6544 [44.31], Avg: -74.9760 (0.741)
Ep: 150, Reward: 243.2944, Test: -32.1905 [28.12], Avg: -74.8788 (0.739)
Ep: 151, Reward: 253.7676, Test: -10.8680 [39.68], Avg: -74.7188 (0.738)
Ep: 152, Reward: 234.0752, Test: -32.5260 [15.09], Avg: -74.5416 (0.736)
Ep: 153, Reward: 249.0794, Test: -19.7111 [47.99], Avg: -74.4972 (0.735)
Ep: 154, Reward: 240.9381, Test: 4.2482 [29.89], Avg: -74.1820 (0.733)
Ep: 155, Reward: 250.3080, Test: 31.7240 [55.59], Avg: -73.8595 (0.732)
Ep: 156, Reward: 279.0293, Test: -1.4965 [39.01], Avg: -73.6470 (0.730)
Ep: 157, Reward: 238.4633, Test: -4.0909 [37.59], Avg: -73.4447 (0.729)
Ep: 158, Reward: 212.0918, Test: -14.3412 [23.52], Avg: -73.2210 (0.727)
Ep: 159, Reward: 208.3286, Test: -11.0526 [44.73], Avg: -73.1120 (0.726)
Ep: 160, Reward: 231.2699, Test: -25.7871 [31.30], Avg: -73.0124 (0.724)
Ep: 161, Reward: 278.8481, Test: -27.5002 [17.69], Avg: -72.8407 (0.723)
Ep: 162, Reward: 258.5024, Test: -32.1740 [24.88], Avg: -72.7438 (0.722)
Ep: 163, Reward: 267.6352, Test: -26.5917 [32.93], Avg: -72.6631 (0.720)
Ep: 164, Reward: 210.7948, Test: -2.7913 [27.19], Avg: -72.4044 (0.719)
Ep: 165, Reward: 235.2703, Test: -15.0369 [20.14], Avg: -72.1802 (0.717)
Ep: 166, Reward: 246.2035, Test: -12.1483 [52.40], Avg: -72.1345 (0.716)
Ep: 167, Reward: 266.2126, Test: 5.2879 [27.37], Avg: -71.8366 (0.714)
Ep: 168, Reward: 244.8208, Test: 29.3513 [35.75], Avg: -71.4493 (0.713)
Ep: 169, Reward: 277.2276, Test: 17.3818 [33.23], Avg: -71.1222 (0.712)
Ep: 170, Reward: 302.5581, Test: 13.3838 [26.95], Avg: -70.7857 (0.710)
Ep: 171, Reward: 307.1041, Test: 24.4066 [37.00], Avg: -70.4473 (0.709)
Ep: 172, Reward: 264.3194, Test: 17.9117 [39.16], Avg: -70.1630 (0.707)
Ep: 173, Reward: 294.4725, Test: 27.7293 [47.62], Avg: -69.8740 (0.706)
Ep: 174, Reward: 310.6023, Test: 10.1879 [20.67], Avg: -69.5346 (0.704)
Ep: 175, Reward: 284.7144, Test: 4.4603 [37.73], Avg: -69.3285 (0.703)
Ep: 176, Reward: 273.1077, Test: 13.2066 [42.85], Avg: -69.1043 (0.702)
Ep: 177, Reward: 211.3154, Test: 21.8928 [36.69], Avg: -68.7992 (0.700)
Ep: 178, Reward: 262.2386, Test: -8.3756 [32.16], Avg: -68.6413 (0.699)
Ep: 179, Reward: 258.8705, Test: 20.6988 [42.52], Avg: -68.3813 (0.697)
Ep: 180, Reward: 264.2765, Test: 5.5522 [33.62], Avg: -68.1585 (0.696)
Ep: 181, Reward: 287.6770, Test: 31.6698 [57.85], Avg: -67.9279 (0.695)
Ep: 182, Reward: 279.9830, Test: 6.6612 [28.96], Avg: -67.6785 (0.693)
Ep: 183, Reward: 240.5347, Test: 26.5730 [25.06], Avg: -67.3025 (0.692)
Ep: 184, Reward: 256.7458, Test: 6.6732 [42.78], Avg: -67.1339 (0.690)
Ep: 185, Reward: 267.9366, Test: 22.3088 [39.69], Avg: -66.8664 (0.689)
Ep: 186, Reward: 226.7739, Test: 11.9665 [40.16], Avg: -66.6596 (0.688)
Ep: 187, Reward: 242.0223, Test: 9.4836 [47.96], Avg: -66.5097 (0.686)
Ep: 188, Reward: 243.6595, Test: 7.6983 [28.45], Avg: -66.2676 (0.685)
Ep: 189, Reward: 259.1169, Test: 5.4693 [24.88], Avg: -66.0210 (0.684)
Ep: 190, Reward: 235.2620, Test: 17.5561 [46.77], Avg: -65.8283 (0.682)
Ep: 191, Reward: 284.9038, Test: 40.0859 [28.54], Avg: -65.4253 (0.681)
Ep: 192, Reward: 258.1783, Test: 7.3119 [25.67], Avg: -65.1814 (0.680)
Ep: 193, Reward: 228.6263, Test: 22.8260 [36.36], Avg: -64.9152 (0.678)
Ep: 194, Reward: 255.2123, Test: 21.0595 [28.14], Avg: -64.6186 (0.677)
Ep: 195, Reward: 275.1742, Test: 16.6823 [46.13], Avg: -64.4391 (0.675)
Ep: 196, Reward: 303.0860, Test: 4.6214 [32.00], Avg: -64.2510 (0.674)
Ep: 197, Reward: 255.8758, Test: 14.8073 [38.81], Avg: -64.0478 (0.673)
Ep: 198, Reward: 277.2528, Test: 8.7980 [31.60], Avg: -63.8405 (0.671)
Ep: 199, Reward: 309.2767, Test: 12.4667 [25.12], Avg: -63.5846 (0.670)
Ep: 200, Reward: 205.0790, Test: 6.2024 [32.27], Avg: -63.3979 (0.669)
Ep: 201, Reward: 242.4976, Test: 8.6383 [24.98], Avg: -63.1649 (0.667)
Ep: 202, Reward: 209.0334, Test: 3.2032 [27.07], Avg: -62.9714 (0.666)
Ep: 203, Reward: 255.8976, Test: 16.3209 [28.08], Avg: -62.7203 (0.665)
Ep: 204, Reward: 263.1991, Test: 13.0054 [24.96], Avg: -62.4727 (0.663)
Ep: 205, Reward: 212.0275, Test: 9.4488 [52.33], Avg: -62.3775 (0.662)
Ep: 206, Reward: 238.5922, Test: 4.8805 [36.87], Avg: -62.2307 (0.661)
Ep: 207, Reward: 206.0707, Test: 6.6735 [26.29], Avg: -62.0258 (0.659)
Ep: 208, Reward: 241.9644, Test: 31.7896 [44.85], Avg: -61.7916 (0.658)
Ep: 209, Reward: 247.9636, Test: 17.7279 [29.28], Avg: -61.5523 (0.657)
Ep: 210, Reward: 227.2906, Test: 35.2355 [27.52], Avg: -61.2240 (0.655)
Ep: 211, Reward: 268.4332, Test: 10.6510 [29.29], Avg: -61.0231 (0.654)
Ep: 212, Reward: 209.4021, Test: 30.8625 [50.59], Avg: -60.8293 (0.653)
Ep: 213, Reward: 175.0482, Test: 18.3566 [31.04], Avg: -60.6043 (0.652)
Ep: 214, Reward: 203.6062, Test: 48.9196 [41.78], Avg: -60.2892 (0.650)
Ep: 215, Reward: 241.9093, Test: 38.3993 [39.28], Avg: -60.0142 (0.649)
Ep: 216, Reward: 171.5315, Test: 9.0425 [57.37], Avg: -59.9603 (0.648)
Ep: 217, Reward: 181.1179, Test: 24.7758 [24.45], Avg: -59.6838 (0.646)
Ep: 218, Reward: 191.0613, Test: 6.6839 [20.16], Avg: -59.4728 (0.645)
Ep: 219, Reward: 214.6532, Test: 4.8290 [42.96], Avg: -59.3758 (0.644)
Ep: 220, Reward: 228.1432, Test: 22.5094 [29.21], Avg: -59.1374 (0.642)
Ep: 221, Reward: 171.0012, Test: -2.6023 [33.67], Avg: -59.0344 (0.641)
Ep: 222, Reward: 191.6044, Test: 15.8635 [36.57], Avg: -58.8626 (0.640)
Ep: 223, Reward: 154.8282, Test: 17.3439 [31.01], Avg: -58.6608 (0.639)
Ep: 224, Reward: 179.9811, Test: 2.5142 [29.30], Avg: -58.5191 (0.637)
Ep: 225, Reward: 185.9754, Test: 17.2502 [36.09], Avg: -58.3435 (0.636)
Ep: 226, Reward: 208.0561, Test: 6.1976 [34.08], Avg: -58.2094 (0.635)
Ep: 227, Reward: 219.6352, Test: 10.6838 [27.94], Avg: -58.0298 (0.634)
Ep: 228, Reward: 174.4288, Test: 14.8618 [11.78], Avg: -57.7629 (0.632)
Ep: 229, Reward: 239.7593, Test: 49.5857 [86.24], Avg: -57.6711 (0.631)
Ep: 230, Reward: 197.6847, Test: 25.6421 [41.96], Avg: -57.4921 (0.630)
Ep: 231, Reward: 200.6848, Test: 48.1287 [41.43], Avg: -57.2154 (0.628)
Ep: 232, Reward: 194.5477, Test: 19.8287 [49.04], Avg: -57.0952 (0.627)
Ep: 233, Reward: 237.3420, Test: 50.2922 [36.15], Avg: -56.7908 (0.626)
Ep: 234, Reward: 215.8231, Test: 6.9070 [23.42], Avg: -56.6194 (0.625)
Ep: 235, Reward: 212.0378, Test: 29.1230 [41.63], Avg: -56.4325 (0.623)
Ep: 236, Reward: 217.3735, Test: 48.0823 [32.38], Avg: -56.1281 (0.622)
Ep: 237, Reward: 202.7628, Test: 27.0812 [59.88], Avg: -56.0301 (0.621)
Ep: 238, Reward: 241.4717, Test: 22.1076 [47.69], Avg: -55.9027 (0.620)
Ep: 239, Reward: 212.0451, Test: 10.2715 [40.74], Avg: -55.7967 (0.618)
Ep: 240, Reward: 182.7891, Test: 19.1316 [25.17], Avg: -55.5902 (0.617)
Ep: 241, Reward: 232.2938, Test: 24.8982 [35.26], Avg: -55.4033 (0.616)
Ep: 242, Reward: 185.2156, Test: 45.1521 [49.59], Avg: -55.1936 (0.615)
Ep: 243, Reward: 208.4071, Test: 16.3558 [32.24], Avg: -55.0325 (0.614)
Ep: 244, Reward: 192.8159, Test: 34.7333 [26.84], Avg: -54.7757 (0.612)
Ep: 245, Reward: 214.5448, Test: 37.2116 [28.37], Avg: -54.5171 (0.611)
Ep: 246, Reward: 204.8399, Test: 45.5952 [35.34], Avg: -54.2548 (0.610)
Ep: 247, Reward: 198.3409, Test: 37.6784 [41.04], Avg: -54.0496 (0.609)
Ep: 248, Reward: 167.6470, Test: 37.0334 [35.18], Avg: -53.8251 (0.607)
Ep: 249, Reward: 207.8412, Test: 18.3590 [25.51], Avg: -53.6384 (0.606)
Ep: 250, Reward: 160.0097, Test: 20.6832 [35.11], Avg: -53.4822 (0.605)
Ep: 251, Reward: 183.2053, Test: 37.8782 [36.46], Avg: -53.2643 (0.604)
Ep: 252, Reward: 183.4297, Test: 17.2593 [31.07], Avg: -53.1084 (0.603)
Ep: 253, Reward: 209.8605, Test: 14.5627 [36.50], Avg: -52.9857 (0.601)
Ep: 254, Reward: 132.9043, Test: 23.7405 [24.29], Avg: -52.7800 (0.600)
Ep: 255, Reward: 187.7277, Test: 36.1579 [34.43], Avg: -52.5671 (0.599)
Ep: 256, Reward: 224.9683, Test: 29.1924 [33.06], Avg: -52.3776 (0.598)
Ep: 257, Reward: 172.5358, Test: 15.6403 [39.11], Avg: -52.2655 (0.597)
Ep: 258, Reward: 172.3770, Test: 19.7354 [27.00], Avg: -52.0918 (0.595)
Ep: 259, Reward: 180.7551, Test: 14.2166 [27.82], Avg: -51.9438 (0.594)
Ep: 260, Reward: 197.5320, Test: 29.7785 [28.83], Avg: -51.7411 (0.593)
Ep: 261, Reward: 179.7668, Test: 10.9018 [25.64], Avg: -51.5999 (0.592)
Ep: 262, Reward: 163.5691, Test: 30.2875 [26.59], Avg: -51.3896 (0.591)
Ep: 263, Reward: 187.7825, Test: 26.1233 [45.31], Avg: -51.2677 (0.589)
Ep: 264, Reward: 165.7146, Test: 11.7253 [32.30], Avg: -51.1518 (0.588)
Ep: 265, Reward: 185.8650, Test: 12.9742 [28.63], Avg: -51.0184 (0.587)
Ep: 266, Reward: 157.9198, Test: 46.1555 [45.36], Avg: -50.8243 (0.586)
Ep: 267, Reward: 174.3508, Test: 17.3134 [27.43], Avg: -50.6724 (0.585)
Ep: 268, Reward: 184.4670, Test: 23.1549 [28.25], Avg: -50.5030 (0.584)
Ep: 269, Reward: 171.7961, Test: 39.4699 [39.92], Avg: -50.3176 (0.582)
Ep: 270, Reward: 176.0824, Test: 6.5080 [22.79], Avg: -50.1920 (0.581)
Ep: 271, Reward: 198.6716, Test: 24.1804 [32.44], Avg: -50.0378 (0.580)
Ep: 272, Reward: 140.7220, Test: 12.1090 [35.91], Avg: -49.9418 (0.579)
Ep: 273, Reward: 166.0986, Test: 20.7020 [29.39], Avg: -49.7912 (0.578)
Ep: 274, Reward: 162.8165, Test: 6.9767 [28.78], Avg: -49.6894 (0.577)
Ep: 275, Reward: 164.6147, Test: 25.4177 [40.65], Avg: -49.5645 (0.575)
Ep: 276, Reward: 189.0399, Test: 26.7949 [57.39], Avg: -49.4961 (0.574)
Ep: 277, Reward: 149.9817, Test: 51.4944 [59.35], Avg: -49.3463 (0.573)
Ep: 278, Reward: 159.5103, Test: 29.9751 [55.14], Avg: -49.2596 (0.572)
Ep: 279, Reward: 150.8048, Test: 40.5590 [38.92], Avg: -49.0778 (0.571)
Ep: 280, Reward: 180.8494, Test: 28.5851 [51.09], Avg: -48.9833 (0.570)
Ep: 281, Reward: 176.7927, Test: 32.4476 [31.05], Avg: -48.8046 (0.569)
Ep: 282, Reward: 173.6968, Test: 36.8261 [54.94], Avg: -48.6962 (0.567)
Ep: 283, Reward: 147.5137, Test: 48.3199 [60.39], Avg: -48.5672 (0.566)
Ep: 284, Reward: 193.9642, Test: 36.7023 [29.38], Avg: -48.3711 (0.565)
Ep: 285, Reward: 193.9822, Test: 36.3434 [50.84], Avg: -48.2527 (0.564)
Ep: 286, Reward: 156.1554, Test: 23.9827 [22.20], Avg: -48.0783 (0.563)
Ep: 287, Reward: 159.9815, Test: 58.9112 [59.11], Avg: -47.9120 (0.562)
Ep: 288, Reward: 165.3224, Test: 39.2291 [40.05], Avg: -47.7491 (0.561)
Ep: 289, Reward: 159.6177, Test: 28.0106 [35.45], Avg: -47.6101 (0.560)
Ep: 290, Reward: 182.9112, Test: 28.7397 [40.64], Avg: -47.4874 (0.558)
Ep: 291, Reward: 123.3735, Test: 38.8610 [38.05], Avg: -47.3220 (0.557)
Ep: 292, Reward: 147.7788, Test: 46.3742 [51.01], Avg: -47.1763 (0.556)
Ep: 293, Reward: 160.6861, Test: 51.2917 [63.34], Avg: -47.0568 (0.555)
Ep: 294, Reward: 176.2117, Test: 69.5355 [57.10], Avg: -46.8552 (0.554)
Ep: 295, Reward: 155.1147, Test: 60.1049 [32.83], Avg: -46.6048 (0.553)
Ep: 296, Reward: 163.7735, Test: 53.5258 [31.57], Avg: -46.3739 (0.552)
Ep: 297, Reward: 161.4792, Test: 29.6752 [36.26], Avg: -46.2404 (0.551)
Ep: 298, Reward: 170.1168, Test: 23.1829 [35.95], Avg: -46.1285 (0.550)
Ep: 299, Reward: 147.4428, Test: 26.2462 [34.90], Avg: -46.0035 (0.548)
Ep: 300, Reward: 162.9885, Test: 46.8997 [61.80], Avg: -45.9002 (0.547)
Ep: 301, Reward: 149.7746, Test: 84.1917 [42.88], Avg: -45.6114 (0.546)
Ep: 302, Reward: 138.5828, Test: 48.3683 [48.61], Avg: -45.4617 (0.545)
Ep: 303, Reward: 162.6950, Test: 40.8927 [49.78], Avg: -45.3414 (0.544)
Ep: 304, Reward: 187.3704, Test: 17.7483 [30.11], Avg: -45.2332 (0.543)
Ep: 305, Reward: 155.1492, Test: 34.8634 [36.34], Avg: -45.0902 (0.542)
Ep: 306, Reward: 141.2808, Test: 28.0495 [37.33], Avg: -44.9736 (0.541)
Ep: 307, Reward: 147.5325, Test: 10.0626 [35.37], Avg: -44.9097 (0.540)
Ep: 308, Reward: 164.0881, Test: 31.3254 [34.40], Avg: -44.7743 (0.539)
Ep: 309, Reward: 171.6198, Test: 51.2129 [69.86], Avg: -44.6901 (0.538)
Ep: 310, Reward: 151.7541, Test: 67.7629 [50.22], Avg: -44.4900 (0.537)
Ep: 311, Reward: 171.6822, Test: 33.8811 [42.81], Avg: -44.3760 (0.535)
Ep: 312, Reward: 165.4627, Test: 3.5766 [42.36], Avg: -44.3581 (0.534)
Ep: 313, Reward: 135.0468, Test: 16.4044 [35.02], Avg: -44.2761 (0.533)
Ep: 314, Reward: 166.5055, Test: 29.5452 [51.44], Avg: -44.2050 (0.532)
Ep: 315, Reward: 173.2617, Test: 23.2687 [50.60], Avg: -44.1516 (0.531)
Ep: 316, Reward: 149.8432, Test: 13.1491 [30.48], Avg: -44.0670 (0.530)
Ep: 317, Reward: 127.0176, Test: 24.6750 [45.13], Avg: -43.9928 (0.529)
Ep: 318, Reward: 145.3505, Test: 32.6403 [21.70], Avg: -43.8205 (0.528)
Ep: 319, Reward: 147.9428, Test: 38.4252 [35.59], Avg: -43.6747 (0.527)
Ep: 320, Reward: 169.2608, Test: 50.8138 [61.26], Avg: -43.5712 (0.526)
Ep: 321, Reward: 129.2635, Test: 36.7058 [40.13], Avg: -43.4465 (0.525)
Ep: 322, Reward: 156.3455, Test: 35.6981 [40.24], Avg: -43.3261 (0.524)
Ep: 323, Reward: 129.3853, Test: 32.3260 [37.91], Avg: -43.2096 (0.523)
Ep: 324, Reward: 140.1913, Test: 45.4091 [44.65], Avg: -43.0743 (0.522)
Ep: 325, Reward: 163.4516, Test: 20.8984 [22.76], Avg: -42.9479 (0.521)
Ep: 326, Reward: 137.7838, Test: 43.3019 [40.09], Avg: -42.8067 (0.520)
Ep: 327, Reward: 170.0483, Test: 54.8310 [46.33], Avg: -42.6503 (0.519)
Ep: 328, Reward: 188.8831, Test: 64.3939 [55.18], Avg: -42.4927 (0.518)
Ep: 329, Reward: 113.2912, Test: 83.9672 [58.81], Avg: -42.2877 (0.517)
Ep: 330, Reward: 142.6887, Test: 11.4998 [29.20], Avg: -42.2134 (0.515)
Ep: 331, Reward: 144.2778, Test: 61.1726 [30.02], Avg: -41.9924 (0.514)
Ep: 332, Reward: 176.6518, Test: 44.3007 [39.59], Avg: -41.8522 (0.513)
Ep: 333, Reward: 159.3278, Test: 33.7473 [49.91], Avg: -41.7752 (0.512)
Ep: 334, Reward: 166.7041, Test: 19.6231 [28.79], Avg: -41.6779 (0.511)
Ep: 335, Reward: 133.6210, Test: 48.3798 [44.95], Avg: -41.5437 (0.510)
Ep: 336, Reward: 159.9865, Test: 54.9489 [70.20], Avg: -41.4656 (0.509)
Ep: 337, Reward: 150.8219, Test: 23.1451 [43.15], Avg: -41.4022 (0.508)
Ep: 338, Reward: 153.9852, Test: 39.7785 [39.46], Avg: -41.2791 (0.507)
Ep: 339, Reward: 141.9282, Test: 66.3106 [42.00], Avg: -41.0862 (0.506)
Ep: 340, Reward: 156.7274, Test: 57.1633 [53.08], Avg: -40.9537 (0.505)
Ep: 341, Reward: 167.5920, Test: 41.3302 [52.42], Avg: -40.8664 (0.504)
Ep: 342, Reward: 153.4952, Test: 61.1152 [56.78], Avg: -40.7346 (0.503)
Ep: 343, Reward: 125.5076, Test: 33.8858 [43.69], Avg: -40.6447 (0.502)
Ep: 344, Reward: 161.5589, Test: 48.6117 [34.17], Avg: -40.4850 (0.501)
Ep: 345, Reward: 202.1513, Test: 48.7684 [35.80], Avg: -40.3306 (0.500)
Ep: 346, Reward: 161.9623, Test: 38.1302 [48.80], Avg: -40.2451 (0.499)
Ep: 347, Reward: 132.2366, Test: 70.0060 [33.89], Avg: -40.0256 (0.498)
Ep: 348, Reward: 157.9932, Test: 58.2158 [56.52], Avg: -39.9061 (0.497)
Ep: 349, Reward: 159.7196, Test: 70.8926 [47.66], Avg: -39.7257 (0.496)
Ep: 350, Reward: 169.5592, Test: 77.7561 [53.52], Avg: -39.5435 (0.495)
Ep: 351, Reward: 146.8697, Test: 70.8102 [65.17], Avg: -39.4151 (0.494)
Ep: 352, Reward: 149.3546, Test: 50.9410 [58.70], Avg: -39.3254 (0.493)
Ep: 353, Reward: 153.0124, Test: 93.9539 [45.01], Avg: -39.0761 (0.492)
Ep: 354, Reward: 157.4644, Test: 73.6186 [61.94], Avg: -38.9331 (0.491)
Ep: 355, Reward: 142.3969, Test: 43.3942 [33.05], Avg: -38.7947 (0.490)
Ep: 356, Reward: 163.3799, Test: 65.2179 [57.88], Avg: -38.6655 (0.489)
Ep: 357, Reward: 212.7546, Test: 56.2146 [40.65], Avg: -38.5140 (0.488)
Ep: 358, Reward: 154.0710, Test: 53.0758 [49.30], Avg: -38.3962 (0.487)
Ep: 359, Reward: 149.7028, Test: 84.2431 [42.41], Avg: -38.1733 (0.486)
Ep: 360, Reward: 136.2064, Test: 56.6909 [40.83], Avg: -38.0237 (0.485)
Ep: 361, Reward: 158.0167, Test: 84.4231 [58.30], Avg: -37.8465 (0.484)
Ep: 362, Reward: 167.8091, Test: 50.1450 [45.94], Avg: -37.7306 (0.483)
Ep: 363, Reward: 176.1027, Test: 51.7109 [47.86], Avg: -37.6164 (0.483)
Ep: 364, Reward: 148.6300, Test: 47.6595 [38.35], Avg: -37.4878 (0.482)
Ep: 365, Reward: 159.6298, Test: 90.7797 [22.55], Avg: -37.1990 (0.481)
Ep: 366, Reward: 153.9542, Test: 51.8479 [47.41], Avg: -37.0855 (0.480)
Ep: 367, Reward: 177.8975, Test: 71.2064 [33.44], Avg: -36.8821 (0.479)
Ep: 368, Reward: 172.7746, Test: 110.9546 [44.37], Avg: -36.6017 (0.478)
Ep: 369, Reward: 180.3270, Test: 68.9636 [59.90], Avg: -36.4782 (0.477)
Ep: 370, Reward: 167.0701, Test: 76.4251 [72.80], Avg: -36.3702 (0.476)
Ep: 371, Reward: 137.0791, Test: 64.4950 [43.83], Avg: -36.2168 (0.475)
Ep: 372, Reward: 187.7743, Test: 54.2936 [50.85], Avg: -36.1105 (0.474)
Ep: 373, Reward: 194.0997, Test: 113.7937 [47.17], Avg: -35.8358 (0.473)
Ep: 374, Reward: 167.0101, Test: 49.7135 [43.31], Avg: -35.7232 (0.472)
Ep: 375, Reward: 142.1183, Test: 93.0580 [48.45], Avg: -35.5095 (0.471)
Ep: 376, Reward: 171.8956, Test: 79.7795 [46.68], Avg: -35.3275 (0.470)
Ep: 377, Reward: 153.3821, Test: 110.8746 [52.65], Avg: -35.0800 (0.469)
Ep: 378, Reward: 191.7664, Test: 102.8066 [50.11], Avg: -34.8484 (0.468)
Ep: 379, Reward: 201.9243, Test: 79.5328 [52.12], Avg: -34.6846 (0.467)
Ep: 380, Reward: 178.2105, Test: 106.6817 [62.37], Avg: -34.4773 (0.466)
Ep: 381, Reward: 160.8402, Test: 85.0137 [48.23], Avg: -34.2907 (0.465)
Ep: 382, Reward: 190.0219, Test: 106.9503 [40.57], Avg: -34.0279 (0.465)
Ep: 383, Reward: 184.2847, Test: 81.5499 [51.34], Avg: -33.8606 (0.464)
Ep: 384, Reward: 186.6966, Test: 73.3735 [29.49], Avg: -33.6586 (0.463)
Ep: 385, Reward: 195.6432, Test: 125.7608 [66.50], Avg: -33.4179 (0.462)
Ep: 386, Reward: 172.6055, Test: 79.3400 [55.24], Avg: -33.2693 (0.461)
Ep: 387, Reward: 188.6748, Test: 94.8691 [34.28], Avg: -33.0274 (0.460)
Ep: 388, Reward: 156.0999, Test: 88.5936 [60.12], Avg: -32.8693 (0.459)
Ep: 389, Reward: 178.4128, Test: 145.9044 [67.00], Avg: -32.5827 (0.458)
Ep: 390, Reward: 186.8079, Test: 93.7492 [57.25], Avg: -32.4060 (0.457)
Ep: 391, Reward: 178.1411, Test: 101.2474 [63.69], Avg: -32.2276 (0.456)
Ep: 392, Reward: 224.4951, Test: 76.1179 [64.47], Avg: -32.1159 (0.455)
Ep: 393, Reward: 194.6602, Test: 76.5263 [47.73], Avg: -31.9613 (0.454)
Ep: 394, Reward: 154.5533, Test: 120.9381 [40.90], Avg: -31.6778 (0.453)
Ep: 395, Reward: 179.1542, Test: 95.0195 [62.59], Avg: -31.5159 (0.453)
Ep: 396, Reward: 191.0700, Test: 110.4364 [50.02], Avg: -31.2843 (0.452)
Ep: 397, Reward: 163.2984, Test: 78.7726 [46.74], Avg: -31.1252 (0.451)
Ep: 398, Reward: 197.9537, Test: 100.5915 [40.19], Avg: -30.8958 (0.450)
Ep: 399, Reward: 197.8813, Test: 102.8426 [65.08], Avg: -30.7242 (0.449)
Ep: 400, Reward: 188.1480, Test: 110.5548 [46.03], Avg: -30.4867 (0.448)
Ep: 401, Reward: 189.7416, Test: 106.7071 [49.31], Avg: -30.2681 (0.447)
Ep: 402, Reward: 176.5096, Test: 75.1514 [48.52], Avg: -30.1269 (0.446)
Ep: 403, Reward: 160.9568, Test: 83.4590 [44.65], Avg: -29.9562 (0.445)
Ep: 404, Reward: 201.2352, Test: 115.2282 [38.66], Avg: -29.6932 (0.444)
Ep: 405, Reward: 239.6885, Test: 89.6684 [54.92], Avg: -29.5345 (0.444)
Ep: 406, Reward: 157.1685, Test: 123.4043 [49.80], Avg: -29.2811 (0.443)
Ep: 407, Reward: 181.7693, Test: 119.2275 [66.37], Avg: -29.0797 (0.442)
Ep: 408, Reward: 230.6832, Test: 122.2977 [60.93], Avg: -28.8586 (0.441)
Ep: 409, Reward: 188.9131, Test: 91.6641 [61.40], Avg: -28.7144 (0.440)
Ep: 410, Reward: 138.5628, Test: 96.5831 [59.85], Avg: -28.5552 (0.439)
Ep: 411, Reward: 198.7160, Test: 101.6312 [36.68], Avg: -28.3282 (0.438)
Ep: 412, Reward: 190.3591, Test: 109.3397 [46.18], Avg: -28.1067 (0.437)
Ep: 413, Reward: 164.4620, Test: 82.8548 [54.10], Avg: -27.9694 (0.437)
Ep: 414, Reward: 204.6384, Test: 116.2495 [47.23], Avg: -27.7356 (0.436)
Ep: 415, Reward: 198.8192, Test: 106.4633 [56.97], Avg: -27.5500 (0.435)
Ep: 416, Reward: 174.3226, Test: 123.0906 [70.43], Avg: -27.3577 (0.434)
Ep: 417, Reward: 210.7584, Test: 88.6853 [54.98], Avg: -27.2116 (0.433)
Ep: 418, Reward: 195.1474, Test: 128.9182 [41.95], Avg: -26.9391 (0.432)
Ep: 419, Reward: 160.9135, Test: 123.1640 [65.02], Avg: -26.7365 (0.431)
Ep: 420, Reward: 198.6586, Test: 118.9582 [41.88], Avg: -26.4899 (0.430)
Ep: 421, Reward: 177.7138, Test: 101.0542 [64.37], Avg: -26.3402 (0.430)
Ep: 422, Reward: 192.1410, Test: 89.0977 [24.76], Avg: -26.1258 (0.429)
Ep: 423, Reward: 172.1897, Test: 149.9276 [56.04], Avg: -25.8428 (0.428)
Ep: 424, Reward: 228.1329, Test: 109.1386 [36.69], Avg: -25.6115 (0.427)
Ep: 425, Reward: 175.5288, Test: 124.8779 [34.20], Avg: -25.3385 (0.426)
Ep: 426, Reward: 188.5262, Test: 110.9441 [50.54], Avg: -25.1377 (0.425)
Ep: 427, Reward: 224.4617, Test: 109.3267 [44.20], Avg: -24.9268 (0.424)
Ep: 428, Reward: 160.7024, Test: 121.9836 [38.96], Avg: -24.6752 (0.424)
Ep: 429, Reward: 202.9834, Test: 123.2592 [50.00], Avg: -24.4475 (0.423)
Ep: 430, Reward: 204.0491, Test: 98.3462 [52.66], Avg: -24.2847 (0.422)
Ep: 431, Reward: 233.1664, Test: 163.8197 [55.22], Avg: -23.9771 (0.421)
Ep: 432, Reward: 184.4001, Test: 133.0474 [53.17], Avg: -23.7373 (0.420)
Ep: 433, Reward: 166.5283, Test: 107.0310 [70.24], Avg: -23.5978 (0.419)
Ep: 434, Reward: 204.6303, Test: 96.8493 [44.80], Avg: -23.4239 (0.419)
Ep: 435, Reward: 186.7809, Test: 133.8256 [83.84], Avg: -23.2555 (0.418)
Ep: 436, Reward: 218.1931, Test: 139.1499 [52.74], Avg: -23.0046 (0.417)
Ep: 437, Reward: 205.1172, Test: 117.7353 [60.46], Avg: -22.8213 (0.416)
Ep: 438, Reward: 225.0243, Test: 157.7569 [76.20], Avg: -22.5835 (0.415)
Ep: 439, Reward: 201.6202, Test: 134.7548 [34.24], Avg: -22.3038 (0.414)
Ep: 440, Reward: 211.1875, Test: 144.6204 [42.56], Avg: -22.0218 (0.414)
Ep: 441, Reward: 229.7935, Test: 141.5333 [67.54], Avg: -21.8045 (0.413)
Ep: 442, Reward: 183.3857, Test: 146.8045 [33.53], Avg: -21.4996 (0.412)
Ep: 443, Reward: 185.2366, Test: 129.3055 [57.17], Avg: -21.2887 (0.411)
Ep: 444, Reward: 185.1235, Test: 102.9284 [63.00], Avg: -21.1512 (0.410)
Ep: 445, Reward: 202.1867, Test: 153.1631 [68.78], Avg: -20.9145 (0.409)
Ep: 446, Reward: 184.2090, Test: 111.3712 [59.63], Avg: -20.7520 (0.409)
Ep: 447, Reward: 209.4077, Test: 134.5404 [102.13], Avg: -20.6333 (0.408)
Ep: 448, Reward: 179.4402, Test: 144.1006 [62.30], Avg: -20.4052 (0.407)
Ep: 449, Reward: 189.7791, Test: 141.2111 [60.42], Avg: -20.1803 (0.406)
Ep: 450, Reward: 209.9551, Test: 118.3808 [43.68], Avg: -19.9699 (0.405)
Ep: 451, Reward: 195.5499, Test: 184.6640 [55.23], Avg: -19.6394 (0.405)
Ep: 452, Reward: 235.7316, Test: 124.2619 [42.22], Avg: -19.4149 (0.404)
Ep: 453, Reward: 199.9306, Test: 122.3472 [39.27], Avg: -19.1892 (0.403)
Ep: 454, Reward: 197.5472, Test: 139.2133 [73.19], Avg: -19.0019 (0.402)
Ep: 455, Reward: 236.3504, Test: 141.8597 [60.17], Avg: -18.7811 (0.401)
Ep: 456, Reward: 229.4326, Test: 130.5017 [31.87], Avg: -18.5242 (0.401)
Ep: 457, Reward: 218.4284, Test: 134.5260 [84.28], Avg: -18.3740 (0.400)
Ep: 458, Reward: 205.9147, Test: 110.3903 [33.75], Avg: -18.1670 (0.399)
Ep: 459, Reward: 205.3089, Test: 121.0288 [37.99], Avg: -17.9470 (0.398)
Ep: 460, Reward: 194.7976, Test: 104.8045 [63.56], Avg: -17.8186 (0.397)
Ep: 461, Reward: 211.6805, Test: 121.2066 [62.67], Avg: -17.6533 (0.397)
Ep: 462, Reward: 197.3924, Test: 123.5425 [53.76], Avg: -17.4645 (0.396)
Ep: 463, Reward: 182.1230, Test: 118.1004 [49.11], Avg: -17.2782 (0.395)
Ep: 464, Reward: 201.0443, Test: 109.8024 [77.56], Avg: -17.1717 (0.394)
Ep: 465, Reward: 164.2166, Test: 118.2008 [54.87], Avg: -16.9989 (0.393)
Ep: 466, Reward: 180.3939, Test: 151.5400 [90.20], Avg: -16.8312 (0.393)
Ep: 467, Reward: 191.5309, Test: 158.6754 [42.95], Avg: -16.5479 (0.392)
Ep: 468, Reward: 184.4542, Test: 120.3061 [71.25], Avg: -16.4080 (0.391)
Ep: 469, Reward: 181.9612, Test: 114.8631 [52.74], Avg: -16.2409 (0.390)
Ep: 470, Reward: 202.5744, Test: 107.3320 [53.76], Avg: -16.0927 (0.389)
Ep: 471, Reward: 205.7722, Test: 132.0492 [51.91], Avg: -15.8888 (0.389)
Ep: 472, Reward: 226.0285, Test: 114.6087 [51.67], Avg: -15.7222 (0.388)
Ep: 473, Reward: 255.3023, Test: 111.1841 [47.04], Avg: -15.5537 (0.387)
Ep: 474, Reward: 136.9993, Test: 107.2431 [46.85], Avg: -15.3938 (0.386)
Ep: 475, Reward: 194.3934, Test: 137.6899 [64.48], Avg: -15.2076 (0.386)
Ep: 476, Reward: 172.3538, Test: 132.3345 [33.87], Avg: -14.9693 (0.385)
Ep: 477, Reward: 193.6006, Test: 130.6867 [50.74], Avg: -14.7708 (0.384)
Ep: 478, Reward: 210.9355, Test: 127.1348 [58.81], Avg: -14.5973 (0.383)
Ep: 479, Reward: 188.7511, Test: 156.2397 [61.12], Avg: -14.3687 (0.383)
Ep: 480, Reward: 243.6621, Test: 112.4931 [50.84], Avg: -14.2106 (0.382)
Ep: 481, Reward: 197.9137, Test: 141.2643 [49.76], Avg: -13.9913 (0.381)
Ep: 482, Reward: 205.8993, Test: 142.6023 [86.00], Avg: -13.8452 (0.380)
Ep: 483, Reward: 230.6661, Test: 131.4047 [59.06], Avg: -13.6671 (0.379)
Ep: 484, Reward: 212.8450, Test: 116.2680 [36.21], Avg: -13.4739 (0.379)
Ep: 485, Reward: 193.8915, Test: 165.3686 [53.23], Avg: -13.2154 (0.378)
Ep: 486, Reward: 201.0534, Test: 128.2285 [38.30], Avg: -13.0036 (0.377)
Ep: 487, Reward: 179.4601, Test: 136.9089 [52.09], Avg: -12.8032 (0.376)
Ep: 488, Reward: 213.7903, Test: 124.5602 [63.54], Avg: -12.6522 (0.376)
Ep: 489, Reward: 215.2721, Test: 170.5041 [53.53], Avg: -12.3876 (0.375)
Ep: 490, Reward: 185.9945, Test: 129.4406 [50.23], Avg: -12.2011 (0.374)
Ep: 491, Reward: 224.6840, Test: 123.7124 [51.07], Avg: -12.0286 (0.373)
Ep: 492, Reward: 229.0683, Test: 151.5324 [96.93], Avg: -11.8935 (0.373)
Ep: 493, Reward: 228.2535, Test: 176.3584 [75.05], Avg: -11.6643 (0.372)
Ep: 494, Reward: 224.7065, Test: 166.7394 [57.47], Avg: -11.4200 (0.371)
Ep: 495, Reward: 219.6808, Test: 164.3167 [41.34], Avg: -11.1490 (0.370)
Ep: 496, Reward: 258.1146, Test: 130.0742 [51.75], Avg: -10.9690 (0.370)
Ep: 497, Reward: 225.5154, Test: 207.0924 [62.17], Avg: -10.6560 (0.369)
Ep: 498, Reward: 235.4532, Test: 150.2032 [50.82], Avg: -10.4355 (0.368)
Ep: 499, Reward: 196.2774, Test: 157.1594 [74.65], Avg: -10.2496 (0.368)
