Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.100                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.025				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(PPO_EPOCHS):
				for i in range(0, len(self.replay_buffer), BATCH_SIZE):
					state, action, log_prob, target, advantage = self.replay_buffer.index(BATCH_SIZE, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -29.4542, Test: -44.6639 [5.21], Avg: -49.8697 (0.997)
Ep: 1, Reward: -48.1095, Test: -47.4184 [11.88], Avg: -54.5827 (0.994)
Ep: 2, Reward: -53.4326, Test: -18.8887 [22.44], Avg: -50.1635 (0.991)
Ep: 3, Reward: -55.5303, Test: -24.5538 [22.44], Avg: -49.3714 (0.988)
Ep: 4, Reward: -30.3999, Test: -24.9205 [22.60], Avg: -49.0016 (0.985)
Ep: 5, Reward: 24.4420, Test: 78.8874 [51.00], Avg: -36.1872 (0.982)
Ep: 6, Reward: 167.5116, Test: 239.8503 [48.98], Avg: -3.7508 (0.979)
Ep: 7, Reward: 279.1526, Test: 511.7379 [203.52], Avg: 35.2458 (0.976)
Ep: 8, Reward: 455.2736, Test: 596.0597 [206.08], Avg: 74.6605 (0.973)
Ep: 9, Reward: 580.9971, Test: 525.7493 [222.77], Avg: 97.4921 (0.970)
Ep: 10, Reward: 583.1265, Test: 740.7944 [146.54], Avg: 142.6526 (0.967)
Ep: 11, Reward: 676.6465, Test: 339.6629 [161.79], Avg: 145.5880 (0.965)
Ep: 12, Reward: 387.5609, Test: 441.2528 [213.39], Avg: 151.9165 (0.962)
Ep: 13, Reward: 355.3822, Test: 301.7535 [171.54], Avg: 150.3665 (0.959)
Ep: 14, Reward: 419.5836, Test: 430.2931 [199.35], Avg: 155.7380 (0.956)
Ep: 15, Reward: 559.0612, Test: 516.1684 [197.52], Avg: 165.9196 (0.953)
Ep: 16, Reward: 445.0225, Test: 407.2307 [192.32], Avg: 168.8014 (0.950)
Ep: 17, Reward: 374.6138, Test: 478.1703 [178.13], Avg: 176.0926 (0.947)
Ep: 18, Reward: 395.6687, Test: 321.3831 [203.34], Avg: 173.0372 (0.945)
Ep: 19, Reward: 428.9346, Test: 574.9517 [132.09], Avg: 186.5283 (0.942)
Ep: 20, Reward: 419.1631, Test: 640.0080 [237.06], Avg: 196.8341 (0.939)
Ep: 21, Reward: 555.6690, Test: 478.6065 [163.15], Avg: 202.2260 (0.936)
Ep: 22, Reward: 527.3584, Test: 502.0428 [181.96], Avg: 207.3500 (0.933)
Ep: 23, Reward: 441.9391, Test: 508.1544 [172.83], Avg: 212.6824 (0.930)
Ep: 24, Reward: 429.7271, Test: 463.7020 [188.05], Avg: 215.2011 (0.928)
Ep: 25, Reward: 528.6569, Test: 582.2003 [190.28], Avg: 221.9978 (0.925)
Ep: 26, Reward: 593.0713, Test: 560.7188 [163.36], Avg: 228.4926 (0.922)
Ep: 27, Reward: 681.5205, Test: 642.5458 [140.11], Avg: 238.2762 (0.919)
Ep: 28, Reward: 750.6318, Test: 724.5145 [181.12], Avg: 248.7974 (0.917)
Ep: 29, Reward: 586.8298, Test: 664.9066 [197.85], Avg: 256.0727 (0.914)
Ep: 30, Reward: 651.2338, Test: 741.0237 [145.38], Avg: 267.0266 (0.911)
Ep: 31, Reward: 681.9235, Test: 664.4796 [152.65], Avg: 274.6766 (0.908)
Ep: 32, Reward: 667.4638, Test: 726.2263 [102.31], Avg: 285.2595 (0.906)
Ep: 33, Reward: 696.6830, Test: 749.6015 [114.77], Avg: 295.5409 (0.903)
Ep: 34, Reward: 660.7140, Test: 753.8542 [132.63], Avg: 304.8462 (0.900)
Ep: 35, Reward: 622.3829, Test: 735.5490 [127.00], Avg: 313.2824 (0.897)
Ep: 36, Reward: 739.7786, Test: 642.9404 [224.53], Avg: 316.1238 (0.895)
Ep: 37, Reward: 827.2783, Test: 660.9804 [251.81], Avg: 318.5725 (0.892)
Ep: 38, Reward: 724.0698, Test: 689.0675 [169.25], Avg: 323.7326 (0.889)
Ep: 39, Reward: 816.4851, Test: 788.9986 [135.79], Avg: 331.9694 (0.887)
Ep: 40, Reward: 835.8334, Test: 824.4281 [109.58], Avg: 341.3080 (0.884)
Ep: 41, Reward: 785.8922, Test: 729.7466 [160.86], Avg: 346.7264 (0.881)
Ep: 42, Reward: 591.4163, Test: 670.5685 [237.61], Avg: 348.7319 (0.879)
Ep: 43, Reward: 737.8861, Test: 677.1610 [151.88], Avg: 352.7444 (0.876)
Ep: 44, Reward: 759.4176, Test: 733.8636 [191.72], Avg: 356.9534 (0.874)
Ep: 45, Reward: 791.7538, Test: 775.5491 [127.71], Avg: 363.2770 (0.871)
Ep: 46, Reward: 789.3831, Test: 842.9995 [91.91], Avg: 371.5284 (0.868)
Ep: 47, Reward: 801.6855, Test: 782.0329 [93.21], Avg: 378.1387 (0.866)
Ep: 48, Reward: 842.1423, Test: 732.5269 [156.19], Avg: 382.1836 (0.863)
Ep: 49, Reward: 826.2522, Test: 728.7172 [178.60], Avg: 385.5423 (0.861)
Ep: 50, Reward: 865.5175, Test: 847.5949 [63.82], Avg: 393.3509 (0.858)
Ep: 51, Reward: 831.7235, Test: 788.8140 [122.20], Avg: 398.6059 (0.855)
Ep: 52, Reward: 910.9804, Test: 848.8381 [95.06], Avg: 405.3074 (0.853)
Ep: 53, Reward: 876.3716, Test: 804.0624 [149.28], Avg: 409.9272 (0.850)
Ep: 54, Reward: 927.1676, Test: 834.0994 [63.19], Avg: 416.4906 (0.848)
Ep: 55, Reward: 882.6859, Test: 754.6507 [191.06], Avg: 419.1174 (0.845)
Ep: 56, Reward: 846.3255, Test: 825.3472 [132.35], Avg: 423.9222 (0.843)
Ep: 57, Reward: 861.6229, Test: 802.1438 [169.50], Avg: 427.5208 (0.840)
Ep: 58, Reward: 880.1419, Test: 823.4211 [152.96], Avg: 431.6385 (0.838)
Ep: 59, Reward: 889.5980, Test: 818.6408 [98.52], Avg: 436.4465 (0.835)
Ep: 60, Reward: 842.6085, Test: 830.9382 [84.72], Avg: 441.5248 (0.833)
Ep: 61, Reward: 882.6054, Test: 842.6234 [122.03], Avg: 446.0259 (0.830)
Ep: 62, Reward: 814.5588, Test: 840.8203 [68.96], Avg: 451.1979 (0.828)
Ep: 63, Reward: 733.9879, Test: 761.9999 [139.96], Avg: 453.8673 (0.825)
Ep: 64, Reward: 838.2138, Test: 780.2515 [115.27], Avg: 457.1152 (0.823)
Ep: 65, Reward: 800.9959, Test: 842.6707 [72.25], Avg: 461.8622 (0.820)
Ep: 66, Reward: 796.4383, Test: 813.0633 [39.39], Avg: 466.5160 (0.818)
Ep: 67, Reward: 756.3565, Test: 681.0306 [214.08], Avg: 466.5224 (0.815)
Ep: 68, Reward: 811.8919, Test: 741.5181 [203.99], Avg: 467.5514 (0.813)
Ep: 69, Reward: 840.4411, Test: 832.7119 [64.80], Avg: 471.8422 (0.810)
Ep: 70, Reward: 797.1062, Test: 806.9128 [98.49], Avg: 475.1743 (0.808)
Ep: 71, Reward: 764.0195, Test: 831.4605 [55.81], Avg: 479.3476 (0.805)
Ep: 72, Reward: 804.8843, Test: 762.8031 [151.33], Avg: 481.1575 (0.803)
Ep: 73, Reward: 822.8359, Test: 783.5075 [116.04], Avg: 483.6753 (0.801)
Ep: 74, Reward: 848.5431, Test: 807.8062 [119.10], Avg: 486.4090 (0.798)
Ep: 75, Reward: 824.0389, Test: 840.9242 [58.86], Avg: 490.2993 (0.796)
Ep: 76, Reward: 815.4841, Test: 794.6118 [175.23], Avg: 491.9756 (0.793)
Ep: 77, Reward: 862.6393, Test: 738.4181 [186.92], Avg: 492.7388 (0.791)
Ep: 78, Reward: 814.3248, Test: 810.6101 [134.38], Avg: 495.0615 (0.789)
Ep: 79, Reward: 810.2369, Test: 793.0448 [103.25], Avg: 497.4957 (0.786)
Ep: 80, Reward: 798.4070, Test: 836.6535 [41.73], Avg: 501.1677 (0.784)
Ep: 81, Reward: 826.7091, Test: 839.7949 [25.21], Avg: 504.9898 (0.782)
Ep: 82, Reward: 843.5567, Test: 835.5574 [70.07], Avg: 508.1284 (0.779)
Ep: 83, Reward: 869.2502, Test: 820.2725 [96.18], Avg: 510.6994 (0.777)
Ep: 84, Reward: 837.5752, Test: 850.7531 [57.54], Avg: 514.0231 (0.775)
Ep: 85, Reward: 824.1630, Test: 842.1734 [38.41], Avg: 517.3922 (0.772)
Ep: 86, Reward: 848.1877, Test: 798.2814 [147.80], Avg: 518.9219 (0.770)
Ep: 87, Reward: 844.0581, Test: 777.7425 [174.07], Avg: 519.8850 (0.768)
Ep: 88, Reward: 823.1927, Test: 838.7170 [81.02], Avg: 522.5570 (0.765)
Ep: 89, Reward: 797.5026, Test: 791.4310 [96.72], Avg: 524.4698 (0.763)
Ep: 90, Reward: 772.1834, Test: 818.5412 [146.76], Avg: 526.0886 (0.761)
Ep: 91, Reward: 798.0548, Test: 774.2609 [94.19], Avg: 527.7624 (0.758)
Ep: 92, Reward: 816.6316, Test: 844.9903 [86.15], Avg: 530.2471 (0.756)
Ep: 93, Reward: 753.3973, Test: 810.1558 [173.20], Avg: 531.3823 (0.754)
Ep: 94, Reward: 864.4720, Test: 756.0498 [131.91], Avg: 532.3587 (0.752)
Ep: 95, Reward: 830.3389, Test: 837.1637 [43.18], Avg: 535.0840 (0.749)
Ep: 96, Reward: 842.5526, Test: 764.7528 [146.54], Avg: 535.9410 (0.747)
Ep: 97, Reward: 885.9832, Test: 851.4242 [78.30], Avg: 538.3612 (0.745)
Ep: 98, Reward: 871.0107, Test: 809.6070 [98.31], Avg: 540.1080 (0.743)
Ep: 99, Reward: 807.3222, Test: 795.6687 [111.26], Avg: 541.5511 (0.740)
Ep: 100, Reward: 841.0410, Test: 844.2354 [68.44], Avg: 543.8704 (0.738)
Ep: 101, Reward: 852.0994, Test: 829.2369 [124.70], Avg: 545.4455 (0.736)
Ep: 102, Reward: 862.0558, Test: 863.3250 [50.66], Avg: 548.0399 (0.734)
Ep: 103, Reward: 814.4555, Test: 848.4288 [58.47], Avg: 550.3660 (0.732)
Ep: 104, Reward: 829.3745, Test: 884.4793 [17.68], Avg: 553.3797 (0.729)
Ep: 105, Reward: 852.2363, Test: 852.6650 [74.89], Avg: 555.4967 (0.727)
Ep: 106, Reward: 897.0742, Test: 820.5480 [123.24], Avg: 556.8220 (0.725)
Ep: 107, Reward: 878.8955, Test: 839.1520 [76.84], Avg: 558.7247 (0.723)
Ep: 108, Reward: 913.4041, Test: 821.7472 [95.20], Avg: 560.2643 (0.721)
Ep: 109, Reward: 929.6903, Test: 795.3722 [180.01], Avg: 560.7652 (0.719)
Ep: 110, Reward: 925.1357, Test: 857.3600 [67.30], Avg: 562.8310 (0.716)
Ep: 111, Reward: 857.7556, Test: 848.8561 [98.45], Avg: 564.5057 (0.714)
Ep: 112, Reward: 848.7733, Test: 883.2317 [21.42], Avg: 567.1368 (0.712)
Ep: 113, Reward: 904.6770, Test: 864.1132 [69.13], Avg: 569.1354 (0.710)
Ep: 114, Reward: 853.3568, Test: 817.3171 [187.86], Avg: 569.6599 (0.708)
Ep: 115, Reward: 889.3525, Test: 815.3577 [135.08], Avg: 570.6136 (0.706)
Ep: 116, Reward: 906.2312, Test: 889.2522 [22.77], Avg: 573.1424 (0.704)
Ep: 117, Reward: 904.3137, Test: 846.7544 [78.31], Avg: 574.7974 (0.702)
Ep: 118, Reward: 831.4537, Test: 811.7778 [166.35], Avg: 575.3910 (0.699)
Ep: 119, Reward: 932.0650, Test: 819.5577 [118.53], Avg: 576.4379 (0.697)
Ep: 120, Reward: 731.6545, Test: 849.2819 [49.57], Avg: 578.2831 (0.695)
Ep: 121, Reward: 909.9680, Test: 744.9069 [168.98], Avg: 578.2638 (0.693)
Ep: 122, Reward: 884.6994, Test: 786.8311 [122.17], Avg: 578.9663 (0.691)
Ep: 123, Reward: 932.5810, Test: 827.3837 [172.95], Avg: 579.5749 (0.689)
Ep: 124, Reward: 814.8063, Test: 827.5018 [123.04], Avg: 580.5740 (0.687)
Ep: 125, Reward: 870.6237, Test: 883.0548 [21.17], Avg: 582.8066 (0.685)
Ep: 126, Reward: 809.2135, Test: 817.1758 [145.09], Avg: 583.5096 (0.683)
Ep: 127, Reward: 836.6394, Test: 731.4545 [173.17], Avg: 583.3126 (0.681)
Ep: 128, Reward: 903.9554, Test: 830.3260 [111.18], Avg: 584.3656 (0.679)
Ep: 129, Reward: 851.6841, Test: 836.8183 [85.54], Avg: 585.6495 (0.677)
Ep: 130, Reward: 904.7695, Test: 880.8043 [63.00], Avg: 587.4217 (0.675)
Ep: 131, Reward: 905.2604, Test: 793.1798 [149.94], Avg: 587.8446 (0.673)
Ep: 132, Reward: 787.6515, Test: 754.7549 [192.87], Avg: 587.6494 (0.671)
Ep: 133, Reward: 860.1860, Test: 863.7809 [63.09], Avg: 589.2393 (0.669)
Ep: 134, Reward: 800.0032, Test: 781.6836 [156.48], Avg: 589.5057 (0.667)
Ep: 135, Reward: 872.0601, Test: 807.0103 [100.97], Avg: 590.3626 (0.665)
Ep: 136, Reward: 790.0747, Test: 776.3259 [121.40], Avg: 590.8339 (0.663)
Ep: 137, Reward: 808.9765, Test: 825.1093 [145.39], Avg: 591.4779 (0.661)
Ep: 138, Reward: 820.2575, Test: 728.3655 [120.54], Avg: 591.5955 (0.659)
Ep: 139, Reward: 832.6127, Test: 759.5608 [188.50], Avg: 591.4488 (0.657)
Ep: 140, Reward: 837.6677, Test: 808.8443 [88.66], Avg: 592.3619 (0.655)
Ep: 141, Reward: 801.5382, Test: 832.3486 [82.82], Avg: 593.4687 (0.653)
Ep: 142, Reward: 837.7212, Test: 734.0852 [165.07], Avg: 593.2977 (0.651)
Ep: 143, Reward: 847.0844, Test: 710.7027 [162.20], Avg: 592.9866 (0.649)
Ep: 144, Reward: 848.7616, Test: 859.1375 [103.34], Avg: 594.1094 (0.647)
Ep: 145, Reward: 785.2739, Test: 785.7607 [140.39], Avg: 594.4605 (0.645)
Ep: 146, Reward: 724.8050, Test: 898.0552 [22.39], Avg: 596.3734 (0.643)
Ep: 147, Reward: 829.1482, Test: 884.4123 [29.27], Avg: 598.1219 (0.641)
Ep: 148, Reward: 777.9671, Test: 643.1866 [218.30], Avg: 596.9592 (0.639)
Ep: 149, Reward: 839.7586, Test: 870.4540 [67.48], Avg: 598.3326 (0.637)
Ep: 150, Reward: 743.0251, Test: 762.7612 [151.52], Avg: 598.4181 (0.635)
Ep: 151, Reward: 851.1356, Test: 866.7358 [44.36], Avg: 599.8915 (0.633)
Ep: 152, Reward: 804.6747, Test: 856.7717 [57.17], Avg: 601.1968 (0.631)
Ep: 153, Reward: 854.1126, Test: 877.9498 [44.65], Avg: 602.7040 (0.630)
Ep: 154, Reward: 844.1602, Test: 803.8297 [104.52], Avg: 603.3272 (0.628)
Ep: 155, Reward: 848.9242, Test: 746.9158 [159.09], Avg: 603.2278 (0.626)
Ep: 156, Reward: 817.7869, Test: 784.2133 [117.40], Avg: 603.6329 (0.624)
Ep: 157, Reward: 797.9700, Test: 815.6413 [139.05], Avg: 604.0946 (0.622)
Ep: 158, Reward: 799.6039, Test: 822.8878 [131.66], Avg: 604.6426 (0.620)
Ep: 159, Reward: 834.6701, Test: 741.4658 [133.97], Avg: 604.6604 (0.618)
Ep: 160, Reward: 826.6984, Test: 757.7389 [184.96], Avg: 604.4624 (0.616)
Ep: 161, Reward: 859.0768, Test: 826.7511 [126.28], Avg: 605.0551 (0.615)
Ep: 162, Reward: 875.9691, Test: 833.7854 [137.97], Avg: 605.6119 (0.613)
Ep: 163, Reward: 899.0379, Test: 833.9080 [139.09], Avg: 606.1559 (0.611)
Ep: 164, Reward: 828.3704, Test: 853.5534 [84.03], Avg: 607.1460 (0.609)
Ep: 165, Reward: 842.8293, Test: 786.2650 [215.82], Avg: 606.9249 (0.607)
Ep: 166, Reward: 850.3627, Test: 773.3556 [215.12], Avg: 606.6333 (0.605)
Ep: 167, Reward: 910.0786, Test: 842.1155 [116.61], Avg: 607.3408 (0.604)
Ep: 168, Reward: 812.3953, Test: 867.5070 [81.89], Avg: 608.3957 (0.602)
Ep: 169, Reward: 909.3066, Test: 898.3577 [24.60], Avg: 609.9567 (0.600)
Ep: 170, Reward: 839.6267, Test: 883.9586 [24.07], Avg: 611.4183 (0.598)
Ep: 171, Reward: 896.9418, Test: 783.7930 [156.79], Avg: 611.5089 (0.596)
Ep: 172, Reward: 807.0507, Test: 862.7009 [58.50], Avg: 612.6227 (0.595)
Ep: 173, Reward: 838.8415, Test: 860.4832 [73.53], Avg: 613.6246 (0.593)
Ep: 174, Reward: 815.9148, Test: 818.3136 [184.56], Avg: 613.7396 (0.591)
Ep: 175, Reward: 877.9199, Test: 796.2274 [124.76], Avg: 614.0676 (0.589)
Ep: 176, Reward: 882.9081, Test: 802.6336 [166.03], Avg: 614.1949 (0.588)
Ep: 177, Reward: 861.0185, Test: 746.9649 [191.31], Avg: 613.8661 (0.586)
Ep: 178, Reward: 926.2688, Test: 836.7301 [91.31], Avg: 614.6010 (0.584)
Ep: 179, Reward: 863.2922, Test: 802.7880 [203.08], Avg: 614.5183 (0.582)
Ep: 180, Reward: 927.2867, Test: 861.2927 [95.00], Avg: 615.3568 (0.581)
Ep: 181, Reward: 846.1787, Test: 831.1104 [121.25], Avg: 615.8760 (0.579)
Ep: 182, Reward: 797.9185, Test: 833.8363 [99.27], Avg: 616.5246 (0.577)
Ep: 183, Reward: 821.2018, Test: 876.1553 [30.15], Avg: 617.7718 (0.575)
Ep: 184, Reward: 849.5024, Test: 832.2738 [126.03], Avg: 618.2500 (0.574)
Ep: 185, Reward: 879.3386, Test: 795.0682 [205.33], Avg: 618.0968 (0.572)
Ep: 186, Reward: 855.8593, Test: 780.6570 [175.32], Avg: 618.0285 (0.570)
Ep: 187, Reward: 881.9022, Test: 878.5703 [70.00], Avg: 619.0420 (0.568)
Ep: 188, Reward: 877.4907, Test: 868.4090 [85.18], Avg: 619.9108 (0.567)
Ep: 189, Reward: 855.4230, Test: 901.1088 [18.46], Avg: 621.2936 (0.565)
Ep: 190, Reward: 829.3132, Test: 792.9650 [142.18], Avg: 621.4480 (0.563)
Ep: 191, Reward: 876.3935, Test: 814.2990 [150.74], Avg: 621.6673 (0.562)
Ep: 192, Reward: 875.4520, Test: 775.5743 [149.21], Avg: 621.6917 (0.560)
Ep: 193, Reward: 884.9111, Test: 800.3972 [133.19], Avg: 621.9263 (0.558)
Ep: 194, Reward: 780.0206, Test: 782.9772 [130.88], Avg: 622.0810 (0.557)
Ep: 195, Reward: 884.9726, Test: 804.4235 [154.57], Avg: 622.2227 (0.555)
Ep: 196, Reward: 914.4913, Test: 736.1861 [188.42], Avg: 621.8447 (0.553)
Ep: 197, Reward: 781.2528, Test: 795.5759 [166.43], Avg: 621.8816 (0.552)
Ep: 198, Reward: 794.7359, Test: 823.6948 [133.00], Avg: 622.2274 (0.550)
Ep: 199, Reward: 945.4153, Test: 828.9087 [116.78], Avg: 622.6769 (0.548)
Ep: 200, Reward: 908.4895, Test: 826.1305 [140.22], Avg: 622.9915 (0.547)
Ep: 201, Reward: 784.7768, Test: 811.5933 [120.20], Avg: 623.3302 (0.545)
Ep: 202, Reward: 880.6140, Test: 823.0489 [132.28], Avg: 623.6624 (0.543)
Ep: 203, Reward: 829.4465, Test: 735.9551 [203.46], Avg: 623.2155 (0.542)
Ep: 204, Reward: 870.5078, Test: 818.4850 [152.67], Avg: 623.4233 (0.540)
Ep: 205, Reward: 824.9770, Test: 795.3935 [158.60], Avg: 623.4882 (0.539)
Ep: 206, Reward: 947.6363, Test: 875.0977 [87.42], Avg: 624.2814 (0.537)
Ep: 207, Reward: 848.0114, Test: 806.0711 [145.18], Avg: 624.4574 (0.535)
Ep: 208, Reward: 776.0919, Test: 742.4790 [177.19], Avg: 624.1743 (0.534)
Ep: 209, Reward: 903.4297, Test: 761.0333 [198.35], Avg: 623.8815 (0.532)
Ep: 210, Reward: 816.2740, Test: 771.7340 [141.91], Avg: 623.9097 (0.530)
Ep: 211, Reward: 813.2916, Test: 746.1498 [125.32], Avg: 623.8951 (0.529)
Ep: 212, Reward: 913.8551, Test: 800.4232 [97.30], Avg: 624.2671 (0.527)
Ep: 213, Reward: 875.4680, Test: 779.5292 [137.31], Avg: 624.3510 (0.526)
Ep: 214, Reward: 848.4586, Test: 829.4077 [138.38], Avg: 624.6612 (0.524)
Ep: 215, Reward: 801.2402, Test: 814.0628 [139.37], Avg: 624.8928 (0.523)
Ep: 216, Reward: 852.9234, Test: 809.8856 [149.97], Avg: 625.0542 (0.521)
Ep: 217, Reward: 920.7538, Test: 785.6424 [178.72], Avg: 624.9710 (0.519)
Ep: 218, Reward: 828.0232, Test: 761.7879 [212.85], Avg: 624.6239 (0.518)
Ep: 219, Reward: 867.0541, Test: 716.6827 [174.81], Avg: 624.2477 (0.516)
Ep: 220, Reward: 829.8594, Test: 802.6886 [188.30], Avg: 624.2031 (0.515)
Ep: 221, Reward: 984.3137, Test: 878.4131 [80.07], Avg: 624.9875 (0.513)
Ep: 222, Reward: 917.7351, Test: 868.4922 [71.67], Avg: 625.7581 (0.512)
Ep: 223, Reward: 889.9796, Test: 807.8269 [147.87], Avg: 625.9108 (0.510)
Ep: 224, Reward: 884.0204, Test: 828.9748 [125.90], Avg: 626.2537 (0.509)
Ep: 225, Reward: 907.5699, Test: 827.1028 [117.47], Avg: 626.6226 (0.507)
Ep: 226, Reward: 815.9660, Test: 823.5633 [118.63], Avg: 626.9676 (0.506)
Ep: 227, Reward: 765.5435, Test: 705.5573 [174.62], Avg: 626.5464 (0.504)
Ep: 228, Reward: 859.2535, Test: 852.0050 [80.10], Avg: 627.1812 (0.503)
Ep: 229, Reward: 860.3497, Test: 768.8696 [214.56], Avg: 626.8643 (0.501)
Ep: 230, Reward: 860.6354, Test: 784.3696 [182.10], Avg: 626.7578 (0.500)
Ep: 231, Reward: 822.3534, Test: 903.3220 [16.50], Avg: 627.8788 (0.498)
Ep: 232, Reward: 813.8948, Test: 707.5083 [212.36], Avg: 627.3092 (0.497)
Ep: 233, Reward: 865.2702, Test: 824.7792 [118.48], Avg: 627.6467 (0.495)
Ep: 234, Reward: 757.8159, Test: 867.2519 [70.38], Avg: 628.3668 (0.494)
Ep: 235, Reward: 839.7379, Test: 723.5795 [211.54], Avg: 627.8739 (0.492)
Ep: 236, Reward: 748.9392, Test: 726.1953 [198.33], Avg: 627.4519 (0.491)
Ep: 237, Reward: 770.6878, Test: 853.1577 [82.14], Avg: 628.0551 (0.489)
Ep: 238, Reward: 783.6724, Test: 733.6580 [165.74], Avg: 627.8035 (0.488)
Ep: 239, Reward: 704.5364, Test: 768.7625 [120.97], Avg: 627.8868 (0.486)
Ep: 240, Reward: 795.0762, Test: 810.1511 [167.64], Avg: 627.9475 (0.485)
Ep: 241, Reward: 799.4738, Test: 735.0005 [172.82], Avg: 627.6757 (0.483)
Ep: 242, Reward: 698.8518, Test: 717.8832 [132.59], Avg: 627.5013 (0.482)
Ep: 243, Reward: 820.3656, Test: 835.4815 [95.72], Avg: 627.9614 (0.480)
Ep: 244, Reward: 742.5807, Test: 836.7250 [99.30], Avg: 628.4082 (0.479)
Ep: 245, Reward: 803.9549, Test: 720.9734 [179.27], Avg: 628.0557 (0.478)
Ep: 246, Reward: 715.4991, Test: 651.8767 [181.49], Avg: 627.4174 (0.476)
Ep: 247, Reward: 752.9656, Test: 723.0389 [176.18], Avg: 627.0926 (0.475)
Ep: 248, Reward: 696.0668, Test: 808.0112 [151.35], Avg: 627.2113 (0.473)
Ep: 249, Reward: 780.2997, Test: 754.4768 [152.96], Avg: 627.1085 (0.472)
Ep: 250, Reward: 754.4083, Test: 758.5272 [227.42], Avg: 626.7260 (0.470)
Ep: 251, Reward: 787.2103, Test: 773.7567 [191.25], Avg: 626.5505 (0.469)
Ep: 252, Reward: 825.9287, Test: 739.8441 [141.52], Avg: 626.4390 (0.468)
Ep: 253, Reward: 736.7553, Test: 727.5845 [189.09], Avg: 626.0927 (0.466)
Ep: 254, Reward: 758.4958, Test: 658.3507 [189.57], Avg: 625.4758 (0.465)
Ep: 255, Reward: 700.2572, Test: 669.7299 [169.80], Avg: 624.9854 (0.463)
Ep: 256, Reward: 749.1930, Test: 840.1791 [118.01], Avg: 625.3636 (0.462)
Ep: 257, Reward: 707.6553, Test: 707.1012 [217.54], Avg: 624.8372 (0.461)
Ep: 258, Reward: 775.4766, Test: 690.9253 [197.41], Avg: 624.3302 (0.459)
Ep: 259, Reward: 686.0853, Test: 779.1946 [165.14], Avg: 624.2906 (0.458)
Ep: 260, Reward: 819.3921, Test: 693.3803 [177.14], Avg: 623.8766 (0.456)
Ep: 261, Reward: 769.2604, Test: 742.9646 [161.32], Avg: 623.7154 (0.455)
Ep: 262, Reward: 772.6731, Test: 689.8231 [211.98], Avg: 623.1608 (0.454)
Ep: 263, Reward: 765.1876, Test: 768.1490 [131.03], Avg: 623.2137 (0.452)
Ep: 264, Reward: 730.5738, Test: 633.3037 [177.48], Avg: 622.5820 (0.451)
Ep: 265, Reward: 773.7071, Test: 825.1764 [106.49], Avg: 622.9433 (0.450)
Ep: 266, Reward: 727.9903, Test: 783.4551 [164.96], Avg: 622.9266 (0.448)
Ep: 267, Reward: 784.4843, Test: 818.2369 [103.24], Avg: 623.2702 (0.447)
Ep: 268, Reward: 776.2382, Test: 660.6267 [168.95], Avg: 622.7810 (0.446)
Ep: 269, Reward: 783.7773, Test: 732.4329 [154.52], Avg: 622.6148 (0.444)
Ep: 270, Reward: 696.3389, Test: 711.2486 [225.34], Avg: 622.1103 (0.443)
Ep: 271, Reward: 711.4971, Test: 835.5220 [83.65], Avg: 622.5874 (0.442)
Ep: 272, Reward: 779.0143, Test: 746.5201 [151.60], Avg: 622.4861 (0.440)
Ep: 273, Reward: 797.1860, Test: 689.0783 [191.31], Avg: 622.0309 (0.439)
Ep: 274, Reward: 791.0147, Test: 708.7784 [144.35], Avg: 621.8215 (0.438)
Ep: 275, Reward: 766.2629, Test: 723.3878 [209.61], Avg: 621.4300 (0.436)
Ep: 276, Reward: 799.3430, Test: 771.9895 [159.17], Avg: 621.3989 (0.435)
Ep: 277, Reward: 816.3315, Test: 751.4128 [187.52], Avg: 621.1921 (0.434)
Ep: 278, Reward: 822.0667, Test: 790.7146 [146.56], Avg: 621.2744 (0.432)
Ep: 279, Reward: 722.1135, Test: 812.5041 [115.74], Avg: 621.5440 (0.431)
Ep: 280, Reward: 701.9262, Test: 782.5463 [130.23], Avg: 621.6535 (0.430)
Ep: 281, Reward: 763.6055, Test: 741.2491 [173.36], Avg: 621.4629 (0.429)
Ep: 282, Reward: 767.4447, Test: 761.4493 [169.51], Avg: 621.3585 (0.427)
Ep: 283, Reward: 752.3641, Test: 814.2164 [137.54], Avg: 621.5533 (0.426)
Ep: 284, Reward: 854.8538, Test: 777.5927 [217.24], Avg: 621.3386 (0.425)
Ep: 285, Reward: 800.1012, Test: 762.5921 [184.70], Avg: 621.1867 (0.423)
Ep: 286, Reward: 825.9256, Test: 856.7193 [87.88], Avg: 621.7011 (0.422)
Ep: 287, Reward: 746.4475, Test: 855.2585 [116.46], Avg: 622.1077 (0.421)
Ep: 288, Reward: 780.2378, Test: 704.0485 [241.41], Avg: 621.5559 (0.420)
Ep: 289, Reward: 743.4609, Test: 818.5102 [147.29], Avg: 621.7272 (0.418)
Ep: 290, Reward: 822.6639, Test: 770.1845 [170.69], Avg: 621.6508 (0.417)
Ep: 291, Reward: 712.7915, Test: 848.5255 [100.32], Avg: 622.0842 (0.416)
Ep: 292, Reward: 663.3961, Test: 714.0882 [191.33], Avg: 621.7452 (0.415)
Ep: 293, Reward: 766.1335, Test: 747.6442 [143.58], Avg: 621.6850 (0.413)
Ep: 294, Reward: 782.7802, Test: 780.3037 [166.73], Avg: 621.6575 (0.412)
Ep: 295, Reward: 847.3670, Test: 683.4918 [211.37], Avg: 621.1524 (0.411)
Ep: 296, Reward: 844.5579, Test: 673.4316 [152.94], Avg: 620.8134 (0.410)
Ep: 297, Reward: 850.2103, Test: 823.5801 [112.28], Avg: 621.1171 (0.408)
Ep: 298, Reward: 768.2014, Test: 769.1572 [140.53], Avg: 621.1422 (0.407)
Ep: 299, Reward: 807.5199, Test: 871.1425 [75.73], Avg: 621.7231 (0.406)
Ep: 300, Reward: 792.6831, Test: 802.9261 [106.57], Avg: 621.9710 (0.405)
Ep: 301, Reward: 739.9530, Test: 807.1638 [150.81], Avg: 622.0849 (0.404)
Ep: 302, Reward: 655.0205, Test: 636.2363 [173.49], Avg: 621.5590 (0.402)
Ep: 303, Reward: 817.0752, Test: 787.2079 [154.00], Avg: 621.5973 (0.401)
Ep: 304, Reward: 717.3502, Test: 662.3462 [165.55], Avg: 621.1881 (0.400)
Ep: 305, Reward: 798.9730, Test: 670.0874 [196.77], Avg: 620.7049 (0.399)
Ep: 306, Reward: 729.4144, Test: 725.5056 [201.57], Avg: 620.3897 (0.398)
Ep: 307, Reward: 750.3039, Test: 717.0651 [149.33], Avg: 620.2187 (0.396)
Ep: 308, Reward: 701.0531, Test: 741.6799 [185.46], Avg: 620.0116 (0.395)
Ep: 309, Reward: 689.9211, Test: 710.2934 [200.59], Avg: 619.6558 (0.394)
Ep: 310, Reward: 715.1583, Test: 695.0915 [207.82], Avg: 619.2301 (0.393)
Ep: 311, Reward: 805.3717, Test: 691.6580 [179.52], Avg: 618.8869 (0.392)
Ep: 312, Reward: 651.4177, Test: 682.4534 [187.51], Avg: 618.4909 (0.390)
Ep: 313, Reward: 692.5065, Test: 711.5415 [173.65], Avg: 618.2342 (0.389)
Ep: 314, Reward: 714.0852, Test: 737.2678 [135.41], Avg: 618.1822 (0.388)
Ep: 315, Reward: 751.6274, Test: 746.4268 [152.36], Avg: 618.1059 (0.387)
Ep: 316, Reward: 825.6264, Test: 690.2036 [221.86], Avg: 617.6335 (0.386)
Ep: 317, Reward: 784.6028, Test: 662.0065 [200.14], Avg: 617.1436 (0.385)
Ep: 318, Reward: 706.8831, Test: 760.6657 [174.64], Avg: 617.0461 (0.383)
Ep: 319, Reward: 717.9726, Test: 725.3197 [210.61], Avg: 616.7263 (0.382)
Ep: 320, Reward: 674.5067, Test: 687.8027 [168.32], Avg: 616.4234 (0.381)
Ep: 321, Reward: 707.1615, Test: 701.7196 [201.55], Avg: 616.0623 (0.380)
Ep: 322, Reward: 717.1618, Test: 715.0133 [216.43], Avg: 615.6986 (0.379)
Ep: 323, Reward: 753.3169, Test: 640.3697 [189.51], Avg: 615.1899 (0.378)
Ep: 324, Reward: 755.8607, Test: 624.8638 [221.96], Avg: 614.5367 (0.377)
Ep: 325, Reward: 740.9920, Test: 655.1794 [221.93], Avg: 613.9806 (0.376)
Ep: 326, Reward: 733.3483, Test: 753.0196 [121.30], Avg: 614.0348 (0.374)
Ep: 327, Reward: 682.1157, Test: 629.6646 [219.62], Avg: 613.4129 (0.373)
Ep: 328, Reward: 738.1544, Test: 602.0726 [193.35], Avg: 612.7907 (0.372)
Ep: 329, Reward: 720.2641, Test: 679.1856 [177.25], Avg: 612.4548 (0.371)
Ep: 330, Reward: 777.2602, Test: 731.1748 [159.70], Avg: 612.3310 (0.370)
Ep: 331, Reward: 645.2696, Test: 672.6418 [187.01], Avg: 611.9494 (0.369)
Ep: 332, Reward: 748.9121, Test: 781.0341 [131.83], Avg: 612.0612 (0.368)
Ep: 333, Reward: 725.9152, Test: 627.4804 [197.22], Avg: 611.5169 (0.367)
Ep: 334, Reward: 748.5096, Test: 789.7202 [120.01], Avg: 611.6906 (0.365)
Ep: 335, Reward: 698.7547, Test: 779.4399 [100.68], Avg: 611.8902 (0.364)
Ep: 336, Reward: 724.5856, Test: 718.1529 [168.18], Avg: 611.7065 (0.363)
Ep: 337, Reward: 718.6495, Test: 731.3259 [170.23], Avg: 611.5568 (0.362)
Ep: 338, Reward: 695.9905, Test: 653.0152 [201.57], Avg: 611.0845 (0.361)
Ep: 339, Reward: 617.6548, Test: 782.3340 [100.48], Avg: 611.2926 (0.360)
Ep: 340, Reward: 677.7282, Test: 712.2456 [189.31], Avg: 611.0335 (0.359)
Ep: 341, Reward: 654.1118, Test: 662.4015 [226.28], Avg: 610.5220 (0.358)
Ep: 342, Reward: 803.6230, Test: 663.0599 [160.16], Avg: 610.2083 (0.357)
Ep: 343, Reward: 672.9105, Test: 677.7617 [188.37], Avg: 609.8571 (0.356)
Ep: 344, Reward: 682.9742, Test: 761.9064 [154.72], Avg: 609.8493 (0.355)
Ep: 345, Reward: 756.6087, Test: 753.1265 [140.10], Avg: 609.8585 (0.354)
Ep: 346, Reward: 782.5669, Test: 663.0705 [157.16], Avg: 609.5589 (0.353)
Ep: 347, Reward: 827.6658, Test: 721.7475 [220.16], Avg: 609.2487 (0.351)
Ep: 348, Reward: 611.5033, Test: 693.6514 [236.41], Avg: 608.8131 (0.350)
Ep: 349, Reward: 762.3778, Test: 652.7334 [240.10], Avg: 608.2526 (0.349)
Ep: 350, Reward: 792.1457, Test: 690.7128 [153.09], Avg: 608.0514 (0.348)
Ep: 351, Reward: 697.1681, Test: 686.5124 [201.36], Avg: 607.7022 (0.347)
Ep: 352, Reward: 724.8989, Test: 718.5808 [219.00], Avg: 607.3959 (0.346)
Ep: 353, Reward: 783.5553, Test: 780.2449 [122.14], Avg: 607.5392 (0.345)
Ep: 354, Reward: 818.5571, Test: 690.5882 [232.95], Avg: 607.1169 (0.344)
Ep: 355, Reward: 738.0589, Test: 639.1206 [204.19], Avg: 606.6333 (0.343)
Ep: 356, Reward: 788.2551, Test: 653.0956 [175.90], Avg: 606.2707 (0.342)
Ep: 357, Reward: 685.5502, Test: 757.7957 [175.54], Avg: 606.2036 (0.341)
Ep: 358, Reward: 762.1680, Test: 727.9291 [194.69], Avg: 606.0004 (0.340)
Ep: 359, Reward: 712.4206, Test: 747.7228 [194.45], Avg: 605.8539 (0.339)
Ep: 360, Reward: 836.4787, Test: 724.7928 [190.67], Avg: 605.6552 (0.338)
Ep: 361, Reward: 720.0573, Test: 788.0603 [164.66], Avg: 605.7042 (0.337)
Ep: 362, Reward: 734.3280, Test: 711.1042 [221.00], Avg: 605.3857 (0.336)
Ep: 363, Reward: 746.1824, Test: 748.9421 [218.48], Avg: 605.1799 (0.335)
Ep: 364, Reward: 691.6385, Test: 820.5065 [101.89], Avg: 605.4907 (0.334)
Ep: 365, Reward: 672.2086, Test: 793.6278 [119.43], Avg: 605.6784 (0.333)
Ep: 366, Reward: 712.7346, Test: 824.2997 [115.06], Avg: 605.9606 (0.332)
Ep: 367, Reward: 742.0121, Test: 704.4585 [129.01], Avg: 605.8777 (0.331)
Ep: 368, Reward: 732.2087, Test: 657.0966 [211.00], Avg: 605.4446 (0.330)
Ep: 369, Reward: 728.0243, Test: 814.6536 [194.99], Avg: 605.4831 (0.329)
Ep: 370, Reward: 727.6834, Test: 678.3733 [183.73], Avg: 605.1843 (0.328)
Ep: 371, Reward: 803.9762, Test: 649.8011 [197.23], Avg: 604.7741 (0.327)
Ep: 372, Reward: 735.9242, Test: 699.1086 [201.27], Avg: 604.4874 (0.326)
Ep: 373, Reward: 754.2065, Test: 736.7718 [209.05], Avg: 604.2821 (0.325)
Ep: 374, Reward: 703.8062, Test: 737.8888 [204.38], Avg: 604.0934 (0.324)
Ep: 375, Reward: 821.5137, Test: 813.6587 [156.09], Avg: 604.2356 (0.323)
Ep: 376, Reward: 680.7444, Test: 719.0634 [127.98], Avg: 604.2007 (0.322)
Ep: 377, Reward: 684.6973, Test: 663.7160 [146.51], Avg: 603.9706 (0.321)
Ep: 378, Reward: 900.1101, Test: 650.2813 [193.22], Avg: 603.5830 (0.320)
Ep: 379, Reward: 826.0171, Test: 773.6984 [156.96], Avg: 603.6176 (0.319)
Ep: 380, Reward: 749.6038, Test: 677.3830 [168.04], Avg: 603.3701 (0.318)
Ep: 381, Reward: 790.5529, Test: 744.8399 [187.15], Avg: 603.2505 (0.317)
Ep: 382, Reward: 819.6995, Test: 624.2731 [215.56], Avg: 602.7426 (0.316)
Ep: 383, Reward: 855.8463, Test: 765.7897 [151.48], Avg: 602.7727 (0.315)
Ep: 384, Reward: 640.9836, Test: 710.1438 [161.17], Avg: 602.6330 (0.315)
Ep: 385, Reward: 794.9818, Test: 788.1272 [176.17], Avg: 602.6572 (0.314)
Ep: 386, Reward: 604.2198, Test: 815.4503 [158.10], Avg: 602.7985 (0.313)
Ep: 387, Reward: 806.6937, Test: 691.0016 [206.23], Avg: 602.4943 (0.312)
Ep: 388, Reward: 781.8444, Test: 709.4558 [181.39], Avg: 602.3030 (0.311)
Ep: 389, Reward: 733.1685, Test: 683.0175 [187.06], Avg: 602.0303 (0.310)
Ep: 390, Reward: 797.8190, Test: 709.8723 [197.08], Avg: 601.8021 (0.309)
Ep: 391, Reward: 775.0773, Test: 835.2911 [84.61], Avg: 602.1819 (0.308)
Ep: 392, Reward: 815.7055, Test: 720.9462 [177.28], Avg: 602.0330 (0.307)
Ep: 393, Reward: 750.1876, Test: 814.3332 [93.93], Avg: 602.3334 (0.306)
Ep: 394, Reward: 751.2437, Test: 773.5983 [130.73], Avg: 602.4360 (0.305)
Ep: 395, Reward: 733.1430, Test: 807.6716 [103.69], Avg: 602.6925 (0.304)
Ep: 396, Reward: 820.7097, Test: 774.7112 [132.00], Avg: 602.7933 (0.303)
Ep: 397, Reward: 744.8010, Test: 841.9508 [97.46], Avg: 603.1493 (0.302)
Ep: 398, Reward: 711.6400, Test: 773.1455 [219.62], Avg: 603.0249 (0.302)
Ep: 399, Reward: 722.3655, Test: 720.0099 [209.23], Avg: 602.7943 (0.301)
Ep: 400, Reward: 828.4961, Test: 718.9827 [154.24], Avg: 602.6994 (0.300)
Ep: 401, Reward: 816.6550, Test: 698.2411 [127.35], Avg: 602.6203 (0.299)
Ep: 402, Reward: 778.7823, Test: 741.2086 [242.54], Avg: 602.3623 (0.298)
Ep: 403, Reward: 780.4602, Test: 671.9857 [189.29], Avg: 602.0661 (0.297)
Ep: 404, Reward: 800.4357, Test: 559.7092 [266.74], Avg: 601.3029 (0.296)
Ep: 405, Reward: 778.3306, Test: 733.8653 [173.53], Avg: 601.2020 (0.295)
Ep: 406, Reward: 700.6432, Test: 799.4082 [136.29], Avg: 601.3541 (0.294)
Ep: 407, Reward: 760.1685, Test: 767.5247 [229.25], Avg: 601.1995 (0.294)
Ep: 408, Reward: 728.3196, Test: 804.0007 [151.67], Avg: 601.3246 (0.293)
Ep: 409, Reward: 707.4118, Test: 799.1586 [176.21], Avg: 601.3773 (0.292)
Ep: 410, Reward: 811.5223, Test: 725.4584 [185.86], Avg: 601.2270 (0.291)
Ep: 411, Reward: 621.9841, Test: 847.4146 [80.63], Avg: 601.6288 (0.290)
Ep: 412, Reward: 727.8343, Test: 729.3137 [177.61], Avg: 601.5079 (0.289)
Ep: 413, Reward: 770.2697, Test: 767.7386 [168.18], Avg: 601.5032 (0.288)
Ep: 414, Reward: 719.6835, Test: 806.8777 [109.96], Avg: 601.7331 (0.287)
Ep: 415, Reward: 783.7510, Test: 709.7993 [191.18], Avg: 601.5333 (0.287)
Ep: 416, Reward: 710.5851, Test: 691.8929 [221.74], Avg: 601.2183 (0.286)
Ep: 417, Reward: 769.3125, Test: 603.4072 [195.19], Avg: 600.7565 (0.285)
Ep: 418, Reward: 892.8919, Test: 687.2626 [211.73], Avg: 600.4577 (0.284)
Ep: 419, Reward: 737.7630, Test: 872.4513 [55.87], Avg: 600.9723 (0.283)
Ep: 420, Reward: 695.7912, Test: 802.6079 [125.65], Avg: 601.1528 (0.282)
Ep: 421, Reward: 800.4507, Test: 761.6710 [131.49], Avg: 601.2215 (0.281)
Ep: 422, Reward: 684.8048, Test: 796.6802 [161.11], Avg: 601.3027 (0.281)
Ep: 423, Reward: 783.8502, Test: 654.8619 [253.55], Avg: 600.8311 (0.280)
Ep: 424, Reward: 671.1517, Test: 750.3121 [173.59], Avg: 600.7743 (0.279)
Ep: 425, Reward: 740.2592, Test: 752.5479 [182.52], Avg: 600.7022 (0.278)
Ep: 426, Reward: 669.9764, Test: 675.1604 [189.16], Avg: 600.4335 (0.277)
Ep: 427, Reward: 654.0596, Test: 606.7175 [204.64], Avg: 599.9701 (0.276)
Ep: 428, Reward: 750.9620, Test: 769.4034 [167.30], Avg: 599.9751 (0.276)
Ep: 429, Reward: 687.3171, Test: 681.9568 [214.91], Avg: 599.6659 (0.275)
Ep: 430, Reward: 791.4329, Test: 747.9358 [206.21], Avg: 599.5315 (0.274)
Ep: 431, Reward: 710.1861, Test: 728.5812 [162.72], Avg: 599.4536 (0.273)
Ep: 432, Reward: 674.1532, Test: 760.9281 [159.06], Avg: 599.4591 (0.272)
Ep: 433, Reward: 779.4063, Test: 688.0805 [181.55], Avg: 599.2450 (0.271)
Ep: 434, Reward: 780.1759, Test: 624.8701 [189.28], Avg: 598.8688 (0.271)
Ep: 435, Reward: 681.9222, Test: 652.8396 [220.41], Avg: 598.4870 (0.270)
Ep: 436, Reward: 791.1965, Test: 671.2955 [167.99], Avg: 598.2692 (0.269)
Ep: 437, Reward: 750.3124, Test: 670.7743 [201.31], Avg: 597.9751 (0.268)
Ep: 438, Reward: 726.5434, Test: 744.0643 [195.71], Avg: 597.8621 (0.267)
Ep: 439, Reward: 548.1868, Test: 617.5306 [204.61], Avg: 597.4418 (0.267)
Ep: 440, Reward: 620.0264, Test: 714.2048 [182.37], Avg: 597.2930 (0.266)
Ep: 441, Reward: 695.4510, Test: 612.0553 [140.13], Avg: 597.0094 (0.265)
Ep: 442, Reward: 685.2933, Test: 610.2340 [181.03], Avg: 596.6306 (0.264)
Ep: 443, Reward: 695.8323, Test: 669.4394 [175.99], Avg: 596.3982 (0.263)
Ep: 444, Reward: 704.3599, Test: 534.9968 [231.50], Avg: 595.7400 (0.263)
Ep: 445, Reward: 700.2462, Test: 574.6679 [209.52], Avg: 595.2230 (0.262)
Ep: 446, Reward: 756.0930, Test: 688.4251 [226.49], Avg: 594.9248 (0.261)
Ep: 447, Reward: 735.9874, Test: 709.3454 [154.30], Avg: 594.8358 (0.260)
Ep: 448, Reward: 763.1080, Test: 629.6878 [178.15], Avg: 594.5166 (0.259)
Ep: 449, Reward: 734.7022, Test: 683.4359 [204.37], Avg: 594.2601 (0.259)
Ep: 450, Reward: 751.7080, Test: 642.8450 [221.14], Avg: 593.8775 (0.258)
Ep: 451, Reward: 741.0502, Test: 729.5191 [152.47], Avg: 593.8402 (0.257)
Ep: 452, Reward: 683.9983, Test: 784.0130 [126.44], Avg: 593.9809 (0.256)
Ep: 453, Reward: 723.6527, Test: 586.9149 [174.76], Avg: 593.5804 (0.256)
Ep: 454, Reward: 709.2306, Test: 703.2449 [152.70], Avg: 593.4858 (0.255)
Ep: 455, Reward: 737.8620, Test: 651.7916 [205.73], Avg: 593.1625 (0.254)
Ep: 456, Reward: 724.8658, Test: 708.9656 [191.00], Avg: 592.9980 (0.253)
Ep: 457, Reward: 805.8925, Test: 722.3697 [180.39], Avg: 592.8866 (0.253)
Ep: 458, Reward: 822.3306, Test: 790.2762 [139.35], Avg: 593.0131 (0.252)
Ep: 459, Reward: 730.7168, Test: 633.4245 [187.95], Avg: 592.6923 (0.251)
Ep: 460, Reward: 707.8224, Test: 766.4886 [219.97], Avg: 592.5922 (0.250)
Ep: 461, Reward: 725.3509, Test: 738.0591 [180.82], Avg: 592.5157 (0.250)
Ep: 462, Reward: 668.3623, Test: 638.6550 [169.19], Avg: 592.2499 (0.249)
Ep: 463, Reward: 802.4686, Test: 693.1806 [190.11], Avg: 592.0577 (0.248)
Ep: 464, Reward: 729.1966, Test: 643.6074 [208.44], Avg: 591.7203 (0.247)
Ep: 465, Reward: 862.0265, Test: 712.1946 [240.54], Avg: 591.4626 (0.247)
Ep: 466, Reward: 828.0085, Test: 740.2734 [188.99], Avg: 591.3766 (0.246)
Ep: 467, Reward: 754.9371, Test: 748.3881 [195.49], Avg: 591.2944 (0.245)
Ep: 468, Reward: 711.4933, Test: 651.4457 [215.18], Avg: 590.9638 (0.244)
Ep: 469, Reward: 727.0540, Test: 636.0420 [188.03], Avg: 590.6597 (0.244)
Ep: 470, Reward: 704.3848, Test: 815.1975 [170.30], Avg: 590.7748 (0.243)
Ep: 471, Reward: 702.8298, Test: 715.5366 [179.29], Avg: 590.6593 (0.242)
Ep: 472, Reward: 672.0757, Test: 698.6918 [123.01], Avg: 590.6276 (0.241)
Ep: 473, Reward: 683.1651, Test: 715.9346 [147.48], Avg: 590.5809 (0.241)
Ep: 474, Reward: 698.8430, Test: 631.3159 [163.62], Avg: 590.3222 (0.240)
Ep: 475, Reward: 784.2850, Test: 720.6713 [194.95], Avg: 590.1864 (0.239)
Ep: 476, Reward: 664.6092, Test: 679.9228 [162.31], Avg: 590.0343 (0.239)
Ep: 477, Reward: 698.9364, Test: 688.2326 [213.71], Avg: 589.7926 (0.238)
Ep: 478, Reward: 733.5312, Test: 702.7706 [190.87], Avg: 589.6300 (0.237)
Ep: 479, Reward: 755.1507, Test: 693.1217 [200.60], Avg: 589.4277 (0.236)
Ep: 480, Reward: 565.9707, Test: 573.6058 [233.22], Avg: 588.9100 (0.236)
Ep: 481, Reward: 538.9338, Test: 683.4650 [220.46], Avg: 588.6487 (0.235)
Ep: 482, Reward: 622.4945, Test: 731.1468 [172.09], Avg: 588.5875 (0.234)
Ep: 483, Reward: 728.3547, Test: 771.7990 [119.07], Avg: 588.7200 (0.234)
Ep: 484, Reward: 746.1011, Test: 809.7515 [91.22], Avg: 588.9876 (0.233)
Ep: 485, Reward: 720.9935, Test: 692.1771 [176.19], Avg: 588.8374 (0.232)
Ep: 486, Reward: 705.9999, Test: 743.8199 [122.21], Avg: 588.9047 (0.231)
Ep: 487, Reward: 644.4054, Test: 677.4478 [228.50], Avg: 588.6179 (0.231)
Ep: 488, Reward: 729.8016, Test: 760.6814 [201.57], Avg: 588.5576 (0.230)
Ep: 489, Reward: 714.1617, Test: 604.8798 [211.92], Avg: 588.1584 (0.229)
Ep: 490, Reward: 737.0453, Test: 604.0169 [227.99], Avg: 587.7264 (0.229)
Ep: 491, Reward: 758.5608, Test: 771.5907 [111.60], Avg: 587.8733 (0.228)
Ep: 492, Reward: 697.3344, Test: 748.8342 [199.01], Avg: 587.7961 (0.227)
Ep: 493, Reward: 771.5946, Test: 751.0063 [146.52], Avg: 587.8299 (0.227)
Ep: 494, Reward: 765.7502, Test: 738.2948 [192.66], Avg: 587.7446 (0.226)
Ep: 495, Reward: 747.6418, Test: 818.1987 [177.76], Avg: 587.8509 (0.225)
Ep: 496, Reward: 759.8737, Test: 614.9735 [167.56], Avg: 587.5683 (0.225)
Ep: 497, Reward: 764.7014, Test: 657.7205 [224.06], Avg: 587.2592 (0.224)
Ep: 498, Reward: 715.3589, Test: 702.6804 [209.56], Avg: 587.0706 (0.223)
Ep: 499, Reward: 688.9735, Test: 690.6017 [154.27], Avg: 586.9691 (0.223)
