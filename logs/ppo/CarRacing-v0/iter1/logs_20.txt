Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.1                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 4					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.01				# The limit of the ratio of new action probabilities to old probabilities

DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000    			# The number of steps to collect experience in sequence for each GAE calculation
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			value = self.critic_local(state.to(self.device))
			return value

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) + critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)
		self.replay_buffer = PrioritizedReplayBuffer()
		self.ppo_epochs = PPO_EPOCHS
		self.ppo_batch = BATCH_SIZE

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(self.ppo_epochs):
				for i in range(0, len(self.replay_buffer), self.ppo_batch):
					state, action, log_prob, target, advantage = self.replay_buffer.index(self.ppo_batch, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.99			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -55.1093, Test: -30.1906 [5.13], Avg: -35.3169 (0.997)
Ep: 1, Reward: -43.6631, Test: -20.5628 [8.12], Avg: -32.0014 (0.994)
Ep: 2, Reward: -56.2033, Test: -62.0309 [16.78], Avg: -47.6046 (0.991)
Ep: 3, Reward: -68.6874, Test: -38.0051 [44.77], Avg: -56.3984 (0.988)
Ep: 4, Reward: -70.0273, Test: -54.3999 [15.58], Avg: -59.1144 (0.985)
Ep: 5, Reward: -70.4186, Test: -82.1616 [1.16], Avg: -63.1491 (0.982)
Ep: 6, Reward: -70.8438, Test: -72.6898 [13.48], Avg: -66.4375 (0.979)
Ep: 7, Reward: -47.9274, Test: -50.1157 [15.62], Avg: -66.3499 (0.976)
Ep: 8, Reward: -20.7577, Test: -20.3022 [34.46], Avg: -65.0626 (0.973)
Ep: 9, Reward: 20.4307, Test: 4.5780 [38.73], Avg: -61.9715 (0.970)
Ep: 10, Reward: 18.9789, Test: -7.4085 [30.84], Avg: -59.8145 (0.967)
Ep: 11, Reward: 121.7140, Test: 103.6422 [79.95], Avg: -52.8559 (0.965)
Ep: 12, Reward: 240.6649, Test: 178.9677 [62.40], Avg: -39.8233 (0.962)
Ep: 13, Reward: 412.9577, Test: 188.0638 [78.49], Avg: -29.1519 (0.959)
Ep: 14, Reward: 503.1862, Test: 215.7379 [88.29], Avg: -18.7118 (0.956)
Ep: 15, Reward: 632.9513, Test: 178.3622 [94.15], Avg: -12.2792 (0.953)
Ep: 16, Reward: 625.7110, Test: 180.4168 [104.98], Avg: -7.1193 (0.950)
Ep: 17, Reward: 669.3385, Test: 234.0069 [93.38], Avg: 1.0889 (0.947)
Ep: 18, Reward: 645.9496, Test: 124.2635 [88.89], Avg: 2.8933 (0.945)
Ep: 19, Reward: 615.4365, Test: 183.8058 [77.21], Avg: 8.0786 (0.942)
Ep: 20, Reward: 595.3716, Test: 245.4282 [82.50], Avg: 15.4524 (0.939)
Ep: 21, Reward: 438.4602, Test: 243.0527 [27.41], Avg: 24.5520 (0.936)
Ep: 22, Reward: 432.7977, Test: 223.3776 [107.80], Avg: 28.5095 (0.933)
Ep: 23, Reward: 421.2244, Test: 136.2760 [99.95], Avg: 28.8351 (0.930)
Ep: 24, Reward: 448.1536, Test: 237.1416 [116.59], Avg: 32.5036 (0.928)
Ep: 25, Reward: 407.1829, Test: 197.3173 [113.24], Avg: 34.4871 (0.925)
Ep: 26, Reward: 294.6190, Test: 144.9090 [114.74], Avg: 34.3271 (0.922)
Ep: 27, Reward: 336.8241, Test: 204.9823 [102.73], Avg: 36.7530 (0.919)
Ep: 28, Reward: 378.8286, Test: 123.9128 [116.21], Avg: 35.7514 (0.917)
Ep: 29, Reward: 214.2360, Test: 158.0288 [126.89], Avg: 35.5976 (0.914)
Ep: 30, Reward: 275.9853, Test: 176.1958 [119.41], Avg: 36.2813 (0.911)
Ep: 31, Reward: 259.9238, Test: 131.6965 [115.97], Avg: 35.6389 (0.908)
Ep: 32, Reward: 201.8987, Test: 170.3063 [107.90], Avg: 36.4500 (0.906)
Ep: 33, Reward: 217.4991, Test: 177.0049 [136.44], Avg: 36.5710 (0.903)
Ep: 34, Reward: 324.0645, Test: 222.6820 [96.90], Avg: 39.1198 (0.900)
Ep: 35, Reward: 401.0595, Test: 244.6258 [148.27], Avg: 40.7098 (0.897)
Ep: 36, Reward: 356.0676, Test: 215.8967 [110.54], Avg: 42.4569 (0.895)
Ep: 37, Reward: 359.9734, Test: 179.9674 [132.52], Avg: 42.5882 (0.892)
Ep: 38, Reward: 369.9973, Test: 176.4023 [102.36], Avg: 43.3947 (0.889)
Ep: 39, Reward: 214.4543, Test: 223.3657 [122.51], Avg: 44.8312 (0.887)
Ep: 40, Reward: 273.2257, Test: 206.1506 [106.37], Avg: 46.1714 (0.884)
Ep: 41, Reward: 279.0136, Test: 180.0046 [125.47], Avg: 46.3706 (0.881)
Ep: 42, Reward: 320.1685, Test: 162.7020 [85.57], Avg: 47.0860 (0.879)
Ep: 43, Reward: 228.0894, Test: 182.9240 [112.05], Avg: 47.6267 (0.876)
Ep: 44, Reward: 241.7546, Test: 211.4221 [109.99], Avg: 48.8224 (0.874)
Ep: 45, Reward: 304.3779, Test: 218.0438 [109.73], Avg: 50.1156 (0.871)
Ep: 46, Reward: 250.8006, Test: 214.0837 [82.65], Avg: 51.8459 (0.868)
Ep: 47, Reward: 304.9208, Test: 244.5298 [129.35], Avg: 53.1652 (0.866)
Ep: 48, Reward: 385.2682, Test: 265.1621 [61.77], Avg: 56.2310 (0.863)
Ep: 49, Reward: 296.1472, Test: 287.6659 [115.44], Avg: 58.5510 (0.861)
Ep: 50, Reward: 269.8586, Test: 264.2321 [127.94], Avg: 60.0754 (0.858)
Ep: 51, Reward: 296.0929, Test: 176.4364 [121.97], Avg: 59.9675 (0.855)
Ep: 52, Reward: 375.3086, Test: 224.0223 [167.77], Avg: 59.8974 (0.853)
Ep: 53, Reward: 422.9809, Test: 110.7896 [91.81], Avg: 59.1397 (0.850)
Ep: 54, Reward: 303.0940, Test: 239.4968 [134.01], Avg: 59.9823 (0.848)
Ep: 55, Reward: 285.1333, Test: 190.4225 [113.03], Avg: 60.2933 (0.845)
Ep: 56, Reward: 357.8191, Test: 164.6790 [124.07], Avg: 59.9480 (0.843)
Ep: 57, Reward: 442.7389, Test: 211.9160 [140.96], Avg: 60.1377 (0.840)
Ep: 58, Reward: 363.7690, Test: 326.7325 [74.35], Avg: 63.3961 (0.838)
Ep: 59, Reward: 360.9283, Test: 242.3689 [94.60], Avg: 64.8023 (0.835)
Ep: 60, Reward: 322.8328, Test: 311.7163 [194.91], Avg: 65.6548 (0.833)
Ep: 61, Reward: 261.5767, Test: 248.5581 [156.88], Avg: 66.0745 (0.830)
Ep: 62, Reward: 318.1607, Test: 154.5123 [114.82], Avg: 65.6558 (0.828)
Ep: 63, Reward: 347.6833, Test: 192.0021 [119.71], Avg: 65.7595 (0.825)
Ep: 64, Reward: 319.9805, Test: 245.6327 [125.54], Avg: 66.5954 (0.823)
Ep: 65, Reward: 317.5597, Test: 190.4547 [107.35], Avg: 66.8455 (0.820)
Ep: 66, Reward: 285.5082, Test: 241.3359 [113.38], Avg: 67.7576 (0.818)
Ep: 67, Reward: 220.3452, Test: 311.2044 [145.62], Avg: 69.1962 (0.815)
Ep: 68, Reward: 338.0869, Test: 286.7883 [115.19], Avg: 70.6803 (0.813)
Ep: 69, Reward: 236.4910, Test: 198.5771 [115.59], Avg: 70.8561 (0.810)
Ep: 70, Reward: 328.6049, Test: 237.9939 [107.97], Avg: 71.6895 (0.808)
Ep: 71, Reward: 315.2255, Test: 246.4505 [143.87], Avg: 72.1184 (0.805)
Ep: 72, Reward: 344.1722, Test: 301.3140 [146.16], Avg: 73.2559 (0.803)
Ep: 73, Reward: 334.0266, Test: 317.4688 [94.89], Avg: 75.2738 (0.801)
Ep: 74, Reward: 374.7463, Test: 295.7472 [150.51], Avg: 76.2066 (0.798)
Ep: 75, Reward: 280.6239, Test: 288.2442 [121.34], Avg: 77.3999 (0.796)
Ep: 76, Reward: 380.3803, Test: 284.8148 [105.41], Avg: 78.7246 (0.793)
Ep: 77, Reward: 300.9918, Test: 247.9817 [112.20], Avg: 79.4562 (0.791)
Ep: 78, Reward: 298.2345, Test: 229.4264 [158.05], Avg: 79.3539 (0.789)
Ep: 79, Reward: 312.6532, Test: 271.0479 [110.52], Avg: 80.3685 (0.786)
Ep: 80, Reward: 246.9552, Test: 213.9471 [143.31], Avg: 80.2484 (0.784)
Ep: 81, Reward: 347.8930, Test: 239.8883 [156.98], Avg: 80.2809 (0.782)
Ep: 82, Reward: 336.0065, Test: 319.0178 [209.88], Avg: 80.6286 (0.779)
Ep: 83, Reward: 356.1192, Test: 190.8711 [109.11], Avg: 80.6420 (0.777)
Ep: 84, Reward: 314.2733, Test: 191.2626 [120.38], Avg: 80.5272 (0.775)
Ep: 85, Reward: 311.8146, Test: 318.3115 [123.64], Avg: 81.8545 (0.772)
Ep: 86, Reward: 355.6119, Test: 170.2061 [140.90], Avg: 81.2505 (0.770)
Ep: 87, Reward: 407.6059, Test: 328.4099 [165.45], Avg: 82.1790 (0.768)
Ep: 88, Reward: 291.0188, Test: 263.7619 [165.17], Avg: 82.3634 (0.765)
Ep: 89, Reward: 353.9481, Test: 140.6647 [130.95], Avg: 81.5562 (0.763)
Ep: 90, Reward: 336.4948, Test: 328.3846 [197.50], Avg: 82.0983 (0.761)
Ep: 91, Reward: 391.4279, Test: 422.7799 [202.00], Avg: 83.6057 (0.758)
Ep: 92, Reward: 414.0638, Test: 230.9057 [148.00], Avg: 83.5981 (0.756)
Ep: 93, Reward: 414.4472, Test: 444.9366 [187.18], Avg: 85.4509 (0.754)
Ep: 94, Reward: 412.3626, Test: 182.1788 [106.82], Avg: 85.3447 (0.752)
Ep: 95, Reward: 349.1268, Test: 294.3202 [169.80], Avg: 85.7528 (0.749)
Ep: 96, Reward: 456.7320, Test: 330.7105 [117.12], Avg: 87.0707 (0.747)
Ep: 97, Reward: 323.6386, Test: 223.8270 [114.38], Avg: 87.2991 (0.745)
Ep: 98, Reward: 468.9743, Test: 303.3289 [258.95], Avg: 86.8655 (0.743)
Ep: 99, Reward: 370.9784, Test: 371.7348 [205.74], Avg: 87.6568 (0.740)
Ep: 100, Reward: 434.3785, Test: 317.1747 [213.92], Avg: 87.8112 (0.738)
Ep: 101, Reward: 327.6086, Test: 266.0643 [93.28], Avg: 88.6443 (0.736)
Ep: 102, Reward: 397.0801, Test: 325.0448 [141.07], Avg: 89.5698 (0.734)
Ep: 103, Reward: 233.4353, Test: 282.6428 [143.87], Avg: 90.0429 (0.732)
Ep: 104, Reward: 409.5426, Test: 434.9119 [269.32], Avg: 90.7625 (0.729)
Ep: 105, Reward: 356.6886, Test: 394.9128 [184.96], Avg: 91.8869 (0.727)
Ep: 106, Reward: 276.1985, Test: 243.0152 [137.13], Avg: 92.0177 (0.725)
Ep: 107, Reward: 299.2786, Test: 226.2260 [165.05], Avg: 91.7322 (0.723)
Ep: 108, Reward: 358.4960, Test: 312.5530 [214.50], Avg: 91.7902 (0.721)
Ep: 109, Reward: 365.4684, Test: 377.3024 [263.14], Avg: 91.9935 (0.719)
Ep: 110, Reward: 317.1647, Test: 367.9967 [180.45], Avg: 92.8544 (0.716)
Ep: 111, Reward: 434.6291, Test: 344.7604 [245.79], Avg: 92.9089 (0.714)
Ep: 112, Reward: 405.6780, Test: 292.3932 [196.05], Avg: 92.9393 (0.712)
Ep: 113, Reward: 412.6997, Test: 345.2760 [203.96], Avg: 93.3637 (0.710)
Ep: 114, Reward: 490.4750, Test: 495.5459 [259.82], Avg: 94.6016 (0.708)
Ep: 115, Reward: 445.7301, Test: 250.4532 [138.85], Avg: 94.7482 (0.706)
Ep: 116, Reward: 354.3006, Test: 291.4988 [144.83], Avg: 95.1919 (0.704)
Ep: 117, Reward: 462.8016, Test: 359.5168 [82.32], Avg: 96.7344 (0.702)
Ep: 118, Reward: 338.3816, Test: 340.9139 [160.86], Avg: 97.4346 (0.699)
Ep: 119, Reward: 341.5405, Test: 352.9113 [111.68], Avg: 98.6329 (0.697)
Ep: 120, Reward: 449.7867, Test: 355.5295 [231.62], Avg: 98.8418 (0.695)
Ep: 121, Reward: 334.5296, Test: 337.5377 [251.11], Avg: 98.7401 (0.693)
Ep: 122, Reward: 340.6638, Test: 299.0019 [220.84], Avg: 98.5727 (0.691)
Ep: 123, Reward: 405.7652, Test: 283.6476 [219.25], Avg: 98.2971 (0.689)
Ep: 124, Reward: 420.4252, Test: 193.4639 [138.37], Avg: 97.9515 (0.687)
Ep: 125, Reward: 356.0031, Test: 350.2816 [228.76], Avg: 98.1386 (0.685)
Ep: 126, Reward: 400.1887, Test: 338.0430 [233.66], Avg: 98.1878 (0.683)
Ep: 127, Reward: 314.7854, Test: 349.0906 [159.67], Avg: 98.9005 (0.681)
Ep: 128, Reward: 386.8562, Test: 330.6754 [141.05], Avg: 99.6039 (0.679)
Ep: 129, Reward: 375.6510, Test: 350.7045 [121.49], Avg: 100.6008 (0.677)
Ep: 130, Reward: 331.6815, Test: 290.0805 [174.56], Avg: 100.7147 (0.675)
Ep: 131, Reward: 324.7712, Test: 256.4138 [242.91], Avg: 100.0540 (0.673)
Ep: 132, Reward: 433.9126, Test: 304.0067 [220.64], Avg: 99.9286 (0.671)
Ep: 133, Reward: 409.1937, Test: 369.5650 [127.89], Avg: 100.9864 (0.669)
Ep: 134, Reward: 393.6628, Test: 323.2897 [124.10], Avg: 101.7139 (0.667)
Ep: 135, Reward: 421.2058, Test: 301.5377 [234.08], Avg: 101.4620 (0.665)
Ep: 136, Reward: 364.0413, Test: 282.9569 [114.19], Avg: 101.9533 (0.663)
Ep: 137, Reward: 343.9849, Test: 350.4680 [224.39], Avg: 102.1281 (0.661)
Ep: 138, Reward: 421.6364, Test: 293.7507 [102.95], Avg: 102.7660 (0.659)
Ep: 139, Reward: 272.6682, Test: 225.0935 [185.87], Avg: 102.3121 (0.657)
Ep: 140, Reward: 386.3090, Test: 295.4322 [126.10], Avg: 102.7875 (0.655)
Ep: 141, Reward: 329.4544, Test: 329.6440 [193.54], Avg: 103.0221 (0.653)
Ep: 142, Reward: 321.4136, Test: 231.7791 [145.57], Avg: 102.9045 (0.651)
Ep: 143, Reward: 460.0228, Test: 402.9219 [232.49], Avg: 103.3735 (0.649)
Ep: 144, Reward: 434.4706, Test: 427.2429 [247.77], Avg: 103.8983 (0.647)
Ep: 145, Reward: 331.7112, Test: 373.8707 [163.42], Avg: 104.6281 (0.645)
Ep: 146, Reward: 363.6650, Test: 281.4487 [155.31], Avg: 104.7744 (0.643)
Ep: 147, Reward: 407.0177, Test: 274.7055 [168.24], Avg: 104.7858 (0.641)
Ep: 148, Reward: 415.1086, Test: 223.8341 [126.20], Avg: 104.7378 (0.639)
Ep: 149, Reward: 262.7821, Test: 381.4899 [198.45], Avg: 105.2599 (0.637)
Ep: 150, Reward: 343.3136, Test: 226.9267 [138.64], Avg: 105.1475 (0.635)
Ep: 151, Reward: 289.4296, Test: 208.2302 [106.63], Avg: 105.1242 (0.633)
Ep: 152, Reward: 309.7846, Test: 326.6449 [200.54], Avg: 105.2613 (0.631)
Ep: 153, Reward: 342.5274, Test: 301.5155 [202.39], Avg: 105.2214 (0.630)
Ep: 154, Reward: 367.1360, Test: 328.9237 [179.35], Avg: 105.5075 (0.628)
Ep: 155, Reward: 339.5318, Test: 263.6168 [129.99], Avg: 105.6878 (0.626)
Ep: 156, Reward: 392.4838, Test: 281.2277 [128.21], Avg: 105.9893 (0.624)
Ep: 157, Reward: 244.7468, Test: 261.3341 [123.75], Avg: 106.1893 (0.622)
Ep: 158, Reward: 279.2709, Test: 197.0169 [116.43], Avg: 106.0283 (0.620)
Ep: 159, Reward: 381.2485, Test: 323.1921 [90.45], Avg: 106.8202 (0.618)
Ep: 160, Reward: 332.0744, Test: 221.1987 [148.42], Avg: 106.6088 (0.616)
Ep: 161, Reward: 388.4111, Test: 290.4790 [130.20], Avg: 106.9401 (0.615)
Ep: 162, Reward: 281.8060, Test: 219.4936 [125.41], Avg: 106.8612 (0.613)
Ep: 163, Reward: 363.8207, Test: 233.2269 [165.98], Avg: 106.6196 (0.611)
Ep: 164, Reward: 340.9978, Test: 299.8278 [133.18], Avg: 106.9834 (0.609)
Ep: 165, Reward: 260.8126, Test: 276.7445 [134.10], Avg: 107.1982 (0.607)
Ep: 166, Reward: 310.4861, Test: 259.6255 [124.99], Avg: 107.3625 (0.605)
Ep: 167, Reward: 429.3116, Test: 182.5419 [118.47], Avg: 107.1048 (0.604)
Ep: 168, Reward: 387.5258, Test: 273.5597 [171.44], Avg: 107.0753 (0.602)
Ep: 169, Reward: 328.6421, Test: 270.5875 [125.84], Avg: 107.2970 (0.600)
Ep: 170, Reward: 347.7084, Test: 242.0677 [127.45], Avg: 107.3398 (0.598)
Ep: 171, Reward: 322.3128, Test: 198.3238 [166.06], Avg: 106.9033 (0.596)
Ep: 172, Reward: 446.9932, Test: 354.1186 [176.63], Avg: 107.3113 (0.595)
Ep: 173, Reward: 328.0485, Test: 287.7349 [185.17], Avg: 107.2840 (0.593)
Ep: 174, Reward: 247.8072, Test: 304.9618 [124.70], Avg: 107.7011 (0.591)
Ep: 175, Reward: 341.1840, Test: 299.4000 [159.41], Avg: 107.8845 (0.589)
Ep: 176, Reward: 331.6568, Test: 280.3663 [194.13], Avg: 107.7622 (0.588)
Ep: 177, Reward: 441.7808, Test: 249.9799 [143.16], Avg: 107.7569 (0.586)
Ep: 178, Reward: 338.0834, Test: 292.3448 [121.46], Avg: 108.1096 (0.584)
Ep: 179, Reward: 380.5433, Test: 315.0743 [223.51], Avg: 108.0177 (0.582)
Ep: 180, Reward: 462.6394, Test: 343.4629 [191.80], Avg: 108.2588 (0.581)
Ep: 181, Reward: 437.5330, Test: 366.7431 [146.80], Avg: 108.8725 (0.579)
Ep: 182, Reward: 427.5982, Test: 359.7390 [151.93], Avg: 109.4131 (0.577)
Ep: 183, Reward: 337.1115, Test: 252.7197 [145.68], Avg: 109.4002 (0.575)
Ep: 184, Reward: 335.7114, Test: 317.6166 [100.44], Avg: 109.9828 (0.574)
Ep: 185, Reward: 304.6253, Test: 213.6357 [136.92], Avg: 109.8039 (0.572)
Ep: 186, Reward: 397.5819, Test: 363.0047 [267.24], Avg: 109.7288 (0.570)
Ep: 187, Reward: 405.2726, Test: 306.4316 [122.48], Avg: 110.1236 (0.568)
Ep: 188, Reward: 437.6921, Test: 334.0115 [198.31], Avg: 110.2590 (0.567)
Ep: 189, Reward: 519.6469, Test: 480.7637 [217.21], Avg: 111.0658 (0.565)
Ep: 190, Reward: 387.2530, Test: 340.7116 [160.16], Avg: 111.4296 (0.563)
Ep: 191, Reward: 339.9025, Test: 318.7133 [160.63], Avg: 111.6725 (0.562)
Ep: 192, Reward: 486.1797, Test: 420.0171 [163.63], Avg: 112.4224 (0.560)
Ep: 193, Reward: 352.6439, Test: 321.8897 [128.77], Avg: 112.8383 (0.558)
Ep: 194, Reward: 371.9770, Test: 361.9324 [201.78], Avg: 113.0809 (0.557)
Ep: 195, Reward: 417.6078, Test: 284.1939 [124.56], Avg: 113.3184 (0.555)
Ep: 196, Reward: 428.6841, Test: 294.5306 [95.68], Avg: 113.7526 (0.553)
Ep: 197, Reward: 435.1342, Test: 414.0368 [156.62], Avg: 114.4782 (0.552)
Ep: 198, Reward: 440.9015, Test: 430.0588 [283.32], Avg: 114.6403 (0.550)
Ep: 199, Reward: 469.3091, Test: 305.8750 [120.99], Avg: 114.9915 (0.548)
Ep: 200, Reward: 357.2095, Test: 232.7937 [202.70], Avg: 114.5691 (0.547)
Ep: 201, Reward: 413.6265, Test: 331.4357 [236.99], Avg: 114.4695 (0.545)
Ep: 202, Reward: 493.7558, Test: 379.8320 [255.53], Avg: 114.5179 (0.543)
Ep: 203, Reward: 475.1259, Test: 529.9408 [184.15], Avg: 115.6516 (0.542)
Ep: 204, Reward: 336.9799, Test: 376.1768 [180.26], Avg: 116.0431 (0.540)
Ep: 205, Reward: 405.5456, Test: 287.3009 [222.87], Avg: 115.7926 (0.539)
Ep: 206, Reward: 325.0288, Test: 287.7901 [163.13], Avg: 115.8354 (0.537)
Ep: 207, Reward: 398.0467, Test: 293.7488 [184.89], Avg: 115.8019 (0.535)
Ep: 208, Reward: 382.9211, Test: 269.7716 [195.79], Avg: 115.6018 (0.534)
Ep: 209, Reward: 369.5559, Test: 256.2993 [146.57], Avg: 115.5738 (0.532)
Ep: 210, Reward: 364.1896, Test: 299.3596 [193.95], Avg: 115.5257 (0.530)
Ep: 211, Reward: 359.9061, Test: 281.9690 [183.37], Avg: 115.4458 (0.529)
Ep: 212, Reward: 447.4726, Test: 375.6418 [150.40], Avg: 115.9613 (0.527)
Ep: 213, Reward: 498.3691, Test: 411.0030 [265.49], Avg: 116.0994 (0.526)
Ep: 214, Reward: 345.9917, Test: 340.8743 [224.11], Avg: 116.1025 (0.524)
Ep: 215, Reward: 286.1240, Test: 280.7748 [136.21], Avg: 116.2343 (0.523)
Ep: 216, Reward: 425.7721, Test: 315.2524 [179.88], Avg: 116.3225 (0.521)
Ep: 217, Reward: 357.1040, Test: 494.2705 [266.00], Avg: 116.8360 (0.519)
Ep: 218, Reward: 457.3124, Test: 390.2862 [270.93], Avg: 116.8475 (0.518)
Ep: 219, Reward: 309.8098, Test: 306.1157 [177.97], Avg: 116.8988 (0.516)
Ep: 220, Reward: 413.6447, Test: 294.2164 [211.87], Avg: 116.7425 (0.515)
Ep: 221, Reward: 539.5111, Test: 432.5634 [245.28], Avg: 117.0603 (0.513)
Ep: 222, Reward: 499.6532, Test: 287.5675 [135.10], Avg: 117.2190 (0.512)
Ep: 223, Reward: 398.8660, Test: 341.9760 [161.39], Avg: 117.5019 (0.510)
Ep: 224, Reward: 360.1789, Test: 338.7314 [199.27], Avg: 117.5995 (0.509)
Ep: 225, Reward: 434.7829, Test: 413.1653 [175.99], Avg: 118.1286 (0.507)
Ep: 226, Reward: 464.6459, Test: 465.7061 [121.25], Avg: 119.1257 (0.506)
Ep: 227, Reward: 477.7638, Test: 262.7870 [179.07], Avg: 118.9704 (0.504)
Ep: 228, Reward: 359.6859, Test: 327.0176 [109.67], Avg: 119.4000 (0.503)
Ep: 229, Reward: 451.3056, Test: 466.5836 [160.79], Avg: 120.2104 (0.501)
Ep: 230, Reward: 595.0198, Test: 371.3851 [200.97], Avg: 120.4277 (0.500)
Ep: 231, Reward: 405.6154, Test: 286.4533 [235.38], Avg: 120.1288 (0.498)
Ep: 232, Reward: 341.6698, Test: 318.0717 [206.33], Avg: 120.0928 (0.497)
Ep: 233, Reward: 504.4665, Test: 374.8884 [228.09], Avg: 120.2069 (0.495)
Ep: 234, Reward: 446.9700, Test: 300.2940 [186.43], Avg: 120.1799 (0.494)
Ep: 235, Reward: 555.4138, Test: 383.0199 [134.18], Avg: 120.7251 (0.492)
Ep: 236, Reward: 507.4190, Test: 399.4605 [192.49], Avg: 121.0890 (0.491)
Ep: 237, Reward: 363.0977, Test: 558.3131 [246.86], Avg: 121.8888 (0.489)
Ep: 238, Reward: 507.6955, Test: 339.8498 [71.10], Avg: 122.5033 (0.488)
Ep: 239, Reward: 501.9738, Test: 306.8447 [245.88], Avg: 122.2469 (0.486)
Ep: 240, Reward: 392.7449, Test: 318.7183 [195.30], Avg: 122.2518 (0.485)
Ep: 241, Reward: 421.1695, Test: 443.9347 [199.70], Avg: 122.7558 (0.483)
Ep: 242, Reward: 456.9673, Test: 387.3691 [181.27], Avg: 123.0988 (0.482)
Ep: 243, Reward: 527.1098, Test: 416.9402 [185.03], Avg: 123.5447 (0.480)
Ep: 244, Reward: 429.6161, Test: 325.7707 [187.37], Avg: 123.6054 (0.479)
Ep: 245, Reward: 491.1215, Test: 329.9869 [216.60], Avg: 123.5638 (0.478)
Ep: 246, Reward: 365.5913, Test: 398.6735 [248.86], Avg: 123.6701 (0.476)
Ep: 247, Reward: 558.6353, Test: 447.0318 [202.40], Avg: 124.1579 (0.475)
Ep: 248, Reward: 475.5305, Test: 439.5428 [175.92], Avg: 124.7180 (0.473)
Ep: 249, Reward: 452.6374, Test: 283.6268 [156.38], Avg: 124.7281 (0.472)
Ep: 250, Reward: 403.6157, Test: 358.3118 [200.72], Avg: 124.8590 (0.470)
Ep: 251, Reward: 648.8902, Test: 294.5917 [220.99], Avg: 124.6556 (0.469)
Ep: 252, Reward: 581.9896, Test: 343.7853 [127.16], Avg: 125.0191 (0.468)
Ep: 253, Reward: 491.8860, Test: 582.1938 [210.29], Avg: 125.9911 (0.466)
Ep: 254, Reward: 441.0212, Test: 386.3864 [262.85], Avg: 125.9815 (0.465)
Ep: 255, Reward: 449.6008, Test: 350.2113 [266.75], Avg: 125.8154 (0.463)
Ep: 256, Reward: 429.4146, Test: 361.2454 [153.34], Avg: 126.1348 (0.462)
Ep: 257, Reward: 564.7634, Test: 399.5493 [278.23], Avg: 126.1162 (0.461)
Ep: 258, Reward: 500.8794, Test: 319.1400 [222.33], Avg: 126.0030 (0.459)
Ep: 259, Reward: 453.2346, Test: 338.3982 [172.51], Avg: 126.1564 (0.458)
Ep: 260, Reward: 508.8671, Test: 383.1832 [184.44], Avg: 126.4345 (0.456)
Ep: 261, Reward: 525.4753, Test: 280.9576 [195.88], Avg: 126.2766 (0.455)
Ep: 262, Reward: 420.9032, Test: 399.8451 [177.76], Avg: 126.6409 (0.454)
Ep: 263, Reward: 393.7883, Test: 451.8259 [319.01], Avg: 126.6643 (0.452)
Ep: 264, Reward: 371.3893, Test: 442.5086 [123.41], Avg: 127.3905 (0.451)
Ep: 265, Reward: 534.4318, Test: 513.8437 [110.19], Avg: 128.4291 (0.450)
Ep: 266, Reward: 519.3179, Test: 338.0321 [214.32], Avg: 128.4114 (0.448)
Ep: 267, Reward: 383.2131, Test: 368.5120 [158.95], Avg: 128.7142 (0.447)
Ep: 268, Reward: 564.7441, Test: 526.9784 [219.63], Avg: 129.3783 (0.446)
Ep: 269, Reward: 398.7569, Test: 312.9621 [212.20], Avg: 129.2723 (0.444)
Ep: 270, Reward: 461.8796, Test: 425.3143 [277.76], Avg: 129.3398 (0.443)
Ep: 271, Reward: 460.7225, Test: 423.7188 [187.21], Avg: 129.7338 (0.442)
Ep: 272, Reward: 521.7574, Test: 373.4129 [178.17], Avg: 129.9737 (0.440)
Ep: 273, Reward: 426.9293, Test: 350.7039 [236.97], Avg: 129.9144 (0.439)
Ep: 274, Reward: 444.7778, Test: 385.7095 [85.63], Avg: 130.5332 (0.438)
Ep: 275, Reward: 459.6759, Test: 332.8296 [106.96], Avg: 130.8786 (0.436)
Ep: 276, Reward: 372.5848, Test: 367.8601 [162.05], Avg: 131.1491 (0.435)
Ep: 277, Reward: 468.1349, Test: 428.2939 [128.20], Avg: 131.7568 (0.434)
Ep: 278, Reward: 409.1977, Test: 480.6264 [247.87], Avg: 132.1189 (0.432)
Ep: 279, Reward: 401.8791, Test: 386.3552 [182.80], Avg: 132.3740 (0.431)
Ep: 280, Reward: 399.8991, Test: 284.9429 [122.96], Avg: 132.4794 (0.430)
Ep: 281, Reward: 451.2800, Test: 305.3057 [132.40], Avg: 132.6227 (0.429)
Ep: 282, Reward: 617.1445, Test: 377.5535 [208.85], Avg: 132.7502 (0.427)
Ep: 283, Reward: 466.6858, Test: 493.3522 [203.80], Avg: 133.3023 (0.426)
Ep: 284, Reward: 476.8335, Test: 312.3485 [156.79], Avg: 133.3804 (0.425)
Ep: 285, Reward: 323.5733, Test: 355.0976 [178.75], Avg: 133.5307 (0.423)
Ep: 286, Reward: 438.6996, Test: 404.9518 [179.59], Avg: 133.8506 (0.422)
Ep: 287, Reward: 317.8373, Test: 393.1579 [184.90], Avg: 134.1090 (0.421)
Ep: 288, Reward: 386.6577, Test: 407.8114 [146.79], Avg: 134.5481 (0.420)
Ep: 289, Reward: 341.7608, Test: 437.8183 [129.21], Avg: 135.1483 (0.418)
Ep: 290, Reward: 375.8936, Test: 551.9937 [196.17], Avg: 135.9067 (0.417)
Ep: 291, Reward: 458.7645, Test: 496.7555 [191.35], Avg: 136.4872 (0.416)
Ep: 292, Reward: 357.7729, Test: 348.8981 [188.72], Avg: 136.5680 (0.415)
Ep: 293, Reward: 405.2802, Test: 461.9975 [211.35], Avg: 136.9561 (0.413)
Ep: 294, Reward: 531.2388, Test: 349.0967 [216.84], Avg: 136.9401 (0.412)
Ep: 295, Reward: 375.3388, Test: 306.4675 [152.81], Avg: 136.9966 (0.411)
Ep: 296, Reward: 431.0313, Test: 300.7949 [158.05], Avg: 137.0160 (0.410)
Ep: 297, Reward: 449.1530, Test: 318.0409 [165.17], Avg: 137.0692 (0.408)
Ep: 298, Reward: 409.7139, Test: 400.2433 [198.85], Avg: 137.2843 (0.407)
Ep: 299, Reward: 416.9677, Test: 436.7797 [175.91], Avg: 137.6963 (0.406)
Ep: 300, Reward: 388.1084, Test: 443.8554 [254.57], Avg: 137.8677 (0.405)
Ep: 301, Reward: 438.6013, Test: 389.7267 [157.30], Avg: 138.1808 (0.404)
Ep: 302, Reward: 458.3887, Test: 432.9791 [198.99], Avg: 138.4970 (0.402)
Ep: 303, Reward: 455.9460, Test: 486.1387 [196.83], Avg: 138.9931 (0.401)
Ep: 304, Reward: 519.5519, Test: 390.5442 [266.42], Avg: 138.9444 (0.400)
Ep: 305, Reward: 531.7662, Test: 439.3189 [207.41], Avg: 139.2482 (0.399)
Ep: 306, Reward: 428.5066, Test: 237.0269 [112.46], Avg: 139.2003 (0.398)
Ep: 307, Reward: 440.0794, Test: 462.4178 [206.82], Avg: 139.5783 (0.396)
Ep: 308, Reward: 378.3841, Test: 359.8160 [289.77], Avg: 139.3532 (0.395)
Ep: 309, Reward: 440.7201, Test: 424.6568 [141.30], Avg: 139.8178 (0.394)
Ep: 310, Reward: 368.1061, Test: 377.8709 [161.30], Avg: 140.0646 (0.393)
Ep: 311, Reward: 608.4122, Test: 366.0399 [101.71], Avg: 140.4628 (0.392)
Ep: 312, Reward: 483.3663, Test: 398.9140 [127.12], Avg: 140.8824 (0.390)
Ep: 313, Reward: 361.8938, Test: 329.7750 [164.12], Avg: 140.9613 (0.389)
Ep: 314, Reward: 397.3811, Test: 458.3422 [206.08], Avg: 141.3147 (0.388)
Ep: 315, Reward: 465.0981, Test: 334.7216 [91.18], Avg: 141.6381 (0.387)
Ep: 316, Reward: 430.2492, Test: 395.8328 [262.82], Avg: 141.6109 (0.386)
Ep: 317, Reward: 400.9874, Test: 542.0884 [202.28], Avg: 142.2342 (0.385)
Ep: 318, Reward: 424.1902, Test: 386.2007 [198.75], Avg: 142.3759 (0.383)
Ep: 319, Reward: 446.7828, Test: 394.4389 [164.17], Avg: 142.6506 (0.382)
Ep: 320, Reward: 470.6070, Test: 382.6693 [226.36], Avg: 142.6931 (0.381)
Ep: 321, Reward: 482.2577, Test: 485.8519 [194.80], Avg: 143.1539 (0.380)
Ep: 322, Reward: 412.0378, Test: 291.5586 [103.20], Avg: 143.2938 (0.379)
Ep: 323, Reward: 537.1024, Test: 299.9773 [158.46], Avg: 143.2884 (0.378)
Ep: 324, Reward: 424.5167, Test: 539.3382 [270.60], Avg: 143.6744 (0.377)
Ep: 325, Reward: 495.2673, Test: 358.4370 [180.18], Avg: 143.7804 (0.376)
Ep: 326, Reward: 398.6086, Test: 305.8308 [113.24], Avg: 143.9297 (0.374)
Ep: 327, Reward: 451.8143, Test: 375.7323 [125.51], Avg: 144.2538 (0.373)
Ep: 328, Reward: 504.5451, Test: 369.5895 [244.38], Avg: 144.1959 (0.372)
Ep: 329, Reward: 412.9293, Test: 286.2215 [221.77], Avg: 143.9543 (0.371)
Ep: 330, Reward: 504.0682, Test: 411.6986 [238.26], Avg: 144.0433 (0.370)
Ep: 331, Reward: 443.1842, Test: 373.8367 [150.57], Avg: 144.2820 (0.369)
Ep: 332, Reward: 600.3947, Test: 431.2828 [195.70], Avg: 144.5561 (0.368)
Ep: 333, Reward: 509.3573, Test: 483.6017 [251.06], Avg: 144.8196 (0.367)
Ep: 334, Reward: 438.0343, Test: 419.3866 [115.82], Avg: 145.2935 (0.365)
Ep: 335, Reward: 581.1721, Test: 414.7706 [217.29], Avg: 145.4488 (0.364)
Ep: 336, Reward: 388.4417, Test: 481.2073 [182.28], Avg: 145.9042 (0.363)
Ep: 337, Reward: 398.7646, Test: 325.7584 [141.90], Avg: 146.0165 (0.362)
Ep: 338, Reward: 613.0740, Test: 312.9712 [258.43], Avg: 145.7466 (0.361)
Ep: 339, Reward: 437.9205, Test: 249.1631 [181.11], Avg: 145.5181 (0.360)
Ep: 340, Reward: 531.2124, Test: 420.2591 [212.84], Avg: 145.6997 (0.359)
Ep: 341, Reward: 454.8276, Test: 393.6553 [168.96], Avg: 145.9306 (0.358)
Ep: 342, Reward: 546.8636, Test: 291.3923 [133.72], Avg: 145.9649 (0.357)
Ep: 343, Reward: 466.1011, Test: 505.9572 [174.70], Avg: 146.5035 (0.356)
Ep: 344, Reward: 451.4461, Test: 460.6874 [206.94], Avg: 146.8144 (0.355)
Ep: 345, Reward: 491.3303, Test: 355.4316 [175.04], Avg: 146.9114 (0.354)
Ep: 346, Reward: 488.0073, Test: 444.9813 [222.96], Avg: 147.1279 (0.353)
Ep: 347, Reward: 405.1586, Test: 384.8992 [201.47], Avg: 147.2322 (0.351)
Ep: 348, Reward: 570.8099, Test: 357.3000 [122.64], Avg: 147.4827 (0.350)
Ep: 349, Reward: 486.1018, Test: 322.5729 [169.48], Avg: 147.4987 (0.349)
Ep: 350, Reward: 582.0046, Test: 342.0095 [212.72], Avg: 147.4468 (0.348)
Ep: 351, Reward: 457.7425, Test: 260.4411 [95.34], Avg: 147.4970 (0.347)
Ep: 352, Reward: 563.6231, Test: 420.2078 [258.97], Avg: 147.5359 (0.346)
Ep: 353, Reward: 542.0595, Test: 353.6288 [175.51], Avg: 147.6223 (0.345)
Ep: 354, Reward: 544.6369, Test: 380.6683 [144.04], Avg: 147.8730 (0.344)
Ep: 355, Reward: 674.8289, Test: 413.8690 [207.31], Avg: 148.0379 (0.343)
Ep: 356, Reward: 417.7047, Test: 486.8498 [202.92], Avg: 148.4185 (0.342)
Ep: 357, Reward: 530.7058, Test: 580.1320 [184.66], Avg: 149.1087 (0.341)
Ep: 358, Reward: 635.0150, Test: 467.1515 [169.27], Avg: 149.5231 (0.340)
Ep: 359, Reward: 519.9814, Test: 444.2413 [197.82], Avg: 149.7922 (0.339)
Ep: 360, Reward: 438.2929, Test: 448.4834 [143.65], Avg: 150.2217 (0.338)
Ep: 361, Reward: 546.2954, Test: 519.9476 [165.37], Avg: 150.7862 (0.337)
Ep: 362, Reward: 592.0894, Test: 406.1794 [217.15], Avg: 150.8916 (0.336)
Ep: 363, Reward: 591.8162, Test: 447.4637 [225.08], Avg: 151.0880 (0.335)
Ep: 364, Reward: 445.9514, Test: 470.6776 [166.90], Avg: 151.5063 (0.334)
Ep: 365, Reward: 472.5967, Test: 512.3607 [139.20], Avg: 152.1119 (0.333)
Ep: 366, Reward: 612.9951, Test: 599.2160 [197.77], Avg: 152.7913 (0.332)
Ep: 367, Reward: 431.8499, Test: 421.5389 [270.82], Avg: 152.7857 (0.331)
Ep: 368, Reward: 473.3418, Test: 376.4210 [174.07], Avg: 152.9200 (0.330)
Ep: 369, Reward: 617.8365, Test: 378.5387 [210.22], Avg: 152.9616 (0.329)
Ep: 370, Reward: 553.8857, Test: 341.1080 [246.76], Avg: 152.8036 (0.328)
Ep: 371, Reward: 679.7787, Test: 421.4466 [115.44], Avg: 153.2155 (0.327)
Ep: 372, Reward: 431.5387, Test: 416.8277 [223.26], Avg: 153.3236 (0.326)
Ep: 373, Reward: 557.3518, Test: 352.2008 [208.72], Avg: 153.2973 (0.325)
Ep: 374, Reward: 516.9832, Test: 442.4837 [204.24], Avg: 153.5238 (0.324)
Ep: 375, Reward: 548.2606, Test: 390.7804 [113.32], Avg: 153.8535 (0.323)
Ep: 376, Reward: 536.1762, Test: 411.3563 [187.84], Avg: 154.0382 (0.322)
Ep: 377, Reward: 499.5057, Test: 382.4276 [185.32], Avg: 154.1522 (0.321)
Ep: 378, Reward: 547.2894, Test: 523.0075 [159.26], Avg: 154.7052 (0.320)
Ep: 379, Reward: 546.2583, Test: 398.6335 [220.41], Avg: 154.7671 (0.319)
Ep: 380, Reward: 431.7858, Test: 342.1182 [178.96], Avg: 154.7891 (0.318)
Ep: 381, Reward: 561.0489, Test: 409.7980 [115.18], Avg: 155.1552 (0.317)
Ep: 382, Reward: 513.7841, Test: 369.9089 [160.77], Avg: 155.2961 (0.316)
Ep: 383, Reward: 579.1628, Test: 423.9346 [237.98], Avg: 155.3760 (0.315)
Ep: 384, Reward: 535.6510, Test: 507.7884 [193.03], Avg: 155.7900 (0.315)
Ep: 385, Reward: 639.7190, Test: 508.2960 [270.22], Avg: 156.0031 (0.314)
Ep: 386, Reward: 505.6493, Test: 416.6280 [177.55], Avg: 156.2178 (0.313)
Ep: 387, Reward: 506.5928, Test: 580.6388 [237.19], Avg: 156.7003 (0.312)
Ep: 388, Reward: 539.7562, Test: 480.0515 [227.48], Avg: 156.9468 (0.311)
Ep: 389, Reward: 517.5408, Test: 429.3778 [221.55], Avg: 157.0773 (0.310)
Ep: 390, Reward: 589.7637, Test: 367.5917 [212.90], Avg: 157.0712 (0.309)
Ep: 391, Reward: 474.2084, Test: 393.9194 [164.51], Avg: 157.2557 (0.308)
Ep: 392, Reward: 492.2738, Test: 406.2262 [180.17], Avg: 157.4308 (0.307)
Ep: 393, Reward: 513.7080, Test: 395.4835 [180.35], Avg: 157.5772 (0.306)
Ep: 394, Reward: 550.9956, Test: 407.0733 [217.09], Avg: 157.6593 (0.305)
Ep: 395, Reward: 552.9940, Test: 470.8048 [211.11], Avg: 157.9169 (0.304)
Ep: 396, Reward: 410.6838, Test: 506.8744 [197.24], Avg: 158.2991 (0.303)
Ep: 397, Reward: 439.8687, Test: 526.8588 [244.22], Avg: 158.6115 (0.302)
Ep: 398, Reward: 511.3546, Test: 400.8854 [207.33], Avg: 158.6991 (0.302)
Ep: 399, Reward: 448.3688, Test: 425.4828 [256.13], Avg: 158.7257 (0.301)
Ep: 400, Reward: 509.0212, Test: 419.2521 [242.92], Avg: 158.7696 (0.300)
Ep: 401, Reward: 635.2761, Test: 434.6858 [240.49], Avg: 158.8577 (0.299)
Ep: 402, Reward: 505.7067, Test: 402.2878 [249.19], Avg: 158.8434 (0.298)
Ep: 403, Reward: 576.7305, Test: 471.9667 [169.80], Avg: 159.1982 (0.297)
Ep: 404, Reward: 515.4399, Test: 481.4233 [195.38], Avg: 159.5114 (0.296)
Ep: 405, Reward: 588.3924, Test: 442.3453 [259.45], Avg: 159.5690 (0.295)
Ep: 406, Reward: 517.0699, Test: 395.7078 [186.12], Avg: 159.6919 (0.294)
Ep: 407, Reward: 539.6809, Test: 385.7996 [217.11], Avg: 159.7140 (0.294)
Ep: 408, Reward: 483.8988, Test: 464.7428 [166.49], Avg: 160.0527 (0.293)
Ep: 409, Reward: 567.3227, Test: 420.7444 [136.94], Avg: 160.3545 (0.292)
Ep: 410, Reward: 432.2141, Test: 334.1108 [121.33], Avg: 160.4821 (0.291)
Ep: 411, Reward: 548.7670, Test: 429.1754 [195.90], Avg: 160.6588 (0.290)
Ep: 412, Reward: 381.7337, Test: 479.6487 [240.22], Avg: 160.8495 (0.289)
Ep: 413, Reward: 614.3404, Test: 496.2823 [242.45], Avg: 161.0741 (0.288)
Ep: 414, Reward: 693.0540, Test: 335.4214 [157.94], Avg: 161.1136 (0.287)
Ep: 415, Reward: 546.8081, Test: 509.6352 [212.25], Avg: 161.4412 (0.287)
Ep: 416, Reward: 526.2550, Test: 480.0688 [241.64], Avg: 161.6258 (0.286)
Ep: 417, Reward: 543.6051, Test: 383.1509 [162.90], Avg: 161.7661 (0.285)
Ep: 418, Reward: 502.3061, Test: 542.9364 [240.59], Avg: 162.1016 (0.284)
Ep: 419, Reward: 599.8839, Test: 383.2285 [220.25], Avg: 162.1037 (0.283)
Ep: 420, Reward: 629.1739, Test: 422.2890 [172.73], Avg: 162.3114 (0.282)
Ep: 421, Reward: 525.3869, Test: 506.8810 [147.63], Avg: 162.7781 (0.281)
Ep: 422, Reward: 527.8866, Test: 508.8083 [207.05], Avg: 163.1066 (0.281)
Ep: 423, Reward: 667.6948, Test: 466.0417 [132.27], Avg: 163.5092 (0.280)
Ep: 424, Reward: 497.4283, Test: 458.1996 [160.02], Avg: 163.8260 (0.279)
Ep: 425, Reward: 597.2362, Test: 408.8103 [132.00], Avg: 164.0913 (0.278)
Ep: 426, Reward: 502.3438, Test: 451.5533 [174.77], Avg: 164.3552 (0.277)
Ep: 427, Reward: 469.0457, Test: 431.9822 [188.92], Avg: 164.5391 (0.276)
Ep: 428, Reward: 464.4985, Test: 504.1865 [145.97], Avg: 164.9905 (0.276)
Ep: 429, Reward: 503.0838, Test: 320.8989 [78.28], Avg: 165.1711 (0.275)
Ep: 430, Reward: 439.7851, Test: 340.8206 [152.02], Avg: 165.2259 (0.274)
Ep: 431, Reward: 519.6440, Test: 480.1511 [195.27], Avg: 165.5029 (0.273)
Ep: 432, Reward: 456.9338, Test: 358.8592 [164.00], Avg: 165.5707 (0.272)
Ep: 433, Reward: 629.5108, Test: 433.3707 [173.31], Avg: 165.7884 (0.271)
Ep: 434, Reward: 565.3803, Test: 554.7746 [180.84], Avg: 166.2669 (0.271)
Ep: 435, Reward: 533.4152, Test: 466.2954 [168.36], Avg: 166.5689 (0.270)
Ep: 436, Reward: 531.2684, Test: 369.8707 [192.76], Avg: 166.5930 (0.269)
Ep: 437, Reward: 556.4211, Test: 503.4164 [224.11], Avg: 166.8503 (0.268)
Ep: 438, Reward: 478.7976, Test: 417.5128 [185.50], Avg: 166.9988 (0.267)
Ep: 439, Reward: 508.9869, Test: 519.1813 [264.69], Avg: 167.1976 (0.267)
Ep: 440, Reward: 541.0548, Test: 390.0657 [245.39], Avg: 167.1465 (0.266)
Ep: 441, Reward: 517.5082, Test: 544.3984 [216.75], Avg: 167.5096 (0.265)
Ep: 442, Reward: 552.2602, Test: 467.6875 [224.25], Avg: 167.6810 (0.264)
Ep: 443, Reward: 472.6552, Test: 326.4326 [113.54], Avg: 167.7829 (0.263)
Ep: 444, Reward: 501.1126, Test: 490.8965 [217.15], Avg: 168.0210 (0.263)
Ep: 445, Reward: 552.1253, Test: 482.4631 [200.20], Avg: 168.2772 (0.262)
Ep: 446, Reward: 504.2647, Test: 466.1371 [167.69], Avg: 168.5684 (0.261)
Ep: 447, Reward: 507.5546, Test: 571.6701 [219.29], Avg: 168.9786 (0.260)
Ep: 448, Reward: 595.5368, Test: 357.9239 [160.72], Avg: 169.0415 (0.259)
Ep: 449, Reward: 480.0269, Test: 508.1203 [256.44], Avg: 169.2251 (0.259)
Ep: 450, Reward: 440.2754, Test: 400.8692 [169.68], Avg: 169.3625 (0.258)
Ep: 451, Reward: 552.3571, Test: 588.9186 [216.54], Avg: 169.8117 (0.257)
Ep: 452, Reward: 494.1731, Test: 428.9814 [182.35], Avg: 169.9813 (0.256)
Ep: 453, Reward: 623.1516, Test: 454.0981 [234.12], Avg: 170.0914 (0.256)
Ep: 454, Reward: 494.1320, Test: 459.4618 [134.57], Avg: 170.4316 (0.255)
Ep: 455, Reward: 553.7982, Test: 441.4043 [227.24], Avg: 170.5275 (0.254)
Ep: 456, Reward: 597.5921, Test: 507.4925 [223.47], Avg: 170.7758 (0.253)
Ep: 457, Reward: 593.2047, Test: 582.9162 [189.84], Avg: 171.2612 (0.253)
Ep: 458, Reward: 557.8979, Test: 507.7805 [232.35], Avg: 171.4882 (0.252)
Ep: 459, Reward: 559.7707, Test: 474.9538 [174.58], Avg: 171.7684 (0.251)
Ep: 460, Reward: 645.1206, Test: 532.1980 [214.10], Avg: 172.0858 (0.250)
Ep: 461, Reward: 664.3480, Test: 567.1884 [184.63], Avg: 172.5413 (0.250)
Ep: 462, Reward: 511.4908, Test: 484.9702 [201.70], Avg: 172.7805 (0.249)
Ep: 463, Reward: 627.7501, Test: 495.6927 [194.15], Avg: 173.0580 (0.248)
Ep: 464, Reward: 610.9137, Test: 421.9862 [148.28], Avg: 173.2744 (0.247)
Ep: 465, Reward: 575.8034, Test: 462.5543 [116.25], Avg: 173.6457 (0.247)
Ep: 466, Reward: 558.4976, Test: 492.0712 [222.50], Avg: 173.8512 (0.246)
Ep: 467, Reward: 522.5106, Test: 504.4975 [225.94], Avg: 174.0749 (0.245)
Ep: 468, Reward: 671.1986, Test: 341.3705 [139.29], Avg: 174.1346 (0.244)
Ep: 469, Reward: 661.2246, Test: 420.6951 [270.13], Avg: 174.0845 (0.244)
Ep: 470, Reward: 542.3390, Test: 451.7343 [214.61], Avg: 174.2183 (0.243)
Ep: 471, Reward: 539.5059, Test: 596.0153 [227.73], Avg: 174.6295 (0.242)
Ep: 472, Reward: 571.0803, Test: 362.3358 [241.51], Avg: 174.5157 (0.241)
Ep: 473, Reward: 631.3376, Test: 408.8204 [222.93], Avg: 174.5397 (0.241)
Ep: 474, Reward: 519.9508, Test: 449.7681 [219.26], Avg: 174.6575 (0.240)
Ep: 475, Reward: 578.6268, Test: 482.4676 [194.59], Avg: 174.8954 (0.239)
Ep: 476, Reward: 524.3172, Test: 439.8089 [220.45], Avg: 174.9886 (0.239)
Ep: 477, Reward: 540.6344, Test: 427.6068 [225.94], Avg: 175.0444 (0.238)
Ep: 478, Reward: 519.2988, Test: 421.2667 [246.48], Avg: 175.0439 (0.237)
Ep: 479, Reward: 472.2008, Test: 460.1504 [222.43], Avg: 175.1745 (0.236)
Ep: 480, Reward: 589.6973, Test: 428.9081 [256.73], Avg: 175.1682 (0.236)
Ep: 481, Reward: 477.8516, Test: 442.0189 [194.97], Avg: 175.3174 (0.235)
Ep: 482, Reward: 512.0424, Test: 513.5207 [271.06], Avg: 175.4564 (0.234)
Ep: 483, Reward: 555.7032, Test: 423.7038 [164.76], Avg: 175.6289 (0.234)
Ep: 484, Reward: 495.8644, Test: 339.4892 [107.75], Avg: 175.7446 (0.233)
Ep: 485, Reward: 414.1809, Test: 526.3719 [205.93], Avg: 176.0423 (0.232)
Ep: 486, Reward: 439.7229, Test: 460.6277 [227.91], Avg: 176.1587 (0.231)
Ep: 487, Reward: 578.2975, Test: 402.1903 [131.62], Avg: 176.3521 (0.231)
Ep: 488, Reward: 533.7334, Test: 424.7554 [225.37], Avg: 176.3992 (0.230)
Ep: 489, Reward: 570.1053, Test: 274.7996 [76.93], Avg: 176.4431 (0.229)
Ep: 490, Reward: 483.6384, Test: 384.3635 [169.70], Avg: 176.5209 (0.229)
Ep: 491, Reward: 438.7343, Test: 501.1327 [213.59], Avg: 176.7465 (0.228)
Ep: 492, Reward: 430.2231, Test: 503.2528 [190.36], Avg: 177.0227 (0.227)
Ep: 493, Reward: 583.2283, Test: 493.1563 [141.88], Avg: 177.3754 (0.227)
Ep: 494, Reward: 585.1278, Test: 482.4827 [163.32], Avg: 177.6619 (0.226)
Ep: 495, Reward: 592.2593, Test: 426.7517 [223.50], Avg: 177.7135 (0.225)
Ep: 496, Reward: 521.1781, Test: 369.5048 [160.29], Avg: 177.7768 (0.225)
Ep: 497, Reward: 537.4363, Test: 403.7158 [225.84], Avg: 177.7770 (0.224)
Ep: 498, Reward: 621.1325, Test: 372.6189 [125.69], Avg: 177.9156 (0.223)
Ep: 499, Reward: 502.5559, Test: 391.0523 [192.50], Avg: 177.9569 (0.223)
