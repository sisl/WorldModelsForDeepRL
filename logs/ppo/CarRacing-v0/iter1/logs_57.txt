Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.1				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages) + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss.mean())
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((len(self.replay_buffer)*PPO_EPOCHS)//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -39.2232, Test: -62.5358 [4.78], Avg: -67.3109 (0.997)
Ep: 1, Reward: -68.3982, Test: -50.1647 [12.72], Avg: -65.0958 (0.994)
Ep: 2, Reward: -63.4396, Test: -71.7756 [7.11], Avg: -69.6940 (0.991)
Ep: 3, Reward: -62.2080, Test: -58.9219 [10.26], Avg: -69.5657 (0.988)
Ep: 4, Reward: -56.7744, Test: -59.3398 [6.06], Avg: -68.7318 (0.985)
Ep: 5, Reward: -58.2043, Test: -47.6787 [25.70], Avg: -69.5060 (0.982)
Ep: 6, Reward: -16.2687, Test: 29.0676 [83.75], Avg: -67.3887 (0.979)
Ep: 7, Reward: 52.5564, Test: 171.2928 [109.70], Avg: -51.2654 (0.976)
Ep: 8, Reward: 282.2539, Test: 457.3873 [119.87], Avg: -8.0670 (0.973)
Ep: 9, Reward: 470.0668, Test: 721.5745 [180.37], Avg: 46.8597 (0.970)
Ep: 10, Reward: 723.1914, Test: 658.4823 [117.44], Avg: 91.7855 (0.967)
Ep: 11, Reward: 278.4902, Test: 287.5840 [115.51], Avg: 98.4762 (0.965)
Ep: 12, Reward: 237.4122, Test: 403.3433 [182.68], Avg: 107.8754 (0.962)
Ep: 13, Reward: 368.7088, Test: 326.3875 [140.35], Avg: 113.4586 (0.959)
Ep: 14, Reward: 227.0793, Test: 268.5267 [180.46], Avg: 111.7658 (0.956)
Ep: 15, Reward: 213.8376, Test: 266.5626 [161.67], Avg: 111.3366 (0.953)
Ep: 16, Reward: 237.0094, Test: 219.2474 [75.19], Avg: 113.2611 (0.950)
Ep: 17, Reward: 335.0987, Test: 301.1894 [206.67], Avg: 112.2201 (0.947)
Ep: 18, Reward: 250.4760, Test: 297.4672 [168.46], Avg: 113.1037 (0.945)
Ep: 19, Reward: 489.6003, Test: 394.2034 [131.14], Avg: 120.6018 (0.942)
Ep: 20, Reward: 688.0170, Test: 689.7281 [173.73], Avg: 139.4304 (0.939)
Ep: 21, Reward: 702.3112, Test: 615.6112 [321.88], Avg: 146.4442 (0.936)
Ep: 22, Reward: 558.8003, Test: 729.7441 [141.84], Avg: 165.6383 (0.933)
Ep: 23, Reward: 705.4218, Test: 610.9551 [218.54], Avg: 175.0874 (0.930)
Ep: 24, Reward: 552.1822, Test: 568.7572 [242.98], Avg: 181.1150 (0.928)
Ep: 25, Reward: 745.1415, Test: 764.1238 [132.00], Avg: 198.4615 (0.925)
Ep: 26, Reward: 764.2918, Test: 698.6691 [117.15], Avg: 212.6489 (0.922)
Ep: 27, Reward: 854.6352, Test: 774.8838 [226.74], Avg: 224.6307 (0.919)
Ep: 28, Reward: 626.6224, Test: 540.1723 [283.10], Avg: 225.7493 (0.917)
Ep: 29, Reward: 687.1282, Test: 602.8495 [287.38], Avg: 228.7399 (0.914)
Ep: 30, Reward: 641.5076, Test: 463.0369 [198.86], Avg: 229.8830 (0.911)
Ep: 31, Reward: 498.9577, Test: 353.6400 [286.16], Avg: 224.8080 (0.908)
Ep: 32, Reward: 583.1167, Test: 690.4707 [182.88], Avg: 233.3772 (0.906)
Ep: 33, Reward: 728.7142, Test: 682.7497 [177.71], Avg: 241.3673 (0.903)
Ep: 34, Reward: 598.5562, Test: 783.2060 [137.41], Avg: 252.9225 (0.900)
Ep: 35, Reward: 782.9049, Test: 672.9176 [155.96], Avg: 260.2569 (0.897)
Ep: 36, Reward: 864.4196, Test: 734.9721 [135.34], Avg: 269.4292 (0.895)
Ep: 37, Reward: 667.6289, Test: 721.8548 [78.49], Avg: 279.2697 (0.892)
Ep: 38, Reward: 811.7748, Test: 752.8005 [121.24], Avg: 288.3028 (0.889)
Ep: 39, Reward: 805.2440, Test: 857.1445 [57.87], Avg: 301.0770 (0.887)
Ep: 40, Reward: 726.0866, Test: 869.8709 [65.00], Avg: 313.3648 (0.884)
Ep: 41, Reward: 865.0801, Test: 819.1471 [95.29], Avg: 323.1385 (0.881)
Ep: 42, Reward: 800.8311, Test: 830.0556 [138.88], Avg: 331.6974 (0.879)
Ep: 43, Reward: 822.2750, Test: 590.9879 [280.54], Avg: 331.2145 (0.876)
Ep: 44, Reward: 825.7371, Test: 801.0169 [129.39], Avg: 338.7793 (0.874)
Ep: 45, Reward: 605.0488, Test: 632.8556 [138.35], Avg: 342.1647 (0.871)
Ep: 46, Reward: 620.2315, Test: 687.0993 [164.65], Avg: 346.0005 (0.868)
Ep: 47, Reward: 617.2287, Test: 721.8449 [158.55], Avg: 350.5274 (0.866)
Ep: 48, Reward: 638.8745, Test: 797.2310 [98.31], Avg: 357.6374 (0.863)
Ep: 49, Reward: 712.7899, Test: 715.3179 [142.98], Avg: 361.9313 (0.861)
Ep: 50, Reward: 631.1795, Test: 741.2633 [169.53], Avg: 366.0450 (0.858)
Ep: 51, Reward: 677.5929, Test: 602.2114 [195.41], Avg: 366.8288 (0.855)
Ep: 52, Reward: 663.1626, Test: 831.6921 [59.41], Avg: 374.4789 (0.853)
Ep: 53, Reward: 749.0795, Test: 725.7427 [139.83], Avg: 378.3942 (0.850)
Ep: 54, Reward: 625.0936, Test: 571.2243 [81.35], Avg: 380.4212 (0.848)
Ep: 55, Reward: 586.0544, Test: 719.2479 [54.43], Avg: 385.4998 (0.845)
Ep: 56, Reward: 682.0105, Test: 713.4500 [119.70], Avg: 389.1534 (0.843)
Ep: 57, Reward: 708.8067, Test: 760.1049 [159.95], Avg: 392.7914 (0.840)
Ep: 58, Reward: 684.0611, Test: 594.3369 [158.01], Avg: 393.5293 (0.838)
Ep: 59, Reward: 568.7680, Test: 532.9595 [157.78], Avg: 393.2234 (0.835)
Ep: 60, Reward: 412.6407, Test: 394.0916 [59.65], Avg: 392.2598 (0.833)
Ep: 61, Reward: 525.2089, Test: 440.5090 [133.14], Avg: 390.8906 (0.830)
Ep: 62, Reward: 295.4054, Test: 306.3768 [159.26], Avg: 387.0212 (0.828)
Ep: 63, Reward: 374.6615, Test: 408.0372 [192.45], Avg: 384.3425 (0.825)
Ep: 64, Reward: 433.0824, Test: 356.8890 [200.31], Avg: 380.8384 (0.823)
Ep: 65, Reward: 416.8536, Test: 435.1550 [233.63], Avg: 378.1215 (0.820)
Ep: 66, Reward: 500.6597, Test: 380.9359 [111.81], Avg: 376.4947 (0.818)
Ep: 67, Reward: 526.7534, Test: 350.7282 [135.21], Avg: 374.1274 (0.815)
Ep: 68, Reward: 473.4843, Test: 799.3397 [127.68], Avg: 378.4394 (0.813)
Ep: 69, Reward: 762.4967, Test: 779.0126 [107.16], Avg: 382.6311 (0.810)
Ep: 70, Reward: 801.7720, Test: 773.0112 [136.77], Avg: 386.2030 (0.808)
Ep: 71, Reward: 737.7265, Test: 653.5677 [143.75], Avg: 387.9200 (0.805)
Ep: 72, Reward: 699.6342, Test: 686.4687 [86.51], Avg: 390.8246 (0.803)
Ep: 73, Reward: 742.5880, Test: 724.5460 [70.44], Avg: 394.3824 (0.801)
Ep: 74, Reward: 570.8851, Test: 716.0923 [96.04], Avg: 397.3913 (0.798)
Ep: 75, Reward: 623.3127, Test: 614.9555 [69.18], Avg: 399.3436 (0.796)
Ep: 76, Reward: 632.9899, Test: 658.1599 [62.51], Avg: 401.8930 (0.793)
Ep: 77, Reward: 564.5983, Test: 655.7721 [107.32], Avg: 403.7719 (0.791)
Ep: 78, Reward: 622.0829, Test: 656.4300 [153.13], Avg: 405.0318 (0.789)
Ep: 79, Reward: 630.5886, Test: 756.1614 [99.03], Avg: 408.1831 (0.786)
Ep: 80, Reward: 757.1789, Test: 812.4623 [49.61], Avg: 412.5617 (0.784)
Ep: 81, Reward: 724.4676, Test: 738.5474 [111.73], Avg: 415.1745 (0.782)
Ep: 82, Reward: 651.3680, Test: 736.9230 [82.20], Avg: 418.0607 (0.779)
Ep: 83, Reward: 703.0594, Test: 711.6575 [82.60], Avg: 420.5726 (0.777)
Ep: 84, Reward: 683.2928, Test: 695.0487 [48.38], Avg: 423.2325 (0.775)
Ep: 85, Reward: 663.6423, Test: 694.7610 [41.22], Avg: 425.9106 (0.772)
Ep: 86, Reward: 747.9847, Test: 751.3107 [177.00], Avg: 427.6163 (0.770)
Ep: 87, Reward: 672.7492, Test: 682.8108 [195.19], Avg: 428.2982 (0.768)
Ep: 88, Reward: 787.2656, Test: 824.9955 [155.39], Avg: 431.0095 (0.765)
Ep: 89, Reward: 665.6649, Test: 611.1369 [234.25], Avg: 430.4081 (0.763)
Ep: 90, Reward: 583.0527, Test: 617.4567 [243.38], Avg: 429.7890 (0.761)
Ep: 91, Reward: 667.7650, Test: 549.0384 [276.63], Avg: 428.0783 (0.758)
Ep: 92, Reward: 533.1513, Test: 695.1729 [206.55], Avg: 428.7293 (0.756)
Ep: 93, Reward: 714.5661, Test: 785.7730 [153.67], Avg: 430.8928 (0.754)
Ep: 94, Reward: 630.0078, Test: 686.1160 [174.09], Avg: 431.7469 (0.752)
Ep: 95, Reward: 643.1246, Test: 580.5495 [244.45], Avg: 430.7505 (0.749)
Ep: 96, Reward: 713.0199, Test: 577.8317 [178.58], Avg: 430.4257 (0.747)
Ep: 97, Reward: 552.5019, Test: 497.4425 [183.06], Avg: 429.2416 (0.745)
Ep: 98, Reward: 612.3205, Test: 310.5022 [175.41], Avg: 426.2704 (0.743)
Ep: 99, Reward: 570.8958, Test: 517.8286 [244.91], Avg: 424.7369 (0.740)
Ep: 100, Reward: 604.0997, Test: 546.9435 [262.30], Avg: 423.3498 (0.738)
Ep: 101, Reward: 697.6985, Test: 584.2931 [194.24], Avg: 423.0234 (0.736)
Ep: 102, Reward: 615.9806, Test: 506.0369 [187.66], Avg: 422.0074 (0.734)
Ep: 103, Reward: 591.2650, Test: 540.4900 [209.23], Avg: 421.1348 (0.732)
Ep: 104, Reward: 473.5985, Test: 495.7549 [241.46], Avg: 419.5458 (0.729)
Ep: 105, Reward: 546.8902, Test: 500.6424 [218.79], Avg: 418.2468 (0.727)
Ep: 106, Reward: 573.7468, Test: 629.3096 [135.86], Avg: 418.9496 (0.725)
Ep: 107, Reward: 543.9693, Test: 401.9893 [144.19], Avg: 417.4575 (0.723)
Ep: 108, Reward: 469.5439, Test: 514.2236 [254.03], Avg: 416.0147 (0.721)
Ep: 109, Reward: 608.0537, Test: 517.9933 [331.35], Avg: 413.9295 (0.719)
Ep: 110, Reward: 556.6897, Test: 465.0769 [147.93], Avg: 413.0575 (0.716)
Ep: 111, Reward: 542.2707, Test: 460.1134 [246.15], Avg: 411.2799 (0.714)
Ep: 112, Reward: 448.2398, Test: 391.6773 [242.30], Avg: 408.9622 (0.712)
Ep: 113, Reward: 525.7400, Test: 413.3956 [191.45], Avg: 407.3217 (0.710)
Ep: 114, Reward: 461.0769, Test: 492.6176 [220.48], Avg: 406.1461 (0.708)
Ep: 115, Reward: 410.9050, Test: 469.6350 [269.25], Avg: 404.3723 (0.706)
Ep: 116, Reward: 591.9332, Test: 427.5271 [213.50], Avg: 402.7454 (0.704)
Ep: 117, Reward: 514.5602, Test: 447.3031 [233.74], Avg: 401.1422 (0.702)
Ep: 118, Reward: 576.6093, Test: 713.5134 [196.01], Avg: 402.1200 (0.699)
Ep: 119, Reward: 551.9705, Test: 661.6097 [129.93], Avg: 403.1997 (0.697)
Ep: 120, Reward: 691.7586, Test: 560.1481 [201.25], Avg: 402.8336 (0.695)
Ep: 121, Reward: 661.5502, Test: 622.4092 [281.88], Avg: 402.3229 (0.693)
Ep: 122, Reward: 560.8197, Test: 669.8996 [192.07], Avg: 402.9368 (0.691)
Ep: 123, Reward: 607.8721, Test: 661.3658 [156.29], Avg: 403.7605 (0.689)
Ep: 124, Reward: 504.8605, Test: 495.3307 [292.64], Avg: 402.1519 (0.687)
Ep: 125, Reward: 655.7574, Test: 674.4448 [209.65], Avg: 402.6491 (0.685)
Ep: 126, Reward: 504.0609, Test: 462.1740 [293.57], Avg: 400.8063 (0.683)
Ep: 127, Reward: 591.1264, Test: 555.2353 [170.17], Avg: 400.6833 (0.681)
Ep: 128, Reward: 546.4824, Test: 578.1917 [224.19], Avg: 400.3215 (0.679)
Ep: 129, Reward: 444.2783, Test: 409.0463 [99.84], Avg: 399.6206 (0.677)
Ep: 130, Reward: 487.4084, Test: 507.5547 [168.09], Avg: 399.1614 (0.675)
Ep: 131, Reward: 434.0533, Test: 506.7456 [189.31], Avg: 398.5422 (0.673)
Ep: 132, Reward: 476.1310, Test: 457.8619 [161.87], Avg: 397.7712 (0.671)
Ep: 133, Reward: 537.5443, Test: 421.0495 [147.97], Avg: 396.8406 (0.669)
Ep: 134, Reward: 522.0745, Test: 552.5175 [191.90], Avg: 396.5723 (0.667)
Ep: 135, Reward: 506.4324, Test: 406.7510 [219.48], Avg: 395.0333 (0.665)
Ep: 136, Reward: 667.0395, Test: 488.4874 [259.44], Avg: 393.8217 (0.663)
Ep: 137, Reward: 652.5728, Test: 675.1367 [102.62], Avg: 395.1166 (0.661)
Ep: 138, Reward: 467.9221, Test: 528.0694 [130.01], Avg: 395.1378 (0.659)
Ep: 139, Reward: 631.4916, Test: 612.7921 [253.14], Avg: 394.8843 (0.657)
Ep: 140, Reward: 707.9641, Test: 491.4832 [213.78], Avg: 394.0532 (0.655)
Ep: 141, Reward: 628.4942, Test: 521.8849 [204.95], Avg: 393.5101 (0.653)
Ep: 142, Reward: 628.8786, Test: 765.1859 [127.30], Avg: 395.2191 (0.651)
Ep: 143, Reward: 752.1076, Test: 726.9042 [166.04], Avg: 396.3694 (0.649)
Ep: 144, Reward: 728.9087, Test: 764.6363 [116.19], Avg: 398.1079 (0.647)
Ep: 145, Reward: 725.8430, Test: 791.4711 [112.54], Avg: 400.0313 (0.645)
Ep: 146, Reward: 802.6502, Test: 720.2474 [170.74], Avg: 401.0481 (0.643)
Ep: 147, Reward: 703.3163, Test: 769.5508 [162.02], Avg: 402.4433 (0.641)
Ep: 148, Reward: 775.2614, Test: 833.5491 [96.09], Avg: 404.6918 (0.639)
Ep: 149, Reward: 711.1516, Test: 677.2486 [257.55], Avg: 404.7918 (0.637)
Ep: 150, Reward: 683.8942, Test: 722.7874 [160.48], Avg: 405.8349 (0.635)
Ep: 151, Reward: 694.8780, Test: 669.2825 [313.95], Avg: 405.5027 (0.633)
Ep: 152, Reward: 700.3606, Test: 740.9602 [158.83], Avg: 406.6572 (0.631)
Ep: 153, Reward: 780.5892, Test: 767.9162 [186.93], Avg: 407.7892 (0.630)
Ep: 154, Reward: 619.2354, Test: 760.8095 [117.39], Avg: 409.3094 (0.628)
Ep: 155, Reward: 732.5310, Test: 727.5358 [206.32], Avg: 410.0268 (0.626)
Ep: 156, Reward: 765.7238, Test: 660.3302 [227.82], Avg: 410.1700 (0.624)
Ep: 157, Reward: 758.8507, Test: 785.7321 [140.68], Avg: 411.6566 (0.622)
Ep: 158, Reward: 720.2510, Test: 647.8484 [210.17], Avg: 411.8203 (0.620)
Ep: 159, Reward: 810.4717, Test: 663.7927 [207.82], Avg: 412.0962 (0.618)
Ep: 160, Reward: 730.0216, Test: 789.6799 [127.27], Avg: 413.6509 (0.616)
Ep: 161, Reward: 674.4986, Test: 640.5527 [288.44], Avg: 413.2710 (0.615)
Ep: 162, Reward: 610.4218, Test: 677.8624 [186.97], Avg: 413.7472 (0.613)
Ep: 163, Reward: 643.8215, Test: 634.4873 [144.61], Avg: 414.2114 (0.611)
Ep: 164, Reward: 754.0298, Test: 720.6995 [139.43], Avg: 415.2239 (0.609)
Ep: 165, Reward: 580.1906, Test: 741.9960 [115.02], Avg: 416.4995 (0.607)
Ep: 166, Reward: 715.9169, Test: 745.4228 [82.93], Avg: 417.9726 (0.605)
Ep: 167, Reward: 773.7409, Test: 735.3846 [95.00], Avg: 419.2965 (0.604)
Ep: 168, Reward: 732.8818, Test: 785.9710 [148.28], Avg: 420.5887 (0.602)
Ep: 169, Reward: 761.8753, Test: 807.2726 [65.75], Avg: 422.4766 (0.600)
Ep: 170, Reward: 764.6090, Test: 750.9378 [181.75], Avg: 423.3345 (0.598)
Ep: 171, Reward: 770.3502, Test: 831.5938 [43.32], Avg: 425.4563 (0.596)
Ep: 172, Reward: 822.4558, Test: 793.9512 [50.49], Avg: 427.2944 (0.595)
Ep: 173, Reward: 819.1942, Test: 798.6422 [98.15], Avg: 428.8645 (0.593)
Ep: 174, Reward: 787.4699, Test: 879.7430 [24.89], Avg: 431.2987 (0.591)
Ep: 175, Reward: 854.9665, Test: 825.4639 [56.36], Avg: 433.2181 (0.589)
Ep: 176, Reward: 811.7444, Test: 784.4774 [152.65], Avg: 434.3402 (0.588)
Ep: 177, Reward: 848.7705, Test: 853.9754 [31.96], Avg: 436.5181 (0.586)
Ep: 178, Reward: 779.1332, Test: 814.5606 [77.93], Avg: 438.1947 (0.584)
Ep: 179, Reward: 859.6574, Test: 856.4187 [37.93], Avg: 440.3075 (0.582)
Ep: 180, Reward: 828.7280, Test: 815.5703 [85.07], Avg: 441.9108 (0.581)
Ep: 181, Reward: 731.7864, Test: 832.5341 [30.53], Avg: 443.8893 (0.579)
Ep: 182, Reward: 806.0080, Test: 770.5441 [70.55], Avg: 445.2888 (0.577)
Ep: 183, Reward: 839.3588, Test: 845.5102 [34.46], Avg: 447.2766 (0.575)
Ep: 184, Reward: 815.1381, Test: 843.1887 [40.32], Avg: 449.1988 (0.574)
Ep: 185, Reward: 758.5215, Test: 778.1039 [93.47], Avg: 450.4645 (0.572)
Ep: 186, Reward: 547.3751, Test: 506.6813 [191.12], Avg: 449.7431 (0.570)
Ep: 187, Reward: 528.1751, Test: 488.5260 [182.83], Avg: 448.9769 (0.568)
Ep: 188, Reward: 557.6485, Test: 550.0611 [160.69], Avg: 448.6616 (0.567)
Ep: 189, Reward: 504.4462, Test: 575.2218 [136.29], Avg: 448.6104 (0.565)
Ep: 190, Reward: 536.8389, Test: 610.7814 [194.42], Avg: 448.4415 (0.563)
Ep: 191, Reward: 628.6252, Test: 664.6699 [139.63], Avg: 448.8405 (0.562)
Ep: 192, Reward: 526.3227, Test: 724.9478 [188.64], Avg: 449.2937 (0.560)
Ep: 193, Reward: 636.6098, Test: 593.9235 [151.38], Avg: 449.2589 (0.558)
Ep: 194, Reward: 573.8462, Test: 559.2893 [218.02], Avg: 448.7051 (0.557)
Ep: 195, Reward: 628.4188, Test: 669.1944 [208.48], Avg: 448.7664 (0.555)
Ep: 196, Reward: 563.4355, Test: 629.4391 [168.39], Avg: 448.8287 (0.553)
Ep: 197, Reward: 599.0146, Test: 638.7901 [169.37], Avg: 448.9327 (0.552)
Ep: 198, Reward: 746.4844, Test: 642.6795 [220.01], Avg: 448.8007 (0.550)
Ep: 199, Reward: 736.1514, Test: 668.9287 [229.53], Avg: 448.7537 (0.548)
Ep: 200, Reward: 762.2712, Test: 774.7965 [110.34], Avg: 449.8268 (0.547)
Ep: 201, Reward: 690.2820, Test: 697.4283 [143.29], Avg: 450.3432 (0.545)
Ep: 202, Reward: 793.0572, Test: 815.6292 [120.11], Avg: 451.5510 (0.543)
Ep: 203, Reward: 776.1835, Test: 670.6048 [281.84], Avg: 451.2432 (0.542)
Ep: 204, Reward: 778.2360, Test: 672.3767 [205.26], Avg: 451.3206 (0.540)
Ep: 205, Reward: 722.3857, Test: 741.0880 [169.38], Avg: 451.9051 (0.539)
Ep: 206, Reward: 756.5593, Test: 718.5161 [218.12], Avg: 452.1393 (0.537)
Ep: 207, Reward: 749.3302, Test: 815.2890 [93.27], Avg: 453.4368 (0.535)
Ep: 208, Reward: 743.8199, Test: 842.0916 [56.87], Avg: 455.0243 (0.534)
Ep: 209, Reward: 881.4207, Test: 875.0241 [71.52], Avg: 456.6837 (0.532)
Ep: 210, Reward: 835.1976, Test: 866.2824 [86.50], Avg: 458.2150 (0.530)
Ep: 211, Reward: 808.7841, Test: 674.2968 [176.43], Avg: 458.4020 (0.529)
Ep: 212, Reward: 721.7493, Test: 604.7898 [344.25], Avg: 457.4731 (0.527)
Ep: 213, Reward: 773.2263, Test: 723.5616 [187.73], Avg: 457.8393 (0.526)
Ep: 214, Reward: 748.9597, Test: 613.5426 [322.28], Avg: 457.0645 (0.524)
Ep: 215, Reward: 863.6221, Test: 628.6832 [176.13], Avg: 457.0436 (0.523)
Ep: 216, Reward: 748.2182, Test: 824.0212 [115.51], Avg: 458.2024 (0.521)
Ep: 217, Reward: 807.3325, Test: 807.9522 [153.65], Avg: 459.1020 (0.519)
Ep: 218, Reward: 759.6469, Test: 668.8024 [274.22], Avg: 458.8074 (0.518)
Ep: 219, Reward: 836.8041, Test: 770.5641 [153.28], Avg: 459.5277 (0.516)
Ep: 220, Reward: 817.7951, Test: 835.6052 [76.37], Avg: 460.8839 (0.515)
Ep: 221, Reward: 807.4237, Test: 752.8135 [209.41], Avg: 461.2556 (0.513)
Ep: 222, Reward: 883.3994, Test: 797.7399 [135.09], Avg: 462.1587 (0.512)
Ep: 223, Reward: 695.0602, Test: 538.8725 [330.85], Avg: 461.0242 (0.510)
Ep: 224, Reward: 536.6213, Test: 420.3791 [150.15], Avg: 460.1762 (0.509)
Ep: 225, Reward: 401.8025, Test: 460.8606 [197.95], Avg: 459.3034 (0.507)
Ep: 226, Reward: 485.1058, Test: 421.6433 [195.35], Avg: 458.2769 (0.506)
Ep: 227, Reward: 538.8098, Test: 511.3638 [159.19], Avg: 457.8115 (0.504)
Ep: 228, Reward: 480.4435, Test: 428.5709 [158.30], Avg: 456.9926 (0.503)
Ep: 229, Reward: 454.8519, Test: 485.2721 [132.87], Avg: 456.5378 (0.501)
Ep: 230, Reward: 505.7887, Test: 388.0602 [215.50], Avg: 455.3085 (0.500)
Ep: 231, Reward: 496.6282, Test: 434.6337 [166.03], Avg: 454.5037 (0.498)
Ep: 232, Reward: 495.4454, Test: 604.5895 [135.60], Avg: 454.5658 (0.497)
Ep: 233, Reward: 546.3104, Test: 521.2183 [161.93], Avg: 454.1587 (0.495)
Ep: 234, Reward: 551.5112, Test: 423.3198 [183.87], Avg: 453.2450 (0.494)
Ep: 235, Reward: 505.3970, Test: 456.6789 [234.66], Avg: 452.2652 (0.492)
Ep: 236, Reward: 519.0522, Test: 470.3080 [172.02], Avg: 451.6155 (0.491)
Ep: 237, Reward: 446.3771, Test: 424.4826 [235.84], Avg: 450.5106 (0.489)
Ep: 238, Reward: 476.3711, Test: 519.3077 [220.03], Avg: 449.8778 (0.488)
Ep: 239, Reward: 456.6639, Test: 508.6609 [168.39], Avg: 449.4211 (0.486)
Ep: 240, Reward: 558.1227, Test: 445.3123 [148.37], Avg: 448.7884 (0.485)
Ep: 241, Reward: 414.6419, Test: 425.3516 [142.33], Avg: 448.1034 (0.483)
Ep: 242, Reward: 297.6734, Test: 270.6575 [50.68], Avg: 447.1646 (0.482)
Ep: 243, Reward: 250.4347, Test: 237.8681 [83.11], Avg: 445.9662 (0.480)
Ep: 244, Reward: 334.9897, Test: 370.1199 [91.31], Avg: 445.2840 (0.479)
Ep: 245, Reward: 318.3363, Test: 376.7754 [114.49], Avg: 444.5401 (0.478)
Ep: 246, Reward: 417.9308, Test: 346.0924 [211.09], Avg: 443.2869 (0.476)
Ep: 247, Reward: 472.6833, Test: 458.9518 [114.11], Avg: 442.8899 (0.475)
Ep: 248, Reward: 449.2683, Test: 518.1717 [140.59], Avg: 442.6277 (0.473)
Ep: 249, Reward: 436.8412, Test: 587.2610 [102.68], Avg: 442.7955 (0.472)
Ep: 250, Reward: 511.8836, Test: 476.7313 [140.95], Avg: 442.3691 (0.470)
Ep: 251, Reward: 594.5698, Test: 630.6921 [89.74], Avg: 442.7603 (0.469)
Ep: 252, Reward: 621.3571, Test: 590.6164 [106.67], Avg: 442.9231 (0.468)
Ep: 253, Reward: 669.8834, Test: 627.0908 [188.66], Avg: 442.9055 (0.466)
Ep: 254, Reward: 703.1154, Test: 719.6582 [87.84], Avg: 443.6463 (0.465)
Ep: 255, Reward: 556.8404, Test: 519.1227 [90.57], Avg: 443.5873 (0.463)
Ep: 256, Reward: 532.5450, Test: 588.0655 [147.05], Avg: 443.5773 (0.462)
Ep: 257, Reward: 661.1531, Test: 603.4117 [133.12], Avg: 443.6808 (0.461)
Ep: 258, Reward: 664.1464, Test: 651.3224 [154.04], Avg: 443.8878 (0.459)
Ep: 259, Reward: 597.2578, Test: 584.7616 [103.82], Avg: 444.0303 (0.458)
Ep: 260, Reward: 623.1221, Test: 609.3247 [68.80], Avg: 444.4000 (0.456)
Ep: 261, Reward: 595.2983, Test: 594.4715 [154.96], Avg: 444.3814 (0.455)
Ep: 262, Reward: 670.7465, Test: 625.5681 [151.24], Avg: 444.4952 (0.454)
Ep: 263, Reward: 670.4188, Test: 682.1444 [136.54], Avg: 444.8782 (0.452)
Ep: 264, Reward: 492.9973, Test: 422.5816 [111.09], Avg: 444.3748 (0.451)
Ep: 265, Reward: 598.0000, Test: 648.1515 [112.31], Avg: 444.7187 (0.450)
Ep: 266, Reward: 614.2954, Test: 535.9915 [143.51], Avg: 444.5231 (0.448)
Ep: 267, Reward: 549.4796, Test: 338.5473 [153.62], Avg: 443.5544 (0.447)
Ep: 268, Reward: 396.6426, Test: 411.1263 [164.08], Avg: 442.8239 (0.446)
Ep: 269, Reward: 451.4821, Test: 438.9177 [212.19], Avg: 442.0236 (0.444)
Ep: 270, Reward: 489.3762, Test: 419.8056 [187.84], Avg: 441.2484 (0.443)
Ep: 271, Reward: 474.7011, Test: 335.3231 [202.23], Avg: 440.1155 (0.442)
Ep: 272, Reward: 494.4894, Test: 395.7738 [87.31], Avg: 439.6333 (0.440)
Ep: 273, Reward: 411.0198, Test: 385.3915 [151.87], Avg: 438.8810 (0.439)
Ep: 274, Reward: 475.8298, Test: 443.5463 [128.69], Avg: 438.4301 (0.438)
Ep: 275, Reward: 514.7900, Test: 483.7039 [146.45], Avg: 438.0635 (0.436)
Ep: 276, Reward: 569.0504, Test: 386.6907 [124.08], Avg: 437.4301 (0.435)
Ep: 277, Reward: 427.8755, Test: 339.1565 [147.23], Avg: 436.5470 (0.434)
Ep: 278, Reward: 346.0551, Test: 457.5780 [245.56], Avg: 435.7422 (0.432)
Ep: 279, Reward: 354.6297, Test: 480.4191 [136.15], Avg: 435.4155 (0.431)
Ep: 280, Reward: 413.7447, Test: 328.7377 [178.27], Avg: 434.4015 (0.430)
Ep: 281, Reward: 342.9683, Test: 306.3012 [124.37], Avg: 433.5062 (0.429)
Ep: 282, Reward: 374.6705, Test: 410.8222 [146.57], Avg: 432.9081 (0.427)
Ep: 283, Reward: 406.3838, Test: 332.9267 [144.78], Avg: 432.0462 (0.426)
Ep: 284, Reward: 354.1267, Test: 348.9826 [133.89], Avg: 431.2850 (0.425)
Ep: 285, Reward: 401.7297, Test: 362.9598 [156.05], Avg: 430.5005 (0.423)
Ep: 286, Reward: 387.9180, Test: 254.0638 [133.33], Avg: 429.4211 (0.422)
Ep: 287, Reward: 245.4457, Test: 354.4276 [93.19], Avg: 428.8372 (0.421)
Ep: 288, Reward: 351.3291, Test: 375.5577 [107.17], Avg: 428.2820 (0.420)
Ep: 289, Reward: 357.4491, Test: 342.8121 [164.34], Avg: 427.4205 (0.418)
Ep: 290, Reward: 336.0920, Test: 254.2216 [169.32], Avg: 426.2435 (0.417)
Ep: 291, Reward: 262.0268, Test: 309.9819 [85.20], Avg: 425.5535 (0.416)
Ep: 292, Reward: 397.9093, Test: 361.5605 [151.37], Avg: 424.8185 (0.415)
Ep: 293, Reward: 336.7981, Test: 392.0823 [199.96], Avg: 424.0270 (0.413)
Ep: 294, Reward: 328.0268, Test: 322.0439 [129.33], Avg: 423.2429 (0.412)
Ep: 295, Reward: 218.2417, Test: 358.7999 [103.07], Avg: 422.6770 (0.411)
Ep: 296, Reward: 314.8490, Test: 437.4523 [222.34], Avg: 421.9781 (0.410)
Ep: 297, Reward: 305.1393, Test: 344.5253 [169.97], Avg: 421.1478 (0.408)
Ep: 298, Reward: 315.3307, Test: 349.5886 [143.49], Avg: 420.4286 (0.407)
Ep: 299, Reward: 269.7804, Test: 274.3355 [172.96], Avg: 419.3651 (0.406)
Ep: 300, Reward: 300.0214, Test: 214.8713 [120.03], Avg: 418.2869 (0.405)
Ep: 301, Reward: 252.2962, Test: 370.6785 [191.19], Avg: 417.4962 (0.404)
Ep: 302, Reward: 265.7914, Test: 236.6969 [204.48], Avg: 416.2246 (0.402)
Ep: 303, Reward: 376.0443, Test: 336.3325 [194.10], Avg: 415.3234 (0.401)
Ep: 304, Reward: 340.8072, Test: 366.7016 [168.13], Avg: 414.6127 (0.400)
Ep: 305, Reward: 434.7809, Test: 334.2697 [213.17], Avg: 413.6535 (0.399)
Ep: 306, Reward: 403.0258, Test: 502.0695 [180.19], Avg: 413.3546 (0.398)
Ep: 307, Reward: 365.0634, Test: 431.0741 [154.17], Avg: 412.9116 (0.396)
Ep: 308, Reward: 361.7308, Test: 432.8950 [169.10], Avg: 412.4290 (0.395)
Ep: 309, Reward: 385.0121, Test: 528.9865 [124.71], Avg: 412.4027 (0.394)
Ep: 310, Reward: 534.4766, Test: 504.7339 [139.01], Avg: 412.2526 (0.393)
Ep: 311, Reward: 513.0329, Test: 516.6882 [229.13], Avg: 411.8529 (0.392)
Ep: 312, Reward: 541.5836, Test: 392.1037 [91.26], Avg: 411.4983 (0.390)
Ep: 313, Reward: 415.3324, Test: 395.1600 [76.67], Avg: 411.2021 (0.389)
Ep: 314, Reward: 406.0155, Test: 342.5199 [153.11], Avg: 410.4980 (0.388)
Ep: 315, Reward: 374.1696, Test: 413.7697 [106.20], Avg: 410.1723 (0.387)
Ep: 316, Reward: 386.6156, Test: 387.6618 [119.63], Avg: 409.7239 (0.386)
Ep: 317, Reward: 358.1066, Test: 421.8545 [151.90], Avg: 409.2843 (0.385)
Ep: 318, Reward: 318.8038, Test: 354.3219 [141.96], Avg: 408.6670 (0.383)
Ep: 319, Reward: 323.0549, Test: 343.0382 [192.22], Avg: 407.8613 (0.382)
Ep: 320, Reward: 395.1475, Test: 413.7464 [118.75], Avg: 407.5096 (0.381)
Ep: 321, Reward: 384.8020, Test: 460.1642 [42.90], Avg: 407.5399 (0.380)
Ep: 322, Reward: 447.9684, Test: 454.1488 [136.57], Avg: 407.2614 (0.379)
Ep: 323, Reward: 387.7535, Test: 334.0522 [209.77], Avg: 406.3880 (0.378)
Ep: 324, Reward: 441.3872, Test: 506.4189 [128.91], Avg: 406.2992 (0.377)
Ep: 325, Reward: 455.5075, Test: 505.9652 [197.36], Avg: 405.9995 (0.376)
Ep: 326, Reward: 484.6490, Test: 385.3040 [254.80], Avg: 405.1570 (0.374)
Ep: 327, Reward: 570.2806, Test: 526.1599 [273.13], Avg: 404.6932 (0.373)
Ep: 328, Reward: 552.7498, Test: 591.1498 [304.55], Avg: 404.3342 (0.372)
Ep: 329, Reward: 703.4813, Test: 787.3942 [97.15], Avg: 405.2006 (0.371)
Ep: 330, Reward: 726.2845, Test: 740.1601 [196.52], Avg: 405.6189 (0.370)
Ep: 331, Reward: 789.5065, Test: 813.2921 [69.60], Avg: 406.6372 (0.369)
Ep: 332, Reward: 775.4060, Test: 769.0001 [90.27], Avg: 407.4543 (0.368)
Ep: 333, Reward: 750.8136, Test: 764.9804 [144.15], Avg: 408.0931 (0.367)
Ep: 334, Reward: 779.8875, Test: 669.9439 [174.13], Avg: 408.3550 (0.365)
Ep: 335, Reward: 713.7919, Test: 772.0469 [123.99], Avg: 409.0684 (0.364)
Ep: 336, Reward: 834.0119, Test: 787.5706 [153.38], Avg: 409.7364 (0.363)
Ep: 337, Reward: 814.9183, Test: 818.6012 [66.13], Avg: 410.7504 (0.362)
Ep: 338, Reward: 873.0284, Test: 768.2177 [164.26], Avg: 411.3203 (0.361)
Ep: 339, Reward: 829.7689, Test: 788.2105 [135.56], Avg: 412.0301 (0.360)
Ep: 340, Reward: 695.2371, Test: 760.2911 [127.66], Avg: 412.6770 (0.359)
Ep: 341, Reward: 744.9783, Test: 779.6735 [75.12], Avg: 413.5305 (0.358)
Ep: 342, Reward: 698.1352, Test: 709.9658 [138.96], Avg: 413.9896 (0.357)
Ep: 343, Reward: 739.4481, Test: 592.4586 [240.78], Avg: 413.8084 (0.356)
Ep: 344, Reward: 670.2902, Test: 730.4263 [239.13], Avg: 414.0331 (0.355)
Ep: 345, Reward: 738.2797, Test: 700.4280 [194.00], Avg: 414.3001 (0.354)
Ep: 346, Reward: 537.0355, Test: 684.8474 [191.73], Avg: 414.5272 (0.353)
Ep: 347, Reward: 744.2916, Test: 731.4451 [224.81], Avg: 414.7919 (0.351)
Ep: 348, Reward: 615.4612, Test: 597.3531 [279.03], Avg: 414.5155 (0.350)
Ep: 349, Reward: 617.9496, Test: 717.5301 [178.69], Avg: 414.8707 (0.349)
Ep: 350, Reward: 656.9912, Test: 829.6462 [35.77], Avg: 415.9505 (0.348)
Ep: 351, Reward: 783.0896, Test: 721.4174 [158.78], Avg: 416.3672 (0.347)
Ep: 352, Reward: 730.1972, Test: 719.4413 [150.96], Avg: 416.7981 (0.346)
Ep: 353, Reward: 723.0475, Test: 761.6510 [150.91], Avg: 417.3460 (0.345)
Ep: 354, Reward: 580.5500, Test: 775.9744 [106.97], Avg: 418.0549 (0.344)
Ep: 355, Reward: 758.9491, Test: 859.3405 [40.33], Avg: 419.1812 (0.343)
Ep: 356, Reward: 850.1222, Test: 670.8656 [230.71], Avg: 419.2399 (0.342)
Ep: 357, Reward: 847.3838, Test: 806.8534 [89.62], Avg: 420.0723 (0.341)
Ep: 358, Reward: 747.7542, Test: 783.0846 [106.96], Avg: 420.7856 (0.340)
Ep: 359, Reward: 747.9732, Test: 709.7452 [232.09], Avg: 420.9435 (0.339)
Ep: 360, Reward: 697.2726, Test: 739.4407 [161.79], Avg: 421.3776 (0.338)
Ep: 361, Reward: 725.3773, Test: 751.6276 [213.32], Avg: 421.7006 (0.337)
Ep: 362, Reward: 702.0638, Test: 646.1809 [208.42], Avg: 421.7449 (0.336)
Ep: 363, Reward: 741.8936, Test: 763.3596 [137.85], Avg: 422.3047 (0.335)
Ep: 364, Reward: 630.6208, Test: 700.7646 [130.26], Avg: 422.7107 (0.334)
Ep: 365, Reward: 698.0943, Test: 607.2628 [174.25], Avg: 422.7389 (0.333)
Ep: 366, Reward: 773.2575, Test: 723.0834 [148.09], Avg: 423.1537 (0.332)
Ep: 367, Reward: 779.6708, Test: 739.2373 [154.00], Avg: 423.5942 (0.331)
Ep: 368, Reward: 766.8546, Test: 747.1965 [185.04], Avg: 423.9697 (0.330)
Ep: 369, Reward: 800.8905, Test: 737.1573 [197.76], Avg: 424.2816 (0.329)
Ep: 370, Reward: 746.4462, Test: 761.7446 [133.14], Avg: 424.8324 (0.328)
Ep: 371, Reward: 770.9385, Test: 653.2871 [263.38], Avg: 424.7385 (0.327)
Ep: 372, Reward: 846.7209, Test: 882.3869 [24.99], Avg: 425.8984 (0.326)
Ep: 373, Reward: 831.5773, Test: 857.9703 [68.79], Avg: 426.8697 (0.325)
Ep: 374, Reward: 863.1943, Test: 842.4863 [138.47], Avg: 427.6088 (0.324)
Ep: 375, Reward: 847.0641, Test: 852.0986 [59.28], Avg: 428.5801 (0.323)
Ep: 376, Reward: 811.6898, Test: 823.2345 [100.27], Avg: 429.3610 (0.322)
Ep: 377, Reward: 852.8205, Test: 833.7561 [78.37], Avg: 430.2235 (0.321)
Ep: 378, Reward: 799.5299, Test: 734.9157 [164.75], Avg: 430.5927 (0.320)
Ep: 379, Reward: 343.7508, Test: 68.4187 [123.86], Avg: 429.3137 (0.319)
Ep: 380, Reward: 20.0799, Test: 39.5817 [115.09], Avg: 427.9887 (0.318)
Ep: 381, Reward: 91.4608, Test: 108.4539 [162.37], Avg: 426.7272 (0.317)
Ep: 382, Reward: -4.5561, Test: 63.2973 [103.13], Avg: 425.5090 (0.316)
Ep: 383, Reward: 69.7931, Test: 49.1400 [89.57], Avg: 424.2956 (0.315)
Ep: 384, Reward: 33.2138, Test: 183.7190 [213.92], Avg: 423.1151 (0.315)
Ep: 385, Reward: 176.7942, Test: 100.9814 [129.39], Avg: 421.9454 (0.314)
Ep: 386, Reward: 66.4377, Test: 99.9311 [130.22], Avg: 420.7768 (0.313)
Ep: 387, Reward: 59.2714, Test: 133.2842 [158.07], Avg: 419.6284 (0.312)
Ep: 388, Reward: 73.9453, Test: 84.0624 [142.66], Avg: 418.3991 (0.311)
Ep: 389, Reward: 98.9739, Test: 159.4681 [188.91], Avg: 417.2508 (0.310)
Ep: 390, Reward: 111.2970, Test: 251.1542 [237.81], Avg: 416.2178 (0.309)
Ep: 391, Reward: 70.7094, Test: 140.2908 [231.60], Avg: 414.9231 (0.308)
Ep: 392, Reward: 188.5092, Test: 161.5915 [201.50], Avg: 413.7657 (0.307)
Ep: 393, Reward: 148.8404, Test: 237.2673 [179.22], Avg: 412.8629 (0.306)
Ep: 394, Reward: 113.9444, Test: 246.0212 [155.24], Avg: 412.0475 (0.305)
Ep: 395, Reward: 180.6693, Test: 159.9227 [157.62], Avg: 411.0128 (0.304)
Ep: 396, Reward: 253.0145, Test: 397.5022 [253.55], Avg: 410.3401 (0.303)
Ep: 397, Reward: 220.1840, Test: 222.1723 [193.67], Avg: 409.3807 (0.302)
Ep: 398, Reward: 194.1020, Test: 262.3047 [217.06], Avg: 408.4681 (0.302)
Ep: 399, Reward: 154.5290, Test: 162.6039 [99.09], Avg: 407.6057 (0.301)
Ep: 400, Reward: 163.2022, Test: 158.3746 [152.20], Avg: 406.6046 (0.300)
Ep: 401, Reward: 216.6606, Test: 267.2807 [221.29], Avg: 405.7075 (0.299)
Ep: 402, Reward: 293.0848, Test: 265.9263 [69.27], Avg: 405.1888 (0.298)
Ep: 403, Reward: 229.2954, Test: 223.9411 [174.78], Avg: 404.3075 (0.297)
Ep: 404, Reward: 213.3595, Test: 292.1529 [235.78], Avg: 403.4484 (0.296)
Ep: 405, Reward: 235.3314, Test: 152.9788 [187.41], Avg: 402.3699 (0.295)
Ep: 406, Reward: 212.5077, Test: 229.4562 [169.88], Avg: 401.5277 (0.294)
Ep: 407, Reward: 288.5271, Test: 282.0709 [215.03], Avg: 400.7078 (0.294)
Ep: 408, Reward: 257.7908, Test: 257.1847 [175.53], Avg: 399.9278 (0.293)
Ep: 409, Reward: 258.5801, Test: 231.6331 [148.38], Avg: 399.1554 (0.292)
Ep: 410, Reward: 318.8297, Test: 225.7382 [68.67], Avg: 398.5664 (0.291)
Ep: 411, Reward: 184.2571, Test: 82.0240 [134.64], Avg: 397.4713 (0.290)
Ep: 412, Reward: 288.3579, Test: 208.3079 [131.30], Avg: 396.6953 (0.289)
Ep: 413, Reward: 162.8179, Test: 241.2293 [241.65], Avg: 395.7361 (0.288)
Ep: 414, Reward: 264.7193, Test: 179.0202 [133.90], Avg: 394.8913 (0.287)
Ep: 415, Reward: 362.5229, Test: 189.7022 [131.83], Avg: 394.0811 (0.287)
Ep: 416, Reward: 288.0141, Test: 213.9357 [113.29], Avg: 393.3774 (0.286)
Ep: 417, Reward: 275.7552, Test: 264.5965 [125.08], Avg: 392.7701 (0.285)
Ep: 418, Reward: 319.6991, Test: 247.1726 [234.92], Avg: 391.8620 (0.284)
Ep: 419, Reward: 231.0770, Test: 195.6757 [78.83], Avg: 391.2072 (0.283)
Ep: 420, Reward: 211.7856, Test: 435.9222 [295.66], Avg: 390.6111 (0.282)
Ep: 421, Reward: 248.2029, Test: 234.1418 [136.86], Avg: 389.9160 (0.281)
Ep: 422, Reward: 244.4852, Test: 445.4574 [207.40], Avg: 389.5570 (0.281)
Ep: 423, Reward: 241.6403, Test: 253.5531 [236.88], Avg: 388.6775 (0.280)
Ep: 424, Reward: 299.4166, Test: 272.2351 [135.72], Avg: 388.0842 (0.279)
Ep: 425, Reward: 259.7140, Test: 329.4921 [190.14], Avg: 387.5003 (0.278)
Ep: 426, Reward: 190.4831, Test: 344.7869 [234.89], Avg: 386.8502 (0.277)
Ep: 427, Reward: 201.8305, Test: 289.2048 [179.87], Avg: 386.2018 (0.276)
Ep: 428, Reward: 265.4324, Test: 306.6535 [244.55], Avg: 385.4463 (0.276)
Ep: 429, Reward: 293.8132, Test: 260.7525 [120.86], Avg: 384.8752 (0.275)
Ep: 430, Reward: 291.8395, Test: 287.9180 [249.19], Avg: 384.0721 (0.274)
Ep: 431, Reward: 307.4865, Test: 299.2123 [106.42], Avg: 383.6293 (0.273)
Ep: 432, Reward: 268.8028, Test: 194.6239 [130.11], Avg: 382.8924 (0.272)
Ep: 433, Reward: 210.9087, Test: 316.7205 [230.21], Avg: 382.2094 (0.271)
Ep: 434, Reward: 249.6477, Test: 253.5099 [140.61], Avg: 381.5903 (0.271)
Ep: 435, Reward: 287.4306, Test: 364.8483 [257.14], Avg: 380.9622 (0.270)
Ep: 436, Reward: 268.1499, Test: 261.2720 [144.84], Avg: 380.3568 (0.269)
Ep: 437, Reward: 243.7276, Test: 377.3690 [230.50], Avg: 379.8238 (0.268)
Ep: 438, Reward: 279.5623, Test: 230.0857 [74.05], Avg: 379.3140 (0.267)
Ep: 439, Reward: 341.9744, Test: 217.1693 [225.21], Avg: 378.4336 (0.267)
Ep: 440, Reward: 307.9744, Test: 247.8246 [223.89], Avg: 377.6298 (0.266)
Ep: 441, Reward: 316.4844, Test: 306.3767 [213.18], Avg: 376.9863 (0.265)
Ep: 442, Reward: 323.4127, Test: 255.3347 [73.91], Avg: 376.5448 (0.264)
Ep: 443, Reward: 216.1642, Test: 283.3049 [252.24], Avg: 375.7667 (0.263)
Ep: 444, Reward: 252.4461, Test: 141.6115 [92.42], Avg: 375.0328 (0.263)
Ep: 445, Reward: 337.7509, Test: 293.8525 [286.74], Avg: 374.2079 (0.262)
Ep: 446, Reward: 311.6363, Test: 256.4352 [174.48], Avg: 373.5541 (0.261)
Ep: 447, Reward: 378.6559, Test: 244.8048 [244.56], Avg: 372.7208 (0.260)
Ep: 448, Reward: 403.4271, Test: 189.8174 [103.69], Avg: 372.0825 (0.259)
Ep: 449, Reward: 320.4270, Test: 332.4598 [202.64], Avg: 371.5442 (0.259)
Ep: 450, Reward: 287.5135, Test: 334.1703 [234.86], Avg: 370.9405 (0.258)
Ep: 451, Reward: 379.0289, Test: 351.9243 [220.46], Avg: 370.4107 (0.257)
Ep: 452, Reward: 433.5425, Test: 344.8148 [224.62], Avg: 369.8584 (0.256)
Ep: 453, Reward: 310.3562, Test: 315.1461 [241.49], Avg: 369.2059 (0.256)
Ep: 454, Reward: 369.2911, Test: 261.0828 [216.98], Avg: 368.4914 (0.255)
Ep: 455, Reward: 423.4481, Test: 314.5229 [289.64], Avg: 367.7379 (0.254)
Ep: 456, Reward: 268.6128, Test: 440.6332 [210.06], Avg: 367.4377 (0.253)
Ep: 457, Reward: 285.2767, Test: 257.8020 [158.62], Avg: 366.8520 (0.253)
Ep: 458, Reward: 386.1958, Test: 369.2800 [209.80], Avg: 366.4003 (0.252)
Ep: 459, Reward: 449.2492, Test: 299.6050 [229.75], Avg: 365.7556 (0.251)
Ep: 460, Reward: 398.8752, Test: 404.3837 [245.03], Avg: 365.3079 (0.250)
Ep: 461, Reward: 404.4820, Test: 327.5605 [280.30], Avg: 364.6194 (0.250)
Ep: 462, Reward: 402.1937, Test: 445.5337 [257.08], Avg: 364.2390 (0.249)
Ep: 463, Reward: 307.7307, Test: 360.1497 [170.02], Avg: 363.8637 (0.248)
Ep: 464, Reward: 490.3770, Test: 474.8781 [279.72], Avg: 363.5009 (0.247)
Ep: 465, Reward: 388.1394, Test: 295.9607 [145.65], Avg: 363.0434 (0.247)
Ep: 466, Reward: 342.3720, Test: 433.4774 [167.48], Avg: 362.8356 (0.246)
Ep: 467, Reward: 384.1198, Test: 301.3505 [246.31], Avg: 362.1779 (0.245)
Ep: 468, Reward: 405.1159, Test: 256.9104 [145.16], Avg: 361.6440 (0.244)
Ep: 469, Reward: 328.7672, Test: 541.8833 [283.57], Avg: 361.4241 (0.244)
Ep: 470, Reward: 270.4912, Test: 252.3913 [276.77], Avg: 360.6050 (0.243)
Ep: 471, Reward: 278.4241, Test: 393.1255 [215.75], Avg: 360.2168 (0.242)
Ep: 472, Reward: 305.3792, Test: 255.5033 [232.97], Avg: 359.5028 (0.241)
Ep: 473, Reward: 286.5096, Test: 319.7923 [220.90], Avg: 358.9530 (0.241)
Ep: 474, Reward: 482.4480, Test: 352.4017 [240.72], Avg: 358.4325 (0.240)
Ep: 475, Reward: 261.7122, Test: 313.2163 [249.53], Avg: 357.8133 (0.239)
Ep: 476, Reward: 287.2064, Test: 406.2820 [281.84], Avg: 357.3240 (0.239)
Ep: 477, Reward: 399.5372, Test: 378.9950 [177.37], Avg: 356.9983 (0.238)
Ep: 478, Reward: 408.1202, Test: 337.8884 [291.91], Avg: 356.3490 (0.237)
Ep: 479, Reward: 328.7036, Test: 323.3478 [223.79], Avg: 355.8140 (0.236)
Ep: 480, Reward: 247.5294, Test: 455.9955 [195.71], Avg: 355.6154 (0.236)
Ep: 481, Reward: 341.5108, Test: 400.1892 [248.97], Avg: 355.1913 (0.235)
Ep: 482, Reward: 351.9534, Test: 347.7476 [235.93], Avg: 354.6875 (0.234)
Ep: 483, Reward: 298.3335, Test: 421.1469 [253.49], Avg: 354.3010 (0.234)
Ep: 484, Reward: 347.4507, Test: 408.4393 [267.06], Avg: 353.8620 (0.233)
Ep: 485, Reward: 322.9341, Test: 400.8417 [290.24], Avg: 353.3615 (0.232)
Ep: 486, Reward: 390.0483, Test: 480.8955 [268.63], Avg: 353.0718 (0.231)
Ep: 487, Reward: 357.2532, Test: 321.5714 [258.00], Avg: 352.4785 (0.231)
Ep: 488, Reward: 305.2992, Test: 360.2243 [296.55], Avg: 351.8879 (0.230)
Ep: 489, Reward: 327.9718, Test: 434.3937 [260.83], Avg: 351.5240 (0.229)
Ep: 490, Reward: 416.8642, Test: 387.4054 [197.74], Avg: 351.1944 (0.229)
Ep: 491, Reward: 339.7601, Test: 522.1277 [192.20], Avg: 351.1511 (0.228)
Ep: 492, Reward: 297.8123, Test: 301.5350 [227.68], Avg: 350.5886 (0.227)
Ep: 493, Reward: 334.2412, Test: 353.7988 [139.91], Avg: 350.3119 (0.227)
Ep: 494, Reward: 332.2056, Test: 392.7904 [314.07], Avg: 349.7633 (0.226)
Ep: 495, Reward: 539.6471, Test: 268.5686 [116.60], Avg: 349.3645 (0.225)
Ep: 496, Reward: 443.2772, Test: 388.0198 [348.22], Avg: 348.7416 (0.225)
Ep: 497, Reward: 355.2685, Test: 502.0847 [277.65], Avg: 348.4920 (0.224)
Ep: 498, Reward: 519.8124, Test: 401.0120 [212.07], Avg: 348.1723 (0.223)
Ep: 499, Reward: 328.3562, Test: 414.1590 [269.02], Avg: 347.7662 (0.223)
