Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 8					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.01			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.1				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(PPO_EPOCHS):
				for i in range(0, len(self.replay_buffer), BATCH_SIZE):
					state, action, log_prob, target, advantage = self.replay_buffer.index(BATCH_SIZE, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=32*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -28.9782, Test: -81.9037 [1.56], Avg: -83.4641 (0.997)
Ep: 1, Reward: -80.6906, Test: -103.6838 [35.68], Avg: -111.4143 (0.994)
Ep: 2, Reward: -70.4136, Test: -99.0056 [37.50], Avg: -119.7791 (0.991)
Ep: 3, Reward: -60.4953, Test: -72.6478 [4.28], Avg: -109.0662 (0.988)
Ep: 4, Reward: -58.0409, Test: -72.8285 [11.71], Avg: -104.1614 (0.985)
Ep: 5, Reward: -66.8682, Test: -32.4501 [30.08], Avg: -97.2221 (0.982)
Ep: 6, Reward: -3.1587, Test: 47.1867 [55.39], Avg: -84.5045 (0.979)
Ep: 7, Reward: 258.0445, Test: 492.0885 [185.23], Avg: -35.5839 (0.976)
Ep: 8, Reward: 376.0356, Test: 334.3120 [206.03], Avg: -17.3764 (0.973)
Ep: 9, Reward: 554.1172, Test: 295.7875 [177.48], Avg: -3.8078 (0.970)
Ep: 10, Reward: 477.9811, Test: 168.4098 [108.39], Avg: 1.9950 (0.967)
Ep: 11, Reward: 367.8505, Test: 165.8184 [134.14], Avg: 4.4688 (0.965)
Ep: 12, Reward: 366.2782, Test: 185.7394 [105.50], Avg: 10.2976 (0.962)
Ep: 13, Reward: 296.2769, Test: 136.7300 [82.90], Avg: 13.4072 (0.959)
Ep: 14, Reward: 306.1696, Test: 155.7431 [116.85], Avg: 15.1064 (0.956)
Ep: 15, Reward: 345.5305, Test: 322.9977 [119.88], Avg: 26.8573 (0.953)
Ep: 16, Reward: 281.6074, Test: 323.5120 [209.37], Avg: 31.9918 (0.950)
Ep: 17, Reward: 323.0656, Test: 226.3954 [127.73], Avg: 35.6961 (0.947)
Ep: 18, Reward: 235.0333, Test: 244.4548 [170.21], Avg: 37.7249 (0.945)
Ep: 19, Reward: 223.3551, Test: 115.0015 [104.08], Avg: 36.3846 (0.942)
Ep: 20, Reward: 261.7833, Test: 242.7888 [104.02], Avg: 41.2599 (0.939)
Ep: 21, Reward: 213.5327, Test: 102.8380 [97.13], Avg: 39.6438 (0.936)
Ep: 22, Reward: 233.5113, Test: 227.7780 [105.21], Avg: 43.2493 (0.930)
Ep: 23, Reward: 385.6094, Test: 364.5330 [174.42], Avg: 49.3685 (0.928)
Ep: 24, Reward: 390.1070, Test: 354.2183 [126.54], Avg: 56.5008 (0.925)
Ep: 25, Reward: 424.7028, Test: 276.7786 [132.25], Avg: 59.8866 (0.922)
Ep: 26, Reward: 212.9771, Test: 119.0805 [106.03], Avg: 58.1518 (0.919)
Ep: 27, Reward: 283.9724, Test: 288.2032 [96.64], Avg: 62.9166 (0.917)
Ep: 28, Reward: 371.6264, Test: 246.0329 [176.15], Avg: 63.1567 (0.914)
Ep: 29, Reward: 339.4643, Test: 333.9595 [185.05], Avg: 66.0152 (0.911)
Ep: 30, Reward: 465.9071, Test: 347.2478 [209.47], Avg: 68.3302 (0.908)
Ep: 31, Reward: 441.4347, Test: 358.6942 [145.43], Avg: 72.8594 (0.906)
Ep: 32, Reward: 394.7612, Test: 404.7877 [274.22], Avg: 74.6081 (0.903)
Ep: 33, Reward: 598.7275, Test: 355.3809 [300.40], Avg: 74.0309 (0.900)
Ep: 34, Reward: 616.3913, Test: 381.9313 [289.64], Avg: 74.5525 (0.897)
Ep: 35, Reward: 505.1007, Test: 617.8846 [242.82], Avg: 82.9001 (0.895)
Ep: 36, Reward: 613.6807, Test: 718.1957 [167.44], Avg: 95.5448 (0.892)
Ep: 37, Reward: 594.0629, Test: 768.9749 [161.17], Avg: 109.0252 (0.889)
Ep: 38, Reward: 658.5701, Test: 736.6073 [151.95], Avg: 121.2210 (0.887)
Ep: 39, Reward: 765.3749, Test: 764.0797 [197.13], Avg: 132.3643 (0.884)
Ep: 40, Reward: 725.7749, Test: 409.2550 [254.11], Avg: 132.9200 (0.881)
Ep: 41, Reward: 604.3128, Test: 493.6779 [262.52], Avg: 135.2589 (0.879)
Ep: 42, Reward: 511.0898, Test: 590.1164 [192.73], Avg: 141.3549 (0.876)
Ep: 43, Reward: 683.9187, Test: 605.0010 [186.24], Avg: 147.6596 (0.874)
Ep: 44, Reward: 723.0922, Test: 581.2860 [125.81], Avg: 154.5000 (0.871)
Ep: 45, Reward: 705.7371, Test: 570.8360 [214.77], Avg: 158.8819 (0.868)
Ep: 46, Reward: 672.8090, Test: 505.4473 [182.60], Avg: 162.3705 (0.866)
Ep: 47, Reward: 468.9919, Test: 396.5919 [183.94], Avg: 163.4180 (0.863)
Ep: 48, Reward: 413.7944, Test: 399.7084 [173.58], Avg: 164.6977 (0.861)
Ep: 49, Reward: 404.4783, Test: 403.0106 [204.50], Avg: 165.3740 (0.858)
Ep: 50, Reward: 392.2122, Test: 306.2287 [169.70], Avg: 164.8085 (0.855)
Ep: 51, Reward: 362.7134, Test: 379.4614 [83.58], Avg: 167.3292 (0.853)
Ep: 52, Reward: 396.0453, Test: 309.3505 [158.64], Avg: 167.0156 (0.850)
Ep: 53, Reward: 487.7876, Test: 332.7506 [155.68], Avg: 167.2019 (0.848)
Ep: 54, Reward: 454.1967, Test: 571.7813 [210.42], Avg: 170.7321 (0.845)
Ep: 55, Reward: 482.2252, Test: 573.1670 [176.07], Avg: 174.7744 (0.843)
Ep: 56, Reward: 518.4277, Test: 487.2197 [115.23], Avg: 178.2343 (0.840)
Ep: 57, Reward: 680.5323, Test: 715.3038 [179.26], Avg: 184.4034 (0.838)
Ep: 58, Reward: 684.2098, Test: 724.0411 [175.87], Avg: 190.5690 (0.835)
Ep: 59, Reward: 774.3565, Test: 653.0493 [198.93], Avg: 194.9615 (0.833)
Ep: 60, Reward: 698.4500, Test: 722.1671 [189.65], Avg: 200.4952 (0.830)
Ep: 61, Reward: 812.5345, Test: 798.9721 [136.29], Avg: 207.9498 (0.828)
Ep: 62, Reward: 804.8639, Test: 831.7557 [62.27], Avg: 216.8631 (0.825)
Ep: 63, Reward: 799.2835, Test: 815.8651 [85.70], Avg: 224.8835 (0.823)
Ep: 64, Reward: 683.8976, Test: 781.3536 [71.27], Avg: 232.3482 (0.820)
Ep: 65, Reward: 741.0571, Test: 747.6555 [163.69], Avg: 237.6757 (0.818)
Ep: 66, Reward: 753.3235, Test: 761.9910 [129.62], Avg: 243.5666 (0.815)
Ep: 67, Reward: 622.4657, Test: 677.6385 [210.16], Avg: 246.8595 (0.813)
Ep: 68, Reward: 655.0767, Test: 654.8496 [183.98], Avg: 250.1060 (0.810)
Ep: 69, Reward: 833.2248, Test: 699.5318 [183.52], Avg: 253.9047 (0.808)
Ep: 70, Reward: 628.8067, Test: 690.2972 [119.01], Avg: 258.3749 (0.805)
Ep: 71, Reward: 558.4501, Test: 525.0193 [191.56], Avg: 259.4177 (0.803)
Ep: 72, Reward: 563.8244, Test: 610.6387 [225.11], Avg: 261.1452 (0.801)
Ep: 73, Reward: 571.6627, Test: 619.2436 [189.77], Avg: 263.4199 (0.798)
Ep: 74, Reward: 624.7637, Test: 536.7004 [231.50], Avg: 263.9770 (0.796)
Ep: 75, Reward: 602.6547, Test: 462.7063 [181.13], Avg: 264.2086 (0.793)
Ep: 76, Reward: 458.8027, Test: 493.2934 [184.76], Avg: 264.7843 (0.791)
Ep: 77, Reward: 519.1597, Test: 386.1888 [181.89], Avg: 264.0089 (0.789)
Ep: 78, Reward: 373.0684, Test: 440.0867 [256.08], Avg: 262.9961 (0.786)
Ep: 79, Reward: 396.2897, Test: 418.9666 [177.38], Avg: 262.7285 (0.784)
Ep: 80, Reward: 418.0814, Test: 524.5934 [210.92], Avg: 263.3575 (0.782)
Ep: 81, Reward: 473.5595, Test: 618.7961 [194.67], Avg: 265.3181 (0.779)
Ep: 82, Reward: 492.1127, Test: 478.5437 [148.65], Avg: 266.0961 (0.777)
Ep: 83, Reward: 570.8484, Test: 543.9849 [240.12], Avg: 266.5458 (0.775)
Ep: 84, Reward: 496.3860, Test: 517.8124 [202.67], Avg: 267.1175 (0.772)
Ep: 85, Reward: 646.1559, Test: 669.5297 [221.84], Avg: 269.2172 (0.770)
Ep: 86, Reward: 605.5483, Test: 444.4316 [217.82], Avg: 268.7276 (0.768)
Ep: 87, Reward: 571.2425, Test: 561.9680 [207.48], Avg: 269.7021 (0.765)
Ep: 88, Reward: 609.6149, Test: 611.1660 [211.01], Avg: 271.1679 (0.763)
Ep: 89, Reward: 712.2354, Test: 642.6963 [270.35], Avg: 272.2921 (0.761)
Ep: 90, Reward: 799.8956, Test: 684.3717 [89.85], Avg: 275.8330 (0.758)
Ep: 91, Reward: 593.4149, Test: 613.6117 [43.32], Avg: 279.0337 (0.756)
Ep: 92, Reward: 460.5111, Test: 502.7535 [61.15], Avg: 280.7818 (0.754)
Ep: 93, Reward: 396.1444, Test: 334.9571 [59.92], Avg: 280.7207 (0.752)
Ep: 94, Reward: 300.3754, Test: 349.1027 [87.61], Avg: 280.5183 (0.749)
Ep: 95, Reward: 513.2722, Test: 550.8070 [60.45], Avg: 282.7041 (0.747)
Ep: 96, Reward: 403.1240, Test: 373.6404 [43.86], Avg: 283.1895 (0.745)
Ep: 97, Reward: 34.8280, Test: -26.5556 [15.21], Avg: 279.8736 (0.743)
Ep: 98, Reward: 50.4845, Test: -22.5131 [15.96], Avg: 276.6579 (0.740)
Ep: 99, Reward: -43.6042, Test: -48.4437 [17.94], Avg: 273.2275 (0.738)
Ep: 100, Reward: -80.4945, Test: -72.8792 [3.07], Avg: 269.7703 (0.736)
Ep: 101, Reward: -71.6849, Test: -64.9085 [8.40], Avg: 266.4068 (0.734)
Ep: 102, Reward: -64.6944, Test: -63.5556 [8.76], Avg: 263.1183 (0.732)
Ep: 103, Reward: -65.3302, Test: -65.9454 [6.90], Avg: 259.8879 (0.729)
Ep: 104, Reward: -60.9740, Test: -65.1610 [9.13], Avg: 256.7052 (0.727)
Ep: 105, Reward: -62.3318, Test: -65.7235 [9.04], Avg: 253.5782 (0.725)
Ep: 106, Reward: -62.9431, Test: -66.0775 [5.07], Avg: 250.5433 (0.723)
Ep: 107, Reward: -65.4012, Test: -69.2960 [6.26], Avg: 247.5239 (0.721)
Ep: 108, Reward: -71.3405, Test: -67.5571 [3.49], Avg: 244.6012 (0.719)
Ep: 109, Reward: -73.2548, Test: -91.8220 [2.52], Avg: 241.5199 (0.716)
Ep: 110, Reward: -88.7153, Test: -93.2303 [0.52], Avg: 238.4995 (0.714)
Ep: 111, Reward: -93.1794, Test: -93.0451 [0.58], Avg: 235.5341 (0.712)
Ep: 112, Reward: -93.2860, Test: -92.9516 [0.61], Avg: 232.6217 (0.710)
Ep: 113, Reward: -92.9730, Test: -93.1307 [0.36], Avg: 229.7611 (0.708)
Ep: 114, Reward: -93.2995, Test: -93.1842 [0.24], Avg: 226.9507 (0.706)
Ep: 115, Reward: -92.9538, Test: -93.2052 [0.29], Avg: 224.1883 (0.704)
Ep: 116, Reward: -93.0253, Test: -92.8704 [0.78], Avg: 221.4717 (0.702)
Ep: 117, Reward: -93.1259, Test: -93.3536 [0.50], Avg: 218.7995 (0.699)
Ep: 118, Reward: -93.3086, Test: -93.0407 [0.70], Avg: 216.1731 (0.697)
Ep: 119, Reward: -93.2220, Test: -93.3188 [0.35], Avg: 213.5911 (0.695)
Ep: 120, Reward: -92.4511, Test: -92.7497 [1.52], Avg: 211.0467 (0.693)
Ep: 121, Reward: -92.3517, Test: -92.3447 [1.98], Avg: 208.5437 (0.691)
Ep: 122, Reward: -93.1384, Test: -93.2043 [0.40], Avg: 206.0872 (0.689)
Ep: 123, Reward: -92.7651, Test: -93.2685 [0.43], Avg: 203.6696 (0.687)
Ep: 124, Reward: -93.2824, Test: -93.0272 [0.38], Avg: 201.2929 (0.685)
Ep: 125, Reward: -93.1467, Test: -93.0436 [0.53], Avg: 198.9527 (0.683)
Ep: 126, Reward: -93.2476, Test: -93.0455 [0.51], Avg: 196.6495 (0.681)
Ep: 127, Reward: -93.1395, Test: -92.7394 [0.67], Avg: 194.3835 (0.679)
Ep: 128, Reward: -93.0893, Test: -93.1381 [0.54], Avg: 192.1504 (0.677)
Ep: 129, Reward: -93.2746, Test: -93.1819 [0.33], Avg: 189.9531 (0.675)
Ep: 130, Reward: -93.2034, Test: -93.0835 [0.47], Avg: 187.7889 (0.673)
Ep: 131, Reward: -93.1585, Test: -93.2850 [0.58], Avg: 185.6551 (0.671)
Ep: 132, Reward: -93.2337, Test: -93.3834 [0.46], Avg: 183.5537 (0.669)
Ep: 133, Reward: -93.1637, Test: -93.0793 [0.44], Avg: 181.4860 (0.667)
Ep: 134, Reward: -93.1488, Test: -93.0206 [0.33], Avg: 179.4501 (0.665)
Ep: 135, Reward: -93.1021, Test: -93.1243 [0.54], Avg: 177.4419 (0.663)
Ep: 136, Reward: -93.1412, Test: -93.0936 [0.34], Avg: 175.4647 (0.661)
Ep: 137, Reward: -92.8163, Test: -93.0385 [0.71], Avg: 173.5139 (0.659)
Ep: 138, Reward: -92.9319, Test: -93.1536 [0.48], Avg: 171.5920 (0.657)
Ep: 139, Reward: -93.3749, Test: -93.4793 [0.58], Avg: 169.6944 (0.655)
Ep: 140, Reward: -92.9765, Test: -93.2651 [0.31], Avg: 167.8273 (0.653)
Ep: 141, Reward: -93.0840, Test: -93.1178 [0.29], Avg: 165.9876 (0.651)
Ep: 142, Reward: -92.9402, Test: -92.8789 [0.63], Avg: 164.1729 (0.649)
Ep: 143, Reward: -93.0605, Test: -93.0369 [0.62], Avg: 162.3825 (0.647)
Ep: 144, Reward: -93.2478, Test: -93.0854 [0.52], Avg: 160.6170 (0.645)
Ep: 145, Reward: -93.1591, Test: -93.1075 [0.57], Avg: 158.8753 (0.643)
Ep: 146, Reward: -93.2487, Test: -92.8732 [0.38], Avg: 157.1602 (0.641)
Ep: 147, Reward: -93.1561, Test: -93.4037 [0.72], Avg: 155.4623 (0.639)
Ep: 148, Reward: -93.1675, Test: -93.2169 [0.32], Avg: 153.7912 (0.637)
Ep: 149, Reward: -93.2250, Test: -93.2458 [0.45], Avg: 152.1413 (0.635)
Ep: 150, Reward: -93.2913, Test: -93.1075 [0.65], Avg: 150.5128 (0.633)
Ep: 151, Reward: -93.0824, Test: -93.0939 [0.38], Avg: 148.9076 (0.631)
Ep: 152, Reward: -93.1383, Test: -92.9834 [0.46], Avg: 147.3236 (0.630)
Ep: 153, Reward: -92.9853, Test: -93.0686 [0.46], Avg: 145.7596 (0.628)
Ep: 154, Reward: -92.9437, Test: -92.7903 [0.89], Avg: 144.2149 (0.626)
Ep: 155, Reward: -93.2176, Test: -93.3914 [0.47], Avg: 142.6888 (0.624)
Ep: 156, Reward: -92.9793, Test: -93.4230 [0.31], Avg: 141.1829 (0.622)
Ep: 157, Reward: -93.1644, Test: -93.1570 [0.23], Avg: 139.6982 (0.620)
Ep: 158, Reward: -93.2503, Test: -92.9761 [0.50], Avg: 138.2317 (0.618)
Ep: 159, Reward: -93.1568, Test: -92.7791 [0.66], Avg: 136.7838 (0.616)
Ep: 160, Reward: -93.2056, Test: -92.9658 [0.52], Avg: 135.3535 (0.615)
Ep: 161, Reward: -92.9897, Test: -92.8263 [0.33], Avg: 133.9430 (0.613)
Ep: 162, Reward: -93.1049, Test: -92.9323 [0.69], Avg: 132.5469 (0.611)
Ep: 163, Reward: -93.2098, Test: -93.0521 [0.64], Avg: 131.1674 (0.609)
Ep: 164, Reward: -92.5946, Test: -93.0752 [0.52], Avg: 129.8052 (0.607)
Ep: 165, Reward: -93.0540, Test: -93.1316 [0.64], Avg: 128.4584 (0.605)
Ep: 166, Reward: -93.2982, Test: -93.0779 [0.42], Avg: 127.1293 (0.604)
Ep: 167, Reward: -92.6200, Test: -92.9418 [0.49], Avg: 125.8165 (0.602)
Ep: 168, Reward: -93.0979, Test: -93.0577 [0.45], Avg: 124.5187 (0.600)
Ep: 169, Reward: -93.2020, Test: -93.3317 [0.36], Avg: 123.2351 (0.598)
Ep: 170, Reward: -93.1300, Test: -93.0729 [0.64], Avg: 121.9664 (0.596)
Ep: 171, Reward: -93.0494, Test: -93.2982 [0.37], Avg: 120.7127 (0.595)
Ep: 172, Reward: -93.0751, Test: -93.2539 [0.36], Avg: 119.4738 (0.593)
Ep: 173, Reward: -93.0980, Test: -93.0569 [0.35], Avg: 118.2504 (0.591)
Ep: 174, Reward: -92.7879, Test: -93.2697 [0.71], Avg: 117.0377 (0.589)
Ep: 175, Reward: -92.8166, Test: -93.3163 [0.60], Avg: 115.8390 (0.588)
Ep: 176, Reward: -92.8957, Test: -93.0857 [0.45], Avg: 114.6561 (0.586)
Ep: 177, Reward: -93.0485, Test: -93.2401 [0.48], Avg: 113.4855 (0.584)
Ep: 178, Reward: -93.0294, Test: -92.9076 [0.61], Avg: 112.3290 (0.582)
Ep: 179, Reward: -92.4749, Test: -93.0812 [0.37], Avg: 111.1858 (0.581)
Ep: 180, Reward: -93.1731, Test: -93.1653 [0.44], Avg: 110.0543 (0.579)
Ep: 181, Reward: -92.1366, Test: -92.8812 [0.32], Avg: 108.9375 (0.577)
Ep: 182, Reward: -92.3108, Test: -93.2900 [0.47], Avg: 107.8299 (0.575)
Ep: 183, Reward: -92.0490, Test: -92.9781 [0.34], Avg: 106.7368 (0.574)
Ep: 184, Reward: -92.2572, Test: -93.0607 [0.36], Avg: 105.6548 (0.572)
Ep: 185, Reward: -91.8528, Test: -92.5693 [1.65], Avg: 104.5802 (0.570)
Ep: 186, Reward: -92.4347, Test: -93.0323 [0.45], Avg: 103.5211 (0.568)
Ep: 187, Reward: -92.1356, Test: -92.9547 [0.50], Avg: 102.4733 (0.567)
Ep: 188, Reward: -91.1908, Test: -93.3372 [0.42], Avg: 101.4350 (0.565)
Ep: 189, Reward: -90.6410, Test: -93.2711 [0.53], Avg: 100.4075 (0.563)
Ep: 190, Reward: -87.7512, Test: -93.3907 [0.36], Avg: 99.3910 (0.562)
Ep: 191, Reward: -89.3697, Test: -93.2392 [0.41], Avg: 98.3856 (0.560)
Ep: 192, Reward: -90.4968, Test: -93.2196 [0.38], Avg: 97.3908 (0.558)
Ep: 193, Reward: -91.3762, Test: -93.0373 [0.63], Avg: 96.4060 (0.557)
Ep: 194, Reward: -89.3470, Test: -93.2368 [0.32], Avg: 95.4318 (0.555)
Ep: 195, Reward: -88.4053, Test: -93.1363 [0.43], Avg: 94.4675 (0.553)
Ep: 196, Reward: -88.4631, Test: -93.1049 [0.39], Avg: 93.5134 (0.552)
Ep: 197, Reward: -86.7223, Test: -93.3729 [0.39], Avg: 92.5675 (0.550)
Ep: 198, Reward: -87.5366, Test: -93.1958 [0.43], Avg: 91.6319 (0.548)
Ep: 199, Reward: -86.1547, Test: -92.8439 [0.54], Avg: 90.7068 (0.547)
Ep: 200, Reward: -86.4659, Test: -92.4483 [1.11], Avg: 89.7900 (0.545)
Ep: 201, Reward: -86.3802, Test: -92.8877 [0.99], Avg: 88.8808 (0.543)
Ep: 202, Reward: -85.8336, Test: -92.7385 [1.97], Avg: 87.9764 (0.542)
Ep: 203, Reward: -85.1572, Test: -93.0091 [0.34], Avg: 87.0876 (0.540)
Ep: 204, Reward: -85.7051, Test: -92.4796 [1.71], Avg: 86.2033 (0.539)
Ep: 205, Reward: -86.0121, Test: -91.4806 [2.28], Avg: 85.3297 (0.537)
Ep: 206, Reward: -85.3810, Test: -90.8362 [2.83], Avg: 84.4650 (0.535)
Ep: 207, Reward: -84.8284, Test: -87.2733 [3.87], Avg: 83.6207 (0.534)
Ep: 208, Reward: -83.6076, Test: -87.9439 [2.95], Avg: 82.7857 (0.532)
Ep: 209, Reward: -84.5232, Test: -83.6200 [4.94], Avg: 81.9698 (0.530)
Ep: 210, Reward: -83.3044, Test: -84.7221 [4.50], Avg: 81.1584 (0.529)
Ep: 211, Reward: -84.2184, Test: -82.2864 [3.32], Avg: 80.3718 (0.527)
Ep: 212, Reward: -81.7097, Test: -79.7451 [2.21], Avg: 79.6097 (0.526)
Ep: 213, Reward: -80.5984, Test: -80.9717 [3.34], Avg: 78.8437 (0.524)
Ep: 214, Reward: -78.4426, Test: -79.2237 [1.35], Avg: 78.1022 (0.523)
Ep: 215, Reward: -79.7369, Test: -80.0574 [2.23], Avg: 77.3597 (0.521)
Ep: 216, Reward: -78.7316, Test: -79.5547 [2.24], Avg: 76.6263 (0.519)
Ep: 217, Reward: -76.9099, Test: -78.7301 [2.44], Avg: 75.9024 (0.518)
Ep: 218, Reward: -77.1647, Test: -80.5243 [1.38], Avg: 75.1819 (0.516)
Ep: 219, Reward: -77.3096, Test: -79.6074 [2.69], Avg: 74.4660 (0.515)
Ep: 220, Reward: -77.2816, Test: -79.2867 [1.51], Avg: 73.7635 (0.513)
Ep: 221, Reward: -76.8273, Test: -79.7905 [1.53], Avg: 73.0649 (0.512)
Ep: 222, Reward: -77.4588, Test: -78.7492 [1.87], Avg: 72.3757 (0.510)
Ep: 223, Reward: -77.3189, Test: -80.2314 [1.10], Avg: 71.6896 (0.509)
Ep: 224, Reward: -78.1925, Test: -79.4444 [1.23], Avg: 71.0124 (0.507)
Ep: 225, Reward: -77.1771, Test: -78.8769 [0.91], Avg: 70.3451 (0.506)
Ep: 226, Reward: -77.9208, Test: -79.5793 [1.86], Avg: 69.6765 (0.504)
Ep: 227, Reward: -77.0648, Test: -79.6804 [1.40], Avg: 69.0152 (0.503)
Ep: 228, Reward: -77.1938, Test: -79.6966 [2.60], Avg: 68.3545 (0.501)
Ep: 229, Reward: -76.9225, Test: -80.0101 [1.61], Avg: 67.7024 (0.500)
Ep: 230, Reward: -77.3545, Test: -80.1940 [1.48], Avg: 67.0558 (0.498)
Ep: 231, Reward: -75.4750, Test: -79.1786 [1.73], Avg: 66.4180 (0.497)
Ep: 232, Reward: -76.6652, Test: -78.8369 [1.81], Avg: 65.7868 (0.495)
Ep: 233, Reward: -75.4778, Test: -78.9984 [1.64], Avg: 65.1611 (0.494)
Ep: 234, Reward: -74.6168, Test: -80.3460 [1.29], Avg: 64.5364 (0.492)
Ep: 235, Reward: -73.9609, Test: -78.0231 [2.01], Avg: 63.9238 (0.491)
Ep: 236, Reward: -75.0816, Test: -80.5450 [2.25], Avg: 63.3047 (0.489)
Ep: 237, Reward: -75.9849, Test: -80.0042 [1.13], Avg: 62.6979 (0.488)
Ep: 238, Reward: -75.1704, Test: -79.6432 [1.46], Avg: 62.0962 (0.486)
Ep: 239, Reward: -76.6916, Test: -79.7458 [1.70], Avg: 61.4981 (0.485)
Ep: 240, Reward: -74.5316, Test: -78.7123 [2.82], Avg: 60.9046 (0.483)
Ep: 241, Reward: -74.5541, Test: -77.1256 [2.86], Avg: 60.3224 (0.482)
Ep: 242, Reward: -74.4868, Test: -77.8189 [2.42], Avg: 59.7440 (0.480)
Ep: 243, Reward: -75.7572, Test: -78.8945 [1.78], Avg: 59.1685 (0.479)
Ep: 244, Reward: -74.4171, Test: -80.0623 [2.45], Avg: 58.5902 (0.478)
Ep: 245, Reward: -73.9663, Test: -79.6287 [2.57], Avg: 58.0179 (0.476)
Ep: 246, Reward: -75.3442, Test: -79.2245 [0.76], Avg: 57.4592 (0.475)
Ep: 247, Reward: -74.9718, Test: -77.4147 [2.67], Avg: 56.9046 (0.473)
Ep: 248, Reward: -77.0721, Test: -75.1681 [2.91], Avg: 56.3625 (0.472)
Ep: 249, Reward: -76.4752, Test: -78.0193 [2.19], Avg: 55.8162 (0.470)
Ep: 250, Reward: -74.5630, Test: -76.8923 [2.12], Avg: 55.2790 (0.469)
Ep: 251, Reward: -75.3163, Test: -75.3120 [2.65], Avg: 54.7503 (0.468)
Ep: 252, Reward: -75.7649, Test: -77.3411 [1.99], Avg: 54.2203 (0.466)
Ep: 253, Reward: -73.6604, Test: -76.0187 [1.46], Avg: 53.7018 (0.465)
Ep: 254, Reward: -74.3825, Test: -76.2478 [2.52], Avg: 53.1824 (0.463)
Ep: 255, Reward: -74.7372, Test: -73.0181 [3.49], Avg: 52.6758 (0.462)
Ep: 256, Reward: -76.3065, Test: -73.3905 [3.36], Avg: 52.1721 (0.461)
Ep: 257, Reward: -76.0135, Test: -72.6363 [2.55], Avg: 51.6785 (0.459)
Ep: 258, Reward: -76.8734, Test: -75.0045 [2.29], Avg: 51.1805 (0.458)
Ep: 259, Reward: -75.0619, Test: -76.1087 [2.09], Avg: 50.6829 (0.456)
Ep: 260, Reward: -76.3994, Test: -72.7006 [3.63], Avg: 50.1963 (0.455)
Ep: 261, Reward: -75.1458, Test: -74.1802 [3.45], Avg: 49.7084 (0.454)
Ep: 262, Reward: -73.8304, Test: -75.2664 [1.87], Avg: 49.2261 (0.452)
Ep: 263, Reward: -74.8689, Test: -76.1329 [2.13], Avg: 48.7432 (0.451)
Ep: 264, Reward: -74.8839, Test: -74.6127 [2.92], Avg: 48.2667 (0.450)
Ep: 265, Reward: -73.6935, Test: -74.4136 [3.21], Avg: 47.7934 (0.448)
Ep: 266, Reward: -73.8472, Test: -75.2911 [1.98], Avg: 47.3250 (0.447)
Ep: 267, Reward: -73.8734, Test: -76.8625 [2.42], Avg: 46.8526 (0.446)
Ep: 268, Reward: -73.9361, Test: -76.3321 [2.67], Avg: 46.3847 (0.444)
Ep: 269, Reward: -73.7895, Test: -76.1962 [3.30], Avg: 45.9185 (0.443)
Ep: 270, Reward: -73.3507, Test: -77.6907 [2.80], Avg: 45.4521 (0.442)
Ep: 271, Reward: -74.0005, Test: -76.2124 [2.69], Avg: 44.9949 (0.440)
Ep: 272, Reward: -74.0116, Test: -76.0317 [1.87], Avg: 44.5447 (0.439)
Ep: 273, Reward: -75.1528, Test: -77.5239 [2.27], Avg: 44.0909 (0.438)
Ep: 274, Reward: -73.9674, Test: -77.2200 [2.37], Avg: 43.6411 (0.436)
Ep: 275, Reward: -74.2438, Test: -75.6731 [2.40], Avg: 43.2001 (0.435)
Ep: 276, Reward: -74.5189, Test: -76.7410 [2.09], Avg: 42.7596 (0.434)
Ep: 277, Reward: -75.3356, Test: -75.7973 [3.18], Avg: 42.3217 (0.432)
Ep: 278, Reward: -74.7318, Test: -73.3705 [1.96], Avg: 41.9000 (0.431)
Ep: 279, Reward: -72.8271, Test: -74.9319 [2.20], Avg: 41.4749 (0.430)
Ep: 280, Reward: -73.7086, Test: -74.8137 [2.90], Avg: 41.0507 (0.429)
Ep: 281, Reward: -74.9377, Test: -77.9494 [2.54], Avg: 40.6197 (0.427)
Ep: 282, Reward: -74.0157, Test: -75.2285 [2.09], Avg: 40.2030 (0.426)
Ep: 283, Reward: -74.9975, Test: -74.2896 [2.85], Avg: 39.7898 (0.425)
Ep: 284, Reward: -75.0743, Test: -74.5906 [2.72], Avg: 39.3789 (0.423)
Ep: 285, Reward: -73.6130, Test: -74.9923 [3.00], Avg: 38.9685 (0.422)
Ep: 286, Reward: -75.0238, Test: -75.7564 [2.49], Avg: 38.5601 (0.421)
Ep: 287, Reward: -74.7444, Test: -76.0624 [2.46], Avg: 38.1536 (0.420)
Ep: 288, Reward: -74.8805, Test: -76.7547 [2.40], Avg: 37.7477 (0.418)
Ep: 289, Reward: -75.5004, Test: -73.9646 [3.86], Avg: 37.3492 (0.417)
Ep: 290, Reward: -75.2313, Test: -73.9219 [2.72], Avg: 36.9574 (0.416)
Ep: 291, Reward: -75.0592, Test: -75.1027 [4.39], Avg: 36.5586 (0.415)
Ep: 292, Reward: -76.7389, Test: -76.4015 [2.61], Avg: 36.1642 (0.413)
Ep: 293, Reward: -76.5182, Test: -76.0580 [3.89], Avg: 35.7693 (0.412)
Ep: 294, Reward: -74.4465, Test: -75.3687 [2.14], Avg: 35.3853 (0.411)
Ep: 295, Reward: -74.4390, Test: -75.7421 [2.36], Avg: 35.0019 (0.410)
Ep: 296, Reward: -75.2834, Test: -76.1262 [2.91], Avg: 34.6179 (0.408)
Ep: 297, Reward: -75.5761, Test: -73.2093 [2.76], Avg: 34.2468 (0.407)
Ep: 298, Reward: -73.4562, Test: -73.1330 [5.12], Avg: 33.8706 (0.406)
Ep: 299, Reward: -75.0586, Test: -73.0210 [1.52], Avg: 33.5092 (0.405)
Ep: 300, Reward: -73.1977, Test: -73.4719 [3.77], Avg: 33.1413 (0.404)
Ep: 301, Reward: -75.1636, Test: -71.4929 [4.60], Avg: 32.7796 (0.402)
Ep: 302, Reward: -74.1446, Test: -75.7968 [3.29], Avg: 32.4104 (0.401)
Ep: 303, Reward: -73.7924, Test: -75.7298 [2.56], Avg: 32.0462 (0.400)
Ep: 304, Reward: -74.5745, Test: -75.0729 [2.84], Avg: 31.6857 (0.399)
Ep: 305, Reward: -73.7422, Test: -73.8124 [4.24], Avg: 31.3271 (0.398)
Ep: 306, Reward: -74.1363, Test: -72.5857 [4.37], Avg: 30.9743 (0.396)
Ep: 307, Reward: -73.4096, Test: -72.1103 [3.86], Avg: 30.6271 (0.395)
Ep: 308, Reward: -73.2619, Test: -72.6340 [3.04], Avg: 30.2831 (0.394)
Ep: 309, Reward: -74.5896, Test: -73.1608 [2.72], Avg: 29.9407 (0.393)
Ep: 310, Reward: -75.7084, Test: -70.7856 [4.22], Avg: 29.6032 (0.392)
Ep: 311, Reward: -72.3576, Test: -72.0789 [2.43], Avg: 29.2695 (0.390)
Ep: 312, Reward: -73.4032, Test: -69.8451 [5.24], Avg: 28.9361 (0.389)
Ep: 313, Reward: -72.2744, Test: -69.4877 [3.30], Avg: 28.6122 (0.388)
Ep: 314, Reward: -72.1978, Test: -70.3661 [3.46], Avg: 28.2870 (0.387)
Ep: 315, Reward: -74.5888, Test: -71.6599 [2.69], Avg: 27.9622 (0.386)
Ep: 316, Reward: -74.7514, Test: -72.4383 [2.26], Avg: 27.6383 (0.385)
Ep: 317, Reward: -72.4418, Test: -70.8623 [5.32], Avg: 27.3118 (0.383)
Ep: 318, Reward: -72.8728, Test: -70.5098 [4.88], Avg: 26.9899 (0.382)
Ep: 319, Reward: -72.9473, Test: -68.9343 [4.00], Avg: 26.6776 (0.381)
Ep: 320, Reward: -72.5222, Test: -66.3435 [2.52], Avg: 26.3800 (0.380)
Ep: 321, Reward: -73.7447, Test: -71.1101 [2.33], Avg: 26.0700 (0.379)
Ep: 322, Reward: -71.0529, Test: -70.7772 [5.15], Avg: 25.7542 (0.378)
Ep: 323, Reward: -72.3929, Test: -71.3392 [4.20], Avg: 25.4415 (0.377)
Ep: 324, Reward: -71.5967, Test: -69.3140 [3.02], Avg: 25.1407 (0.376)
Ep: 325, Reward: -70.5999, Test: -71.5366 [3.46], Avg: 24.8335 (0.374)
Ep: 326, Reward: -71.6255, Test: -67.3984 [6.24], Avg: 24.5324 (0.373)
Ep: 327, Reward: -70.7637, Test: -69.8019 [3.72], Avg: 24.2334 (0.372)
Ep: 328, Reward: -70.9152, Test: -65.6007 [6.08], Avg: 23.9419 (0.371)
Ep: 329, Reward: -71.8151, Test: -63.8033 [5.97], Avg: 23.6579 (0.370)
Ep: 330, Reward: -68.4053, Test: -65.0188 [6.49], Avg: 23.3704 (0.369)
Ep: 331, Reward: -70.2083, Test: -61.9020 [4.29], Avg: 23.1007 (0.368)
Ep: 332, Reward: -67.6947, Test: -63.6183 [7.63], Avg: 22.8173 (0.367)
Ep: 333, Reward: -69.1394, Test: -63.9590 [5.23], Avg: 22.5418 (0.365)
Ep: 334, Reward: -67.1590, Test: -65.0005 [5.32], Avg: 22.2646 (0.364)
Ep: 335, Reward: -67.7876, Test: -59.5496 [6.01], Avg: 22.0032 (0.363)
Ep: 336, Reward: -66.6523, Test: -62.4505 [6.19], Avg: 21.7343 (0.362)
Ep: 337, Reward: -66.6777, Test: -63.1018 [8.02], Avg: 21.4596 (0.361)
Ep: 338, Reward: -67.2276, Test: -59.4186 [6.23], Avg: 21.2026 (0.360)
Ep: 339, Reward: -66.2804, Test: -61.2510 [4.78], Avg: 20.9460 (0.359)
Ep: 340, Reward: -66.5680, Test: -58.8659 [5.58], Avg: 20.6956 (0.358)
Ep: 341, Reward: -63.3321, Test: -59.7332 [8.99], Avg: 20.4341 (0.357)
Ep: 342, Reward: -67.5079, Test: -57.2025 [8.76], Avg: 20.1823 (0.356)
Ep: 343, Reward: -61.9449, Test: -53.7670 [7.63], Avg: 19.9451 (0.355)
Ep: 344, Reward: -63.5075, Test: -54.7355 [9.51], Avg: 19.7011 (0.354)
Ep: 345, Reward: -64.1870, Test: -46.1437 [16.37], Avg: 19.4635 (0.353)
Ep: 346, Reward: -61.3213, Test: -44.2555 [13.17], Avg: 19.2419 (0.351)
Ep: 347, Reward: -56.1174, Test: -48.1097 [24.95], Avg: 18.9767 (0.350)
Ep: 348, Reward: -60.8031, Test: -54.9913 [6.47], Avg: 18.7462 (0.349)
Ep: 349, Reward: -60.8932, Test: -49.7992 [7.50], Avg: 18.5289 (0.348)
Ep: 350, Reward: -57.4413, Test: -45.0848 [12.95], Avg: 18.3108 (0.347)
Ep: 351, Reward: -52.8454, Test: -40.4885 [16.54], Avg: 18.0968 (0.346)
Ep: 352, Reward: -51.5215, Test: -42.7501 [14.20], Avg: 17.8842 (0.345)
Ep: 353, Reward: -56.4188, Test: -55.3242 [6.86], Avg: 17.6580 (0.344)
Ep: 354, Reward: -52.5740, Test: -36.5562 [17.07], Avg: 17.4572 (0.343)
Ep: 355, Reward: -48.6135, Test: -48.6529 [7.15], Avg: 17.2514 (0.342)
Ep: 356, Reward: -58.6521, Test: -36.8028 [12.02], Avg: 17.0663 (0.341)
Ep: 357, Reward: -51.8324, Test: -48.2095 [16.89], Avg: 16.8368 (0.340)
Ep: 358, Reward: -50.4084, Test: -40.7713 [18.09], Avg: 16.6259 (0.339)
Ep: 359, Reward: -57.1278, Test: -50.2966 [9.08], Avg: 16.4148 (0.338)
Ep: 360, Reward: -56.5666, Test: -46.4396 [9.10], Avg: 16.2155 (0.337)
Ep: 361, Reward: -56.9949, Test: -38.5709 [10.68], Avg: 16.0347 (0.336)
Ep: 362, Reward: -43.6469, Test: -40.7765 [14.17], Avg: 15.8391 (0.335)
Ep: 363, Reward: -48.2760, Test: -39.0806 [24.79], Avg: 15.6201 (0.334)
Ep: 364, Reward: -52.4343, Test: -30.0927 [21.47], Avg: 15.4361 (0.333)
Ep: 365, Reward: -47.3032, Test: -43.4460 [8.24], Avg: 15.2527 (0.332)
Ep: 366, Reward: -50.0718, Test: -46.0441 [9.39], Avg: 15.0601 (0.331)
Ep: 367, Reward: -54.0401, Test: -47.7070 [11.79], Avg: 14.8575 (0.330)
Ep: 368, Reward: -50.6330, Test: -40.5362 [18.48], Avg: 14.6573 (0.329)
Ep: 369, Reward: -44.7036, Test: -36.5517 [8.36], Avg: 14.4963 (0.328)
Ep: 370, Reward: -49.5268, Test: -48.8749 [9.78], Avg: 14.2991 (0.327)
Ep: 371, Reward: -47.5022, Test: -45.3984 [11.52], Avg: 14.1076 (0.326)
Ep: 372, Reward: -50.1434, Test: -36.4818 [27.76], Avg: 13.8976 (0.325)
Ep: 373, Reward: -51.3303, Test: -37.8158 [12.59], Avg: 13.7257 (0.324)
Ep: 374, Reward: -47.8542, Test: -34.8512 [21.78], Avg: 13.5380 (0.323)
Ep: 375, Reward: -46.3038, Test: -34.3790 [16.02], Avg: 13.3680 (0.322)
Ep: 376, Reward: -44.5114, Test: -33.2449 [21.43], Avg: 13.1875 (0.321)
Ep: 377, Reward: -45.8975, Test: -46.0880 [10.33], Avg: 13.0034 (0.320)
Ep: 378, Reward: -45.3552, Test: -39.6199 [13.96], Avg: 12.8277 (0.319)
Ep: 379, Reward: -45.8681, Test: -45.4114 [7.56], Avg: 12.6545 (0.318)
Ep: 380, Reward: -49.9206, Test: -43.6713 [11.88], Avg: 12.4755 (0.317)
Ep: 381, Reward: -42.7257, Test: -38.7238 [11.03], Avg: 12.3126 (0.316)
Ep: 382, Reward: -42.7558, Test: -39.7496 [10.92], Avg: 12.1482 (0.315)
Ep: 383, Reward: -37.1218, Test: -37.5694 [10.03], Avg: 11.9926 (0.315)
Ep: 384, Reward: -46.1795, Test: -36.4703 [19.30], Avg: 11.8166 (0.314)
Ep: 385, Reward: -45.0175, Test: -38.7557 [18.37], Avg: 11.6380 (0.313)
Ep: 386, Reward: -42.6803, Test: -47.4082 [8.85], Avg: 11.4625 (0.312)
Ep: 387, Reward: -37.9542, Test: -41.2624 [10.71], Avg: 11.2990 (0.311)
Ep: 388, Reward: -45.2382, Test: -41.8642 [15.67], Avg: 11.1221 (0.310)
Ep: 389, Reward: -44.8707, Test: -43.1971 [10.35], Avg: 10.9563 (0.309)
Ep: 390, Reward: -43.4709, Test: -41.0932 [15.56], Avg: 10.7834 (0.308)
Ep: 391, Reward: -43.7336, Test: -44.5441 [10.33], Avg: 10.6159 (0.307)
Ep: 392, Reward: -44.6363, Test: -36.6479 [16.27], Avg: 10.4542 (0.306)
Ep: 393, Reward: -46.3115, Test: -45.5462 [8.74], Avg: 10.2899 (0.305)
Ep: 394, Reward: -44.5764, Test: -40.0656 [15.55], Avg: 10.1230 (0.304)
Ep: 395, Reward: -38.9314, Test: -44.2884 [12.98], Avg: 9.9529 (0.303)
Ep: 396, Reward: -41.2049, Test: -46.4994 [7.84], Avg: 9.7909 (0.302)
Ep: 397, Reward: -44.1586, Test: -48.4393 [7.92], Avg: 9.6247 (0.302)
Ep: 398, Reward: -43.8353, Test: -44.1155 [9.01], Avg: 9.4674 (0.301)
Ep: 399, Reward: -42.7542, Test: -42.1078 [11.44], Avg: 9.3099 (0.300)
Ep: 400, Reward: -45.0152, Test: -49.8331 [6.99], Avg: 9.1450 (0.299)
Ep: 401, Reward: -46.2059, Test: -41.8127 [7.90], Avg: 8.9986 (0.298)
Ep: 402, Reward: -42.9117, Test: -47.6055 [8.25], Avg: 8.8376 (0.297)
Ep: 403, Reward: -41.4163, Test: -42.9396 [10.08], Avg: 8.6845 (0.296)
Ep: 404, Reward: -45.3467, Test: -39.8578 [7.57], Avg: 8.5460 (0.295)
Ep: 405, Reward: -45.7237, Test: -47.1701 [9.04], Avg: 8.3865 (0.294)
Ep: 406, Reward: -37.3249, Test: -39.7129 [7.59], Avg: 8.2496 (0.294)
Ep: 407, Reward: -37.4787, Test: -46.2250 [8.03], Avg: 8.0964 (0.293)
Ep: 408, Reward: -44.4331, Test: -48.4122 [7.29], Avg: 7.9405 (0.292)
Ep: 409, Reward: -38.7725, Test: -44.7833 [5.21], Avg: 7.7991 (0.291)
Ep: 410, Reward: -37.8277, Test: -45.4131 [5.83], Avg: 7.6555 (0.290)
Ep: 411, Reward: -43.0353, Test: -41.8739 [8.21], Avg: 7.5153 (0.289)
Ep: 412, Reward: -38.7303, Test: -45.1976 [7.50], Avg: 7.3695 (0.288)
Ep: 413, Reward: -39.7366, Test: -45.5283 [4.72], Avg: 7.2304 (0.287)
Ep: 414, Reward: -41.1199, Test: -45.0274 [7.15], Avg: 7.0872 (0.287)
Ep: 415, Reward: -43.2879, Test: -45.9794 [11.57], Avg: 6.9318 (0.286)
Ep: 416, Reward: -45.3011, Test: -44.2419 [7.82], Avg: 6.7904 (0.285)
Ep: 417, Reward: -39.5918, Test: -46.6103 [7.91], Avg: 6.6437 (0.284)
Ep: 418, Reward: -46.0927, Test: -47.2490 [5.40], Avg: 6.5022 (0.283)
Ep: 419, Reward: -41.5120, Test: -47.4700 [5.92], Avg: 6.3596 (0.282)
Ep: 420, Reward: -41.0033, Test: -48.1172 [6.65], Avg: 6.2144 (0.281)
Ep: 421, Reward: -41.2788, Test: -51.0841 [3.73], Avg: 6.0698 (0.281)
Ep: 422, Reward: -41.2754, Test: -46.2498 [6.92], Avg: 5.9297 (0.280)
Ep: 423, Reward: -45.3222, Test: -48.3292 [3.21], Avg: 5.7942 (0.279)
Ep: 424, Reward: -39.9924, Test: -47.7787 [6.29], Avg: 5.6533 (0.278)
Ep: 425, Reward: -42.3619, Test: -43.3493 [8.11], Avg: 5.5193 (0.277)
Ep: 426, Reward: -43.6809, Test: -47.6778 [6.26], Avg: 5.3800 (0.276)
Ep: 427, Reward: -35.1444, Test: -48.5123 [2.72], Avg: 5.2478 (0.276)
Ep: 428, Reward: -35.7789, Test: -41.0340 [7.88], Avg: 5.1215 (0.275)
Ep: 429, Reward: -36.0062, Test: -46.3214 [5.09], Avg: 4.9900 (0.274)
Ep: 430, Reward: -39.4189, Test: -42.6109 [10.17], Avg: 4.8560 (0.273)
Ep: 431, Reward: -41.4178, Test: -46.1618 [7.33], Avg: 4.7209 (0.272)
Ep: 432, Reward: -41.3982, Test: -41.6464 [8.21], Avg: 4.5949 (0.271)
Ep: 433, Reward: -40.1473, Test: -38.0357 [10.10], Avg: 4.4734 (0.271)
Ep: 434, Reward: -41.2611, Test: -44.9898 [8.01], Avg: 4.3413 (0.270)
Ep: 435, Reward: -44.6510, Test: -41.0873 [9.22], Avg: 4.2159 (0.269)
Ep: 436, Reward: -41.1349, Test: -42.9312 [8.56], Avg: 4.0884 (0.268)
Ep: 437, Reward: -33.7965, Test: -38.4710 [6.02], Avg: 3.9775 (0.267)
Ep: 438, Reward: -34.6585, Test: -44.4662 [3.91], Avg: 3.8583 (0.267)
Ep: 439, Reward: -35.1440, Test: -37.6652 [14.57], Avg: 3.7308 (0.266)
Ep: 440, Reward: -37.7616, Test: -44.2879 [6.61], Avg: 3.6069 (0.265)
Ep: 441, Reward: -37.2053, Test: -32.0542 [19.89], Avg: 3.4812 (0.264)
Ep: 442, Reward: -40.2553, Test: -34.3702 [23.95], Avg: 3.3417 (0.263)
Ep: 443, Reward: -32.5909, Test: -34.0842 [20.63], Avg: 3.2110 (0.263)
Ep: 444, Reward: -32.8301, Test: -41.5084 [8.17], Avg: 3.0921 (0.262)
Ep: 445, Reward: -34.6669, Test: -35.5000 [22.34], Avg: 2.9555 (0.261)
Ep: 446, Reward: -29.9139, Test: -33.4951 [18.69], Avg: 2.8321 (0.260)
Ep: 447, Reward: -28.9457, Test: -40.1609 [9.18], Avg: 2.7157 (0.259)
Ep: 448, Reward: -36.0673, Test: -37.4292 [8.13], Avg: 2.6082 (0.259)
Ep: 449, Reward: -32.3104, Test: -37.9204 [9.29], Avg: 2.4974 (0.258)
Ep: 450, Reward: -33.2863, Test: -32.5062 [25.39], Avg: 2.3635 (0.257)
Ep: 451, Reward: -34.2599, Test: -38.7225 [9.96], Avg: 2.2506 (0.256)
Ep: 452, Reward: -30.7853, Test: -27.7873 [23.27], Avg: 2.1329 (0.256)
Ep: 453, Reward: -34.8541, Test: -31.7546 [16.21], Avg: 2.0226 (0.255)
Ep: 454, Reward: -33.0797, Test: -38.1252 [7.13], Avg: 1.9187 (0.254)
Ep: 455, Reward: -30.2222, Test: -19.2199 [42.31], Avg: 1.7795 (0.253)
Ep: 456, Reward: -28.6507, Test: -34.1384 [5.82], Avg: 1.6882 (0.253)
Ep: 457, Reward: -29.6499, Test: -22.7071 [30.61], Avg: 1.5681 (0.252)
Ep: 458, Reward: -40.2603, Test: -26.6838 [25.27], Avg: 1.4515 (0.251)
Ep: 459, Reward: -34.0037, Test: -30.3569 [18.84], Avg: 1.3414 (0.250)
Ep: 460, Reward: -26.1498, Test: -29.7504 [17.76], Avg: 1.2354 (0.250)
Ep: 461, Reward: -25.1632, Test: -30.6082 [19.71], Avg: 1.1238 (0.249)
Ep: 462, Reward: -31.6970, Test: -36.8369 [9.73], Avg: 1.0208 (0.248)
Ep: 463, Reward: -33.3839, Test: -28.0694 [18.29], Avg: 0.9187 (0.247)
Ep: 464, Reward: -31.0496, Test: -24.8800 [28.66], Avg: 0.8016 (0.247)
Ep: 465, Reward: -20.8188, Test: -29.9181 [22.71], Avg: 0.6870 (0.246)
Ep: 466, Reward: -39.9641, Test: -30.2722 [20.38], Avg: 0.5770 (0.245)
Ep: 467, Reward: -27.1768, Test: -31.2753 [24.97], Avg: 0.4556 (0.244)
Ep: 468, Reward: -33.9553, Test: -21.2658 [30.44], Avg: 0.3444 (0.244)
Ep: 469, Reward: -31.6864, Test: -24.5966 [25.24], Avg: 0.2376 (0.243)
Ep: 470, Reward: -21.3313, Test: -35.4188 [17.98], Avg: 0.1237 (0.242)
Ep: 471, Reward: -24.1432, Test: -14.7061 [34.63], Avg: 0.0190 (0.241)
Ep: 472, Reward: -33.1203, Test: -4.7306 [37.80], Avg: -0.0710 (0.241)
Ep: 473, Reward: -20.8571, Test: -9.0706 [28.14], Avg: -0.1494 (0.240)
Ep: 474, Reward: -23.1944, Test: -20.3289 [24.33], Avg: -0.2431 (0.239)
Ep: 475, Reward: -26.9630, Test: 4.6156 [41.65], Avg: -0.3204 (0.239)
Ep: 476, Reward: -11.9275, Test: -23.6525 [31.06], Avg: -0.4344 (0.238)
Ep: 477, Reward: -22.6965, Test: -7.6541 [30.37], Avg: -0.5130 (0.237)
Ep: 478, Reward: -14.4680, Test: -12.2007 [34.20], Avg: -0.6088 (0.236)
Ep: 479, Reward: 6.2811, Test: -0.7036 [27.97], Avg: -0.6673 (0.236)
Ep: 480, Reward: -12.5432, Test: -0.9619 [38.48], Avg: -0.7479 (0.235)
Ep: 481, Reward: -19.3421, Test: 1.6018 [26.75], Avg: -0.7985 (0.234)
Ep: 482, Reward: 4.3662, Test: -6.9061 [31.02], Avg: -0.8754 (0.234)
Ep: 483, Reward: 9.2181, Test: 5.3324 [32.24], Avg: -0.9292 (0.233)
Ep: 484, Reward: -11.7268, Test: -8.3380 [35.37], Avg: -1.0174 (0.232)
Ep: 485, Reward: 3.6387, Test: 5.7997 [29.49], Avg: -1.0640 (0.231)
Ep: 486, Reward: 17.4519, Test: 6.2304 [37.99], Avg: -1.1271 (0.231)
Ep: 487, Reward: -1.7724, Test: 6.7457 [28.91], Avg: -1.1702 (0.230)
Ep: 488, Reward: -1.9605, Test: 3.3103 [32.55], Avg: -1.2276 (0.229)
Ep: 489, Reward: -2.5166, Test: 4.1722 [32.08], Avg: -1.2820 (0.229)
Ep: 490, Reward: -2.3034, Test: 11.5586 [41.70], Avg: -1.3408 (0.228)
Ep: 491, Reward: -2.5555, Test: 6.9707 [25.73], Avg: -1.3762 (0.227)
Ep: 492, Reward: -7.9648, Test: -9.7037 [32.19], Avg: -1.4584 (0.227)
Ep: 493, Reward: 8.7988, Test: -9.4634 [30.78], Avg: -1.5369 (0.226)
Ep: 494, Reward: -8.5468, Test: -6.4470 [25.56], Avg: -1.5985 (0.225)
Ep: 495, Reward: 3.3612, Test: -2.4284 [33.48], Avg: -1.6677 (0.225)
Ep: 496, Reward: 5.8134, Test: -9.2257 [33.21], Avg: -1.7497 (0.224)
Ep: 497, Reward: -12.1113, Test: 10.3227 [37.24], Avg: -1.8002 (0.223)
Ep: 498, Reward: 7.1673, Test: -3.3893 [26.88], Avg: -1.8573 (0.223)
Ep: 499, Reward: -6.7553, Test: 3.8552 [27.01], Avg: -1.8999 (0.222)
