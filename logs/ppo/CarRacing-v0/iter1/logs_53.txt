Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.1				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((len(self.replay_buffer)*PPO_EPOCHS)//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -34.6448, Test: -75.0453 [3.29], Avg: -78.3327 (0.997)
Ep: 1, Reward: -79.8124, Test: -76.7071 [6.87], Avg: -80.9566 (0.994)
Ep: 2, Reward: -75.0890, Test: -75.1150 [10.37], Avg: -82.4653 (0.991)
Ep: 3, Reward: -76.8194, Test: -73.5277 [6.67], Avg: -81.8996 (0.988)
Ep: 4, Reward: -68.7699, Test: -68.4223 [10.15], Avg: -81.2347 (0.985)
Ep: 5, Reward: -75.5811, Test: -74.4756 [2.87], Avg: -80.5863 (0.982)
Ep: 6, Reward: -69.7321, Test: -70.0820 [3.81], Avg: -79.6299 (0.979)
Ep: 7, Reward: -69.5735, Test: -73.9629 [7.85], Avg: -79.9025 (0.976)
Ep: 8, Reward: -75.3257, Test: -77.4261 [4.97], Avg: -80.1793 (0.973)
Ep: 9, Reward: -76.4366, Test: -78.5504 [6.00], Avg: -80.6159 (0.970)
Ep: 10, Reward: -37.4585, Test: -9.1940 [18.22], Avg: -75.7794 (0.967)
Ep: 11, Reward: 13.6070, Test: 81.6794 [41.19], Avg: -66.0904 (0.965)
Ep: 12, Reward: 116.5954, Test: 207.8669 [86.89], Avg: -51.7009 (0.962)
Ep: 13, Reward: 363.6688, Test: 393.7887 [148.12], Avg: -30.4600 (0.959)
Ep: 14, Reward: 345.9658, Test: 339.7412 [134.88], Avg: -14.7720 (0.956)
Ep: 15, Reward: 283.8587, Test: 361.9177 [143.08], Avg: -0.1711 (0.953)
Ep: 16, Reward: 351.8957, Test: 415.5449 [74.87], Avg: 19.8788 (0.950)
Ep: 17, Reward: 449.2866, Test: 550.8037 [147.36], Avg: 41.1879 (0.947)
Ep: 18, Reward: 465.6930, Test: 482.8460 [142.36], Avg: 56.9405 (0.945)
Ep: 19, Reward: 291.0745, Test: 326.7902 [76.59], Avg: 66.6033 (0.942)
Ep: 20, Reward: 411.4783, Test: 470.7337 [117.53], Avg: 80.2511 (0.939)
Ep: 21, Reward: 467.7835, Test: 462.0683 [142.74], Avg: 91.1182 (0.936)
Ep: 22, Reward: 494.3076, Test: 501.5315 [209.76], Avg: 99.8421 (0.933)
Ep: 23, Reward: 455.2897, Test: 386.9344 [170.29], Avg: 104.7088 (0.930)
Ep: 24, Reward: 454.2405, Test: 251.0827 [195.75], Avg: 102.7336 (0.928)
Ep: 25, Reward: 425.0942, Test: 384.5986 [155.56], Avg: 107.5915 (0.925)
Ep: 26, Reward: 395.2706, Test: 449.3881 [162.68], Avg: 114.2254 (0.922)
Ep: 27, Reward: 451.1968, Test: 365.5909 [183.20], Avg: 116.6600 (0.919)
Ep: 28, Reward: 448.6411, Test: 304.1740 [144.20], Avg: 118.1535 (0.917)
Ep: 29, Reward: 351.8984, Test: 223.7652 [86.30], Avg: 118.7971 (0.914)
Ep: 30, Reward: 372.1655, Test: 364.7359 [199.44], Avg: 120.2972 (0.911)
Ep: 31, Reward: 432.9072, Test: 317.2944 [185.39], Avg: 120.6601 (0.908)
Ep: 32, Reward: 440.6264, Test: 423.4448 [178.99], Avg: 124.4113 (0.906)
Ep: 33, Reward: 450.5257, Test: 584.1595 [218.84], Avg: 131.4967 (0.903)
Ep: 34, Reward: 522.6316, Test: 578.1342 [150.27], Avg: 139.9645 (0.900)
Ep: 35, Reward: 509.0691, Test: 584.1006 [206.82], Avg: 146.5566 (0.897)
Ep: 36, Reward: 637.6300, Test: 752.2214 [133.46], Avg: 159.3189 (0.895)
Ep: 37, Reward: 747.0758, Test: 538.8700 [163.54], Avg: 165.0035 (0.892)
Ep: 38, Reward: 608.4608, Test: 605.1635 [124.85], Avg: 173.0883 (0.889)
Ep: 39, Reward: 673.7933, Test: 566.5040 [186.66], Avg: 178.2573 (0.887)
Ep: 40, Reward: 687.6892, Test: 594.1112 [203.42], Avg: 183.4386 (0.884)
Ep: 41, Reward: 598.1542, Test: 659.9998 [148.68], Avg: 191.2454 (0.881)
Ep: 42, Reward: 506.0167, Test: 561.8081 [139.43], Avg: 196.6206 (0.879)
Ep: 43, Reward: 623.2363, Test: 727.7444 [170.84], Avg: 204.8088 (0.876)
Ep: 44, Reward: 616.9317, Test: 586.1433 [218.46], Avg: 208.4282 (0.874)
Ep: 45, Reward: 569.6319, Test: 621.5286 [152.28], Avg: 214.0983 (0.871)
Ep: 46, Reward: 593.5741, Test: 657.4390 [179.13], Avg: 219.7197 (0.868)
Ep: 47, Reward: 524.5298, Test: 550.7035 [171.84], Avg: 223.0353 (0.866)
Ep: 48, Reward: 579.3949, Test: 423.1526 [225.32], Avg: 222.5209 (0.863)
Ep: 49, Reward: 625.2757, Test: 613.2869 [222.54], Avg: 225.8853 (0.861)
Ep: 50, Reward: 660.1155, Test: 649.2089 [251.26], Avg: 229.2591 (0.858)
Ep: 51, Reward: 686.8407, Test: 580.9545 [225.17], Avg: 231.6924 (0.855)
Ep: 52, Reward: 610.6063, Test: 725.7884 [135.39], Avg: 238.4604 (0.853)
Ep: 53, Reward: 677.4231, Test: 714.3150 [86.00], Avg: 245.6800 (0.850)
Ep: 54, Reward: 492.2950, Test: 504.9516 [97.08], Avg: 248.6290 (0.848)
Ep: 55, Reward: 547.7215, Test: 568.3570 [69.00], Avg: 253.1062 (0.845)
Ep: 56, Reward: 497.4624, Test: 566.6963 [63.11], Avg: 257.5006 (0.843)
Ep: 57, Reward: 647.4988, Test: 629.5011 [153.26], Avg: 261.2719 (0.840)
Ep: 58, Reward: 382.0901, Test: 277.3459 [76.13], Avg: 260.2540 (0.838)
Ep: 59, Reward: 358.9734, Test: 301.7571 [99.82], Avg: 259.2822 (0.835)
Ep: 60, Reward: 331.1365, Test: 339.3391 [79.19], Avg: 259.2964 (0.833)
Ep: 61, Reward: 335.4865, Test: 428.2119 [148.10], Avg: 259.6321 (0.830)
Ep: 62, Reward: 416.2860, Test: 543.2370 [120.64], Avg: 262.2188 (0.828)
Ep: 63, Reward: 434.0813, Test: 426.5596 [105.19], Avg: 263.1431 (0.825)
Ep: 64, Reward: 464.2305, Test: 536.4065 [96.17], Avg: 265.8676 (0.823)
Ep: 65, Reward: 500.4157, Test: 523.3785 [96.45], Avg: 268.3079 (0.820)
Ep: 66, Reward: 478.9637, Test: 454.6561 [196.34], Avg: 268.1587 (0.818)
Ep: 67, Reward: 545.9840, Test: 544.1566 [237.94], Avg: 268.7184 (0.815)
Ep: 68, Reward: 744.2521, Test: 715.4086 [186.18], Avg: 272.4938 (0.813)
Ep: 69, Reward: -29.2157, Test: -38.9087 [5.65], Avg: 267.9646 (0.810)
Ep: 70, Reward: 2.7408, Test: -12.1453 [40.94], Avg: 263.4427 (0.808)
Ep: 71, Reward: -35.6180, Test: -27.7450 [23.91], Avg: 259.0662 (0.805)
Ep: 72, Reward: 16.0174, Test: 12.1530 [69.39], Avg: 254.7333 (0.803)
Ep: 73, Reward: 192.3678, Test: 153.4701 [122.02], Avg: 251.7160 (0.801)
Ep: 74, Reward: 501.0152, Test: 682.7101 [194.25], Avg: 254.8725 (0.798)
Ep: 75, Reward: 654.9731, Test: 721.3206 [155.55], Avg: 258.9633 (0.796)
Ep: 76, Reward: 715.8852, Test: 784.9661 [127.34], Avg: 264.1407 (0.793)
Ep: 77, Reward: 648.3721, Test: 691.9121 [80.74], Avg: 268.5898 (0.791)
Ep: 78, Reward: 684.6266, Test: 716.9981 [104.26], Avg: 272.9461 (0.789)
Ep: 79, Reward: 588.8341, Test: 679.4466 [131.97], Avg: 276.3778 (0.786)
Ep: 80, Reward: 646.8900, Test: 712.0510 [77.97], Avg: 280.7939 (0.784)
Ep: 81, Reward: 641.9558, Test: 645.5245 [137.93], Avg: 283.5599 (0.782)
Ep: 82, Reward: 540.0832, Test: 515.0569 [149.78], Avg: 284.5443 (0.779)
Ep: 83, Reward: 639.2576, Test: 627.8072 [186.97], Avg: 286.4050 (0.777)
Ep: 84, Reward: 688.3296, Test: 581.5401 [201.49], Avg: 287.5067 (0.775)
Ep: 85, Reward: 750.8628, Test: 616.5163 [183.76], Avg: 289.1956 (0.772)
Ep: 86, Reward: 678.0394, Test: 643.2878 [198.63], Avg: 290.9825 (0.770)
Ep: 87, Reward: 546.1545, Test: 750.1013 [183.86], Avg: 294.1105 (0.768)
Ep: 88, Reward: 472.9949, Test: 545.3054 [176.45], Avg: 294.9503 (0.765)
Ep: 89, Reward: 322.7810, Test: 412.9149 [227.59], Avg: 293.7322 (0.763)
Ep: 90, Reward: 336.5463, Test: 505.3306 [213.66], Avg: 293.7096 (0.761)
Ep: 91, Reward: 24.6284, Test: 63.7380 [87.83], Avg: 290.2553 (0.758)
Ep: 92, Reward: 28.3050, Test: 23.2149 [53.91], Avg: 286.8042 (0.756)
Ep: 93, Reward: 29.5524, Test: 39.7582 [47.88], Avg: 283.6666 (0.754)
Ep: 94, Reward: 37.8571, Test: 75.2038 [76.04], Avg: 280.6718 (0.752)
Ep: 95, Reward: 49.0031, Test: 46.7573 [66.13], Avg: 277.5464 (0.749)
Ep: 96, Reward: 58.1254, Test: 136.6112 [154.23], Avg: 274.5035 (0.747)
Ep: 97, Reward: 81.4940, Test: 67.1867 [68.13], Avg: 271.6928 (0.745)
Ep: 98, Reward: 101.1050, Test: 130.2993 [127.65], Avg: 268.9752 (0.743)
Ep: 99, Reward: 102.7633, Test: 98.9302 [116.18], Avg: 266.1130 (0.740)
Ep: 100, Reward: 47.6123, Test: 31.3731 [29.32], Avg: 263.4985 (0.738)
Ep: 101, Reward: 79.5410, Test: 23.6314 [39.80], Avg: 260.7567 (0.736)
Ep: 102, Reward: 24.3702, Test: -21.6063 [26.99], Avg: 257.7532 (0.734)
Ep: 103, Reward: -24.1721, Test: -10.9037 [33.54], Avg: 254.8475 (0.732)
Ep: 104, Reward: -3.6528, Test: -1.2141 [74.63], Avg: 251.6980 (0.729)
Ep: 105, Reward: -6.8224, Test: -8.1258 [68.98], Avg: 248.5961 (0.727)
Ep: 106, Reward: -12.1008, Test: -35.2203 [24.90], Avg: 245.7110 (0.725)
Ep: 107, Reward: 30.7733, Test: 53.2625 [75.04], Avg: 243.2342 (0.723)
Ep: 108, Reward: 56.0164, Test: 100.7971 [135.61], Avg: 240.6834 (0.721)
Ep: 109, Reward: 11.9464, Test: 41.2990 [82.71], Avg: 238.1189 (0.719)
Ep: 110, Reward: 45.5389, Test: 151.8719 [112.95], Avg: 236.3243 (0.716)
Ep: 111, Reward: 149.5022, Test: 178.6933 [165.54], Avg: 234.3317 (0.714)
Ep: 112, Reward: 121.5235, Test: 274.4467 [199.69], Avg: 232.9195 (0.712)
Ep: 113, Reward: 96.8233, Test: 127.1707 [212.34], Avg: 230.1292 (0.710)
Ep: 114, Reward: 216.1950, Test: 142.1545 [211.58], Avg: 227.5244 (0.708)
Ep: 115, Reward: 183.1871, Test: 83.5982 [109.32], Avg: 225.3412 (0.706)
Ep: 116, Reward: 99.1915, Test: 150.1502 [234.87], Avg: 222.6911 (0.704)
Ep: 117, Reward: 80.3358, Test: 70.7155 [98.67], Avg: 220.5670 (0.702)
Ep: 118, Reward: 121.2943, Test: 48.8213 [81.79], Avg: 218.4365 (0.699)
Ep: 119, Reward: 207.0136, Test: 69.8558 [89.64], Avg: 216.4513 (0.697)
Ep: 120, Reward: 44.2065, Test: 91.4269 [124.11], Avg: 214.3923 (0.695)
Ep: 121, Reward: 110.4092, Test: 84.9940 [89.35], Avg: 212.5993 (0.693)
Ep: 122, Reward: 108.6678, Test: 93.4812 [192.64], Avg: 210.0647 (0.691)
Ep: 123, Reward: 181.3563, Test: 222.0791 [252.11], Avg: 208.1285 (0.689)
Ep: 124, Reward: 367.1926, Test: 490.1892 [181.94], Avg: 208.9294 (0.687)
Ep: 125, Reward: 728.0750, Test: 635.4671 [149.08], Avg: 211.1315 (0.685)
Ep: 126, Reward: 621.1029, Test: 623.8534 [172.35], Avg: 213.0242 (0.683)
Ep: 127, Reward: 540.0805, Test: 648.8519 [189.41], Avg: 214.9493 (0.681)
Ep: 128, Reward: 670.9820, Test: 694.7072 [161.31], Avg: 217.4180 (0.679)
Ep: 129, Reward: 749.9902, Test: 729.4086 [172.62], Avg: 220.0285 (0.677)
Ep: 130, Reward: 705.4794, Test: 588.8794 [193.08], Avg: 221.3703 (0.675)
Ep: 131, Reward: 500.1409, Test: 484.4351 [182.54], Avg: 221.9803 (0.673)
Ep: 132, Reward: 393.2270, Test: 507.4076 [180.78], Avg: 222.7672 (0.671)
Ep: 133, Reward: 410.3686, Test: 256.9575 [62.06], Avg: 222.5592 (0.669)
Ep: 134, Reward: 531.5805, Test: 344.3894 [220.73], Avg: 221.8266 (0.667)
Ep: 135, Reward: 397.7569, Test: 343.1647 [199.23], Avg: 221.2538 (0.665)
Ep: 136, Reward: 401.3003, Test: 425.4684 [202.41], Avg: 221.2670 (0.663)
Ep: 137, Reward: 350.0702, Test: 394.8819 [160.02], Avg: 221.3655 (0.661)
Ep: 138, Reward: 293.4743, Test: 310.8712 [161.88], Avg: 220.8448 (0.659)
Ep: 139, Reward: 342.8035, Test: 269.0002 [126.01], Avg: 220.2887 (0.657)
Ep: 140, Reward: 256.1068, Test: 398.7344 [189.83], Avg: 220.2080 (0.655)
Ep: 141, Reward: 257.3826, Test: 349.0997 [176.57], Avg: 219.8723 (0.653)
Ep: 142, Reward: 328.7658, Test: 264.1966 [50.70], Avg: 219.8277 (0.651)
Ep: 143, Reward: 290.3498, Test: 394.1899 [97.88], Avg: 220.3588 (0.649)
Ep: 144, Reward: 402.3343, Test: 312.9803 [200.80], Avg: 219.6127 (0.647)
Ep: 145, Reward: 362.1623, Test: 278.6759 [166.89], Avg: 218.8742 (0.645)
Ep: 146, Reward: 389.7518, Test: 282.6576 [146.95], Avg: 218.3084 (0.643)
Ep: 147, Reward: 277.9201, Test: 294.2358 [113.40], Avg: 218.0552 (0.641)
Ep: 148, Reward: 411.6979, Test: 419.2694 [181.02], Avg: 218.1907 (0.639)
Ep: 149, Reward: 475.6875, Test: 449.8943 [188.59], Avg: 218.4782 (0.637)
Ep: 150, Reward: 428.3297, Test: 484.0097 [144.84], Avg: 219.2775 (0.635)
Ep: 151, Reward: 387.7118, Test: 445.3670 [161.38], Avg: 219.7032 (0.633)
Ep: 152, Reward: 459.7589, Test: 350.4183 [150.53], Avg: 219.5737 (0.631)
Ep: 153, Reward: 525.7578, Test: 341.9798 [99.81], Avg: 219.7204 (0.630)
Ep: 154, Reward: 351.7651, Test: 296.8846 [189.09], Avg: 218.9982 (0.628)
Ep: 155, Reward: 438.0034, Test: 433.3117 [181.79], Avg: 219.2067 (0.626)
Ep: 156, Reward: 459.4894, Test: 360.1790 [208.21], Avg: 218.7784 (0.624)
Ep: 157, Reward: 417.9972, Test: 451.8648 [124.72], Avg: 219.4643 (0.622)
Ep: 158, Reward: 362.6328, Test: 411.5944 [143.35], Avg: 219.7711 (0.620)
Ep: 159, Reward: 413.0843, Test: 398.2319 [209.10], Avg: 219.5796 (0.618)
Ep: 160, Reward: 433.0841, Test: 402.6730 [201.29], Avg: 219.4665 (0.616)
Ep: 161, Reward: 360.8654, Test: 405.4282 [183.19], Avg: 219.4836 (0.615)
Ep: 162, Reward: 366.4316, Test: 435.1297 [176.92], Avg: 219.7212 (0.613)
Ep: 163, Reward: 334.9039, Test: 468.1310 [132.75], Avg: 220.4264 (0.611)
Ep: 164, Reward: 414.9707, Test: 410.4770 [145.26], Avg: 220.6978 (0.609)
Ep: 165, Reward: 364.4472, Test: 355.7476 [166.23], Avg: 220.5100 (0.607)
Ep: 166, Reward: 352.1553, Test: 346.4693 [116.37], Avg: 220.5674 (0.605)
Ep: 167, Reward: 315.5617, Test: 347.2061 [167.16], Avg: 220.3262 (0.604)
Ep: 168, Reward: 314.1213, Test: 346.3243 [151.77], Avg: 220.1737 (0.602)
Ep: 169, Reward: 329.3590, Test: 318.0775 [110.03], Avg: 220.1024 (0.600)
Ep: 170, Reward: 406.4763, Test: 410.4164 [130.38], Avg: 220.4529 (0.598)
Ep: 171, Reward: 289.0724, Test: 277.4070 [151.20], Avg: 219.9049 (0.596)
Ep: 172, Reward: 321.2669, Test: 379.3874 [108.75], Avg: 220.1982 (0.595)
Ep: 173, Reward: 283.6211, Test: 309.0599 [163.45], Avg: 219.7695 (0.593)
Ep: 174, Reward: 412.9563, Test: 348.0287 [144.38], Avg: 219.6774 (0.591)
Ep: 175, Reward: 327.7492, Test: 349.4124 [193.94], Avg: 219.3126 (0.589)
Ep: 176, Reward: 370.9626, Test: 340.7107 [132.19], Avg: 219.2516 (0.588)
Ep: 177, Reward: 410.7772, Test: 415.1712 [186.96], Avg: 219.3019 (0.586)
Ep: 178, Reward: 387.0669, Test: 314.2473 [133.69], Avg: 219.0855 (0.584)
Ep: 179, Reward: 388.2948, Test: 306.4348 [133.25], Avg: 218.8305 (0.582)
Ep: 180, Reward: 370.9861, Test: 364.8650 [158.63], Avg: 218.7609 (0.581)
Ep: 181, Reward: 271.9251, Test: 334.7675 [149.79], Avg: 218.5753 (0.579)
Ep: 182, Reward: 322.4329, Test: 331.8489 [111.10], Avg: 218.5872 (0.577)
Ep: 183, Reward: 302.5003, Test: 359.7785 [196.72], Avg: 218.2854 (0.575)
Ep: 184, Reward: 346.7742, Test: 264.1685 [144.00], Avg: 217.7550 (0.574)
Ep: 185, Reward: 296.5089, Test: 256.6176 [185.88], Avg: 216.9646 (0.572)
Ep: 186, Reward: 341.5586, Test: 351.1426 [174.85], Avg: 216.7471 (0.570)
Ep: 187, Reward: 239.6642, Test: 227.5723 [105.98], Avg: 216.2410 (0.568)
Ep: 188, Reward: 367.9788, Test: 255.4802 [165.32], Avg: 215.5739 (0.567)
Ep: 189, Reward: 334.1186, Test: 321.4709 [210.57], Avg: 215.0230 (0.565)
Ep: 190, Reward: 328.3340, Test: 316.8212 [162.57], Avg: 214.7048 (0.563)
Ep: 191, Reward: 336.2463, Test: 324.1865 [199.69], Avg: 214.2350 (0.562)
Ep: 192, Reward: 354.7636, Test: 297.8550 [196.36], Avg: 213.6508 (0.560)
Ep: 193, Reward: 351.8134, Test: 330.5394 [131.89], Avg: 213.5735 (0.558)
Ep: 194, Reward: 394.4655, Test: 433.2394 [181.21], Avg: 213.7707 (0.557)
Ep: 195, Reward: 287.2045, Test: 406.8718 [158.80], Avg: 213.9457 (0.555)
Ep: 196, Reward: 349.2548, Test: 399.5606 [171.67], Avg: 214.0165 (0.553)
Ep: 197, Reward: 388.3484, Test: 391.1442 [162.48], Avg: 214.0904 (0.552)
Ep: 198, Reward: 392.5839, Test: 329.2995 [148.04], Avg: 213.9255 (0.550)
Ep: 199, Reward: 389.7384, Test: 287.9816 [175.00], Avg: 213.4207 (0.548)
Ep: 200, Reward: 291.4788, Test: 384.3310 [96.63], Avg: 213.7903 (0.547)
Ep: 201, Reward: 334.5005, Test: 281.2593 [146.43], Avg: 213.3994 (0.545)
Ep: 202, Reward: 425.7559, Test: 396.4393 [252.51], Avg: 213.0572 (0.543)
Ep: 203, Reward: 335.1580, Test: 311.9288 [107.24], Avg: 213.0162 (0.542)
Ep: 204, Reward: 412.2091, Test: 369.5104 [199.71], Avg: 212.8053 (0.540)
Ep: 205, Reward: 418.2822, Test: 395.7417 [222.24], Avg: 212.6145 (0.539)
Ep: 206, Reward: 325.5562, Test: 425.7743 [190.30], Avg: 212.7250 (0.537)
Ep: 207, Reward: 384.4752, Test: 348.5472 [139.73], Avg: 212.7062 (0.535)
Ep: 208, Reward: 405.8732, Test: 426.8409 [165.09], Avg: 212.9408 (0.534)
Ep: 209, Reward: 372.1081, Test: 439.5779 [202.30], Avg: 213.0567 (0.532)
Ep: 210, Reward: 466.5550, Test: 400.9419 [206.12], Avg: 212.9703 (0.530)
Ep: 211, Reward: 414.6381, Test: 376.6422 [214.57], Avg: 212.7302 (0.529)
Ep: 212, Reward: 440.0339, Test: 343.3595 [130.30], Avg: 212.7318 (0.527)
Ep: 213, Reward: 388.7197, Test: 333.5008 [121.89], Avg: 212.7265 (0.526)
Ep: 214, Reward: 380.7461, Test: 449.7756 [192.82], Avg: 212.9322 (0.524)
Ep: 215, Reward: 451.6278, Test: 378.0388 [151.38], Avg: 212.9958 (0.523)
Ep: 216, Reward: 286.6890, Test: 436.2847 [177.46], Avg: 213.2070 (0.521)
Ep: 217, Reward: 422.8238, Test: 501.4761 [211.59], Avg: 213.5587 (0.519)
Ep: 218, Reward: 445.2498, Test: 395.7865 [197.66], Avg: 213.4883 (0.518)
Ep: 219, Reward: 409.2273, Test: 469.9412 [144.09], Avg: 213.9990 (0.516)
Ep: 220, Reward: 405.6654, Test: 449.2369 [136.12], Avg: 214.4475 (0.515)
Ep: 221, Reward: 402.5777, Test: 311.3691 [153.41], Avg: 214.1930 (0.513)
Ep: 222, Reward: 480.1182, Test: 478.8676 [115.41], Avg: 214.8624 (0.512)
Ep: 223, Reward: 395.1398, Test: 476.1915 [203.27], Avg: 215.1216 (0.510)
Ep: 224, Reward: 426.9583, Test: 395.9636 [162.08], Avg: 215.2050 (0.509)
Ep: 225, Reward: 453.5950, Test: 493.5513 [182.64], Avg: 215.6284 (0.507)
Ep: 226, Reward: 426.9826, Test: 335.5099 [107.95], Avg: 215.6810 (0.506)
Ep: 227, Reward: 494.3164, Test: 411.5403 [183.92], Avg: 215.7334 (0.504)
Ep: 228, Reward: 465.6715, Test: 437.9520 [162.86], Avg: 215.9926 (0.503)
Ep: 229, Reward: 464.4699, Test: 375.5621 [133.90], Avg: 216.1042 (0.501)
Ep: 230, Reward: 417.6242, Test: 432.4964 [194.13], Avg: 216.2006 (0.500)
Ep: 231, Reward: 481.7696, Test: 467.2586 [193.84], Avg: 216.4472 (0.498)
Ep: 232, Reward: 425.4573, Test: 451.3846 [166.82], Avg: 216.7396 (0.497)
Ep: 233, Reward: 401.6774, Test: 425.9384 [195.45], Avg: 216.7983 (0.495)
Ep: 234, Reward: 397.9303, Test: 440.6436 [174.67], Avg: 217.0076 (0.494)
Ep: 235, Reward: 476.4952, Test: 427.0455 [184.46], Avg: 217.1160 (0.492)
Ep: 236, Reward: 415.1654, Test: 403.4966 [97.93], Avg: 217.4892 (0.491)
Ep: 237, Reward: 448.0731, Test: 508.5460 [172.00], Avg: 217.9894 (0.489)
Ep: 238, Reward: 489.1238, Test: 480.3871 [159.32], Avg: 218.4207 (0.488)
Ep: 239, Reward: 519.2242, Test: 603.1367 [144.17], Avg: 219.4229 (0.486)
Ep: 240, Reward: 451.6331, Test: 379.5315 [191.02], Avg: 219.2947 (0.485)
Ep: 241, Reward: 506.9941, Test: 459.5251 [154.79], Avg: 219.6477 (0.483)
Ep: 242, Reward: 500.1395, Test: 381.8553 [216.28], Avg: 219.4252 (0.482)
Ep: 243, Reward: 565.6198, Test: 345.2645 [151.34], Avg: 219.3207 (0.480)
Ep: 244, Reward: 456.1529, Test: 489.6321 [164.39], Avg: 219.7530 (0.479)
Ep: 245, Reward: 518.1620, Test: 549.2502 [212.22], Avg: 220.2298 (0.478)
Ep: 246, Reward: 474.6338, Test: 513.9221 [151.93], Avg: 220.8037 (0.476)
Ep: 247, Reward: 420.7474, Test: 566.1315 [199.97], Avg: 221.3898 (0.475)
Ep: 248, Reward: 507.2840, Test: 504.4505 [103.45], Avg: 222.1111 (0.473)
Ep: 249, Reward: 438.1355, Test: 461.4706 [152.41], Avg: 222.4589 (0.472)
Ep: 250, Reward: 443.7547, Test: 416.9688 [160.77], Avg: 222.5933 (0.470)
Ep: 251, Reward: 448.2768, Test: 466.1215 [203.70], Avg: 222.7514 (0.469)
Ep: 252, Reward: 455.4140, Test: 451.6419 [168.14], Avg: 222.9915 (0.468)
Ep: 253, Reward: 496.1660, Test: 377.0284 [235.29], Avg: 222.6716 (0.466)
Ep: 254, Reward: 453.3565, Test: 372.4758 [172.17], Avg: 222.5839 (0.465)
Ep: 255, Reward: 552.9485, Test: 437.0109 [176.30], Avg: 222.7328 (0.463)
Ep: 256, Reward: 353.4234, Test: 463.6669 [161.86], Avg: 223.0405 (0.462)
Ep: 257, Reward: 319.1094, Test: 391.4558 [148.34], Avg: 223.1183 (0.461)
Ep: 258, Reward: 419.2186, Test: 443.7064 [180.05], Avg: 223.2748 (0.459)
Ep: 259, Reward: 400.6443, Test: 396.8498 [130.54], Avg: 223.4403 (0.458)
Ep: 260, Reward: 365.6029, Test: 394.9915 [131.40], Avg: 223.5942 (0.456)
Ep: 261, Reward: 486.9911, Test: 450.1964 [193.26], Avg: 223.7214 (0.455)
Ep: 262, Reward: 392.3759, Test: 374.4212 [99.04], Avg: 223.9179 (0.454)
Ep: 263, Reward: 454.9611, Test: 445.0647 [205.14], Avg: 223.9785 (0.452)
Ep: 264, Reward: 406.3172, Test: 471.6787 [129.83], Avg: 224.4233 (0.451)
Ep: 265, Reward: 346.0711, Test: 420.9901 [143.25], Avg: 224.6238 (0.450)
Ep: 266, Reward: 420.3337, Test: 436.3406 [175.09], Avg: 224.7609 (0.448)
Ep: 267, Reward: 481.8167, Test: 410.0939 [168.67], Avg: 224.8231 (0.447)
Ep: 268, Reward: 356.1080, Test: 364.7193 [155.45], Avg: 224.7653 (0.446)
Ep: 269, Reward: 460.0284, Test: 403.3648 [196.71], Avg: 224.6982 (0.444)
Ep: 270, Reward: 398.3183, Test: 372.7298 [152.70], Avg: 224.6810 (0.443)
Ep: 271, Reward: 386.0025, Test: 513.5887 [218.84], Avg: 224.9386 (0.442)
Ep: 272, Reward: 345.0043, Test: 307.3776 [158.69], Avg: 224.6593 (0.440)
Ep: 273, Reward: 289.0089, Test: 335.2908 [193.51], Avg: 224.3569 (0.439)
Ep: 274, Reward: 380.8998, Test: 439.0746 [173.95], Avg: 224.5051 (0.438)
Ep: 275, Reward: 422.6873, Test: 390.5309 [174.61], Avg: 224.4740 (0.436)
Ep: 276, Reward: 425.0857, Test: 415.1017 [122.36], Avg: 224.7205 (0.435)
Ep: 277, Reward: 411.7984, Test: 417.8156 [203.96], Avg: 224.6814 (0.434)
Ep: 278, Reward: 381.0295, Test: 377.5120 [159.77], Avg: 224.6565 (0.432)
Ep: 279, Reward: 413.9055, Test: 423.0296 [158.57], Avg: 224.7987 (0.431)
Ep: 280, Reward: 433.3049, Test: 368.2880 [203.67], Avg: 224.5845 (0.430)
Ep: 281, Reward: 293.6416, Test: 494.8769 [207.63], Avg: 224.8067 (0.429)
Ep: 282, Reward: 479.8281, Test: 420.5382 [142.39], Avg: 224.9951 (0.427)
Ep: 283, Reward: 414.4597, Test: 411.1254 [147.28], Avg: 225.1319 (0.426)
Ep: 284, Reward: 392.1523, Test: 398.0267 [116.64], Avg: 225.3293 (0.425)
Ep: 285, Reward: 336.8040, Test: 384.2537 [188.39], Avg: 225.2263 (0.423)
Ep: 286, Reward: 449.6316, Test: 361.7031 [181.02], Avg: 225.0711 (0.422)
Ep: 287, Reward: 429.2547, Test: 462.8314 [220.61], Avg: 225.1306 (0.421)
Ep: 288, Reward: 383.0142, Test: 426.5453 [157.91], Avg: 225.2812 (0.420)
Ep: 289, Reward: 407.5142, Test: 468.4883 [131.65], Avg: 225.6659 (0.418)
Ep: 290, Reward: 299.2167, Test: 411.1892 [157.04], Avg: 225.7638 (0.417)
Ep: 291, Reward: 395.0254, Test: 432.2876 [172.18], Avg: 225.8814 (0.416)
Ep: 292, Reward: 456.7898, Test: 322.1415 [150.26], Avg: 225.6971 (0.415)
Ep: 293, Reward: 381.5416, Test: 379.2376 [132.35], Avg: 225.7691 (0.413)
Ep: 294, Reward: 388.9841, Test: 397.1493 [190.14], Avg: 225.7055 (0.412)
Ep: 295, Reward: 401.0457, Test: 485.0449 [120.34], Avg: 226.1751 (0.411)
Ep: 296, Reward: 467.9530, Test: 362.6260 [106.62], Avg: 226.2756 (0.410)
Ep: 297, Reward: 400.6824, Test: 386.3629 [123.94], Avg: 226.3969 (0.408)
Ep: 298, Reward: 373.2772, Test: 391.7721 [147.42], Avg: 226.4569 (0.407)
Ep: 299, Reward: 398.7893, Test: 504.2529 [231.58], Avg: 226.6110 (0.406)
Ep: 300, Reward: 403.7160, Test: 416.5679 [243.42], Avg: 226.4333 (0.405)
Ep: 301, Reward: 443.7631, Test: 383.5555 [208.47], Avg: 226.2633 (0.404)
Ep: 302, Reward: 449.0704, Test: 438.0915 [161.07], Avg: 226.4308 (0.402)
Ep: 303, Reward: 460.0761, Test: 450.2858 [173.45], Avg: 226.5966 (0.401)
Ep: 304, Reward: 426.0186, Test: 562.0095 [156.68], Avg: 227.1826 (0.400)
Ep: 305, Reward: 510.3509, Test: 454.0521 [170.77], Avg: 227.3660 (0.399)
Ep: 306, Reward: 435.3697, Test: 519.6283 [171.80], Avg: 227.7584 (0.398)
Ep: 307, Reward: 448.8759, Test: 375.4589 [146.47], Avg: 227.7624 (0.396)
Ep: 308, Reward: 516.6283, Test: 491.0432 [194.98], Avg: 227.9834 (0.395)
Ep: 309, Reward: 462.8789, Test: 491.1464 [175.40], Avg: 228.2665 (0.394)
Ep: 310, Reward: 425.6855, Test: 428.0719 [175.32], Avg: 228.3452 (0.393)
Ep: 311, Reward: 370.0038, Test: 380.9685 [205.04], Avg: 228.1772 (0.392)
Ep: 312, Reward: 340.6047, Test: 362.1801 [125.31], Avg: 228.2050 (0.390)
Ep: 313, Reward: 506.7313, Test: 388.4914 [187.75], Avg: 228.1175 (0.389)
Ep: 314, Reward: 472.8169, Test: 419.1538 [171.64], Avg: 228.1791 (0.388)
Ep: 315, Reward: 419.6009, Test: 431.4657 [154.96], Avg: 228.3320 (0.387)
Ep: 316, Reward: 448.9279, Test: 383.1037 [135.84], Avg: 228.3918 (0.386)
Ep: 317, Reward: 464.3399, Test: 483.0875 [200.30], Avg: 228.5628 (0.385)
Ep: 318, Reward: 389.1065, Test: 478.8057 [165.05], Avg: 228.8299 (0.383)
Ep: 319, Reward: 437.4557, Test: 535.0946 [170.50], Avg: 229.2541 (0.382)
Ep: 320, Reward: 423.3712, Test: 392.9980 [157.24], Avg: 229.2744 (0.381)
Ep: 321, Reward: 437.5722, Test: 452.4282 [146.09], Avg: 229.5137 (0.380)
Ep: 322, Reward: 409.8285, Test: 419.3319 [150.57], Avg: 229.6352 (0.379)
Ep: 323, Reward: 429.1403, Test: 385.9968 [152.47], Avg: 229.6473 (0.378)
Ep: 324, Reward: 397.1999, Test: 429.3196 [112.67], Avg: 229.9149 (0.377)
Ep: 325, Reward: 404.2767, Test: 413.6894 [187.98], Avg: 229.9020 (0.376)
Ep: 326, Reward: 421.4918, Test: 419.9531 [172.68], Avg: 229.9552 (0.374)
Ep: 327, Reward: 443.1510, Test: 391.3742 [189.84], Avg: 229.8685 (0.373)
Ep: 328, Reward: 381.3301, Test: 346.3226 [149.39], Avg: 229.7684 (0.372)
Ep: 329, Reward: 437.8890, Test: 453.9808 [166.72], Avg: 229.9426 (0.371)
Ep: 330, Reward: 450.9110, Test: 390.4511 [222.42], Avg: 229.7556 (0.370)
Ep: 331, Reward: 496.6019, Test: 494.4319 [172.52], Avg: 230.0332 (0.369)
Ep: 332, Reward: 405.8374, Test: 438.5723 [134.65], Avg: 230.2551 (0.368)
Ep: 333, Reward: 489.4685, Test: 289.2585 [130.55], Avg: 230.0409 (0.367)
Ep: 334, Reward: 460.1063, Test: 444.4068 [168.18], Avg: 230.1787 (0.365)
Ep: 335, Reward: 448.1262, Test: 388.4909 [193.44], Avg: 230.0742 (0.364)
Ep: 336, Reward: 393.0607, Test: 367.8869 [204.58], Avg: 229.8761 (0.363)
Ep: 337, Reward: 405.6712, Test: 391.2551 [245.96], Avg: 229.6258 (0.362)
Ep: 338, Reward: 487.1775, Test: 419.2693 [166.42], Avg: 229.6944 (0.361)
Ep: 339, Reward: 402.0032, Test: 391.4828 [213.91], Avg: 229.5411 (0.360)
Ep: 340, Reward: 342.3106, Test: 368.7968 [247.62], Avg: 229.2233 (0.359)
Ep: 341, Reward: 400.8053, Test: 480.8922 [173.30], Avg: 229.4524 (0.358)
Ep: 342, Reward: 449.8798, Test: 459.7391 [159.60], Avg: 229.6585 (0.357)
Ep: 343, Reward: 411.0847, Test: 372.9490 [176.64], Avg: 229.5615 (0.356)
Ep: 344, Reward: 497.1177, Test: 309.0484 [129.42], Avg: 229.4168 (0.355)
Ep: 345, Reward: 410.9759, Test: 419.7782 [216.94], Avg: 229.3400 (0.354)
Ep: 346, Reward: 437.1716, Test: 348.1153 [227.62], Avg: 229.0263 (0.353)
Ep: 347, Reward: 351.4611, Test: 428.3411 [176.30], Avg: 229.0925 (0.351)
Ep: 348, Reward: 462.4891, Test: 425.9479 [183.04], Avg: 229.1320 (0.350)
Ep: 349, Reward: 462.3099, Test: 414.9691 [200.44], Avg: 229.0903 (0.349)
Ep: 350, Reward: 369.9908, Test: 324.8792 [198.36], Avg: 228.7981 (0.348)
Ep: 351, Reward: 482.5549, Test: 313.9103 [171.01], Avg: 228.5541 (0.347)
Ep: 352, Reward: 413.1659, Test: 364.1725 [172.62], Avg: 228.4492 (0.346)
Ep: 353, Reward: 478.2652, Test: 374.3930 [221.66], Avg: 228.2353 (0.345)
Ep: 354, Reward: 456.1520, Test: 370.1472 [181.00], Avg: 228.1252 (0.344)
Ep: 355, Reward: 425.1344, Test: 478.5267 [184.76], Avg: 228.3096 (0.343)
Ep: 356, Reward: 341.5081, Test: 414.2415 [163.29], Avg: 228.3731 (0.342)
Ep: 357, Reward: 422.5467, Test: 325.9495 [178.96], Avg: 228.1457 (0.341)
Ep: 358, Reward: 490.6215, Test: 343.0344 [91.28], Avg: 228.2115 (0.340)
Ep: 359, Reward: 371.1753, Test: 399.4446 [165.37], Avg: 228.2278 (0.339)
Ep: 360, Reward: 428.7336, Test: 295.4275 [154.40], Avg: 227.9862 (0.338)
Ep: 361, Reward: 458.0169, Test: 371.5298 [174.10], Avg: 227.9018 (0.337)
Ep: 362, Reward: 451.2442, Test: 391.5506 [107.26], Avg: 228.0572 (0.336)
Ep: 363, Reward: 486.1379, Test: 466.9950 [198.65], Avg: 228.1678 (0.335)
Ep: 364, Reward: 452.9147, Test: 438.0801 [144.48], Avg: 228.3471 (0.334)
Ep: 365, Reward: 445.3100, Test: 474.4835 [179.32], Avg: 228.5297 (0.333)
Ep: 366, Reward: 352.4717, Test: 347.1299 [135.60], Avg: 228.4834 (0.332)
Ep: 367, Reward: 375.8513, Test: 457.6320 [148.89], Avg: 228.7014 (0.331)
Ep: 368, Reward: 456.3893, Test: 438.6221 [155.65], Avg: 228.8485 (0.330)
Ep: 369, Reward: 383.2175, Test: 389.9514 [118.80], Avg: 228.9628 (0.329)
Ep: 370, Reward: 399.0354, Test: 360.6694 [106.38], Avg: 229.0311 (0.328)
Ep: 371, Reward: 448.0125, Test: 395.3628 [175.97], Avg: 229.0052 (0.327)
Ep: 372, Reward: 451.2323, Test: 368.9776 [191.51], Avg: 228.8670 (0.326)
Ep: 373, Reward: 366.7249, Test: 406.1571 [153.08], Avg: 228.9318 (0.325)
Ep: 374, Reward: 469.8292, Test: 486.0238 [151.90], Avg: 229.2123 (0.324)
Ep: 375, Reward: 422.7386, Test: 368.1824 [150.93], Avg: 229.1805 (0.323)
Ep: 376, Reward: 313.5643, Test: 259.6688 [118.96], Avg: 228.9458 (0.322)
Ep: 377, Reward: 302.7797, Test: 445.3428 [154.01], Avg: 229.1108 (0.321)
Ep: 378, Reward: 424.7078, Test: 395.3274 [101.81], Avg: 229.2808 (0.320)
Ep: 379, Reward: 367.4256, Test: 308.1373 [148.05], Avg: 229.0987 (0.319)
Ep: 380, Reward: 396.6166, Test: 325.5165 [160.13], Avg: 228.9315 (0.318)
Ep: 381, Reward: 363.5417, Test: 355.5600 [243.39], Avg: 228.6258 (0.317)
Ep: 382, Reward: 372.6460, Test: 395.2201 [188.11], Avg: 228.5697 (0.316)
Ep: 383, Reward: 420.7696, Test: 363.0264 [157.61], Avg: 228.5094 (0.315)
Ep: 384, Reward: 302.2872, Test: 378.3199 [207.32], Avg: 228.3600 (0.315)
Ep: 385, Reward: 471.5860, Test: 359.1440 [181.61], Avg: 228.2283 (0.314)
Ep: 386, Reward: 386.8149, Test: 348.7940 [195.27], Avg: 228.0353 (0.313)
Ep: 387, Reward: 408.2387, Test: 446.3225 [218.65], Avg: 228.0343 (0.312)
Ep: 388, Reward: 351.2988, Test: 497.9931 [184.44], Avg: 228.2542 (0.311)
Ep: 389, Reward: 390.7225, Test: 358.5333 [125.46], Avg: 228.2665 (0.310)
Ep: 390, Reward: 407.6855, Test: 367.1413 [175.72], Avg: 228.1723 (0.309)
Ep: 391, Reward: 387.3278, Test: 425.9094 [205.56], Avg: 228.1523 (0.308)
Ep: 392, Reward: 401.7062, Test: 422.5267 [158.42], Avg: 228.2438 (0.307)
Ep: 393, Reward: 419.7340, Test: 306.2543 [101.26], Avg: 228.1848 (0.306)
Ep: 394, Reward: 345.3506, Test: 404.9945 [206.32], Avg: 228.1101 (0.305)
Ep: 395, Reward: 408.9321, Test: 433.7280 [201.88], Avg: 228.1196 (0.304)
Ep: 396, Reward: 438.1227, Test: 460.8905 [229.17], Avg: 228.1286 (0.303)
Ep: 397, Reward: 384.2197, Test: 481.7207 [209.49], Avg: 228.2394 (0.302)
Ep: 398, Reward: 369.7405, Test: 389.7550 [181.23], Avg: 228.1900 (0.302)
Ep: 399, Reward: 398.3975, Test: 482.2798 [187.70], Avg: 228.3560 (0.301)
Ep: 400, Reward: 420.9515, Test: 405.9745 [141.79], Avg: 228.4453 (0.300)
Ep: 401, Reward: 387.6357, Test: 458.1799 [215.11], Avg: 228.4817 (0.299)
Ep: 402, Reward: 495.4108, Test: 428.6771 [177.23], Avg: 228.5387 (0.298)
Ep: 403, Reward: 311.5577, Test: 369.4314 [144.49], Avg: 228.5298 (0.297)
Ep: 404, Reward: 412.8223, Test: 419.7714 [212.31], Avg: 228.4778 (0.296)
Ep: 405, Reward: 303.0386, Test: 332.3138 [211.12], Avg: 228.2135 (0.295)
Ep: 406, Reward: 502.2745, Test: 477.8356 [158.38], Avg: 228.4377 (0.294)
Ep: 407, Reward: 389.1735, Test: 393.0927 [150.46], Avg: 228.4725 (0.294)
Ep: 408, Reward: 369.9835, Test: 414.6999 [181.29], Avg: 228.4846 (0.293)
Ep: 409, Reward: 450.7508, Test: 419.7471 [215.37], Avg: 228.4258 (0.292)
Ep: 410, Reward: 426.2885, Test: 437.4921 [224.76], Avg: 228.3876 (0.291)
Ep: 411, Reward: 423.6134, Test: 445.5800 [130.54], Avg: 228.5979 (0.290)
Ep: 412, Reward: 338.3113, Test: 323.7378 [155.29], Avg: 228.4523 (0.289)
Ep: 413, Reward: 341.2828, Test: 367.9547 [231.05], Avg: 228.2311 (0.288)
Ep: 414, Reward: 383.9963, Test: 334.0741 [191.73], Avg: 228.0242 (0.287)
Ep: 415, Reward: 468.2701, Test: 487.1074 [231.52], Avg: 228.0905 (0.287)
Ep: 416, Reward: 423.3002, Test: 414.1791 [142.48], Avg: 228.1950 (0.286)
Ep: 417, Reward: 425.9393, Test: 414.8817 [148.99], Avg: 228.2852 (0.285)
Ep: 418, Reward: 428.6332, Test: 398.5210 [230.84], Avg: 228.1406 (0.284)
Ep: 419, Reward: 394.8919, Test: 458.9309 [156.09], Avg: 228.3184 (0.283)
Ep: 420, Reward: 449.1784, Test: 387.4120 [221.74], Avg: 228.1696 (0.282)
Ep: 421, Reward: 422.2742, Test: 438.1728 [122.94], Avg: 228.3759 (0.281)
Ep: 422, Reward: 341.2158, Test: 360.2047 [240.95], Avg: 228.1180 (0.281)
Ep: 423, Reward: 337.0623, Test: 325.7629 [166.09], Avg: 227.9565 (0.280)
Ep: 424, Reward: 342.3230, Test: 318.2187 [120.31], Avg: 227.8858 (0.279)
Ep: 425, Reward: 367.0590, Test: 406.7288 [294.78], Avg: 227.6137 (0.278)
Ep: 426, Reward: 429.8086, Test: 412.7128 [198.21], Avg: 227.5830 (0.277)
Ep: 427, Reward: 381.2008, Test: 437.3765 [171.83], Avg: 227.6717 (0.276)
Ep: 428, Reward: 300.0979, Test: 303.3584 [134.20], Avg: 227.5353 (0.276)
Ep: 429, Reward: 293.9597, Test: 330.6288 [133.59], Avg: 227.4644 (0.275)
Ep: 430, Reward: 391.8877, Test: 335.7887 [123.94], Avg: 227.4282 (0.274)
Ep: 431, Reward: 374.2156, Test: 416.1759 [204.29], Avg: 227.3922 (0.273)
Ep: 432, Reward: 381.8604, Test: 428.4026 [149.95], Avg: 227.5101 (0.272)
Ep: 433, Reward: 416.6963, Test: 460.5295 [195.56], Avg: 227.5964 (0.271)
Ep: 434, Reward: 387.5679, Test: 375.1962 [151.21], Avg: 227.5881 (0.271)
Ep: 435, Reward: 424.0803, Test: 311.0226 [55.10], Avg: 227.6531 (0.270)
Ep: 436, Reward: 467.7652, Test: 434.9144 [163.05], Avg: 227.7543 (0.269)
Ep: 437, Reward: 404.9691, Test: 313.5188 [196.70], Avg: 227.5010 (0.268)
Ep: 438, Reward: 399.9751, Test: 375.1512 [187.28], Avg: 227.4107 (0.267)
Ep: 439, Reward: 420.2108, Test: 330.3773 [213.70], Avg: 227.1590 (0.267)
Ep: 440, Reward: 424.0927, Test: 459.2795 [211.24], Avg: 227.2064 (0.266)
Ep: 441, Reward: 351.7350, Test: 331.2142 [159.65], Avg: 227.0805 (0.265)
Ep: 442, Reward: 444.3595, Test: 477.9081 [185.62], Avg: 227.2277 (0.264)
Ep: 443, Reward: 444.5494, Test: 343.9528 [215.49], Avg: 227.0052 (0.263)
Ep: 444, Reward: 475.1593, Test: 480.5946 [215.39], Avg: 227.0911 (0.263)
Ep: 445, Reward: 421.4334, Test: 372.0653 [97.86], Avg: 227.1967 (0.262)
Ep: 446, Reward: 523.2065, Test: 416.8930 [145.36], Avg: 227.2959 (0.261)
Ep: 447, Reward: 387.3375, Test: 491.5853 [177.82], Avg: 227.4889 (0.260)
Ep: 448, Reward: 477.3494, Test: 350.8525 [199.55], Avg: 227.3192 (0.259)
Ep: 449, Reward: 468.1230, Test: 468.7571 [170.13], Avg: 227.4777 (0.259)
Ep: 450, Reward: 306.6740, Test: 449.6330 [162.26], Avg: 227.6105 (0.258)
Ep: 451, Reward: 395.3709, Test: 477.7971 [253.67], Avg: 227.6028 (0.257)
Ep: 452, Reward: 307.1484, Test: 436.1891 [258.18], Avg: 227.4933 (0.256)
Ep: 453, Reward: 394.1350, Test: 507.5379 [132.30], Avg: 227.8187 (0.256)
Ep: 454, Reward: 407.1479, Test: 416.9223 [182.65], Avg: 227.8329 (0.255)
Ep: 455, Reward: 347.7661, Test: 355.4499 [135.22], Avg: 227.8162 (0.254)
Ep: 456, Reward: 383.9659, Test: 410.6941 [223.97], Avg: 227.7263 (0.253)
Ep: 457, Reward: 404.1648, Test: 324.3997 [83.30], Avg: 227.7555 (0.253)
Ep: 458, Reward: 353.8677, Test: 498.7981 [201.10], Avg: 227.9079 (0.252)
Ep: 459, Reward: 346.8385, Test: 424.4372 [158.57], Avg: 227.9904 (0.251)
Ep: 460, Reward: 427.9644, Test: 372.9942 [154.45], Avg: 227.9699 (0.250)
Ep: 461, Reward: 417.3992, Test: 381.1286 [173.54], Avg: 227.9258 (0.250)
Ep: 462, Reward: 440.9576, Test: 375.9528 [209.76], Avg: 227.7925 (0.249)
Ep: 463, Reward: 407.7594, Test: 446.5812 [142.68], Avg: 227.9565 (0.248)
Ep: 464, Reward: 300.9841, Test: 411.6184 [134.03], Avg: 228.0633 (0.247)
Ep: 465, Reward: 473.3762, Test: 392.7258 [196.57], Avg: 227.9948 (0.247)
Ep: 466, Reward: 340.6554, Test: 369.7169 [173.42], Avg: 227.9269 (0.246)
Ep: 467, Reward: 410.2522, Test: 285.6791 [188.97], Avg: 227.6465 (0.245)
Ep: 468, Reward: 392.5351, Test: 332.1358 [103.41], Avg: 227.6488 (0.244)
Ep: 469, Reward: 482.3169, Test: 369.7165 [159.85], Avg: 227.6110 (0.244)
Ep: 470, Reward: 392.9758, Test: 263.8460 [174.19], Avg: 227.3181 (0.243)
Ep: 471, Reward: 387.2790, Test: 297.7295 [184.49], Avg: 227.0764 (0.242)
Ep: 472, Reward: 325.7266, Test: 445.8772 [215.21], Avg: 227.0840 (0.241)
Ep: 473, Reward: 414.9674, Test: 380.9395 [192.84], Avg: 227.0018 (0.241)
Ep: 474, Reward: 435.6453, Test: 373.1749 [151.15], Avg: 226.9913 (0.240)
Ep: 475, Reward: 317.5907, Test: 444.2880 [159.36], Avg: 227.1130 (0.239)
Ep: 476, Reward: 484.6891, Test: 385.7772 [123.27], Avg: 227.1872 (0.239)
Ep: 477, Reward: 429.4031, Test: 427.8935 [245.14], Avg: 227.0942 (0.238)
Ep: 478, Reward: 483.8216, Test: 471.7707 [164.76], Avg: 227.2611 (0.237)
Ep: 479, Reward: 407.4968, Test: 431.2408 [208.05], Avg: 227.2526 (0.236)
Ep: 480, Reward: 415.7219, Test: 487.4129 [251.43], Avg: 227.2707 (0.236)
Ep: 481, Reward: 372.3417, Test: 421.9776 [181.93], Avg: 227.2973 (0.235)
Ep: 482, Reward: 387.1527, Test: 424.9381 [201.96], Avg: 227.2883 (0.234)
Ep: 483, Reward: 429.0227, Test: 376.5880 [211.30], Avg: 227.1602 (0.234)
Ep: 484, Reward: 351.7738, Test: 417.4353 [164.51], Avg: 227.2134 (0.233)
Ep: 485, Reward: 341.2161, Test: 360.9436 [96.82], Avg: 227.2893 (0.232)
Ep: 486, Reward: 377.0989, Test: 432.3467 [119.55], Avg: 227.4649 (0.231)
Ep: 487, Reward: 390.3307, Test: 301.5815 [172.08], Avg: 227.2641 (0.231)
Ep: 488, Reward: 379.1359, Test: 364.7429 [199.00], Avg: 227.1383 (0.230)
Ep: 489, Reward: 418.5507, Test: 380.6774 [185.40], Avg: 227.0733 (0.229)
Ep: 490, Reward: 361.3602, Test: 300.4895 [135.27], Avg: 226.9473 (0.229)
Ep: 491, Reward: 333.9497, Test: 374.2902 [117.77], Avg: 227.0074 (0.228)
Ep: 492, Reward: 477.5138, Test: 444.5521 [159.84], Avg: 227.1245 (0.227)
Ep: 493, Reward: 442.6912, Test: 434.1896 [210.23], Avg: 227.1181 (0.227)
Ep: 494, Reward: 407.3312, Test: 418.9065 [168.98], Avg: 227.1641 (0.226)
Ep: 495, Reward: 407.0587, Test: 311.9313 [155.38], Avg: 227.0218 (0.225)
Ep: 496, Reward: 437.4052, Test: 341.5554 [167.78], Avg: 226.9146 (0.225)
Ep: 497, Reward: 377.7228, Test: 285.9571 [97.49], Avg: 226.8374 (0.224)
Ep: 498, Reward: 379.5842, Test: 343.8103 [193.51], Avg: 226.6840 (0.223)
Ep: 499, Reward: 421.3980, Test: 435.3802 [145.41], Avg: 226.8106 (0.223)
