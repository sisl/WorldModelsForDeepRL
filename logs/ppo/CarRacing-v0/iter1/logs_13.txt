Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 32,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.5                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 1.000             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.005				# The limit of the ratio of new action probabilities to old probabilities
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 20					# The number of steps to collect experience in sequence for each GAE calculation
ADVANTAGE_DECAY = 0.99			# The discount factor for the cumulative GAE calculation

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			value = self.critic_local(state.to(self.device))
			return value

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=1, clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) + critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)
		self.replay_buffer = PrioritizedReplayBuffer()
		self.ppo_epochs = PPO_EPOCHS
		self.ppo_batch = BATCH_SIZE

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.0):
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(zip(states, actions, log_probs, targets, advantages))
			for _ in range(self.ppo_epochs):
				self.replay_buffer.reset_priorities()
				for _ in range(states.size(0)//self.ppo_batch):
					(state, action, log_prob, target, advantage), indices, importances = self.replay_buffer.sample(self.ppo_batch, dtype=torch.stack)
					errors = self.network.optimize(state, action, log_prob, target, advantage, importances**(1-self.eps), scale=self.eps)
					self.replay_buffer.update_priorities(indices, errors)
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.0225               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -29.4174, Test: -19.9055 [15.26], Avg: -35.1639 (1.000)
Ep: 1, Reward: -29.2670, Test: -13.5023 [19.39], Avg: -34.0268 (1.000)
Ep: 2, Reward: -28.8448, Test: -12.9443 [19.31], Avg: -33.4348 (1.000)
Ep: 3, Reward: -27.5751, Test: -29.0464 [5.64], Avg: -33.7483 (1.000)
Ep: 4, Reward: -24.5767, Test: -23.5907 [15.55], Avg: -34.8263 (1.000)
Ep: 5, Reward: -22.0053, Test: -30.3785 [6.40], Avg: -35.1520 (1.000)
Ep: 6, Reward: -25.5826, Test: -25.5798 [18.45], Avg: -36.4196 (1.000)
Ep: 7, Reward: -23.0438, Test: -24.6044 [10.29], Avg: -36.2292 (1.000)
Ep: 8, Reward: -25.7790, Test: -30.4316 [5.12], Avg: -36.1537 (1.000)
Ep: 9, Reward: -27.1464, Test: -14.7849 [24.95], Avg: -36.5122 (1.000)
Ep: 10, Reward: -24.4279, Test: -16.5907 [18.81], Avg: -36.4110 (1.000)
Ep: 11, Reward: -35.5309, Test: -22.7634 [11.70], Avg: -36.2489 (1.000)
Ep: 12, Reward: -37.8537, Test: -11.6910 [25.80], Avg: -36.3442 (1.000)
Ep: 13, Reward: -39.1086, Test: -23.6525 [13.24], Avg: -36.3836 (1.000)
Ep: 14, Reward: -39.3178, Test: -17.9046 [5.87], Avg: -35.5430 (1.000)
Ep: 15, Reward: -44.9630, Test: -26.8555 [10.98], Avg: -35.6865 (1.000)
Ep: 16, Reward: -39.1756, Test: -41.7890 [36.03], Avg: -38.1649 (1.000)
Ep: 17, Reward: -42.6233, Test: -40.1102 [16.92], Avg: -39.2131 (1.000)
Ep: 18, Reward: -51.3883, Test: -46.5962 [16.57], Avg: -40.4737 (1.000)
Ep: 19, Reward: -50.0649, Test: -44.7151 [10.08], Avg: -41.1895 (1.000)
Ep: 20, Reward: -50.7627, Test: -46.6078 [12.41], Avg: -42.0383 (1.000)
Ep: 21, Reward: -59.7521, Test: -66.7680 [20.29], Avg: -44.0847 (1.000)
Ep: 22, Reward: -64.0747, Test: -50.0955 [6.95], Avg: -44.6482 (1.000)
Ep: 23, Reward: -64.7919, Test: -47.7005 [9.51], Avg: -45.1718 (1.000)
Ep: 24, Reward: -65.6399, Test: -61.5006 [6.13], Avg: -46.0699 (1.000)
Ep: 25, Reward: -68.2096, Test: -82.2962 [1.47], Avg: -47.5198 (1.000)
Ep: 26, Reward: -61.6933, Test: -75.8603 [6.93], Avg: -48.8261 (1.000)
Ep: 27, Reward: -67.4298, Test: -81.7789 [2.02], Avg: -50.0751 (1.000)
Ep: 28, Reward: -66.4427, Test: -82.7777 [1.21], Avg: -51.2444 (1.000)
Ep: 29, Reward: -68.6495, Test: -82.4155 [1.11], Avg: -52.3206 (1.000)
Ep: 30, Reward: -70.9036, Test: -81.6037 [3.86], Avg: -53.3898 (1.000)
Ep: 31, Reward: -71.2982, Test: -80.0283 [3.75], Avg: -54.3394 (1.000)
Ep: 32, Reward: -69.1170, Test: -78.1331 [4.60], Avg: -55.1998 (1.000)
Ep: 33, Reward: -66.3133, Test: -72.6561 [6.71], Avg: -55.9106 (1.000)
Ep: 34, Reward: -59.4405, Test: -63.6501 [6.79], Avg: -56.3256 (1.000)
Ep: 35, Reward: -46.6602, Test: -58.1129 [18.02], Avg: -56.8759 (1.000)
Ep: 36, Reward: -21.6205, Test: 10.5110 [58.54], Avg: -56.6369 (1.000)
Ep: 37, Reward: -1.5187, Test: -16.5438 [70.72], Avg: -57.4429 (1.000)
Ep: 38, Reward: 31.3768, Test: 22.9614 [52.73], Avg: -56.7333 (1.000)
Ep: 39, Reward: 30.9378, Test: 50.1552 [54.71], Avg: -55.4288 (1.000)
Ep: 40, Reward: 97.4342, Test: 100.7809 [81.41], Avg: -53.6044 (1.000)
Ep: 41, Reward: 197.9143, Test: 93.0386 [81.58], Avg: -52.0553 (1.000)
Ep: 42, Reward: 230.9760, Test: 108.5232 [102.19], Avg: -50.6974 (1.000)
Ep: 43, Reward: 222.8779, Test: 129.6131 [108.51], Avg: -49.0654 (1.000)
Ep: 44, Reward: 337.5851, Test: 144.7375 [94.07], Avg: -46.8493 (1.000)
Ep: 45, Reward: 293.7189, Test: 129.6362 [103.45], Avg: -45.2615 (1.000)
Ep: 46, Reward: 316.6388, Test: 138.6783 [125.24], Avg: -44.0126 (1.000)
Ep: 47, Reward: 259.9360, Test: 149.7416 [121.24], Avg: -42.5019 (1.000)
Ep: 48, Reward: 284.1547, Test: 130.2573 [96.02], Avg: -40.9358 (1.000)
Ep: 49, Reward: 225.8080, Test: 131.0910 [86.66], Avg: -39.2285 (1.000)
Ep: 50, Reward: 266.1738, Test: 211.1054 [81.41], Avg: -35.9162 (1.000)
Ep: 51, Reward: 368.3160, Test: 226.1555 [47.62], Avg: -31.7921 (1.000)
Ep: 52, Reward: 270.6692, Test: 206.6419 [69.18], Avg: -28.5986 (1.000)
Ep: 53, Reward: 388.4357, Test: 177.5873 [65.95], Avg: -26.0017 (1.000)
Ep: 54, Reward: 366.3755, Test: 185.7979 [79.29], Avg: -23.5924 (1.000)
Ep: 55, Reward: 380.1396, Test: 223.1888 [70.09], Avg: -20.4373 (1.000)
Ep: 56, Reward: 342.6116, Test: 168.8375 [79.87], Avg: -18.5179 (1.000)
Ep: 57, Reward: 274.3003, Test: 185.7354 [98.78], Avg: -16.6994 (1.000)
Ep: 58, Reward: 311.8320, Test: 157.7665 [89.82], Avg: -15.2647 (1.000)
Ep: 59, Reward: 256.3997, Test: 143.8809 [77.49], Avg: -13.9038 (1.000)
Ep: 60, Reward: 249.2971, Test: 197.8059 [53.00], Avg: -11.3020 (1.000)
Ep: 61, Reward: 254.9558, Test: 201.6864 [47.98], Avg: -8.6406 (1.000)
Ep: 62, Reward: 255.6362, Test: 153.0567 [89.97], Avg: -7.5020 (1.000)
Ep: 63, Reward: 241.3864, Test: 202.7643 [18.92], Avg: -4.5123 (1.000)
Ep: 64, Reward: 238.3164, Test: 175.4108 [116.06], Avg: -3.5298 (1.000)
Ep: 65, Reward: 169.8642, Test: 154.4091 [96.74], Avg: -2.6025 (1.000)
Ep: 66, Reward: 254.4851, Test: 163.0999 [112.33], Avg: -1.8060 (1.000)
Ep: 67, Reward: 269.8935, Test: 156.2569 [103.36], Avg: -1.0015 (1.000)
Ep: 68, Reward: 256.7711, Test: 114.6224 [104.57], Avg: -0.8412 (1.000)
Ep: 69, Reward: 181.7423, Test: 118.9582 [92.03], Avg: -0.4446 (1.000)
Ep: 70, Reward: 209.6811, Test: 100.6839 [96.09], Avg: -0.3735 (1.000)
Ep: 71, Reward: 202.2916, Test: 135.9517 [96.18], Avg: 0.1840 (1.000)
Ep: 72, Reward: 177.1054, Test: 124.0350 [119.24], Avg: 0.2472 (1.000)
Ep: 73, Reward: 192.0821, Test: 147.2442 [101.96], Avg: 0.8558 (1.000)
Ep: 74, Reward: 205.9778, Test: 165.3135 [78.04], Avg: 2.0081 (1.000)
Ep: 75, Reward: 176.4963, Test: 178.1959 [73.54], Avg: 3.3587 (1.000)
Ep: 76, Reward: 223.1889, Test: 110.3158 [62.79], Avg: 3.9323 (1.000)
Ep: 77, Reward: 219.0462, Test: 139.6662 [91.82], Avg: 4.4953 (1.000)
Ep: 78, Reward: 177.1059, Test: 165.5208 [67.25], Avg: 5.6824 (1.000)
Ep: 79, Reward: 195.6563, Test: 183.2527 [58.23], Avg: 7.1741 (1.000)
Ep: 80, Reward: 180.1840, Test: 204.7493 [55.21], Avg: 8.9318 (1.000)
Ep: 81, Reward: 210.4105, Test: 119.1365 [83.93], Avg: 9.2522 (1.000)
Ep: 82, Reward: 201.0336, Test: 130.6319 [96.95], Avg: 9.5465 (1.000)
Ep: 83, Reward: 157.4203, Test: 110.8031 [86.33], Avg: 9.7241 (1.000)
Ep: 84, Reward: 165.6153, Test: 192.5038 [92.34], Avg: 10.7881 (1.000)
Ep: 85, Reward: 195.2509, Test: 137.1970 [97.78], Avg: 11.1210 (1.000)
Ep: 86, Reward: 169.2316, Test: 165.1552 [72.85], Avg: 12.0542 (1.000)
Ep: 87, Reward: 183.3689, Test: 136.0922 [93.30], Avg: 12.4034 (1.000)
Ep: 88, Reward: 214.8987, Test: 165.9787 [92.57], Avg: 13.0889 (1.000)
Ep: 89, Reward: 205.3540, Test: 197.0584 [63.85], Avg: 14.4235 (1.000)
Ep: 90, Reward: 174.3414, Test: 157.7234 [90.24], Avg: 15.0066 (1.000)
Ep: 91, Reward: 158.1738, Test: 172.4578 [74.03], Avg: 15.9134 (1.000)
Ep: 92, Reward: 161.2144, Test: 148.8129 [85.74], Avg: 16.4205 (1.000)
Ep: 93, Reward: 169.2201, Test: 194.8097 [82.30], Avg: 17.4427 (1.000)
Ep: 94, Reward: 159.0597, Test: 143.0360 [93.03], Avg: 17.7854 (1.000)
Ep: 95, Reward: 163.1280, Test: 166.0116 [90.49], Avg: 18.3868 (1.000)
Ep: 96, Reward: 173.5719, Test: 162.0057 [104.27], Avg: 18.7925 (1.000)
Ep: 97, Reward: 167.5472, Test: 194.4435 [72.91], Avg: 19.8408 (1.000)
Ep: 98, Reward: 184.8064, Test: 133.1928 [76.06], Avg: 20.2175 (1.000)
Ep: 99, Reward: 143.9519, Test: 207.1452 [75.78], Avg: 21.3289 (1.000)
Ep: 100, Reward: 167.6749, Test: 192.4899 [88.66], Avg: 22.1458 (1.000)
Ep: 101, Reward: 167.4197, Test: 174.1647 [86.72], Avg: 22.7859 (1.000)
Ep: 102, Reward: 181.2020, Test: 160.6824 [85.09], Avg: 23.2986 (1.000)
Ep: 103, Reward: 193.4410, Test: 179.6440 [102.71], Avg: 23.8143 (1.000)
Ep: 104, Reward: 178.0822, Test: 191.4476 [92.07], Avg: 24.5340 (1.000)
Ep: 105, Reward: 190.1599, Test: 149.3328 [80.32], Avg: 24.9536 (1.000)
Ep: 106, Reward: 178.0945, Test: 176.6373 [71.57], Avg: 25.7023 (1.000)
Ep: 107, Reward: 190.4130, Test: 152.7966 [106.40], Avg: 25.8939 (1.000)
Ep: 108, Reward: 165.5316, Test: 178.0759 [86.13], Avg: 26.4999 (1.000)
Ep: 109, Reward: 136.6350, Test: 243.5659 [69.14], Avg: 27.8447 (1.000)
Ep: 110, Reward: 197.4375, Test: 166.7716 [120.75], Avg: 28.0084 (1.000)
Ep: 111, Reward: 178.6127, Test: 171.6626 [104.98], Avg: 28.3538 (1.000)
Ep: 112, Reward: 180.9667, Test: 155.6857 [92.13], Avg: 28.6652 (1.000)
Ep: 113, Reward: 171.3681, Test: 153.9410 [154.05], Avg: 28.4128 (1.000)
Ep: 114, Reward: 125.2664, Test: 171.9787 [109.88], Avg: 28.7057 (1.000)
Ep: 115, Reward: 222.1587, Test: 150.0146 [106.52], Avg: 28.8332 (1.000)
Ep: 116, Reward: 167.5067, Test: 107.2401 [87.97], Avg: 28.7514 (1.000)
Ep: 117, Reward: 196.4718, Test: 167.3759 [97.25], Avg: 29.1020 (1.000)
Ep: 118, Reward: 208.9354, Test: 182.7016 [100.16], Avg: 29.5511 (1.000)
Ep: 119, Reward: 201.2164, Test: 158.5310 [91.38], Avg: 29.8644 (1.000)
Ep: 120, Reward: 183.1481, Test: 256.4019 [96.46], Avg: 30.9394 (1.000)
Ep: 121, Reward: 222.8370, Test: 127.9295 [92.94], Avg: 30.9726 (1.000)
Ep: 122, Reward: 177.1118, Test: 239.1007 [44.01], Avg: 32.3069 (1.000)
Ep: 123, Reward: 212.5715, Test: 204.8026 [57.39], Avg: 33.2352 (1.000)
Ep: 124, Reward: 194.0421, Test: 151.9410 [102.45], Avg: 33.3652 (1.000)
Ep: 125, Reward: 165.2975, Test: 236.9712 [121.15], Avg: 34.0197 (1.000)
Ep: 126, Reward: 173.9422, Test: 225.5769 [55.03], Avg: 35.0947 (1.000)
Ep: 127, Reward: 187.0297, Test: 156.3206 [110.49], Avg: 35.1785 (1.000)
Ep: 128, Reward: 161.8220, Test: 127.3898 [90.74], Avg: 35.1899 (1.000)
Ep: 129, Reward: 182.3076, Test: 234.5282 [54.68], Avg: 36.3027 (1.000)
Ep: 130, Reward: 239.5150, Test: 176.8100 [111.50], Avg: 36.5241 (1.000)
Ep: 131, Reward: 240.5784, Test: 141.7462 [86.80], Avg: 36.6637 (1.000)
Ep: 132, Reward: 210.3215, Test: 178.6018 [73.32], Avg: 37.1796 (1.000)
Ep: 133, Reward: 231.7482, Test: 214.2194 [64.09], Avg: 38.0225 (1.000)
Ep: 134, Reward: 188.3210, Test: 147.5065 [90.42], Avg: 38.1637 (1.000)
Ep: 135, Reward: 212.0066, Test: 181.0562 [91.82], Avg: 38.5392 (1.000)
Ep: 136, Reward: 213.6647, Test: 213.0547 [69.50], Avg: 39.3058 (1.000)
Ep: 137, Reward: 210.4642, Test: 219.3506 [30.17], Avg: 40.3918 (1.000)
Ep: 138, Reward: 198.9953, Test: 178.9607 [86.99], Avg: 40.7629 (1.000)
Ep: 139, Reward: 193.1671, Test: 194.1524 [76.27], Avg: 41.3138 (1.000)
Ep: 140, Reward: 204.2312, Test: 189.5120 [59.60], Avg: 41.9421 (1.000)
Ep: 141, Reward: 180.0914, Test: 169.3199 [93.53], Avg: 42.1805 (1.000)
Ep: 142, Reward: 192.9490, Test: 223.9349 [79.40], Avg: 42.8963 (1.000)
Ep: 143, Reward: 181.6497, Test: 143.9476 [74.28], Avg: 43.0822 (1.000)
Ep: 144, Reward: 173.7662, Test: 145.3615 [90.56], Avg: 43.1630 (1.000)
Ep: 145, Reward: 201.2857, Test: 141.8851 [85.50], Avg: 43.2536 (1.000)
Ep: 146, Reward: 224.1209, Test: 220.2733 [78.82], Avg: 43.9216 (1.000)
Ep: 147, Reward: 168.4816, Test: 158.3034 [97.57], Avg: 44.0352 (1.000)
Ep: 148, Reward: 204.7892, Test: 195.1230 [75.78], Avg: 44.5406 (1.000)
Ep: 149, Reward: 208.4019, Test: 201.5945 [68.39], Avg: 45.1317 (1.000)
Ep: 150, Reward: 199.3781, Test: 171.1491 [76.81], Avg: 45.4576 (1.000)
Ep: 151, Reward: 205.0883, Test: 195.8510 [66.50], Avg: 46.0095 (1.000)
Ep: 152, Reward: 220.8220, Test: 234.8527 [24.17], Avg: 47.0858 (1.000)
Ep: 153, Reward: 221.1633, Test: 200.8767 [80.36], Avg: 47.5626 (1.000)
Ep: 154, Reward: 203.9072, Test: 193.0992 [112.85], Avg: 47.7735 (1.000)
Ep: 155, Reward: 220.4203, Test: 211.3560 [71.17], Avg: 48.3659 (1.000)
Ep: 156, Reward: 183.6055, Test: 181.8284 [65.92], Avg: 48.7961 (1.000)
Ep: 157, Reward: 210.4502, Test: 212.9735 [65.12], Avg: 49.4230 (1.000)
Ep: 158, Reward: 200.7629, Test: 114.2125 [80.88], Avg: 49.3218 (1.000)
Ep: 159, Reward: 250.3271, Test: 242.2017 [84.09], Avg: 50.0017 (1.000)
Ep: 160, Reward: 232.5993, Test: 217.9724 [88.13], Avg: 50.4976 (1.000)
Ep: 161, Reward: 260.9348, Test: 233.3652 [80.92], Avg: 51.1270 (1.000)
Ep: 162, Reward: 208.1738, Test: 233.3981 [93.45], Avg: 51.6719 (1.000)
Ep: 163, Reward: 196.0161, Test: 207.1488 [86.90], Avg: 52.0900 (1.000)
Ep: 164, Reward: 278.3105, Test: 235.1564 [76.80], Avg: 52.7341 (1.000)
Ep: 165, Reward: 248.6789, Test: 202.7688 [104.44], Avg: 53.0087 (1.000)
Ep: 166, Reward: 285.4415, Test: 179.1957 [108.88], Avg: 53.1123 (1.000)
Ep: 167, Reward: 242.6093, Test: 279.9301 [62.19], Avg: 54.0922 (1.000)
Ep: 168, Reward: 240.6741, Test: 191.5423 [84.67], Avg: 54.4046 (1.000)
Ep: 169, Reward: 261.7914, Test: 213.6884 [102.30], Avg: 54.7398 (1.000)
Ep: 170, Reward: 262.6484, Test: 185.0557 [111.55], Avg: 54.8495 (1.000)
Ep: 171, Reward: 265.9048, Test: 265.3972 [58.06], Avg: 55.7361 (1.000)
Ep: 172, Reward: 312.0151, Test: 233.2454 [101.46], Avg: 56.1757 (1.000)
Ep: 173, Reward: 264.2404, Test: 200.0422 [71.11], Avg: 56.5938 (1.000)
Ep: 174, Reward: 266.3401, Test: 251.1326 [42.37], Avg: 57.4633 (1.000)
Ep: 175, Reward: 275.4469, Test: 192.2274 [99.08], Avg: 57.6661 (1.000)
Ep: 176, Reward: 281.7884, Test: 182.5548 [65.05], Avg: 58.0042 (1.000)
Ep: 177, Reward: 278.7871, Test: 198.9749 [129.20], Avg: 58.0703 (1.000)
Ep: 178, Reward: 268.9323, Test: 155.1382 [111.95], Avg: 57.9872 (1.000)
Ep: 179, Reward: 284.8805, Test: 213.9824 [119.21], Avg: 58.1915 (1.000)
Ep: 180, Reward: 269.3594, Test: 180.5929 [100.26], Avg: 58.3139 (1.000)
Ep: 181, Reward: 271.8829, Test: 144.8108 [95.78], Avg: 58.2629 (1.000)
Ep: 182, Reward: 270.6733, Test: 195.1303 [100.10], Avg: 58.4638 (1.000)
Ep: 183, Reward: 272.5841, Test: 151.3201 [108.99], Avg: 58.3761 (1.000)
Ep: 184, Reward: 256.9579, Test: 201.5380 [109.71], Avg: 58.5570 (1.000)
Ep: 185, Reward: 295.5466, Test: 257.5749 [140.92], Avg: 58.8693 (1.000)
Ep: 186, Reward: 327.5219, Test: 212.2785 [96.90], Avg: 59.1715 (1.000)
Ep: 187, Reward: 300.7820, Test: 249.1733 [89.46], Avg: 59.7063 (1.000)
Ep: 188, Reward: 320.6893, Test: 192.3510 [145.44], Avg: 59.6386 (1.000)
Ep: 189, Reward: 324.4701, Test: 200.4954 [125.63], Avg: 59.7187 (1.000)
Ep: 190, Reward: 284.0440, Test: 217.4526 [126.19], Avg: 59.8839 (1.000)
Ep: 191, Reward: 409.5671, Test: 186.1169 [128.74], Avg: 59.8708 (1.000)
Ep: 192, Reward: 318.9700, Test: 227.8250 [171.07], Avg: 59.8547 (1.000)
Ep: 193, Reward: 370.0715, Test: 251.3650 [121.85], Avg: 60.2138 (1.000)
Ep: 194, Reward: 328.0023, Test: 218.8253 [91.01], Avg: 60.5605 (1.000)
Ep: 195, Reward: 412.4301, Test: 178.0303 [106.68], Avg: 60.6155 (1.000)
Ep: 196, Reward: 339.2978, Test: 278.7051 [87.21], Avg: 61.2799 (1.000)
Ep: 197, Reward: 377.9627, Test: 287.0600 [116.02], Avg: 61.8342 (1.000)
Ep: 198, Reward: 320.8994, Test: 319.5586 [133.42], Avg: 62.4589 (1.000)
Ep: 199, Reward: 352.1884, Test: 284.9628 [87.56], Avg: 63.1336 (1.000)
Ep: 200, Reward: 365.3431, Test: 278.0709 [107.43], Avg: 63.6684 (1.000)
Ep: 201, Reward: 336.2884, Test: 222.5331 [118.39], Avg: 63.8688 (1.000)
Ep: 202, Reward: 361.9623, Test: 274.9554 [135.61], Avg: 64.2406 (1.000)
Ep: 203, Reward: 421.9698, Test: 278.5001 [130.78], Avg: 64.6498 (1.000)
Ep: 204, Reward: 416.5202, Test: 301.6602 [91.35], Avg: 65.3603 (1.000)
Ep: 205, Reward: 414.4974, Test: 222.1977 [110.72], Avg: 65.5842 (1.000)
Ep: 206, Reward: 353.6231, Test: 150.5379 [131.58], Avg: 65.3590 (1.000)
Ep: 207, Reward: 442.1674, Test: 223.7898 [106.17], Avg: 65.6103 (1.000)
Ep: 208, Reward: 382.4839, Test: 289.4593 [126.59], Avg: 66.0756 (1.000)
Ep: 209, Reward: 388.5642, Test: 250.8675 [126.05], Avg: 66.3554 (1.000)
Ep: 210, Reward: 346.7327, Test: 254.8395 [108.66], Avg: 66.7337 (1.000)
Ep: 211, Reward: 355.3586, Test: 189.3401 [168.16], Avg: 66.5188 (1.000)
Ep: 212, Reward: 384.3238, Test: 234.0094 [120.32], Avg: 66.7403 (1.000)
Ep: 213, Reward: 350.8881, Test: 277.8116 [107.80], Avg: 67.2228 (1.000)
Ep: 214, Reward: 390.4500, Test: 323.6282 [104.84], Avg: 67.9278 (1.000)
Ep: 215, Reward: 443.0359, Test: 254.7299 [98.90], Avg: 68.3348 (1.000)
Ep: 216, Reward: 412.0374, Test: 304.1756 [120.03], Avg: 68.8685 (1.000)
Ep: 217, Reward: 367.2321, Test: 260.9335 [142.62], Avg: 69.0953 (1.000)
Ep: 218, Reward: 369.8516, Test: 225.7607 [113.43], Avg: 69.2927 (1.000)
Ep: 219, Reward: 370.8512, Test: 248.5991 [145.99], Avg: 69.4442 (1.000)
Ep: 220, Reward: 347.5185, Test: 243.4911 [112.05], Avg: 69.7247 (1.000)
Ep: 221, Reward: 311.6523, Test: 252.1229 [83.51], Avg: 70.1701 (1.000)
Ep: 222, Reward: 277.2563, Test: 235.3407 [136.19], Avg: 70.3001 (1.000)
Ep: 223, Reward: 273.9718, Test: 274.9727 [96.98], Avg: 70.7809 (1.000)
Ep: 224, Reward: 279.7473, Test: 215.7773 [117.05], Avg: 70.9051 (1.000)
Ep: 225, Reward: 306.9940, Test: 277.9543 [143.89], Avg: 71.1846 (1.000)
Ep: 226, Reward: 280.7859, Test: 237.9349 [126.74], Avg: 71.3608 (1.000)
Ep: 227, Reward: 333.1779, Test: 247.5362 [144.28], Avg: 71.5007 (1.000)
Ep: 228, Reward: 290.8888, Test: 234.2821 [119.05], Avg: 71.6917 (1.000)
Ep: 229, Reward: 319.3794, Test: 240.9889 [95.00], Avg: 72.0147 (1.000)
Ep: 230, Reward: 339.2621, Test: 282.3129 [94.74], Avg: 72.5150 (1.000)
Ep: 231, Reward: 346.7468, Test: 310.3989 [139.22], Avg: 72.9403 (1.000)
Ep: 232, Reward: 406.4940, Test: 232.1144 [108.10], Avg: 73.1595 (1.000)
Ep: 233, Reward: 346.3629, Test: 276.6067 [128.24], Avg: 73.4809 (1.000)
Ep: 234, Reward: 307.6321, Test: 245.2120 [126.19], Avg: 73.6747 (1.000)
Ep: 235, Reward: 388.8557, Test: 331.5326 [86.81], Avg: 74.3995 (1.000)
Ep: 236, Reward: 341.0927, Test: 374.6972 [134.44], Avg: 75.0993 (1.000)
Ep: 237, Reward: 389.8854, Test: 328.7365 [160.39], Avg: 75.4911 (1.000)
Ep: 238, Reward: 339.8825, Test: 282.4915 [233.44], Avg: 75.3805 (1.000)
Ep: 239, Reward: 371.7542, Test: 301.0163 [177.10], Avg: 75.5827 (1.000)
Ep: 240, Reward: 301.0187, Test: 351.7748 [194.64], Avg: 75.9211 (1.000)
Ep: 241, Reward: 418.0983, Test: 380.7321 [136.33], Avg: 76.6173 (1.000)
Ep: 242, Reward: 358.0400, Test: 460.2687 [216.62], Avg: 77.3047 (1.000)
Ep: 243, Reward: 400.0313, Test: 287.4383 [143.36], Avg: 77.5783 (1.000)
Ep: 244, Reward: 477.3295, Test: 362.0536 [185.60], Avg: 77.9819 (1.000)
Ep: 245, Reward: 413.1680, Test: 519.6493 [207.82], Avg: 78.9325 (1.000)
Ep: 246, Reward: 469.0960, Test: 273.6110 [117.37], Avg: 79.2455 (1.000)
Ep: 247, Reward: 424.7344, Test: 527.7480 [196.58], Avg: 80.2613 (1.000)
Ep: 248, Reward: 412.8315, Test: 455.5697 [203.70], Avg: 80.9505 (1.000)
Ep: 249, Reward: 438.6860, Test: 397.1747 [206.43], Avg: 81.3897 (1.000)
Ep: 250, Reward: 361.9157, Test: 370.0272 [146.68], Avg: 81.9552 (1.000)
Ep: 251, Reward: 411.6005, Test: 426.6352 [171.82], Avg: 82.6412 (1.000)
Ep: 252, Reward: 407.3664, Test: 460.9261 [123.55], Avg: 83.6481 (1.000)
Ep: 253, Reward: 438.4112, Test: 336.5911 [177.30], Avg: 83.9459 (1.000)
Ep: 254, Reward: 443.4224, Test: 374.0551 [137.68], Avg: 84.5436 (1.000)
Ep: 255, Reward: 441.0739, Test: 515.8295 [195.04], Avg: 85.4664 (1.000)
Ep: 256, Reward: 449.9847, Test: 438.4697 [164.27], Avg: 86.2008 (1.000)
Ep: 257, Reward: 424.5084, Test: 506.5051 [277.98], Avg: 86.7524 (1.000)
Ep: 258, Reward: 454.6244, Test: 521.9487 [214.66], Avg: 87.6039 (1.000)
Ep: 259, Reward: 516.3289, Test: 359.2434 [195.02], Avg: 87.8986 (1.000)
Ep: 260, Reward: 433.5674, Test: 358.7228 [133.42], Avg: 88.4251 (1.000)
Ep: 261, Reward: 420.9452, Test: 334.5847 [146.15], Avg: 88.8068 (1.000)
Ep: 262, Reward: 379.2149, Test: 375.5545 [173.84], Avg: 89.2361 (1.000)
Ep: 263, Reward: 405.3705, Test: 350.7054 [142.67], Avg: 89.6861 (1.000)
Ep: 264, Reward: 370.4395, Test: 386.9033 [119.53], Avg: 90.3566 (1.000)
Ep: 265, Reward: 411.1372, Test: 386.9995 [129.05], Avg: 90.9867 (1.000)
Ep: 266, Reward: 411.9512, Test: 395.4400 [101.00], Avg: 91.7487 (1.000)
Ep: 267, Reward: 333.9772, Test: 384.5056 [122.36], Avg: 92.3845 (1.000)
Ep: 268, Reward: 299.8991, Test: 322.7417 [131.66], Avg: 92.7514 (1.000)
Ep: 269, Reward: 365.3297, Test: 342.3065 [180.78], Avg: 93.0061 (1.000)
Ep: 270, Reward: 300.1455, Test: 226.0558 [170.11], Avg: 92.8694 (1.000)
Ep: 271, Reward: 308.0488, Test: 311.0458 [153.88], Avg: 93.1058 (1.000)
Ep: 272, Reward: 343.2568, Test: 273.6933 [112.09], Avg: 93.3567 (1.000)
Ep: 273, Reward: 342.7148, Test: 221.9929 [82.45], Avg: 93.5252 (1.000)
Ep: 274, Reward: 323.1735, Test: 271.8268 [149.06], Avg: 93.6316 (1.000)
Ep: 275, Reward: 280.8504, Test: 326.8293 [176.46], Avg: 93.8371 (1.000)
Ep: 276, Reward: 352.5723, Test: 261.9603 [118.32], Avg: 94.0170 (1.000)
Ep: 277, Reward: 288.7249, Test: 256.7834 [131.08], Avg: 94.1309 (1.000)
Ep: 278, Reward: 360.4734, Test: 294.7562 [243.75], Avg: 93.9764 (1.000)
Ep: 279, Reward: 333.6326, Test: 355.2361 [161.29], Avg: 94.3334 (1.000)
Ep: 280, Reward: 365.9245, Test: 212.2345 [153.91], Avg: 94.2053 (1.000)
Ep: 281, Reward: 316.9006, Test: 318.5982 [152.51], Avg: 94.4602 (1.000)
Ep: 282, Reward: 350.1385, Test: 293.3954 [115.50], Avg: 94.7550 (1.000)
Ep: 283, Reward: 424.8100, Test: 220.9727 [152.79], Avg: 94.6614 (1.000)
Ep: 284, Reward: 358.6118, Test: 249.3297 [186.71], Avg: 94.5490 (1.000)
Ep: 285, Reward: 378.2342, Test: 311.4158 [176.53], Avg: 94.6900 (1.000)
Ep: 286, Reward: 399.3103, Test: 363.2129 [88.24], Avg: 95.3182 (1.000)
Ep: 287, Reward: 391.4828, Test: 264.3475 [113.85], Avg: 95.5098 (1.000)
Ep: 288, Reward: 354.1875, Test: -9.6516 [98.40], Avg: 94.8054 (1.000)
Ep: 289, Reward: 17.3866, Test: -71.5888 [8.58], Avg: 94.2021 (1.000)
Ep: 290, Reward: -75.4605, Test: -69.7275 [6.90], Avg: 93.6150 (1.000)
Ep: 291, Reward: -70.9338, Test: -69.6243 [3.31], Avg: 93.0446 (1.000)
Ep: 292, Reward: -68.3820, Test: -71.7678 [4.22], Avg: 92.4677 (1.000)
Ep: 293, Reward: -67.1107, Test: -69.5424 [3.79], Avg: 91.9038 (1.000)
Ep: 294, Reward: -67.6341, Test: 143.7771 [181.70], Avg: 91.4637 (1.000)
Ep: 295, Reward: 172.7682, Test: 139.0024 [164.35], Avg: 91.0691 (1.000)
Ep: 296, Reward: 113.3290, Test: 164.4958 [115.97], Avg: 90.9258 (1.000)
Ep: 297, Reward: 150.8535, Test: 260.3714 [101.40], Avg: 91.1542 (1.000)
Ep: 298, Reward: 334.4455, Test: 215.2130 [112.23], Avg: 91.1937 (1.000)
Ep: 299, Reward: 297.6970, Test: 316.5295 [174.15], Avg: 91.3643 (1.000)
Ep: 300, Reward: 389.3653, Test: 275.1134 [156.63], Avg: 91.4544 (1.000)
Ep: 301, Reward: 344.6781, Test: 313.0019 [39.31], Avg: 92.0579 (1.000)
Ep: 302, Reward: 373.2406, Test: 283.9845 [150.78], Avg: 92.1937 (1.000)
Ep: 303, Reward: 285.2928, Test: 268.4001 [168.87], Avg: 92.2178 (1.000)
Ep: 304, Reward: 372.2923, Test: 265.1613 [108.69], Avg: 92.4285 (1.000)
Ep: 305, Reward: 385.5680, Test: 206.6454 [158.01], Avg: 92.2854 (1.000)
Ep: 306, Reward: 398.3319, Test: 250.2703 [117.88], Avg: 92.4160 (1.000)
Ep: 307, Reward: 411.0239, Test: 322.6712 [161.14], Avg: 92.6404 (1.000)
Ep: 308, Reward: 408.2257, Test: 262.1660 [162.65], Avg: 92.6626 (1.000)
Ep: 309, Reward: 363.7342, Test: 246.6525 [138.38], Avg: 92.7130 (1.000)
Ep: 310, Reward: 409.9898, Test: 231.9552 [136.85], Avg: 92.7207 (1.000)
Ep: 311, Reward: 466.7426, Test: 211.3561 [137.99], Avg: 92.6587 (1.000)
Ep: 312, Reward: 388.6510, Test: 343.7835 [131.83], Avg: 93.0398 (1.000)
Ep: 313, Reward: 326.6215, Test: 307.8221 [108.22], Avg: 93.3792 (1.000)
Ep: 314, Reward: 293.4784, Test: 320.4838 [121.58], Avg: 93.7142 (1.000)
Ep: 315, Reward: 288.7759, Test: 356.2092 [166.49], Avg: 94.0180 (1.000)
Ep: 316, Reward: 363.3006, Test: 181.6441 [99.87], Avg: 93.9793 (1.000)
Ep: 317, Reward: 437.2596, Test: 198.8518 [106.04], Avg: 93.9757 (1.000)
Ep: 318, Reward: 379.9636, Test: 301.5032 [137.15], Avg: 94.1963 (1.000)
Ep: 319, Reward: 392.9207, Test: 173.5616 [115.45], Avg: 94.0836 (1.000)
Ep: 320, Reward: 374.6193, Test: 310.4809 [110.95], Avg: 94.4120 (1.000)
Ep: 321, Reward: 362.4810, Test: 237.1795 [126.91], Avg: 94.4613 (1.000)
Ep: 322, Reward: 426.8743, Test: 275.1305 [146.81], Avg: 94.5661 (1.000)
Ep: 323, Reward: 327.0729, Test: 474.5472 [150.42], Avg: 95.2746 (1.000)
Ep: 324, Reward: 296.8053, Test: 225.5629 [249.27], Avg: 94.9085 (1.000)
Ep: 325, Reward: 289.1436, Test: 324.3983 [84.34], Avg: 95.3538 (1.000)
Ep: 326, Reward: 350.2830, Test: 250.7689 [119.83], Avg: 95.4626 (1.000)
Ep: 327, Reward: 373.6754, Test: 245.6859 [152.73], Avg: 95.4550 (1.000)
Ep: 328, Reward: 380.4684, Test: 311.8571 [139.58], Avg: 95.6885 (1.000)
Ep: 329, Reward: 293.5601, Test: 267.8820 [172.11], Avg: 95.6887 (1.000)
Ep: 330, Reward: 340.6945, Test: 299.5121 [195.37], Avg: 95.7142 (1.000)
Ep: 331, Reward: 334.8760, Test: 350.1391 [226.14], Avg: 95.7994 (1.000)
Ep: 332, Reward: 357.1527, Test: 414.4644 [212.30], Avg: 96.1188 (1.000)
Ep: 333, Reward: 386.6757, Test: 227.1482 [159.34], Avg: 96.0341 (1.000)
Ep: 334, Reward: 297.8361, Test: 276.3719 [188.85], Avg: 96.0087 (1.000)
Ep: 335, Reward: 331.0314, Test: 248.6232 [118.72], Avg: 96.1096 (1.000)
Ep: 336, Reward: 353.2984, Test: 281.2241 [202.09], Avg: 96.0592 (1.000)
Ep: 337, Reward: 276.8707, Test: 338.8638 [252.81], Avg: 96.0296 (1.000)
Ep: 338, Reward: 282.2520, Test: 280.9337 [105.37], Avg: 96.2642 (1.000)
Ep: 339, Reward: 293.9753, Test: 325.0795 [177.92], Avg: 96.4139 (1.000)
Ep: 340, Reward: 354.8882, Test: 363.0256 [230.45], Avg: 96.5199 (1.000)
Ep: 341, Reward: 310.0240, Test: 194.5001 [152.52], Avg: 96.3604 (1.000)
Ep: 342, Reward: 339.4702, Test: 198.6103 [159.46], Avg: 96.1937 (1.000)
Ep: 343, Reward: 392.6859, Test: 293.3311 [124.52], Avg: 96.4047 (1.000)
Ep: 344, Reward: 249.8542, Test: 263.4825 [114.34], Avg: 96.5576 (1.000)
Ep: 345, Reward: 285.8346, Test: 271.0964 [134.63], Avg: 96.6729 (1.000)
Ep: 346, Reward: 317.8784, Test: 287.7616 [183.04], Avg: 96.6961 (1.000)
Ep: 347, Reward: 341.8605, Test: 288.5063 [117.44], Avg: 96.9098 (1.000)
Ep: 348, Reward: 371.1142, Test: 338.9329 [118.06], Avg: 97.2650 (1.000)
Ep: 349, Reward: 375.4062, Test: 444.0868 [213.90], Avg: 97.6448 (1.000)
Ep: 350, Reward: 383.8007, Test: 313.3900 [247.02], Avg: 97.5557 (1.000)
Ep: 351, Reward: 387.0945, Test: 283.3142 [135.04], Avg: 97.6998 (1.000)
Ep: 352, Reward: 408.1542, Test: 387.6790 [164.83], Avg: 98.0544 (1.000)
Ep: 353, Reward: 368.1556, Test: 343.6410 [237.25], Avg: 98.0779 (1.000)
Ep: 354, Reward: 447.7561, Test: 257.5738 [149.55], Avg: 98.1059 (1.000)
Ep: 355, Reward: 432.0321, Test: 358.8904 [219.71], Avg: 98.2213 (1.000)
Ep: 356, Reward: 455.7372, Test: 242.1800 [158.50], Avg: 98.1806 (1.000)
Ep: 357, Reward: 434.1797, Test: 219.2340 [151.18], Avg: 98.0964 (1.000)
Ep: 358, Reward: 428.9183, Test: 222.4848 [177.28], Avg: 97.9491 (1.000)
Ep: 359, Reward: 413.1394, Test: 168.9617 [123.72], Avg: 97.8027 (1.000)
Ep: 360, Reward: 399.3489, Test: 310.5975 [224.28], Avg: 97.7708 (1.000)
Ep: 361, Reward: 415.7631, Test: 323.1420 [92.84], Avg: 98.1369 (1.000)
Ep: 362, Reward: 340.8941, Test: 268.0601 [201.73], Avg: 98.0493 (1.000)
Ep: 363, Reward: 302.0190, Test: 342.4804 [149.11], Avg: 98.3112 (1.000)
Ep: 364, Reward: 369.9881, Test: 191.3183 [162.29], Avg: 98.1214 (1.000)
Ep: 365, Reward: 343.0391, Test: 259.5738 [137.72], Avg: 98.1863 (1.000)
Ep: 366, Reward: 330.7262, Test: 166.2457 [147.31], Avg: 97.9703 (1.000)
Ep: 367, Reward: 398.7183, Test: 192.1885 [150.66], Avg: 97.8169 (1.000)
Ep: 368, Reward: 383.4108, Test: 276.9344 [132.75], Avg: 97.9426 (1.000)
Ep: 369, Reward: 463.3062, Test: 428.7898 [171.48], Avg: 98.3733 (1.000)
Ep: 370, Reward: 349.9966, Test: 398.6839 [147.70], Avg: 98.7847 (1.000)
Ep: 371, Reward: 395.8269, Test: 328.9680 [204.04], Avg: 98.8550 (1.000)
Ep: 372, Reward: 368.3637, Test: 398.8572 [293.47], Avg: 98.8725 (1.000)
Ep: 373, Reward: 408.2914, Test: 405.6353 [166.76], Avg: 99.2468 (1.000)
Ep: 374, Reward: 382.2435, Test: 186.0563 [136.10], Avg: 99.1154 (1.000)
Ep: 375, Reward: 311.8088, Test: 228.7122 [173.24], Avg: 98.9993 (1.000)
Ep: 376, Reward: 468.6483, Test: 275.5541 [156.55], Avg: 99.0524 (1.000)
Ep: 377, Reward: 451.5978, Test: 238.5321 [225.61], Avg: 98.8245 (1.000)
Ep: 378, Reward: 375.3239, Test: 275.5221 [207.98], Avg: 98.7420 (1.000)
Ep: 379, Reward: 444.4004, Test: 248.7594 [208.16], Avg: 98.5890 (1.000)
Ep: 380, Reward: 414.8917, Test: 208.9325 [153.12], Avg: 98.4767 (1.000)
Ep: 381, Reward: 406.1083, Test: 438.1127 [216.06], Avg: 98.8002 (1.000)
Ep: 382, Reward: 401.3143, Test: 358.7154 [277.53], Avg: 98.7542 (1.000)
Ep: 383, Reward: 415.4759, Test: 334.7927 [158.70], Avg: 98.9556 (1.000)
Ep: 384, Reward: 442.8462, Test: 372.5123 [268.25], Avg: 98.9694 (1.000)
Ep: 385, Reward: 417.3999, Test: 175.1373 [141.34], Avg: 98.8006 (1.000)
Ep: 386, Reward: 429.1740, Test: 350.3451 [183.80], Avg: 98.9756 (1.000)
Ep: 387, Reward: 422.0836, Test: 380.4484 [237.48], Avg: 99.0890 (1.000)
Ep: 388, Reward: 550.6312, Test: 551.0382 [239.43], Avg: 99.6353 (1.000)
Ep: 389, Reward: 559.8781, Test: 476.2224 [289.72], Avg: 99.8580 (1.000)
Ep: 390, Reward: 599.9177, Test: 273.2202 [187.54], Avg: 99.8218 (1.000)
Ep: 391, Reward: 443.3986, Test: 437.8049 [302.95], Avg: 99.9112 (1.000)
Ep: 392, Reward: 472.0387, Test: 280.3612 [190.21], Avg: 99.8863 (1.000)
Ep: 393, Reward: 627.3878, Test: 571.0570 [298.94], Avg: 100.3235 (1.000)
Ep: 394, Reward: 467.1063, Test: 507.6066 [307.11], Avg: 100.5771 (1.000)
Ep: 395, Reward: 497.3378, Test: 601.2868 [333.24], Avg: 101.0000 (1.000)
Ep: 396, Reward: 493.1893, Test: 404.4063 [312.08], Avg: 100.9781 (1.000)
Ep: 397, Reward: 517.0189, Test: 505.1129 [278.40], Avg: 101.2940 (1.000)
Ep: 398, Reward: 528.4519, Test: 637.3399 [282.05], Avg: 101.9306 (1.000)
Ep: 399, Reward: 537.9905, Test: 374.8868 [403.49], Avg: 101.6043 (1.000)
Ep: 400, Reward: 491.6428, Test: 526.3076 [277.39], Avg: 101.9717 (1.000)
Ep: 401, Reward: 371.0771, Test: 303.3388 [198.77], Avg: 101.9781 (1.000)
Ep: 402, Reward: 359.7277, Test: 444.9865 [296.19], Avg: 102.0943 (1.000)
Ep: 403, Reward: 536.4376, Test: 447.5625 [270.63], Avg: 102.2795 (1.000)
Ep: 404, Reward: 477.5453, Test: 490.4914 [273.41], Avg: 102.5630 (1.000)
Ep: 405, Reward: 523.3672, Test: 440.1779 [223.35], Avg: 102.8444 (1.000)
Ep: 406, Reward: 535.1459, Test: 348.8877 [266.11], Avg: 102.7951 (1.000)
Ep: 407, Reward: 542.2462, Test: 368.4891 [253.41], Avg: 102.8252 (1.000)
Ep: 408, Reward: 407.3855, Test: 456.8326 [272.73], Avg: 103.0239 (1.000)
Ep: 409, Reward: 454.9179, Test: 459.0486 [192.85], Avg: 103.4219 (1.000)
Ep: 410, Reward: 564.6019, Test: 710.5223 [299.92], Avg: 104.1693 (1.000)
Ep: 411, Reward: 550.8178, Test: 446.7630 [315.51], Avg: 104.2351 (1.000)
Ep: 412, Reward: 485.2281, Test: 549.4642 [164.19], Avg: 104.9155 (1.000)
Ep: 413, Reward: 449.9441, Test: 501.9748 [217.05], Avg: 105.3504 (1.000)
Ep: 414, Reward: 453.1784, Test: 420.9335 [230.14], Avg: 105.5563 (1.000)
Ep: 415, Reward: 337.1549, Test: 384.3316 [229.80], Avg: 105.6740 (1.000)
Ep: 416, Reward: 316.0814, Test: 422.8031 [198.49], Avg: 105.9585 (1.000)
Ep: 417, Reward: 374.4082, Test: 500.1001 [223.05], Avg: 106.3678 (1.000)
Ep: 418, Reward: 406.5851, Test: 382.6904 [170.55], Avg: 106.6202 (1.000)
Ep: 419, Reward: 398.0776, Test: 384.0341 [235.83], Avg: 106.7192 (1.000)
Ep: 420, Reward: 322.8002, Test: 300.0347 [127.61], Avg: 106.8753 (1.000)
Ep: 421, Reward: 405.9742, Test: 283.8515 [100.80], Avg: 107.0558 (1.000)
Ep: 422, Reward: 336.8611, Test: 313.1706 [215.69], Avg: 107.0332 (1.000)
Ep: 423, Reward: 348.9701, Test: 345.0451 [161.08], Avg: 107.2146 (1.000)
Ep: 424, Reward: 345.2255, Test: 324.9431 [138.12], Avg: 107.4019 (1.000)
Ep: 425, Reward: 304.1653, Test: 276.1192 [133.66], Avg: 107.4842 (1.000)
Ep: 426, Reward: 250.8314, Test: 227.8491 [97.02], Avg: 107.5389 (1.000)
Ep: 427, Reward: 267.3471, Test: 253.8882 [126.62], Avg: 107.5850 (1.000)
Ep: 428, Reward: 285.3114, Test: 209.9650 [55.73], Avg: 107.6937 (1.000)
Ep: 429, Reward: 288.8943, Test: 286.0852 [62.63], Avg: 107.9629 (1.000)
Ep: 430, Reward: 290.1905, Test: 334.6224 [83.79], Avg: 108.2944 (1.000)
Ep: 431, Reward: 326.8739, Test: 276.1211 [107.89], Avg: 108.4332 (1.000)
Ep: 432, Reward: 290.1403, Test: 154.2319 [113.41], Avg: 108.2770 (1.000)
Ep: 433, Reward: 362.5022, Test: 143.7083 [127.72], Avg: 108.0644 (1.000)
Ep: 434, Reward: 327.3870, Test: 219.4234 [138.33], Avg: 108.0023 (1.000)
Ep: 435, Reward: 339.2767, Test: 212.1615 [41.61], Avg: 108.1458 (1.000)
Ep: 436, Reward: 303.3406, Test: 233.6690 [113.93], Avg: 108.1723 (1.000)
Ep: 437, Reward: 326.6116, Test: 148.4796 [117.60], Avg: 107.9958 (1.000)
Ep: 438, Reward: 309.8382, Test: 145.3788 [102.65], Avg: 107.8472 (1.000)
Ep: 439, Reward: 305.7048, Test: 184.5723 [154.33], Avg: 107.6708 (1.000)
Ep: 440, Reward: 353.5022, Test: 212.2478 [148.92], Avg: 107.5702 (1.000)
Ep: 441, Reward: 258.7248, Test: 231.9940 [84.05], Avg: 107.6616 (1.000)
Ep: 442, Reward: 271.5319, Test: 187.9414 [92.73], Avg: 107.6335 (1.000)
Ep: 443, Reward: 370.2950, Test: 226.3838 [129.08], Avg: 107.6102 (1.000)
Ep: 444, Reward: 353.0638, Test: 165.7405 [98.70], Avg: 107.5191 (1.000)
Ep: 445, Reward: 345.8645, Test: 224.3775 [104.95], Avg: 107.5457 (1.000)
Ep: 446, Reward: 343.4267, Test: 140.6772 [109.52], Avg: 107.3749 (1.000)
Ep: 447, Reward: 364.5535, Test: 195.7427 [97.09], Avg: 107.3554 (1.000)
Ep: 448, Reward: 341.1753, Test: 194.6570 [126.94], Avg: 107.2671 (1.000)
Ep: 449, Reward: 298.9316, Test: 260.0163 [111.10], Avg: 107.3597 (1.000)
Ep: 450, Reward: 291.2126, Test: 197.1480 [114.54], Avg: 107.3048 (1.000)
Ep: 451, Reward: 243.7003, Test: 254.9586 [133.83], Avg: 107.3354 (1.000)
Ep: 452, Reward: 333.0980, Test: 145.8795 [104.36], Avg: 107.1901 (1.000)
Ep: 453, Reward: 289.9254, Test: 187.1579 [125.11], Avg: 107.0906 (1.000)
Ep: 454, Reward: 266.9703, Test: 218.1077 [109.43], Avg: 107.0941 (1.000)
Ep: 455, Reward: 256.0557, Test: 171.8729 [120.56], Avg: 106.9718 (1.000)
Ep: 456, Reward: 318.5058, Test: 224.5635 [141.03], Avg: 106.9205 (1.000)
Ep: 457, Reward: 320.6572, Test: 192.8894 [135.12], Avg: 106.8132 (1.000)
Ep: 458, Reward: 363.5904, Test: 374.3731 [244.33], Avg: 106.8638 (1.000)
Ep: 459, Reward: 382.9004, Test: 175.4451 [180.53], Avg: 106.6204 (1.000)
Ep: 460, Reward: 364.0325, Test: 186.4533 [142.20], Avg: 106.4851 (1.000)
Ep: 461, Reward: 319.2471, Test: 276.7855 [126.87], Avg: 106.5791 (1.000)
Ep: 462, Reward: 388.4664, Test: 195.7492 [132.06], Avg: 106.4865 (1.000)
Ep: 463, Reward: 286.4003, Test: 252.2711 [102.84], Avg: 106.5791 (1.000)
Ep: 464, Reward: 345.6039, Test: 272.5689 [183.00], Avg: 106.5425 (1.000)
Ep: 465, Reward: 312.4613, Test: 298.8303 [168.95], Avg: 106.5926 (1.000)
Ep: 466, Reward: 408.3720, Test: 355.8357 [277.95], Avg: 106.5311 (1.000)
Ep: 467, Reward: 358.0243, Test: 401.8602 [229.14], Avg: 106.6725 (1.000)
Ep: 468, Reward: 410.4407, Test: 210.9071 [167.71], Avg: 106.5372 (1.000)
Ep: 469, Reward: 382.6896, Test: 347.7274 [146.74], Avg: 106.7381 (1.000)
Ep: 470, Reward: 400.6842, Test: 358.3060 [285.63], Avg: 106.6658 (1.000)
Ep: 471, Reward: 371.6496, Test: 323.7499 [174.54], Avg: 106.7560 (1.000)
Ep: 472, Reward: 405.5849, Test: 225.9751 [169.62], Avg: 106.6494 (1.000)
Ep: 473, Reward: 391.7767, Test: 245.9402 [198.21], Avg: 106.5251 (1.000)
Ep: 474, Reward: 331.1720, Test: 390.9151 [194.79], Avg: 106.7137 (1.000)
Ep: 475, Reward: 351.6699, Test: 340.6587 [152.94], Avg: 106.8839 (1.000)
Ep: 476, Reward: 388.0394, Test: 264.7799 [193.90], Avg: 106.8084 (1.000)
Ep: 477, Reward: 371.1889, Test: 400.8552 [149.28], Avg: 107.1113 (1.000)
Ep: 478, Reward: 388.2970, Test: 323.8940 [232.64], Avg: 107.0782 (1.000)
Ep: 479, Reward: 401.7311, Test: 262.3391 [153.79], Avg: 107.0813 (1.000)
Ep: 480, Reward: 381.3673, Test: 303.6603 [134.89], Avg: 107.2095 (1.000)
Ep: 481, Reward: 366.6909, Test: 269.3789 [198.18], Avg: 107.1348 (1.000)
Ep: 482, Reward: 346.8833, Test: 272.0312 [118.52], Avg: 107.2308 (1.000)
Ep: 483, Reward: 329.5342, Test: 315.0971 [108.36], Avg: 107.4364 (1.000)
Ep: 484, Reward: 419.6218, Test: 237.8067 [121.34], Avg: 107.4550 (1.000)
Ep: 485, Reward: 431.0487, Test: 322.0898 [195.20], Avg: 107.4950 (1.000)
Ep: 486, Reward: 442.3940, Test: 288.5250 [108.03], Avg: 107.6449 (1.000)
Ep: 487, Reward: 398.7726, Test: 272.1365 [104.20], Avg: 107.7685 (1.000)
Ep: 488, Reward: 455.1947, Test: 279.3966 [189.12], Avg: 107.7327 (1.000)
Ep: 489, Reward: 365.0613, Test: 259.0596 [141.71], Avg: 107.7523 (1.000)
Ep: 490, Reward: 376.3914, Test: 294.6758 [172.52], Avg: 107.7816 (1.000)
Ep: 491, Reward: 394.0013, Test: 295.6508 [100.76], Avg: 107.9587 (1.000)
Ep: 492, Reward: 359.0379, Test: 407.6822 [99.90], Avg: 108.3640 (1.000)
Ep: 493, Reward: 352.8681, Test: 308.3612 [118.18], Avg: 108.5296 (1.000)
Ep: 494, Reward: 312.3365, Test: 300.2711 [163.37], Avg: 108.5869 (1.000)
Ep: 495, Reward: 354.8694, Test: 250.1136 [163.03], Avg: 108.5436 (1.000)
Ep: 496, Reward: 288.6925, Test: 220.8658 [157.12], Avg: 108.4534 (1.000)
Ep: 497, Reward: 335.6874, Test: 395.3211 [186.83], Avg: 108.6543 (1.000)
Ep: 498, Reward: 295.7900, Test: 245.7762 [187.10], Avg: 108.5542 (1.000)
Ep: 499, Reward: 317.4189, Test: 259.7826 [185.30], Avg: 108.4860 (1.000)
