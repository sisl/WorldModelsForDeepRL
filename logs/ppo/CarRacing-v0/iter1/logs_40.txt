Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.100                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.02				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * 0.5 * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(PPO_EPOCHS):
				for i in range(0, len(self.replay_buffer), BATCH_SIZE):
					state, action, log_prob, target, advantage = self.replay_buffer.index(BATCH_SIZE, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -29.2205, Test: -31.1329 [7.70], Avg: -38.8374 (0.997)
Ep: 1, Reward: -31.9029, Test: -45.2350 [7.17], Avg: -45.6207 (0.994)
Ep: 2, Reward: -56.0885, Test: -64.7706 [4.11], Avg: -53.3732 (0.991)
Ep: 3, Reward: -52.5805, Test: -56.3360 [3.62], Avg: -55.0199 (0.988)
Ep: 4, Reward: -56.4341, Test: -58.7320 [10.70], Avg: -57.9019 (0.985)
Ep: 5, Reward: -51.6915, Test: -40.7169 [26.86], Avg: -59.5143 (0.982)
Ep: 6, Reward: -36.7392, Test: -32.0764 [33.75], Avg: -60.4163 (0.979)
Ep: 7, Reward: -32.7344, Test: 8.3004 [40.82], Avg: -56.9296 (0.976)
Ep: 8, Reward: 81.2056, Test: 173.0428 [69.55], Avg: -39.1051 (0.973)
Ep: 9, Reward: 142.5486, Test: 266.8112 [134.21], Avg: -21.9341 (0.970)
Ep: 10, Reward: 285.0371, Test: 570.2381 [254.93], Avg: 8.7242 (0.967)
Ep: 11, Reward: 147.6535, Test: 135.3629 [120.42], Avg: 9.2422 (0.965)
Ep: 12, Reward: 194.0200, Test: 182.5368 [92.09], Avg: 15.4885 (0.962)
Ep: 13, Reward: 293.4933, Test: 296.1457 [185.28], Avg: 22.3010 (0.959)
Ep: 14, Reward: 243.3031, Test: 137.8573 [222.81], Avg: 15.1506 (0.956)
Ep: 15, Reward: 253.1690, Test: 336.7158 [217.06], Avg: 21.6823 (0.953)
Ep: 16, Reward: 244.8194, Test: 265.6366 [181.67], Avg: 25.3460 (0.950)
Ep: 17, Reward: 312.4215, Test: 229.7247 [131.68], Avg: 29.3848 (0.947)
Ep: 18, Reward: 242.8152, Test: 208.0416 [147.07], Avg: 31.0474 (0.945)
Ep: 19, Reward: 288.3148, Test: 248.9430 [191.87], Avg: 32.3488 (0.942)
Ep: 20, Reward: 256.8770, Test: 306.5434 [174.72], Avg: 37.0857 (0.939)
Ep: 21, Reward: 377.8815, Test: 307.4930 [247.43], Avg: 38.1299 (0.936)
Ep: 22, Reward: 341.7432, Test: 183.2164 [127.29], Avg: 38.9038 (0.933)
Ep: 23, Reward: 366.2870, Test: 355.0596 [244.48], Avg: 41.8903 (0.930)
Ep: 24, Reward: 402.6554, Test: 292.0596 [218.51], Avg: 43.1567 (0.928)
Ep: 25, Reward: 333.9878, Test: 290.9336 [288.67], Avg: 41.5840 (0.925)
Ep: 26, Reward: 424.5123, Test: 464.7063 [352.99], Avg: 44.1817 (0.922)
Ep: 27, Reward: 573.2655, Test: 516.7297 [327.37], Avg: 49.3665 (0.919)
Ep: 28, Reward: 441.4916, Test: 552.8775 [237.90], Avg: 58.5253 (0.917)
Ep: 29, Reward: 698.9883, Test: 577.4453 [264.54], Avg: 67.0047 (0.914)
Ep: 30, Reward: 561.2642, Test: 535.3105 [253.19], Avg: 73.9438 (0.911)
Ep: 31, Reward: 514.7071, Test: 564.6482 [288.66], Avg: 80.2577 (0.908)
Ep: 32, Reward: 540.8672, Test: 480.2302 [244.86], Avg: 84.9579 (0.906)
Ep: 33, Reward: 478.1382, Test: 554.9921 [249.07], Avg: 91.4570 (0.903)
Ep: 34, Reward: 479.7829, Test: 483.1793 [323.22], Avg: 93.4144 (0.900)
Ep: 35, Reward: 462.4633, Test: 299.5415 [250.81], Avg: 92.1733 (0.897)
Ep: 36, Reward: 393.5709, Test: 487.8884 [227.20], Avg: 96.7277 (0.895)
Ep: 37, Reward: 468.0987, Test: 307.0215 [232.81], Avg: 96.1352 (0.892)
Ep: 38, Reward: 532.8154, Test: 553.7947 [267.18], Avg: 101.0193 (0.889)
Ep: 39, Reward: 495.5683, Test: 792.7343 [136.58], Avg: 114.8977 (0.887)
Ep: 40, Reward: 679.7219, Test: 740.9422 [161.01], Avg: 126.2400 (0.884)
Ep: 41, Reward: 641.6375, Test: 552.1883 [282.40], Avg: 129.6579 (0.881)
Ep: 42, Reward: 555.2085, Test: 798.4988 [70.92], Avg: 143.5631 (0.879)
Ep: 43, Reward: 569.7546, Test: 530.7938 [323.54], Avg: 145.0107 (0.876)
Ep: 44, Reward: 662.9226, Test: 671.0888 [258.30], Avg: 150.9614 (0.874)
Ep: 45, Reward: 664.2022, Test: 543.4266 [233.10], Avg: 154.4260 (0.871)
Ep: 46, Reward: 699.4767, Test: 510.8361 [295.20], Avg: 155.7283 (0.868)
Ep: 47, Reward: 678.0071, Test: 672.1055 [192.34], Avg: 162.4791 (0.866)
Ep: 48, Reward: 601.4268, Test: 643.0626 [264.48], Avg: 166.8894 (0.863)
Ep: 49, Reward: 565.9571, Test: 655.3717 [144.34], Avg: 173.7722 (0.861)
Ep: 50, Reward: 563.7456, Test: 567.5854 [248.35], Avg: 176.6245 (0.858)
Ep: 51, Reward: 501.7581, Test: 571.6909 [257.87], Avg: 179.2628 (0.855)
Ep: 52, Reward: 503.6408, Test: 567.5639 [230.87], Avg: 182.2333 (0.853)
Ep: 53, Reward: 624.8406, Test: 655.7984 [188.51], Avg: 187.5121 (0.850)
Ep: 54, Reward: 440.1340, Test: 655.8775 [177.93], Avg: 192.7928 (0.848)
Ep: 55, Reward: 650.1115, Test: 540.7878 [301.88], Avg: 193.6163 (0.845)
Ep: 56, Reward: 498.5748, Test: 442.4419 [277.87], Avg: 193.1068 (0.843)
Ep: 57, Reward: 523.8275, Test: 225.3461 [189.38], Avg: 190.3975 (0.840)
Ep: 58, Reward: 606.0570, Test: 432.6757 [280.61], Avg: 189.7478 (0.838)
Ep: 59, Reward: 595.9143, Test: 329.0744 [215.30], Avg: 188.4815 (0.835)
Ep: 60, Reward: 464.1532, Test: 546.4441 [261.94], Avg: 190.0557 (0.833)
Ep: 61, Reward: 381.5005, Test: 418.9396 [213.46], Avg: 190.3045 (0.830)
Ep: 62, Reward: 498.6451, Test: 652.0808 [160.43], Avg: 195.0878 (0.828)
Ep: 63, Reward: 533.0751, Test: 543.4778 [263.20], Avg: 196.4190 (0.825)
Ep: 64, Reward: 454.0913, Test: 585.0633 [172.52], Avg: 199.7440 (0.823)
Ep: 65, Reward: 385.9848, Test: 427.6608 [228.63], Avg: 199.7331 (0.820)
Ep: 66, Reward: 506.4800, Test: 477.5477 [274.26], Avg: 199.7862 (0.818)
Ep: 67, Reward: 548.9616, Test: 581.1644 [193.24], Avg: 202.5529 (0.815)
Ep: 68, Reward: 482.4329, Test: 463.0621 [294.98], Avg: 202.0533 (0.813)
Ep: 69, Reward: 491.6903, Test: 511.2577 [249.36], Avg: 202.9082 (0.810)
Ep: 70, Reward: 548.4628, Test: 527.7571 [257.64], Avg: 203.8548 (0.808)
Ep: 71, Reward: 601.3636, Test: 471.3679 [216.83], Avg: 204.5587 (0.805)
Ep: 72, Reward: 562.9269, Test: 474.8731 [252.98], Avg: 204.7962 (0.803)
Ep: 73, Reward: 504.9255, Test: 659.4471 [147.26], Avg: 208.9501 (0.801)
Ep: 74, Reward: 614.1602, Test: 527.0925 [290.00], Avg: 209.3253 (0.798)
Ep: 75, Reward: 613.1665, Test: 698.8580 [187.29], Avg: 213.3022 (0.796)
Ep: 76, Reward: 662.1247, Test: 746.1037 [119.49], Avg: 218.6699 (0.793)
Ep: 77, Reward: 621.0081, Test: 585.6957 [192.06], Avg: 220.9131 (0.791)
Ep: 78, Reward: 505.5904, Test: 636.0256 [206.26], Avg: 223.5567 (0.789)
Ep: 79, Reward: 516.5845, Test: 619.1239 [146.30], Avg: 226.6726 (0.786)
Ep: 80, Reward: 625.9574, Test: 681.6215 [190.86], Avg: 229.9329 (0.784)
Ep: 81, Reward: 435.1297, Test: 495.4355 [195.97], Avg: 230.7808 (0.782)
Ep: 82, Reward: 531.4774, Test: 409.5965 [246.54], Avg: 229.9649 (0.779)
Ep: 83, Reward: 448.1657, Test: 313.4988 [192.44], Avg: 228.6684 (0.777)
Ep: 84, Reward: 340.3067, Test: 301.1030 [236.10], Avg: 226.7430 (0.775)
Ep: 85, Reward: 397.7768, Test: 429.5603 [212.68], Avg: 226.6283 (0.772)
Ep: 86, Reward: 302.8986, Test: 388.6831 [177.55], Avg: 226.4502 (0.770)
Ep: 87, Reward: 387.1397, Test: 365.8834 [157.51], Avg: 226.2448 (0.768)
Ep: 88, Reward: 454.7498, Test: 291.1398 [169.14], Avg: 225.0734 (0.765)
Ep: 89, Reward: 360.3284, Test: 373.2932 [203.43], Avg: 224.4600 (0.763)
Ep: 90, Reward: 416.7530, Test: 235.3319 [142.32], Avg: 223.0155 (0.761)
Ep: 91, Reward: 312.7000, Test: 394.1528 [166.49], Avg: 223.0660 (0.758)
Ep: 92, Reward: 348.3158, Test: 324.9104 [188.30], Avg: 222.1364 (0.756)
Ep: 93, Reward: 432.6622, Test: 367.5659 [197.50], Avg: 221.5824 (0.754)
Ep: 94, Reward: 444.4503, Test: 225.1036 [115.53], Avg: 220.4034 (0.752)
Ep: 95, Reward: 311.1904, Test: 321.4109 [192.37], Avg: 219.4517 (0.749)
Ep: 96, Reward: 348.9000, Test: 329.3400 [172.50], Avg: 218.8063 (0.747)
Ep: 97, Reward: 378.1907, Test: 263.5847 [110.39], Avg: 218.1368 (0.745)
Ep: 98, Reward: 391.2249, Test: 319.4073 [135.85], Avg: 217.7875 (0.743)
Ep: 99, Reward: 366.6504, Test: 386.0722 [151.76], Avg: 217.9527 (0.740)
Ep: 100, Reward: 308.8800, Test: 449.0395 [227.33], Avg: 217.9899 (0.738)
Ep: 101, Reward: 327.5199, Test: 471.4091 [259.93], Avg: 217.9261 (0.736)
Ep: 102, Reward: 516.0336, Test: 436.1269 [233.66], Avg: 217.7760 (0.734)
Ep: 103, Reward: 445.5461, Test: 501.4044 [218.77], Avg: 218.3996 (0.732)
Ep: 104, Reward: 476.6337, Test: 574.0620 [255.88], Avg: 219.3499 (0.729)
Ep: 105, Reward: 561.0814, Test: 546.9624 [231.35], Avg: 220.2581 (0.727)
Ep: 106, Reward: 551.2761, Test: 603.3896 [200.09], Avg: 221.9688 (0.725)
Ep: 107, Reward: 573.3141, Test: 670.8607 [225.03], Avg: 224.0416 (0.723)
Ep: 108, Reward: 636.7565, Test: 688.5150 [153.21], Avg: 226.8973 (0.721)
Ep: 109, Reward: 574.7522, Test: 466.9464 [224.47], Avg: 227.0389 (0.719)
Ep: 110, Reward: 546.5832, Test: 409.6115 [197.90], Avg: 226.9009 (0.716)
Ep: 111, Reward: 483.8868, Test: 535.0209 [195.23], Avg: 227.9088 (0.714)
Ep: 112, Reward: 499.6307, Test: 598.6853 [253.78], Avg: 228.9442 (0.712)
Ep: 113, Reward: 502.1582, Test: 518.6766 [263.87], Avg: 229.1711 (0.710)
Ep: 114, Reward: 650.9749, Test: 576.6156 [257.75], Avg: 229.9511 (0.708)
Ep: 115, Reward: 546.1814, Test: 526.5908 [190.00], Avg: 230.8704 (0.706)
Ep: 116, Reward: 483.1729, Test: 515.9034 [146.62], Avg: 232.0534 (0.704)
Ep: 117, Reward: 588.9921, Test: 568.8900 [236.05], Avg: 232.9075 (0.702)
Ep: 118, Reward: 605.2354, Test: 525.3632 [201.19], Avg: 233.6745 (0.699)
Ep: 119, Reward: 515.6689, Test: 696.5523 [190.02], Avg: 235.9483 (0.697)
Ep: 120, Reward: 602.1677, Test: 523.8956 [160.42], Avg: 237.0023 (0.695)
Ep: 121, Reward: 548.6342, Test: 552.6195 [154.48], Avg: 238.3231 (0.693)
Ep: 122, Reward: 494.7627, Test: 579.1717 [193.66], Avg: 239.5198 (0.691)
Ep: 123, Reward: 555.1054, Test: 613.1466 [213.68], Avg: 240.8096 (0.689)
Ep: 124, Reward: 601.9300, Test: 576.1423 [215.34], Avg: 241.7695 (0.687)
Ep: 125, Reward: 623.8947, Test: 643.9432 [159.50], Avg: 243.6955 (0.685)
Ep: 126, Reward: 566.6475, Test: 594.3073 [164.66], Avg: 245.1597 (0.683)
Ep: 127, Reward: 489.8576, Test: 549.1978 [164.79], Avg: 246.2476 (0.681)
Ep: 128, Reward: 529.4137, Test: 632.9059 [142.81], Avg: 248.1379 (0.679)
Ep: 129, Reward: 703.4991, Test: 488.4201 [225.55], Avg: 248.2512 (0.677)
Ep: 130, Reward: 563.4692, Test: 553.7390 [182.92], Avg: 249.1868 (0.675)
Ep: 131, Reward: 493.0043, Test: 424.5230 [208.97], Avg: 248.9320 (0.673)
Ep: 132, Reward: 603.3289, Test: 657.8238 [142.77], Avg: 250.9329 (0.671)
Ep: 133, Reward: 517.6731, Test: 551.0534 [200.59], Avg: 251.6757 (0.669)
Ep: 134, Reward: 533.3777, Test: 624.5767 [182.46], Avg: 253.0863 (0.667)
Ep: 135, Reward: 580.6965, Test: 479.6717 [209.29], Avg: 253.2135 (0.665)
Ep: 136, Reward: 456.2545, Test: 563.3413 [160.97], Avg: 254.3023 (0.663)
Ep: 137, Reward: 517.1201, Test: 430.3753 [136.13], Avg: 254.5917 (0.661)
Ep: 138, Reward: 401.7922, Test: 441.5706 [149.20], Avg: 254.8635 (0.659)
Ep: 139, Reward: 449.5717, Test: 506.5881 [222.39], Avg: 255.0730 (0.657)
Ep: 140, Reward: 398.1522, Test: 453.0337 [174.46], Avg: 255.2397 (0.655)
Ep: 141, Reward: 409.2280, Test: 438.9930 [202.06], Avg: 255.1108 (0.653)
Ep: 142, Reward: 402.8158, Test: 398.0404 [164.90], Avg: 254.9571 (0.651)
Ep: 143, Reward: 493.1211, Test: 474.9262 [221.75], Avg: 254.9447 (0.649)
Ep: 144, Reward: 342.8328, Test: 432.2572 [153.26], Avg: 255.1106 (0.647)
Ep: 145, Reward: 309.4954, Test: 450.4775 [215.24], Avg: 254.9745 (0.645)
Ep: 146, Reward: 516.9795, Test: 358.7626 [156.74], Avg: 254.6143 (0.643)
Ep: 147, Reward: 407.9690, Test: 443.1273 [221.55], Avg: 254.3910 (0.641)
Ep: 148, Reward: 407.7922, Test: 328.1842 [222.30], Avg: 253.3944 (0.639)
Ep: 149, Reward: 417.6779, Test: 408.2912 [209.09], Avg: 253.0331 (0.637)
Ep: 150, Reward: 430.5757, Test: 438.5339 [190.94], Avg: 252.9971 (0.635)
Ep: 151, Reward: 395.0520, Test: 571.2996 [205.93], Avg: 253.7363 (0.633)
Ep: 152, Reward: 438.5137, Test: 359.9539 [221.64], Avg: 252.9820 (0.631)
Ep: 153, Reward: 456.5193, Test: 424.0206 [229.61], Avg: 252.6016 (0.630)
Ep: 154, Reward: 411.0870, Test: 513.3948 [202.79], Avg: 252.9758 (0.628)
Ep: 155, Reward: 418.9111, Test: 393.1435 [116.15], Avg: 253.1297 (0.626)
Ep: 156, Reward: 328.2205, Test: 422.8979 [194.05], Avg: 252.9751 (0.624)
Ep: 157, Reward: 475.6267, Test: 465.3158 [223.70], Avg: 252.9032 (0.622)
Ep: 158, Reward: 523.7765, Test: 523.2495 [225.51], Avg: 253.1852 (0.620)
Ep: 159, Reward: 462.5383, Test: 605.5125 [198.63], Avg: 254.1458 (0.618)
Ep: 160, Reward: 455.7952, Test: 362.6782 [191.68], Avg: 253.6293 (0.616)
Ep: 161, Reward: 553.9129, Test: 368.0926 [226.54], Avg: 252.9375 (0.615)
Ep: 162, Reward: 432.5842, Test: 465.1020 [166.10], Avg: 253.2201 (0.613)
Ep: 163, Reward: 535.0012, Test: 467.0792 [164.72], Avg: 253.5197 (0.611)
Ep: 164, Reward: 617.5526, Test: 537.0384 [237.44], Avg: 253.7990 (0.609)
Ep: 165, Reward: 519.2875, Test: 418.7623 [212.81], Avg: 253.5108 (0.607)
Ep: 166, Reward: 593.5317, Test: 434.0828 [188.75], Avg: 253.4618 (0.605)
Ep: 167, Reward: 455.2126, Test: 379.8235 [202.46], Avg: 253.0088 (0.604)
Ep: 168, Reward: 455.1122, Test: 431.3489 [218.93], Avg: 252.7687 (0.602)
Ep: 169, Reward: 432.6944, Test: 296.2409 [200.86], Avg: 251.8429 (0.600)
Ep: 170, Reward: 478.9671, Test: 427.5565 [213.04], Avg: 251.6246 (0.598)
Ep: 171, Reward: 589.3128, Test: 412.8709 [205.87], Avg: 251.3652 (0.596)
Ep: 172, Reward: 446.1077, Test: 309.8238 [153.63], Avg: 250.8150 (0.595)
Ep: 173, Reward: 446.1105, Test: 410.2361 [204.14], Avg: 250.5580 (0.593)
Ep: 174, Reward: 400.8789, Test: 544.9877 [209.36], Avg: 251.0441 (0.591)
Ep: 175, Reward: 509.4779, Test: 403.6303 [178.74], Avg: 250.8955 (0.589)
Ep: 176, Reward: 525.3339, Test: 348.2951 [199.66], Avg: 250.3177 (0.588)
Ep: 177, Reward: 464.2791, Test: 408.6764 [181.99], Avg: 250.1850 (0.586)
Ep: 178, Reward: 553.6966, Test: 439.8700 [204.10], Avg: 250.1045 (0.584)
Ep: 179, Reward: 406.1403, Test: 506.1064 [142.64], Avg: 250.7343 (0.582)
Ep: 180, Reward: 421.6184, Test: 513.8830 [200.82], Avg: 251.0786 (0.581)
Ep: 181, Reward: 482.7616, Test: 515.4646 [212.91], Avg: 251.3614 (0.579)
Ep: 182, Reward: 442.3613, Test: 467.3402 [200.95], Avg: 251.4435 (0.577)
Ep: 183, Reward: 534.3933, Test: 553.9541 [250.96], Avg: 251.7237 (0.575)
Ep: 184, Reward: 495.5976, Test: 541.9036 [207.14], Avg: 252.1726 (0.574)
Ep: 185, Reward: 433.3146, Test: 538.4236 [219.09], Avg: 252.5337 (0.572)
Ep: 186, Reward: 502.2089, Test: 561.3394 [175.17], Avg: 253.2483 (0.570)
Ep: 187, Reward: 623.6715, Test: 493.6205 [160.99], Avg: 253.6706 (0.568)
Ep: 188, Reward: 607.8966, Test: 545.8838 [181.04], Avg: 254.2588 (0.567)
Ep: 189, Reward: 601.2287, Test: 556.3323 [234.39], Avg: 254.6150 (0.565)
Ep: 190, Reward: 624.2739, Test: 689.9742 [147.78], Avg: 256.1207 (0.563)
Ep: 191, Reward: 561.3130, Test: 634.7880 [232.11], Avg: 256.8840 (0.562)
Ep: 192, Reward: 554.2898, Test: 629.6602 [139.27], Avg: 258.0939 (0.560)
Ep: 193, Reward: 546.0322, Test: 602.3901 [138.87], Avg: 259.1528 (0.558)
Ep: 194, Reward: 563.7342, Test: 550.5519 [276.65], Avg: 259.2284 (0.557)
Ep: 195, Reward: 588.8188, Test: 523.8245 [275.16], Avg: 259.1745 (0.555)
Ep: 196, Reward: 513.3056, Test: 502.1434 [246.22], Avg: 259.1580 (0.553)
Ep: 197, Reward: 553.0750, Test: 563.6506 [314.88], Avg: 259.1056 (0.552)
Ep: 198, Reward: 509.3880, Test: 603.1985 [237.37], Avg: 259.6419 (0.550)
Ep: 199, Reward: 532.9172, Test: 499.5882 [204.99], Avg: 259.8167 (0.548)
Ep: 200, Reward: 381.9429, Test: 492.5746 [219.34], Avg: 259.8834 (0.547)
Ep: 201, Reward: 516.2226, Test: 508.4376 [296.76], Avg: 259.6448 (0.545)
Ep: 202, Reward: 589.8762, Test: 619.6190 [195.76], Avg: 260.4537 (0.543)
Ep: 203, Reward: 471.3510, Test: 571.5323 [184.65], Avg: 261.0734 (0.542)
Ep: 204, Reward: 534.4857, Test: 609.9531 [258.84], Avg: 261.5127 (0.540)
Ep: 205, Reward: 580.1239, Test: 566.1513 [241.78], Avg: 261.8178 (0.539)
Ep: 206, Reward: 474.6587, Test: 544.6595 [214.22], Avg: 262.1493 (0.537)
Ep: 207, Reward: 601.0234, Test: 549.8675 [242.08], Avg: 262.3687 (0.535)
Ep: 208, Reward: 496.2664, Test: 626.9187 [193.32], Avg: 263.1880 (0.534)
Ep: 209, Reward: 510.0015, Test: 514.8546 [244.11], Avg: 263.2240 (0.532)
Ep: 210, Reward: 589.6354, Test: 536.2897 [227.65], Avg: 263.4392 (0.530)
Ep: 211, Reward: 562.5319, Test: 641.8529 [166.65], Avg: 264.4381 (0.529)
Ep: 212, Reward: 507.0957, Test: 604.0120 [199.44], Avg: 265.0960 (0.527)
Ep: 213, Reward: 510.5480, Test: 564.5795 [253.27], Avg: 265.3119 (0.526)
Ep: 214, Reward: 595.8442, Test: 532.4539 [186.80], Avg: 265.6856 (0.524)
Ep: 215, Reward: 471.5947, Test: 484.7801 [227.67], Avg: 265.6459 (0.523)
Ep: 216, Reward: 646.2195, Test: 573.5591 [205.98], Avg: 266.1156 (0.521)
Ep: 217, Reward: 632.5818, Test: 531.9231 [237.67], Avg: 266.2447 (0.519)
Ep: 218, Reward: 604.6421, Test: 636.8524 [161.30], Avg: 267.2005 (0.518)
Ep: 219, Reward: 598.0941, Test: 609.9083 [195.72], Avg: 267.8686 (0.516)
Ep: 220, Reward: 608.9178, Test: 654.4534 [197.14], Avg: 268.7258 (0.515)
Ep: 221, Reward: 490.1308, Test: 705.8496 [137.93], Avg: 270.0736 (0.513)
Ep: 222, Reward: 583.2495, Test: 588.1231 [276.78], Avg: 270.2587 (0.512)
Ep: 223, Reward: 539.6835, Test: 548.1517 [273.74], Avg: 270.2772 (0.510)
Ep: 224, Reward: 562.4202, Test: 782.8355 [56.29], Avg: 272.3051 (0.509)
Ep: 225, Reward: 471.6000, Test: 708.4679 [229.16], Avg: 273.2210 (0.507)
Ep: 226, Reward: 707.3043, Test: 534.1028 [224.91], Avg: 273.3795 (0.506)
Ep: 227, Reward: 613.0804, Test: 673.5757 [234.23], Avg: 274.1074 (0.504)
Ep: 228, Reward: 639.5700, Test: 636.1988 [280.05], Avg: 274.4657 (0.503)
Ep: 229, Reward: 626.3118, Test: 512.9352 [295.13], Avg: 274.2193 (0.501)
Ep: 230, Reward: 697.4830, Test: 613.5128 [202.73], Avg: 274.8105 (0.500)
Ep: 231, Reward: 633.4360, Test: 696.2842 [157.50], Avg: 275.9483 (0.498)
Ep: 232, Reward: 557.9046, Test: 550.4166 [259.37], Avg: 276.0131 (0.497)
Ep: 233, Reward: 599.9421, Test: 504.8621 [249.52], Avg: 275.9247 (0.495)
Ep: 234, Reward: 678.0005, Test: 625.9660 [195.15], Avg: 276.5838 (0.494)
Ep: 235, Reward: 603.1373, Test: 575.2673 [198.07], Avg: 277.0102 (0.492)
Ep: 236, Reward: 574.9373, Test: 622.0027 [260.24], Avg: 277.3678 (0.491)
Ep: 237, Reward: 654.6725, Test: 473.6445 [232.04], Avg: 277.2175 (0.489)
Ep: 238, Reward: 559.3488, Test: 547.4012 [288.91], Avg: 277.1392 (0.488)
Ep: 239, Reward: 568.6622, Test: 519.1698 [242.18], Avg: 277.1385 (0.486)
Ep: 240, Reward: 646.5796, Test: 601.7821 [246.79], Avg: 277.4616 (0.485)
Ep: 241, Reward: 573.8115, Test: 578.0392 [207.96], Avg: 277.8443 (0.483)
Ep: 242, Reward: 568.6547, Test: 521.6320 [210.91], Avg: 277.9796 (0.482)
Ep: 243, Reward: 650.2564, Test: 535.8790 [224.77], Avg: 278.1154 (0.480)
Ep: 244, Reward: 634.8736, Test: 583.2221 [233.83], Avg: 278.4063 (0.479)
Ep: 245, Reward: 552.5853, Test: 476.4277 [230.96], Avg: 278.2724 (0.478)
Ep: 246, Reward: 563.0484, Test: 582.9127 [201.81], Avg: 278.6888 (0.476)
Ep: 247, Reward: 519.2492, Test: 597.1080 [224.50], Avg: 279.0675 (0.475)
Ep: 248, Reward: 580.6101, Test: 624.0884 [178.64], Avg: 279.7357 (0.473)
Ep: 249, Reward: 457.5927, Test: 696.1705 [194.14], Avg: 280.6249 (0.472)
Ep: 250, Reward: 588.7753, Test: 703.4891 [176.57], Avg: 281.6061 (0.470)
Ep: 251, Reward: 525.8201, Test: 590.0238 [186.27], Avg: 282.0908 (0.469)
Ep: 252, Reward: 439.6370, Test: 596.5646 [183.37], Avg: 282.6090 (0.468)
Ep: 253, Reward: 532.4500, Test: 504.0293 [205.64], Avg: 282.6711 (0.466)
Ep: 254, Reward: 501.9087, Test: 568.0593 [223.68], Avg: 282.9131 (0.465)
Ep: 255, Reward: 542.4255, Test: 584.8357 [196.35], Avg: 283.3255 (0.463)
Ep: 256, Reward: 529.7917, Test: 613.2975 [167.66], Avg: 283.9571 (0.462)
Ep: 257, Reward: 586.4084, Test: 520.3869 [307.25], Avg: 283.6826 (0.461)
Ep: 258, Reward: 491.6107, Test: 495.8926 [257.82], Avg: 283.5065 (0.459)
Ep: 259, Reward: 437.6267, Test: 472.3097 [194.95], Avg: 283.4829 (0.458)
Ep: 260, Reward: 493.4900, Test: 572.9165 [212.34], Avg: 283.7782 (0.456)
Ep: 261, Reward: 447.3040, Test: 609.1508 [252.33], Avg: 284.0570 (0.455)
Ep: 262, Reward: 580.3779, Test: 448.5424 [239.63], Avg: 283.7713 (0.454)
Ep: 263, Reward: 611.5560, Test: 627.6069 [204.88], Avg: 284.2977 (0.452)
Ep: 264, Reward: 473.7534, Test: 512.3074 [239.47], Avg: 284.2544 (0.451)
Ep: 265, Reward: 492.6304, Test: 557.7136 [164.97], Avg: 284.6623 (0.450)
Ep: 266, Reward: 594.6120, Test: 632.1970 [213.29], Avg: 285.1651 (0.448)
Ep: 267, Reward: 523.4894, Test: 556.8358 [208.03], Avg: 285.4025 (0.447)
Ep: 268, Reward: 585.8033, Test: 598.1277 [222.39], Avg: 285.7384 (0.446)
Ep: 269, Reward: 598.5256, Test: 611.0929 [230.22], Avg: 286.0907 (0.444)
Ep: 270, Reward: 692.8531, Test: 546.1228 [144.45], Avg: 286.5172 (0.443)
Ep: 271, Reward: 675.5427, Test: 656.4829 [153.57], Avg: 287.3128 (0.442)
Ep: 272, Reward: 653.1045, Test: 668.0345 [168.64], Avg: 288.0897 (0.440)
Ep: 273, Reward: 520.0780, Test: 564.9348 [192.00], Avg: 288.3993 (0.439)
Ep: 274, Reward: 620.9932, Test: 598.4785 [213.44], Avg: 288.7508 (0.438)
Ep: 275, Reward: 570.0791, Test: 592.6906 [252.80], Avg: 288.9361 (0.436)
Ep: 276, Reward: 668.3976, Test: 653.8819 [212.52], Avg: 289.4863 (0.435)
Ep: 277, Reward: 593.0731, Test: 670.4805 [154.49], Avg: 290.3011 (0.434)
Ep: 278, Reward: 611.2276, Test: 532.8830 [247.66], Avg: 290.2829 (0.432)
Ep: 279, Reward: 532.2999, Test: 666.9782 [191.18], Avg: 290.9454 (0.431)
Ep: 280, Reward: 634.5872, Test: 616.9205 [208.94], Avg: 291.3620 (0.430)
Ep: 281, Reward: 704.5601, Test: 678.5809 [175.54], Avg: 292.1126 (0.429)
Ep: 282, Reward: 632.6629, Test: 681.2569 [161.70], Avg: 292.9163 (0.427)
Ep: 283, Reward: 682.8105, Test: 689.1484 [192.78], Avg: 293.6327 (0.426)
Ep: 284, Reward: 731.1231, Test: 611.7077 [189.73], Avg: 294.0830 (0.425)
Ep: 285, Reward: 606.3876, Test: 549.5439 [172.06], Avg: 294.3746 (0.423)
Ep: 286, Reward: 616.5139, Test: 594.2363 [200.94], Avg: 294.7193 (0.422)
Ep: 287, Reward: 692.8078, Test: 588.2111 [241.25], Avg: 294.9007 (0.421)
Ep: 288, Reward: 554.2196, Test: 464.9425 [251.47], Avg: 294.6189 (0.420)
Ep: 289, Reward: 600.4716, Test: 537.4188 [190.93], Avg: 294.7978 (0.418)
Ep: 290, Reward: 610.6994, Test: 533.4748 [203.66], Avg: 294.9182 (0.417)
Ep: 291, Reward: 501.6658, Test: 591.5627 [275.25], Avg: 294.9914 (0.416)
Ep: 292, Reward: 566.0048, Test: 543.9840 [176.73], Avg: 295.2381 (0.415)
Ep: 293, Reward: 532.9320, Test: 672.0700 [249.63], Avg: 295.6707 (0.413)
Ep: 294, Reward: 528.1254, Test: 479.3824 [215.90], Avg: 295.5616 (0.412)
Ep: 295, Reward: 661.4368, Test: 573.6247 [211.57], Avg: 295.7862 (0.411)
Ep: 296, Reward: 607.7038, Test: 630.2667 [234.60], Avg: 296.1225 (0.410)
Ep: 297, Reward: 553.9902, Test: 506.4426 [183.28], Avg: 296.2133 (0.408)
Ep: 298, Reward: 579.0612, Test: 533.3021 [187.48], Avg: 296.3792 (0.407)
Ep: 299, Reward: 663.4745, Test: 678.2442 [139.53], Avg: 297.1870 (0.406)
Ep: 300, Reward: 588.9120, Test: 569.5998 [230.74], Avg: 297.3254 (0.405)
Ep: 301, Reward: 583.7133, Test: 535.1523 [207.97], Avg: 297.4243 (0.404)
Ep: 302, Reward: 604.4802, Test: 577.6147 [221.82], Avg: 297.6169 (0.402)
Ep: 303, Reward: 661.4994, Test: 620.5750 [183.26], Avg: 298.0765 (0.401)
Ep: 304, Reward: 599.8457, Test: 643.2876 [171.91], Avg: 298.6447 (0.400)
Ep: 305, Reward: 646.2864, Test: 595.1833 [191.96], Avg: 298.9864 (0.399)
Ep: 306, Reward: 565.7945, Test: 508.0067 [166.63], Avg: 299.1245 (0.398)
Ep: 307, Reward: 541.6746, Test: 677.9221 [193.28], Avg: 299.7269 (0.396)
Ep: 308, Reward: 513.5073, Test: 620.9644 [176.61], Avg: 300.1949 (0.395)
Ep: 309, Reward: 613.5430, Test: 570.5415 [247.08], Avg: 300.2700 (0.394)
Ep: 310, Reward: 555.2833, Test: 562.7802 [214.23], Avg: 300.4252 (0.393)
Ep: 311, Reward: 597.8750, Test: 640.6903 [198.39], Avg: 300.8799 (0.392)
Ep: 312, Reward: 540.4463, Test: 595.5229 [203.95], Avg: 301.1697 (0.390)
Ep: 313, Reward: 615.6445, Test: 438.1993 [245.38], Avg: 300.8246 (0.389)
Ep: 314, Reward: 581.9207, Test: 657.2366 [150.70], Avg: 301.4777 (0.388)
Ep: 315, Reward: 546.5721, Test: 632.6562 [154.44], Avg: 302.0370 (0.387)
Ep: 316, Reward: 526.5928, Test: 538.6505 [229.33], Avg: 302.0600 (0.386)
Ep: 317, Reward: 614.9009, Test: 534.6766 [177.23], Avg: 302.2341 (0.385)
Ep: 318, Reward: 600.4264, Test: 602.1317 [208.63], Avg: 302.5202 (0.383)
Ep: 319, Reward: 696.6474, Test: 536.2635 [181.76], Avg: 302.6827 (0.382)
Ep: 320, Reward: 619.9575, Test: 510.5135 [247.04], Avg: 302.5605 (0.381)
Ep: 321, Reward: 511.6564, Test: 551.4872 [210.16], Avg: 302.6809 (0.380)
Ep: 322, Reward: 557.5115, Test: 384.5502 [205.14], Avg: 302.2993 (0.379)
Ep: 323, Reward: 524.0520, Test: 534.5635 [244.81], Avg: 302.2605 (0.378)
Ep: 324, Reward: 653.7842, Test: 519.2752 [225.96], Avg: 302.2330 (0.377)
Ep: 325, Reward: 563.4692, Test: 586.5671 [256.85], Avg: 302.3173 (0.376)
Ep: 326, Reward: 501.3514, Test: 583.7628 [186.06], Avg: 302.6090 (0.374)
Ep: 327, Reward: 553.2451, Test: 592.0148 [147.40], Avg: 303.0420 (0.373)
Ep: 328, Reward: 570.8987, Test: 588.0666 [218.24], Avg: 303.2449 (0.372)
Ep: 329, Reward: 540.6872, Test: 652.2215 [178.19], Avg: 303.7625 (0.371)
Ep: 330, Reward: 582.7889, Test: 630.2681 [213.18], Avg: 304.1049 (0.370)
Ep: 331, Reward: 555.9477, Test: 657.2629 [187.63], Avg: 304.6034 (0.369)
Ep: 332, Reward: 580.6304, Test: 513.5835 [194.95], Avg: 304.6456 (0.368)
Ep: 333, Reward: 607.7803, Test: 493.4326 [229.75], Avg: 304.5229 (0.367)
Ep: 334, Reward: 541.9652, Test: 330.4495 [116.39], Avg: 304.2529 (0.365)
Ep: 335, Reward: 555.4831, Test: 495.9680 [252.07], Avg: 304.0733 (0.364)
Ep: 336, Reward: 623.7732, Test: 481.4425 [250.06], Avg: 303.8576 (0.363)
Ep: 337, Reward: 536.0148, Test: 478.2969 [207.91], Avg: 303.7585 (0.362)
Ep: 338, Reward: 526.7741, Test: 519.5886 [212.29], Avg: 303.7690 (0.361)
Ep: 339, Reward: 604.0638, Test: 621.4936 [234.66], Avg: 304.0133 (0.360)
Ep: 340, Reward: 654.8703, Test: 530.4550 [192.67], Avg: 304.1123 (0.359)
Ep: 341, Reward: 558.5370, Test: 515.4199 [181.75], Avg: 304.1987 (0.358)
Ep: 342, Reward: 575.8786, Test: 614.0147 [261.70], Avg: 304.3390 (0.357)
Ep: 343, Reward: 645.8217, Test: 542.4939 [195.99], Avg: 304.4616 (0.356)
Ep: 344, Reward: 672.7550, Test: 563.1311 [182.04], Avg: 304.6837 (0.355)
Ep: 345, Reward: 607.4800, Test: 689.3225 [134.63], Avg: 305.4063 (0.354)
Ep: 346, Reward: 718.0626, Test: 702.0233 [102.50], Avg: 306.2539 (0.353)
Ep: 347, Reward: 582.8045, Test: 649.8342 [195.07], Avg: 306.6806 (0.351)
Ep: 348, Reward: 681.1380, Test: 601.6221 [181.97], Avg: 307.0043 (0.350)
Ep: 349, Reward: 625.1175, Test: 600.4307 [229.91], Avg: 307.1858 (0.349)
Ep: 350, Reward: 642.5185, Test: 643.3906 [220.05], Avg: 307.5167 (0.348)
Ep: 351, Reward: 610.5549, Test: 689.5319 [144.20], Avg: 308.1923 (0.347)
Ep: 352, Reward: 744.8560, Test: 584.3272 [215.45], Avg: 308.3642 (0.346)
Ep: 353, Reward: 576.6729, Test: 644.7841 [209.24], Avg: 308.7235 (0.345)
Ep: 354, Reward: 699.7474, Test: 528.1293 [203.44], Avg: 308.7685 (0.344)
Ep: 355, Reward: 584.6659, Test: 641.0816 [203.25], Avg: 309.1310 (0.343)
Ep: 356, Reward: 596.4433, Test: 675.8764 [156.82], Avg: 309.7190 (0.342)
Ep: 357, Reward: 587.8650, Test: 574.0035 [156.65], Avg: 310.0197 (0.341)
Ep: 358, Reward: 689.2709, Test: 606.3321 [252.39], Avg: 310.1420 (0.340)
Ep: 359, Reward: 650.0398, Test: 583.8696 [155.35], Avg: 310.4709 (0.339)
Ep: 360, Reward: 675.7035, Test: 621.3572 [200.19], Avg: 310.7775 (0.338)
Ep: 361, Reward: 565.5586, Test: 689.4602 [117.29], Avg: 311.4996 (0.337)
Ep: 362, Reward: 713.9029, Test: 684.9915 [191.25], Avg: 312.0016 (0.336)
Ep: 363, Reward: 580.0546, Test: 614.0166 [214.70], Avg: 312.2415 (0.335)
Ep: 364, Reward: 561.7002, Test: 636.1595 [189.70], Avg: 312.6092 (0.334)
Ep: 365, Reward: 608.0423, Test: 506.9511 [219.62], Avg: 312.5402 (0.333)
Ep: 366, Reward: 614.4100, Test: 681.3499 [222.10], Avg: 312.9399 (0.332)
Ep: 367, Reward: 577.2120, Test: 653.2107 [167.25], Avg: 313.4101 (0.331)
Ep: 368, Reward: 574.6872, Test: 628.3242 [176.98], Avg: 313.7839 (0.330)
Ep: 369, Reward: 530.6743, Test: 686.1211 [133.74], Avg: 314.4288 (0.329)
Ep: 370, Reward: 582.3337, Test: 562.3862 [191.75], Avg: 314.5803 (0.328)
Ep: 371, Reward: 612.3468, Test: 609.9580 [182.52], Avg: 314.8836 (0.327)
Ep: 372, Reward: 647.3869, Test: 619.2482 [179.44], Avg: 315.2186 (0.326)
Ep: 373, Reward: 600.7449, Test: 528.3873 [209.89], Avg: 315.2273 (0.325)
Ep: 374, Reward: 705.2513, Test: 587.7851 [211.29], Avg: 315.3907 (0.324)
Ep: 375, Reward: 639.8558, Test: 624.7425 [173.09], Avg: 315.7531 (0.323)
Ep: 376, Reward: 647.4072, Test: 581.5193 [213.48], Avg: 315.8918 (0.322)
Ep: 377, Reward: 586.4646, Test: 717.0380 [143.77], Avg: 316.5727 (0.321)
Ep: 378, Reward: 650.7439, Test: 767.5238 [92.22], Avg: 317.5192 (0.320)
Ep: 379, Reward: 675.8663, Test: 754.3401 [135.28], Avg: 318.3127 (0.319)
Ep: 380, Reward: 693.9329, Test: 797.4048 [60.26], Avg: 319.4120 (0.318)
Ep: 381, Reward: 766.0271, Test: 745.2673 [153.82], Avg: 320.1242 (0.317)
Ep: 382, Reward: 603.5763, Test: 742.6610 [167.68], Avg: 320.7896 (0.316)
Ep: 383, Reward: 654.4327, Test: 728.8365 [163.02], Avg: 321.4277 (0.315)
Ep: 384, Reward: 651.4122, Test: 701.7469 [197.41], Avg: 321.9027 (0.315)
Ep: 385, Reward: 703.5305, Test: 652.8908 [190.33], Avg: 322.2671 (0.314)
Ep: 386, Reward: 705.3711, Test: 673.5345 [250.95], Avg: 322.5263 (0.313)
Ep: 387, Reward: 677.8619, Test: 551.8094 [277.86], Avg: 322.4012 (0.312)
Ep: 388, Reward: 758.3912, Test: 641.4644 [226.03], Avg: 322.6403 (0.311)
Ep: 389, Reward: 709.5884, Test: 763.7356 [88.77], Avg: 323.5437 (0.310)
Ep: 390, Reward: 686.4322, Test: 705.4433 [165.45], Avg: 324.0973 (0.309)
Ep: 391, Reward: 661.3343, Test: 754.4834 [100.75], Avg: 324.9382 (0.308)
Ep: 392, Reward: 759.3841, Test: 688.1780 [156.34], Avg: 325.4647 (0.307)
Ep: 393, Reward: 704.1277, Test: 780.8032 [82.82], Avg: 326.4101 (0.306)
Ep: 394, Reward: 694.4021, Test: 618.9657 [203.53], Avg: 326.6355 (0.305)
Ep: 395, Reward: 582.2756, Test: 710.7479 [187.13], Avg: 327.1329 (0.304)
Ep: 396, Reward: 722.1623, Test: 775.4287 [153.28], Avg: 327.8761 (0.303)
Ep: 397, Reward: 711.3478, Test: 566.8215 [259.84], Avg: 327.8236 (0.302)
Ep: 398, Reward: 696.7518, Test: 697.3290 [188.63], Avg: 328.2769 (0.302)
Ep: 399, Reward: 731.3485, Test: 781.3872 [70.02], Avg: 329.2346 (0.301)
Ep: 400, Reward: 688.7698, Test: 779.3162 [114.64], Avg: 330.0711 (0.300)
Ep: 401, Reward: 808.7861, Test: 714.1686 [167.28], Avg: 330.6104 (0.299)
Ep: 402, Reward: 772.1585, Test: 738.3321 [120.03], Avg: 331.3243 (0.298)
Ep: 403, Reward: 699.7454, Test: 673.0706 [168.39], Avg: 331.7534 (0.297)
Ep: 404, Reward: 702.9484, Test: 711.2046 [201.24], Avg: 332.1934 (0.296)
Ep: 405, Reward: 721.2217, Test: 746.0989 [148.53], Avg: 332.8471 (0.295)
Ep: 406, Reward: 719.8053, Test: 740.0312 [175.02], Avg: 333.4175 (0.294)
Ep: 407, Reward: 731.9951, Test: 771.0100 [66.96], Avg: 334.3259 (0.294)
Ep: 408, Reward: 749.2351, Test: 760.2654 [114.25], Avg: 335.0880 (0.293)
Ep: 409, Reward: 784.6207, Test: 671.3777 [202.16], Avg: 335.4151 (0.292)
Ep: 410, Reward: 682.3368, Test: 709.4004 [189.03], Avg: 335.8651 (0.291)
Ep: 411, Reward: 705.0321, Test: 763.1133 [145.71], Avg: 336.5485 (0.290)
Ep: 412, Reward: 807.8243, Test: 732.5687 [145.60], Avg: 337.1548 (0.289)
Ep: 413, Reward: 729.8008, Test: 820.9355 [63.71], Avg: 338.1695 (0.288)
Ep: 414, Reward: 729.7217, Test: 760.4723 [123.01], Avg: 338.8907 (0.287)
Ep: 415, Reward: 729.4398, Test: 809.2239 [63.14], Avg: 339.8695 (0.287)
Ep: 416, Reward: 693.3824, Test: 713.3770 [118.85], Avg: 340.4802 (0.286)
Ep: 417, Reward: 742.3677, Test: 708.1095 [148.99], Avg: 341.0033 (0.285)
Ep: 418, Reward: 665.4085, Test: 812.4649 [48.26], Avg: 342.0133 (0.284)
Ep: 419, Reward: 679.2296, Test: 697.9928 [146.57], Avg: 342.5119 (0.283)
Ep: 420, Reward: 647.5120, Test: 745.0956 [99.23], Avg: 343.2324 (0.282)
Ep: 421, Reward: 699.6976, Test: 731.7083 [146.60], Avg: 343.8056 (0.281)
Ep: 422, Reward: 691.3567, Test: 742.7216 [156.99], Avg: 344.3775 (0.281)
Ep: 423, Reward: 714.3942, Test: 623.5878 [231.47], Avg: 344.4901 (0.280)
Ep: 424, Reward: 625.8359, Test: 565.7796 [246.74], Avg: 344.4302 (0.279)
Ep: 425, Reward: 672.1657, Test: 601.7866 [235.39], Avg: 344.4818 (0.278)
Ep: 426, Reward: 738.8553, Test: 726.5831 [127.39], Avg: 345.0783 (0.277)
Ep: 427, Reward: 757.7906, Test: 493.8659 [137.44], Avg: 345.1048 (0.276)
Ep: 428, Reward: 626.3501, Test: 627.2645 [182.56], Avg: 345.3370 (0.276)
Ep: 429, Reward: 771.1910, Test: 730.3710 [149.10], Avg: 345.8857 (0.275)
Ep: 430, Reward: 768.2559, Test: 709.0468 [146.53], Avg: 346.3883 (0.274)
Ep: 431, Reward: 727.2963, Test: 763.0127 [103.27], Avg: 347.1137 (0.273)
Ep: 432, Reward: 771.4791, Test: 769.9426 [130.39], Avg: 347.7890 (0.272)
Ep: 433, Reward: 610.0960, Test: 749.6408 [112.10], Avg: 348.4567 (0.271)
Ep: 434, Reward: 684.3386, Test: 785.9017 [176.62], Avg: 349.0563 (0.271)
Ep: 435, Reward: 717.2935, Test: 735.1605 [159.61], Avg: 349.5758 (0.270)
Ep: 436, Reward: 659.8909, Test: 651.3527 [238.57], Avg: 349.7204 (0.269)
Ep: 437, Reward: 784.4273, Test: 652.5168 [188.25], Avg: 349.9819 (0.268)
Ep: 438, Reward: 720.9690, Test: 744.8098 [165.60], Avg: 350.5041 (0.267)
Ep: 439, Reward: 693.1635, Test: 700.7553 [229.52], Avg: 350.7785 (0.267)
Ep: 440, Reward: 745.0087, Test: 758.1797 [109.01], Avg: 351.4551 (0.266)
Ep: 441, Reward: 758.0920, Test: 627.2496 [226.11], Avg: 351.5675 (0.265)
Ep: 442, Reward: 754.7407, Test: 757.8600 [140.84], Avg: 352.1667 (0.264)
Ep: 443, Reward: 800.8232, Test: 748.3251 [143.30], Avg: 352.7362 (0.263)
Ep: 444, Reward: 722.6248, Test: 712.0320 [245.44], Avg: 352.9920 (0.263)
Ep: 445, Reward: 632.0668, Test: 722.5384 [217.77], Avg: 353.3323 (0.262)
Ep: 446, Reward: 770.8265, Test: 800.9670 [70.06], Avg: 354.1770 (0.261)
Ep: 447, Reward: 789.9718, Test: 682.8581 [215.33], Avg: 354.4301 (0.260)
Ep: 448, Reward: 807.9810, Test: 821.9780 [37.50], Avg: 355.3878 (0.259)
Ep: 449, Reward: 734.5425, Test: 772.0771 [164.93], Avg: 355.9473 (0.259)
Ep: 450, Reward: 649.9287, Test: 768.4897 [129.15], Avg: 356.5757 (0.258)
Ep: 451, Reward: 774.3004, Test: 689.5078 [211.44], Avg: 356.8444 (0.257)
Ep: 452, Reward: 808.2906, Test: 768.1023 [163.64], Avg: 357.3911 (0.256)
Ep: 453, Reward: 755.5741, Test: 758.4406 [141.74], Avg: 357.9622 (0.256)
Ep: 454, Reward: 822.8605, Test: 663.5500 [203.85], Avg: 358.1858 (0.255)
Ep: 455, Reward: 673.8142, Test: 679.3597 [163.58], Avg: 358.5314 (0.254)
Ep: 456, Reward: 680.5586, Test: 720.6851 [131.87], Avg: 359.0353 (0.253)
Ep: 457, Reward: 698.2209, Test: 655.6626 [218.72], Avg: 359.2055 (0.253)
Ep: 458, Reward: 762.4662, Test: 712.5692 [140.97], Avg: 359.6682 (0.252)
Ep: 459, Reward: 704.3784, Test: 701.5907 [122.41], Avg: 360.1454 (0.251)
Ep: 460, Reward: 627.4445, Test: 762.5961 [93.73], Avg: 360.8151 (0.250)
Ep: 461, Reward: 801.2027, Test: 673.6788 [175.21], Avg: 361.1130 (0.250)
Ep: 462, Reward: 716.2494, Test: 750.5062 [124.53], Avg: 361.6851 (0.249)
Ep: 463, Reward: 765.5847, Test: 682.3672 [177.01], Avg: 361.9947 (0.248)
Ep: 464, Reward: 747.9220, Test: 721.3611 [163.87], Avg: 362.4151 (0.247)
Ep: 465, Reward: 748.0531, Test: 777.7067 [153.08], Avg: 362.9778 (0.247)
Ep: 466, Reward: 760.5578, Test: 610.1664 [190.16], Avg: 363.0999 (0.246)
Ep: 467, Reward: 741.8427, Test: 748.9547 [135.64], Avg: 363.6346 (0.245)
Ep: 468, Reward: 791.3574, Test: 812.0293 [78.38], Avg: 364.4235 (0.244)
Ep: 469, Reward: 734.6762, Test: 805.5433 [76.29], Avg: 365.1998 (0.244)
Ep: 470, Reward: 743.8282, Test: 767.3479 [136.86], Avg: 365.7630 (0.243)
Ep: 471, Reward: 694.9146, Test: 724.5798 [153.30], Avg: 366.1984 (0.242)
Ep: 472, Reward: 643.5686, Test: 644.7258 [217.03], Avg: 366.3284 (0.241)
Ep: 473, Reward: 747.3264, Test: 764.2454 [76.27], Avg: 367.0070 (0.241)
Ep: 474, Reward: 732.6323, Test: 743.4911 [151.67], Avg: 367.4803 (0.240)
Ep: 475, Reward: 672.6579, Test: 722.1415 [207.37], Avg: 367.7897 (0.239)
Ep: 476, Reward: 746.1043, Test: 760.1933 [124.71], Avg: 368.3510 (0.239)
Ep: 477, Reward: 707.9597, Test: 773.4515 [107.19], Avg: 368.9742 (0.238)
Ep: 478, Reward: 697.7226, Test: 761.8704 [197.46], Avg: 369.3822 (0.237)
Ep: 479, Reward: 798.2773, Test: 752.1149 [156.93], Avg: 369.8526 (0.236)
Ep: 480, Reward: 682.7218, Test: 659.5996 [179.17], Avg: 370.0825 (0.236)
Ep: 481, Reward: 813.4673, Test: 748.7660 [131.79], Avg: 370.5948 (0.235)
Ep: 482, Reward: 667.8072, Test: 746.0108 [167.74], Avg: 371.0247 (0.234)
Ep: 483, Reward: 758.1805, Test: 698.2585 [197.99], Avg: 371.2918 (0.234)
Ep: 484, Reward: 782.1538, Test: 813.9363 [49.56], Avg: 372.1023 (0.233)
Ep: 485, Reward: 749.7876, Test: 753.4554 [125.46], Avg: 372.6288 (0.232)
Ep: 486, Reward: 706.0402, Test: 724.9669 [203.37], Avg: 372.9347 (0.231)
Ep: 487, Reward: 689.4941, Test: 634.4750 [267.04], Avg: 372.9234 (0.231)
Ep: 488, Reward: 746.0834, Test: 727.2214 [145.94], Avg: 373.3495 (0.230)
Ep: 489, Reward: 824.0242, Test: 769.0887 [94.07], Avg: 373.9651 (0.229)
Ep: 490, Reward: 725.8203, Test: 711.7230 [129.90], Avg: 374.3885 (0.229)
Ep: 491, Reward: 768.8687, Test: 732.8652 [158.18], Avg: 374.7956 (0.228)
Ep: 492, Reward: 751.7070, Test: 756.7751 [180.56], Avg: 375.2041 (0.227)
Ep: 493, Reward: 734.8221, Test: 747.5689 [78.19], Avg: 375.7996 (0.227)
Ep: 494, Reward: 727.7762, Test: 792.4141 [109.13], Avg: 376.4208 (0.226)
Ep: 495, Reward: 784.0579, Test: 754.6065 [151.92], Avg: 376.8770 (0.225)
Ep: 496, Reward: 721.2579, Test: 753.5892 [178.69], Avg: 377.2754 (0.225)
Ep: 497, Reward: 765.6055, Test: 779.3514 [118.55], Avg: 377.8447 (0.224)
Ep: 498, Reward: 683.6009, Test: 699.7820 [218.19], Avg: 378.0527 (0.223)
Ep: 499, Reward: 763.0662, Test: 775.3359 [92.33], Avg: 378.6626 (0.223)
