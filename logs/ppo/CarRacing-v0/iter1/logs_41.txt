Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.100                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.05				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(PPO_EPOCHS):
				for i in range(0, len(self.replay_buffer), BATCH_SIZE):
					state, action, log_prob, target, advantage = self.replay_buffer.index(BATCH_SIZE, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -22.7615, Test: -16.4682 [13.16], Avg: -29.6288 (0.997)
Ep: 1, Reward: -21.3295, Test: -12.3980 [22.19], Avg: -32.1093 (0.994)
Ep: 2, Reward: -1.6956, Test: -33.5948 [23.13], Avg: -40.3149 (0.991)
Ep: 3, Reward: -18.5297, Test: 20.4218 [44.04], Avg: -36.1413 (0.988)
Ep: 4, Reward: 30.0002, Test: 83.6959 [77.80], Avg: -27.7344 (0.985)
Ep: 5, Reward: 197.8724, Test: 321.4646 [131.87], Avg: 8.4871 (0.982)
Ep: 6, Reward: 425.4763, Test: 434.1672 [196.34], Avg: 41.2501 (0.979)
Ep: 7, Reward: 451.2148, Test: 459.2691 [145.03], Avg: 75.3732 (0.976)
Ep: 8, Reward: 689.6360, Test: 605.7257 [241.28], Avg: 107.4929 (0.973)
Ep: 9, Reward: 551.5270, Test: 499.1869 [233.89], Avg: 123.2734 (0.970)
Ep: 10, Reward: 492.5551, Test: 526.0745 [206.67], Avg: 141.1031 (0.967)
Ep: 11, Reward: 665.7102, Test: 683.5857 [216.49], Avg: 168.2690 (0.965)
Ep: 12, Reward: 605.2721, Test: 541.0365 [145.44], Avg: 185.7555 (0.962)
Ep: 13, Reward: 569.7370, Test: 648.2588 [73.65], Avg: 213.5307 (0.959)
Ep: 14, Reward: 408.0339, Test: 456.4470 [63.67], Avg: 225.4803 (0.956)
Ep: 15, Reward: 454.1334, Test: 428.5928 [95.55], Avg: 232.2028 (0.953)
Ep: 16, Reward: 514.3727, Test: 611.5898 [85.23], Avg: 249.5059 (0.950)
Ep: 17, Reward: 510.6654, Test: 586.0901 [87.44], Avg: 263.3471 (0.947)
Ep: 18, Reward: 510.4474, Test: 506.4944 [203.07], Avg: 265.4565 (0.945)
Ep: 19, Reward: 534.9200, Test: 645.1458 [244.39], Avg: 272.2216 (0.942)
Ep: 20, Reward: 613.4746, Test: 575.1336 [200.47], Avg: 277.1000 (0.939)
Ep: 21, Reward: 663.4863, Test: 675.1754 [201.91], Avg: 286.0166 (0.936)
Ep: 22, Reward: 644.0783, Test: 694.5348 [186.09], Avg: 295.6875 (0.933)
Ep: 23, Reward: 700.3221, Test: 688.9756 [251.52], Avg: 301.5944 (0.930)
Ep: 24, Reward: 769.6449, Test: 848.8431 [91.84], Avg: 319.8107 (0.928)
Ep: 25, Reward: 844.5712, Test: 825.5102 [98.13], Avg: 335.4864 (0.925)
Ep: 26, Reward: 740.7548, Test: 669.4320 [174.49], Avg: 341.3921 (0.922)
Ep: 27, Reward: 810.8094, Test: 721.8621 [216.47], Avg: 347.2491 (0.919)
Ep: 28, Reward: 583.4067, Test: 653.1947 [221.30], Avg: 350.1678 (0.917)
Ep: 29, Reward: 603.7294, Test: 547.3670 [252.93], Avg: 348.3100 (0.914)
Ep: 30, Reward: 532.9360, Test: 460.4245 [149.19], Avg: 347.1140 (0.911)
Ep: 31, Reward: 571.7084, Test: 565.9268 [130.05], Avg: 349.8878 (0.908)
Ep: 32, Reward: 663.1623, Test: 644.1037 [232.43], Avg: 351.7600 (0.906)
Ep: 33, Reward: 748.0716, Test: 694.2171 [171.29], Avg: 356.7942 (0.903)
Ep: 34, Reward: 727.3613, Test: 771.1209 [178.54], Avg: 363.5311 (0.900)
Ep: 35, Reward: 609.0432, Test: 670.3963 [216.94], Avg: 366.0289 (0.897)
Ep: 36, Reward: 715.4733, Test: 604.9548 [206.36], Avg: 366.9090 (0.895)
Ep: 37, Reward: 642.3395, Test: 775.2362 [153.25], Avg: 373.6215 (0.892)
Ep: 38, Reward: 684.5970, Test: 680.8029 [172.45], Avg: 377.0761 (0.889)
Ep: 39, Reward: 667.8541, Test: 742.5796 [186.86], Avg: 381.5422 (0.887)
Ep: 40, Reward: 733.1555, Test: 719.6570 [225.40], Avg: 384.2914 (0.884)
Ep: 41, Reward: 923.6542, Test: 834.2020 [123.76], Avg: 392.0568 (0.881)
Ep: 42, Reward: 919.0490, Test: 853.7938 [128.81], Avg: 399.7994 (0.879)
Ep: 43, Reward: 892.0635, Test: 749.6771 [214.50], Avg: 402.8763 (0.876)
Ep: 44, Reward: 751.7137, Test: 809.2915 [109.93], Avg: 409.4648 (0.874)
Ep: 45, Reward: 827.3187, Test: 829.3668 [85.19], Avg: 416.7410 (0.871)
Ep: 46, Reward: 794.2068, Test: 678.6077 [218.32], Avg: 417.6676 (0.868)
Ep: 47, Reward: 708.8712, Test: 719.4906 [188.47], Avg: 420.0292 (0.866)
Ep: 48, Reward: 664.4672, Test: 723.1019 [172.37], Avg: 422.6966 (0.863)
Ep: 49, Reward: 646.8310, Test: 685.0792 [177.39], Avg: 424.3964 (0.861)
Ep: 50, Reward: 677.5926, Test: 710.1432 [242.71], Avg: 425.2404 (0.858)
Ep: 51, Reward: 783.7024, Test: 652.2238 [209.35], Avg: 425.5795 (0.855)
Ep: 52, Reward: 609.7295, Test: 719.4572 [117.68], Avg: 428.9040 (0.853)
Ep: 53, Reward: 623.4140, Test: 582.9733 [231.81], Avg: 427.4644 (0.850)
Ep: 54, Reward: 587.5161, Test: 567.7548 [182.33], Avg: 426.7001 (0.848)
Ep: 55, Reward: 595.0907, Test: 569.3819 [169.86], Avg: 426.2148 (0.845)
Ep: 56, Reward: 653.1845, Test: 520.4819 [226.48], Avg: 423.8953 (0.843)
Ep: 57, Reward: 627.9610, Test: 615.2756 [180.53], Avg: 424.0824 (0.840)
Ep: 58, Reward: 657.8411, Test: 595.2687 [181.41], Avg: 423.9092 (0.838)
Ep: 59, Reward: 630.9052, Test: 676.4175 [145.14], Avg: 425.6987 (0.835)
Ep: 60, Reward: 580.2487, Test: 589.4531 [194.77], Avg: 425.1903 (0.833)
Ep: 61, Reward: 484.4903, Test: 500.8986 [158.98], Avg: 423.8472 (0.830)
Ep: 62, Reward: 640.4988, Test: 487.5503 [171.48], Avg: 422.1363 (0.828)
Ep: 63, Reward: 541.9513, Test: 497.6139 [130.14], Avg: 421.2823 (0.825)
Ep: 64, Reward: 574.4940, Test: 532.4720 [216.58], Avg: 419.6609 (0.823)
Ep: 65, Reward: 588.7906, Test: 627.3129 [169.63], Avg: 420.2370 (0.820)
Ep: 66, Reward: 628.6970, Test: 606.2993 [159.41], Avg: 420.6348 (0.818)
Ep: 67, Reward: 699.2267, Test: 600.0544 [243.88], Avg: 419.6869 (0.815)
Ep: 68, Reward: 643.0638, Test: 579.5519 [201.03], Avg: 419.0903 (0.813)
Ep: 69, Reward: 686.2923, Test: 665.7083 [158.27], Avg: 420.3525 (0.810)
Ep: 70, Reward: 648.1858, Test: 703.8493 [117.21], Avg: 422.6945 (0.808)
Ep: 71, Reward: 710.6077, Test: 682.8058 [230.88], Avg: 423.1005 (0.805)
Ep: 72, Reward: 707.4389, Test: 702.2914 [207.91], Avg: 424.0770 (0.803)
Ep: 73, Reward: 684.8028, Test: 698.8818 [256.78], Avg: 424.3206 (0.801)
Ep: 74, Reward: 783.8095, Test: 749.7573 [248.66], Avg: 425.3442 (0.798)
Ep: 75, Reward: 789.0715, Test: 791.7777 [190.27], Avg: 427.6621 (0.796)
Ep: 76, Reward: 809.2682, Test: 819.5956 [130.82], Avg: 431.0532 (0.793)
Ep: 77, Reward: 792.9733, Test: 843.1079 [118.60], Avg: 434.8154 (0.791)
Ep: 78, Reward: 807.7806, Test: 818.4376 [103.93], Avg: 438.3558 (0.789)
Ep: 79, Reward: 828.1818, Test: 832.8092 [73.26], Avg: 442.3708 (0.786)
Ep: 80, Reward: 901.5161, Test: 868.0984 [98.02], Avg: 446.4166 (0.784)
Ep: 81, Reward: 744.4984, Test: 758.3793 [163.60], Avg: 448.2259 (0.782)
Ep: 82, Reward: 832.0177, Test: 789.7513 [179.73], Avg: 450.1753 (0.779)
Ep: 83, Reward: 887.6731, Test: 796.9165 [166.51], Avg: 452.3209 (0.777)
Ep: 84, Reward: 859.5974, Test: 855.0511 [70.15], Avg: 456.2337 (0.775)
Ep: 85, Reward: 905.5657, Test: 823.5274 [131.13], Avg: 458.9797 (0.772)
Ep: 86, Reward: 874.9896, Test: 837.6198 [98.07], Avg: 462.2046 (0.770)
Ep: 87, Reward: 893.3815, Test: 822.3466 [129.16], Avg: 464.8295 (0.768)
Ep: 88, Reward: 915.4521, Test: 868.9716 [45.95], Avg: 468.8541 (0.765)
Ep: 89, Reward: 896.3740, Test: 826.9759 [162.53], Avg: 471.0273 (0.763)
Ep: 90, Reward: 893.1715, Test: 810.5843 [159.96], Avg: 473.0009 (0.761)
Ep: 91, Reward: 818.6275, Test: 811.7033 [133.97], Avg: 475.2262 (0.758)
Ep: 92, Reward: 817.8649, Test: 880.1096 [28.27], Avg: 479.2758 (0.756)
Ep: 93, Reward: 743.0760, Test: 816.2568 [135.89], Avg: 481.4151 (0.754)
Ep: 94, Reward: 823.5333, Test: 840.4593 [117.68], Avg: 483.9558 (0.752)
Ep: 95, Reward: 820.0386, Test: 808.8682 [129.05], Avg: 485.9960 (0.749)
Ep: 96, Reward: 910.0730, Test: 865.7187 [80.53], Avg: 489.0805 (0.747)
Ep: 97, Reward: 836.6728, Test: 849.3215 [140.26], Avg: 491.3251 (0.745)
Ep: 98, Reward: 902.9411, Test: 901.8653 [17.23], Avg: 495.2980 (0.743)
Ep: 99, Reward: 896.3975, Test: 832.0233 [112.86], Avg: 497.5366 (0.740)
Ep: 100, Reward: 899.4112, Test: 849.6627 [95.14], Avg: 500.0810 (0.738)
Ep: 101, Reward: 928.9143, Test: 901.1960 [26.81], Avg: 503.7507 (0.736)
Ep: 102, Reward: 920.7638, Test: 898.6361 [19.81], Avg: 507.3921 (0.734)
Ep: 103, Reward: 948.4639, Test: 866.8726 [62.29], Avg: 510.2498 (0.732)
Ep: 104, Reward: 938.1013, Test: 861.6721 [89.38], Avg: 512.7454 (0.729)
Ep: 105, Reward: 884.8133, Test: 902.8739 [18.76], Avg: 516.2489 (0.727)
Ep: 106, Reward: 868.5607, Test: 819.2605 [172.17], Avg: 517.4717 (0.725)
Ep: 107, Reward: 894.0588, Test: 813.1410 [186.45], Avg: 518.4831 (0.723)
Ep: 108, Reward: 878.8515, Test: 799.9275 [128.06], Avg: 519.8903 (0.721)
Ep: 109, Reward: 939.9400, Test: 874.6847 [69.72], Avg: 522.4818 (0.719)
Ep: 110, Reward: 940.0978, Test: 855.8247 [119.85], Avg: 524.4052 (0.716)
Ep: 111, Reward: 947.0224, Test: 861.3420 [59.37], Avg: 526.8834 (0.714)
Ep: 112, Reward: 910.5046, Test: 867.0977 [83.79], Avg: 529.1527 (0.712)
Ep: 113, Reward: 877.1922, Test: 860.9514 [65.58], Avg: 531.4879 (0.710)
Ep: 114, Reward: 876.3489, Test: 802.9832 [147.89], Avg: 532.5627 (0.708)
Ep: 115, Reward: 841.3651, Test: 823.3220 [156.78], Avg: 533.7177 (0.706)
Ep: 116, Reward: 933.4410, Test: 886.6333 [22.71], Avg: 536.5400 (0.704)
Ep: 117, Reward: 804.9944, Test: 859.5830 [48.17], Avg: 538.8694 (0.702)
Ep: 118, Reward: 898.7838, Test: 839.4846 [123.05], Avg: 540.3615 (0.699)
Ep: 119, Reward: 848.9955, Test: 867.5052 [42.91], Avg: 542.7301 (0.697)
Ep: 120, Reward: 834.7583, Test: 872.3259 [32.17], Avg: 545.1882 (0.695)
Ep: 121, Reward: 890.2052, Test: 831.2441 [90.26], Avg: 546.7931 (0.693)
Ep: 122, Reward: 924.2009, Test: 873.1967 [29.62], Avg: 549.2060 (0.691)
Ep: 123, Reward: 848.0452, Test: 819.4210 [166.79], Avg: 550.0400 (0.689)
Ep: 124, Reward: 945.9429, Test: 850.2631 [79.15], Avg: 551.8086 (0.687)
Ep: 125, Reward: 880.1851, Test: 875.3982 [34.44], Avg: 554.1034 (0.685)
Ep: 126, Reward: 879.0511, Test: 857.3154 [76.40], Avg: 555.8893 (0.683)
Ep: 127, Reward: 910.1910, Test: 834.0732 [83.71], Avg: 557.4086 (0.681)
Ep: 128, Reward: 855.3600, Test: 849.9318 [120.49], Avg: 558.7422 (0.679)
Ep: 129, Reward: 872.5177, Test: 771.0201 [169.27], Avg: 559.0731 (0.677)
Ep: 130, Reward: 833.9020, Test: 661.4950 [197.31], Avg: 558.3487 (0.675)
Ep: 131, Reward: 799.8356, Test: 779.2380 [133.24], Avg: 559.0127 (0.673)
Ep: 132, Reward: 766.1607, Test: 715.4033 [165.75], Avg: 558.9424 (0.671)
Ep: 133, Reward: 732.6882, Test: 766.8749 [140.84], Avg: 559.4430 (0.669)
Ep: 134, Reward: 814.2565, Test: 678.6837 [217.95], Avg: 558.7119 (0.667)
Ep: 135, Reward: 767.5806, Test: 761.1187 [132.43], Avg: 559.2264 (0.665)
Ep: 136, Reward: 776.6574, Test: 765.5830 [131.18], Avg: 559.7752 (0.663)
Ep: 137, Reward: 717.6288, Test: 716.4214 [220.72], Avg: 559.3108 (0.661)
Ep: 138, Reward: 775.6704, Test: 743.3552 [129.23], Avg: 559.7052 (0.659)
Ep: 139, Reward: 751.6781, Test: 735.6319 [188.35], Avg: 559.6164 (0.657)
Ep: 140, Reward: 768.6678, Test: 815.4468 [53.01], Avg: 561.0548 (0.655)
Ep: 141, Reward: 727.2398, Test: 706.6433 [156.84], Avg: 560.9756 (0.653)
Ep: 142, Reward: 749.3761, Test: 636.1752 [233.27], Avg: 559.8702 (0.651)
Ep: 143, Reward: 710.2592, Test: 680.7769 [192.20], Avg: 559.3751 (0.649)
Ep: 144, Reward: 755.0787, Test: 740.0154 [162.50], Avg: 559.5002 (0.647)
Ep: 145, Reward: 804.9149, Test: 622.0261 [185.36], Avg: 558.6589 (0.645)
Ep: 146, Reward: 640.6714, Test: 598.5434 [210.19], Avg: 557.5003 (0.643)
Ep: 147, Reward: 769.6832, Test: 693.1618 [163.34], Avg: 557.3133 (0.641)
Ep: 148, Reward: 766.2889, Test: 694.6409 [169.12], Avg: 557.1000 (0.639)
Ep: 149, Reward: 691.6332, Test: 773.1729 [144.65], Avg: 557.5761 (0.637)
Ep: 150, Reward: 816.6565, Test: 722.5760 [177.43], Avg: 557.4938 (0.635)
Ep: 151, Reward: 767.7296, Test: 818.3828 [69.78], Avg: 558.7511 (0.633)
Ep: 152, Reward: 789.3747, Test: 786.4027 [154.83], Avg: 559.2270 (0.631)
Ep: 153, Reward: 822.7594, Test: 745.6152 [215.96], Avg: 559.0350 (0.630)
Ep: 154, Reward: 786.6008, Test: 771.6154 [164.09], Avg: 559.3479 (0.628)
Ep: 155, Reward: 688.5285, Test: 761.6592 [167.83], Avg: 559.5689 (0.626)
Ep: 156, Reward: 689.3753, Test: 759.8080 [109.32], Avg: 560.1480 (0.624)
Ep: 157, Reward: 809.4350, Test: 784.2493 [129.89], Avg: 560.7443 (0.622)
Ep: 158, Reward: 696.4132, Test: 734.8236 [122.39], Avg: 561.0694 (0.620)
Ep: 159, Reward: 757.9663, Test: 747.5562 [195.56], Avg: 561.0127 (0.618)
Ep: 160, Reward: 824.7498, Test: 754.1663 [171.54], Avg: 561.1469 (0.616)
Ep: 161, Reward: 831.2458, Test: 764.7708 [159.72], Avg: 561.4179 (0.615)
Ep: 162, Reward: 760.2266, Test: 733.4081 [182.89], Avg: 561.3511 (0.613)
Ep: 163, Reward: 786.1708, Test: 827.2650 [104.11], Avg: 562.3377 (0.611)
Ep: 164, Reward: 845.9488, Test: 727.7042 [197.96], Avg: 562.1402 (0.609)
Ep: 165, Reward: 822.0662, Test: 768.3317 [170.76], Avg: 562.3536 (0.607)
Ep: 166, Reward: 841.2776, Test: 832.8112 [90.15], Avg: 563.4333 (0.605)
Ep: 167, Reward: 798.7533, Test: 808.5660 [154.50], Avg: 563.9728 (0.604)
Ep: 168, Reward: 879.5388, Test: 713.4809 [209.44], Avg: 563.6181 (0.602)
Ep: 169, Reward: 843.6313, Test: 747.9224 [160.14], Avg: 563.7603 (0.600)
Ep: 170, Reward: 775.2032, Test: 710.0073 [193.18], Avg: 563.4858 (0.598)
Ep: 171, Reward: 746.1172, Test: 790.5781 [99.81], Avg: 564.2258 (0.596)
Ep: 172, Reward: 776.0259, Test: 704.5188 [180.33], Avg: 563.9944 (0.595)
Ep: 173, Reward: 694.3844, Test: 636.7402 [211.46], Avg: 563.1972 (0.593)
Ep: 174, Reward: 679.2844, Test: 803.2526 [130.39], Avg: 563.8239 (0.591)
Ep: 175, Reward: 684.1114, Test: 797.3325 [183.04], Avg: 564.1106 (0.589)
Ep: 176, Reward: 765.8698, Test: 724.8293 [177.07], Avg: 564.0183 (0.588)
Ep: 177, Reward: 712.2966, Test: 676.5437 [193.78], Avg: 563.5618 (0.586)
Ep: 178, Reward: 681.5731, Test: 694.5546 [149.54], Avg: 563.4581 (0.584)
Ep: 179, Reward: 614.9375, Test: 752.5781 [113.11], Avg: 563.8804 (0.582)
Ep: 180, Reward: 644.2126, Test: 666.4688 [212.79], Avg: 563.2716 (0.581)
Ep: 181, Reward: 629.3494, Test: 719.7444 [168.49], Avg: 563.2056 (0.579)
Ep: 182, Reward: 715.9155, Test: 706.6425 [181.89], Avg: 562.9954 (0.577)
Ep: 183, Reward: 676.8266, Test: 727.3859 [136.95], Avg: 563.1446 (0.575)
Ep: 184, Reward: 566.7706, Test: 758.2691 [114.63], Avg: 563.5797 (0.574)
Ep: 185, Reward: 668.5072, Test: 627.8804 [211.31], Avg: 562.7893 (0.572)
Ep: 186, Reward: 698.1833, Test: 654.3370 [181.44], Avg: 562.3086 (0.570)
Ep: 187, Reward: 717.3573, Test: 720.1638 [142.69], Avg: 562.3893 (0.568)
Ep: 188, Reward: 590.6424, Test: 669.1288 [187.60], Avg: 561.9614 (0.567)
Ep: 189, Reward: 693.6506, Test: 622.6924 [129.02], Avg: 561.6020 (0.565)
Ep: 190, Reward: 724.2191, Test: 765.1219 [140.57], Avg: 561.9316 (0.563)
Ep: 191, Reward: 660.9792, Test: 749.2149 [138.05], Avg: 562.1880 (0.562)
Ep: 192, Reward: 712.9383, Test: 698.3879 [154.86], Avg: 562.0914 (0.560)
Ep: 193, Reward: 730.2873, Test: 725.8400 [202.23], Avg: 561.8930 (0.558)
Ep: 194, Reward: 663.8924, Test: 621.3040 [211.85], Avg: 561.1113 (0.557)
Ep: 195, Reward: 570.7959, Test: 650.9259 [167.09], Avg: 560.7170 (0.555)
Ep: 196, Reward: 607.7875, Test: 708.7348 [92.63], Avg: 560.9982 (0.553)
Ep: 197, Reward: 618.1734, Test: 783.4665 [68.73], Avg: 561.7746 (0.552)
Ep: 198, Reward: 675.7459, Test: 645.8182 [165.19], Avg: 561.3668 (0.550)
Ep: 199, Reward: 709.7848, Test: 747.6437 [161.10], Avg: 561.4927 (0.548)
Ep: 200, Reward: 744.9533, Test: 731.5788 [157.70], Avg: 561.5543 (0.547)
Ep: 201, Reward: 638.7428, Test: 791.0938 [57.57], Avg: 562.4057 (0.545)
Ep: 202, Reward: 704.2861, Test: 719.5947 [129.89], Avg: 562.5402 (0.543)
Ep: 203, Reward: 671.3256, Test: 726.4034 [168.46], Avg: 562.5176 (0.542)
Ep: 204, Reward: 725.1940, Test: 831.8383 [40.39], Avg: 563.6344 (0.540)
Ep: 205, Reward: 755.1736, Test: 701.3512 [196.11], Avg: 563.3509 (0.539)
Ep: 206, Reward: 809.7516, Test: 725.1251 [135.35], Avg: 563.4785 (0.537)
Ep: 207, Reward: 798.2867, Test: 781.3289 [100.66], Avg: 564.0419 (0.535)
Ep: 208, Reward: 758.7918, Test: 597.6348 [219.43], Avg: 563.1528 (0.534)
Ep: 209, Reward: 755.1035, Test: 783.0247 [85.41], Avg: 563.7931 (0.532)
Ep: 210, Reward: 708.1538, Test: 583.2630 [194.25], Avg: 562.9647 (0.530)
Ep: 211, Reward: 721.1631, Test: 788.1583 [86.19], Avg: 563.6204 (0.529)
Ep: 212, Reward: 755.9783, Test: 638.1736 [196.54], Avg: 563.0477 (0.527)
Ep: 213, Reward: 694.7634, Test: 675.6882 [188.13], Avg: 562.6949 (0.526)
Ep: 214, Reward: 768.3500, Test: 785.3935 [85.90], Avg: 563.3312 (0.524)
Ep: 215, Reward: 688.9269, Test: 701.2376 [171.13], Avg: 563.1774 (0.523)
Ep: 216, Reward: 722.7844, Test: 762.5177 [123.61], Avg: 563.5264 (0.521)
Ep: 217, Reward: 798.0815, Test: 607.0332 [277.08], Avg: 562.4549 (0.519)
Ep: 218, Reward: 778.3063, Test: 659.8595 [213.32], Avg: 561.9256 (0.518)
Ep: 219, Reward: 692.5801, Test: 659.1716 [236.39], Avg: 561.2932 (0.516)
Ep: 220, Reward: 702.8159, Test: 697.7663 [205.36], Avg: 560.9815 (0.515)
Ep: 221, Reward: 769.6078, Test: 751.3335 [182.95], Avg: 561.0148 (0.513)
Ep: 222, Reward: 837.3423, Test: 751.4477 [173.58], Avg: 561.0904 (0.512)
Ep: 223, Reward: 825.0884, Test: 527.1819 [220.26], Avg: 559.9557 (0.510)
Ep: 224, Reward: 763.4454, Test: 769.9327 [157.02], Avg: 560.1911 (0.509)
Ep: 225, Reward: 777.5251, Test: 765.6715 [179.44], Avg: 560.3063 (0.507)
Ep: 226, Reward: 738.6132, Test: 780.1319 [119.98], Avg: 560.7462 (0.506)
Ep: 227, Reward: 701.8516, Test: 604.6906 [220.25], Avg: 559.9729 (0.504)
Ep: 228, Reward: 710.5295, Test: 650.3286 [249.05], Avg: 559.2800 (0.503)
Ep: 229, Reward: 835.6458, Test: 773.9310 [113.67], Avg: 559.7190 (0.501)
Ep: 230, Reward: 813.8708, Test: 779.9899 [87.04], Avg: 560.2957 (0.500)
Ep: 231, Reward: 729.4613, Test: 736.5240 [190.97], Avg: 560.2322 (0.498)
Ep: 232, Reward: 811.8054, Test: 733.8979 [197.68], Avg: 560.1291 (0.497)
Ep: 233, Reward: 776.9061, Test: 751.1020 [150.87], Avg: 560.3005 (0.495)
Ep: 234, Reward: 748.3678, Test: 783.9988 [171.25], Avg: 560.5237 (0.494)
Ep: 235, Reward: 829.1690, Test: 847.0772 [30.38], Avg: 561.6092 (0.492)
Ep: 236, Reward: 750.5000, Test: 790.4757 [147.71], Avg: 561.9516 (0.491)
Ep: 237, Reward: 818.0127, Test: 824.4067 [80.85], Avg: 562.7147 (0.489)
Ep: 238, Reward: 809.5050, Test: 831.0394 [79.70], Avg: 563.5039 (0.488)
Ep: 239, Reward: 775.9112, Test: 847.5401 [43.66], Avg: 564.5055 (0.486)
Ep: 240, Reward: 846.9100, Test: 696.9899 [195.42], Avg: 564.2444 (0.485)
Ep: 241, Reward: 810.9938, Test: 858.1357 [34.95], Avg: 565.3143 (0.483)
Ep: 242, Reward: 867.9179, Test: 833.4209 [89.12], Avg: 566.0509 (0.482)
Ep: 243, Reward: 802.1439, Test: 856.2413 [27.94], Avg: 567.1257 (0.480)
Ep: 244, Reward: 824.8900, Test: 814.0756 [126.03], Avg: 567.6193 (0.479)
Ep: 245, Reward: 895.0360, Test: 815.8097 [109.34], Avg: 568.1837 (0.478)
Ep: 246, Reward: 899.9999, Test: 831.7391 [109.65], Avg: 568.8068 (0.476)
Ep: 247, Reward: 845.6824, Test: 849.1583 [56.93], Avg: 569.7077 (0.475)
Ep: 248, Reward: 897.3320, Test: 843.2908 [110.50], Avg: 570.3626 (0.473)
Ep: 249, Reward: 790.5619, Test: 857.6086 [71.46], Avg: 571.2258 (0.472)
Ep: 250, Reward: 930.2091, Test: 804.4350 [135.81], Avg: 571.6138 (0.470)
Ep: 251, Reward: 869.8563, Test: 889.8501 [25.85], Avg: 572.7741 (0.469)
Ep: 252, Reward: 803.5928, Test: 880.8375 [32.20], Avg: 573.8644 (0.468)
Ep: 253, Reward: 904.5150, Test: 843.5653 [107.23], Avg: 574.5041 (0.466)
Ep: 254, Reward: 786.3023, Test: 783.3601 [160.78], Avg: 574.6926 (0.465)
Ep: 255, Reward: 871.2774, Test: 818.6598 [104.28], Avg: 575.2383 (0.463)
Ep: 256, Reward: 861.8470, Test: 845.8965 [38.03], Avg: 576.1434 (0.462)
Ep: 257, Reward: 887.4759, Test: 819.6078 [184.46], Avg: 576.3721 (0.461)
Ep: 258, Reward: 846.3895, Test: 779.4593 [189.10], Avg: 576.4261 (0.459)
Ep: 259, Reward: 865.5428, Test: 836.3194 [94.18], Avg: 577.0635 (0.458)
Ep: 260, Reward: 857.1302, Test: 864.2964 [65.86], Avg: 577.9117 (0.456)
Ep: 261, Reward: 877.6331, Test: 820.3941 [115.12], Avg: 578.3978 (0.455)
Ep: 262, Reward: 844.2779, Test: 845.2864 [74.64], Avg: 579.1288 (0.454)
Ep: 263, Reward: 856.9985, Test: 804.9612 [148.78], Avg: 579.4207 (0.452)
Ep: 264, Reward: 860.4626, Test: 878.6490 [41.42], Avg: 580.3935 (0.451)
Ep: 265, Reward: 870.9481, Test: 801.7467 [134.18], Avg: 580.7212 (0.450)
Ep: 266, Reward: 852.7876, Test: 859.0816 [60.05], Avg: 581.5389 (0.448)
Ep: 267, Reward: 828.2819, Test: 821.3534 [119.33], Avg: 581.9885 (0.447)
Ep: 268, Reward: 744.0509, Test: 854.3001 [81.40], Avg: 582.6982 (0.446)
Ep: 269, Reward: 883.3764, Test: 854.3982 [54.81], Avg: 583.5014 (0.444)
Ep: 270, Reward: 822.5308, Test: 832.3900 [103.21], Avg: 584.0390 (0.443)
Ep: 271, Reward: 873.1007, Test: 786.6628 [96.87], Avg: 584.4278 (0.442)
Ep: 272, Reward: 838.0216, Test: 752.0037 [148.79], Avg: 584.4966 (0.440)
Ep: 273, Reward: 781.4065, Test: 838.6772 [109.05], Avg: 585.0263 (0.439)
Ep: 274, Reward: 789.6691, Test: 832.0076 [58.00], Avg: 585.7136 (0.438)
Ep: 275, Reward: 793.6323, Test: 837.0579 [130.41], Avg: 586.1517 (0.436)
Ep: 276, Reward: 835.5534, Test: 851.6389 [50.54], Avg: 586.9277 (0.435)
Ep: 277, Reward: 823.7414, Test: 852.6641 [42.63], Avg: 587.7302 (0.434)
Ep: 278, Reward: 828.3838, Test: 833.3329 [72.01], Avg: 588.3524 (0.432)
Ep: 279, Reward: 853.4021, Test: 805.8108 [124.59], Avg: 588.6841 (0.431)
Ep: 280, Reward: 826.9778, Test: 832.1313 [108.43], Avg: 589.1646 (0.430)
Ep: 281, Reward: 768.6636, Test: 752.1003 [213.93], Avg: 588.9838 (0.429)
Ep: 282, Reward: 856.3664, Test: 799.9500 [176.31], Avg: 589.1062 (0.427)
Ep: 283, Reward: 816.2301, Test: 823.1048 [101.28], Avg: 589.5735 (0.426)
Ep: 284, Reward: 757.6793, Test: 844.6083 [71.45], Avg: 590.2177 (0.425)
Ep: 285, Reward: 842.0144, Test: 839.1341 [59.04], Avg: 590.8816 (0.423)
Ep: 286, Reward: 778.5607, Test: 779.7862 [129.93], Avg: 591.0871 (0.422)
Ep: 287, Reward: 894.8006, Test: 842.6214 [71.19], Avg: 591.7133 (0.421)
Ep: 288, Reward: 825.4664, Test: 834.3863 [86.06], Avg: 592.2552 (0.420)
Ep: 289, Reward: 849.5886, Test: 796.9053 [171.20], Avg: 592.3705 (0.418)
Ep: 290, Reward: 934.1145, Test: 794.1250 [168.40], Avg: 592.4852 (0.417)
Ep: 291, Reward: 865.1606, Test: 836.8262 [114.26], Avg: 592.9307 (0.416)
Ep: 292, Reward: 841.1773, Test: 726.4948 [198.33], Avg: 592.7096 (0.415)
Ep: 293, Reward: 840.6412, Test: 811.6218 [104.42], Avg: 593.0990 (0.413)
Ep: 294, Reward: 873.1375, Test: 818.7962 [153.84], Avg: 593.3426 (0.412)
Ep: 295, Reward: 813.2618, Test: 852.6153 [71.81], Avg: 593.9759 (0.411)
Ep: 296, Reward: 841.8776, Test: 786.0320 [181.55], Avg: 594.0113 (0.410)
Ep: 297, Reward: 809.4137, Test: 865.0502 [29.90], Avg: 594.8205 (0.408)
Ep: 298, Reward: 786.1588, Test: 815.4008 [164.28], Avg: 595.0088 (0.407)
Ep: 299, Reward: 888.3886, Test: 846.9665 [79.93], Avg: 595.5823 (0.406)
Ep: 300, Reward: 835.2006, Test: 785.5410 [185.78], Avg: 595.5961 (0.405)
Ep: 301, Reward: 874.6994, Test: 850.9349 [80.56], Avg: 596.1749 (0.404)
Ep: 302, Reward: 905.5344, Test: 772.1098 [109.05], Avg: 596.3956 (0.402)
Ep: 303, Reward: 812.9700, Test: 783.3892 [171.62], Avg: 596.4462 (0.401)
Ep: 304, Reward: 875.1777, Test: 861.9315 [63.06], Avg: 597.1099 (0.400)
Ep: 305, Reward: 871.1765, Test: 841.3287 [117.06], Avg: 597.5254 (0.399)
Ep: 306, Reward: 815.0712, Test: 851.6043 [89.00], Avg: 598.0631 (0.398)
Ep: 307, Reward: 807.5753, Test: 825.8422 [81.82], Avg: 598.5370 (0.396)
Ep: 308, Reward: 792.4547, Test: 678.4894 [186.36], Avg: 598.1927 (0.395)
Ep: 309, Reward: 831.1874, Test: 790.1097 [131.04], Avg: 598.3890 (0.394)
Ep: 310, Reward: 739.1517, Test: 806.6288 [102.54], Avg: 598.7289 (0.393)
Ep: 311, Reward: 848.3970, Test: 787.3978 [177.24], Avg: 598.7655 (0.392)
Ep: 312, Reward: 872.0797, Test: 778.9996 [109.93], Avg: 598.9902 (0.390)
Ep: 313, Reward: 881.7994, Test: 803.8953 [87.79], Avg: 599.3631 (0.389)
Ep: 314, Reward: 831.2710, Test: 746.4319 [209.75], Avg: 599.1641 (0.388)
Ep: 315, Reward: 759.1414, Test: 835.7313 [67.54], Avg: 599.6990 (0.387)
Ep: 316, Reward: 834.1015, Test: 744.1720 [191.44], Avg: 599.5509 (0.386)
Ep: 317, Reward: 767.5877, Test: 795.9931 [131.52], Avg: 599.7550 (0.385)
Ep: 318, Reward: 835.4111, Test: 624.2061 [212.29], Avg: 599.1662 (0.383)
Ep: 319, Reward: 787.6419, Test: 770.3086 [143.86], Avg: 599.2514 (0.382)
Ep: 320, Reward: 740.8938, Test: 776.3244 [118.31], Avg: 599.4345 (0.381)
Ep: 321, Reward: 786.7103, Test: 852.7982 [19.79], Avg: 600.1599 (0.380)
Ep: 322, Reward: 796.6623, Test: 756.3202 [162.90], Avg: 600.1390 (0.379)
Ep: 323, Reward: 717.4358, Test: 847.3807 [24.38], Avg: 600.8269 (0.378)
Ep: 324, Reward: 860.1512, Test: 829.4262 [64.32], Avg: 601.3324 (0.377)
Ep: 325, Reward: 789.6030, Test: 648.7626 [220.07], Avg: 600.8028 (0.376)
Ep: 326, Reward: 712.7471, Test: 737.1260 [171.65], Avg: 600.6947 (0.374)
Ep: 327, Reward: 789.8239, Test: 806.7282 [128.46], Avg: 600.9312 (0.373)
Ep: 328, Reward: 771.7245, Test: 845.4841 [63.97], Avg: 601.4801 (0.372)
Ep: 329, Reward: 686.7718, Test: 752.9450 [152.51], Avg: 601.4769 (0.371)
Ep: 330, Reward: 752.3319, Test: 745.9608 [125.11], Avg: 601.5355 (0.370)
Ep: 331, Reward: 762.5139, Test: 849.6932 [89.64], Avg: 602.0129 (0.369)
Ep: 332, Reward: 898.8596, Test: 743.9343 [151.55], Avg: 601.9840 (0.368)
Ep: 333, Reward: 742.6724, Test: 803.7694 [105.24], Avg: 602.2731 (0.367)
Ep: 334, Reward: 785.0274, Test: 773.5314 [121.42], Avg: 602.4219 (0.365)
Ep: 335, Reward: 861.8278, Test: 782.5320 [161.97], Avg: 602.4759 (0.364)
Ep: 336, Reward: 834.1528, Test: 767.6682 [158.23], Avg: 602.4965 (0.363)
Ep: 337, Reward: 867.8729, Test: 811.0225 [114.69], Avg: 602.7741 (0.362)
Ep: 338, Reward: 790.5361, Test: 869.6508 [62.18], Avg: 603.3780 (0.361)
Ep: 339, Reward: 734.5907, Test: 777.8282 [139.47], Avg: 603.4809 (0.360)
Ep: 340, Reward: 881.0975, Test: 852.0227 [56.29], Avg: 604.0446 (0.359)
Ep: 341, Reward: 949.7162, Test: 834.7136 [142.55], Avg: 604.3023 (0.358)
Ep: 342, Reward: 840.5318, Test: 827.1342 [149.77], Avg: 604.5153 (0.357)
Ep: 343, Reward: 888.9708, Test: 864.0034 [52.77], Avg: 605.1162 (0.356)
Ep: 344, Reward: 854.5249, Test: 778.5911 [143.05], Avg: 605.2044 (0.355)
Ep: 345, Reward: 847.2849, Test: 818.2850 [91.08], Avg: 605.5570 (0.354)
Ep: 346, Reward: 801.1167, Test: 839.7674 [63.41], Avg: 606.0493 (0.353)
Ep: 347, Reward: 810.0777, Test: 852.0584 [63.78], Avg: 606.5729 (0.351)
Ep: 348, Reward: 837.6138, Test: 820.2057 [65.38], Avg: 606.9977 (0.350)
Ep: 349, Reward: 931.6043, Test: 805.5524 [93.75], Avg: 607.2971 (0.349)
Ep: 350, Reward: 841.6942, Test: 727.1621 [187.12], Avg: 607.1055 (0.348)
Ep: 351, Reward: 876.7442, Test: 727.8391 [182.23], Avg: 606.9308 (0.347)
Ep: 352, Reward: 764.7756, Test: 869.0355 [36.26], Avg: 607.5706 (0.346)
Ep: 353, Reward: 833.7072, Test: 741.3095 [223.68], Avg: 607.3165 (0.345)
Ep: 354, Reward: 856.3468, Test: 737.0954 [189.16], Avg: 607.1493 (0.344)
Ep: 355, Reward: 799.7569, Test: 793.2072 [158.87], Avg: 607.2256 (0.343)
Ep: 356, Reward: 723.1839, Test: 840.1553 [60.17], Avg: 607.7096 (0.342)
Ep: 357, Reward: 731.4587, Test: 817.9675 [104.17], Avg: 608.0059 (0.341)
Ep: 358, Reward: 824.1717, Test: 813.2583 [97.63], Avg: 608.3057 (0.340)
Ep: 359, Reward: 823.9556, Test: 819.8777 [132.86], Avg: 608.5243 (0.339)
Ep: 360, Reward: 847.4658, Test: 830.8722 [160.46], Avg: 608.6958 (0.338)
Ep: 361, Reward: 754.1014, Test: 740.3895 [164.79], Avg: 608.6043 (0.337)
Ep: 362, Reward: 836.6632, Test: 786.6192 [151.35], Avg: 608.6778 (0.336)
Ep: 363, Reward: 806.4037, Test: 814.9799 [48.60], Avg: 609.1111 (0.335)
Ep: 364, Reward: 771.2807, Test: 811.6930 [122.67], Avg: 609.3300 (0.334)
Ep: 365, Reward: 810.7371, Test: 738.0239 [174.70], Avg: 609.2043 (0.333)
Ep: 366, Reward: 730.3176, Test: 722.5451 [119.03], Avg: 609.1888 (0.332)
Ep: 367, Reward: 694.6084, Test: 761.1102 [200.33], Avg: 609.0573 (0.331)
Ep: 368, Reward: 775.1818, Test: 708.3830 [185.59], Avg: 608.8235 (0.330)
Ep: 369, Reward: 718.8494, Test: 755.2676 [190.76], Avg: 608.7037 (0.329)
Ep: 370, Reward: 661.7787, Test: 768.9721 [87.11], Avg: 608.9009 (0.328)
Ep: 371, Reward: 710.4716, Test: 725.0586 [214.32], Avg: 608.6370 (0.327)
Ep: 372, Reward: 713.1857, Test: 765.6695 [99.62], Avg: 608.7909 (0.326)
Ep: 373, Reward: 592.9500, Test: 719.7386 [157.65], Avg: 608.6661 (0.325)
Ep: 374, Reward: 782.9775, Test: 699.4092 [185.63], Avg: 608.4130 (0.324)
Ep: 375, Reward: 734.8939, Test: 768.9376 [125.50], Avg: 608.5062 (0.323)
Ep: 376, Reward: 749.1519, Test: 777.6809 [142.47], Avg: 608.5770 (0.322)
Ep: 377, Reward: 757.6343, Test: 778.0611 [139.18], Avg: 608.6572 (0.321)
Ep: 378, Reward: 733.5517, Test: 778.3750 [123.57], Avg: 608.7789 (0.320)
Ep: 379, Reward: 703.8726, Test: 698.7392 [184.13], Avg: 608.5311 (0.319)
Ep: 380, Reward: 729.3271, Test: 781.5868 [110.19], Avg: 608.6961 (0.318)
Ep: 381, Reward: 782.6469, Test: 671.3009 [197.78], Avg: 608.3423 (0.317)
Ep: 382, Reward: 693.9606, Test: 630.8290 [236.55], Avg: 607.7834 (0.316)
Ep: 383, Reward: 740.1284, Test: 810.5643 [83.18], Avg: 608.0948 (0.315)
Ep: 384, Reward: 789.2718, Test: 665.8347 [164.05], Avg: 607.8187 (0.315)
Ep: 385, Reward: 812.7984, Test: 700.3691 [150.62], Avg: 607.6682 (0.314)
Ep: 386, Reward: 796.0294, Test: 779.0177 [73.79], Avg: 607.9203 (0.313)
Ep: 387, Reward: 801.1204, Test: 831.3049 [77.86], Avg: 608.2954 (0.312)
Ep: 388, Reward: 784.8891, Test: 720.2776 [188.39], Avg: 608.0990 (0.311)
Ep: 389, Reward: 674.4581, Test: 790.7885 [158.75], Avg: 608.1604 (0.310)
Ep: 390, Reward: 781.8304, Test: 709.3522 [225.99], Avg: 607.8412 (0.309)
Ep: 391, Reward: 770.9315, Test: 713.5252 [195.66], Avg: 607.6116 (0.308)
Ep: 392, Reward: 710.2134, Test: 703.0179 [186.46], Avg: 607.3799 (0.307)
Ep: 393, Reward: 753.8710, Test: 793.3742 [165.94], Avg: 607.4308 (0.306)
Ep: 394, Reward: 729.6684, Test: 798.1323 [164.19], Avg: 607.4980 (0.305)
Ep: 395, Reward: 784.4558, Test: 857.4729 [24.80], Avg: 608.0666 (0.304)
Ep: 396, Reward: 605.2218, Test: 790.0678 [133.52], Avg: 608.1887 (0.303)
Ep: 397, Reward: 708.9398, Test: 843.6095 [77.51], Avg: 608.5855 (0.302)
Ep: 398, Reward: 678.3356, Test: 701.8021 [213.06], Avg: 608.2851 (0.302)
Ep: 399, Reward: 858.3885, Test: 758.8176 [131.89], Avg: 608.3317 (0.301)
Ep: 400, Reward: 770.6142, Test: 712.2961 [212.20], Avg: 608.0618 (0.300)
Ep: 401, Reward: 748.1570, Test: 624.8835 [217.36], Avg: 607.5629 (0.299)
Ep: 402, Reward: 871.1402, Test: 782.4303 [138.93], Avg: 607.6521 (0.298)
Ep: 403, Reward: 742.4698, Test: 627.0817 [235.42], Avg: 607.1175 (0.297)
Ep: 404, Reward: 797.1694, Test: 878.2093 [27.61], Avg: 607.7187 (0.296)
Ep: 405, Reward: 758.7525, Test: 567.0494 [193.50], Avg: 607.1419 (0.295)
Ep: 406, Reward: 676.3433, Test: 730.7378 [197.62], Avg: 606.9600 (0.294)
Ep: 407, Reward: 751.2187, Test: 764.1063 [204.82], Avg: 606.8432 (0.294)
Ep: 408, Reward: 825.4656, Test: 707.3037 [210.69], Avg: 606.5737 (0.293)
Ep: 409, Reward: 774.9039, Test: 838.6452 [74.52], Avg: 606.9579 (0.292)
Ep: 410, Reward: 710.7740, Test: 789.5711 [149.23], Avg: 607.0392 (0.291)
Ep: 411, Reward: 811.2384, Test: 670.0467 [218.53], Avg: 606.6617 (0.290)
Ep: 412, Reward: 753.3466, Test: 778.8194 [172.93], Avg: 606.6598 (0.289)
Ep: 413, Reward: 731.1926, Test: 785.4776 [169.04], Avg: 606.6834 (0.288)
Ep: 414, Reward: 822.8558, Test: 858.0165 [71.26], Avg: 607.1173 (0.287)
Ep: 415, Reward: 763.9070, Test: 631.4136 [251.74], Avg: 606.5706 (0.287)
Ep: 416, Reward: 808.3223, Test: 726.2009 [220.32], Avg: 606.3292 (0.286)
Ep: 417, Reward: 697.5386, Test: 873.0020 [35.50], Avg: 606.8822 (0.285)
Ep: 418, Reward: 637.0697, Test: 844.5203 [66.73], Avg: 607.2901 (0.284)
Ep: 419, Reward: 741.9218, Test: 818.9137 [77.41], Avg: 607.6096 (0.283)
Ep: 420, Reward: 847.7253, Test: 703.0827 [208.93], Avg: 607.3402 (0.282)
Ep: 421, Reward: 826.8319, Test: 752.9045 [181.76], Avg: 607.2544 (0.281)
Ep: 422, Reward: 613.4140, Test: 755.4577 [163.06], Avg: 607.2193 (0.281)
Ep: 423, Reward: 721.3887, Test: 765.7502 [191.12], Avg: 607.1424 (0.280)
Ep: 424, Reward: 733.4727, Test: 757.0327 [111.47], Avg: 607.2328 (0.279)
Ep: 425, Reward: 802.6754, Test: 782.7363 [140.59], Avg: 607.3148 (0.278)
Ep: 426, Reward: 811.4427, Test: 641.5404 [223.35], Avg: 606.8718 (0.277)
Ep: 427, Reward: 889.9959, Test: 813.6233 [115.32], Avg: 607.0855 (0.276)
Ep: 428, Reward: 929.4078, Test: 763.0335 [191.68], Avg: 607.0022 (0.276)
Ep: 429, Reward: 796.0300, Test: 773.9867 [169.84], Avg: 606.9955 (0.275)
Ep: 430, Reward: 671.3536, Test: 747.3972 [201.40], Avg: 606.8540 (0.274)
Ep: 431, Reward: 744.7620, Test: 699.9480 [268.85], Avg: 606.4472 (0.273)
Ep: 432, Reward: 677.6209, Test: 798.6480 [164.43], Avg: 606.5113 (0.272)
Ep: 433, Reward: 741.8422, Test: 741.3174 [230.75], Avg: 606.2902 (0.271)
Ep: 434, Reward: 772.9540, Test: 809.8615 [160.66], Avg: 606.3889 (0.271)
Ep: 435, Reward: 802.4053, Test: 708.9345 [250.24], Avg: 606.0501 (0.270)
Ep: 436, Reward: 757.6348, Test: 795.7680 [159.56], Avg: 606.1191 (0.269)
Ep: 437, Reward: 874.5225, Test: 766.9029 [184.06], Avg: 606.0660 (0.268)
Ep: 438, Reward: 783.8568, Test: 804.9875 [96.39], Avg: 606.2995 (0.267)
Ep: 439, Reward: 900.9171, Test: 836.5146 [32.83], Avg: 606.7481 (0.267)
Ep: 440, Reward: 753.8699, Test: 763.5871 [173.74], Avg: 606.7098 (0.266)
Ep: 441, Reward: 801.1484, Test: 673.6003 [211.17], Avg: 606.3834 (0.265)
Ep: 442, Reward: 833.0008, Test: 811.1491 [85.98], Avg: 606.6515 (0.264)
Ep: 443, Reward: 812.3515, Test: 686.4590 [245.98], Avg: 606.2773 (0.263)
Ep: 444, Reward: 824.2981, Test: 753.6465 [215.97], Avg: 606.1231 (0.263)
Ep: 445, Reward: 791.7084, Test: 766.9084 [138.02], Avg: 606.1742 (0.262)
Ep: 446, Reward: 780.2365, Test: 787.0946 [173.70], Avg: 606.1903 (0.261)
Ep: 447, Reward: 794.9368, Test: 747.5045 [211.87], Avg: 606.0328 (0.260)
Ep: 448, Reward: 769.1177, Test: 846.6673 [50.81], Avg: 606.4556 (0.259)
Ep: 449, Reward: 785.6906, Test: 751.9235 [220.20], Avg: 606.2895 (0.259)
Ep: 450, Reward: 854.0272, Test: 804.5509 [157.67], Avg: 606.3795 (0.258)
Ep: 451, Reward: 772.5626, Test: 831.7235 [103.26], Avg: 606.6496 (0.257)
Ep: 452, Reward: 812.8736, Test: 743.8233 [152.56], Avg: 606.6157 (0.256)
Ep: 453, Reward: 915.8420, Test: 727.0683 [229.31], Avg: 606.3759 (0.256)
Ep: 454, Reward: 762.3429, Test: 728.7140 [212.66], Avg: 606.1774 (0.255)
Ep: 455, Reward: 891.6963, Test: 724.7595 [166.39], Avg: 606.0725 (0.254)
Ep: 456, Reward: 765.9435, Test: 789.2886 [129.07], Avg: 606.1910 (0.253)
Ep: 457, Reward: 751.4823, Test: 680.2667 [240.83], Avg: 605.8269 (0.253)
Ep: 458, Reward: 782.3987, Test: 763.6653 [190.36], Avg: 605.7560 (0.252)
Ep: 459, Reward: 877.6332, Test: 786.5278 [131.13], Avg: 605.8640 (0.251)
Ep: 460, Reward: 886.0315, Test: 849.1182 [53.44], Avg: 606.2757 (0.250)
Ep: 461, Reward: 739.3347, Test: 756.1999 [184.77], Avg: 606.2003 (0.250)
Ep: 462, Reward: 692.1246, Test: 850.8503 [47.50], Avg: 606.6261 (0.249)
Ep: 463, Reward: 804.8654, Test: 762.6802 [161.10], Avg: 606.6152 (0.248)
Ep: 464, Reward: 805.4577, Test: 801.4820 [179.37], Avg: 606.6485 (0.247)
Ep: 465, Reward: 815.9241, Test: 807.6003 [102.45], Avg: 606.8599 (0.247)
Ep: 466, Reward: 847.8426, Test: 850.3881 [71.33], Avg: 607.2287 (0.246)
Ep: 467, Reward: 823.9030, Test: 852.0003 [63.06], Avg: 607.6169 (0.245)
Ep: 468, Reward: 879.6203, Test: 740.7446 [201.83], Avg: 607.4705 (0.244)
Ep: 469, Reward: 849.3472, Test: 763.0666 [178.40], Avg: 607.4219 (0.244)
Ep: 470, Reward: 858.2823, Test: 821.5136 [139.72], Avg: 607.5798 (0.243)
Ep: 471, Reward: 860.9003, Test: 822.6923 [114.21], Avg: 607.7936 (0.242)
Ep: 472, Reward: 843.4992, Test: 811.6450 [137.76], Avg: 607.9333 (0.241)
Ep: 473, Reward: 751.9636, Test: 817.2545 [133.04], Avg: 608.0943 (0.241)
Ep: 474, Reward: 783.7221, Test: 711.9416 [243.18], Avg: 607.8009 (0.240)
Ep: 475, Reward: 824.9596, Test: 848.1808 [53.67], Avg: 608.1932 (0.239)
Ep: 476, Reward: 818.7105, Test: 802.5698 [145.35], Avg: 608.2960 (0.239)
Ep: 477, Reward: 813.5302, Test: 703.4149 [229.47], Avg: 608.0149 (0.238)
Ep: 478, Reward: 839.5465, Test: 700.5722 [206.11], Avg: 607.7778 (0.237)
Ep: 479, Reward: 722.9108, Test: 723.2789 [156.37], Avg: 607.6927 (0.236)
Ep: 480, Reward: 855.0766, Test: 776.7104 [156.49], Avg: 607.7187 (0.236)
Ep: 481, Reward: 732.0145, Test: 789.5700 [129.12], Avg: 607.8281 (0.235)
Ep: 482, Reward: 787.5134, Test: 791.5768 [172.44], Avg: 607.8515 (0.234)
Ep: 483, Reward: 823.5936, Test: 743.5313 [196.69], Avg: 607.7255 (0.234)
Ep: 484, Reward: 757.3360, Test: 731.9467 [165.66], Avg: 607.6400 (0.233)
Ep: 485, Reward: 832.1144, Test: 758.4033 [158.85], Avg: 607.6234 (0.232)
Ep: 486, Reward: 779.2132, Test: 750.9603 [164.78], Avg: 607.5793 (0.231)
Ep: 487, Reward: 826.4166, Test: 683.0233 [202.71], Avg: 607.3186 (0.231)
Ep: 488, Reward: 892.2573, Test: 868.1114 [13.48], Avg: 607.8243 (0.230)
Ep: 489, Reward: 785.6936, Test: 749.2840 [123.80], Avg: 607.8604 (0.229)
Ep: 490, Reward: 810.8289, Test: 719.9329 [206.64], Avg: 607.6678 (0.229)
Ep: 491, Reward: 664.3624, Test: 654.3495 [233.50], Avg: 607.2880 (0.228)
Ep: 492, Reward: 758.0176, Test: 790.5503 [131.28], Avg: 607.3935 (0.227)
Ep: 493, Reward: 804.5902, Test: 830.5201 [84.90], Avg: 607.6733 (0.227)
Ep: 494, Reward: 759.3839, Test: 716.8801 [213.66], Avg: 607.4623 (0.226)
Ep: 495, Reward: 872.9242, Test: 776.6814 [167.52], Avg: 607.4657 (0.225)
Ep: 496, Reward: 845.4560, Test: 691.2202 [270.33], Avg: 607.0903 (0.225)
Ep: 497, Reward: 836.5887, Test: 784.0565 [163.56], Avg: 607.1172 (0.224)
Ep: 498, Reward: 808.9524, Test: 784.2194 [135.00], Avg: 607.2016 (0.223)
Ep: 499, Reward: 746.9414, Test: 842.4695 [88.20], Avg: 607.4957 (0.223)
