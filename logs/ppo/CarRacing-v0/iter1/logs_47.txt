Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.1				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((len(self.replay_buffer)*PPO_EPOCHS)//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -28.6468, Test: -50.7219 [15.08], Avg: -65.8040 (0.997)
Ep: 1, Reward: -36.9101, Test: -75.8310 [11.08], Avg: -76.3583 (0.994)
Ep: 2, Reward: -66.1806, Test: -62.8554 [15.39], Avg: -76.9878 (0.991)
Ep: 3, Reward: -54.2759, Test: -79.6024 [34.72], Avg: -86.3225 (0.988)
Ep: 4, Reward: -67.2695, Test: -62.0681 [18.87], Avg: -85.2448 (0.985)
Ep: 5, Reward: -83.6241, Test: -70.1106 [8.31], Avg: -84.1075 (0.982)
Ep: 6, Reward: -56.3992, Test: -45.4903 [36.92], Avg: -83.8654 (0.979)
Ep: 7, Reward: -48.9883, Test: -80.9928 [1.61], Avg: -83.7075 (0.976)
Ep: 8, Reward: -85.2350, Test: -78.5949 [2.67], Avg: -83.4364 (0.973)
Ep: 9, Reward: -87.8320, Test: -68.4490 [17.67], Avg: -83.7051 (0.970)
Ep: 10, Reward: -60.1413, Test: -104.7768 [59.69], Avg: -91.0475 (0.967)
Ep: 11, Reward: -50.1303, Test: -49.1598 [16.62], Avg: -88.9419 (0.965)
Ep: 12, Reward: -57.5293, Test: -36.7035 [21.58], Avg: -86.5838 (0.962)
Ep: 13, Reward: -53.5551, Test: -36.8033 [21.21], Avg: -84.5434 (0.959)
Ep: 14, Reward: -29.8030, Test: -17.2166 [16.73], Avg: -81.1699 (0.956)
Ep: 15, Reward: -44.6935, Test: -37.0925 [23.45], Avg: -79.8806 (0.953)
Ep: 16, Reward: -8.9671, Test: 55.5608 [47.27], Avg: -74.6938 (0.950)
Ep: 17, Reward: 56.2488, Test: 80.3631 [122.84], Avg: -72.9038 (0.947)
Ep: 18, Reward: -4.5843, Test: 54.8410 [65.39], Avg: -69.6219 (0.945)
Ep: 19, Reward: 11.2872, Test: 18.4944 [57.67], Avg: -68.0994 (0.942)
Ep: 20, Reward: 35.9828, Test: 10.1096 [24.78], Avg: -65.5550 (0.939)
Ep: 21, Reward: 46.3742, Test: 70.9274 [96.67], Avg: -63.7455 (0.936)
Ep: 22, Reward: 140.3029, Test: 136.0662 [147.49], Avg: -61.4708 (0.933)
Ep: 23, Reward: 156.7227, Test: -17.5727 [31.70], Avg: -60.9625 (0.930)
Ep: 24, Reward: -18.3438, Test: -25.2880 [32.74], Avg: -60.8450 (0.928)
Ep: 25, Reward: 3.7236, Test: -4.3917 [29.96], Avg: -59.8260 (0.925)
Ep: 26, Reward: 16.3323, Test: 27.0605 [62.56], Avg: -58.9250 (0.922)
Ep: 27, Reward: 67.5624, Test: 24.3584 [41.86], Avg: -57.4455 (0.919)
Ep: 28, Reward: 109.6056, Test: 66.1829 [102.16], Avg: -56.7052 (0.917)
Ep: 29, Reward: 119.3941, Test: 294.1055 [239.28], Avg: -52.9873 (0.914)
Ep: 30, Reward: 379.0415, Test: 484.0036 [238.56], Avg: -43.3605 (0.911)
Ep: 31, Reward: 460.5779, Test: 366.6264 [208.98], Avg: -37.0791 (0.908)
Ep: 32, Reward: 660.3290, Test: 616.1287 [279.69], Avg: -25.7605 (0.906)
Ep: 33, Reward: 592.3731, Test: 647.4759 [129.87], Avg: -9.7791 (0.903)
Ep: 34, Reward: 598.3588, Test: 704.6930 [161.72], Avg: 6.0139 (0.900)
Ep: 35, Reward: 637.7255, Test: 599.1190 [177.37], Avg: 17.5621 (0.897)
Ep: 36, Reward: 643.2259, Test: 696.0997 [192.47], Avg: 30.6992 (0.895)
Ep: 37, Reward: 573.4996, Test: 622.6360 [282.08], Avg: 38.8532 (0.892)
Ep: 38, Reward: 613.7701, Test: 616.5803 [226.91], Avg: 47.8485 (0.889)
Ep: 39, Reward: 748.2415, Test: 593.1706 [297.65], Avg: 54.0404 (0.887)
Ep: 40, Reward: 522.5920, Test: 582.7344 [108.87], Avg: 64.2801 (0.884)
Ep: 41, Reward: 707.2564, Test: 679.4794 [203.76], Avg: 74.0763 (0.881)
Ep: 42, Reward: 361.6664, Test: 351.1879 [174.07], Avg: 76.4726 (0.879)
Ep: 43, Reward: 301.8631, Test: 210.2685 [132.61], Avg: 76.4996 (0.876)
Ep: 44, Reward: 350.2272, Test: 402.8600 [202.84], Avg: 79.2445 (0.874)
Ep: 45, Reward: 334.2011, Test: 440.6925 [117.07], Avg: 84.5571 (0.871)
Ep: 46, Reward: 455.7536, Test: 665.0914 [149.52], Avg: 93.7275 (0.868)
Ep: 47, Reward: 489.7653, Test: 691.6388 [149.02], Avg: 103.0794 (0.866)
Ep: 48, Reward: 724.0204, Test: 788.1945 [149.93], Avg: 114.0016 (0.863)
Ep: 49, Reward: 783.4532, Test: 735.2065 [206.57], Avg: 122.2943 (0.861)
Ep: 50, Reward: 747.9802, Test: 692.8666 [250.83], Avg: 128.5637 (0.858)
Ep: 51, Reward: 674.0542, Test: 710.8521 [152.38], Avg: 136.8311 (0.855)
Ep: 52, Reward: 539.5959, Test: 721.6292 [140.79], Avg: 145.2086 (0.853)
Ep: 53, Reward: 566.0093, Test: 576.8440 [172.41], Avg: 150.0090 (0.850)
Ep: 54, Reward: 689.3674, Test: 692.7339 [130.07], Avg: 157.5118 (0.848)
Ep: 55, Reward: 661.5738, Test: 621.4519 [213.03], Avg: 161.9922 (0.845)
Ep: 56, Reward: 729.8055, Test: 630.1718 [152.36], Avg: 167.5328 (0.843)
Ep: 57, Reward: 676.6307, Test: 681.1068 [191.49], Avg: 173.0861 (0.840)
Ep: 58, Reward: 561.6674, Test: 587.0641 [167.06], Avg: 177.2711 (0.838)
Ep: 59, Reward: 684.7868, Test: 625.8746 [228.40], Avg: 180.9412 (0.835)
Ep: 60, Reward: 627.3811, Test: 692.3717 [139.91], Avg: 187.0317 (0.833)
Ep: 61, Reward: 534.6573, Test: 523.3417 [146.44], Avg: 190.0940 (0.830)
Ep: 62, Reward: 550.1717, Test: 558.8402 [179.35], Avg: 193.1003 (0.828)
Ep: 63, Reward: 511.0470, Test: 512.8212 [138.16], Avg: 195.9372 (0.825)
Ep: 64, Reward: 540.6769, Test: 630.4346 [130.24], Avg: 200.6181 (0.823)
Ep: 65, Reward: 577.0470, Test: 714.2058 [78.98], Avg: 207.2031 (0.820)
Ep: 66, Reward: 614.6985, Test: 728.7663 [95.22], Avg: 213.5665 (0.818)
Ep: 67, Reward: 646.4288, Test: 668.9877 [100.64], Avg: 218.7839 (0.815)
Ep: 68, Reward: 477.6344, Test: 571.5764 [165.97], Avg: 221.4914 (0.813)
Ep: 69, Reward: 592.7407, Test: 586.9402 [123.72], Avg: 224.9447 (0.810)
Ep: 70, Reward: 577.7394, Test: 518.6285 [177.64], Avg: 226.5791 (0.808)
Ep: 71, Reward: 553.5462, Test: 628.8001 [219.73], Avg: 229.1137 (0.805)
Ep: 72, Reward: 590.8952, Test: 604.6811 [147.53], Avg: 232.2374 (0.803)
Ep: 73, Reward: 684.0595, Test: 675.2948 [113.93], Avg: 236.6851 (0.801)
Ep: 74, Reward: 582.6869, Test: 693.8546 [74.78], Avg: 241.7837 (0.798)
Ep: 75, Reward: 643.0286, Test: 552.0686 [114.04], Avg: 244.3658 (0.796)
Ep: 76, Reward: 548.7731, Test: 569.8057 [105.32], Avg: 247.2245 (0.793)
Ep: 77, Reward: 584.3781, Test: 568.4580 [85.11], Avg: 250.2517 (0.791)
Ep: 78, Reward: 580.2176, Test: 614.8911 [79.11], Avg: 253.8660 (0.789)
Ep: 79, Reward: 587.0323, Test: 593.7000 [31.43], Avg: 257.7211 (0.786)
Ep: 80, Reward: 498.8022, Test: 575.7184 [101.13], Avg: 260.3985 (0.784)
Ep: 81, Reward: 497.6834, Test: 566.0992 [181.96], Avg: 261.9075 (0.782)
Ep: 82, Reward: 527.1034, Test: 600.9208 [139.84], Avg: 264.3073 (0.779)
Ep: 83, Reward: 518.9588, Test: 585.3562 [125.00], Avg: 266.6412 (0.777)
Ep: 84, Reward: 589.3194, Test: 593.4254 [59.51], Avg: 269.7856 (0.775)
Ep: 85, Reward: 600.6721, Test: 577.8019 [116.02], Avg: 272.0181 (0.772)
Ep: 86, Reward: 427.9984, Test: 500.1220 [120.13], Avg: 273.2592 (0.770)
Ep: 87, Reward: 527.0218, Test: 585.9733 [83.57], Avg: 275.8631 (0.768)
Ep: 88, Reward: 600.9849, Test: 645.7451 [195.10], Avg: 277.8270 (0.765)
Ep: 89, Reward: 657.4818, Test: 614.2791 [141.96], Avg: 279.9880 (0.763)
Ep: 90, Reward: 687.3996, Test: 701.4034 [103.49], Avg: 283.4816 (0.761)
Ep: 91, Reward: 695.1523, Test: 651.8571 [77.12], Avg: 286.6475 (0.758)
Ep: 92, Reward: 616.5486, Test: 736.2771 [127.50], Avg: 290.1113 (0.756)
Ep: 93, Reward: 665.7358, Test: 675.0970 [90.36], Avg: 293.2456 (0.754)
Ep: 94, Reward: 528.6607, Test: 492.8788 [89.41], Avg: 294.4059 (0.752)
Ep: 95, Reward: 229.8940, Test: 233.1958 [80.99], Avg: 292.9246 (0.749)
Ep: 96, Reward: 257.6762, Test: 176.0332 [71.71], Avg: 290.9803 (0.747)
Ep: 97, Reward: 158.2330, Test: 106.1051 [57.38], Avg: 288.5083 (0.745)
Ep: 98, Reward: 179.4541, Test: 141.6057 [107.11], Avg: 285.9425 (0.743)
Ep: 99, Reward: 238.7518, Test: 257.2416 [65.40], Avg: 285.0015 (0.740)
Ep: 100, Reward: 241.1321, Test: 137.5880 [57.71], Avg: 282.9706 (0.738)
Ep: 101, Reward: 109.0132, Test: 146.3563 [65.83], Avg: 280.9858 (0.736)
Ep: 102, Reward: 64.0611, Test: 64.7812 [85.03], Avg: 278.0612 (0.734)
Ep: 103, Reward: 27.7632, Test: -40.9463 [50.89], Avg: 274.5045 (0.732)
Ep: 104, Reward: 59.8788, Test: 31.4836 [74.51], Avg: 271.4804 (0.729)
Ep: 105, Reward: 41.7261, Test: -16.1677 [50.63], Avg: 268.2891 (0.727)
Ep: 106, Reward: -42.0305, Test: -67.3022 [19.38], Avg: 264.9717 (0.725)
Ep: 107, Reward: -58.9380, Test: -45.1882 [36.36], Avg: 261.7631 (0.723)
Ep: 108, Reward: -42.4000, Test: -62.2474 [28.72], Avg: 258.5270 (0.721)
Ep: 109, Reward: -37.4685, Test: -48.2065 [31.04], Avg: 255.4564 (0.719)
Ep: 110, Reward: -29.6645, Test: -42.4386 [32.76], Avg: 252.4775 (0.716)
Ep: 111, Reward: -48.6148, Test: -58.6469 [24.65], Avg: 249.4795 (0.714)
Ep: 112, Reward: -59.1971, Test: -49.1549 [41.13], Avg: 246.4728 (0.712)
Ep: 113, Reward: -34.7568, Test: -29.8295 [56.13], Avg: 243.5567 (0.710)
Ep: 114, Reward: -23.1958, Test: -29.8240 [50.56], Avg: 240.7398 (0.708)
Ep: 115, Reward: -2.3872, Test: -48.0044 [43.77], Avg: 237.8733 (0.706)
Ep: 116, Reward: -38.3104, Test: 28.5011 [54.02], Avg: 235.6222 (0.704)
Ep: 117, Reward: -9.5033, Test: -8.7989 [59.94], Avg: 233.0428 (0.702)
Ep: 118, Reward: 29.0818, Test: -9.9517 [66.71], Avg: 230.4403 (0.699)
Ep: 119, Reward: -20.2195, Test: -15.7370 [55.84], Avg: 227.9235 (0.697)
Ep: 120, Reward: 5.1640, Test: -30.3824 [66.40], Avg: 225.2399 (0.695)
Ep: 121, Reward: -18.3122, Test: 35.5095 [29.70], Avg: 223.4413 (0.693)
Ep: 122, Reward: 35.7976, Test: 41.1343 [19.77], Avg: 221.7984 (0.691)
Ep: 123, Reward: 48.1056, Test: 28.2138 [32.45], Avg: 219.9756 (0.689)
Ep: 124, Reward: 62.9219, Test: 38.3642 [34.73], Avg: 218.2448 (0.687)
Ep: 125, Reward: 51.6481, Test: 41.8507 [23.89], Avg: 216.6552 (0.685)
Ep: 126, Reward: 53.4899, Test: 58.6943 [39.37], Avg: 215.1014 (0.683)
Ep: 127, Reward: 40.8544, Test: 54.2408 [59.94], Avg: 213.3764 (0.681)
Ep: 128, Reward: 7.6519, Test: -38.3970 [32.22], Avg: 211.1749 (0.679)
Ep: 129, Reward: -36.8377, Test: -7.9736 [47.66], Avg: 209.1226 (0.677)
Ep: 130, Reward: -24.9186, Test: -9.2291 [33.47], Avg: 207.2003 (0.675)
Ep: 131, Reward: 4.1510, Test: -39.2348 [35.42], Avg: 205.0650 (0.673)
Ep: 132, Reward: -14.9385, Test: -3.9155 [29.42], Avg: 203.2725 (0.671)
Ep: 133, Reward: 8.3252, Test: 23.6791 [37.78], Avg: 201.6504 (0.669)
Ep: 134, Reward: 37.3554, Test: 30.1983 [46.91], Avg: 200.0329 (0.667)
Ep: 135, Reward: 23.9428, Test: 40.1696 [107.95], Avg: 198.0637 (0.665)
Ep: 136, Reward: 87.2307, Test: 56.4252 [46.19], Avg: 196.6927 (0.663)
Ep: 137, Reward: 79.9100, Test: 88.0771 [46.89], Avg: 195.5658 (0.661)
Ep: 138, Reward: 72.0706, Test: 128.7632 [98.32], Avg: 194.3779 (0.659)
Ep: 139, Reward: 122.6752, Test: 120.8734 [86.45], Avg: 193.2353 (0.657)
Ep: 140, Reward: 106.9031, Test: 175.2159 [156.39], Avg: 191.9984 (0.655)
Ep: 141, Reward: 147.3217, Test: 135.5256 [83.61], Avg: 191.0119 (0.653)
Ep: 142, Reward: 200.3176, Test: 189.5861 [107.34], Avg: 190.2513 (0.651)
Ep: 143, Reward: 162.4276, Test: 146.9368 [117.30], Avg: 189.1359 (0.649)
Ep: 144, Reward: 115.4781, Test: 180.7053 [155.53], Avg: 188.0052 (0.647)
Ep: 145, Reward: 239.0778, Test: 233.0726 [164.09], Avg: 187.1900 (0.645)
Ep: 146, Reward: 229.7222, Test: 188.6561 [78.40], Avg: 186.6666 (0.643)
Ep: 147, Reward: 184.5812, Test: 190.8377 [75.67], Avg: 186.1835 (0.641)
Ep: 148, Reward: 188.4986, Test: 259.2042 [149.57], Avg: 185.6697 (0.639)
Ep: 149, Reward: 232.3794, Test: 279.7320 [159.11], Avg: 185.2361 (0.637)
Ep: 150, Reward: 206.0837, Test: 226.9567 [120.37], Avg: 184.7152 (0.635)
Ep: 151, Reward: 276.9013, Test: 266.5375 [190.09], Avg: 184.0030 (0.633)
Ep: 152, Reward: 233.1367, Test: 180.0929 [102.04], Avg: 183.3105 (0.631)
Ep: 153, Reward: 215.6173, Test: 301.6643 [141.74], Avg: 183.1587 (0.630)
Ep: 154, Reward: 287.9474, Test: 244.7072 [128.90], Avg: 182.7241 (0.628)
Ep: 155, Reward: 271.5591, Test: 341.3190 [145.12], Avg: 182.8105 (0.626)
Ep: 156, Reward: 275.9345, Test: 209.9017 [115.98], Avg: 182.2443 (0.624)
Ep: 157, Reward: 203.0833, Test: 212.0172 [137.84], Avg: 181.5603 (0.622)
Ep: 158, Reward: 227.5335, Test: 229.4527 [107.14], Avg: 181.1877 (0.620)
Ep: 159, Reward: 250.1685, Test: 247.5302 [69.44], Avg: 181.1683 (0.618)
Ep: 160, Reward: 240.9045, Test: 250.5456 [155.26], Avg: 180.6349 (0.616)
Ep: 161, Reward: 226.4362, Test: 255.2780 [129.33], Avg: 180.2973 (0.615)
Ep: 162, Reward: 278.0675, Test: 286.1741 [123.73], Avg: 180.1878 (0.613)
Ep: 163, Reward: 301.2208, Test: 256.2024 [139.57], Avg: 179.8003 (0.611)
Ep: 164, Reward: 253.3811, Test: 240.0962 [137.69], Avg: 179.3312 (0.609)
Ep: 165, Reward: 279.5749, Test: 298.9377 [144.31], Avg: 179.1824 (0.607)
Ep: 166, Reward: 285.7803, Test: 368.5280 [232.01], Avg: 178.9269 (0.605)
Ep: 167, Reward: 300.1527, Test: 395.5311 [194.68], Avg: 179.0575 (0.604)
Ep: 168, Reward: 334.7610, Test: 307.3584 [149.25], Avg: 178.9335 (0.602)
Ep: 169, Reward: 304.5664, Test: 236.3676 [134.42], Avg: 178.4806 (0.600)
Ep: 170, Reward: 219.8591, Test: 236.3320 [122.22], Avg: 178.1042 (0.598)
Ep: 171, Reward: 264.8398, Test: 321.5424 [131.80], Avg: 178.1718 (0.596)
Ep: 172, Reward: 309.7686, Test: 288.7657 [88.40], Avg: 178.3001 (0.595)
Ep: 173, Reward: 282.6832, Test: 218.1635 [111.64], Avg: 177.8876 (0.593)
Ep: 174, Reward: 288.1600, Test: 305.1668 [127.50], Avg: 177.8863 (0.591)
Ep: 175, Reward: 258.2126, Test: 281.2260 [163.36], Avg: 177.5453 (0.589)
Ep: 176, Reward: 271.3315, Test: 218.0793 [92.46], Avg: 177.2520 (0.588)
Ep: 177, Reward: 218.8499, Test: 286.0501 [114.50], Avg: 177.2199 (0.586)
Ep: 178, Reward: 280.6328, Test: 321.0382 [134.14], Avg: 177.2740 (0.584)
Ep: 179, Reward: 233.4475, Test: 294.5105 [97.31], Avg: 177.3846 (0.582)
Ep: 180, Reward: 283.2876, Test: 314.4605 [104.80], Avg: 177.5630 (0.581)
Ep: 181, Reward: 244.6624, Test: 333.8943 [111.21], Avg: 177.8109 (0.579)
Ep: 182, Reward: 274.8169, Test: 336.9869 [102.13], Avg: 178.1226 (0.577)
Ep: 183, Reward: 266.3252, Test: 280.8247 [112.43], Avg: 178.0698 (0.575)
Ep: 184, Reward: 341.3947, Test: 253.2761 [131.04], Avg: 177.7680 (0.574)
Ep: 185, Reward: 257.9521, Test: 265.1127 [108.26], Avg: 177.6556 (0.572)
Ep: 186, Reward: 255.7898, Test: 230.3391 [104.09], Avg: 177.3807 (0.570)
Ep: 187, Reward: 270.1277, Test: 239.7962 [126.98], Avg: 177.0372 (0.568)
Ep: 188, Reward: 337.6407, Test: 286.9681 [180.62], Avg: 176.6632 (0.567)
Ep: 189, Reward: 237.1821, Test: 282.0802 [146.21], Avg: 176.4485 (0.565)
Ep: 190, Reward: 243.9189, Test: 222.7428 [116.13], Avg: 176.0829 (0.563)
Ep: 191, Reward: 204.7443, Test: 277.0511 [110.49], Avg: 176.0333 (0.562)
Ep: 192, Reward: 254.5576, Test: 282.6015 [82.25], Avg: 176.1593 (0.560)
Ep: 193, Reward: 314.7744, Test: 338.8662 [178.34], Avg: 176.0787 (0.558)
Ep: 194, Reward: 276.9535, Test: 295.0431 [145.91], Avg: 175.9405 (0.557)
Ep: 195, Reward: 259.5917, Test: 285.7218 [184.47], Avg: 175.5595 (0.555)
Ep: 196, Reward: 323.6297, Test: 297.0429 [182.48], Avg: 175.2498 (0.553)
Ep: 197, Reward: 282.7592, Test: 251.1156 [126.87], Avg: 174.9923 (0.552)
Ep: 198, Reward: 229.8771, Test: 237.6040 [113.59], Avg: 174.7361 (0.550)
Ep: 199, Reward: 314.9143, Test: 279.7678 [148.21], Avg: 174.5202 (0.548)
Ep: 200, Reward: 352.1724, Test: 279.2435 [96.37], Avg: 174.5617 (0.547)
Ep: 201, Reward: 240.0862, Test: 383.8897 [204.65], Avg: 174.5849 (0.545)
Ep: 202, Reward: 314.5974, Test: 260.7729 [109.61], Avg: 174.4695 (0.543)
Ep: 203, Reward: 401.3168, Test: 404.9797 [117.71], Avg: 175.0225 (0.542)
Ep: 204, Reward: 369.5836, Test: 359.5403 [195.95], Avg: 174.9667 (0.540)
Ep: 205, Reward: 357.6725, Test: 362.7122 [175.55], Avg: 175.0259 (0.539)
Ep: 206, Reward: 301.2458, Test: 351.4127 [110.26], Avg: 175.3453 (0.537)
Ep: 207, Reward: 335.2541, Test: 310.1815 [136.72], Avg: 175.3363 (0.535)
Ep: 208, Reward: 314.6811, Test: 343.0615 [168.00], Avg: 175.3350 (0.534)
Ep: 209, Reward: 313.8106, Test: 244.4752 [143.03], Avg: 174.9831 (0.532)
Ep: 210, Reward: 239.1815, Test: 272.9916 [122.36], Avg: 174.8677 (0.530)
Ep: 211, Reward: 304.9138, Test: 358.2991 [117.47], Avg: 175.1788 (0.529)
Ep: 212, Reward: 330.6277, Test: 354.1556 [173.66], Avg: 175.2038 (0.527)
Ep: 213, Reward: 311.9909, Test: 326.3209 [125.89], Avg: 175.3217 (0.526)
Ep: 214, Reward: 286.5196, Test: 239.6785 [131.77], Avg: 175.0081 (0.524)
Ep: 215, Reward: 283.3541, Test: 324.5269 [161.53], Avg: 174.9525 (0.523)
Ep: 216, Reward: 266.9596, Test: 265.0751 [115.00], Avg: 174.8379 (0.521)
Ep: 217, Reward: 289.7872, Test: 322.9983 [152.05], Avg: 174.8200 (0.519)
Ep: 218, Reward: 334.7413, Test: 304.0645 [125.41], Avg: 174.8376 (0.518)
Ep: 219, Reward: 303.4978, Test: 391.5415 [171.80], Avg: 175.0417 (0.516)
Ep: 220, Reward: 244.0465, Test: 295.5798 [119.89], Avg: 175.0446 (0.515)
Ep: 221, Reward: 318.1539, Test: 341.9232 [168.22], Avg: 175.0386 (0.513)
Ep: 222, Reward: 251.8198, Test: 228.9395 [87.68], Avg: 174.8871 (0.512)
Ep: 223, Reward: 255.9339, Test: 319.7289 [170.98], Avg: 174.7704 (0.510)
Ep: 224, Reward: 299.2713, Test: 236.1850 [90.30], Avg: 174.6421 (0.509)
Ep: 225, Reward: 297.0329, Test: 217.6627 [92.11], Avg: 174.4249 (0.507)
Ep: 226, Reward: 309.5611, Test: 262.9295 [73.41], Avg: 174.4914 (0.506)
Ep: 227, Reward: 285.9650, Test: 337.9265 [146.83], Avg: 174.5642 (0.504)
Ep: 228, Reward: 300.8472, Test: 300.7271 [157.73], Avg: 174.4264 (0.503)
Ep: 229, Reward: 340.9383, Test: 360.6964 [119.72], Avg: 174.7158 (0.501)
Ep: 230, Reward: 286.4941, Test: 408.0364 [154.17], Avg: 175.0584 (0.500)
Ep: 231, Reward: 368.1176, Test: 234.3995 [98.16], Avg: 174.8911 (0.498)
Ep: 232, Reward: 289.8105, Test: 390.9308 [109.04], Avg: 175.3503 (0.497)
Ep: 233, Reward: 335.0267, Test: 399.2587 [161.98], Avg: 175.6150 (0.495)
Ep: 234, Reward: 331.5308, Test: 342.1802 [207.54], Avg: 175.4406 (0.494)
Ep: 235, Reward: 352.1204, Test: 310.5104 [158.07], Avg: 175.3432 (0.492)
Ep: 236, Reward: 380.2080, Test: 371.0131 [168.01], Avg: 175.4599 (0.491)
Ep: 237, Reward: 386.2687, Test: 389.6576 [209.53], Avg: 175.4795 (0.489)
Ep: 238, Reward: 367.4676, Test: 395.0921 [165.86], Avg: 175.7044 (0.488)
Ep: 239, Reward: 308.1006, Test: 405.0857 [169.93], Avg: 175.9521 (0.486)
Ep: 240, Reward: 362.1288, Test: 436.5538 [127.36], Avg: 176.5050 (0.485)
Ep: 241, Reward: 392.3178, Test: 397.8354 [166.03], Avg: 176.7335 (0.483)
Ep: 242, Reward: 489.7532, Test: 429.1087 [172.88], Avg: 177.0606 (0.482)
Ep: 243, Reward: 426.5955, Test: 490.6765 [181.55], Avg: 177.6019 (0.480)
Ep: 244, Reward: 418.8874, Test: 457.9462 [224.43], Avg: 177.8301 (0.479)
Ep: 245, Reward: 394.0236, Test: 422.4383 [171.00], Avg: 178.1294 (0.478)
Ep: 246, Reward: 435.0826, Test: 440.1076 [199.53], Avg: 178.3822 (0.476)
Ep: 247, Reward: 424.6610, Test: 316.1929 [143.30], Avg: 178.3601 (0.475)
Ep: 248, Reward: 485.9977, Test: 571.3482 [159.11], Avg: 179.2993 (0.473)
Ep: 249, Reward: 517.3773, Test: 523.9154 [175.81], Avg: 179.9746 (0.472)
Ep: 250, Reward: 549.5085, Test: 483.8578 [178.55], Avg: 180.4739 (0.470)
Ep: 251, Reward: 498.8020, Test: 462.3735 [211.77], Avg: 180.7522 (0.469)
Ep: 252, Reward: 502.2435, Test: 519.9706 [192.62], Avg: 181.3316 (0.468)
Ep: 253, Reward: 432.5466, Test: 426.4535 [236.61], Avg: 181.3651 (0.466)
Ep: 254, Reward: 506.7172, Test: 432.4308 [189.60], Avg: 181.6061 (0.465)
Ep: 255, Reward: 382.4799, Test: 479.9476 [225.81], Avg: 181.8895 (0.463)
Ep: 256, Reward: 519.9913, Test: 358.4964 [141.61], Avg: 182.0257 (0.462)
Ep: 257, Reward: 529.8551, Test: 508.3093 [214.33], Avg: 182.4596 (0.461)
Ep: 258, Reward: 430.1284, Test: 405.1851 [165.82], Avg: 182.6793 (0.459)
Ep: 259, Reward: 469.0931, Test: 450.1792 [202.01], Avg: 182.9312 (0.458)
Ep: 260, Reward: 415.4587, Test: 532.4268 [170.75], Avg: 183.6160 (0.456)
Ep: 261, Reward: 563.3938, Test: 489.3777 [178.88], Avg: 184.1003 (0.455)
Ep: 262, Reward: 406.7297, Test: 431.0627 [207.73], Avg: 184.2495 (0.454)
Ep: 263, Reward: 493.4576, Test: 546.5313 [200.25], Avg: 184.8632 (0.452)
Ep: 264, Reward: 508.4701, Test: 442.7205 [221.57], Avg: 185.0002 (0.451)
Ep: 265, Reward: 626.6741, Test: 486.8282 [216.41], Avg: 185.3213 (0.450)
Ep: 266, Reward: 461.8950, Test: 550.5121 [173.04], Avg: 186.0409 (0.448)
Ep: 267, Reward: 357.0469, Test: 325.8883 [182.20], Avg: 185.8829 (0.447)
Ep: 268, Reward: 412.2056, Test: 394.5044 [213.84], Avg: 185.8635 (0.446)
Ep: 269, Reward: 394.8359, Test: 384.5808 [127.77], Avg: 186.1263 (0.444)
Ep: 270, Reward: 290.4954, Test: 506.0852 [113.01], Avg: 186.8899 (0.443)
Ep: 271, Reward: 405.0991, Test: 508.3626 [157.61], Avg: 187.4924 (0.442)
Ep: 272, Reward: 492.1202, Test: 382.5017 [212.00], Avg: 187.4301 (0.440)
Ep: 273, Reward: 549.1361, Test: 519.5924 [245.08], Avg: 187.7479 (0.439)
Ep: 274, Reward: 525.9559, Test: 529.0735 [183.03], Avg: 188.3236 (0.438)
Ep: 275, Reward: 509.8671, Test: 531.7858 [295.69], Avg: 188.4967 (0.436)
Ep: 276, Reward: 542.6008, Test: 558.8493 [134.88], Avg: 189.3467 (0.435)
Ep: 277, Reward: 565.6037, Test: 657.0676 [210.36], Avg: 190.2725 (0.434)
Ep: 278, Reward: 564.7396, Test: 561.2712 [149.21], Avg: 191.0674 (0.432)
Ep: 279, Reward: 621.6973, Test: 502.3515 [197.70], Avg: 191.4731 (0.431)
Ep: 280, Reward: 603.5755, Test: 404.9587 [136.60], Avg: 191.7467 (0.430)
Ep: 281, Reward: 355.5513, Test: 395.1880 [213.06], Avg: 191.7126 (0.429)
Ep: 282, Reward: 420.2843, Test: 356.2936 [142.83], Avg: 191.7895 (0.427)
Ep: 283, Reward: 387.7316, Test: 214.9581 [68.63], Avg: 191.6294 (0.426)
Ep: 284, Reward: 306.1284, Test: 394.3285 [246.55], Avg: 191.4755 (0.425)
Ep: 285, Reward: 268.0438, Test: 267.5107 [98.71], Avg: 191.3962 (0.423)
Ep: 286, Reward: 331.2438, Test: 414.0084 [150.15], Avg: 191.6487 (0.422)
Ep: 287, Reward: 349.7888, Test: 385.6642 [150.79], Avg: 191.7988 (0.421)
Ep: 288, Reward: 379.5941, Test: 461.0414 [135.79], Avg: 192.2606 (0.420)
Ep: 289, Reward: 421.2444, Test: 374.9699 [160.01], Avg: 192.3388 (0.418)
Ep: 290, Reward: 487.3824, Test: 373.7544 [155.48], Avg: 192.4280 (0.417)
Ep: 291, Reward: 424.6278, Test: 535.9903 [131.16], Avg: 193.1554 (0.416)
Ep: 292, Reward: 556.2620, Test: 500.4701 [249.71], Avg: 193.3520 (0.415)
Ep: 293, Reward: 571.4914, Test: 459.5453 [193.01], Avg: 193.6009 (0.413)
Ep: 294, Reward: 631.6994, Test: 652.5328 [113.98], Avg: 194.7702 (0.412)
Ep: 295, Reward: 590.1245, Test: 662.0662 [138.65], Avg: 195.8805 (0.411)
Ep: 296, Reward: 615.5331, Test: 622.9210 [95.91], Avg: 196.9954 (0.410)
Ep: 297, Reward: 584.0094, Test: 560.8895 [138.35], Avg: 197.7523 (0.408)
Ep: 298, Reward: 643.8281, Test: 629.5789 [60.78], Avg: 198.9932 (0.407)
Ep: 299, Reward: 569.3897, Test: 583.0705 [125.70], Avg: 199.8545 (0.406)
Ep: 300, Reward: 568.1463, Test: 631.9979 [114.03], Avg: 200.9113 (0.405)
Ep: 301, Reward: 660.2232, Test: 621.5667 [150.60], Avg: 201.8055 (0.404)
Ep: 302, Reward: 620.2666, Test: 731.0324 [114.88], Avg: 203.1730 (0.402)
Ep: 303, Reward: 640.5599, Test: 688.8555 [139.01], Avg: 204.3134 (0.401)
Ep: 304, Reward: 701.8712, Test: 591.0288 [163.58], Avg: 205.0450 (0.400)
Ep: 305, Reward: 678.5540, Test: 745.6874 [119.71], Avg: 206.4206 (0.399)
Ep: 306, Reward: 603.3637, Test: 714.8445 [144.59], Avg: 207.6057 (0.398)
Ep: 307, Reward: 673.9012, Test: 688.1148 [93.49], Avg: 208.8623 (0.396)
Ep: 308, Reward: 658.0580, Test: 689.8304 [122.44], Avg: 210.0226 (0.395)
Ep: 309, Reward: 704.0545, Test: 697.8689 [142.06], Avg: 211.1380 (0.394)
Ep: 310, Reward: 690.7398, Test: 677.1048 [178.71], Avg: 212.0617 (0.393)
Ep: 311, Reward: 622.7587, Test: 688.2761 [82.52], Avg: 213.3235 (0.392)
Ep: 312, Reward: 614.7204, Test: 705.0118 [149.00], Avg: 214.4184 (0.390)
Ep: 313, Reward: 625.3295, Test: 692.8883 [126.85], Avg: 215.5382 (0.389)
Ep: 314, Reward: 705.3967, Test: 715.0424 [121.90], Avg: 216.7369 (0.388)
Ep: 315, Reward: 778.1745, Test: 839.8159 [51.56], Avg: 218.5455 (0.387)
Ep: 316, Reward: 724.0940, Test: 793.8709 [90.13], Avg: 220.0761 (0.386)
Ep: 317, Reward: 792.8813, Test: 780.2526 [75.69], Avg: 221.5997 (0.385)
Ep: 318, Reward: 779.3391, Test: 759.8189 [83.92], Avg: 223.0238 (0.383)
Ep: 319, Reward: 808.3443, Test: 752.6418 [216.09], Avg: 224.0036 (0.382)
Ep: 320, Reward: 780.3998, Test: 722.6427 [155.78], Avg: 225.0717 (0.381)
Ep: 321, Reward: 848.6447, Test: 729.9048 [165.70], Avg: 226.1249 (0.380)
Ep: 322, Reward: 825.3349, Test: 810.7981 [64.69], Avg: 227.7347 (0.379)
Ep: 323, Reward: 808.7434, Test: 759.9591 [178.62], Avg: 228.8261 (0.378)
Ep: 324, Reward: 801.3669, Test: 841.0308 [72.53], Avg: 230.4866 (0.377)
Ep: 325, Reward: 810.3303, Test: 833.3576 [59.99], Avg: 232.1519 (0.376)
Ep: 326, Reward: 774.4369, Test: 846.3030 [33.35], Avg: 233.9280 (0.374)
Ep: 327, Reward: 866.8073, Test: 789.4476 [81.67], Avg: 235.3727 (0.373)
Ep: 328, Reward: 837.6542, Test: 779.9543 [131.81], Avg: 236.6273 (0.372)
Ep: 329, Reward: 818.5114, Test: 830.8508 [61.04], Avg: 238.2430 (0.371)
Ep: 330, Reward: 818.4546, Test: 879.5774 [20.34], Avg: 240.1191 (0.370)
Ep: 331, Reward: 790.1949, Test: 841.4184 [39.14], Avg: 241.8123 (0.369)
Ep: 332, Reward: 836.9298, Test: 838.5054 [79.72], Avg: 243.3648 (0.368)
Ep: 333, Reward: 785.4498, Test: 813.6914 [46.43], Avg: 244.9334 (0.367)
Ep: 334, Reward: 850.7446, Test: 832.7076 [56.02], Avg: 246.5207 (0.365)
Ep: 335, Reward: 825.5177, Test: 830.0415 [97.74], Avg: 247.9665 (0.364)
Ep: 336, Reward: 834.8750, Test: 868.5016 [26.06], Avg: 249.7305 (0.363)
Ep: 337, Reward: 851.0722, Test: 819.9558 [74.85], Avg: 251.1961 (0.362)
Ep: 338, Reward: 879.1272, Test: 852.5412 [55.87], Avg: 252.8052 (0.361)
Ep: 339, Reward: 834.1370, Test: 844.7129 [61.76], Avg: 254.3645 (0.360)
Ep: 340, Reward: 833.6906, Test: 835.8551 [65.07], Avg: 255.8789 (0.359)
Ep: 341, Reward: 826.1168, Test: 708.6360 [216.91], Avg: 256.5685 (0.358)
Ep: 342, Reward: 861.1428, Test: 831.5259 [80.10], Avg: 258.0112 (0.357)
Ep: 343, Reward: 834.1288, Test: 711.7866 [166.60], Avg: 258.8461 (0.356)
Ep: 344, Reward: 746.8103, Test: 716.8726 [175.63], Avg: 259.6646 (0.355)
Ep: 345, Reward: 829.3064, Test: 776.4428 [165.16], Avg: 260.6808 (0.354)
Ep: 346, Reward: 764.8145, Test: 789.3275 [150.87], Avg: 261.7696 (0.353)
Ep: 347, Reward: 802.3673, Test: 781.4051 [196.51], Avg: 262.6981 (0.351)
Ep: 348, Reward: 813.7914, Test: 835.1141 [41.61], Avg: 264.2190 (0.350)
Ep: 349, Reward: 751.2862, Test: 688.3857 [190.72], Avg: 264.8860 (0.349)
Ep: 350, Reward: 776.4810, Test: 833.8895 [49.40], Avg: 266.3664 (0.348)
Ep: 351, Reward: 831.9759, Test: 832.8455 [34.51], Avg: 267.8777 (0.347)
Ep: 352, Reward: 729.4616, Test: 718.9790 [140.30], Avg: 268.7581 (0.346)
Ep: 353, Reward: 767.9784, Test: 785.8078 [110.56], Avg: 269.9064 (0.345)
Ep: 354, Reward: 829.4632, Test: 822.7255 [58.42], Avg: 271.2991 (0.344)
Ep: 355, Reward: 761.2915, Test: 808.5462 [154.51], Avg: 272.3741 (0.343)
Ep: 356, Reward: 768.9161, Test: 760.6487 [140.50], Avg: 273.3483 (0.342)
Ep: 357, Reward: 816.9336, Test: 790.7229 [95.83], Avg: 274.5258 (0.341)
Ep: 358, Reward: 805.9862, Test: 748.3636 [160.71], Avg: 275.3980 (0.340)
Ep: 359, Reward: 766.9710, Test: 752.0282 [166.46], Avg: 276.2596 (0.339)
Ep: 360, Reward: 762.7322, Test: 850.5921 [56.44], Avg: 277.6942 (0.338)
Ep: 361, Reward: 753.7908, Test: 748.1827 [204.04], Avg: 278.4302 (0.337)
Ep: 362, Reward: 791.4707, Test: 813.3611 [118.48], Avg: 279.5775 (0.336)
Ep: 363, Reward: 715.8224, Test: 820.2262 [67.22], Avg: 280.8781 (0.335)
Ep: 364, Reward: 752.5501, Test: 681.9902 [213.61], Avg: 281.3918 (0.334)
Ep: 365, Reward: 823.2926, Test: 782.9526 [139.32], Avg: 282.3816 (0.333)
Ep: 366, Reward: 821.5853, Test: 793.6340 [113.47], Avg: 283.4655 (0.332)
Ep: 367, Reward: 811.4905, Test: 673.6921 [165.51], Avg: 284.0761 (0.331)
Ep: 368, Reward: 878.3894, Test: 806.5059 [121.19], Avg: 285.1635 (0.330)
Ep: 369, Reward: 831.9756, Test: 778.8556 [125.34], Avg: 286.1590 (0.329)
Ep: 370, Reward: 833.9704, Test: 757.5575 [150.82], Avg: 287.0231 (0.328)
Ep: 371, Reward: 769.4820, Test: 759.9924 [158.60], Avg: 287.8682 (0.327)
Ep: 372, Reward: 822.8409, Test: 754.9850 [169.04], Avg: 288.6673 (0.326)
Ep: 373, Reward: 715.1737, Test: 742.3209 [217.75], Avg: 289.2981 (0.325)
Ep: 374, Reward: 699.7756, Test: 825.9948 [119.59], Avg: 290.4104 (0.324)
Ep: 375, Reward: 754.8613, Test: 674.1595 [224.52], Avg: 290.8339 (0.323)
Ep: 376, Reward: 772.0841, Test: 715.5336 [177.40], Avg: 291.4898 (0.322)
Ep: 377, Reward: 713.3126, Test: 849.9402 [31.09], Avg: 292.8850 (0.321)
Ep: 378, Reward: 747.2921, Test: 875.4929 [28.32], Avg: 294.3475 (0.320)
Ep: 379, Reward: 841.0231, Test: 754.5897 [193.47], Avg: 295.0495 (0.319)
Ep: 380, Reward: 770.8077, Test: 809.9485 [122.00], Avg: 296.0807 (0.318)
Ep: 381, Reward: 820.9889, Test: 868.0842 [59.27], Avg: 297.4230 (0.317)
Ep: 382, Reward: 768.9744, Test: 847.9115 [70.68], Avg: 298.6757 (0.316)
Ep: 383, Reward: 807.5760, Test: 720.2817 [162.63], Avg: 299.3501 (0.315)
Ep: 384, Reward: 777.3272, Test: 746.2296 [203.26], Avg: 299.9829 (0.315)
Ep: 385, Reward: 814.6081, Test: 636.3581 [202.54], Avg: 300.3297 (0.314)
Ep: 386, Reward: 770.3627, Test: 717.5516 [185.10], Avg: 300.9294 (0.313)
Ep: 387, Reward: 777.7265, Test: 832.8806 [46.26], Avg: 302.1812 (0.312)
Ep: 388, Reward: 760.2070, Test: 808.4589 [139.28], Avg: 303.1247 (0.311)
Ep: 389, Reward: 803.2628, Test: 824.8389 [153.62], Avg: 304.0685 (0.310)
Ep: 390, Reward: 882.1586, Test: 831.8304 [116.54], Avg: 305.1202 (0.309)
Ep: 391, Reward: 856.1763, Test: 817.0639 [129.66], Avg: 306.0954 (0.308)
Ep: 392, Reward: 836.3736, Test: 798.6335 [216.44], Avg: 306.7980 (0.307)
Ep: 393, Reward: 861.5759, Test: 862.1064 [42.94], Avg: 308.0984 (0.306)
Ep: 394, Reward: 903.8274, Test: 799.4632 [129.05], Avg: 309.0157 (0.305)
Ep: 395, Reward: 865.2983, Test: 831.9938 [96.80], Avg: 310.0919 (0.304)
Ep: 396, Reward: 954.4011, Test: 881.1614 [29.50], Avg: 311.4560 (0.303)
Ep: 397, Reward: 895.9809, Test: 838.0608 [108.10], Avg: 312.5075 (0.302)
Ep: 398, Reward: 910.7788, Test: 806.8685 [130.61], Avg: 313.4192 (0.302)
Ep: 399, Reward: 865.7984, Test: 821.7709 [150.92], Avg: 314.3128 (0.301)
Ep: 400, Reward: 804.7895, Test: 849.8576 [67.66], Avg: 315.4796 (0.300)
Ep: 401, Reward: 822.7920, Test: 776.8074 [193.87], Avg: 316.1449 (0.299)
Ep: 402, Reward: 841.4053, Test: 766.5133 [197.23], Avg: 316.7730 (0.298)
Ep: 403, Reward: 754.9739, Test: 770.1684 [147.76], Avg: 317.5296 (0.297)
Ep: 404, Reward: 873.1212, Test: 775.8949 [182.31], Avg: 318.2112 (0.296)
Ep: 405, Reward: 827.0181, Test: 839.9094 [89.01], Avg: 319.2769 (0.295)
Ep: 406, Reward: 921.3051, Test: 858.7627 [62.36], Avg: 320.4492 (0.294)
Ep: 407, Reward: 883.8292, Test: 820.6792 [165.99], Avg: 321.2684 (0.294)
Ep: 408, Reward: 867.5650, Test: 792.2733 [140.33], Avg: 322.0769 (0.293)
Ep: 409, Reward: 898.5079, Test: 807.3246 [192.03], Avg: 322.7921 (0.292)
Ep: 410, Reward: 899.9245, Test: 857.6355 [89.89], Avg: 323.8747 (0.291)
Ep: 411, Reward: 876.7680, Test: 863.2382 [82.92], Avg: 324.9826 (0.290)
Ep: 412, Reward: 893.8157, Test: 872.2628 [32.67], Avg: 326.2286 (0.289)
Ep: 413, Reward: 847.9389, Test: 854.1266 [88.67], Avg: 327.2896 (0.288)
Ep: 414, Reward: 832.3160, Test: 808.5531 [158.00], Avg: 328.0685 (0.287)
Ep: 415, Reward: 878.4109, Test: 867.8515 [57.94], Avg: 329.2268 (0.287)
Ep: 416, Reward: 928.5547, Test: 867.8741 [74.69], Avg: 330.3394 (0.286)
Ep: 417, Reward: 909.1170, Test: 862.0761 [42.82], Avg: 331.5091 (0.285)
Ep: 418, Reward: 848.4021, Test: 766.4204 [120.82], Avg: 332.2587 (0.284)
Ep: 419, Reward: 883.7486, Test: 867.2717 [66.17], Avg: 333.3750 (0.283)
Ep: 420, Reward: 911.0383, Test: 876.3715 [37.18], Avg: 334.5765 (0.282)
Ep: 421, Reward: 863.8262, Test: 890.3146 [19.38], Avg: 335.8474 (0.281)
Ep: 422, Reward: 893.6126, Test: 861.0413 [53.70], Avg: 336.9621 (0.281)
Ep: 423, Reward: 887.0959, Test: 878.2447 [10.30], Avg: 338.2144 (0.280)
Ep: 424, Reward: 884.4138, Test: 872.9074 [49.67], Avg: 339.3556 (0.279)
Ep: 425, Reward: 907.0854, Test: 870.5000 [75.90], Avg: 340.4243 (0.278)
Ep: 426, Reward: 896.9678, Test: 847.4505 [126.14], Avg: 341.3163 (0.277)
Ep: 427, Reward: 835.6229, Test: 894.2658 [17.40], Avg: 342.5676 (0.276)
Ep: 428, Reward: 879.6368, Test: 854.5608 [95.59], Avg: 343.5382 (0.276)
Ep: 429, Reward: 876.3000, Test: 876.6966 [58.23], Avg: 344.6427 (0.275)
Ep: 430, Reward: 872.2406, Test: 850.9456 [133.57], Avg: 345.5075 (0.274)
Ep: 431, Reward: 892.5039, Test: 880.1345 [45.24], Avg: 346.6403 (0.273)
Ep: 432, Reward: 949.2383, Test: 846.4470 [79.78], Avg: 347.6104 (0.272)
Ep: 433, Reward: 828.9472, Test: 859.1857 [117.46], Avg: 348.5185 (0.271)
Ep: 434, Reward: 917.6061, Test: 851.1021 [80.74], Avg: 349.4882 (0.271)
Ep: 435, Reward: 904.2360, Test: 886.0948 [21.64], Avg: 350.6693 (0.270)
Ep: 436, Reward: 924.5653, Test: 866.7177 [69.22], Avg: 351.6918 (0.269)
Ep: 437, Reward: 894.8489, Test: 882.5883 [47.66], Avg: 352.7951 (0.268)
Ep: 438, Reward: 890.0382, Test: 860.7255 [66.13], Avg: 353.8015 (0.267)
Ep: 439, Reward: 901.9704, Test: 867.8907 [80.06], Avg: 354.7879 (0.267)
Ep: 440, Reward: 961.4193, Test: 872.4177 [77.37], Avg: 355.7862 (0.266)
Ep: 441, Reward: 846.6781, Test: 878.9664 [50.41], Avg: 356.8558 (0.265)
Ep: 442, Reward: 901.9191, Test: 870.7469 [60.11], Avg: 357.8802 (0.264)
Ep: 443, Reward: 918.3717, Test: 879.6461 [69.96], Avg: 358.8978 (0.263)
Ep: 444, Reward: 921.4053, Test: 813.3989 [174.51], Avg: 359.5270 (0.263)
Ep: 445, Reward: 887.3621, Test: 896.5079 [22.96], Avg: 360.6795 (0.262)
Ep: 446, Reward: 879.3082, Test: 871.4982 [56.54], Avg: 361.6957 (0.261)
Ep: 447, Reward: 906.0268, Test: 861.7433 [63.83], Avg: 362.6694 (0.260)
Ep: 448, Reward: 854.8056, Test: 821.7248 [151.41], Avg: 363.3546 (0.259)
Ep: 449, Reward: 836.1476, Test: 751.9733 [157.35], Avg: 363.8686 (0.259)
Ep: 450, Reward: 919.0724, Test: 799.6379 [128.35], Avg: 364.5502 (0.258)
Ep: 451, Reward: 899.0276, Test: 855.0824 [70.72], Avg: 365.4790 (0.257)
Ep: 452, Reward: 883.8899, Test: 883.6616 [55.89], Avg: 366.4995 (0.256)
Ep: 453, Reward: 942.0368, Test: 862.1609 [69.14], Avg: 367.4390 (0.256)
Ep: 454, Reward: 826.5351, Test: 814.7098 [142.10], Avg: 368.1097 (0.255)
Ep: 455, Reward: 956.8396, Test: 890.9474 [24.42], Avg: 369.2027 (0.254)
Ep: 456, Reward: 947.9595, Test: 899.1111 [20.92], Avg: 370.3165 (0.253)
Ep: 457, Reward: 960.2890, Test: 887.2508 [49.88], Avg: 371.3363 (0.253)
Ep: 458, Reward: 961.0536, Test: 881.8380 [49.23], Avg: 372.3412 (0.252)
Ep: 459, Reward: 905.6839, Test: 872.9706 [53.63], Avg: 373.3130 (0.251)
Ep: 460, Reward: 888.8244, Test: 843.4677 [133.83], Avg: 374.0425 (0.250)
Ep: 461, Reward: 891.8647, Test: 897.8561 [20.21], Avg: 375.1326 (0.250)
Ep: 462, Reward: 956.8529, Test: 880.7907 [19.09], Avg: 376.1835 (0.249)
Ep: 463, Reward: 928.0773, Test: 858.0793 [84.38], Avg: 377.0402 (0.248)
Ep: 464, Reward: 906.7880, Test: 837.9681 [118.36], Avg: 377.7769 (0.247)
Ep: 465, Reward: 933.4635, Test: 892.1761 [28.18], Avg: 378.8203 (0.247)
Ep: 466, Reward: 946.1890, Test: 883.6727 [35.22], Avg: 379.8259 (0.246)
Ep: 467, Reward: 949.6781, Test: 835.3329 [157.51], Avg: 380.4626 (0.245)
Ep: 468, Reward: 974.4546, Test: 861.9428 [70.33], Avg: 381.3393 (0.244)
Ep: 469, Reward: 935.0566, Test: 885.4260 [25.67], Avg: 382.3572 (0.244)
Ep: 470, Reward: 904.3285, Test: 901.0215 [27.63], Avg: 383.3998 (0.243)
Ep: 471, Reward: 929.9767, Test: 855.4496 [91.67], Avg: 384.2057 (0.242)
Ep: 472, Reward: 892.8664, Test: 878.2798 [15.81], Avg: 385.2168 (0.241)
Ep: 473, Reward: 916.0348, Test: 897.3900 [21.61], Avg: 386.2517 (0.241)
Ep: 474, Reward: 907.1406, Test: 890.5926 [39.51], Avg: 387.2303 (0.240)
Ep: 475, Reward: 915.6729, Test: 872.8558 [39.56], Avg: 388.1675 (0.239)
Ep: 476, Reward: 900.9830, Test: 879.3175 [26.78], Avg: 389.1410 (0.239)
Ep: 477, Reward: 851.4236, Test: 870.5689 [55.50], Avg: 390.0320 (0.238)
Ep: 478, Reward: 917.2289, Test: 885.3760 [39.63], Avg: 390.9834 (0.237)
Ep: 479, Reward: 927.4128, Test: 861.6275 [75.54], Avg: 391.8066 (0.236)
Ep: 480, Reward: 884.1184, Test: 845.6648 [77.64], Avg: 392.5887 (0.236)
Ep: 481, Reward: 935.9859, Test: 839.2696 [89.08], Avg: 393.3306 (0.235)
Ep: 482, Reward: 976.4657, Test: 870.5340 [44.96], Avg: 394.2255 (0.234)
Ep: 483, Reward: 920.6270, Test: 892.7856 [29.35], Avg: 395.1950 (0.234)
Ep: 484, Reward: 939.6748, Test: 892.1349 [20.50], Avg: 396.1773 (0.233)
Ep: 485, Reward: 885.4369, Test: 882.0653 [21.70], Avg: 397.1324 (0.232)
Ep: 486, Reward: 926.6469, Test: 896.2996 [15.85], Avg: 398.1249 (0.231)
Ep: 487, Reward: 986.9651, Test: 869.4487 [66.83], Avg: 398.9537 (0.231)
Ep: 488, Reward: 904.7969, Test: 831.3441 [151.77], Avg: 399.5276 (0.230)
Ep: 489, Reward: 891.5486, Test: 871.5705 [92.05], Avg: 400.3031 (0.229)
Ep: 490, Reward: 853.8122, Test: 860.6412 [75.93], Avg: 401.0860 (0.229)
Ep: 491, Reward: 1012.8433, Test: 897.4517 [33.60], Avg: 402.0266 (0.228)
Ep: 492, Reward: 975.7386, Test: 876.2988 [56.42], Avg: 402.8742 (0.227)
Ep: 493, Reward: 958.3043, Test: 884.9691 [74.81], Avg: 403.6986 (0.227)
Ep: 494, Reward: 938.4669, Test: 859.9555 [95.54], Avg: 404.4273 (0.226)
Ep: 495, Reward: 869.1219, Test: 775.5010 [157.57], Avg: 404.8578 (0.225)
Ep: 496, Reward: 973.8354, Test: 841.4839 [105.66], Avg: 405.5237 (0.225)
Ep: 497, Reward: 898.8223, Test: 891.4791 [39.73], Avg: 406.4198 (0.224)
Ep: 498, Reward: 988.8894, Test: 865.6911 [73.18], Avg: 407.1935 (0.223)
Ep: 499, Reward: 919.9413, Test: 800.4476 [116.59], Avg: 407.7468 (0.223)
