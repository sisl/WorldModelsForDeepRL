Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.1                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 4					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.01				# The limit of the ratio of new action probabilities to old probabilities

DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000    			# The number of steps to collect experience in sequence for each GAE calculation
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			value = self.critic_local(state.to(self.device))
			return value

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) + critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)
		self.replay_buffer = PrioritizedReplayBuffer()
		self.ppo_epochs = PPO_EPOCHS
		self.ppo_batch = BATCH_SIZE

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(self.ppo_epochs):
				for i in range(0, len(self.replay_buffer), self.ppo_batch):
					state, action, log_prob, target, advantage = self.replay_buffer.index(self.ppo_batch, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, e_weight=self.eps*ENTROPY_WEIGHT, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.9			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -41.3702, Test: -27.0374 [5.29], Avg: -32.3318 (0.997)
Ep: 1, Reward: -33.2754, Test: -24.6041 [16.06], Avg: -36.4992 (0.994)
Ep: 2, Reward: -35.4882, Test: -99.0386 [10.13], Avg: -60.7220 (0.991)
Ep: 3, Reward: -53.9782, Test: -95.9557 [31.28], Avg: -77.3497 (0.988)
Ep: 4, Reward: -41.8138, Test: 175.2235 [118.59], Avg: -50.5536 (0.985)
Ep: 5, Reward: -16.3658, Test: 244.8699 [138.57], Avg: -24.4109 (0.982)
Ep: 6, Reward: 33.0925, Test: 390.7640 [304.00], Avg: -8.5295 (0.979)
Ep: 7, Reward: 125.0900, Test: 353.5424 [213.78], Avg: 10.0072 (0.976)
Ep: 8, Reward: 216.2707, Test: 216.8332 [118.86], Avg: 19.7812 (0.973)
Ep: 9, Reward: 238.4011, Test: 490.7878 [198.04], Avg: 47.0781 (0.970)
Ep: 10, Reward: 369.6379, Test: 438.6707 [229.94], Avg: 61.7741 (0.967)
Ep: 11, Reward: 571.8647, Test: 281.9354 [129.67], Avg: 69.3148 (0.965)
Ep: 12, Reward: 534.0567, Test: 254.4152 [114.64], Avg: 74.7346 (0.962)
Ep: 13, Reward: 691.1999, Test: 267.8596 [78.41], Avg: 82.9286 (0.959)
Ep: 14, Reward: 610.1567, Test: 325.7184 [44.99], Avg: 96.1153 (0.956)
Ep: 15, Reward: 723.5861, Test: 221.6163 [138.45], Avg: 95.3061 (0.953)
Ep: 16, Reward: 671.7167, Test: 242.3380 [137.19], Avg: 95.8850 (0.950)
Ep: 17, Reward: 657.9705, Test: 254.8423 [70.88], Avg: 100.7781 (0.947)
Ep: 18, Reward: 511.7659, Test: 232.1186 [120.00], Avg: 101.3749 (0.945)
Ep: 19, Reward: 521.7644, Test: 238.9278 [135.35], Avg: 101.4851 (0.942)
Ep: 20, Reward: 522.5703, Test: 199.4250 [119.22], Avg: 100.4716 (0.939)
Ep: 21, Reward: 528.4650, Test: 282.4596 [108.96], Avg: 103.7911 (0.936)
Ep: 22, Reward: 539.1809, Test: 247.9874 [74.88], Avg: 106.8046 (0.933)
Ep: 23, Reward: 593.3370, Test: 248.7244 [82.62], Avg: 109.2756 (0.930)
Ep: 24, Reward: 489.5086, Test: 277.9934 [102.03], Avg: 111.9431 (0.928)
Ep: 25, Reward: 443.2978, Test: 246.6058 [73.68], Avg: 114.2885 (0.925)
Ep: 26, Reward: 559.0284, Test: 261.0178 [98.83], Avg: 116.0624 (0.922)
Ep: 27, Reward: 414.6937, Test: 287.6667 [85.66], Avg: 119.1318 (0.919)
Ep: 28, Reward: 430.2197, Test: 187.5633 [130.96], Avg: 116.9756 (0.917)
Ep: 29, Reward: 548.1455, Test: 366.1292 [176.20], Avg: 119.4075 (0.914)
Ep: 30, Reward: 543.8930, Test: 310.3548 [153.02], Avg: 120.6309 (0.911)
Ep: 31, Reward: 557.6716, Test: 269.5691 [72.82], Avg: 123.0095 (0.908)
Ep: 32, Reward: 643.5031, Test: 290.3678 [94.52], Avg: 125.2167 (0.906)
Ep: 33, Reward: 565.2389, Test: 357.7333 [147.33], Avg: 127.7222 (0.903)
Ep: 34, Reward: 701.2537, Test: 356.5737 [133.19], Avg: 130.4554 (0.900)
Ep: 35, Reward: 584.0523, Test: 279.6305 [144.43], Avg: 130.5872 (0.897)
Ep: 36, Reward: 577.1955, Test: 292.8083 [136.06], Avg: 131.2942 (0.895)
Ep: 37, Reward: 464.9536, Test: 240.6050 [132.85], Avg: 130.6749 (0.892)
Ep: 38, Reward: 401.8984, Test: 245.0395 [110.14], Avg: 130.7832 (0.889)
Ep: 39, Reward: 451.3446, Test: 229.7799 [119.87], Avg: 130.2613 (0.887)
Ep: 40, Reward: 433.4140, Test: 383.4797 [172.62], Avg: 132.2272 (0.884)
Ep: 41, Reward: 647.3099, Test: 416.2382 [147.99], Avg: 135.4658 (0.881)
Ep: 42, Reward: 723.1944, Test: 495.2135 [209.38], Avg: 138.9627 (0.879)
Ep: 43, Reward: 757.4348, Test: 440.6700 [221.06], Avg: 140.7955 (0.876)
Ep: 44, Reward: 721.0629, Test: 597.9318 [185.09], Avg: 146.8408 (0.874)
Ep: 45, Reward: 815.8531, Test: 456.0507 [159.82], Avg: 150.0884 (0.871)
Ep: 46, Reward: 775.6280, Test: 656.2236 [181.14], Avg: 157.0032 (0.868)
Ep: 47, Reward: 722.3197, Test: 616.5155 [172.04], Avg: 162.9923 (0.866)
Ep: 48, Reward: 768.2053, Test: 617.9925 [139.32], Avg: 169.4348 (0.863)
Ep: 49, Reward: 818.7116, Test: 722.0799 [124.97], Avg: 177.9882 (0.861)
Ep: 50, Reward: 882.9292, Test: 781.8156 [108.17], Avg: 187.7069 (0.858)
Ep: 51, Reward: 786.4041, Test: 818.2954 [132.57], Avg: 197.2842 (0.855)
Ep: 52, Reward: 801.1177, Test: 723.8199 [163.55], Avg: 204.1330 (0.853)
Ep: 53, Reward: 852.0696, Test: 805.5699 [168.67], Avg: 212.1473 (0.850)
Ep: 54, Reward: 875.1082, Test: 791.7230 [144.11], Avg: 220.0648 (0.848)
Ep: 55, Reward: 913.2893, Test: 686.6315 [177.60], Avg: 225.2249 (0.845)
Ep: 56, Reward: 779.3572, Test: 751.4915 [115.97], Avg: 232.4231 (0.843)
Ep: 57, Reward: 841.7605, Test: 832.1545 [72.58], Avg: 241.5119 (0.840)
Ep: 58, Reward: 818.0422, Test: 843.6969 [99.63], Avg: 250.0298 (0.838)
Ep: 59, Reward: 771.4990, Test: 849.5194 [100.35], Avg: 258.3488 (0.835)
Ep: 60, Reward: 806.7102, Test: 820.9784 [89.86], Avg: 266.0991 (0.833)
Ep: 61, Reward: 797.3781, Test: 841.8986 [72.72], Avg: 274.2132 (0.830)
Ep: 62, Reward: 809.7818, Test: 856.8935 [16.37], Avg: 283.2023 (0.828)
Ep: 63, Reward: 806.6274, Test: 851.3259 [47.54], Avg: 291.3365 (0.825)
Ep: 64, Reward: 827.8155, Test: 869.5904 [55.34], Avg: 299.3812 (0.823)
Ep: 65, Reward: 812.3894, Test: 852.2527 [78.21], Avg: 306.5731 (0.820)
Ep: 66, Reward: 856.3652, Test: 795.3805 [113.03], Avg: 312.1817 (0.818)
Ep: 67, Reward: 785.2840, Test: 833.7354 [91.56], Avg: 318.5052 (0.815)
Ep: 68, Reward: 893.3721, Test: 863.1948 [49.43], Avg: 325.6828 (0.813)
Ep: 69, Reward: 882.7030, Test: 847.8292 [63.57], Avg: 332.2339 (0.810)
Ep: 70, Reward: 883.3733, Test: 828.2044 [84.26], Avg: 338.0326 (0.808)
Ep: 71, Reward: 896.0274, Test: 839.1008 [129.76], Avg: 343.1897 (0.805)
Ep: 72, Reward: 861.9104, Test: 816.8410 [88.38], Avg: 348.4673 (0.803)
Ep: 73, Reward: 901.3294, Test: 860.9517 [81.56], Avg: 354.2907 (0.801)
Ep: 74, Reward: 806.8253, Test: 875.7492 [40.97], Avg: 360.6972 (0.798)
Ep: 75, Reward: 886.5650, Test: 874.7473 [34.09], Avg: 367.0125 (0.796)
Ep: 76, Reward: 862.5970, Test: 875.8080 [35.07], Avg: 373.1647 (0.793)
Ep: 77, Reward: 817.4481, Test: 791.0940 [113.43], Avg: 377.0685 (0.791)
Ep: 78, Reward: 832.3748, Test: 861.6100 [53.59], Avg: 382.5236 (0.789)
Ep: 79, Reward: 849.2235, Test: 840.6680 [137.52], Avg: 386.5314 (0.786)
Ep: 80, Reward: 936.4180, Test: 843.4282 [96.11], Avg: 390.9856 (0.784)
Ep: 81, Reward: 839.6998, Test: 770.1047 [190.34], Avg: 393.2878 (0.782)
Ep: 82, Reward: 882.0475, Test: 823.4277 [92.80], Avg: 397.3521 (0.779)
Ep: 83, Reward: 834.0957, Test: 760.5268 [181.97], Avg: 399.5093 (0.777)
Ep: 84, Reward: 882.4931, Test: 810.7027 [167.24], Avg: 402.3794 (0.775)
Ep: 85, Reward: 911.0640, Test: 748.6946 [180.27], Avg: 404.3101 (0.772)
Ep: 86, Reward: 869.8506, Test: 852.8287 [104.53], Avg: 408.2640 (0.770)
Ep: 87, Reward: 856.1399, Test: 825.4573 [183.29], Avg: 410.9219 (0.768)
Ep: 88, Reward: 850.4318, Test: 850.0987 [112.09], Avg: 414.5970 (0.765)
Ep: 89, Reward: 856.3484, Test: 810.3136 [126.60], Avg: 417.5873 (0.763)
Ep: 90, Reward: 785.9955, Test: 806.2359 [195.92], Avg: 419.7051 (0.761)
Ep: 91, Reward: 785.0170, Test: 765.6312 [124.97], Avg: 422.1068 (0.758)
Ep: 92, Reward: 936.3742, Test: 796.9006 [166.37], Avg: 424.3479 (0.756)
Ep: 93, Reward: 750.4743, Test: 637.6214 [279.34], Avg: 423.6451 (0.754)
Ep: 94, Reward: 885.2635, Test: 771.7810 [231.35], Avg: 424.8744 (0.752)
Ep: 95, Reward: 715.2128, Test: 842.6847 [72.54], Avg: 428.4710 (0.749)
Ep: 96, Reward: 803.5812, Test: 751.9147 [239.34], Avg: 429.3381 (0.747)
Ep: 97, Reward: 738.4760, Test: 725.9354 [267.85], Avg: 429.6314 (0.745)
Ep: 98, Reward: 806.2986, Test: 712.0292 [246.06], Avg: 429.9984 (0.743)
Ep: 99, Reward: 820.8983, Test: 696.1070 [170.90], Avg: 430.9505 (0.740)
Ep: 100, Reward: 821.4861, Test: 790.2804 [157.84], Avg: 432.9454 (0.738)
Ep: 101, Reward: 881.8819, Test: 837.3633 [102.73], Avg: 435.9032 (0.736)
Ep: 102, Reward: 849.5368, Test: 887.1849 [23.89], Avg: 440.0526 (0.734)
Ep: 103, Reward: 872.0670, Test: 710.8170 [218.39], Avg: 440.5562 (0.732)
Ep: 104, Reward: 851.3928, Test: 870.3026 [26.56], Avg: 444.3961 (0.729)
Ep: 105, Reward: 804.6233, Test: 654.5404 [199.25], Avg: 444.4989 (0.727)
Ep: 106, Reward: 891.5469, Test: 781.4042 [206.59], Avg: 445.7168 (0.725)
Ep: 107, Reward: 808.7121, Test: 849.8719 [75.21], Avg: 448.7626 (0.723)
Ep: 108, Reward: 819.0435, Test: 820.9662 [125.96], Avg: 451.0216 (0.721)
Ep: 109, Reward: 817.7414, Test: 783.3689 [197.93], Avg: 452.2436 (0.719)
Ep: 110, Reward: 770.7486, Test: 827.5011 [119.53], Avg: 454.5474 (0.716)
Ep: 111, Reward: 868.1719, Test: 852.7809 [83.20], Avg: 457.3602 (0.714)
Ep: 112, Reward: 887.3634, Test: 827.3315 [111.14], Avg: 459.6508 (0.712)
Ep: 113, Reward: 827.5296, Test: 862.6835 [64.04], Avg: 462.6244 (0.710)
Ep: 114, Reward: 850.5688, Test: 827.5650 [187.22], Avg: 464.1698 (0.708)
Ep: 115, Reward: 829.7468, Test: 880.0894 [16.57], Avg: 467.6125 (0.706)
Ep: 116, Reward: 824.0565, Test: 790.4785 [113.87], Avg: 469.3988 (0.704)
Ep: 117, Reward: 846.8015, Test: 844.0912 [82.49], Avg: 471.8751 (0.702)
Ep: 118, Reward: 810.9827, Test: 813.8895 [173.63], Avg: 473.2901 (0.699)
Ep: 119, Reward: 774.0398, Test: 818.1253 [105.11], Avg: 475.2878 (0.697)
Ep: 120, Reward: 678.2080, Test: 651.1983 [255.07], Avg: 474.6336 (0.695)
Ep: 121, Reward: 669.1470, Test: 723.5964 [270.93], Avg: 474.4535 (0.693)
Ep: 122, Reward: 731.4316, Test: 714.1789 [148.31], Avg: 475.1967 (0.691)
Ep: 123, Reward: 829.7221, Test: 663.6867 [246.07], Avg: 474.7323 (0.689)
Ep: 124, Reward: 712.1878, Test: 755.9846 [213.47], Avg: 475.2746 (0.687)
Ep: 125, Reward: 685.7518, Test: 707.1239 [231.02], Avg: 475.2812 (0.685)
Ep: 126, Reward: 705.0527, Test: 498.2533 [283.38], Avg: 473.2307 (0.683)
Ep: 127, Reward: 690.9420, Test: 637.2151 [173.41], Avg: 473.1571 (0.681)
Ep: 128, Reward: 650.8236, Test: 533.2771 [270.21], Avg: 471.5285 (0.679)
Ep: 129, Reward: 703.5412, Test: 586.2165 [279.71], Avg: 470.2591 (0.677)
Ep: 130, Reward: 781.1548, Test: 768.8372 [173.93], Avg: 471.2106 (0.675)
Ep: 131, Reward: 745.8646, Test: 838.2401 [102.92], Avg: 473.2114 (0.673)
Ep: 132, Reward: 753.4457, Test: 708.3981 [225.31], Avg: 473.2857 (0.671)
Ep: 133, Reward: 760.2179, Test: 692.3563 [251.18], Avg: 473.0461 (0.669)
Ep: 134, Reward: 768.1073, Test: 684.2497 [246.01], Avg: 472.7883 (0.667)
Ep: 135, Reward: 875.0720, Test: 630.1929 [236.74], Avg: 472.2049 (0.665)
Ep: 136, Reward: 704.0084, Test: 624.8847 [262.39], Avg: 471.4041 (0.663)
Ep: 137, Reward: 729.8946, Test: 760.1166 [189.52], Avg: 472.1229 (0.661)
Ep: 138, Reward: 782.3158, Test: 700.3346 [169.39], Avg: 472.5461 (0.659)
Ep: 139, Reward: 902.1540, Test: 797.3139 [162.05], Avg: 473.7084 (0.657)
Ep: 140, Reward: 822.1855, Test: 632.2151 [248.20], Avg: 473.0723 (0.655)
Ep: 141, Reward: 759.7793, Test: 840.1108 [90.55], Avg: 475.0194 (0.653)
Ep: 142, Reward: 833.5426, Test: 798.4798 [158.85], Avg: 476.1705 (0.651)
Ep: 143, Reward: 755.7206, Test: 837.0053 [108.96], Avg: 477.9196 (0.649)
Ep: 144, Reward: 733.2523, Test: 874.6531 [49.74], Avg: 480.3127 (0.647)
Ep: 145, Reward: 866.2429, Test: 817.8809 [155.72], Avg: 481.5582 (0.645)
Ep: 146, Reward: 787.6184, Test: 801.8751 [220.21], Avg: 482.2392 (0.643)
Ep: 147, Reward: 810.5488, Test: 739.9462 [220.91], Avg: 482.4878 (0.641)
Ep: 148, Reward: 858.8742, Test: 791.1510 [155.22], Avg: 483.5177 (0.639)
Ep: 149, Reward: 854.3489, Test: 818.7364 [127.06], Avg: 484.9054 (0.637)
Ep: 150, Reward: 846.0237, Test: 618.0874 [237.16], Avg: 484.2168 (0.635)
Ep: 151, Reward: 845.2000, Test: 710.6245 [216.97], Avg: 484.2789 (0.633)
Ep: 152, Reward: 774.6699, Test: 762.5590 [146.40], Avg: 485.1409 (0.631)
Ep: 153, Reward: 831.1717, Test: 655.0379 [237.61], Avg: 484.7011 (0.630)
Ep: 154, Reward: 856.3990, Test: 713.5747 [234.60], Avg: 484.6642 (0.628)
Ep: 155, Reward: 711.3396, Test: 661.5993 [171.85], Avg: 484.6968 (0.626)
Ep: 156, Reward: 890.5386, Test: 831.6107 [118.81], Avg: 486.1497 (0.624)
Ep: 157, Reward: 788.2759, Test: 692.8158 [186.30], Avg: 486.2786 (0.622)
Ep: 158, Reward: 717.3967, Test: 673.8849 [185.01], Avg: 486.2949 (0.620)
Ep: 159, Reward: 721.8244, Test: 720.3688 [204.15], Avg: 486.4819 (0.618)
Ep: 160, Reward: 651.7290, Test: 737.6784 [163.00], Avg: 487.0297 (0.616)
Ep: 161, Reward: 737.7922, Test: 750.2340 [159.10], Avg: 487.6723 (0.615)
Ep: 162, Reward: 844.7324, Test: 750.4647 [178.15], Avg: 488.1916 (0.613)
Ep: 163, Reward: 908.8905, Test: 794.5412 [122.58], Avg: 489.3121 (0.611)
Ep: 164, Reward: 779.8678, Test: 809.2379 [135.09], Avg: 490.4323 (0.609)
Ep: 165, Reward: 683.1270, Test: 739.8205 [144.70], Avg: 491.0630 (0.607)
Ep: 166, Reward: 743.9207, Test: 768.0825 [225.97], Avg: 491.3687 (0.605)
Ep: 167, Reward: 865.1333, Test: 830.5447 [133.49], Avg: 492.5930 (0.604)
Ep: 168, Reward: 767.7105, Test: 812.6321 [99.44], Avg: 493.8983 (0.602)
Ep: 169, Reward: 708.9646, Test: 799.1879 [151.14], Avg: 494.8051 (0.600)
Ep: 170, Reward: 713.0224, Test: 813.8730 [165.53], Avg: 495.7030 (0.598)
Ep: 171, Reward: 811.5281, Test: 715.8421 [194.80], Avg: 495.8503 (0.596)
Ep: 172, Reward: 704.5845, Test: 801.4602 [139.58], Avg: 496.8100 (0.595)
Ep: 173, Reward: 717.5330, Test: 822.2809 [147.67], Avg: 497.8319 (0.593)
Ep: 174, Reward: 790.4805, Test: 762.2651 [230.78], Avg: 498.0242 (0.591)
Ep: 175, Reward: 792.1339, Test: 749.4740 [154.97], Avg: 498.5723 (0.589)
Ep: 176, Reward: 793.3860, Test: 709.7856 [190.24], Avg: 498.6908 (0.588)
Ep: 177, Reward: 805.4930, Test: 794.8422 [133.75], Avg: 499.6032 (0.586)
Ep: 178, Reward: 798.2250, Test: 760.0605 [112.91], Avg: 500.4275 (0.584)
Ep: 179, Reward: 793.2337, Test: 711.3730 [171.04], Avg: 500.6492 (0.582)
Ep: 180, Reward: 810.8015, Test: 802.7913 [103.94], Avg: 501.7442 (0.581)
Ep: 181, Reward: 841.9960, Test: 767.6020 [176.23], Avg: 502.2367 (0.579)
Ep: 182, Reward: 735.8984, Test: 710.2547 [198.68], Avg: 502.2877 (0.577)
Ep: 183, Reward: 687.6702, Test: 782.3929 [175.78], Avg: 502.8547 (0.575)
Ep: 184, Reward: 801.3978, Test: 762.4772 [159.82], Avg: 503.3941 (0.574)
Ep: 185, Reward: 785.7908, Test: 814.0136 [122.92], Avg: 504.4033 (0.572)
Ep: 186, Reward: 735.1423, Test: 664.7601 [197.45], Avg: 504.2049 (0.570)
Ep: 187, Reward: 645.5364, Test: 669.0247 [197.31], Avg: 504.0321 (0.568)
Ep: 188, Reward: 735.9938, Test: 729.3278 [152.17], Avg: 504.4189 (0.567)
Ep: 189, Reward: 824.1856, Test: 730.8127 [141.70], Avg: 504.8647 (0.565)
Ep: 190, Reward: 672.5436, Test: 733.8054 [183.37], Avg: 505.1033 (0.563)
Ep: 191, Reward: 704.3209, Test: 724.4540 [157.92], Avg: 505.4233 (0.562)
Ep: 192, Reward: 773.5731, Test: 716.9836 [213.88], Avg: 505.4112 (0.560)
Ep: 193, Reward: 738.5892, Test: 637.0122 [234.06], Avg: 504.8831 (0.558)
Ep: 194, Reward: 697.7939, Test: 738.7822 [170.16], Avg: 505.2100 (0.557)
Ep: 195, Reward: 799.6820, Test: 759.5653 [208.72], Avg: 505.4428 (0.555)
Ep: 196, Reward: 762.6402, Test: 708.8290 [150.57], Avg: 505.7109 (0.553)
Ep: 197, Reward: 761.8584, Test: 831.9005 [111.25], Avg: 506.7964 (0.552)
Ep: 198, Reward: 822.5655, Test: 729.1678 [198.49], Avg: 506.9165 (0.550)
Ep: 199, Reward: 791.9917, Test: 807.4857 [124.27], Avg: 507.7980 (0.548)
Ep: 200, Reward: 749.8102, Test: 806.0606 [107.10], Avg: 508.7490 (0.547)
Ep: 201, Reward: 631.7286, Test: 685.3886 [245.28], Avg: 508.4092 (0.545)
Ep: 202, Reward: 800.4783, Test: 725.4947 [175.29], Avg: 508.6151 (0.543)
Ep: 203, Reward: 694.3621, Test: 698.4761 [169.13], Avg: 508.7167 (0.542)
Ep: 204, Reward: 697.6724, Test: 748.5205 [140.89], Avg: 509.1993 (0.540)
Ep: 205, Reward: 746.5299, Test: 678.7947 [213.32], Avg: 508.9870 (0.539)
Ep: 206, Reward: 672.5008, Test: 640.1875 [211.36], Avg: 508.5997 (0.537)
Ep: 207, Reward: 721.3998, Test: 739.2523 [198.42], Avg: 508.7547 (0.535)
Ep: 208, Reward: 663.5487, Test: 734.9775 [242.28], Avg: 508.6779 (0.534)
Ep: 209, Reward: 649.8542, Test: 721.8222 [189.58], Avg: 508.7901 (0.532)
Ep: 210, Reward: 768.7190, Test: 747.0653 [155.71], Avg: 509.1814 (0.530)
Ep: 211, Reward: 689.3997, Test: 739.8950 [174.08], Avg: 509.4486 (0.529)
Ep: 212, Reward: 696.4500, Test: 617.8250 [198.80], Avg: 509.0241 (0.527)
Ep: 213, Reward: 733.1918, Test: 648.0234 [193.26], Avg: 508.7705 (0.526)
Ep: 214, Reward: 784.1488, Test: 661.6670 [222.78], Avg: 508.4455 (0.524)
Ep: 215, Reward: 737.8558, Test: 752.6247 [211.87], Avg: 508.5950 (0.523)
Ep: 216, Reward: 753.7444, Test: 697.8316 [246.99], Avg: 508.3289 (0.521)
Ep: 217, Reward: 775.0396, Test: 777.4138 [155.53], Avg: 508.8498 (0.519)
Ep: 218, Reward: 702.2951, Test: 696.3201 [163.84], Avg: 508.9577 (0.518)
Ep: 219, Reward: 629.7756, Test: 597.1515 [151.10], Avg: 508.6717 (0.516)
Ep: 220, Reward: 712.5741, Test: 717.5740 [210.35], Avg: 508.6652 (0.515)
Ep: 221, Reward: 688.8301, Test: 875.0608 [22.70], Avg: 510.2133 (0.513)
Ep: 222, Reward: 736.3606, Test: 738.6442 [169.93], Avg: 510.4757 (0.512)
Ep: 223, Reward: 817.1133, Test: 739.6615 [161.10], Avg: 510.7796 (0.510)
Ep: 224, Reward: 739.7426, Test: 756.6713 [174.38], Avg: 511.0975 (0.509)
Ep: 225, Reward: 742.3844, Test: 781.1579 [153.21], Avg: 511.6145 (0.507)
Ep: 226, Reward: 766.8802, Test: 644.1715 [221.94], Avg: 511.2208 (0.506)
Ep: 227, Reward: 821.8129, Test: 700.1176 [235.04], Avg: 511.0184 (0.504)
Ep: 228, Reward: 746.1605, Test: 803.2649 [133.83], Avg: 511.7102 (0.503)
Ep: 229, Reward: 729.2875, Test: 797.1427 [131.78], Avg: 512.3782 (0.501)
Ep: 230, Reward: 736.2772, Test: 817.3860 [130.67], Avg: 513.1330 (0.500)
Ep: 231, Reward: 733.4482, Test: 715.2400 [189.89], Avg: 513.1856 (0.498)
Ep: 232, Reward: 840.7584, Test: 721.7536 [164.68], Avg: 513.3740 (0.497)
Ep: 233, Reward: 761.2306, Test: 684.3808 [215.66], Avg: 513.1831 (0.495)
Ep: 234, Reward: 738.2202, Test: 766.1404 [144.84], Avg: 513.6432 (0.494)
Ep: 235, Reward: 750.7838, Test: 730.9009 [181.79], Avg: 513.7935 (0.492)
Ep: 236, Reward: 774.8462, Test: 712.0868 [180.46], Avg: 513.8687 (0.491)
Ep: 237, Reward: 751.6761, Test: 701.8265 [194.91], Avg: 513.8395 (0.489)
Ep: 238, Reward: 670.6526, Test: 806.4851 [142.17], Avg: 514.4691 (0.488)
Ep: 239, Reward: 764.7608, Test: 776.6203 [143.80], Avg: 514.9623 (0.486)
Ep: 240, Reward: 800.6785, Test: 822.2425 [87.53], Avg: 515.8741 (0.485)
Ep: 241, Reward: 764.7912, Test: 715.7309 [211.82], Avg: 515.8247 (0.483)
Ep: 242, Reward: 704.5722, Test: 624.7657 [178.04], Avg: 515.5403 (0.482)
Ep: 243, Reward: 807.7353, Test: 686.2456 [207.15], Avg: 515.3909 (0.480)
Ep: 244, Reward: 734.8876, Test: 772.0745 [232.15], Avg: 515.4911 (0.479)
Ep: 245, Reward: 787.9396, Test: 797.5665 [151.56], Avg: 516.0216 (0.478)
Ep: 246, Reward: 811.0241, Test: 784.6973 [127.62], Avg: 516.5927 (0.476)
Ep: 247, Reward: 718.7558, Test: 785.1879 [180.63], Avg: 516.9474 (0.475)
Ep: 248, Reward: 729.8604, Test: 716.3934 [183.78], Avg: 517.0103 (0.473)
Ep: 249, Reward: 807.2069, Test: 559.3956 [152.99], Avg: 516.5679 (0.472)
Ep: 250, Reward: 740.0908, Test: 852.1497 [22.00], Avg: 517.8172 (0.470)
Ep: 251, Reward: 759.6562, Test: 694.7330 [198.17], Avg: 517.7329 (0.469)
Ep: 252, Reward: 642.2343, Test: 765.3828 [105.95], Avg: 518.2930 (0.468)
Ep: 253, Reward: 707.3233, Test: 668.4810 [166.62], Avg: 518.2283 (0.466)
Ep: 254, Reward: 744.5485, Test: 768.2880 [164.16], Avg: 518.5651 (0.465)
Ep: 255, Reward: 728.8031, Test: 639.1197 [276.68], Avg: 517.9553 (0.463)
Ep: 256, Reward: 738.2544, Test: 678.7116 [195.03], Avg: 517.8219 (0.462)
Ep: 257, Reward: 674.7254, Test: 661.8428 [257.47], Avg: 517.3822 (0.461)
Ep: 258, Reward: 662.1649, Test: 474.1685 [202.82], Avg: 516.4323 (0.459)
Ep: 259, Reward: 648.9690, Test: 687.6310 [203.65], Avg: 516.3075 (0.458)
Ep: 260, Reward: 705.1456, Test: 560.9612 [269.17], Avg: 515.4472 (0.456)
Ep: 261, Reward: 653.9634, Test: 675.9741 [184.92], Avg: 515.3541 (0.455)
Ep: 262, Reward: 628.0993, Test: 770.9462 [140.40], Avg: 515.7921 (0.454)
Ep: 263, Reward: 702.2430, Test: 665.1751 [109.81], Avg: 515.9420 (0.452)
Ep: 264, Reward: 670.3747, Test: 707.7572 [205.62], Avg: 515.8900 (0.451)
Ep: 265, Reward: 660.2845, Test: 617.6146 [215.31], Avg: 515.4629 (0.450)
Ep: 266, Reward: 517.6115, Test: 561.8009 [261.97], Avg: 514.6554 (0.448)
Ep: 267, Reward: 677.4191, Test: 754.9097 [115.09], Avg: 515.1224 (0.447)
Ep: 268, Reward: 602.2600, Test: 706.3806 [174.37], Avg: 515.1852 (0.446)
Ep: 269, Reward: 618.2664, Test: 655.6639 [198.64], Avg: 514.9698 (0.444)
Ep: 270, Reward: 604.5778, Test: 623.3781 [199.05], Avg: 514.6353 (0.443)
Ep: 271, Reward: 661.3902, Test: 667.9314 [278.14], Avg: 514.1763 (0.442)
Ep: 272, Reward: 692.2214, Test: 594.1150 [234.96], Avg: 513.6085 (0.440)
Ep: 273, Reward: 615.6699, Test: 496.6345 [199.78], Avg: 512.8174 (0.439)
Ep: 274, Reward: 531.5962, Test: 531.3083 [265.59], Avg: 511.9189 (0.438)
Ep: 275, Reward: 581.5964, Test: 472.8174 [271.17], Avg: 510.7947 (0.436)
Ep: 276, Reward: 760.0769, Test: 679.3667 [212.48], Avg: 510.6362 (0.435)
Ep: 277, Reward: 653.3264, Test: 630.0388 [201.94], Avg: 510.3393 (0.434)
Ep: 278, Reward: 602.1514, Test: 547.7741 [208.74], Avg: 509.7253 (0.432)
Ep: 279, Reward: 628.9235, Test: 598.4008 [234.73], Avg: 509.2037 (0.431)
Ep: 280, Reward: 647.3953, Test: 709.5071 [158.55], Avg: 509.3523 (0.430)
Ep: 281, Reward: 630.1543, Test: 634.4050 [182.82], Avg: 509.1474 (0.429)
Ep: 282, Reward: 625.7219, Test: 575.2893 [285.51], Avg: 508.3723 (0.427)
Ep: 283, Reward: 637.5717, Test: 587.9554 [111.53], Avg: 508.2598 (0.426)
Ep: 284, Reward: 687.8392, Test: 576.6934 [257.08], Avg: 507.5979 (0.425)
Ep: 285, Reward: 595.7102, Test: 683.6081 [156.40], Avg: 507.6665 (0.423)
Ep: 286, Reward: 629.6401, Test: 513.5169 [247.73], Avg: 506.8237 (0.422)
Ep: 287, Reward: 661.8886, Test: 687.2481 [148.40], Avg: 506.9349 (0.421)
Ep: 288, Reward: 591.1559, Test: 537.9638 [229.41], Avg: 506.2484 (0.420)
Ep: 289, Reward: 644.5862, Test: 706.1530 [165.39], Avg: 506.3675 (0.418)
Ep: 290, Reward: 553.0961, Test: 671.7053 [241.08], Avg: 506.1072 (0.417)
Ep: 291, Reward: 529.1861, Test: 553.7288 [205.61], Avg: 505.5661 (0.416)
Ep: 292, Reward: 618.6713, Test: 616.7324 [255.13], Avg: 505.0748 (0.415)
Ep: 293, Reward: 658.6452, Test: 527.2911 [199.21], Avg: 504.4728 (0.413)
Ep: 294, Reward: 590.4985, Test: 503.8133 [186.30], Avg: 503.8390 (0.412)
Ep: 295, Reward: 522.0492, Test: 534.3506 [253.40], Avg: 503.0860 (0.411)
Ep: 296, Reward: 571.0249, Test: 598.3135 [236.97], Avg: 502.6088 (0.410)
Ep: 297, Reward: 394.2507, Test: 698.5872 [169.21], Avg: 502.6986 (0.408)
Ep: 298, Reward: 464.6625, Test: 679.0145 [194.70], Avg: 502.6371 (0.407)
Ep: 299, Reward: 591.4649, Test: 548.1431 [206.93], Avg: 502.0991 (0.406)
Ep: 300, Reward: 528.1036, Test: 433.2946 [312.78], Avg: 500.8313 (0.405)
Ep: 301, Reward: 586.3540, Test: 484.4058 [247.66], Avg: 499.9569 (0.404)
Ep: 302, Reward: 451.6655, Test: 430.7782 [183.16], Avg: 499.1241 (0.402)
Ep: 303, Reward: 538.4636, Test: 533.6746 [261.66], Avg: 498.3770 (0.401)
Ep: 304, Reward: 504.7405, Test: 593.7209 [227.92], Avg: 497.9423 (0.400)
Ep: 305, Reward: 546.5309, Test: 641.5038 [243.25], Avg: 497.6166 (0.399)
Ep: 306, Reward: 501.8335, Test: 592.7516 [180.84], Avg: 497.3374 (0.398)
Ep: 307, Reward: 516.3514, Test: 612.3242 [215.75], Avg: 497.0102 (0.396)
Ep: 308, Reward: 628.6759, Test: 529.1944 [322.97], Avg: 496.0692 (0.395)
Ep: 309, Reward: 530.8169, Test: 459.9401 [209.28], Avg: 495.2775 (0.394)
Ep: 310, Reward: 524.3691, Test: 581.5919 [216.21], Avg: 494.8599 (0.393)
Ep: 311, Reward: 533.5039, Test: 579.0323 [198.93], Avg: 494.4920 (0.392)
Ep: 312, Reward: 521.2342, Test: 674.9802 [216.44], Avg: 494.3772 (0.390)
Ep: 313, Reward: 640.3341, Test: 614.9030 [207.94], Avg: 494.0988 (0.389)
Ep: 314, Reward: 611.2985, Test: 576.4078 [181.05], Avg: 493.7853 (0.388)
Ep: 315, Reward: 689.6775, Test: 500.9301 [272.15], Avg: 492.9467 (0.387)
Ep: 316, Reward: 554.7412, Test: 568.6914 [219.93], Avg: 492.4918 (0.386)
Ep: 317, Reward: 643.0991, Test: 535.3267 [288.18], Avg: 491.7203 (0.385)
Ep: 318, Reward: 666.1740, Test: 617.4477 [189.15], Avg: 491.5215 (0.383)
Ep: 319, Reward: 541.8355, Test: 614.1561 [237.90], Avg: 491.1613 (0.382)
Ep: 320, Reward: 560.3967, Test: 591.2644 [231.01], Avg: 490.7535 (0.381)
Ep: 321, Reward: 574.8810, Test: 654.0006 [203.86], Avg: 490.6274 (0.380)
Ep: 322, Reward: 567.2251, Test: 621.1569 [260.87], Avg: 490.2239 (0.379)
Ep: 323, Reward: 569.1397, Test: 663.4751 [226.75], Avg: 490.0587 (0.378)
Ep: 324, Reward: 748.6968, Test: 655.9158 [199.19], Avg: 489.9562 (0.377)
Ep: 325, Reward: 745.2120, Test: 428.8103 [278.05], Avg: 488.9157 (0.376)
Ep: 326, Reward: 703.7085, Test: 491.3069 [216.17], Avg: 488.2619 (0.374)
Ep: 327, Reward: 630.3252, Test: 517.9567 [178.58], Avg: 487.8080 (0.373)
Ep: 328, Reward: 618.5365, Test: 777.1373 [147.60], Avg: 488.2388 (0.372)
Ep: 329, Reward: 609.1085, Test: 674.4229 [244.59], Avg: 488.0618 (0.371)
Ep: 330, Reward: 663.7291, Test: 398.1283 [197.66], Avg: 487.1929 (0.370)
Ep: 331, Reward: 658.8233, Test: 553.9444 [261.16], Avg: 486.6074 (0.369)
Ep: 332, Reward: 633.5826, Test: 642.8149 [199.48], Avg: 486.4774 (0.368)
Ep: 333, Reward: 617.0064, Test: 810.3977 [155.43], Avg: 486.9819 (0.367)
Ep: 334, Reward: 665.9707, Test: 511.3315 [279.58], Avg: 486.2200 (0.365)
Ep: 335, Reward: 583.6730, Test: 803.5922 [88.92], Avg: 486.9000 (0.364)
Ep: 336, Reward: 634.1797, Test: 641.3795 [190.62], Avg: 486.7927 (0.363)
Ep: 337, Reward: 610.3635, Test: 695.1358 [231.93], Avg: 486.7229 (0.362)
Ep: 338, Reward: 731.3762, Test: 503.3570 [267.74], Avg: 485.9822 (0.361)
Ep: 339, Reward: 702.3484, Test: 643.6512 [280.47], Avg: 485.6210 (0.360)
Ep: 340, Reward: 607.6441, Test: 568.4014 [230.01], Avg: 485.1892 (0.359)
Ep: 341, Reward: 689.2323, Test: 528.8364 [309.17], Avg: 484.4129 (0.358)
Ep: 342, Reward: 704.7611, Test: 757.1030 [188.11], Avg: 484.6595 (0.357)
Ep: 343, Reward: 695.4105, Test: 607.2828 [271.98], Avg: 484.2253 (0.356)
Ep: 344, Reward: 707.3196, Test: 494.5808 [234.71], Avg: 483.5750 (0.355)
Ep: 345, Reward: 576.5760, Test: 575.7173 [255.56], Avg: 483.1027 (0.354)
Ep: 346, Reward: 487.3178, Test: 656.6745 [173.80], Avg: 483.1020 (0.353)
Ep: 347, Reward: 602.1703, Test: 667.0964 [173.98], Avg: 483.1308 (0.351)
Ep: 348, Reward: 640.6802, Test: 524.6191 [250.81], Avg: 482.5310 (0.350)
Ep: 349, Reward: 634.7207, Test: 511.6937 [227.58], Avg: 481.9641 (0.349)
Ep: 350, Reward: 613.8528, Test: 593.4748 [280.51], Avg: 481.4826 (0.348)
Ep: 351, Reward: 582.4644, Test: 565.9526 [266.44], Avg: 480.9656 (0.347)
Ep: 352, Reward: 631.8412, Test: 577.8727 [288.24], Avg: 480.4236 (0.346)
Ep: 353, Reward: 578.2823, Test: 551.4788 [183.38], Avg: 480.1063 (0.345)
Ep: 354, Reward: 616.6648, Test: 631.7899 [303.06], Avg: 479.6799 (0.344)
Ep: 355, Reward: 551.4744, Test: 632.0409 [157.43], Avg: 479.6657 (0.343)
Ep: 356, Reward: 650.5357, Test: 734.3147 [174.54], Avg: 479.8901 (0.342)
Ep: 357, Reward: 519.7528, Test: 661.5807 [260.50], Avg: 479.6699 (0.341)
Ep: 358, Reward: 543.2803, Test: 469.8086 [283.69], Avg: 478.8522 (0.340)
Ep: 359, Reward: 553.2983, Test: 498.4243 [254.48], Avg: 478.1997 (0.339)
Ep: 360, Reward: 569.1710, Test: 522.2716 [265.39], Avg: 477.5866 (0.338)
Ep: 361, Reward: 602.4877, Test: 558.0134 [266.55], Avg: 477.0725 (0.337)
Ep: 362, Reward: 585.0007, Test: 758.3188 [188.74], Avg: 477.3273 (0.336)
Ep: 363, Reward: 576.9205, Test: 686.7937 [240.81], Avg: 477.2412 (0.335)
Ep: 364, Reward: 713.3863, Test: 521.6886 [311.93], Avg: 476.5084 (0.334)
Ep: 365, Reward: 626.2665, Test: 628.0659 [166.60], Avg: 476.4673 (0.333)
Ep: 366, Reward: 524.7743, Test: 669.0578 [216.45], Avg: 476.4023 (0.332)
Ep: 367, Reward: 665.7275, Test: 604.6451 [249.81], Avg: 476.0719 (0.331)
Ep: 368, Reward: 667.0056, Test: 491.3912 [275.63], Avg: 475.3665 (0.330)
Ep: 369, Reward: 590.3582, Test: 693.9962 [212.71], Avg: 475.3825 (0.329)
Ep: 370, Reward: 762.8039, Test: 604.3502 [309.18], Avg: 474.8967 (0.328)
Ep: 371, Reward: 577.7553, Test: 584.7979 [232.30], Avg: 474.5677 (0.327)
Ep: 372, Reward: 626.3140, Test: 657.7658 [191.84], Avg: 474.5445 (0.326)
Ep: 373, Reward: 675.0302, Test: 596.4950 [263.46], Avg: 474.1662 (0.325)
Ep: 374, Reward: 636.7491, Test: 689.5290 [212.05], Avg: 474.1750 (0.324)
Ep: 375, Reward: 529.4005, Test: 743.6206 [203.68], Avg: 474.3499 (0.323)
Ep: 376, Reward: 589.0068, Test: 581.8395 [260.25], Avg: 473.9447 (0.322)
Ep: 377, Reward: 703.8259, Test: 734.7882 [236.22], Avg: 474.0098 (0.321)
Ep: 378, Reward: 625.4371, Test: 731.2297 [186.00], Avg: 474.1977 (0.320)
Ep: 379, Reward: 634.4265, Test: 602.2384 [226.66], Avg: 473.9382 (0.319)
Ep: 380, Reward: 592.1811, Test: 677.6150 [172.22], Avg: 474.0208 (0.318)
Ep: 381, Reward: 594.8808, Test: 655.7286 [227.00], Avg: 473.9022 (0.317)
Ep: 382, Reward: 603.7036, Test: 729.9074 [185.12], Avg: 474.0873 (0.316)
Ep: 383, Reward: 748.5057, Test: 649.4183 [223.13], Avg: 473.9628 (0.315)
Ep: 384, Reward: 708.8957, Test: 708.9408 [201.41], Avg: 474.0500 (0.315)
Ep: 385, Reward: 727.9652, Test: 715.2272 [175.75], Avg: 474.2195 (0.314)
Ep: 386, Reward: 713.0786, Test: 740.9363 [199.55], Avg: 474.3930 (0.313)
Ep: 387, Reward: 739.5667, Test: 675.6576 [273.58], Avg: 474.2067 (0.312)
Ep: 388, Reward: 596.1908, Test: 649.4393 [232.77], Avg: 474.0588 (0.311)
Ep: 389, Reward: 813.7471, Test: 681.3676 [193.30], Avg: 474.0947 (0.310)
Ep: 390, Reward: 751.1251, Test: 766.6016 [131.14], Avg: 474.5074 (0.309)
Ep: 391, Reward: 687.7661, Test: 653.4158 [199.99], Avg: 474.4536 (0.308)
Ep: 392, Reward: 641.6957, Test: 713.4992 [165.52], Avg: 474.6407 (0.307)
Ep: 393, Reward: 714.5111, Test: 606.3383 [319.92], Avg: 474.1630 (0.306)
Ep: 394, Reward: 636.4516, Test: 589.3395 [251.03], Avg: 473.8190 (0.305)
Ep: 395, Reward: 760.8557, Test: 714.5635 [242.27], Avg: 473.8152 (0.304)
Ep: 396, Reward: 652.3512, Test: 605.5981 [193.85], Avg: 473.6589 (0.303)
Ep: 397, Reward: 701.8333, Test: 779.5553 [170.20], Avg: 473.9998 (0.302)
Ep: 398, Reward: 735.6303, Test: 782.6078 [143.44], Avg: 474.4138 (0.302)
Ep: 399, Reward: 771.8496, Test: 794.0988 [95.04], Avg: 474.9754 (0.301)
Ep: 400, Reward: 675.9445, Test: 805.7069 [107.67], Avg: 475.5316 (0.300)
Ep: 401, Reward: 755.7858, Test: 784.6471 [132.44], Avg: 475.9711 (0.299)
Ep: 402, Reward: 721.7146, Test: 725.4183 [134.53], Avg: 476.2563 (0.298)
Ep: 403, Reward: 691.6666, Test: 820.8439 [112.91], Avg: 476.8298 (0.297)
Ep: 404, Reward: 773.3607, Test: 650.0289 [276.83], Avg: 476.5739 (0.296)
Ep: 405, Reward: 670.3358, Test: 679.8586 [160.92], Avg: 476.6782 (0.295)
Ep: 406, Reward: 781.0727, Test: 693.5671 [214.48], Avg: 476.6841 (0.294)
Ep: 407, Reward: 699.7276, Test: 660.5402 [220.26], Avg: 476.5949 (0.294)
Ep: 408, Reward: 714.4132, Test: 671.7189 [182.56], Avg: 476.6256 (0.293)
Ep: 409, Reward: 640.3997, Test: 584.4102 [258.27], Avg: 476.2586 (0.292)
Ep: 410, Reward: 817.6564, Test: 648.7984 [184.11], Avg: 476.2304 (0.291)
Ep: 411, Reward: 879.2609, Test: 872.3304 [53.81], Avg: 477.0612 (0.290)
Ep: 412, Reward: 729.7623, Test: 655.7555 [131.43], Avg: 477.1757 (0.289)
Ep: 413, Reward: 686.0473, Test: 780.0192 [151.38], Avg: 477.5415 (0.288)
Ep: 414, Reward: 734.8834, Test: 711.2375 [218.87], Avg: 477.5773 (0.287)
Ep: 415, Reward: 754.8951, Test: 686.5739 [231.31], Avg: 477.5236 (0.287)
Ep: 416, Reward: 712.9827, Test: 702.5378 [199.83], Avg: 477.5840 (0.286)
Ep: 417, Reward: 715.1388, Test: 588.2966 [254.01], Avg: 477.2412 (0.285)
Ep: 418, Reward: 798.6986, Test: 584.2298 [266.76], Avg: 476.8599 (0.284)
Ep: 419, Reward: 688.5475, Test: 642.8237 [303.04], Avg: 476.5335 (0.283)
Ep: 420, Reward: 705.3040, Test: 732.2840 [209.82], Avg: 476.6427 (0.282)
Ep: 421, Reward: 757.8924, Test: 710.3621 [127.85], Avg: 476.8935 (0.281)
Ep: 422, Reward: 754.5290, Test: 679.0899 [135.55], Avg: 477.0511 (0.281)
Ep: 423, Reward: 711.2693, Test: 707.2729 [174.72], Avg: 477.1820 (0.280)
Ep: 424, Reward: 621.5601, Test: 695.0715 [203.77], Avg: 477.2152 (0.279)
Ep: 425, Reward: 708.6815, Test: 663.8113 [282.32], Avg: 476.9905 (0.278)
Ep: 426, Reward: 652.0060, Test: 729.1276 [172.03], Avg: 477.1781 (0.277)
Ep: 427, Reward: 717.1387, Test: 709.8423 [183.59], Avg: 477.2928 (0.276)
Ep: 428, Reward: 691.3262, Test: 730.1838 [214.13], Avg: 477.3831 (0.276)
Ep: 429, Reward: 703.0679, Test: 741.9761 [250.33], Avg: 477.4163 (0.275)
Ep: 430, Reward: 740.9831, Test: 809.3057 [154.82], Avg: 477.8271 (0.274)
Ep: 431, Reward: 686.9757, Test: 661.5419 [202.67], Avg: 477.7832 (0.273)
Ep: 432, Reward: 730.4104, Test: 712.8408 [190.01], Avg: 477.8873 (0.272)
Ep: 433, Reward: 803.8612, Test: 766.9830 [207.44], Avg: 478.0754 (0.271)
Ep: 434, Reward: 794.4955, Test: 751.4170 [256.30], Avg: 478.1146 (0.271)
Ep: 435, Reward: 750.9546, Test: 679.2016 [221.23], Avg: 478.0684 (0.270)
Ep: 436, Reward: 795.5995, Test: 535.0694 [215.89], Avg: 477.7048 (0.269)
Ep: 437, Reward: 715.9180, Test: 561.9904 [192.10], Avg: 477.4587 (0.268)
Ep: 438, Reward: 610.5744, Test: 609.3910 [246.72], Avg: 477.1972 (0.267)
Ep: 439, Reward: 734.3806, Test: 618.8527 [286.72], Avg: 476.8675 (0.267)
Ep: 440, Reward: 757.5993, Test: 642.0444 [225.20], Avg: 476.7314 (0.266)
Ep: 441, Reward: 623.6360, Test: 711.0405 [168.90], Avg: 476.8793 (0.265)
Ep: 442, Reward: 770.2138, Test: 791.0214 [137.55], Avg: 477.2780 (0.264)
Ep: 443, Reward: 607.2176, Test: 844.2660 [96.81], Avg: 477.8865 (0.263)
Ep: 444, Reward: 710.4810, Test: 719.1136 [222.45], Avg: 477.9287 (0.263)
Ep: 445, Reward: 726.5354, Test: 656.9813 [186.76], Avg: 477.9114 (0.262)
Ep: 446, Reward: 784.1642, Test: 802.2014 [169.82], Avg: 478.2570 (0.261)
Ep: 447, Reward: 731.8423, Test: 593.7157 [166.47], Avg: 478.1431 (0.260)
Ep: 448, Reward: 717.3332, Test: 767.9538 [162.53], Avg: 478.4266 (0.259)
Ep: 449, Reward: 635.3243, Test: 651.7431 [215.54], Avg: 478.3327 (0.259)
Ep: 450, Reward: 759.7700, Test: 755.8420 [151.56], Avg: 478.6120 (0.258)
Ep: 451, Reward: 849.8395, Test: 708.2545 [234.03], Avg: 478.6023 (0.257)
Ep: 452, Reward: 694.9167, Test: 776.2106 [189.67], Avg: 478.8406 (0.256)
Ep: 453, Reward: 734.1865, Test: 789.7700 [152.72], Avg: 479.1891 (0.256)
Ep: 454, Reward: 752.0568, Test: 727.5484 [176.09], Avg: 479.3479 (0.255)
Ep: 455, Reward: 799.8931, Test: 736.6353 [243.54], Avg: 479.3780 (0.254)
Ep: 456, Reward: 749.0960, Test: 776.1854 [134.65], Avg: 479.7329 (0.253)
Ep: 457, Reward: 716.5300, Test: 777.3072 [208.26], Avg: 479.9279 (0.253)
Ep: 458, Reward: 832.5021, Test: 669.5741 [205.94], Avg: 479.8924 (0.252)
Ep: 459, Reward: 714.8602, Test: 726.1775 [289.09], Avg: 479.7993 (0.251)
Ep: 460, Reward: 788.1166, Test: 663.0041 [253.65], Avg: 479.6465 (0.250)
Ep: 461, Reward: 647.4953, Test: 685.3678 [236.53], Avg: 479.5798 (0.250)
Ep: 462, Reward: 771.6102, Test: 783.0470 [154.26], Avg: 479.9021 (0.249)
Ep: 463, Reward: 762.6186, Test: 713.4183 [252.91], Avg: 479.8603 (0.248)
Ep: 464, Reward: 673.8618, Test: 796.4476 [183.19], Avg: 480.1472 (0.247)
Ep: 465, Reward: 783.6027, Test: 773.3411 [168.69], Avg: 480.4144 (0.247)
Ep: 466, Reward: 736.7533, Test: 765.9983 [197.55], Avg: 480.6029 (0.246)
Ep: 467, Reward: 769.0811, Test: 782.4220 [176.24], Avg: 480.8712 (0.245)
Ep: 468, Reward: 726.2260, Test: 781.8411 [146.75], Avg: 481.2000 (0.244)
Ep: 469, Reward: 855.9622, Test: 687.6888 [164.53], Avg: 481.2893 (0.244)
Ep: 470, Reward: 828.3095, Test: 795.8642 [219.21], Avg: 481.4918 (0.243)
Ep: 471, Reward: 795.6982, Test: 764.3957 [244.81], Avg: 481.5725 (0.242)
Ep: 472, Reward: 794.3265, Test: 746.5160 [159.38], Avg: 481.7957 (0.241)
Ep: 473, Reward: 749.6365, Test: 738.2599 [204.04], Avg: 481.9063 (0.241)
Ep: 474, Reward: 823.7942, Test: 779.1046 [140.62], Avg: 482.2359 (0.240)
Ep: 475, Reward: 724.2266, Test: 686.5625 [255.53], Avg: 482.1283 (0.239)
Ep: 476, Reward: 796.0594, Test: 710.1641 [207.93], Avg: 482.1705 (0.239)
Ep: 477, Reward: 733.8522, Test: 751.5991 [188.96], Avg: 482.3389 (0.238)
Ep: 478, Reward: 755.9529, Test: 730.1632 [253.46], Avg: 482.3271 (0.237)
Ep: 479, Reward: 787.5139, Test: 686.0106 [160.95], Avg: 482.4161 (0.236)
Ep: 480, Reward: 767.0514, Test: 791.7676 [184.00], Avg: 482.6767 (0.236)
Ep: 481, Reward: 741.5563, Test: 787.7152 [158.75], Avg: 482.9802 (0.235)
Ep: 482, Reward: 685.8979, Test: 757.0261 [219.68], Avg: 483.0928 (0.234)
Ep: 483, Reward: 782.1193, Test: 720.3361 [267.74], Avg: 483.0298 (0.234)
Ep: 484, Reward: 683.2443, Test: 690.0588 [232.92], Avg: 482.9764 (0.233)
Ep: 485, Reward: 757.6648, Test: 709.2078 [233.93], Avg: 482.9606 (0.232)
Ep: 486, Reward: 753.5489, Test: 741.5962 [196.67], Avg: 483.0878 (0.231)
Ep: 487, Reward: 786.6337, Test: 802.9227 [140.56], Avg: 483.4552 (0.231)
Ep: 488, Reward: 754.2359, Test: 788.7712 [178.31], Avg: 483.7149 (0.230)
Ep: 489, Reward: 672.9558, Test: 781.4638 [164.29], Avg: 483.9873 (0.229)
Ep: 490, Reward: 716.7000, Test: 766.6258 [193.85], Avg: 484.1681 (0.229)
Ep: 491, Reward: 761.8504, Test: 723.8377 [188.41], Avg: 484.2723 (0.228)
Ep: 492, Reward: 753.7874, Test: 771.4300 [136.04], Avg: 484.5788 (0.227)
Ep: 493, Reward: 727.3985, Test: 761.8331 [203.70], Avg: 484.7277 (0.227)
Ep: 494, Reward: 733.8901, Test: 774.1483 [194.59], Avg: 484.9193 (0.226)
Ep: 495, Reward: 896.7413, Test: 676.1607 [230.85], Avg: 484.8394 (0.225)
Ep: 496, Reward: 845.4429, Test: 793.4434 [199.44], Avg: 485.0591 (0.225)
Ep: 497, Reward: 734.3471, Test: 837.2191 [109.57], Avg: 485.5462 (0.224)
Ep: 498, Reward: 875.4946, Test: 753.3335 [154.88], Avg: 485.7725 (0.223)
Ep: 499, Reward: 729.7159, Test: 878.7486 [28.99], Avg: 486.5004 (0.223)
