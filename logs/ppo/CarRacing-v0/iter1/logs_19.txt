Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.2                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 4					# Number of samples to train on for each train step
PPO_EPOCHS = 4					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.005				# The limit of the ratio of new action probabilities to old probabilities
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 40					# The number of steps to collect experience in sequence for each GAE calculation
ADVANTAGE_DECAY = 0.99			# The discount factor for the cumulative GAE calculation

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			value = self.critic_local(state.to(self.device))
			return value

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) + critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)
		self.replay_buffer = PrioritizedReplayBuffer()
		self.ppo_epochs = PPO_EPOCHS
		self.ppo_batch = BATCH_SIZE

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**0.0)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(self.ppo_epochs):
				for i in range(0, len(self.replay_buffer), self.ppo_batch):
					state, action, log_prob, target, advantage = self.replay_buffer.index(self.ppo_batch, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=self.ppo_batch*self.ppo_epochs*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.997			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -48.1707, Test: -28.6104 [7.43], Avg: -36.0374 (0.997)
Ep: 1, Reward: -48.3132, Test: -25.0847 [8.53], Avg: -34.8251 (0.994)
Ep: 2, Reward: -45.1902, Test: -25.4640 [8.67], Avg: -34.5947 (0.991)
Ep: 3, Reward: -45.1882, Test: -26.7181 [8.48], Avg: -34.7454 (0.988)
Ep: 4, Reward: -44.5024, Test: -28.9803 [8.28], Avg: -35.2477 (0.985)
Ep: 5, Reward: -44.4763, Test: -21.7223 [9.79], Avg: -34.6252 (0.982)
Ep: 6, Reward: -44.1404, Test: -29.5449 [6.08], Avg: -34.7674 (0.979)
Ep: 7, Reward: -41.8155, Test: -24.0327 [17.24], Avg: -35.5810 (0.976)
Ep: 8, Reward: -41.7051, Test: -15.5627 [20.36], Avg: -35.6194 (0.973)
Ep: 9, Reward: -38.8650, Test: -16.5051 [20.28], Avg: -35.7362 (0.970)
Ep: 10, Reward: -34.5307, Test: -21.2024 [15.41], Avg: -35.8161 (0.967)
Ep: 11, Reward: -33.3492, Test: -19.3887 [22.22], Avg: -36.2989 (0.965)
Ep: 12, Reward: -35.3320, Test: -30.2584 [4.97], Avg: -36.2162 (0.962)
Ep: 13, Reward: -36.4933, Test: -25.3324 [16.41], Avg: -36.6112 (0.959)
Ep: 14, Reward: -35.4894, Test: -25.2596 [17.22], Avg: -37.0026 (0.956)
Ep: 15, Reward: -34.8790, Test: 0.6334 [25.47], Avg: -36.2423 (0.953)
Ep: 16, Reward: -31.4632, Test: -27.4336 [3.98], Avg: -35.9584 (0.950)
Ep: 17, Reward: -26.0474, Test: -14.8933 [31.98], Avg: -36.5651 (0.947)
Ep: 18, Reward: -27.5337, Test: -4.9714 [25.16], Avg: -36.2262 (0.945)
Ep: 19, Reward: -27.5607, Test: -1.2802 [37.37], Avg: -36.3476 (0.942)
Ep: 20, Reward: -26.4095, Test: 1.5800 [39.08], Avg: -36.4024 (0.939)
Ep: 21, Reward: -24.0090, Test: -14.3038 [31.32], Avg: -36.8217 (0.936)
Ep: 22, Reward: -31.5215, Test: -10.3129 [31.43], Avg: -37.0356 (0.933)
Ep: 23, Reward: -27.6579, Test: -29.6803 [36.04], Avg: -38.2309 (0.930)
Ep: 24, Reward: -33.0299, Test: -10.0955 [25.40], Avg: -38.1214 (0.928)
Ep: 25, Reward: -28.6795, Test: -28.4655 [19.46], Avg: -38.4985 (0.925)
Ep: 26, Reward: -41.2747, Test: -24.7537 [43.41], Avg: -39.5974 (0.922)
Ep: 27, Reward: -32.4337, Test: -51.1746 [36.99], Avg: -41.3319 (0.919)
Ep: 28, Reward: -50.0418, Test: -35.5104 [12.52], Avg: -41.5628 (0.917)
Ep: 29, Reward: -47.4075, Test: -27.6898 [14.85], Avg: -41.5953 (0.914)
Ep: 30, Reward: -43.5284, Test: -36.1343 [23.18], Avg: -42.1668 (0.911)
Ep: 31, Reward: -43.5859, Test: -49.2490 [15.62], Avg: -42.8763 (0.908)
Ep: 32, Reward: -52.6889, Test: -78.4337 [3.12], Avg: -44.0483 (0.906)
Ep: 33, Reward: -41.4574, Test: -73.2692 [4.10], Avg: -45.0284 (0.903)
Ep: 34, Reward: -30.6074, Test: -69.9280 [4.47], Avg: -45.8674 (0.900)
Ep: 35, Reward: -38.8865, Test: -78.2799 [2.62], Avg: -46.8405 (0.897)
Ep: 36, Reward: -40.8112, Test: -77.2332 [1.94], Avg: -47.7143 (0.895)
Ep: 37, Reward: -22.9133, Test: -76.2710 [2.81], Avg: -48.5398 (0.892)
Ep: 38, Reward: -37.5953, Test: -32.8883 [45.89], Avg: -49.3151 (0.889)
Ep: 39, Reward: -39.5182, Test: -74.0778 [4.76], Avg: -50.0533 (0.887)
Ep: 40, Reward: -39.8371, Test: -48.9163 [35.66], Avg: -50.8953 (0.884)
Ep: 41, Reward: -45.3122, Test: 4.2962 [79.80], Avg: -51.4811 (0.881)
Ep: 42, Reward: -22.3094, Test: 43.1131 [100.62], Avg: -51.6212 (0.879)
Ep: 43, Reward: -19.1725, Test: 17.9174 [107.54], Avg: -52.4849 (0.876)
Ep: 44, Reward: -12.3724, Test: -31.1128 [55.90], Avg: -53.2521 (0.874)
Ep: 45, Reward: -2.1982, Test: -41.3421 [25.25], Avg: -53.5422 (0.871)
Ep: 46, Reward: -5.4368, Test: -17.1404 [55.57], Avg: -53.9500 (0.868)
Ep: 47, Reward: -11.9600, Test: -27.1259 [49.87], Avg: -54.4301 (0.866)
Ep: 48, Reward: -29.3064, Test: -3.7577 [42.11], Avg: -54.2553 (0.863)
Ep: 49, Reward: -7.7949, Test: -7.1844 [35.77], Avg: -54.0292 (0.861)
Ep: 50, Reward: -3.1803, Test: 68.0547 [74.27], Avg: -53.0917 (0.858)
Ep: 51, Reward: 18.4398, Test: 40.7324 [69.96], Avg: -52.6328 (0.855)
Ep: 52, Reward: -4.2026, Test: 59.0067 [78.39], Avg: -52.0054 (0.853)
Ep: 53, Reward: -25.7898, Test: 110.2855 [82.95], Avg: -50.5361 (0.850)
Ep: 54, Reward: 7.2269, Test: 95.9409 [77.26], Avg: -49.2775 (0.848)
Ep: 55, Reward: 31.4267, Test: 126.9731 [58.95], Avg: -47.1829 (0.845)
Ep: 56, Reward: 49.0978, Test: 113.7641 [72.51], Avg: -45.6314 (0.843)
Ep: 57, Reward: 43.8841, Test: 117.8351 [82.32], Avg: -44.2323 (0.840)
Ep: 58, Reward: -5.7615, Test: 61.6759 [64.26], Avg: -43.5264 (0.838)
Ep: 59, Reward: 94.2785, Test: 142.8013 [88.63], Avg: -41.8981 (0.835)
Ep: 60, Reward: 113.4570, Test: 78.1823 [98.25], Avg: -41.5402 (0.833)
Ep: 61, Reward: 209.5655, Test: 108.8106 [85.62], Avg: -40.4961 (0.830)
Ep: 62, Reward: 264.5257, Test: 77.1878 [80.08], Avg: -39.8992 (0.828)
Ep: 63, Reward: 256.5200, Test: 45.8984 [57.31], Avg: -39.4542 (0.825)
Ep: 64, Reward: 325.2153, Test: 91.9488 [96.43], Avg: -38.9161 (0.823)
Ep: 65, Reward: 360.3736, Test: 66.7461 [57.45], Avg: -38.1856 (0.820)
Ep: 66, Reward: 361.4198, Test: 97.7538 [79.12], Avg: -37.3376 (0.818)
Ep: 67, Reward: 357.2809, Test: 103.5023 [91.39], Avg: -36.6104 (0.815)
Ep: 68, Reward: 383.4366, Test: 50.5008 [78.61], Avg: -36.4872 (0.813)
Ep: 69, Reward: 360.6686, Test: 86.0765 [92.57], Avg: -36.0587 (0.810)
Ep: 70, Reward: 464.0532, Test: 154.7776 [87.06], Avg: -34.5971 (0.808)
Ep: 71, Reward: 456.1841, Test: 114.2427 [66.95], Avg: -33.4598 (0.805)
Ep: 72, Reward: 413.8403, Test: 169.8845 [74.82], Avg: -31.6992 (0.803)
Ep: 73, Reward: 459.7537, Test: 162.5419 [80.65], Avg: -30.1642 (0.801)
Ep: 74, Reward: 456.1194, Test: 110.6412 [74.28], Avg: -29.2772 (0.798)
Ep: 75, Reward: 508.2115, Test: 172.6305 [51.82], Avg: -27.3023 (0.796)
Ep: 76, Reward: 443.5017, Test: 117.7922 [90.07], Avg: -26.5877 (0.793)
Ep: 77, Reward: 462.3092, Test: 138.3738 [74.94], Avg: -25.4336 (0.791)
Ep: 78, Reward: 422.0893, Test: 176.7082 [73.60], Avg: -23.8065 (0.789)
Ep: 79, Reward: 482.3983, Test: 156.0016 [65.47], Avg: -22.3773 (0.786)
Ep: 80, Reward: 441.7958, Test: 156.9220 [87.46], Avg: -21.2434 (0.784)
Ep: 81, Reward: 346.3745, Test: 151.0456 [68.39], Avg: -19.9764 (0.782)
Ep: 82, Reward: 507.0727, Test: 170.4237 [78.58], Avg: -18.6291 (0.779)
Ep: 83, Reward: 423.3758, Test: 162.3761 [76.06], Avg: -17.3798 (0.777)
Ep: 84, Reward: 444.3243, Test: 170.7885 [76.68], Avg: -16.0682 (0.775)
Ep: 85, Reward: 406.8317, Test: 182.9713 [84.83], Avg: -14.7402 (0.772)
Ep: 86, Reward: 528.9663, Test: 191.8160 [50.31], Avg: -12.9442 (0.770)
Ep: 87, Reward: 406.2787, Test: 172.2432 [85.73], Avg: -11.8141 (0.768)
Ep: 88, Reward: 406.3638, Test: 160.2042 [93.56], Avg: -10.9325 (0.765)
Ep: 89, Reward: 550.0467, Test: 163.7184 [89.42], Avg: -9.9855 (0.763)
Ep: 90, Reward: 409.0857, Test: 206.8584 [102.68], Avg: -8.7310 (0.761)
Ep: 91, Reward: 463.8449, Test: 210.8301 [80.50], Avg: -7.2195 (0.758)
Ep: 92, Reward: 378.0292, Test: 179.3811 [74.75], Avg: -6.0168 (0.756)
Ep: 93, Reward: 282.8049, Test: 197.7949 [76.51], Avg: -4.6625 (0.754)
Ep: 94, Reward: 307.7550, Test: 176.2657 [86.46], Avg: -3.6681 (0.752)
Ep: 95, Reward: 315.3896, Test: 217.9078 [46.39], Avg: -1.8432 (0.749)
Ep: 96, Reward: 385.6027, Test: 130.8933 [79.66], Avg: -1.2960 (0.747)
Ep: 97, Reward: 251.3095, Test: 182.6744 [74.39], Avg: -0.1778 (0.745)
Ep: 98, Reward: 333.4015, Test: 170.8633 [89.49], Avg: 0.6459 (0.743)
Ep: 99, Reward: 277.1539, Test: 120.3387 [88.27], Avg: 0.9601 (0.740)
Ep: 100, Reward: 226.5143, Test: 176.0448 [80.27], Avg: 1.8989 (0.738)
Ep: 101, Reward: 210.6757, Test: 99.6164 [87.72], Avg: 1.9969 (0.736)
Ep: 102, Reward: 229.7609, Test: 157.9097 [104.10], Avg: 2.4999 (0.734)
Ep: 103, Reward: 217.3809, Test: 163.4596 [89.22], Avg: 3.1897 (0.732)
Ep: 104, Reward: 228.0066, Test: 176.0773 [70.62], Avg: 4.1637 (0.729)
Ep: 105, Reward: 267.7216, Test: 256.8395 [96.45], Avg: 5.6375 (0.727)
Ep: 106, Reward: 227.0351, Test: 191.4753 [97.10], Avg: 6.4668 (0.725)
Ep: 107, Reward: 254.3675, Test: 216.9217 [85.99], Avg: 7.6193 (0.723)
Ep: 108, Reward: 259.0786, Test: 229.7949 [76.58], Avg: 8.9550 (0.721)
Ep: 109, Reward: 183.7547, Test: 180.2088 [80.96], Avg: 9.7758 (0.719)
Ep: 110, Reward: 228.6401, Test: 141.4467 [103.63], Avg: 10.0284 (0.716)
Ep: 111, Reward: 226.8071, Test: 155.9692 [80.08], Avg: 10.6165 (0.714)
Ep: 112, Reward: 229.0174, Test: 141.8168 [112.05], Avg: 10.7860 (0.712)
Ep: 113, Reward: 248.0233, Test: 121.8826 [89.30], Avg: 10.9772 (0.710)
Ep: 114, Reward: 219.5626, Test: 193.3396 [64.31], Avg: 12.0038 (0.708)
Ep: 115, Reward: 276.4082, Test: 171.5942 [43.39], Avg: 13.0055 (0.706)
Ep: 116, Reward: 181.5040, Test: 188.2807 [91.47], Avg: 13.7218 (0.704)
Ep: 117, Reward: 270.8379, Test: 241.2698 [90.54], Avg: 14.8829 (0.702)
Ep: 118, Reward: 218.7913, Test: 209.5011 [82.35], Avg: 15.8263 (0.699)
Ep: 119, Reward: 308.7098, Test: 194.0457 [91.09], Avg: 16.5524 (0.697)
Ep: 120, Reward: 264.2536, Test: 178.3985 [81.47], Avg: 17.2166 (0.695)
Ep: 121, Reward: 212.6983, Test: 211.9791 [87.45], Avg: 18.0962 (0.693)
Ep: 122, Reward: 247.5587, Test: 198.9428 [70.51], Avg: 18.9933 (0.691)
Ep: 123, Reward: 283.2995, Test: 185.3447 [95.58], Avg: 19.5641 (0.689)
Ep: 124, Reward: 222.3820, Test: 127.5860 [76.39], Avg: 19.8171 (0.687)
Ep: 125, Reward: 237.8958, Test: 185.3203 [86.62], Avg: 20.4432 (0.685)
Ep: 126, Reward: 290.5099, Test: 241.2120 [29.31], Avg: 21.9508 (0.683)
Ep: 127, Reward: 230.3490, Test: 229.3344 [113.01], Avg: 22.6880 (0.681)
Ep: 128, Reward: 248.7066, Test: 205.6127 [102.05], Avg: 23.3150 (0.679)
Ep: 129, Reward: 288.4181, Test: 177.3949 [118.91], Avg: 23.5855 (0.677)
Ep: 130, Reward: 286.2407, Test: 203.1115 [106.04], Avg: 24.1465 (0.675)
Ep: 131, Reward: 292.5089, Test: 211.9814 [75.84], Avg: 24.9950 (0.673)
Ep: 132, Reward: 286.9939, Test: 202.1296 [65.25], Avg: 25.8362 (0.671)
Ep: 133, Reward: 230.9840, Test: 211.4862 [67.88], Avg: 26.7151 (0.669)
Ep: 134, Reward: 252.4112, Test: 203.3018 [95.34], Avg: 27.3169 (0.667)
Ep: 135, Reward: 256.5985, Test: 186.0367 [98.81], Avg: 27.7575 (0.665)
Ep: 136, Reward: 227.0889, Test: 208.8505 [116.95], Avg: 28.2256 (0.663)
Ep: 137, Reward: 210.2364, Test: 238.6596 [82.46], Avg: 29.1530 (0.661)
Ep: 138, Reward: 200.2680, Test: 258.1664 [81.57], Avg: 30.2137 (0.659)
Ep: 139, Reward: 281.0849, Test: 223.7225 [62.98], Avg: 31.1460 (0.657)
Ep: 140, Reward: 229.7616, Test: 208.8921 [111.51], Avg: 31.6158 (0.655)
Ep: 141, Reward: 283.8148, Test: 220.6175 [103.98], Avg: 32.2145 (0.653)
Ep: 142, Reward: 281.2325, Test: 177.5726 [121.65], Avg: 32.3803 (0.651)
Ep: 143, Reward: 243.7517, Test: 198.2695 [101.41], Avg: 32.8281 (0.649)
Ep: 144, Reward: 253.0050, Test: 183.4534 [105.03], Avg: 33.1426 (0.647)
Ep: 145, Reward: 261.8178, Test: 122.7663 [118.17], Avg: 32.9470 (0.645)
Ep: 146, Reward: 263.6896, Test: 207.2046 [119.23], Avg: 33.3214 (0.643)
Ep: 147, Reward: 365.2577, Test: 255.0395 [112.13], Avg: 34.0619 (0.641)
Ep: 148, Reward: 329.0949, Test: 227.0863 [82.23], Avg: 34.8054 (0.639)
Ep: 149, Reward: 285.3943, Test: 203.7105 [93.23], Avg: 35.3100 (0.637)
Ep: 150, Reward: 275.0740, Test: 256.4274 [88.95], Avg: 36.1853 (0.635)
Ep: 151, Reward: 292.7685, Test: 211.1354 [123.73], Avg: 36.5222 (0.633)
Ep: 152, Reward: 275.7012, Test: 159.1237 [103.23], Avg: 36.6488 (0.631)
Ep: 153, Reward: 270.3590, Test: 236.4687 [160.70], Avg: 36.9028 (0.630)
Ep: 154, Reward: 267.7228, Test: 249.7503 [62.89], Avg: 37.8703 (0.628)
Ep: 155, Reward: 272.5557, Test: 181.1380 [122.75], Avg: 38.0018 (0.626)
Ep: 156, Reward: 234.5090, Test: 224.2631 [108.57], Avg: 38.4967 (0.624)
Ep: 157, Reward: 255.6227, Test: 260.2884 [127.18], Avg: 39.0955 (0.622)
Ep: 158, Reward: 251.4363, Test: 237.4906 [85.80], Avg: 39.8037 (0.620)
Ep: 159, Reward: 240.0121, Test: 230.1743 [103.53], Avg: 40.3464 (0.618)
Ep: 160, Reward: 290.8333, Test: 224.4170 [66.56], Avg: 41.0763 (0.616)
Ep: 161, Reward: 266.3937, Test: 219.1339 [106.41], Avg: 41.5186 (0.615)
Ep: 162, Reward: 310.0936, Test: 167.1654 [108.96], Avg: 41.6209 (0.613)
Ep: 163, Reward: 270.3487, Test: 221.5502 [119.07], Avg: 41.9920 (0.611)
Ep: 164, Reward: 233.7770, Test: 311.6767 [156.37], Avg: 42.6787 (0.609)
Ep: 165, Reward: 320.1240, Test: 171.0712 [75.32], Avg: 42.9984 (0.607)
Ep: 166, Reward: 292.3968, Test: 243.9079 [149.17], Avg: 43.3083 (0.605)
Ep: 167, Reward: 255.0134, Test: 211.9320 [122.75], Avg: 43.5813 (0.604)
Ep: 168, Reward: 298.3700, Test: 176.2841 [106.92], Avg: 43.7339 (0.602)
Ep: 169, Reward: 247.5455, Test: 177.9137 [148.46], Avg: 43.6499 (0.600)
Ep: 170, Reward: 326.7047, Test: 136.7781 [138.40], Avg: 43.3851 (0.598)
Ep: 171, Reward: 295.0978, Test: 181.1982 [96.40], Avg: 43.6259 (0.596)
Ep: 172, Reward: 298.5944, Test: 176.0223 [100.39], Avg: 43.8109 (0.595)
Ep: 173, Reward: 241.4849, Test: 285.0731 [58.81], Avg: 44.8595 (0.593)
Ep: 174, Reward: 286.0504, Test: 269.3979 [65.23], Avg: 45.7698 (0.591)
Ep: 175, Reward: 305.8533, Test: 248.0503 [126.65], Avg: 46.1995 (0.589)
Ep: 176, Reward: 269.3927, Test: 189.2578 [149.80], Avg: 46.1614 (0.588)
Ep: 177, Reward: 282.0821, Test: 191.3034 [138.92], Avg: 46.1964 (0.586)
Ep: 178, Reward: 294.7022, Test: 214.1743 [171.78], Avg: 46.1751 (0.584)
Ep: 179, Reward: 280.7424, Test: 207.3306 [66.52], Avg: 46.7009 (0.582)
Ep: 180, Reward: 213.2512, Test: 178.7619 [85.32], Avg: 46.9591 (0.581)
Ep: 181, Reward: 239.0166, Test: 231.6448 [101.05], Avg: 47.4187 (0.579)
Ep: 182, Reward: 272.3206, Test: 258.9515 [108.94], Avg: 47.9793 (0.577)
Ep: 183, Reward: 319.9434, Test: 211.6453 [116.83], Avg: 48.2339 (0.575)
Ep: 184, Reward: 265.0464, Test: 167.5243 [124.03], Avg: 48.2082 (0.574)
Ep: 185, Reward: 244.6000, Test: 180.9040 [122.71], Avg: 48.2619 (0.572)
Ep: 186, Reward: 297.6962, Test: 206.3948 [157.30], Avg: 48.2664 (0.570)
Ep: 187, Reward: 278.4116, Test: 212.8872 [114.46], Avg: 48.5332 (0.568)
Ep: 188, Reward: 289.3709, Test: 236.7630 [71.17], Avg: 49.1526 (0.567)
Ep: 189, Reward: 336.4735, Test: 215.4619 [126.03], Avg: 49.3646 (0.565)
Ep: 190, Reward: 324.7569, Test: 211.0047 [130.77], Avg: 49.5262 (0.563)
Ep: 191, Reward: 290.3583, Test: 239.0413 [115.45], Avg: 49.9119 (0.560)
Ep: 192, Reward: 282.2569, Test: 286.2319 [111.04], Avg: 50.5610 (0.558)
Ep: 193, Reward: 215.5825, Test: 212.4363 [117.76], Avg: 50.7885 (0.557)
Ep: 194, Reward: 266.1996, Test: 170.4867 [105.79], Avg: 50.8598 (0.555)
Ep: 195, Reward: 301.5811, Test: 274.5247 [91.99], Avg: 51.5316 (0.553)
Ep: 196, Reward: 252.7974, Test: 196.6992 [112.12], Avg: 51.6994 (0.552)
Ep: 197, Reward: 284.3309, Test: 284.8763 [70.45], Avg: 52.5213 (0.550)
Ep: 198, Reward: 320.1494, Test: 227.7007 [104.30], Avg: 52.8774 (0.548)
Ep: 199, Reward: 238.1520, Test: 257.3740 [100.38], Avg: 53.3980 (0.547)
Ep: 200, Reward: 254.4663, Test: 210.1619 [144.14], Avg: 53.4608 (0.545)
Ep: 201, Reward: 244.2218, Test: 219.2188 [99.56], Avg: 53.7885 (0.543)
Ep: 202, Reward: 308.6731, Test: 204.1960 [118.54], Avg: 53.9455 (0.542)
Ep: 203, Reward: 254.0231, Test: 248.7543 [108.52], Avg: 54.3685 (0.540)
Ep: 204, Reward: 246.1561, Test: 163.2059 [89.98], Avg: 54.4605 (0.539)
Ep: 205, Reward: 268.0769, Test: 143.3155 [113.72], Avg: 54.3397 (0.537)
Ep: 206, Reward: 291.1609, Test: 206.2484 [106.99], Avg: 54.5567 (0.535)
Ep: 207, Reward: 284.9189, Test: 227.6375 [114.69], Avg: 54.8374 (0.534)
Ep: 208, Reward: 274.8771, Test: 264.1710 [96.76], Avg: 55.3761 (0.532)
Ep: 209, Reward: 265.6731, Test: 253.0770 [116.45], Avg: 55.7630 (0.530)
Ep: 210, Reward: 269.3349, Test: 285.5533 [55.43], Avg: 56.5893 (0.529)
Ep: 211, Reward: 259.9164, Test: 256.1881 [88.67], Avg: 57.1126 (0.527)
Ep: 212, Reward: 242.1939, Test: 179.9447 [99.49], Avg: 57.2221 (0.526)
Ep: 213, Reward: 270.8118, Test: 197.4286 [128.55], Avg: 57.2766 (0.524)
Ep: 214, Reward: 277.3205, Test: 239.8475 [80.84], Avg: 57.7498 (0.523)
Ep: 215, Reward: 237.4851, Test: 251.6152 [92.84], Avg: 58.2175 (0.521)
Ep: 216, Reward: 292.7160, Test: 231.8179 [115.22], Avg: 58.4865 (0.518)
Ep: 217, Reward: 259.5476, Test: 265.4327 [54.32], Avg: 59.1867 (0.516)
Ep: 218, Reward: 243.7145, Test: 217.1348 [89.43], Avg: 59.4995 (0.515)
Ep: 219, Reward: 312.8280, Test: 224.5274 [105.48], Avg: 59.7702 (0.513)
Ep: 220, Reward: 283.6516, Test: 284.8801 [52.98], Avg: 60.5491 (0.512)
Ep: 221, Reward: 274.1222, Test: 231.4981 [50.00], Avg: 61.0939 (0.510)
Ep: 222, Reward: 250.9670, Test: 274.5973 [38.07], Avg: 61.8806 (0.509)
Ep: 223, Reward: 243.4482, Test: 226.1735 [126.95], Avg: 62.0473 (0.507)
Ep: 224, Reward: 328.1659, Test: 265.6362 [88.41], Avg: 62.5592 (0.506)
Ep: 225, Reward: 302.1557, Test: 215.9762 [120.24], Avg: 62.7060 (0.504)
Ep: 226, Reward: 305.8423, Test: 212.0335 [108.84], Avg: 62.8843 (0.503)
Ep: 227, Reward: 282.8385, Test: 214.0834 [158.50], Avg: 62.8523 (0.501)
Ep: 228, Reward: 298.3031, Test: 235.8958 [132.43], Avg: 63.0297 (0.500)
Ep: 229, Reward: 283.0103, Test: 226.5115 [113.43], Avg: 63.2473 (0.498)
Ep: 230, Reward: 252.8173, Test: 210.9160 [94.30], Avg: 63.4783 (0.497)
Ep: 231, Reward: 283.7982, Test: 169.0927 [120.87], Avg: 63.4126 (0.495)
Ep: 232, Reward: 266.9399, Test: 255.9646 [82.26], Avg: 63.8859 (0.494)
Ep: 233, Reward: 316.3957, Test: 175.0554 [128.30], Avg: 63.8127 (0.492)
Ep: 234, Reward: 276.8343, Test: 263.8106 [129.57], Avg: 64.1124 (0.491)
Ep: 235, Reward: 309.0585, Test: 230.4063 [132.53], Avg: 64.2555 (0.489)
Ep: 236, Reward: 293.4854, Test: 199.5697 [95.61], Avg: 64.4230 (0.486)
Ep: 237, Reward: 276.5560, Test: 225.7082 [100.98], Avg: 64.6764 (0.485)
Ep: 238, Reward: 299.5438, Test: 223.3871 [107.83], Avg: 64.8893 (0.483)
Ep: 239, Reward: 260.7801, Test: 222.4743 [143.12], Avg: 64.9495 (0.482)
Ep: 240, Reward: 297.0788, Test: 218.8775 [108.92], Avg: 65.1363 (0.480)
Ep: 241, Reward: 262.2490, Test: 255.0820 [115.28], Avg: 65.4448 (0.479)
Ep: 242, Reward: 275.4149, Test: 189.2235 [140.57], Avg: 65.3758 (0.478)
Ep: 243, Reward: 290.8791, Test: 260.1372 [106.66], Avg: 65.7368 (0.476)
Ep: 244, Reward: 299.6355, Test: 257.7159 [169.04], Avg: 65.8304 (0.475)
Ep: 245, Reward: 270.4090, Test: 203.7088 [119.30], Avg: 65.9059 (0.473)
Ep: 246, Reward: 237.1830, Test: 273.7200 [95.38], Avg: 66.3611 (0.472)
Ep: 247, Reward: 318.4913, Test: 235.6091 [85.54], Avg: 66.6987 (0.470)
Ep: 248, Reward: 256.4375, Test: 277.4289 [73.95], Avg: 67.2480 (0.469)
Ep: 249, Reward: 255.7155, Test: 258.1384 [65.34], Avg: 67.7502 (0.466)
Ep: 250, Reward: 280.4693, Test: 205.1627 [120.72], Avg: 67.8167 (0.465)
Ep: 251, Reward: 345.2328, Test: 268.8442 [134.66], Avg: 68.0800 (0.463)
Ep: 252, Reward: 289.1786, Test: 287.3818 [39.73], Avg: 68.7898 (0.462)
Ep: 253, Reward: 312.4292, Test: 257.6329 [89.50], Avg: 69.1809 (0.461)
Ep: 254, Reward: 319.2683, Test: 240.4649 [129.89], Avg: 69.3432 (0.459)
Ep: 255, Reward: 313.4650, Test: 253.6524 [140.00], Avg: 69.5163 (0.458)
Ep: 256, Reward: 316.2811, Test: 181.6680 [105.59], Avg: 69.5419 (0.456)
Ep: 257, Reward: 301.0246, Test: 182.0469 [117.78], Avg: 69.5214 (0.455)
Ep: 258, Reward: 301.3274, Test: 228.6297 [84.15], Avg: 69.8109 (0.454)
Ep: 259, Reward: 279.7338, Test: 281.3531 [112.52], Avg: 70.1917 (0.451)
Ep: 260, Reward: 272.1190, Test: 210.0273 [141.74], Avg: 70.1845 (0.450)
Ep: 261, Reward: 222.2534, Test: 178.9982 [100.65], Avg: 70.2156 (0.448)
Ep: 262, Reward: 240.9033, Test: 223.7419 [101.55], Avg: 70.4132 (0.447)
Ep: 263, Reward: 255.4492, Test: 282.1874 [121.40], Avg: 70.7556 (0.446)
Ep: 264, Reward: 275.1742, Test: 220.8548 [94.37], Avg: 70.9659 (0.444)
Ep: 265, Reward: 256.9993, Test: 240.8089 [111.68], Avg: 71.1845 (0.443)
Ep: 266, Reward: 253.2001, Test: 109.8555 [80.66], Avg: 71.0273 (0.442)
Ep: 267, Reward: 287.6335, Test: 231.9382 [141.18], Avg: 71.1009 (0.440)
Ep: 268, Reward: 283.4897, Test: 222.8762 [104.21], Avg: 71.2777 (0.439)
Ep: 269, Reward: 251.4041, Test: 231.0314 [76.20], Avg: 71.5872 (0.438)
Ep: 270, Reward: 244.8938, Test: 260.7386 [121.12], Avg: 71.8382 (0.436)
Ep: 271, Reward: 298.4983, Test: 194.9289 [153.06], Avg: 71.7280 (0.435)
Ep: 272, Reward: 304.9724, Test: 222.1389 [141.15], Avg: 71.7620 (0.434)
Ep: 273, Reward: 269.1394, Test: 258.0799 [66.73], Avg: 72.1984 (0.432)
Ep: 274, Reward: 318.6915, Test: 293.0889 [91.57], Avg: 72.6687 (0.431)
Ep: 275, Reward: 283.5088, Test: 239.7513 [139.20], Avg: 72.7697 (0.430)
Ep: 276, Reward: 270.6637, Test: 278.8907 [138.92], Avg: 73.0123 (0.429)
Ep: 277, Reward: 233.8104, Test: 202.3861 [139.37], Avg: 72.9763 (0.427)
Ep: 278, Reward: 225.4625, Test: 213.2542 [120.49], Avg: 73.0472 (0.426)
Ep: 279, Reward: 271.8256, Test: 261.6191 [113.29], Avg: 73.3161 (0.425)
Ep: 280, Reward: 269.9703, Test: 167.5840 [157.01], Avg: 73.0928 (0.423)
Ep: 281, Reward: 295.7673, Test: 285.8139 [115.39], Avg: 73.4380 (0.421)
Ep: 282, Reward: 311.1101, Test: 327.7936 [50.21], Avg: 74.1593 (0.420)
Ep: 283, Reward: 317.1544, Test: 183.4742 [155.56], Avg: 73.9965 (0.418)
Ep: 284, Reward: 303.4109, Test: 154.8319 [106.82], Avg: 73.9053 (0.417)
Ep: 285, Reward: 258.5133, Test: 208.0170 [113.22], Avg: 73.9784 (0.416)
Ep: 286, Reward: 320.7927, Test: 249.1044 [126.45], Avg: 74.1480 (0.415)
Ep: 287, Reward: 328.5684, Test: 196.8591 [144.37], Avg: 74.0728 (0.413)
Ep: 288, Reward: 347.3228, Test: 253.3340 [114.14], Avg: 74.2981 (0.412)
Ep: 289, Reward: 321.4094, Test: 147.3453 [116.51], Avg: 74.1483 (0.410)
Ep: 290, Reward: 292.8922, Test: 178.0995 [131.92], Avg: 74.0521 (0.408)
Ep: 291, Reward: 326.3898, Test: 227.5305 [140.01], Avg: 74.0983 (0.407)
Ep: 292, Reward: 330.0603, Test: 191.0008 [173.43], Avg: 73.9053 (0.406)
Ep: 293, Reward: 266.2198, Test: 268.6777 [141.15], Avg: 74.0877 (0.405)
Ep: 294, Reward: 308.6101, Test: 186.2298 [162.09], Avg: 73.9184 (0.404)
Ep: 295, Reward: 313.8123, Test: 153.5794 [117.48], Avg: 73.7906 (0.401)
Ep: 296, Reward: 190.7685, Test: 129.1249 [126.92], Avg: 73.5496 (0.399)
Ep: 297, Reward: 253.8623, Test: 191.8309 [165.11], Avg: 73.3925 (0.396)
Ep: 298, Reward: 239.8147, Test: 217.1198 [115.52], Avg: 73.4868 (0.395)
Ep: 299, Reward: 266.6638, Test: 230.9399 [171.26], Avg: 73.4408 (0.394)
Ep: 300, Reward: 229.4978, Test: 204.3186 [148.28], Avg: 73.3830 (0.393)
Ep: 301, Reward: 350.7825, Test: 305.6580 [45.47], Avg: 74.0016 (0.392)
Ep: 302, Reward: 299.0404, Test: 276.6999 [75.58], Avg: 74.4211 (0.390)
Ep: 303, Reward: 295.9850, Test: 216.9802 [137.95], Avg: 74.4362 (0.389)
Ep: 304, Reward: 267.9285, Test: 270.4964 [60.38], Avg: 74.8811 (0.388)
Ep: 305, Reward: 258.4163, Test: 156.0571 [108.96], Avg: 74.7903 (0.387)
Ep: 306, Reward: 274.1742, Test: 182.8021 [118.10], Avg: 74.7574 (0.386)
Ep: 307, Reward: 279.4642, Test: 232.2099 [179.49], Avg: 74.6859 (0.385)
Ep: 308, Reward: 340.6578, Test: 243.4858 [91.69], Avg: 74.9354 (0.383)
Ep: 309, Reward: 301.2926, Test: 255.0533 [120.30], Avg: 75.1284 (0.382)
Ep: 310, Reward: 307.7916, Test: 266.1207 [127.45], Avg: 75.3327 (0.381)
Ep: 311, Reward: 320.0716, Test: 264.1041 [128.51], Avg: 75.5258 (0.380)
Ep: 312, Reward: 314.5004, Test: 173.9394 [122.87], Avg: 75.4477 (0.379)
Ep: 313, Reward: 313.6318, Test: 227.8711 [119.73], Avg: 75.5518 (0.378)
Ep: 314, Reward: 320.0668, Test: 239.2626 [131.87], Avg: 75.6529 (0.377)
Ep: 315, Reward: 279.1021, Test: 260.9850 [141.72], Avg: 75.7909 (0.376)
Ep: 316, Reward: 286.8114, Test: 257.0310 [132.19], Avg: 75.9457 (0.374)
Ep: 317, Reward: 273.5480, Test: 226.7720 [130.81], Avg: 76.0086 (0.373)
Ep: 318, Reward: 308.4693, Test: 260.1423 [111.22], Avg: 76.2372 (0.372)
Ep: 319, Reward: 315.3058, Test: 196.7897 [112.58], Avg: 76.2621 (0.371)
Ep: 320, Reward: 266.1513, Test: 258.4300 [92.84], Avg: 76.5403 (0.370)
Ep: 321, Reward: 301.4523, Test: 266.9612 [107.18], Avg: 76.7989 (0.369)
Ep: 322, Reward: 287.1018, Test: 202.5182 [133.13], Avg: 76.7759 (0.368)
Ep: 323, Reward: 320.4615, Test: 268.4669 [85.07], Avg: 77.1050 (0.367)
Ep: 324, Reward: 265.4493, Test: 205.7781 [121.54], Avg: 77.1269 (0.365)
Ep: 325, Reward: 290.0415, Test: 237.0918 [108.91], Avg: 77.2836 (0.364)
Ep: 326, Reward: 285.4672, Test: 225.6085 [102.63], Avg: 77.4233 (0.363)
Ep: 327, Reward: 265.1671, Test: 139.0201 [122.51], Avg: 77.2376 (0.362)
Ep: 328, Reward: 270.3347, Test: 261.4532 [85.64], Avg: 77.5372 (0.361)
Ep: 329, Reward: 272.8357, Test: 254.6382 [92.71], Avg: 77.7929 (0.360)
Ep: 330, Reward: 313.4349, Test: 195.0425 [88.13], Avg: 77.8809 (0.359)
Ep: 331, Reward: 317.5479, Test: 190.1148 [128.08], Avg: 77.8332 (0.358)
Ep: 332, Reward: 291.5633, Test: 185.8318 [113.36], Avg: 77.8171 (0.357)
Ep: 333, Reward: 307.7392, Test: 180.6410 [117.96], Avg: 77.7718 (0.356)
Ep: 334, Reward: 297.6252, Test: 249.8203 [82.18], Avg: 78.0400 (0.355)
Ep: 335, Reward: 268.4956, Test: 254.9699 [57.52], Avg: 78.3954 (0.353)
Ep: 336, Reward: 263.9235, Test: 206.8026 [117.72], Avg: 78.4271 (0.351)
Ep: 337, Reward: 306.3193, Test: 170.8176 [114.16], Avg: 78.3627 (0.350)
Ep: 338, Reward: 276.7939, Test: 227.4698 [110.49], Avg: 78.4766 (0.349)
Ep: 339, Reward: 310.3715, Test: 161.8410 [107.75], Avg: 78.4049 (0.348)
Ep: 340, Reward: 353.4138, Test: 183.1043 [135.52], Avg: 78.3145 (0.347)
Ep: 341, Reward: 304.1163, Test: 246.7359 [108.77], Avg: 78.4890 (0.346)
Ep: 342, Reward: 273.4749, Test: 289.1709 [116.08], Avg: 78.7648 (0.345)
Ep: 343, Reward: 276.5313, Test: 201.9185 [114.55], Avg: 78.7898 (0.344)
Ep: 344, Reward: 291.5229, Test: 313.7714 [44.36], Avg: 79.3423 (0.343)
Ep: 345, Reward: 267.1874, Test: 279.6766 [123.64], Avg: 79.5640 (0.341)
Ep: 346, Reward: 254.4381, Test: 255.5760 [117.34], Avg: 79.7331 (0.340)
Ep: 347, Reward: 272.9287, Test: 235.8122 [127.39], Avg: 79.8155 (0.339)
Ep: 348, Reward: 295.4054, Test: 150.1322 [116.13], Avg: 79.6843 (0.338)
Ep: 349, Reward: 275.0813, Test: 307.0520 [78.41], Avg: 80.1099 (0.337)
Ep: 350, Reward: 290.1177, Test: 318.6834 [108.08], Avg: 80.4816 (0.336)
Ep: 351, Reward: 310.0418, Test: 250.6678 [82.14], Avg: 80.7318 (0.335)
Ep: 352, Reward: 307.8284, Test: 180.3515 [148.77], Avg: 80.5925 (0.334)
Ep: 353, Reward: 261.0617, Test: 222.9183 [95.29], Avg: 80.7254 (0.333)
Ep: 354, Reward: 345.2039, Test: 297.7065 [110.92], Avg: 81.0242 (0.332)
Ep: 355, Reward: 270.0000, Test: 266.2607 [103.66], Avg: 81.2533 (0.331)
Ep: 356, Reward: 415.9277, Test: 176.8514 [117.89], Avg: 81.1909 (0.328)
Ep: 357, Reward: 315.3064, Test: 207.4724 [149.54], Avg: 81.1259 (0.327)
Ep: 358, Reward: 345.9052, Test: 252.4837 [130.93], Avg: 81.2385 (0.324)
Ep: 359, Reward: 335.1336, Test: 197.5895 [105.57], Avg: 81.2685 (0.323)
Ep: 360, Reward: 313.5551, Test: 255.8842 [143.01], Avg: 81.3560 (0.322)
Ep: 361, Reward: 285.3925, Test: 253.1644 [113.91], Avg: 81.5160 (0.321)
Ep: 362, Reward: 320.8126, Test: 236.3083 [106.24], Avg: 81.6497 (0.320)
Ep: 363, Reward: 349.1500, Test: 206.9244 [127.04], Avg: 81.6449 (0.319)
Ep: 364, Reward: 303.1129, Test: 259.4622 [107.81], Avg: 81.8367 (0.318)
Ep: 365, Reward: 304.8359, Test: 203.3520 [120.35], Avg: 81.8398 (0.317)
Ep: 366, Reward: 283.6101, Test: 280.5029 [108.33], Avg: 82.0860 (0.316)
Ep: 367, Reward: 287.0613, Test: 232.2249 [83.97], Avg: 82.2658 (0.315)
Ep: 368, Reward: 374.1617, Test: 303.3327 [64.74], Avg: 82.6894 (0.313)
Ep: 369, Reward: 314.2583, Test: 174.8497 [143.13], Avg: 82.5517 (0.312)
Ep: 370, Reward: 309.1116, Test: 236.7420 [137.80], Avg: 82.5958 (0.311)
Ep: 371, Reward: 295.6970, Test: 201.4855 [148.85], Avg: 82.5153 (0.310)
Ep: 372, Reward: 306.9507, Test: 292.4361 [63.69], Avg: 82.9073 (0.309)
Ep: 373, Reward: 301.1471, Test: 206.3854 [164.89], Avg: 82.7966 (0.308)
Ep: 374, Reward: 321.2104, Test: 165.8418 [108.89], Avg: 82.7277 (0.307)
Ep: 375, Reward: 280.5189, Test: 160.4967 [116.76], Avg: 82.6240 (0.306)
Ep: 376, Reward: 321.1844, Test: 204.0549 [122.34], Avg: 82.6216 (0.305)
Ep: 377, Reward: 260.8267, Test: 155.6880 [127.15], Avg: 82.4785 (0.304)
Ep: 378, Reward: 291.9781, Test: 292.9299 [127.85], Avg: 82.6965 (0.303)
Ep: 379, Reward: 298.1347, Test: 216.7287 [152.38], Avg: 82.6482 (0.302)
Ep: 380, Reward: 296.9962, Test: 259.7535 [108.36], Avg: 82.8286 (0.302)
Ep: 381, Reward: 315.0028, Test: 261.6692 [92.43], Avg: 83.0548 (0.301)
Ep: 382, Reward: 318.9112, Test: 211.1137 [113.22], Avg: 83.0936 (0.299)
Ep: 383, Reward: 283.7958, Test: 326.4714 [115.15], Avg: 83.4275 (0.298)
Ep: 384, Reward: 286.9563, Test: 238.2743 [103.79], Avg: 83.5601 (0.297)
Ep: 385, Reward: 291.3913, Test: 259.3507 [147.05], Avg: 83.6345 (0.296)
Ep: 386, Reward: 323.0838, Test: 242.7622 [95.93], Avg: 83.7979 (0.295)
Ep: 387, Reward: 306.0427, Test: 251.7339 [149.57], Avg: 83.8452 (0.294)
Ep: 388, Reward: 298.7658, Test: 236.1635 [119.47], Avg: 83.9296 (0.294)
Ep: 389, Reward: 342.0694, Test: 166.4080 [139.21], Avg: 83.7842 (0.293)
Ep: 390, Reward: 340.8518, Test: 310.2782 [108.67], Avg: 84.0855 (0.292)
Ep: 391, Reward: 292.6811, Test: 227.9202 [94.86], Avg: 84.2104 (0.291)
Ep: 392, Reward: 307.0404, Test: 200.6397 [114.55], Avg: 84.2152 (0.290)
Ep: 393, Reward: 285.9622, Test: 247.1505 [107.94], Avg: 84.3548 (0.289)
Ep: 394, Reward: 324.2320, Test: 233.3349 [166.52], Avg: 84.3104 (0.288)
Ep: 395, Reward: 293.2180, Test: 200.6701 [103.39], Avg: 84.3431 (0.287)
Ep: 396, Reward: 307.6869, Test: 214.7595 [133.71], Avg: 84.3348 (0.287)
Ep: 397, Reward: 304.7364, Test: 108.1395 [126.57], Avg: 84.0766 (0.285)
Ep: 398, Reward: 269.6677, Test: 136.3921 [156.36], Avg: 83.8159 (0.284)
Ep: 399, Reward: 241.3606, Test: 141.1765 [168.40], Avg: 83.5383 (0.283)
Ep: 400, Reward: 243.1978, Test: 104.5378 [156.22], Avg: 83.2011 (0.281)
Ep: 401, Reward: 147.9983, Test: 39.2184 [89.99], Avg: 82.8678 (0.281)
Ep: 402, Reward: 99.1902, Test: 39.4868 [115.14], Avg: 82.4744 (0.280)
Ep: 403, Reward: 129.7287, Test: 160.0084 [144.78], Avg: 82.3080 (0.279)
Ep: 404, Reward: 48.4621, Test: 61.1731 [123.98], Avg: 81.9497 (0.278)
Ep: 405, Reward: 109.4895, Test: 6.6933 [72.03], Avg: 81.5869 (0.277)
Ep: 406, Reward: 105.6893, Test: 23.8069 [88.59], Avg: 81.2273 (0.276)
Ep: 407, Reward: 63.0977, Test: 103.7835 [156.85], Avg: 80.8981 (0.276)
Ep: 408, Reward: 140.5042, Test: 89.5959 [127.33], Avg: 80.6081 (0.275)
Ep: 409, Reward: 125.6326, Test: 94.7463 [132.52], Avg: 80.3193 (0.274)
Ep: 410, Reward: 86.0306, Test: 97.4292 [150.38], Avg: 79.9951 (0.273)
Ep: 411, Reward: 148.5645, Test: 128.2836 [155.96], Avg: 79.7338 (0.272)
Ep: 412, Reward: 159.3809, Test: 133.4934 [131.12], Avg: 79.5465 (0.271)
Ep: 413, Reward: 131.3985, Test: 136.8137 [137.71], Avg: 79.3522 (0.271)
Ep: 414, Reward: 216.8855, Test: 221.6070 [135.50], Avg: 79.3684 (0.270)
Ep: 415, Reward: 198.5852, Test: 89.5682 [94.44], Avg: 79.1659 (0.269)
Ep: 416, Reward: 240.7840, Test: 145.9111 [110.72], Avg: 79.0605 (0.268)
Ep: 417, Reward: 288.9086, Test: 236.6227 [129.92], Avg: 79.1266 (0.267)
Ep: 418, Reward: 293.8113, Test: 206.4078 [106.22], Avg: 79.1769 (0.267)
Ep: 419, Reward: 316.1782, Test: 185.5267 [106.90], Avg: 79.1756 (0.266)
Ep: 420, Reward: 297.1690, Test: 263.5638 [86.80], Avg: 79.4074 (0.265)
Ep: 421, Reward: 265.2835, Test: 171.3469 [151.34], Avg: 79.2666 (0.263)
Ep: 422, Reward: 214.5099, Test: 252.4051 [86.31], Avg: 79.4719 (0.262)
Ep: 423, Reward: 257.0356, Test: 181.4054 [141.80], Avg: 79.3779 (0.261)
Ep: 424, Reward: 342.9406, Test: 222.0502 [127.82], Avg: 79.4128 (0.260)
Ep: 425, Reward: 273.5111, Test: 232.6852 [138.56], Avg: 79.4473 (0.259)
Ep: 426, Reward: 302.8599, Test: 236.9832 [109.75], Avg: 79.5593 (0.259)
Ep: 427, Reward: 310.4684, Test: 233.8546 [144.69], Avg: 79.5817 (0.258)
Ep: 428, Reward: 306.9522, Test: 263.1595 [84.28], Avg: 79.8132 (0.257)
Ep: 429, Reward: 338.9026, Test: 297.5186 [73.15], Avg: 80.1493 (0.256)
Ep: 430, Reward: 295.3080, Test: 234.8170 [131.70], Avg: 80.2026 (0.256)
Ep: 431, Reward: 319.4480, Test: 139.9463 [113.59], Avg: 80.0780 (0.255)
Ep: 432, Reward: 327.0430, Test: 261.8249 [128.04], Avg: 80.2020 (0.254)
Ep: 433, Reward: 340.8238, Test: 175.1414 [117.10], Avg: 80.1510 (0.252)
Ep: 434, Reward: 334.4487, Test: 296.0912 [62.96], Avg: 80.5026 (0.251)
Ep: 435, Reward: 355.8607, Test: 239.0979 [115.08], Avg: 80.6024 (0.250)
Ep: 436, Reward: 308.2452, Test: 225.9714 [133.74], Avg: 80.6291 (0.250)
Ep: 437, Reward: 302.5055, Test: 235.6937 [130.84], Avg: 80.6844 (0.249)
Ep: 438, Reward: 325.6584, Test: 248.4211 [159.03], Avg: 80.7042 (0.248)
Ep: 439, Reward: 301.3761, Test: 185.1082 [143.74], Avg: 80.6148 (0.247)
Ep: 440, Reward: 317.6610, Test: 285.3945 [102.68], Avg: 80.8463 (0.247)
Ep: 441, Reward: 317.1885, Test: 295.8734 [82.73], Avg: 81.1456 (0.246)
Ep: 442, Reward: 319.2081, Test: 234.5294 [136.54], Avg: 81.1837 (0.245)
Ep: 443, Reward: 307.3274, Test: 283.4361 [65.18], Avg: 81.4924 (0.244)
Ep: 444, Reward: 299.6635, Test: 173.2441 [125.36], Avg: 81.4169 (0.244)
Ep: 445, Reward: 294.8485, Test: 243.5807 [107.38], Avg: 81.5397 (0.243)
Ep: 446, Reward: 316.3706, Test: 277.8121 [122.91], Avg: 81.7038 (0.242)
Ep: 447, Reward: 301.5815, Test: 295.4874 [117.48], Avg: 81.9188 (0.241)
Ep: 448, Reward: 338.1836, Test: 225.1862 [146.02], Avg: 81.9126 (0.241)
Ep: 449, Reward: 280.9201, Test: 220.1247 [143.38], Avg: 81.9012 (0.239)
Ep: 450, Reward: 277.3530, Test: 229.5045 [78.03], Avg: 82.0554 (0.239)
Ep: 451, Reward: 324.2188, Test: 191.3444 [103.13], Avg: 82.0690 (0.238)
Ep: 452, Reward: 285.6625, Test: 211.7763 [153.38], Avg: 82.0168 (0.237)
Ep: 453, Reward: 277.7978, Test: 149.1960 [115.17], Avg: 81.9111 (0.236)
Ep: 454, Reward: 353.2769, Test: 262.7382 [128.49], Avg: 82.0261 (0.236)
Ep: 455, Reward: 297.7060, Test: 254.9040 [137.92], Avg: 82.1028 (0.235)
Ep: 456, Reward: 332.3954, Test: 228.8842 [114.36], Avg: 82.1737 (0.234)
Ep: 457, Reward: 317.0028, Test: 281.8022 [62.74], Avg: 82.4726 (0.234)
Ep: 458, Reward: 303.2566, Test: 255.7872 [129.61], Avg: 82.5678 (0.233)
Ep: 459, Reward: 308.7431, Test: 268.0291 [120.36], Avg: 82.7093 (0.232)
Ep: 460, Reward: 288.9327, Test: 272.8594 [76.24], Avg: 82.9564 (0.231)
Ep: 461, Reward: 307.1298, Test: 251.8512 [171.39], Avg: 82.9510 (0.231)
Ep: 462, Reward: 301.1364, Test: 248.2025 [81.98], Avg: 83.1309 (0.230)
Ep: 463, Reward: 318.2812, Test: 212.6344 [102.67], Avg: 83.1887 (0.229)
Ep: 464, Reward: 334.3333, Test: 225.7205 [114.32], Avg: 83.2494 (0.229)
Ep: 465, Reward: 272.7806, Test: 249.2017 [54.66], Avg: 83.4882 (0.228)
Ep: 466, Reward: 362.4894, Test: 257.7987 [160.63], Avg: 83.5175 (0.227)
Ep: 467, Reward: 310.4929, Test: 217.2377 [187.33], Avg: 83.4030 (0.227)
Ep: 468, Reward: 295.4941, Test: 279.8384 [109.87], Avg: 83.5875 (0.226)
Ep: 469, Reward: 344.2402, Test: 136.1233 [120.82], Avg: 83.4423 (0.225)
Ep: 470, Reward: 338.3774, Test: 236.7700 [117.06], Avg: 83.5193 (0.225)
Ep: 471, Reward: 326.0375, Test: 220.6595 [139.44], Avg: 83.5144 (0.224)
Ep: 472, Reward: 331.8843, Test: 200.7014 [123.31], Avg: 83.5014 (0.223)
Ep: 473, Reward: 331.3058, Test: 231.1686 [143.39], Avg: 83.5104 (0.223)
Ep: 474, Reward: 393.3390, Test: 296.3854 [86.98], Avg: 83.7755 (0.222)
Ep: 475, Reward: 333.5431, Test: 228.1926 [136.84], Avg: 83.7914 (0.221)
Ep: 476, Reward: 333.8540, Test: 252.6005 [95.20], Avg: 83.9457 (0.221)
Ep: 477, Reward: 321.5812, Test: 186.3035 [118.44], Avg: 83.9121 (0.220)
Ep: 478, Reward: 336.3578, Test: 269.6374 [165.76], Avg: 83.9537 (0.219)
Ep: 479, Reward: 276.0629, Test: 261.0553 [103.28], Avg: 84.1075 (0.219)
Ep: 480, Reward: 310.2792, Test: 280.7283 [117.19], Avg: 84.2727 (0.218)
Ep: 481, Reward: 287.3867, Test: 271.7374 [127.81], Avg: 84.3964 (0.217)
Ep: 482, Reward: 324.3543, Test: 170.1588 [150.59], Avg: 84.2622 (0.217)
Ep: 483, Reward: 269.9759, Test: 250.9621 [134.02], Avg: 84.3297 (0.216)
Ep: 484, Reward: 336.8032, Test: 208.0397 [120.12], Avg: 84.3371 (0.215)
Ep: 485, Reward: 335.9260, Test: 255.4710 [171.87], Avg: 84.3356 (0.214)
Ep: 486, Reward: 353.0700, Test: 224.7707 [112.24], Avg: 84.3935 (0.213)
Ep: 487, Reward: 302.6230, Test: 202.3946 [108.21], Avg: 84.4136 (0.213)
Ep: 488, Reward: 339.6448, Test: 290.2052 [140.57], Avg: 84.5470 (0.212)
Ep: 489, Reward: 306.0292, Test: 269.6224 [176.34], Avg: 84.5648 (0.212)
Ep: 490, Reward: 310.3247, Test: 260.3060 [102.80], Avg: 84.7134 (0.211)
Ep: 491, Reward: 260.9964, Test: 254.6508 [132.60], Avg: 84.7892 (0.210)
Ep: 492, Reward: 315.9500, Test: 252.2625 [131.20], Avg: 84.8628 (0.210)
Ep: 493, Reward: 306.6536, Test: 238.2484 [93.70], Avg: 84.9836 (0.209)
Ep: 494, Reward: 296.6552, Test: 254.0220 [126.61], Avg: 85.0694 (0.208)
Ep: 495, Reward: 304.2246, Test: 294.1260 [106.97], Avg: 85.2752 (0.208)
Ep: 496, Reward: 310.3342, Test: 202.3844 [151.17], Avg: 85.2067 (0.207)
Ep: 497, Reward: 312.1565, Test: 252.2369 [82.35], Avg: 85.3767 (0.207)
Ep: 498, Reward: 335.1632, Test: 220.5693 [140.84], Avg: 85.3654 (0.206)
Ep: 499, Reward: 330.0373, Test: 197.5275 [145.07], Avg: 85.2996 (0.205)
