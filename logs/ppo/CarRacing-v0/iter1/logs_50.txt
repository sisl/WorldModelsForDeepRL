Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.1				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((len(self.replay_buffer)*PPO_EPOCHS)//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=2*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -23.4043, Test: -41.0611 [11.23], Avg: -52.2935 (0.997)
Ep: 1, Reward: 17.8539, Test: 103.2498 [94.20], Avg: -21.6237 (0.994)
Ep: 2, Reward: 107.8985, Test: 25.5271 [85.97], Avg: -34.5618 (0.991)
Ep: 3, Reward: 142.1571, Test: 141.4219 [104.66], Avg: -16.7305 (0.988)
Ep: 4, Reward: 177.4002, Test: 128.9355 [124.15], Avg: -12.4273 (0.985)
Ep: 5, Reward: 294.1847, Test: 169.6823 [210.76], Avg: -17.2028 (0.982)
Ep: 6, Reward: 270.0001, Test: 412.5547 [256.16], Avg: 7.5973 (0.979)
Ep: 7, Reward: 190.3066, Test: 100.8577 [112.94], Avg: 5.1377 (0.976)
Ep: 8, Reward: 256.5245, Test: 311.8414 [177.06], Avg: 19.5431 (0.973)
Ep: 9, Reward: 480.8760, Test: 473.5137 [231.43], Avg: 41.7969 (0.970)
Ep: 10, Reward: 295.5572, Test: 103.9065 [125.65], Avg: 36.0208 (0.967)
Ep: 11, Reward: 221.1635, Test: 147.5270 [104.87], Avg: 36.5734 (0.965)
Ep: 12, Reward: 153.9508, Test: 312.7427 [177.43], Avg: 44.1685 (0.962)
Ep: 13, Reward: 333.1392, Test: 202.1178 [156.56], Avg: 44.2675 (0.959)
Ep: 14, Reward: 321.4049, Test: 249.7337 [87.56], Avg: 52.1278 (0.956)
Ep: 15, Reward: 264.5555, Test: 293.0976 [217.85], Avg: 53.5728 (0.953)
Ep: 16, Reward: 235.0994, Test: 176.7044 [175.50], Avg: 50.4926 (0.950)
Ep: 17, Reward: 189.0526, Test: 366.6794 [209.88], Avg: 56.3983 (0.947)
Ep: 18, Reward: 275.6320, Test: 354.7741 [266.74], Avg: 58.0634 (0.945)
Ep: 19, Reward: 559.6302, Test: 338.4610 [306.97], Avg: 56.7350 (0.942)
Ep: 20, Reward: 461.5446, Test: 344.0558 [222.38], Avg: 59.8273 (0.939)
Ep: 21, Reward: 348.4764, Test: 269.6225 [215.48], Avg: 59.5691 (0.936)
Ep: 22, Reward: 361.3598, Test: 634.5079 [227.40], Avg: 74.6795 (0.933)
Ep: 23, Reward: 588.8510, Test: 602.5019 [200.51], Avg: 88.3175 (0.930)
Ep: 24, Reward: 613.5762, Test: 500.4298 [253.86], Avg: 94.6476 (0.928)
Ep: 25, Reward: 481.4836, Test: 277.4245 [207.68], Avg: 93.6898 (0.925)
Ep: 26, Reward: 10.7967, Test: 178.3713 [44.88], Avg: 95.1640 (0.922)
Ep: 27, Reward: 431.3190, Test: 677.1658 [66.02], Avg: 113.5920 (0.919)
Ep: 28, Reward: 628.3298, Test: 429.0289 [95.06], Avg: 121.1911 (0.917)
Ep: 29, Reward: 508.5519, Test: 681.1808 [141.76], Avg: 135.1322 (0.914)
Ep: 30, Reward: 538.9320, Test: 631.7060 [111.85], Avg: 147.5426 (0.911)
Ep: 31, Reward: 475.3067, Test: 570.7148 [81.93], Avg: 158.2063 (0.908)
Ep: 32, Reward: 636.6728, Test: 712.9364 [62.30], Avg: 173.1284 (0.906)
Ep: 33, Reward: 489.8515, Test: 641.6862 [136.01], Avg: 182.9093 (0.903)
Ep: 34, Reward: 637.4371, Test: 526.7783 [146.60], Avg: 188.5456 (0.900)
Ep: 35, Reward: 479.5736, Test: 445.0022 [218.77], Avg: 189.5924 (0.897)
Ep: 36, Reward: 457.4260, Test: 494.3362 [176.32], Avg: 193.0632 (0.895)
Ep: 37, Reward: 335.6685, Test: 326.6754 [220.67], Avg: 190.7721 (0.892)
Ep: 38, Reward: 381.6741, Test: 591.8793 [206.81], Avg: 195.7539 (0.889)
Ep: 39, Reward: 589.1341, Test: 461.7555 [247.43], Avg: 196.2183 (0.887)
Ep: 40, Reward: 671.6139, Test: 494.1033 [194.51], Avg: 198.7396 (0.884)
Ep: 41, Reward: 589.7249, Test: 681.4664 [200.60], Avg: 205.4570 (0.881)
Ep: 42, Reward: 596.6529, Test: 601.2903 [162.18], Avg: 210.8908 (0.879)
Ep: 43, Reward: 390.1467, Test: 225.0627 [116.76], Avg: 208.5593 (0.876)
Ep: 44, Reward: 305.1943, Test: 243.1952 [153.02], Avg: 205.9286 (0.874)
Ep: 45, Reward: 394.4853, Test: 270.9943 [118.91], Avg: 204.7581 (0.871)
Ep: 46, Reward: 237.6115, Test: 279.2733 [127.77], Avg: 203.6250 (0.868)
Ep: 47, Reward: 301.4127, Test: 368.9403 [155.32], Avg: 203.8332 (0.866)
Ep: 48, Reward: 290.6968, Test: 262.0793 [190.16], Avg: 201.1411 (0.863)
Ep: 49, Reward: 340.5834, Test: 322.3573 [153.00], Avg: 200.5054 (0.861)
Ep: 50, Reward: 271.3984, Test: 271.7648 [203.11], Avg: 197.9201 (0.858)
Ep: 51, Reward: 372.0425, Test: 310.4498 [150.61], Avg: 197.1878 (0.855)
Ep: 52, Reward: 424.5361, Test: 225.3033 [55.66], Avg: 196.6681 (0.853)
Ep: 53, Reward: 389.0581, Test: 330.2401 [140.68], Avg: 196.5365 (0.850)
Ep: 54, Reward: 496.8968, Test: 526.0491 [255.51], Avg: 197.8820 (0.848)
Ep: 55, Reward: 405.6965, Test: 303.3645 [139.06], Avg: 197.2824 (0.845)
Ep: 56, Reward: 361.5554, Test: 287.2820 [164.61], Avg: 195.9733 (0.843)
Ep: 57, Reward: 407.1792, Test: 179.6090 [183.05], Avg: 192.5352 (0.840)
Ep: 58, Reward: 287.4374, Test: 393.5476 [134.53], Avg: 193.6620 (0.838)
Ep: 59, Reward: 383.8158, Test: 267.9506 [205.98], Avg: 191.4671 (0.835)
Ep: 60, Reward: 471.1914, Test: 455.6596 [200.88], Avg: 192.5051 (0.833)
Ep: 61, Reward: 520.7269, Test: 388.3109 [158.06], Avg: 193.1139 (0.830)
Ep: 62, Reward: 395.0658, Test: 301.2782 [184.27], Avg: 191.9059 (0.828)
Ep: 63, Reward: 439.6803, Test: 404.3185 [187.62], Avg: 192.2934 (0.825)
Ep: 64, Reward: 523.7456, Test: 413.4243 [233.34], Avg: 192.1056 (0.823)
Ep: 65, Reward: 585.3488, Test: 561.4324 [176.79], Avg: 195.0227 (0.820)
Ep: 66, Reward: 596.5621, Test: 469.5833 [252.22], Avg: 195.3561 (0.818)
Ep: 67, Reward: 664.8646, Test: 587.2596 [229.81], Avg: 197.7398 (0.815)
Ep: 68, Reward: 749.6017, Test: 685.1025 [226.59], Avg: 201.5192 (0.813)
Ep: 69, Reward: 685.4260, Test: 559.7494 [258.91], Avg: 202.9381 (0.810)
Ep: 70, Reward: 645.0763, Test: 697.3275 [149.48], Avg: 207.7959 (0.808)
Ep: 71, Reward: 701.8220, Test: 721.9824 [180.12], Avg: 212.4358 (0.805)
Ep: 72, Reward: 737.9913, Test: 573.9560 [236.49], Avg: 214.1485 (0.803)
Ep: 73, Reward: 652.0475, Test: 628.8597 [181.03], Avg: 217.3063 (0.801)
Ep: 74, Reward: 572.4782, Test: 593.6751 [206.59], Avg: 219.5700 (0.798)
Ep: 75, Reward: 526.5812, Test: 506.7910 [225.89], Avg: 220.3769 (0.796)
Ep: 76, Reward: 606.8442, Test: 719.6972 [156.70], Avg: 224.8265 (0.793)
Ep: 77, Reward: 551.6357, Test: 624.2780 [183.12], Avg: 227.6000 (0.791)
Ep: 78, Reward: 547.9425, Test: 332.0173 [201.60], Avg: 226.3698 (0.789)
Ep: 79, Reward: 532.8229, Test: 362.1308 [225.39], Avg: 225.2495 (0.786)
Ep: 80, Reward: 628.0829, Test: 442.3723 [279.15], Avg: 224.4837 (0.784)
Ep: 81, Reward: 659.2185, Test: 437.6311 [280.54], Avg: 223.6618 (0.782)
Ep: 82, Reward: 703.1583, Test: 650.0648 [333.56], Avg: 224.7805 (0.779)
Ep: 83, Reward: 655.1723, Test: 554.8058 [258.92], Avg: 225.6269 (0.777)
Ep: 84, Reward: 619.8884, Test: 521.2876 [335.01], Avg: 225.1640 (0.775)
Ep: 85, Reward: 714.0067, Test: 582.5350 [362.26], Avg: 225.1072 (0.772)
Ep: 86, Reward: 747.1551, Test: 562.9589 [359.52], Avg: 224.8581 (0.770)
Ep: 87, Reward: 592.2904, Test: 539.2169 [283.15], Avg: 225.2128 (0.768)
Ep: 88, Reward: 729.5079, Test: 719.0645 [234.43], Avg: 228.1277 (0.765)
Ep: 89, Reward: 757.1352, Test: 677.1927 [327.46], Avg: 229.4788 (0.763)
Ep: 90, Reward: 573.6304, Test: 436.5368 [314.28], Avg: 228.3006 (0.761)
Ep: 91, Reward: 550.9695, Test: 557.2475 [170.33], Avg: 230.0247 (0.758)
Ep: 92, Reward: 781.0383, Test: 531.1399 [256.43], Avg: 230.5051 (0.756)
Ep: 93, Reward: 566.7100, Test: 335.3677 [308.17], Avg: 228.3423 (0.754)
Ep: 94, Reward: 591.9349, Test: 447.8537 [197.12], Avg: 228.5780 (0.752)
Ep: 95, Reward: 510.2353, Test: 637.3538 [193.27], Avg: 230.8228 (0.749)
Ep: 96, Reward: 575.9784, Test: 463.1149 [188.18], Avg: 231.2776 (0.747)
Ep: 97, Reward: 537.2833, Test: 480.2072 [257.69], Avg: 231.1882 (0.745)
Ep: 98, Reward: 705.3150, Test: 480.7707 [299.28], Avg: 230.6862 (0.743)
Ep: 99, Reward: 517.1657, Test: 571.6409 [287.84], Avg: 231.2174 (0.740)
Ep: 100, Reward: 618.8274, Test: 571.6723 [237.52], Avg: 232.2365 (0.738)
Ep: 101, Reward: 551.4975, Test: 518.5083 [211.66], Avg: 232.9680 (0.736)
Ep: 102, Reward: 564.5793, Test: 321.0749 [235.60], Avg: 231.5360 (0.734)
Ep: 103, Reward: 664.5797, Test: 450.3521 [381.48], Avg: 229.9719 (0.732)
Ep: 104, Reward: 637.9380, Test: 525.3143 [264.41], Avg: 230.2666 (0.729)
Ep: 105, Reward: 596.8993, Test: 425.4091 [246.29], Avg: 229.7841 (0.727)
Ep: 106, Reward: 443.4232, Test: 352.5308 [193.41], Avg: 229.1237 (0.725)
Ep: 107, Reward: 421.6450, Test: 382.3277 [197.57], Avg: 228.7129 (0.723)
Ep: 108, Reward: 366.0445, Test: 387.3283 [268.37], Avg: 227.7060 (0.721)
Ep: 109, Reward: 562.7100, Test: 459.3671 [226.20], Avg: 227.7557 (0.719)
Ep: 110, Reward: 335.9744, Test: 332.3019 [189.88], Avg: 226.9869 (0.716)
Ep: 111, Reward: 257.3632, Test: 396.1560 [208.91], Avg: 226.6321 (0.714)
Ep: 112, Reward: 597.3417, Test: 522.3484 [148.28], Avg: 227.9369 (0.712)
Ep: 113, Reward: 338.6291, Test: 310.3362 [232.87], Avg: 226.6170 (0.710)
Ep: 114, Reward: 213.5503, Test: 156.5064 [112.78], Avg: 225.0266 (0.708)
Ep: 115, Reward: 286.8510, Test: 254.5499 [183.16], Avg: 223.7022 (0.706)
Ep: 116, Reward: 103.2443, Test: 59.8966 [104.82], Avg: 221.4062 (0.704)
Ep: 117, Reward: 37.3453, Test: -10.5333 [79.38], Avg: 218.7679 (0.702)
Ep: 118, Reward: 14.6658, Test: 180.0924 [97.86], Avg: 217.6205 (0.699)
Ep: 119, Reward: 59.4957, Test: 448.4283 [153.43], Avg: 218.2654 (0.697)
Ep: 120, Reward: 399.6695, Test: -41.8468 [45.09], Avg: 215.7431 (0.695)
Ep: 121, Reward: -48.2019, Test: -4.7020 [86.67], Avg: 213.2257 (0.693)
Ep: 122, Reward: -37.9921, Test: -60.9590 [53.48], Avg: 210.5617 (0.691)
Ep: 123, Reward: -57.8749, Test: -8.4676 [118.62], Avg: 207.8387 (0.689)
Ep: 124, Reward: -20.2105, Test: -14.7617 [40.55], Avg: 205.7335 (0.687)
Ep: 125, Reward: -15.9881, Test: 3.8749 [115.30], Avg: 203.2164 (0.685)
Ep: 126, Reward: 16.2655, Test: 96.9247 [145.81], Avg: 201.2313 (0.683)
Ep: 127, Reward: 29.9894, Test: 66.4154 [156.80], Avg: 198.9531 (0.681)
Ep: 128, Reward: 163.2592, Test: 122.9185 [127.89], Avg: 197.3723 (0.679)
Ep: 129, Reward: 476.3447, Test: 600.8177 [249.97], Avg: 198.5528 (0.677)
Ep: 130, Reward: 499.7442, Test: 683.7139 [270.25], Avg: 200.1934 (0.675)
Ep: 131, Reward: 654.1318, Test: 614.5461 [306.33], Avg: 201.0118 (0.673)
Ep: 132, Reward: 449.2380, Test: 746.8724 [178.48], Avg: 203.7741 (0.671)
Ep: 133, Reward: 495.9103, Test: 822.6007 [38.92], Avg: 208.1017 (0.669)
Ep: 134, Reward: 622.9881, Test: 614.4787 [283.02], Avg: 209.0155 (0.667)
Ep: 135, Reward: 636.7135, Test: 715.2416 [199.23], Avg: 211.2728 (0.665)
Ep: 136, Reward: 722.1163, Test: 548.0584 [244.75], Avg: 211.9446 (0.663)
Ep: 137, Reward: 544.5635, Test: 687.7854 [238.01], Avg: 213.6679 (0.661)
Ep: 138, Reward: 598.6487, Test: 734.0848 [188.41], Avg: 216.0565 (0.659)
Ep: 139, Reward: 688.9193, Test: 562.7055 [271.55], Avg: 216.5929 (0.657)
Ep: 140, Reward: 572.1534, Test: 789.7154 [165.08], Avg: 219.4868 (0.655)
Ep: 141, Reward: 696.2640, Test: 615.0305 [291.94], Avg: 220.2164 (0.653)
Ep: 142, Reward: 542.1723, Test: 561.0722 [222.76], Avg: 221.0423 (0.651)
Ep: 143, Reward: 664.4541, Test: 682.4181 [242.00], Avg: 222.5657 (0.649)
Ep: 144, Reward: 685.9990, Test: 714.7227 [134.76], Avg: 225.0305 (0.647)
Ep: 145, Reward: 580.0788, Test: 639.5920 [259.37], Avg: 226.0935 (0.645)
Ep: 146, Reward: 591.9095, Test: 464.9923 [319.86], Avg: 225.5427 (0.643)
Ep: 147, Reward: 672.8487, Test: 435.6543 [279.71], Avg: 225.0724 (0.641)
Ep: 148, Reward: 627.1564, Test: 563.3714 [244.00], Avg: 225.7053 (0.639)
Ep: 149, Reward: 612.2847, Test: 621.5154 [224.86], Avg: 226.8450 (0.637)
Ep: 150, Reward: 539.8884, Test: 624.2143 [124.89], Avg: 228.6495 (0.635)
Ep: 151, Reward: 734.4127, Test: 497.7155 [256.51], Avg: 228.7321 (0.633)
Ep: 152, Reward: 571.4082, Test: 566.0375 [333.91], Avg: 228.7543 (0.631)
Ep: 153, Reward: 492.7477, Test: 470.5700 [277.70], Avg: 228.5214 (0.630)
Ep: 154, Reward: 568.7843, Test: 420.9926 [207.51], Avg: 228.4243 (0.628)
Ep: 155, Reward: 593.9473, Test: 541.6430 [235.18], Avg: 228.9246 (0.626)
Ep: 156, Reward: 726.4242, Test: 586.6753 [265.57], Avg: 229.5117 (0.624)
Ep: 157, Reward: 655.2329, Test: 533.6965 [188.91], Avg: 230.2413 (0.622)
Ep: 158, Reward: 555.9300, Test: 460.0623 [219.41], Avg: 230.3068 (0.620)
Ep: 159, Reward: 615.5421, Test: 497.2742 [173.39], Avg: 230.8916 (0.618)
Ep: 160, Reward: 347.5679, Test: 426.4227 [176.45], Avg: 231.0101 (0.616)
Ep: 161, Reward: 460.2107, Test: 472.8320 [237.84], Avg: 231.0347 (0.615)
Ep: 162, Reward: 544.8411, Test: 437.8754 [264.48], Avg: 230.6811 (0.613)
Ep: 163, Reward: 508.3785, Test: 516.5464 [292.55], Avg: 230.6403 (0.611)
Ep: 164, Reward: 519.5312, Test: 314.0985 [179.91], Avg: 230.0557 (0.609)
Ep: 165, Reward: 587.3382, Test: 479.6430 [217.88], Avg: 230.2468 (0.607)
Ep: 166, Reward: 610.7973, Test: 555.1243 [257.33], Avg: 230.6512 (0.605)
Ep: 167, Reward: 655.2492, Test: 659.5241 [185.73], Avg: 232.0985 (0.604)
Ep: 168, Reward: 604.9125, Test: 672.6245 [291.18], Avg: 232.9822 (0.602)
Ep: 169, Reward: 610.9139, Test: 461.3107 [293.27], Avg: 232.6002 (0.600)
Ep: 170, Reward: 682.8627, Test: 738.6139 [166.72], Avg: 234.5843 (0.598)
Ep: 171, Reward: 640.3641, Test: 689.4642 [217.59], Avg: 235.9639 (0.596)
Ep: 172, Reward: 764.9196, Test: 716.6120 [222.85], Avg: 237.4541 (0.595)
Ep: 173, Reward: 801.5801, Test: 679.0221 [227.59], Avg: 238.6838 (0.593)
Ep: 174, Reward: 718.6569, Test: 657.8777 [244.03], Avg: 239.6848 (0.591)
Ep: 175, Reward: 675.5389, Test: 742.3767 [154.33], Avg: 241.6641 (0.589)
Ep: 176, Reward: 702.8155, Test: 764.1682 [109.55], Avg: 243.9972 (0.588)
Ep: 177, Reward: 819.3783, Test: 800.6604 [131.95], Avg: 246.3832 (0.586)
Ep: 178, Reward: 704.3368, Test: 739.0294 [205.87], Avg: 247.9853 (0.584)
Ep: 179, Reward: 783.6777, Test: 743.4213 [140.23], Avg: 249.9587 (0.582)
Ep: 180, Reward: 702.5555, Test: 744.2262 [172.66], Avg: 251.7355 (0.581)
Ep: 181, Reward: 747.0201, Test: 801.0269 [97.77], Avg: 254.2164 (0.579)
Ep: 182, Reward: 782.9222, Test: 753.1694 [138.09], Avg: 256.1884 (0.577)
Ep: 183, Reward: 672.3110, Test: 717.0941 [162.58], Avg: 257.8097 (0.575)
Ep: 184, Reward: 797.1221, Test: 672.2074 [271.54], Avg: 258.5819 (0.574)
Ep: 185, Reward: 631.3417, Test: 746.6892 [152.79], Avg: 260.3847 (0.572)
Ep: 186, Reward: 776.3235, Test: 692.5239 [187.63], Avg: 261.6922 (0.570)
Ep: 187, Reward: 736.9715, Test: 672.1077 [225.36], Avg: 262.6765 (0.568)
Ep: 188, Reward: 661.1891, Test: 419.1919 [310.29], Avg: 261.8629 (0.567)
Ep: 189, Reward: 735.0513, Test: 662.7247 [232.43], Avg: 262.7493 (0.565)
Ep: 190, Reward: 652.2130, Test: 798.5909 [95.01], Avg: 265.0574 (0.563)
Ep: 191, Reward: 710.4127, Test: 734.0224 [62.41], Avg: 267.1748 (0.562)
Ep: 192, Reward: 616.0861, Test: 608.6703 [203.26], Avg: 267.8911 (0.560)
Ep: 193, Reward: 752.5569, Test: 660.2930 [210.98], Avg: 268.8262 (0.558)
Ep: 194, Reward: 690.4111, Test: 661.2901 [246.28], Avg: 269.5759 (0.557)
Ep: 195, Reward: 655.6183, Test: 673.8661 [248.24], Avg: 270.3721 (0.555)
Ep: 196, Reward: 716.0695, Test: 688.5636 [237.91], Avg: 271.2872 (0.553)
Ep: 197, Reward: 699.4055, Test: 506.2384 [294.48], Avg: 270.9865 (0.552)
Ep: 198, Reward: 633.6899, Test: 563.5887 [196.84], Avg: 271.4678 (0.550)
Ep: 199, Reward: 563.6454, Test: 611.3630 [235.63], Avg: 271.9891 (0.548)
Ep: 200, Reward: 661.4150, Test: 642.1840 [196.20], Avg: 272.8548 (0.547)
Ep: 201, Reward: 662.0719, Test: 515.3312 [238.69], Avg: 272.8735 (0.545)
Ep: 202, Reward: 732.2434, Test: 613.2865 [272.41], Avg: 273.2085 (0.543)
Ep: 203, Reward: 617.1573, Test: 744.5960 [147.61], Avg: 274.7957 (0.542)
Ep: 204, Reward: 639.1757, Test: 780.2797 [100.21], Avg: 276.7726 (0.540)
Ep: 205, Reward: 569.2494, Test: 598.5977 [219.72], Avg: 277.2682 (0.539)
Ep: 206, Reward: 711.5840, Test: 662.2372 [197.66], Avg: 278.1731 (0.537)
Ep: 207, Reward: 671.1894, Test: 538.3175 [299.83], Avg: 277.9823 (0.535)
Ep: 208, Reward: 489.3473, Test: 570.9502 [195.69], Avg: 278.4478 (0.534)
Ep: 209, Reward: 578.8701, Test: 683.3087 [174.85], Avg: 279.5430 (0.532)
Ep: 210, Reward: 633.7526, Test: 625.7133 [253.41], Avg: 279.9827 (0.530)
Ep: 211, Reward: 566.5134, Test: 605.7155 [242.86], Avg: 280.3736 (0.529)
Ep: 212, Reward: 715.9416, Test: 666.0732 [186.50], Avg: 281.3088 (0.527)
Ep: 213, Reward: 668.7694, Test: 648.1912 [171.17], Avg: 282.2233 (0.526)
Ep: 214, Reward: 476.8632, Test: 684.7414 [176.37], Avg: 283.2752 (0.524)
Ep: 215, Reward: 610.6469, Test: 616.1554 [287.91], Avg: 283.4834 (0.523)
Ep: 216, Reward: 612.6239, Test: 605.2707 [209.74], Avg: 283.9997 (0.521)
Ep: 217, Reward: 665.0150, Test: 633.2922 [212.17], Avg: 284.6287 (0.519)
Ep: 218, Reward: 722.7060, Test: 589.9078 [244.04], Avg: 284.9084 (0.518)
Ep: 219, Reward: 677.5788, Test: 732.8277 [199.17], Avg: 286.0391 (0.516)
Ep: 220, Reward: 716.0091, Test: 678.4705 [123.00], Avg: 287.2582 (0.515)
Ep: 221, Reward: 637.4418, Test: 674.1749 [198.75], Avg: 288.1058 (0.513)
Ep: 222, Reward: 786.4798, Test: 658.4568 [285.92], Avg: 288.4844 (0.512)
Ep: 223, Reward: 748.2987, Test: 592.6154 [232.98], Avg: 288.8020 (0.510)
Ep: 224, Reward: 744.6246, Test: 805.4624 [147.19], Avg: 290.4441 (0.509)
Ep: 225, Reward: 782.7368, Test: 740.9757 [231.68], Avg: 291.4125 (0.507)
Ep: 226, Reward: 704.9379, Test: 700.5054 [238.45], Avg: 292.1642 (0.506)
Ep: 227, Reward: 857.7924, Test: 809.1507 [65.75], Avg: 294.1433 (0.504)
Ep: 228, Reward: 741.0271, Test: 697.4247 [270.26], Avg: 294.7242 (0.503)
Ep: 229, Reward: 732.4188, Test: 739.4088 [156.63], Avg: 295.9766 (0.501)
Ep: 230, Reward: 813.2612, Test: 704.6137 [222.98], Avg: 296.7803 (0.500)
Ep: 231, Reward: 799.3867, Test: 752.5574 [108.44], Avg: 298.2774 (0.498)
Ep: 232, Reward: 742.5950, Test: 652.8280 [298.36], Avg: 298.5186 (0.497)
Ep: 233, Reward: 758.7409, Test: 673.4711 [191.28], Avg: 299.3035 (0.495)
Ep: 234, Reward: 796.5564, Test: 794.8895 [107.80], Avg: 300.9537 (0.494)
Ep: 235, Reward: 778.3096, Test: 723.1252 [129.40], Avg: 302.1942 (0.492)
Ep: 236, Reward: 772.7706, Test: 702.7472 [181.59], Avg: 303.1181 (0.491)
Ep: 237, Reward: 758.8981, Test: 779.6722 [72.48], Avg: 304.8159 (0.489)
Ep: 238, Reward: 782.9678, Test: 733.5045 [217.05], Avg: 305.7014 (0.488)
Ep: 239, Reward: 774.0587, Test: 817.3065 [63.75], Avg: 307.5675 (0.486)
Ep: 240, Reward: 828.7973, Test: 806.3507 [80.68], Avg: 309.3023 (0.485)
Ep: 241, Reward: 785.6851, Test: 816.3999 [62.77], Avg: 311.1384 (0.483)
Ep: 242, Reward: 757.8903, Test: 706.7243 [160.57], Avg: 312.1055 (0.482)
Ep: 243, Reward: 751.6018, Test: 795.2354 [77.72], Avg: 313.7671 (0.480)
Ep: 244, Reward: 810.8042, Test: 771.5750 [91.99], Avg: 315.2602 (0.479)
Ep: 245, Reward: 699.6094, Test: 775.5771 [71.35], Avg: 316.8413 (0.478)
Ep: 246, Reward: 824.3016, Test: 670.6136 [272.90], Avg: 317.1688 (0.476)
Ep: 247, Reward: 772.9065, Test: 669.6770 [201.35], Avg: 317.7783 (0.475)
Ep: 248, Reward: 758.2057, Test: 730.6587 [206.00], Avg: 318.6091 (0.473)
Ep: 249, Reward: 701.6980, Test: 708.7421 [183.81], Avg: 319.4344 (0.472)
Ep: 250, Reward: 796.4375, Test: 720.0256 [165.94], Avg: 320.3693 (0.470)
Ep: 251, Reward: 778.5696, Test: 755.9292 [148.96], Avg: 321.5066 (0.469)
Ep: 252, Reward: 734.7168, Test: 809.1388 [85.40], Avg: 323.0965 (0.468)
Ep: 253, Reward: 690.1922, Test: 671.4963 [204.02], Avg: 323.6649 (0.466)
Ep: 254, Reward: 658.8854, Test: 723.9062 [132.90], Avg: 324.7133 (0.465)
Ep: 255, Reward: 768.7930, Test: 718.0127 [171.81], Avg: 325.5785 (0.463)
Ep: 256, Reward: 667.6307, Test: 750.1327 [139.19], Avg: 326.6889 (0.462)
Ep: 257, Reward: 743.5228, Test: 773.0164 [158.79], Avg: 327.8033 (0.461)
Ep: 258, Reward: 710.4701, Test: 787.2483 [97.45], Avg: 329.2010 (0.459)
Ep: 259, Reward: 700.5275, Test: 672.8940 [166.46], Avg: 329.8827 (0.458)
Ep: 260, Reward: 742.7263, Test: 764.5084 [123.49], Avg: 331.0748 (0.456)
Ep: 261, Reward: 784.7831, Test: 803.2796 [64.01], Avg: 332.6327 (0.455)
Ep: 262, Reward: 758.7581, Test: 630.3125 [255.28], Avg: 332.7939 (0.454)
Ep: 263, Reward: 779.7050, Test: 689.7397 [193.35], Avg: 333.4136 (0.452)
Ep: 264, Reward: 746.2666, Test: 614.9023 [191.79], Avg: 333.7521 (0.451)
Ep: 265, Reward: 698.9052, Test: 641.6985 [243.25], Avg: 333.9953 (0.450)
Ep: 266, Reward: 766.0287, Test: 676.5462 [226.11], Avg: 334.4314 (0.448)
Ep: 267, Reward: 701.4828, Test: 701.0400 [226.84], Avg: 334.9530 (0.447)
Ep: 268, Reward: 737.0777, Test: 744.8482 [154.09], Avg: 335.9039 (0.446)
Ep: 269, Reward: 764.2675, Test: 598.5916 [190.24], Avg: 336.1722 (0.444)
Ep: 270, Reward: 762.1763, Test: 780.7339 [94.09], Avg: 337.4654 (0.443)
Ep: 271, Reward: 734.7966, Test: 737.5639 [177.40], Avg: 338.2842 (0.442)
Ep: 272, Reward: 777.2803, Test: 759.6621 [110.95], Avg: 339.4213 (0.440)
Ep: 273, Reward: 659.8727, Test: 755.6053 [137.32], Avg: 340.4390 (0.439)
Ep: 274, Reward: 777.4712, Test: 811.7142 [55.40], Avg: 341.9513 (0.438)
Ep: 275, Reward: 806.3133, Test: 750.5810 [200.54], Avg: 342.7052 (0.436)
Ep: 276, Reward: 795.1372, Test: 651.4780 [218.75], Avg: 343.0302 (0.435)
Ep: 277, Reward: 730.6549, Test: 732.9235 [183.56], Avg: 343.7724 (0.434)
Ep: 278, Reward: 651.1887, Test: 721.1557 [82.60], Avg: 344.8290 (0.432)
Ep: 279, Reward: 643.7027, Test: 752.4935 [93.36], Avg: 345.9515 (0.431)
Ep: 280, Reward: 750.8308, Test: 726.3668 [131.48], Avg: 346.8374 (0.430)
Ep: 281, Reward: 784.8560, Test: 772.3903 [117.09], Avg: 347.9312 (0.429)
Ep: 282, Reward: 742.1650, Test: 772.8184 [170.27], Avg: 348.8309 (0.427)
Ep: 283, Reward: 721.3053, Test: 735.6620 [128.93], Avg: 349.7390 (0.426)
Ep: 284, Reward: 698.8749, Test: 784.4353 [68.59], Avg: 351.0236 (0.425)
Ep: 285, Reward: 796.9411, Test: 702.9993 [170.16], Avg: 351.6593 (0.423)
Ep: 286, Reward: 752.5992, Test: 726.8657 [112.90], Avg: 352.5733 (0.422)
Ep: 287, Reward: 753.1923, Test: 802.3955 [70.49], Avg: 353.8904 (0.421)
Ep: 288, Reward: 785.6261, Test: 720.6876 [190.31], Avg: 354.5011 (0.420)
Ep: 289, Reward: 733.3207, Test: 751.4131 [99.97], Avg: 355.5250 (0.418)
Ep: 290, Reward: 748.0322, Test: 754.3697 [162.31], Avg: 356.3379 (0.417)
Ep: 291, Reward: 765.1653, Test: 700.8067 [193.52], Avg: 356.8548 (0.416)
Ep: 292, Reward: 754.8160, Test: 859.4193 [30.36], Avg: 358.4664 (0.415)
Ep: 293, Reward: 778.4437, Test: 752.1555 [127.46], Avg: 359.3720 (0.413)
Ep: 294, Reward: 746.4966, Test: 709.8384 [94.94], Avg: 360.2382 (0.412)
Ep: 295, Reward: 726.7878, Test: 736.5557 [134.64], Avg: 361.0546 (0.411)
Ep: 296, Reward: 739.1423, Test: 785.8526 [132.25], Avg: 362.0396 (0.410)
Ep: 297, Reward: 758.3838, Test: 736.3219 [109.69], Avg: 362.9275 (0.408)
Ep: 298, Reward: 722.4719, Test: 724.4384 [144.32], Avg: 363.6539 (0.407)
Ep: 299, Reward: 720.9747, Test: 719.6905 [209.15], Avg: 364.1436 (0.406)
Ep: 300, Reward: 716.9829, Test: 771.5858 [142.45], Avg: 365.0239 (0.405)
Ep: 301, Reward: 787.4856, Test: 781.6235 [98.76], Avg: 366.0764 (0.404)
Ep: 302, Reward: 737.9512, Test: 752.5896 [134.87], Avg: 366.9069 (0.402)
Ep: 303, Reward: 727.1966, Test: 720.6956 [131.36], Avg: 367.6386 (0.401)
Ep: 304, Reward: 796.9759, Test: 764.1052 [149.36], Avg: 368.4488 (0.400)
Ep: 305, Reward: 758.8353, Test: 741.0043 [134.84], Avg: 369.2256 (0.399)
Ep: 306, Reward: 734.7725, Test: 699.3583 [196.27], Avg: 369.6616 (0.398)
Ep: 307, Reward: 669.4058, Test: 826.1556 [59.15], Avg: 370.9517 (0.396)
Ep: 308, Reward: 751.1029, Test: 814.0341 [59.74], Avg: 372.1923 (0.395)
Ep: 309, Reward: 754.9690, Test: 801.0301 [68.23], Avg: 373.3555 (0.394)
Ep: 310, Reward: 728.9030, Test: 635.5347 [232.30], Avg: 373.4516 (0.393)
Ep: 311, Reward: 721.2139, Test: 752.2538 [107.06], Avg: 374.3226 (0.392)
Ep: 312, Reward: 757.0118, Test: 731.3353 [174.75], Avg: 374.9049 (0.390)
Ep: 313, Reward: 702.6448, Test: 865.1699 [46.79], Avg: 376.3172 (0.389)
Ep: 314, Reward: 625.2726, Test: 750.8789 [120.95], Avg: 377.1224 (0.388)
Ep: 315, Reward: 798.0761, Test: 698.4824 [193.07], Avg: 377.5283 (0.387)
Ep: 316, Reward: 721.7927, Test: 732.6087 [79.96], Avg: 378.3962 (0.386)
Ep: 317, Reward: 773.5616, Test: 698.6827 [183.81], Avg: 378.8254 (0.385)
Ep: 318, Reward: 728.6126, Test: 707.9223 [228.69], Avg: 379.1401 (0.383)
Ep: 319, Reward: 744.4020, Test: 712.9619 [133.15], Avg: 379.7672 (0.382)
Ep: 320, Reward: 775.9578, Test: 731.9511 [140.79], Avg: 380.4258 (0.381)
Ep: 321, Reward: 782.7751, Test: 807.0397 [54.59], Avg: 381.5811 (0.380)
Ep: 322, Reward: 716.0757, Test: 765.3767 [130.58], Avg: 382.3651 (0.379)
Ep: 323, Reward: 708.8510, Test: 731.6255 [160.91], Avg: 382.9464 (0.378)
Ep: 324, Reward: 749.7149, Test: 756.7934 [135.44], Avg: 383.6800 (0.377)
Ep: 325, Reward: 703.5414, Test: 731.2617 [63.74], Avg: 384.5507 (0.376)
Ep: 326, Reward: 743.9478, Test: 740.3898 [111.54], Avg: 385.2978 (0.374)
Ep: 327, Reward: 726.8524, Test: 766.5802 [102.28], Avg: 386.1484 (0.373)
Ep: 328, Reward: 756.6301, Test: 724.9597 [148.80], Avg: 386.7259 (0.372)
Ep: 329, Reward: 755.3504, Test: 663.7667 [134.19], Avg: 387.1588 (0.371)
Ep: 330, Reward: 816.2516, Test: 716.2326 [167.00], Avg: 387.6484 (0.370)
Ep: 331, Reward: 654.9794, Test: 658.2761 [189.64], Avg: 387.8924 (0.369)
Ep: 332, Reward: 584.1255, Test: 647.9015 [116.05], Avg: 388.3247 (0.368)
Ep: 333, Reward: 631.7019, Test: 608.1450 [133.68], Avg: 388.5826 (0.367)
Ep: 334, Reward: 652.3974, Test: 637.0427 [155.87], Avg: 388.8590 (0.365)
Ep: 335, Reward: 619.3510, Test: 617.3565 [121.77], Avg: 389.1766 (0.364)
Ep: 336, Reward: 689.1391, Test: 573.2684 [172.20], Avg: 389.2119 (0.363)
Ep: 337, Reward: 721.2940, Test: 634.2525 [119.03], Avg: 389.5847 (0.362)
Ep: 338, Reward: 618.4881, Test: 649.6320 [153.70], Avg: 389.8984 (0.361)
Ep: 339, Reward: 700.5257, Test: 632.3686 [124.27], Avg: 390.2461 (0.360)
Ep: 340, Reward: 677.2015, Test: 584.6148 [124.66], Avg: 390.4505 (0.359)
Ep: 341, Reward: 592.3236, Test: 638.5840 [200.81], Avg: 390.5889 (0.358)
Ep: 342, Reward: 698.9218, Test: 629.5926 [182.88], Avg: 390.7525 (0.357)
Ep: 343, Reward: 645.3381, Test: 637.9753 [94.21], Avg: 391.1973 (0.356)
Ep: 344, Reward: 609.7843, Test: 592.6924 [175.20], Avg: 391.2736 (0.355)
Ep: 345, Reward: 713.3254, Test: 666.3491 [114.36], Avg: 391.7381 (0.354)
Ep: 346, Reward: 686.1197, Test: 577.6195 [206.36], Avg: 391.6790 (0.353)
Ep: 347, Reward: 634.5042, Test: 566.4459 [153.60], Avg: 391.7399 (0.351)
Ep: 348, Reward: 636.1148, Test: 490.0023 [255.11], Avg: 391.2904 (0.350)
Ep: 349, Reward: 582.3903, Test: 559.6191 [187.10], Avg: 391.2368 (0.349)
Ep: 350, Reward: 653.2614, Test: 659.9977 [71.97], Avg: 391.7974 (0.348)
Ep: 351, Reward: 630.9303, Test: 536.9975 [174.29], Avg: 391.7148 (0.347)
Ep: 352, Reward: 609.4042, Test: 620.2303 [159.47], Avg: 391.9104 (0.346)
Ep: 353, Reward: 641.9121, Test: 594.4108 [161.17], Avg: 392.0271 (0.345)
Ep: 354, Reward: 680.2637, Test: 722.5712 [60.32], Avg: 392.7884 (0.344)
Ep: 355, Reward: 715.8866, Test: 633.8412 [197.83], Avg: 392.9098 (0.343)
Ep: 356, Reward: 684.0717, Test: 485.1581 [218.96], Avg: 392.5548 (0.342)
Ep: 357, Reward: 634.0375, Test: 645.6240 [154.59], Avg: 392.8299 (0.341)
Ep: 358, Reward: 711.4204, Test: 589.9964 [174.58], Avg: 392.8928 (0.340)
Ep: 359, Reward: 614.3839, Test: 705.9406 [102.95], Avg: 393.4765 (0.339)
Ep: 360, Reward: 617.2174, Test: 646.3228 [161.94], Avg: 393.7283 (0.338)
Ep: 361, Reward: 651.4735, Test: 644.5446 [170.13], Avg: 393.9512 (0.337)
Ep: 362, Reward: 661.7646, Test: 689.9623 [140.90], Avg: 394.3785 (0.336)
Ep: 363, Reward: 656.4179, Test: 706.1297 [129.95], Avg: 394.8779 (0.335)
Ep: 364, Reward: 728.3308, Test: 713.2794 [119.48], Avg: 395.4229 (0.334)
Ep: 365, Reward: 648.5907, Test: 695.7734 [166.98], Avg: 395.7873 (0.333)
Ep: 366, Reward: 727.6847, Test: 648.8069 [168.99], Avg: 396.0162 (0.332)
Ep: 367, Reward: 648.8505, Test: 687.5901 [159.57], Avg: 396.3750 (0.331)
Ep: 368, Reward: 661.8185, Test: 697.5884 [152.79], Avg: 396.7772 (0.330)
Ep: 369, Reward: 670.7737, Test: 747.8449 [102.69], Avg: 397.4485 (0.329)
Ep: 370, Reward: 720.5144, Test: 708.1463 [165.87], Avg: 397.8388 (0.328)
Ep: 371, Reward: 565.9420, Test: 665.6413 [159.61], Avg: 398.1297 (0.327)
Ep: 372, Reward: 712.4140, Test: 561.2199 [241.67], Avg: 397.9190 (0.326)
Ep: 373, Reward: 656.1216, Test: 673.9673 [215.53], Avg: 398.0808 (0.325)
Ep: 374, Reward: 642.0147, Test: 549.3463 [189.00], Avg: 397.9802 (0.324)
Ep: 375, Reward: 600.3752, Test: 671.1352 [187.44], Avg: 398.2082 (0.323)
Ep: 376, Reward: 640.3447, Test: 565.5497 [226.84], Avg: 398.0503 (0.322)
Ep: 377, Reward: 776.9492, Test: 627.5716 [186.07], Avg: 398.1653 (0.321)
Ep: 378, Reward: 616.6422, Test: 704.4838 [125.41], Avg: 398.6426 (0.320)
Ep: 379, Reward: 725.6284, Test: 743.1705 [88.72], Avg: 399.3158 (0.319)
Ep: 380, Reward: 716.7403, Test: 701.5489 [139.64], Avg: 399.7425 (0.318)
Ep: 381, Reward: 664.3019, Test: 648.8940 [174.50], Avg: 399.9380 (0.317)
Ep: 382, Reward: 766.9156, Test: 634.3808 [132.31], Avg: 400.2046 (0.316)
Ep: 383, Reward: 731.6383, Test: 496.6792 [225.25], Avg: 399.8693 (0.315)
Ep: 384, Reward: 661.9382, Test: 679.1248 [142.81], Avg: 400.2237 (0.315)
Ep: 385, Reward: 701.8107, Test: 675.8291 [78.28], Avg: 400.7349 (0.314)
Ep: 386, Reward: 618.4979, Test: 621.8615 [207.25], Avg: 400.7707 (0.313)
Ep: 387, Reward: 586.4793, Test: 635.7389 [147.98], Avg: 400.9949 (0.312)
Ep: 388, Reward: 672.3829, Test: 555.4776 [253.23], Avg: 400.7410 (0.311)
Ep: 389, Reward: 681.6187, Test: 622.8925 [174.37], Avg: 400.8636 (0.310)
Ep: 390, Reward: 669.9103, Test: 714.5652 [146.63], Avg: 401.2909 (0.309)
Ep: 391, Reward: 750.8980, Test: 666.8098 [189.15], Avg: 401.4857 (0.308)
Ep: 392, Reward: 688.1138, Test: 614.7222 [154.64], Avg: 401.6348 (0.307)
Ep: 393, Reward: 705.3064, Test: 664.3350 [162.35], Avg: 401.8895 (0.306)
Ep: 394, Reward: 692.9320, Test: 735.0321 [102.85], Avg: 402.4725 (0.305)
Ep: 395, Reward: 726.2421, Test: 662.8752 [177.58], Avg: 402.6817 (0.304)
Ep: 396, Reward: 657.1415, Test: 593.5946 [265.70], Avg: 402.4933 (0.303)
Ep: 397, Reward: 657.8772, Test: 747.0471 [137.39], Avg: 403.0138 (0.302)
Ep: 398, Reward: 720.0378, Test: 656.5895 [152.51], Avg: 403.2671 (0.302)
Ep: 399, Reward: 655.0631, Test: 649.5959 [207.90], Avg: 403.3632 (0.301)
Ep: 400, Reward: 674.0008, Test: 659.4145 [171.05], Avg: 403.5752 (0.300)
Ep: 401, Reward: 701.1584, Test: 779.4238 [97.26], Avg: 404.2682 (0.299)
Ep: 402, Reward: 712.0549, Test: 604.1663 [252.88], Avg: 404.1367 (0.298)
Ep: 403, Reward: 687.8947, Test: 671.3798 [201.75], Avg: 404.2988 (0.297)
Ep: 404, Reward: 689.5611, Test: 736.4050 [109.78], Avg: 404.8478 (0.296)
Ep: 405, Reward: 655.9034, Test: 599.3275 [202.51], Avg: 404.8280 (0.295)
Ep: 406, Reward: 641.6913, Test: 591.2981 [232.19], Avg: 404.7156 (0.294)
Ep: 407, Reward: 700.5759, Test: 553.8600 [175.69], Avg: 404.6506 (0.294)
Ep: 408, Reward: 675.1869, Test: 676.4602 [156.62], Avg: 404.9322 (0.293)
Ep: 409, Reward: 726.7958, Test: 644.5119 [247.63], Avg: 404.9126 (0.292)
Ep: 410, Reward: 644.1122, Test: 705.3784 [152.57], Avg: 405.2724 (0.291)
Ep: 411, Reward: 756.6636, Test: 677.0381 [221.74], Avg: 405.3938 (0.290)
Ep: 412, Reward: 756.0254, Test: 683.7379 [205.72], Avg: 405.5697 (0.289)
Ep: 413, Reward: 744.9386, Test: 622.7534 [211.99], Avg: 405.5822 (0.288)
Ep: 414, Reward: 739.0078, Test: 817.6819 [40.85], Avg: 406.4768 (0.287)
Ep: 415, Reward: 708.2784, Test: 642.0150 [216.26], Avg: 406.5232 (0.287)
Ep: 416, Reward: 714.6871, Test: 762.6175 [111.66], Avg: 407.1093 (0.286)
Ep: 417, Reward: 796.4694, Test: 659.0913 [183.66], Avg: 407.2728 (0.285)
Ep: 418, Reward: 761.3810, Test: 690.6581 [194.65], Avg: 407.4846 (0.284)
Ep: 419, Reward: 695.4138, Test: 804.7640 [58.01], Avg: 408.2923 (0.283)
Ep: 420, Reward: 667.7919, Test: 705.7355 [133.13], Avg: 408.6826 (0.282)
Ep: 421, Reward: 734.7431, Test: 757.4863 [95.75], Avg: 409.2823 (0.281)
Ep: 422, Reward: 740.2027, Test: 794.9233 [61.07], Avg: 410.0496 (0.281)
Ep: 423, Reward: 733.5694, Test: 737.1313 [112.63], Avg: 410.5554 (0.280)
Ep: 424, Reward: 746.9400, Test: 726.6572 [139.36], Avg: 410.9712 (0.279)
Ep: 425, Reward: 728.6789, Test: 697.7607 [154.55], Avg: 411.2817 (0.278)
Ep: 426, Reward: 741.6944, Test: 746.0355 [82.33], Avg: 411.8728 (0.277)
Ep: 427, Reward: 697.7418, Test: 723.1667 [130.94], Avg: 412.2942 (0.276)
Ep: 428, Reward: 686.0374, Test: 773.4240 [96.71], Avg: 412.9106 (0.276)
Ep: 429, Reward: 722.5731, Test: 779.1971 [83.57], Avg: 413.5680 (0.275)
Ep: 430, Reward: 709.0392, Test: 735.4526 [127.46], Avg: 414.0191 (0.274)
Ep: 431, Reward: 707.9282, Test: 807.8680 [127.81], Avg: 414.6350 (0.273)
Ep: 432, Reward: 749.5870, Test: 644.5972 [166.72], Avg: 414.7810 (0.272)
Ep: 433, Reward: 706.4199, Test: 795.2550 [58.32], Avg: 415.5233 (0.271)
Ep: 434, Reward: 775.6776, Test: 712.1420 [182.07], Avg: 415.7866 (0.271)
Ep: 435, Reward: 762.9508, Test: 698.1343 [126.74], Avg: 416.1435 (0.270)
Ep: 436, Reward: 723.7671, Test: 735.1945 [151.68], Avg: 416.5265 (0.269)
Ep: 437, Reward: 745.1615, Test: 728.6228 [175.37], Avg: 416.8387 (0.268)
Ep: 438, Reward: 747.6600, Test: 688.3355 [207.47], Avg: 416.9845 (0.267)
Ep: 439, Reward: 708.9321, Test: 701.8268 [200.45], Avg: 417.1763 (0.267)
Ep: 440, Reward: 773.5605, Test: 743.4266 [180.33], Avg: 417.5072 (0.266)
Ep: 441, Reward: 763.6002, Test: 736.1460 [203.92], Avg: 417.7668 (0.265)
Ep: 442, Reward: 704.7806, Test: 710.6238 [175.50], Avg: 418.0317 (0.264)
Ep: 443, Reward: 744.9613, Test: 774.0954 [118.17], Avg: 418.5675 (0.263)
Ep: 444, Reward: 732.8363, Test: 751.4386 [75.99], Avg: 419.1447 (0.263)
Ep: 445, Reward: 686.6577, Test: 642.8025 [231.83], Avg: 419.1264 (0.262)
Ep: 446, Reward: 721.7081, Test: 727.1654 [143.32], Avg: 419.4949 (0.261)
Ep: 447, Reward: 740.9270, Test: 792.4834 [129.49], Avg: 420.0384 (0.260)
Ep: 448, Reward: 761.0021, Test: 786.6350 [68.99], Avg: 420.7013 (0.259)
Ep: 449, Reward: 784.8186, Test: 790.2745 [124.41], Avg: 421.2461 (0.259)
Ep: 450, Reward: 708.4957, Test: 813.2552 [58.89], Avg: 421.9847 (0.258)
Ep: 451, Reward: 743.0638, Test: 809.3237 [129.57], Avg: 422.5550 (0.257)
Ep: 452, Reward: 770.7254, Test: 794.6426 [130.13], Avg: 423.0891 (0.256)
Ep: 453, Reward: 762.0154, Test: 771.5619 [112.33], Avg: 423.6093 (0.256)
Ep: 454, Reward: 825.4523, Test: 695.6884 [206.10], Avg: 423.7543 (0.255)
Ep: 455, Reward: 780.6484, Test: 707.4086 [221.49], Avg: 423.8906 (0.254)
Ep: 456, Reward: 787.4638, Test: 789.7068 [71.68], Avg: 424.5342 (0.253)
Ep: 457, Reward: 803.8940, Test: 774.1068 [127.91], Avg: 425.0182 (0.253)
Ep: 458, Reward: 791.3987, Test: 696.2352 [179.57], Avg: 425.2179 (0.252)
Ep: 459, Reward: 787.9654, Test: 745.5456 [132.87], Avg: 425.6254 (0.251)
Ep: 460, Reward: 736.2795, Test: 827.3479 [36.00], Avg: 426.4187 (0.250)
Ep: 461, Reward: 725.8684, Test: 814.0879 [49.68], Avg: 427.1503 (0.250)
Ep: 462, Reward: 796.6015, Test: 791.2630 [88.96], Avg: 427.7446 (0.249)
Ep: 463, Reward: 800.4333, Test: 754.5658 [76.29], Avg: 428.2845 (0.248)
Ep: 464, Reward: 746.5841, Test: 732.5198 [114.82], Avg: 428.6918 (0.247)
Ep: 465, Reward: 800.7342, Test: 832.4461 [30.53], Avg: 429.4927 (0.247)
Ep: 466, Reward: 782.8996, Test: 742.0231 [198.01], Avg: 429.7380 (0.246)
Ep: 467, Reward: 785.7158, Test: 765.6896 [168.36], Avg: 430.0961 (0.245)
Ep: 468, Reward: 678.9283, Test: 797.5015 [95.62], Avg: 430.6756 (0.244)
Ep: 469, Reward: 746.6273, Test: 748.6217 [122.06], Avg: 431.0924 (0.244)
Ep: 470, Reward: 800.2777, Test: 661.0087 [181.03], Avg: 431.1961 (0.243)
Ep: 471, Reward: 744.3556, Test: 791.0946 [72.90], Avg: 431.8042 (0.242)
Ep: 472, Reward: 827.0145, Test: 816.7174 [40.85], Avg: 432.5316 (0.241)
Ep: 473, Reward: 784.9893, Test: 762.9679 [117.47], Avg: 432.9809 (0.241)
Ep: 474, Reward: 798.5526, Test: 835.0456 [55.09], Avg: 433.7114 (0.240)
Ep: 475, Reward: 713.6736, Test: 755.1828 [132.21], Avg: 434.1090 (0.239)
Ep: 476, Reward: 777.5707, Test: 838.0316 [27.61], Avg: 434.8979 (0.239)
Ep: 477, Reward: 791.4151, Test: 787.1468 [101.55], Avg: 435.4224 (0.238)
Ep: 478, Reward: 795.4254, Test: 834.3626 [64.22], Avg: 436.1212 (0.237)
Ep: 479, Reward: 808.8481, Test: 769.3064 [133.44], Avg: 436.5373 (0.236)
Ep: 480, Reward: 800.2793, Test: 807.4836 [91.36], Avg: 437.1186 (0.236)
Ep: 481, Reward: 766.7592, Test: 828.9749 [104.67], Avg: 437.7144 (0.235)
Ep: 482, Reward: 786.1411, Test: 857.3732 [35.43], Avg: 438.5099 (0.234)
Ep: 483, Reward: 823.7473, Test: 769.6235 [208.60], Avg: 438.7630 (0.234)
Ep: 484, Reward: 735.8015, Test: 743.5504 [135.81], Avg: 439.1114 (0.233)
Ep: 485, Reward: 781.5705, Test: 851.5293 [43.28], Avg: 439.8710 (0.232)
Ep: 486, Reward: 839.4293, Test: 798.8548 [52.35], Avg: 440.5006 (0.231)
Ep: 487, Reward: 774.6405, Test: 750.0738 [197.46], Avg: 440.7304 (0.231)
Ep: 488, Reward: 812.0483, Test: 790.0363 [79.77], Avg: 441.2816 (0.230)
Ep: 489, Reward: 817.7377, Test: 757.1850 [165.56], Avg: 441.5884 (0.229)
Ep: 490, Reward: 794.9558, Test: 786.2437 [154.97], Avg: 441.9747 (0.229)
Ep: 491, Reward: 802.3879, Test: 770.9424 [95.09], Avg: 442.4501 (0.228)
Ep: 492, Reward: 846.8526, Test: 690.0555 [136.02], Avg: 442.6764 (0.227)
Ep: 493, Reward: 839.8904, Test: 786.3445 [127.54], Avg: 443.1139 (0.227)
Ep: 494, Reward: 778.0627, Test: 776.6277 [95.07], Avg: 443.5957 (0.226)
Ep: 495, Reward: 779.3814, Test: 650.3998 [241.01], Avg: 443.5267 (0.225)
Ep: 496, Reward: 812.1410, Test: 764.7587 [131.61], Avg: 443.9082 (0.225)
Ep: 497, Reward: 749.0098, Test: 748.4770 [95.12], Avg: 444.3288 (0.224)
Ep: 498, Reward: 805.9273, Test: 792.5567 [146.22], Avg: 444.7336 (0.223)
Ep: 499, Reward: 731.1708, Test: 813.2137 [69.91], Avg: 445.3308 (0.223)
