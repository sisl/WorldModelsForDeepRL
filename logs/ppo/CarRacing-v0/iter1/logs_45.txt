Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 16					# Number of samples to train on for each train step
PPO_EPOCHS = 1					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.05				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((len(self.replay_buffer)*PPO_EPOCHS)//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -26.3275, Test: -41.9503 [26.11], Avg: -68.0601 (0.997)
Ep: 1, Reward: -10.4492, Test: 99.1296 [47.31], Avg: -8.1217 (0.994)
Ep: 2, Reward: 159.1501, Test: 206.8409 [111.96], Avg: 26.2114 (0.991)
Ep: 3, Reward: 432.8216, Test: 448.8654 [63.33], Avg: 116.0412 (0.988)
Ep: 4, Reward: 546.6139, Test: 601.0630 [248.07], Avg: 163.4322 (0.985)
Ep: 5, Reward: 692.4615, Test: 496.0027 [193.18], Avg: 186.6648 (0.982)
Ep: 6, Reward: 556.9231, Test: 678.8286 [239.68], Avg: 222.7342 (0.979)
Ep: 7, Reward: 736.3587, Test: 651.1943 [76.41], Avg: 266.7404 (0.976)
Ep: 8, Reward: 666.1340, Test: 596.2504 [215.75], Avg: 279.3802 (0.973)
Ep: 9, Reward: 734.6053, Test: 764.9359 [117.84], Avg: 316.1520 (0.970)
Ep: 10, Reward: 780.6888, Test: 793.2692 [136.11], Avg: 347.1528 (0.967)
Ep: 11, Reward: 809.3010, Test: 830.3652 [107.67], Avg: 378.4484 (0.965)
Ep: 12, Reward: 453.8615, Test: 326.4227 [200.19], Avg: 359.0472 (0.962)
Ep: 13, Reward: 435.2913, Test: 511.5971 [169.17], Avg: 357.8600 (0.959)
Ep: 14, Reward: 500.7948, Test: 523.0615 [204.52], Avg: 355.2390 (0.956)
Ep: 15, Reward: 580.5096, Test: 690.6099 [204.55], Avg: 363.4150 (0.953)
Ep: 16, Reward: 577.2236, Test: 623.2985 [213.26], Avg: 366.1576 (0.950)
Ep: 17, Reward: 579.0770, Test: 477.0131 [255.83], Avg: 358.1034 (0.947)
Ep: 18, Reward: 505.0478, Test: 839.0278 [75.36], Avg: 379.4488 (0.945)
Ep: 19, Reward: 733.0982, Test: 705.5962 [190.27], Avg: 386.2425 (0.942)
Ep: 20, Reward: 531.0669, Test: 382.0208 [151.85], Avg: 378.8105 (0.939)
Ep: 21, Reward: 320.4532, Test: 449.5575 [203.14], Avg: 372.7925 (0.936)
Ep: 22, Reward: 527.0070, Test: 523.3906 [217.71], Avg: 369.8747 (0.933)
Ep: 23, Reward: 371.6487, Test: 237.9655 [101.34], Avg: 360.1561 (0.930)
Ep: 24, Reward: 370.5251, Test: 448.4744 [194.08], Avg: 355.9257 (0.928)
Ep: 25, Reward: 406.2748, Test: 479.8964 [212.60], Avg: 352.5168 (0.925)
Ep: 26, Reward: 386.1615, Test: 386.0915 [177.68], Avg: 347.1796 (0.922)
Ep: 27, Reward: 546.7773, Test: 498.8434 [157.80], Avg: 346.9607 (0.919)
Ep: 28, Reward: 547.4395, Test: 701.4686 [123.61], Avg: 354.9227 (0.917)
Ep: 29, Reward: 468.0287, Test: 598.5445 [186.00], Avg: 356.8433 (0.914)
Ep: 30, Reward: 447.1866, Test: 406.8797 [266.75], Avg: 349.8525 (0.911)
Ep: 31, Reward: 492.8022, Test: 511.7217 [235.59], Avg: 347.5486 (0.908)
Ep: 32, Reward: 592.0939, Test: 776.6902 [41.03], Avg: 359.3095 (0.906)
Ep: 33, Reward: 682.1992, Test: 687.1482 [131.50], Avg: 365.0842 (0.903)
Ep: 34, Reward: 643.9965, Test: 732.6196 [58.38], Avg: 373.9171 (0.900)
Ep: 35, Reward: 745.0816, Test: 752.4254 [102.62], Avg: 381.5808 (0.897)
Ep: 36, Reward: 713.5134, Test: 801.5090 [135.84], Avg: 389.2589 (0.895)
Ep: 37, Reward: 758.9299, Test: 772.2009 [131.34], Avg: 395.8800 (0.892)
Ep: 38, Reward: 802.0447, Test: 744.1074 [288.44], Avg: 397.4131 (0.889)
Ep: 39, Reward: 822.2920, Test: 679.6275 [360.91], Avg: 395.4457 (0.887)
Ep: 40, Reward: 760.6047, Test: 801.7506 [140.65], Avg: 401.9251 (0.884)
Ep: 41, Reward: 851.5507, Test: 856.8362 [43.85], Avg: 411.7124 (0.881)
Ep: 42, Reward: 863.5177, Test: 875.4689 [45.12], Avg: 421.4482 (0.879)
Ep: 43, Reward: 821.1079, Test: 784.0815 [171.04], Avg: 425.8027 (0.876)
Ep: 44, Reward: 831.0157, Test: 846.6391 [77.48], Avg: 433.4327 (0.874)
Ep: 45, Reward: 834.9477, Test: 521.0216 [232.87], Avg: 430.2745 (0.871)
Ep: 46, Reward: 737.4548, Test: 650.3577 [227.33], Avg: 430.1203 (0.868)
Ep: 47, Reward: 603.4874, Test: 363.7416 [248.63], Avg: 423.5576 (0.866)
Ep: 48, Reward: 656.1443, Test: 630.2797 [241.79], Avg: 422.8419 (0.863)
Ep: 49, Reward: 678.7895, Test: 710.0495 [141.21], Avg: 425.7619 (0.861)
Ep: 50, Reward: 771.9009, Test: 739.0476 [167.59], Avg: 428.6187 (0.858)
Ep: 51, Reward: 740.2990, Test: 704.6403 [177.85], Avg: 430.5065 (0.855)
Ep: 52, Reward: 834.9683, Test: 842.6279 [85.02], Avg: 436.6783 (0.853)
Ep: 53, Reward: 782.8459, Test: 798.2649 [96.61], Avg: 441.5853 (0.850)
Ep: 54, Reward: 813.8929, Test: 621.2647 [257.18], Avg: 440.1763 (0.848)
Ep: 55, Reward: 780.4390, Test: 765.9065 [141.93], Avg: 443.4584 (0.845)
Ep: 56, Reward: 799.3772, Test: 733.1686 [160.73], Avg: 445.7212 (0.843)
Ep: 57, Reward: 897.3320, Test: 844.2090 [46.10], Avg: 451.7969 (0.840)
Ep: 58, Reward: 853.0134, Test: 821.3897 [100.24], Avg: 456.3622 (0.838)
Ep: 59, Reward: 811.7602, Test: 730.8279 [218.75], Avg: 457.2908 (0.835)
Ep: 60, Reward: 860.9940, Test: 787.5349 [136.85], Avg: 460.4612 (0.833)
Ep: 61, Reward: 823.9875, Test: 727.6390 [185.43], Avg: 461.7797 (0.830)
Ep: 62, Reward: 846.6331, Test: 808.2860 [84.11], Avg: 465.9447 (0.828)
Ep: 63, Reward: 746.2970, Test: 772.9756 [123.72], Avg: 468.8089 (0.825)
Ep: 64, Reward: 646.1457, Test: 653.3998 [148.54], Avg: 469.3635 (0.823)
Ep: 65, Reward: 497.6484, Test: 560.5428 [201.82], Avg: 467.6871 (0.820)
Ep: 66, Reward: 678.1060, Test: 646.1225 [180.27], Avg: 467.6597 (0.818)
Ep: 67, Reward: 726.0339, Test: 725.1514 [134.14], Avg: 469.4738 (0.815)
Ep: 68, Reward: 833.5939, Test: 806.3617 [143.41], Avg: 472.2777 (0.813)
Ep: 69, Reward: 858.3463, Test: 771.9238 [164.07], Avg: 474.2146 (0.810)
Ep: 70, Reward: 732.6143, Test: 812.7980 [101.39], Avg: 477.5552 (0.808)
Ep: 71, Reward: 873.6403, Test: 814.3811 [93.29], Avg: 480.9377 (0.805)
Ep: 72, Reward: 801.6776, Test: 624.9175 [312.87], Avg: 478.6242 (0.803)
Ep: 73, Reward: 703.2705, Test: 826.1912 [78.10], Avg: 482.2656 (0.801)
Ep: 74, Reward: 734.7130, Test: 789.3371 [127.14], Avg: 484.6647 (0.798)
Ep: 75, Reward: 785.6896, Test: 833.5362 [95.29], Avg: 488.0012 (0.796)
Ep: 76, Reward: 758.7785, Test: 717.2565 [143.35], Avg: 489.1169 (0.793)
Ep: 77, Reward: 731.3167, Test: 785.6358 [91.36], Avg: 491.7471 (0.791)
Ep: 78, Reward: 799.3574, Test: 823.3542 [110.15], Avg: 494.5504 (0.789)
Ep: 79, Reward: 859.5819, Test: 840.9627 [60.17], Avg: 498.1283 (0.786)
Ep: 80, Reward: 805.7004, Test: 827.5756 [85.21], Avg: 501.1436 (0.784)
Ep: 81, Reward: 849.1018, Test: 806.1899 [114.77], Avg: 503.4640 (0.782)
Ep: 82, Reward: 894.2681, Test: 857.8639 [47.19], Avg: 507.1653 (0.779)
Ep: 83, Reward: 863.3310, Test: 855.0943 [36.75], Avg: 510.8699 (0.777)
Ep: 84, Reward: 808.1423, Test: 747.6642 [188.31], Avg: 511.4403 (0.775)
Ep: 85, Reward: 799.3489, Test: 864.5184 [40.46], Avg: 515.0754 (0.772)
Ep: 86, Reward: 797.4643, Test: 749.0715 [150.89], Avg: 516.0307 (0.770)
Ep: 87, Reward: 840.1706, Test: 849.1172 [82.34], Avg: 518.8801 (0.768)
Ep: 88, Reward: 787.4896, Test: 683.4443 [182.54], Avg: 518.6780 (0.765)
Ep: 89, Reward: 761.4413, Test: 653.7409 [227.34], Avg: 517.6527 (0.763)
Ep: 90, Reward: 759.8259, Test: 625.9519 [241.31], Avg: 516.1910 (0.761)
Ep: 91, Reward: 737.7888, Test: 859.0990 [75.63], Avg: 519.0963 (0.758)
Ep: 92, Reward: 739.3785, Test: 775.4889 [148.47], Avg: 520.2567 (0.756)
Ep: 93, Reward: 846.5828, Test: 860.6902 [51.24], Avg: 523.3332 (0.754)
Ep: 94, Reward: 853.0556, Test: 771.8549 [208.28], Avg: 523.7568 (0.752)
Ep: 95, Reward: 821.2623, Test: 721.7984 [198.51], Avg: 523.7519 (0.749)
Ep: 96, Reward: 879.1642, Test: 731.1860 [218.14], Avg: 523.6416 (0.747)
Ep: 97, Reward: 783.7441, Test: 699.1531 [221.93], Avg: 523.1679 (0.745)
Ep: 98, Reward: 734.8842, Test: 715.2717 [186.54], Avg: 523.2241 (0.743)
Ep: 99, Reward: 796.4778, Test: 605.6623 [257.30], Avg: 521.4755 (0.740)
Ep: 100, Reward: 675.9030, Test: 738.5963 [158.41], Avg: 522.0568 (0.738)
Ep: 101, Reward: 833.5036, Test: 728.0049 [177.44], Avg: 522.3363 (0.736)
Ep: 102, Reward: 615.0432, Test: 540.8820 [240.18], Avg: 520.1845 (0.734)
Ep: 103, Reward: 809.1750, Test: 605.0217 [262.23], Avg: 518.4788 (0.732)
Ep: 104, Reward: 769.0429, Test: 770.3524 [147.32], Avg: 519.4745 (0.729)
Ep: 105, Reward: 794.4892, Test: 774.6265 [191.45], Avg: 520.0755 (0.727)
Ep: 106, Reward: 786.5715, Test: 804.0175 [155.72], Avg: 521.2738 (0.725)
Ep: 107, Reward: 796.5664, Test: 821.4669 [180.87], Avg: 522.3786 (0.723)
Ep: 108, Reward: 729.9423, Test: 811.6239 [104.86], Avg: 524.0702 (0.721)
Ep: 109, Reward: 744.9087, Test: 655.4790 [162.89], Avg: 523.7841 (0.719)
Ep: 110, Reward: 742.0829, Test: 830.4043 [59.52], Avg: 526.0102 (0.716)
Ep: 111, Reward: 770.3464, Test: 647.0075 [225.94], Avg: 525.0732 (0.714)
Ep: 112, Reward: 743.0363, Test: 829.7010 [42.32], Avg: 527.3945 (0.712)
Ep: 113, Reward: 835.4437, Test: 657.2283 [198.88], Avg: 526.7888 (0.710)
Ep: 114, Reward: 713.6193, Test: 679.9612 [244.73], Avg: 525.9926 (0.708)
Ep: 115, Reward: 665.8440, Test: 745.6337 [165.32], Avg: 526.4609 (0.706)
Ep: 116, Reward: 713.6310, Test: 534.4694 [186.21], Avg: 524.9378 (0.704)
Ep: 117, Reward: 728.9617, Test: 568.5439 [278.59], Avg: 522.9465 (0.702)
Ep: 118, Reward: 580.6689, Test: 625.0088 [149.76], Avg: 522.5456 (0.699)
Ep: 119, Reward: 560.6371, Test: 647.3820 [177.57], Avg: 522.1062 (0.697)
Ep: 120, Reward: 744.6151, Test: 830.4980 [72.21], Avg: 524.0581 (0.695)
Ep: 121, Reward: 793.4486, Test: 714.5533 [217.31], Avg: 523.8383 (0.693)
Ep: 122, Reward: 736.9413, Test: 765.1327 [200.38], Avg: 524.1710 (0.691)
Ep: 123, Reward: 792.3409, Test: 682.4271 [204.33], Avg: 523.7994 (0.689)
Ep: 124, Reward: 756.7563, Test: 823.8249 [128.36], Avg: 525.1727 (0.687)
Ep: 125, Reward: 795.8618, Test: 767.9357 [159.64], Avg: 525.8324 (0.685)
Ep: 126, Reward: 791.8083, Test: 800.4460 [156.72], Avg: 526.7606 (0.683)
Ep: 127, Reward: 868.1628, Test: 784.9369 [97.07], Avg: 528.0193 (0.681)
Ep: 128, Reward: 851.8865, Test: 833.9108 [86.82], Avg: 529.7175 (0.679)
Ep: 129, Reward: 839.2381, Test: 782.8476 [143.87], Avg: 530.5579 (0.677)
Ep: 130, Reward: 863.4430, Test: 770.8492 [141.12], Avg: 531.3149 (0.675)
Ep: 131, Reward: 808.4243, Test: 817.9356 [94.82], Avg: 532.7679 (0.673)
Ep: 132, Reward: 837.7390, Test: 808.0137 [117.15], Avg: 533.9566 (0.671)
Ep: 133, Reward: 813.3501, Test: 849.0694 [49.04], Avg: 535.9422 (0.669)
Ep: 134, Reward: 860.2674, Test: 774.8683 [110.42], Avg: 536.8941 (0.667)
Ep: 135, Reward: 870.6753, Test: 825.6700 [86.96], Avg: 538.3781 (0.665)
Ep: 136, Reward: 794.7137, Test: 873.9306 [29.13], Avg: 540.6147 (0.663)
Ep: 137, Reward: 762.7124, Test: 770.9345 [198.37], Avg: 540.8462 (0.661)
Ep: 138, Reward: 873.3943, Test: 752.5727 [155.15], Avg: 541.2532 (0.659)
Ep: 139, Reward: 862.2263, Test: 812.8166 [96.56], Avg: 542.5032 (0.657)
Ep: 140, Reward: 733.2239, Test: 808.6012 [111.39], Avg: 543.6005 (0.655)
Ep: 141, Reward: 796.5170, Test: 779.8077 [173.80], Avg: 544.0399 (0.653)
Ep: 142, Reward: 732.7074, Test: 754.9976 [153.27], Avg: 544.4433 (0.651)
Ep: 143, Reward: 708.2297, Test: 731.8222 [125.63], Avg: 544.8721 (0.649)
Ep: 144, Reward: 827.4481, Test: 790.9893 [79.94], Avg: 546.0182 (0.647)
Ep: 145, Reward: 780.8977, Test: 803.2253 [92.07], Avg: 547.1493 (0.645)
Ep: 146, Reward: 766.4066, Test: 784.5694 [122.94], Avg: 547.9280 (0.643)
Ep: 147, Reward: 802.9519, Test: 795.8562 [122.07], Avg: 548.7784 (0.641)
Ep: 148, Reward: 815.4457, Test: 770.8194 [152.19], Avg: 549.2472 (0.639)
Ep: 149, Reward: 732.5920, Test: 790.1161 [108.22], Avg: 550.1315 (0.637)
Ep: 150, Reward: 801.7063, Test: 837.3775 [71.77], Avg: 551.5585 (0.635)
Ep: 151, Reward: 858.6180, Test: 778.8312 [157.91], Avg: 552.0148 (0.633)
Ep: 152, Reward: 794.7455, Test: 814.3528 [87.50], Avg: 553.1575 (0.631)
Ep: 153, Reward: 806.8971, Test: 776.3933 [155.36], Avg: 553.5983 (0.630)
Ep: 154, Reward: 766.2202, Test: 781.3450 [102.31], Avg: 554.4075 (0.628)
Ep: 155, Reward: 781.5924, Test: 769.5069 [94.56], Avg: 555.1802 (0.626)
Ep: 156, Reward: 765.7958, Test: 739.5598 [162.19], Avg: 555.3216 (0.624)
Ep: 157, Reward: 780.0684, Test: 812.9772 [90.12], Avg: 556.3820 (0.622)
Ep: 158, Reward: 849.7303, Test: 836.8819 [81.93], Avg: 557.6309 (0.620)
Ep: 159, Reward: 746.5192, Test: 725.9778 [153.70], Avg: 557.7224 (0.618)
Ep: 160, Reward: 805.7240, Test: 861.8699 [45.30], Avg: 559.3302 (0.616)
Ep: 161, Reward: 848.4414, Test: 837.5631 [57.56], Avg: 560.6924 (0.615)
Ep: 162, Reward: 894.3842, Test: 830.9179 [92.47], Avg: 561.7829 (0.613)
Ep: 163, Reward: 830.9152, Test: 836.3375 [63.27], Avg: 563.0712 (0.611)
Ep: 164, Reward: 829.8427, Test: 817.6770 [73.12], Avg: 564.1711 (0.609)
Ep: 165, Reward: 852.5105, Test: 814.9454 [99.96], Avg: 565.0796 (0.607)
Ep: 166, Reward: 853.1383, Test: 820.5071 [102.27], Avg: 565.9968 (0.605)
Ep: 167, Reward: 760.8977, Test: 812.4461 [76.11], Avg: 567.0107 (0.604)
Ep: 168, Reward: 775.2517, Test: 777.8656 [103.58], Avg: 567.6454 (0.602)
Ep: 169, Reward: 799.2796, Test: 804.8922 [62.87], Avg: 568.6711 (0.600)
Ep: 170, Reward: 762.5903, Test: 792.3278 [156.96], Avg: 569.0612 (0.598)
Ep: 171, Reward: 778.2172, Test: 767.4021 [147.18], Avg: 569.3586 (0.596)
Ep: 172, Reward: 808.2224, Test: 692.5362 [173.14], Avg: 569.0698 (0.595)
Ep: 173, Reward: 797.2397, Test: 777.8465 [131.86], Avg: 569.5119 (0.593)
Ep: 174, Reward: 745.9404, Test: 766.8669 [179.95], Avg: 569.6113 (0.591)
Ep: 175, Reward: 793.3022, Test: 767.7431 [122.56], Avg: 570.0407 (0.589)
Ep: 176, Reward: 810.1298, Test: 794.9563 [136.19], Avg: 570.5420 (0.588)
Ep: 177, Reward: 779.8395, Test: 790.0378 [112.11], Avg: 571.1453 (0.586)
Ep: 178, Reward: 822.0319, Test: 743.6755 [163.95], Avg: 571.1932 (0.584)
Ep: 179, Reward: 728.9305, Test: 787.0492 [159.69], Avg: 571.5052 (0.582)
Ep: 180, Reward: 787.1988, Test: 768.0126 [130.91], Avg: 571.8676 (0.581)
Ep: 181, Reward: 868.5283, Test: 739.7168 [192.72], Avg: 571.7310 (0.579)
Ep: 182, Reward: 813.3892, Test: 762.0700 [183.93], Avg: 571.7660 (0.577)
Ep: 183, Reward: 783.2790, Test: 749.4330 [108.08], Avg: 572.1442 (0.575)
Ep: 184, Reward: 707.7947, Test: 766.2268 [166.04], Avg: 572.2958 (0.574)
Ep: 185, Reward: 782.9970, Test: 762.8060 [81.94], Avg: 572.8795 (0.572)
Ep: 186, Reward: 769.7677, Test: 786.5325 [102.00], Avg: 573.4766 (0.570)
Ep: 187, Reward: 723.5194, Test: 775.1886 [171.39], Avg: 573.6379 (0.568)
Ep: 188, Reward: 792.6957, Test: 742.1360 [148.84], Avg: 573.7419 (0.567)
Ep: 189, Reward: 798.4092, Test: 699.8639 [206.10], Avg: 573.3209 (0.565)
Ep: 190, Reward: 792.1779, Test: 804.3767 [157.05], Avg: 573.7084 (0.563)
Ep: 191, Reward: 802.1882, Test: 818.1714 [76.63], Avg: 574.5825 (0.562)
Ep: 192, Reward: 816.6373, Test: 647.7243 [201.85], Avg: 573.9156 (0.560)
Ep: 193, Reward: 799.0236, Test: 744.1416 [160.46], Avg: 573.9660 (0.558)
Ep: 194, Reward: 741.6874, Test: 686.8258 [171.99], Avg: 573.6628 (0.557)
Ep: 195, Reward: 747.3597, Test: 773.0717 [134.52], Avg: 573.9938 (0.555)
Ep: 196, Reward: 740.6552, Test: 778.1934 [128.92], Avg: 574.3760 (0.553)
Ep: 197, Reward: 817.1260, Test: 785.4725 [146.53], Avg: 574.7021 (0.552)
Ep: 198, Reward: 759.6335, Test: 743.6393 [133.73], Avg: 574.8790 (0.550)
Ep: 199, Reward: 724.3742, Test: 803.8940 [75.34], Avg: 575.6474 (0.548)
Ep: 200, Reward: 787.0952, Test: 820.4059 [42.57], Avg: 576.6533 (0.547)
Ep: 201, Reward: 766.8793, Test: 813.7735 [117.88], Avg: 577.2436 (0.545)
Ep: 202, Reward: 741.4838, Test: 777.9015 [101.37], Avg: 577.7327 (0.543)
Ep: 203, Reward: 835.9668, Test: 844.9154 [47.55], Avg: 578.8093 (0.542)
Ep: 204, Reward: 764.2879, Test: 849.5155 [72.48], Avg: 579.7762 (0.540)
Ep: 205, Reward: 899.4432, Test: 855.2513 [29.74], Avg: 580.9691 (0.539)
Ep: 206, Reward: 772.7134, Test: 872.0140 [36.15], Avg: 582.2005 (0.537)
Ep: 207, Reward: 939.3994, Test: 810.2161 [132.55], Avg: 582.6595 (0.535)
Ep: 208, Reward: 812.9664, Test: 774.1819 [141.86], Avg: 582.8971 (0.534)
Ep: 209, Reward: 871.0193, Test: 826.8204 [79.13], Avg: 583.6818 (0.532)
Ep: 210, Reward: 895.1344, Test: 870.8738 [26.61], Avg: 584.9168 (0.530)
Ep: 211, Reward: 862.3860, Test: 876.3458 [50.85], Avg: 586.0516 (0.529)
Ep: 212, Reward: 900.9220, Test: 776.6871 [112.16], Avg: 586.4200 (0.527)
Ep: 213, Reward: 774.4176, Test: 724.6811 [161.09], Avg: 586.3133 (0.526)
Ep: 214, Reward: 810.9196, Test: 884.6491 [35.26], Avg: 587.5369 (0.524)
Ep: 215, Reward: 756.4191, Test: 791.2135 [134.34], Avg: 587.8579 (0.523)
Ep: 216, Reward: 869.4811, Test: 832.0670 [57.31], Avg: 588.7192 (0.521)
Ep: 217, Reward: 839.0002, Test: 807.1337 [62.60], Avg: 589.4340 (0.519)
Ep: 218, Reward: 792.7953, Test: 836.0126 [74.34], Avg: 590.2204 (0.518)
Ep: 219, Reward: 882.5302, Test: 841.2253 [61.31], Avg: 591.0827 (0.516)
Ep: 220, Reward: 801.5504, Test: 699.1253 [201.10], Avg: 590.6616 (0.515)
Ep: 221, Reward: 788.4672, Test: 694.5251 [189.50], Avg: 590.2759 (0.513)
Ep: 222, Reward: 694.8332, Test: 810.5279 [77.49], Avg: 590.9160 (0.512)
Ep: 223, Reward: 702.2531, Test: 729.9292 [142.27], Avg: 590.9015 (0.510)
Ep: 224, Reward: 764.1008, Test: 777.4281 [108.12], Avg: 591.2499 (0.509)
Ep: 225, Reward: 828.2438, Test: 718.9942 [210.42], Avg: 590.8841 (0.507)
Ep: 226, Reward: 665.3485, Test: 675.9595 [221.11], Avg: 590.2848 (0.506)
Ep: 227, Reward: 711.1502, Test: 702.1664 [215.43], Avg: 589.8307 (0.504)
Ep: 228, Reward: 692.5540, Test: 711.3929 [166.74], Avg: 589.6334 (0.503)
Ep: 229, Reward: 608.7353, Test: 466.8314 [227.04], Avg: 588.1124 (0.501)
Ep: 230, Reward: 705.9023, Test: 724.0521 [155.05], Avg: 588.0296 (0.500)
Ep: 231, Reward: 750.9581, Test: 716.2525 [200.52], Avg: 587.7180 (0.498)
Ep: 232, Reward: 830.8299, Test: 807.5961 [62.10], Avg: 588.3951 (0.497)
Ep: 233, Reward: 801.0536, Test: 738.3520 [181.83], Avg: 588.2589 (0.495)
Ep: 234, Reward: 760.3897, Test: 712.7716 [200.35], Avg: 587.9362 (0.494)
Ep: 235, Reward: 670.5642, Test: 697.2840 [162.49], Avg: 587.7110 (0.492)
Ep: 236, Reward: 690.1092, Test: 672.8161 [243.63], Avg: 587.0421 (0.491)
Ep: 237, Reward: 624.5901, Test: 650.8778 [220.59], Avg: 586.3835 (0.489)
Ep: 238, Reward: 667.8329, Test: 653.6683 [213.45], Avg: 585.7720 (0.488)
Ep: 239, Reward: 697.6642, Test: 747.4997 [183.72], Avg: 585.6803 (0.486)
Ep: 240, Reward: 629.3965, Test: 671.2966 [186.81], Avg: 585.2604 (0.485)
Ep: 241, Reward: 779.8073, Test: 645.2180 [180.87], Avg: 584.7608 (0.483)
Ep: 242, Reward: 682.9401, Test: 691.5602 [238.77], Avg: 584.2177 (0.482)
Ep: 243, Reward: 734.6213, Test: 802.1030 [124.65], Avg: 584.5999 (0.480)
Ep: 244, Reward: 773.2332, Test: 734.9034 [185.75], Avg: 584.4552 (0.479)
Ep: 245, Reward: 794.7815, Test: 704.5889 [166.49], Avg: 584.2668 (0.478)
Ep: 246, Reward: 741.6401, Test: 681.9880 [229.05], Avg: 583.7351 (0.476)
Ep: 247, Reward: 734.0023, Test: 609.6368 [204.42], Avg: 583.0152 (0.475)
Ep: 248, Reward: 731.0080, Test: 708.2496 [181.07], Avg: 582.7910 (0.473)
Ep: 249, Reward: 735.3415, Test: 675.6457 [203.43], Avg: 582.3487 (0.472)
Ep: 250, Reward: 730.4766, Test: 783.8154 [147.71], Avg: 582.5628 (0.470)
Ep: 251, Reward: 791.6649, Test: 803.8497 [77.48], Avg: 583.1335 (0.469)
Ep: 252, Reward: 790.1525, Test: 793.9134 [85.24], Avg: 583.6297 (0.468)
Ep: 253, Reward: 784.1968, Test: 696.9637 [154.84], Avg: 583.4663 (0.466)
Ep: 254, Reward: 708.3163, Test: 811.3899 [74.60], Avg: 584.0676 (0.465)
Ep: 255, Reward: 775.6791, Test: 755.1642 [178.48], Avg: 584.0387 (0.463)
Ep: 256, Reward: 734.3772, Test: 794.2333 [102.68], Avg: 584.4571 (0.462)
Ep: 257, Reward: 785.2553, Test: 777.7500 [164.50], Avg: 584.5687 (0.461)
Ep: 258, Reward: 732.2059, Test: 805.2971 [133.48], Avg: 584.9055 (0.459)
Ep: 259, Reward: 759.1097, Test: 718.2760 [186.09], Avg: 584.7028 (0.458)
Ep: 260, Reward: 810.5341, Test: 810.7059 [76.31], Avg: 585.2763 (0.456)
Ep: 261, Reward: 772.8092, Test: 776.7849 [164.19], Avg: 585.3806 (0.455)
Ep: 262, Reward: 712.4901, Test: 675.0991 [267.90], Avg: 584.7031 (0.454)
Ep: 263, Reward: 757.9596, Test: 759.3709 [149.02], Avg: 584.8002 (0.452)
Ep: 264, Reward: 790.5162, Test: 688.1929 [211.50], Avg: 584.3922 (0.451)
Ep: 265, Reward: 831.4977, Test: 789.5285 [102.79], Avg: 584.7770 (0.450)
Ep: 266, Reward: 805.8141, Test: 696.2776 [266.82], Avg: 584.1953 (0.448)
Ep: 267, Reward: 816.0367, Test: 736.0022 [222.43], Avg: 583.9317 (0.447)
Ep: 268, Reward: 779.7809, Test: 644.6663 [215.75], Avg: 583.3555 (0.446)
Ep: 269, Reward: 753.5302, Test: 790.1284 [141.60], Avg: 583.5969 (0.444)
Ep: 270, Reward: 771.3129, Test: 743.8512 [240.58], Avg: 583.3005 (0.443)
Ep: 271, Reward: 755.7163, Test: 820.6910 [59.40], Avg: 583.9548 (0.442)
Ep: 272, Reward: 825.8782, Test: 770.4979 [205.00], Avg: 583.8872 (0.440)
Ep: 273, Reward: 833.3369, Test: 788.4069 [143.37], Avg: 584.1104 (0.439)
Ep: 274, Reward: 846.6039, Test: 750.2780 [155.55], Avg: 584.1490 (0.438)
Ep: 275, Reward: 745.3314, Test: 841.9339 [61.94], Avg: 584.8586 (0.436)
Ep: 276, Reward: 817.4835, Test: 720.3425 [182.00], Avg: 584.6907 (0.435)
Ep: 277, Reward: 769.1203, Test: 767.4913 [168.35], Avg: 584.7427 (0.434)
Ep: 278, Reward: 830.9838, Test: 696.1625 [211.57], Avg: 584.3837 (0.432)
Ep: 279, Reward: 794.3179, Test: 869.3785 [31.79], Avg: 585.2880 (0.431)
Ep: 280, Reward: 739.0978, Test: 763.2051 [129.43], Avg: 585.4606 (0.430)
Ep: 281, Reward: 850.2530, Test: 797.1867 [106.75], Avg: 585.8328 (0.429)
Ep: 282, Reward: 819.2721, Test: 744.5569 [173.83], Avg: 585.7794 (0.427)
Ep: 283, Reward: 780.2397, Test: 836.9374 [86.65], Avg: 586.3587 (0.426)
Ep: 284, Reward: 805.4228, Test: 827.4097 [81.01], Avg: 586.9202 (0.425)
Ep: 285, Reward: 812.1787, Test: 770.5580 [141.17], Avg: 587.0687 (0.423)
Ep: 286, Reward: 779.2335, Test: 660.1155 [249.68], Avg: 586.4533 (0.422)
Ep: 287, Reward: 768.0350, Test: 786.8853 [124.73], Avg: 586.7161 (0.421)
Ep: 288, Reward: 826.0048, Test: 742.5264 [204.32], Avg: 586.5483 (0.420)
Ep: 289, Reward: 781.5629, Test: 774.7011 [164.35], Avg: 586.6304 (0.418)
Ep: 290, Reward: 864.1424, Test: 855.2820 [28.69], Avg: 587.4550 (0.417)
Ep: 291, Reward: 773.9164, Test: 767.0934 [177.27], Avg: 587.4631 (0.416)
Ep: 292, Reward: 806.0444, Test: 689.0590 [219.31], Avg: 587.0613 (0.415)
Ep: 293, Reward: 789.5874, Test: 721.9902 [189.82], Avg: 586.8746 (0.413)
Ep: 294, Reward: 731.9063, Test: 656.4400 [204.96], Avg: 586.4156 (0.412)
Ep: 295, Reward: 713.2532, Test: 728.5477 [217.42], Avg: 586.1613 (0.411)
Ep: 296, Reward: 794.2770, Test: 837.1369 [67.15], Avg: 586.7802 (0.410)
Ep: 297, Reward: 809.3344, Test: 697.7455 [217.47], Avg: 586.4228 (0.408)
Ep: 298, Reward: 764.3349, Test: 723.3056 [212.83], Avg: 586.1688 (0.407)
Ep: 299, Reward: 760.0560, Test: 779.6033 [163.87], Avg: 586.2674 (0.406)
Ep: 300, Reward: 699.6773, Test: 738.3186 [153.60], Avg: 586.2622 (0.405)
Ep: 301, Reward: 793.5038, Test: 776.3299 [158.98], Avg: 586.3651 (0.404)
Ep: 302, Reward: 779.2952, Test: 743.5061 [154.96], Avg: 586.3723 (0.402)
Ep: 303, Reward: 782.1746, Test: 785.0637 [162.19], Avg: 586.4924 (0.401)
Ep: 304, Reward: 867.5080, Test: 751.0105 [81.66], Avg: 586.7641 (0.400)
Ep: 305, Reward: 785.1490, Test: 719.2889 [196.53], Avg: 586.5549 (0.399)
Ep: 306, Reward: 753.7213, Test: 837.7310 [106.89], Avg: 587.0249 (0.398)
Ep: 307, Reward: 811.2314, Test: 746.3611 [201.29], Avg: 586.8887 (0.396)
Ep: 308, Reward: 823.8313, Test: 835.2988 [62.42], Avg: 587.4906 (0.395)
Ep: 309, Reward: 841.8892, Test: 851.5259 [32.46], Avg: 588.2376 (0.394)
Ep: 310, Reward: 756.6258, Test: 696.3062 [221.07], Avg: 587.8743 (0.393)
Ep: 311, Reward: 759.0832, Test: 793.8141 [179.56], Avg: 587.9588 (0.392)
Ep: 312, Reward: 806.8864, Test: 815.4911 [116.76], Avg: 588.3128 (0.390)
Ep: 313, Reward: 869.1459, Test: 851.2856 [46.49], Avg: 589.0022 (0.389)
Ep: 314, Reward: 877.5568, Test: 842.2378 [74.29], Avg: 589.5703 (0.388)
Ep: 315, Reward: 836.9486, Test: 793.9930 [157.69], Avg: 589.7182 (0.387)
Ep: 316, Reward: 812.8583, Test: 722.3233 [249.03], Avg: 589.3509 (0.386)
Ep: 317, Reward: 846.2050, Test: 788.9196 [169.08], Avg: 589.4467 (0.385)
Ep: 318, Reward: 817.1753, Test: 795.9895 [111.87], Avg: 589.7435 (0.383)
Ep: 319, Reward: 826.8090, Test: 824.3746 [56.01], Avg: 590.3017 (0.382)
Ep: 320, Reward: 818.5601, Test: 871.8147 [25.01], Avg: 591.1008 (0.381)
Ep: 321, Reward: 879.0169, Test: 815.9443 [89.83], Avg: 591.5201 (0.380)
Ep: 322, Reward: 812.2192, Test: 819.3515 [109.37], Avg: 591.8868 (0.379)
Ep: 323, Reward: 894.6014, Test: 880.0519 [26.02], Avg: 592.6959 (0.378)
Ep: 324, Reward: 884.0571, Test: 852.0275 [65.77], Avg: 593.2915 (0.377)
Ep: 325, Reward: 883.6845, Test: 786.4094 [103.11], Avg: 593.5676 (0.376)
Ep: 326, Reward: 833.1516, Test: 860.6586 [51.54], Avg: 594.2268 (0.374)
Ep: 327, Reward: 767.0716, Test: 856.4912 [54.31], Avg: 594.8608 (0.373)
Ep: 328, Reward: 818.1752, Test: 858.7968 [34.20], Avg: 595.5591 (0.372)
Ep: 329, Reward: 844.4343, Test: 731.0693 [153.56], Avg: 595.5044 (0.371)
Ep: 330, Reward: 870.1769, Test: 818.5495 [78.77], Avg: 595.9402 (0.370)
Ep: 331, Reward: 877.7758, Test: 750.0343 [219.60], Avg: 595.7429 (0.369)
Ep: 332, Reward: 808.0222, Test: 869.7329 [14.10], Avg: 596.5234 (0.368)
Ep: 333, Reward: 829.6187, Test: 792.8519 [110.67], Avg: 596.7798 (0.367)
Ep: 334, Reward: 860.7909, Test: 803.7785 [219.80], Avg: 596.7416 (0.365)
Ep: 335, Reward: 858.8262, Test: 771.5212 [130.32], Avg: 596.8739 (0.364)
Ep: 336, Reward: 813.3485, Test: 846.8877 [51.90], Avg: 597.4618 (0.363)
Ep: 337, Reward: 843.1481, Test: 879.2592 [22.57], Avg: 598.2288 (0.362)
Ep: 338, Reward: 847.5993, Test: 839.4740 [64.47], Avg: 598.7502 (0.361)
Ep: 339, Reward: 855.4219, Test: 848.4567 [71.28], Avg: 599.2750 (0.360)
Ep: 340, Reward: 881.4024, Test: 812.2213 [97.23], Avg: 599.6143 (0.359)
Ep: 341, Reward: 831.0240, Test: 830.9372 [98.61], Avg: 600.0024 (0.358)
Ep: 342, Reward: 878.4443, Test: 860.8234 [29.41], Avg: 600.6771 (0.357)
Ep: 343, Reward: 821.1581, Test: 839.6952 [33.55], Avg: 601.2744 (0.356)
Ep: 344, Reward: 814.4813, Test: 820.6303 [75.89], Avg: 601.6902 (0.355)
Ep: 345, Reward: 840.1403, Test: 858.4703 [39.90], Avg: 602.3170 (0.354)
Ep: 346, Reward: 805.5628, Test: 810.6278 [150.55], Avg: 602.4835 (0.353)
Ep: 347, Reward: 852.6140, Test: 798.4118 [105.72], Avg: 602.7427 (0.351)
Ep: 348, Reward: 904.5789, Test: 713.2423 [208.16], Avg: 602.4629 (0.350)
Ep: 349, Reward: 830.3248, Test: 834.5901 [70.11], Avg: 602.9258 (0.349)
Ep: 350, Reward: 843.1624, Test: 846.8592 [61.19], Avg: 603.4464 (0.348)
Ep: 351, Reward: 867.9870, Test: 879.3808 [16.89], Avg: 604.1823 (0.347)
Ep: 352, Reward: 867.8146, Test: 872.4680 [17.24], Avg: 604.8935 (0.346)
Ep: 353, Reward: 822.2748, Test: 810.4606 [139.21], Avg: 605.0809 (0.345)
Ep: 354, Reward: 828.9664, Test: 840.9848 [67.02], Avg: 605.5567 (0.344)
Ep: 355, Reward: 882.0865, Test: 889.6625 [18.37], Avg: 606.3031 (0.343)
Ep: 356, Reward: 820.4459, Test: 848.4616 [50.81], Avg: 606.8391 (0.342)
Ep: 357, Reward: 911.0493, Test: 847.3077 [78.19], Avg: 607.2924 (0.341)
Ep: 358, Reward: 853.3123, Test: 875.0566 [25.92], Avg: 607.9661 (0.340)
Ep: 359, Reward: 892.8424, Test: 805.7060 [162.46], Avg: 608.0641 (0.339)
Ep: 360, Reward: 871.2337, Test: 782.1080 [169.02], Avg: 608.0780 (0.338)
Ep: 361, Reward: 807.9596, Test: 881.5451 [17.40], Avg: 608.7854 (0.337)
Ep: 362, Reward: 853.1380, Test: 810.5366 [105.59], Avg: 609.0503 (0.336)
Ep: 363, Reward: 870.8511, Test: 878.3070 [36.66], Avg: 609.6893 (0.335)
Ep: 364, Reward: 915.7095, Test: 865.3912 [45.42], Avg: 610.2654 (0.334)
Ep: 365, Reward: 863.5719, Test: 863.4563 [32.25], Avg: 610.8691 (0.333)
Ep: 366, Reward: 904.7001, Test: 822.5786 [149.54], Avg: 611.0384 (0.332)
Ep: 367, Reward: 845.6470, Test: 845.1496 [87.07], Avg: 611.4380 (0.331)
Ep: 368, Reward: 915.6578, Test: 860.2904 [25.01], Avg: 612.0446 (0.330)
Ep: 369, Reward: 889.0478, Test: 871.7322 [19.69], Avg: 612.6933 (0.329)
Ep: 370, Reward: 883.2732, Test: 836.2947 [62.92], Avg: 613.1264 (0.328)
Ep: 371, Reward: 876.1476, Test: 875.5160 [43.16], Avg: 613.7157 (0.327)
Ep: 372, Reward: 877.6165, Test: 832.0596 [115.95], Avg: 613.9902 (0.326)
Ep: 373, Reward: 865.7544, Test: 877.4632 [17.91], Avg: 614.6468 (0.325)
Ep: 374, Reward: 872.3684, Test: 842.1454 [63.90], Avg: 615.0831 (0.324)
Ep: 375, Reward: 898.7150, Test: 865.3358 [35.43], Avg: 615.6544 (0.323)
Ep: 376, Reward: 873.0327, Test: 820.5827 [107.06], Avg: 615.9140 (0.322)
Ep: 377, Reward: 848.4521, Test: 781.7819 [186.09], Avg: 615.8605 (0.321)
Ep: 378, Reward: 847.6506, Test: 883.8625 [29.31], Avg: 616.4903 (0.320)
Ep: 379, Reward: 948.9791, Test: 818.1834 [89.01], Avg: 616.7869 (0.319)
Ep: 380, Reward: 875.6398, Test: 883.2226 [19.49], Avg: 617.4350 (0.318)
Ep: 381, Reward: 811.9983, Test: 848.8650 [23.64], Avg: 617.9790 (0.317)
Ep: 382, Reward: 841.7764, Test: 846.8630 [68.04], Avg: 618.3989 (0.316)
Ep: 383, Reward: 888.8677, Test: 862.4718 [32.79], Avg: 618.9491 (0.315)
Ep: 384, Reward: 859.6401, Test: 873.3203 [29.33], Avg: 619.5337 (0.315)
Ep: 385, Reward: 869.5813, Test: 854.5522 [33.77], Avg: 620.0550 (0.314)
Ep: 386, Reward: 855.8042, Test: 815.1710 [70.68], Avg: 620.3766 (0.313)
Ep: 387, Reward: 892.4005, Test: 850.0489 [57.65], Avg: 620.8200 (0.312)
Ep: 388, Reward: 837.4065, Test: 846.4431 [25.07], Avg: 621.3355 (0.311)
Ep: 389, Reward: 889.5883, Test: 859.4380 [70.33], Avg: 621.7657 (0.310)
Ep: 390, Reward: 839.7357, Test: 862.2145 [32.50], Avg: 622.2976 (0.309)
Ep: 391, Reward: 833.7042, Test: 871.5464 [44.35], Avg: 622.8203 (0.308)
Ep: 392, Reward: 845.2703, Test: 813.2789 [90.12], Avg: 623.0756 (0.307)
Ep: 393, Reward: 844.3567, Test: 814.5022 [114.86], Avg: 623.2699 (0.306)
Ep: 394, Reward: 841.0849, Test: 845.3097 [32.37], Avg: 623.7501 (0.305)
Ep: 395, Reward: 877.8560, Test: 871.0308 [17.46], Avg: 624.3304 (0.304)
Ep: 396, Reward: 875.6158, Test: 816.9010 [74.31], Avg: 624.6283 (0.303)
Ep: 397, Reward: 889.0428, Test: 853.9193 [31.14], Avg: 625.1262 (0.302)
Ep: 398, Reward: 846.9323, Test: 751.9717 [190.44], Avg: 624.9668 (0.302)
Ep: 399, Reward: 854.7672, Test: 812.8031 [99.41], Avg: 625.1879 (0.301)
Ep: 400, Reward: 891.1902, Test: 891.6938 [26.04], Avg: 625.7875 (0.300)
Ep: 401, Reward: 881.3535, Test: 870.1468 [35.67], Avg: 626.3067 (0.299)
Ep: 402, Reward: 856.5365, Test: 840.2365 [68.69], Avg: 626.6670 (0.298)
Ep: 403, Reward: 870.8841, Test: 844.2094 [40.37], Avg: 627.1056 (0.297)
Ep: 404, Reward: 828.0967, Test: 862.0956 [41.53], Avg: 627.5833 (0.296)
Ep: 405, Reward: 858.7927, Test: 825.5173 [110.24], Avg: 627.7993 (0.295)
Ep: 406, Reward: 890.0633, Test: 861.7869 [36.22], Avg: 628.2852 (0.294)
Ep: 407, Reward: 886.5226, Test: 839.9796 [80.02], Avg: 628.6079 (0.294)
Ep: 408, Reward: 853.0056, Test: 857.1648 [39.38], Avg: 629.0704 (0.293)
Ep: 409, Reward: 863.5398, Test: 852.1781 [82.14], Avg: 629.4143 (0.292)
Ep: 410, Reward: 796.0340, Test: 853.1168 [29.36], Avg: 629.8871 (0.291)
Ep: 411, Reward: 852.5219, Test: 878.5022 [10.70], Avg: 630.4646 (0.290)
Ep: 412, Reward: 853.4757, Test: 869.3394 [23.14], Avg: 630.9870 (0.289)
Ep: 413, Reward: 847.3765, Test: 866.6153 [32.28], Avg: 631.4781 (0.288)
Ep: 414, Reward: 855.4793, Test: 840.5409 [98.51], Avg: 631.7445 (0.287)
Ep: 415, Reward: 892.9850, Test: 870.9133 [20.86], Avg: 632.2693 (0.287)
Ep: 416, Reward: 829.3661, Test: 850.4796 [66.24], Avg: 632.6337 (0.286)
Ep: 417, Reward: 876.4696, Test: 855.3434 [88.19], Avg: 632.9556 (0.285)
Ep: 418, Reward: 900.9273, Test: 879.3808 [20.87], Avg: 633.4939 (0.284)
Ep: 419, Reward: 831.7552, Test: 875.4811 [26.59], Avg: 634.0067 (0.283)
Ep: 420, Reward: 879.9866, Test: 860.8333 [52.64], Avg: 634.4205 (0.282)
Ep: 421, Reward: 882.8833, Test: 814.5806 [107.25], Avg: 634.5933 (0.281)
Ep: 422, Reward: 815.9595, Test: 853.5074 [66.06], Avg: 634.9546 (0.281)
Ep: 423, Reward: 860.2188, Test: 875.6950 [22.93], Avg: 635.4683 (0.280)
Ep: 424, Reward: 882.2874, Test: 832.5933 [64.52], Avg: 635.7803 (0.279)
Ep: 425, Reward: 883.2690, Test: 849.0588 [68.49], Avg: 636.1202 (0.278)
Ep: 426, Reward: 848.9886, Test: 846.1616 [40.17], Avg: 636.5180 (0.277)
Ep: 427, Reward: 893.1851, Test: 818.2398 [146.82], Avg: 636.5996 (0.276)
Ep: 428, Reward: 850.9705, Test: 859.2393 [29.59], Avg: 637.0496 (0.276)
Ep: 429, Reward: 921.2211, Test: 829.0004 [67.60], Avg: 637.3388 (0.275)
Ep: 430, Reward: 862.0152, Test: 845.9101 [66.89], Avg: 637.6675 (0.274)
Ep: 431, Reward: 839.6635, Test: 842.7110 [59.73], Avg: 638.0039 (0.273)
Ep: 432, Reward: 873.5550, Test: 842.9018 [68.79], Avg: 638.3182 (0.272)
Ep: 433, Reward: 839.2169, Test: 869.6031 [11.41], Avg: 638.8248 (0.271)
Ep: 434, Reward: 830.5660, Test: 854.0911 [18.98], Avg: 639.2761 (0.271)
Ep: 435, Reward: 836.7248, Test: 848.2533 [41.44], Avg: 639.6603 (0.270)
Ep: 436, Reward: 784.8313, Test: 865.0197 [26.95], Avg: 640.1144 (0.269)
Ep: 437, Reward: 818.3558, Test: 851.3033 [21.32], Avg: 640.5478 (0.268)
Ep: 438, Reward: 851.7569, Test: 857.1471 [23.91], Avg: 640.9868 (0.267)
Ep: 439, Reward: 867.4087, Test: 854.5059 [40.27], Avg: 641.3805 (0.267)
Ep: 440, Reward: 880.7963, Test: 880.5490 [24.55], Avg: 641.8672 (0.266)
Ep: 441, Reward: 926.3820, Test: 841.3408 [70.33], Avg: 642.1594 (0.265)
Ep: 442, Reward: 872.4251, Test: 876.4491 [21.28], Avg: 642.6402 (0.264)
Ep: 443, Reward: 859.9083, Test: 851.0286 [64.44], Avg: 642.9644 (0.263)
Ep: 444, Reward: 879.3895, Test: 881.6963 [15.03], Avg: 643.4671 (0.263)
Ep: 445, Reward: 871.8470, Test: 820.2002 [82.73], Avg: 643.6779 (0.262)
Ep: 446, Reward: 892.2684, Test: 849.0491 [50.68], Avg: 644.0240 (0.261)
Ep: 447, Reward: 866.5997, Test: 839.2670 [73.32], Avg: 644.2961 (0.260)
Ep: 448, Reward: 872.1130, Test: 852.2278 [71.54], Avg: 644.5999 (0.259)
Ep: 449, Reward: 867.0954, Test: 804.9036 [173.59], Avg: 644.5703 (0.259)
Ep: 450, Reward: 839.7266, Test: 836.6383 [79.73], Avg: 644.8194 (0.258)
Ep: 451, Reward: 902.8857, Test: 777.1566 [200.85], Avg: 644.6678 (0.257)
Ep: 452, Reward: 892.0188, Test: 869.9791 [21.88], Avg: 645.1169 (0.256)
Ep: 453, Reward: 878.6759, Test: 865.9049 [69.20], Avg: 645.4508 (0.256)
Ep: 454, Reward: 841.1793, Test: 875.1961 [29.22], Avg: 645.8915 (0.255)
Ep: 455, Reward: 849.7214, Test: 861.2517 [31.62], Avg: 646.2945 (0.254)
Ep: 456, Reward: 839.0642, Test: 840.9678 [49.89], Avg: 646.6113 (0.253)
Ep: 457, Reward: 855.0073, Test: 851.3071 [48.26], Avg: 646.9528 (0.253)
Ep: 458, Reward: 855.6347, Test: 843.2916 [70.26], Avg: 647.2275 (0.252)
Ep: 459, Reward: 832.4486, Test: 842.9224 [101.97], Avg: 647.4313 (0.251)
Ep: 460, Reward: 856.6513, Test: 860.3353 [69.07], Avg: 647.7433 (0.250)
Ep: 461, Reward: 896.0958, Test: 858.1631 [59.28], Avg: 648.0704 (0.250)
Ep: 462, Reward: 853.8205, Test: 879.8223 [17.27], Avg: 648.5336 (0.249)
Ep: 463, Reward: 880.6407, Test: 820.3331 [139.14], Avg: 648.6040 (0.248)
Ep: 464, Reward: 834.9941, Test: 848.1840 [76.61], Avg: 648.8685 (0.247)
Ep: 465, Reward: 905.7167, Test: 866.2629 [22.10], Avg: 649.2876 (0.247)
Ep: 466, Reward: 917.9272, Test: 865.5495 [36.85], Avg: 649.6718 (0.246)
Ep: 467, Reward: 873.2004, Test: 862.6539 [82.27], Avg: 649.9511 (0.245)
Ep: 468, Reward: 856.6237, Test: 868.8522 [34.82], Avg: 650.3435 (0.244)
Ep: 469, Reward: 896.4448, Test: 844.3782 [95.76], Avg: 650.5526 (0.244)
Ep: 470, Reward: 827.3859, Test: 838.7919 [77.60], Avg: 650.7876 (0.243)
Ep: 471, Reward: 888.7112, Test: 869.8123 [26.63], Avg: 651.1952 (0.242)
Ep: 472, Reward: 902.0567, Test: 870.2667 [16.10], Avg: 651.6243 (0.241)
Ep: 473, Reward: 904.1465, Test: 835.7175 [110.77], Avg: 651.7790 (0.241)
Ep: 474, Reward: 944.8511, Test: 834.0048 [77.98], Avg: 651.9984 (0.240)
Ep: 475, Reward: 898.9065, Test: 840.1841 [85.87], Avg: 652.2134 (0.239)
Ep: 476, Reward: 842.2488, Test: 805.3814 [136.04], Avg: 652.2493 (0.239)
Ep: 477, Reward: 855.8201, Test: 849.3660 [36.58], Avg: 652.5851 (0.238)
Ep: 478, Reward: 830.3079, Test: 827.1137 [126.48], Avg: 652.6854 (0.237)
Ep: 479, Reward: 778.9573, Test: 875.7107 [29.95], Avg: 653.0877 (0.236)
Ep: 480, Reward: 815.3511, Test: 784.1688 [175.17], Avg: 652.9960 (0.236)
Ep: 481, Reward: 896.2271, Test: 878.5599 [31.53], Avg: 653.3986 (0.235)
Ep: 482, Reward: 883.4751, Test: 876.0711 [29.47], Avg: 653.7986 (0.234)
Ep: 483, Reward: 833.4528, Test: 859.1696 [44.27], Avg: 654.1314 (0.234)
Ep: 484, Reward: 877.7755, Test: 788.3216 [151.96], Avg: 654.0948 (0.233)
Ep: 485, Reward: 843.5972, Test: 849.1290 [60.07], Avg: 654.3725 (0.232)
Ep: 486, Reward: 907.7961, Test: 800.2760 [129.76], Avg: 654.4056 (0.231)
Ep: 487, Reward: 802.2192, Test: 841.2769 [38.18], Avg: 654.7103 (0.231)
Ep: 488, Reward: 883.9432, Test: 850.4437 [83.84], Avg: 654.9392 (0.230)
Ep: 489, Reward: 904.8069, Test: 877.2367 [32.33], Avg: 655.3268 (0.229)
Ep: 490, Reward: 859.2933, Test: 825.1289 [69.56], Avg: 655.5310 (0.229)
Ep: 491, Reward: 870.5866, Test: 849.2426 [57.95], Avg: 655.8069 (0.228)
Ep: 492, Reward: 872.4117, Test: 802.7843 [98.94], Avg: 655.9044 (0.227)
Ep: 493, Reward: 826.7741, Test: 832.0215 [95.60], Avg: 656.0674 (0.227)
Ep: 494, Reward: 830.5223, Test: 817.2349 [67.30], Avg: 656.2570 (0.226)
Ep: 495, Reward: 907.4822, Test: 772.1295 [174.72], Avg: 656.1383 (0.225)
Ep: 496, Reward: 857.2785, Test: 777.2128 [186.08], Avg: 656.0076 (0.225)
Ep: 497, Reward: 857.1193, Test: 846.9163 [41.19], Avg: 656.3082 (0.224)
Ep: 498, Reward: 813.6069, Test: 784.4640 [136.83], Avg: 656.2908 (0.223)
Ep: 499, Reward: 855.6848, Test: 814.9405 [89.77], Avg: 656.4286 (0.223)
