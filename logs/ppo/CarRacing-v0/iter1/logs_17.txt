Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.2                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 8					# Number of samples to train on for each train step
PPO_EPOCHS = 8					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.005				# The limit of the ratio of new action probabilities to old probabilities
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 20					# The number of steps to collect experience in sequence for each GAE calculation
ADVANTAGE_DECAY = 0.99			# The discount factor for the cumulative GAE calculation

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			value = self.critic_local(state.to(self.device))
			return value

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=1, clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) + critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)
		self.replay_buffer = PrioritizedReplayBuffer()
		self.ppo_epochs = PPO_EPOCHS
		self.ppo_batch = BATCH_SIZE

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**0.0)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(zip(states, actions, log_probs, targets, advantages))
			for _ in range(self.ppo_epochs):
				# self.replay_buffer.reset_priorities()
				for _ in range(update_freq):
					(state, action, log_prob, target, advantage), indices, importances = self.replay_buffer.sample(self.ppo_batch, dtype=torch.stack)
					errors = self.network.optimize(state, action, log_prob, target, advantage, importances**(1-self.eps))
					self.replay_buffer.update_priorities(indices, errors)
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.96			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.0225               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -46.6513, Test: -25.6992 [11.14], Avg: -36.8433 (0.997)
Ep: 1, Reward: -42.9698, Test: -17.4895 [16.19], Avg: -35.2621 (0.994)
Ep: 2, Reward: -38.7734, Test: -21.1361 [17.35], Avg: -36.3357 (0.991)
Ep: 3, Reward: -36.2430, Test: -23.3962 [16.23], Avg: -37.1591 (0.988)
Ep: 4, Reward: -31.9437, Test: -21.0570 [14.70], Avg: -36.8781 (0.985)
Ep: 5, Reward: -28.7220, Test: -20.2961 [18.51], Avg: -37.2000 (0.982)
Ep: 6, Reward: -30.7731, Test: -24.3870 [15.16], Avg: -37.5352 (0.979)
Ep: 7, Reward: -30.6458, Test: -18.8243 [15.65], Avg: -37.1531 (0.976)
Ep: 8, Reward: -29.9900, Test: -19.2528 [17.38], Avg: -37.0952 (0.973)
Ep: 9, Reward: -29.9735, Test: -28.4613 [6.08], Avg: -36.8395 (0.970)
Ep: 10, Reward: -25.8158, Test: -23.5788 [14.22], Avg: -36.9266 (0.967)
Ep: 11, Reward: -27.5803, Test: -17.2228 [21.49], Avg: -37.0751 (0.965)
Ep: 12, Reward: -25.8095, Test: -17.3322 [26.75], Avg: -37.6140 (0.962)
Ep: 13, Reward: -27.3961, Test: -95.8828 [48.59], Avg: -45.2465 (0.959)
Ep: 14, Reward: -30.3335, Test: -31.9410 [60.31], Avg: -48.3804 (0.956)
Ep: 15, Reward: -33.7098, Test: -118.7161 [14.61], Avg: -53.6898 (0.953)
Ep: 16, Reward: -38.7254, Test: -89.9914 [44.74], Avg: -58.4568 (0.950)
Ep: 17, Reward: -34.0441, Test: -67.5252 [55.73], Avg: -62.0566 (0.947)
Ep: 18, Reward: -30.7961, Test: -107.9304 [11.19], Avg: -65.0597 (0.945)
Ep: 19, Reward: -30.1882, Test: -49.5595 [83.86], Avg: -68.4778 (0.942)
Ep: 20, Reward: -26.9520, Test: -66.1830 [52.55], Avg: -70.8707 (0.939)
Ep: 21, Reward: -8.4514, Test: -108.6408 [34.72], Avg: -74.1657 (0.936)
Ep: 22, Reward: -25.3204, Test: -122.6278 [25.43], Avg: -77.3783 (0.933)
Ep: 23, Reward: -35.0577, Test: -77.7753 [42.42], Avg: -79.1622 (0.930)
Ep: 24, Reward: -15.5428, Test: -48.7273 [53.14], Avg: -80.0706 (0.928)
Ep: 25, Reward: -27.1421, Test: -3.8606 [45.00], Avg: -78.8703 (0.925)
Ep: 26, Reward: -28.3231, Test: 60.7693 [126.24], Avg: -78.3739 (0.922)
Ep: 27, Reward: -1.1232, Test: 104.0436 [99.22], Avg: -75.4026 (0.919)
Ep: 28, Reward: 2.8231, Test: 138.6708 [99.83], Avg: -71.4632 (0.917)
Ep: 29, Reward: 18.3616, Test: 83.9621 [143.17], Avg: -71.0548 (0.914)
Ep: 30, Reward: 128.9130, Test: 278.9330 [134.39], Avg: -64.1001 (0.911)
Ep: 31, Reward: 231.9817, Test: 221.9887 [48.27], Avg: -56.6682 (0.908)
Ep: 32, Reward: 260.9918, Test: 221.6151 [84.17], Avg: -50.7860 (0.906)
Ep: 33, Reward: 359.1080, Test: 158.3581 [79.85], Avg: -46.9833 (0.903)
Ep: 34, Reward: 428.2134, Test: 135.5465 [79.23], Avg: -44.0320 (0.900)
Ep: 35, Reward: 590.4102, Test: 274.4038 [84.00], Avg: -37.5198 (0.897)
Ep: 36, Reward: 431.7130, Test: 165.7162 [129.00], Avg: -35.5135 (0.895)
Ep: 37, Reward: 421.9693, Test: 232.5187 [118.19], Avg: -31.5702 (0.892)
Ep: 38, Reward: 538.9567, Test: 214.7030 [61.45], Avg: -26.8311 (0.889)
Ep: 39, Reward: 671.5277, Test: 211.6297 [123.13], Avg: -23.9479 (0.887)
Ep: 40, Reward: 425.5126, Test: 218.0207 [134.97], Avg: -21.3381 (0.884)
Ep: 41, Reward: 552.2549, Test: 214.3087 [183.32], Avg: -20.0921 (0.881)
Ep: 42, Reward: 622.2633, Test: 226.0790 [90.12], Avg: -16.4630 (0.879)
Ep: 43, Reward: 410.2798, Test: 210.5438 [97.13], Avg: -13.5113 (0.876)
Ep: 44, Reward: 426.6225, Test: 216.4001 [140.61], Avg: -11.5268 (0.874)
Ep: 45, Reward: 397.0505, Test: 201.3029 [93.41], Avg: -8.9306 (0.871)
Ep: 46, Reward: 262.8111, Test: 185.6003 [114.41], Avg: -7.2259 (0.868)
Ep: 47, Reward: 310.4929, Test: 184.0940 [127.77], Avg: -5.9020 (0.866)
Ep: 48, Reward: 341.6365, Test: 216.2269 [69.69], Avg: -2.7910 (0.863)
Ep: 49, Reward: 302.6748, Test: 119.0355 [92.33], Avg: -2.2010 (0.861)
Ep: 50, Reward: 297.3893, Test: 239.3698 [58.58], Avg: 1.3871 (0.858)
Ep: 51, Reward: 275.7438, Test: 203.8788 [68.65], Avg: 3.9610 (0.855)
Ep: 52, Reward: 255.5342, Test: 202.8536 [89.65], Avg: 6.0222 (0.853)
Ep: 53, Reward: 262.4060, Test: 245.2221 [94.50], Avg: 8.7018 (0.850)
Ep: 54, Reward: 248.8481, Test: 217.2363 [101.10], Avg: 10.6552 (0.848)
Ep: 55, Reward: 288.2276, Test: 213.6137 [73.96], Avg: 12.9588 (0.845)
Ep: 56, Reward: 291.8229, Test: 168.3687 [113.52], Avg: 13.6937 (0.843)
Ep: 57, Reward: 269.1746, Test: 197.3858 [137.94], Avg: 14.4826 (0.838)
Ep: 58, Reward: 291.5032, Test: 196.7469 [85.77], Avg: 16.1181 (0.835)
Ep: 59, Reward: 284.2051, Test: 185.2006 [114.28], Avg: 17.0315 (0.833)
Ep: 60, Reward: 250.3691, Test: 124.2100 [125.98], Avg: 16.7232 (0.830)
Ep: 61, Reward: 310.4024, Test: 179.4814 [127.56], Avg: 17.2909 (0.828)
Ep: 62, Reward: 338.1524, Test: 200.1560 [138.32], Avg: 17.9980 (0.825)
Ep: 63, Reward: 450.4308, Test: 199.4409 [127.61], Avg: 18.8392 (0.823)
Ep: 64, Reward: 508.0292, Test: 270.7998 [102.15], Avg: 21.1439 (0.818)
Ep: 65, Reward: 408.8085, Test: 242.1219 [85.50], Avg: 23.1966 (0.815)
Ep: 66, Reward: 392.2904, Test: 239.3580 [135.56], Avg: 24.3996 (0.813)
Ep: 67, Reward: 379.9627, Test: 125.0033 [115.92], Avg: 24.1744 (0.810)
Ep: 68, Reward: 433.9976, Test: 296.0424 [118.30], Avg: 26.4000 (0.808)
Ep: 69, Reward: 409.5453, Test: 264.0860 [137.51], Avg: 27.8311 (0.805)
Ep: 70, Reward: 393.9061, Test: 299.3197 [181.75], Avg: 29.0951 (0.803)
Ep: 71, Reward: 499.3161, Test: 160.8557 [130.65], Avg: 29.1105 (0.801)
Ep: 72, Reward: 372.6862, Test: 315.5915 [115.78], Avg: 31.4489 (0.798)
Ep: 73, Reward: 456.2548, Test: 298.5308 [121.64], Avg: 33.4143 (0.796)
Ep: 74, Reward: 417.4259, Test: 259.4094 [119.48], Avg: 34.8345 (0.793)
Ep: 75, Reward: 545.9459, Test: 246.0009 [255.41], Avg: 34.2524 (0.791)
Ep: 76, Reward: 602.2149, Test: 224.3107 [204.90], Avg: 34.0597 (0.789)
Ep: 77, Reward: 551.1808, Test: 328.0072 [148.24], Avg: 35.9277 (0.786)
Ep: 78, Reward: 507.7517, Test: 319.5742 [203.26], Avg: 36.9452 (0.784)
Ep: 79, Reward: 380.7537, Test: 235.0303 [148.56], Avg: 37.5643 (0.782)
Ep: 80, Reward: 440.2517, Test: 255.0655 [119.56], Avg: 38.7734 (0.779)
Ep: 81, Reward: 336.0533, Test: 169.9015 [148.27], Avg: 38.5645 (0.777)
Ep: 82, Reward: 381.9678, Test: 304.0741 [142.58], Avg: 40.0456 (0.775)
Ep: 83, Reward: 411.0003, Test: 351.5697 [240.44], Avg: 40.8919 (0.772)
Ep: 84, Reward: 361.6971, Test: 314.3255 [264.29], Avg: 40.9994 (0.770)
Ep: 85, Reward: 396.9986, Test: 155.4064 [147.97], Avg: 40.6091 (0.768)
Ep: 86, Reward: 353.2663, Test: 222.9970 [206.30], Avg: 40.3342 (0.765)
Ep: 87, Reward: 373.2672, Test: 296.3984 [228.20], Avg: 40.6508 (0.763)
Ep: 88, Reward: 402.0429, Test: 254.1900 [151.77], Avg: 41.3448 (0.761)
Ep: 89, Reward: 343.0475, Test: 463.2099 [179.93], Avg: 44.0330 (0.758)
Ep: 90, Reward: 524.0276, Test: 284.8812 [200.03], Avg: 44.4816 (0.756)
Ep: 91, Reward: 332.5469, Test: 295.5479 [140.54], Avg: 45.6829 (0.754)
Ep: 92, Reward: 389.6680, Test: 437.4618 [250.35], Avg: 47.2037 (0.752)
Ep: 93, Reward: 317.7332, Test: 381.4160 [216.23], Avg: 48.4589 (0.749)
Ep: 94, Reward: 394.8556, Test: 310.5294 [354.41], Avg: 47.4869 (0.747)
Ep: 95, Reward: 425.8959, Test: 647.1126 [282.60], Avg: 50.7892 (0.745)
Ep: 96, Reward: 485.6779, Test: 495.7738 [328.39], Avg: 51.9913 (0.743)
Ep: 97, Reward: 524.8211, Test: 461.6546 [357.69], Avg: 52.5216 (0.740)
Ep: 98, Reward: 471.3594, Test: 294.6884 [189.77], Avg: 53.0509 (0.738)
Ep: 99, Reward: 462.4187, Test: 239.6864 [260.17], Avg: 52.3155 (0.736)
Ep: 100, Reward: 376.1645, Test: 448.0531 [328.58], Avg: 52.9805 (0.734)
Ep: 101, Reward: 575.2646, Test: 552.4617 [285.79], Avg: 55.0755 (0.732)
Ep: 102, Reward: 536.6964, Test: 313.9112 [245.43], Avg: 55.2057 (0.729)
Ep: 103, Reward: 490.1626, Test: 638.3315 [222.79], Avg: 58.6705 (0.727)
Ep: 104, Reward: 543.4671, Test: 408.3846 [259.58], Avg: 59.5289 (0.725)
Ep: 105, Reward: 623.8763, Test: 531.9104 [288.91], Avg: 61.2598 (0.723)
Ep: 106, Reward: 742.8508, Test: 389.5226 [283.41], Avg: 61.6790 (0.721)
Ep: 107, Reward: 490.6809, Test: 585.0072 [367.55], Avg: 63.1214 (0.719)
Ep: 108, Reward: 589.4201, Test: 444.6167 [254.97], Avg: 64.2822 (0.716)
Ep: 109, Reward: 468.6391, Test: 499.2353 [346.53], Avg: 65.0861 (0.714)
Ep: 110, Reward: 597.8093, Test: 473.9542 [374.43], Avg: 65.3964 (0.712)
Ep: 111, Reward: 617.4158, Test: 516.7044 [247.10], Avg: 67.2196 (0.710)
Ep: 112, Reward: 516.8835, Test: 608.5239 [306.27], Avg: 69.2995 (0.708)
Ep: 113, Reward: 554.3551, Test: 445.4521 [326.04], Avg: 69.7391 (0.706)
Ep: 114, Reward: 421.5727, Test: 607.3843 [273.78], Avg: 72.0335 (0.704)
Ep: 115, Reward: 563.1883, Test: 571.5612 [303.30], Avg: 73.7251 (0.702)
Ep: 116, Reward: 638.6887, Test: 435.7869 [316.07], Avg: 74.1182 (0.699)
Ep: 117, Reward: 575.5381, Test: 608.0276 [342.76], Avg: 75.7381 (0.697)
Ep: 118, Reward: 510.2866, Test: 527.3785 [322.06], Avg: 76.8270 (0.695)
Ep: 119, Reward: 518.0359, Test: 617.3358 [290.48], Avg: 78.9106 (0.693)
Ep: 120, Reward: 527.8534, Test: 437.1455 [357.41], Avg: 78.9174 (0.691)
Ep: 121, Reward: 555.0082, Test: 684.3424 [266.03], Avg: 81.6993 (0.689)
Ep: 122, Reward: 447.2077, Test: 422.0445 [338.11], Avg: 81.7175 (0.687)
Ep: 123, Reward: 498.8508, Test: 633.8498 [369.70], Avg: 83.1887 (0.685)
Ep: 124, Reward: 447.8656, Test: 394.9041 [370.51], Avg: 82.7184 (0.683)
Ep: 125, Reward: 413.3772, Test: 346.3298 [224.82], Avg: 83.0262 (0.681)
Ep: 126, Reward: 503.3894, Test: 339.3429 [300.87], Avg: 82.6754 (0.679)
Ep: 127, Reward: 550.2381, Test: 576.4052 [337.83], Avg: 83.8934 (0.677)
Ep: 128, Reward: 516.9885, Test: 446.8467 [308.78], Avg: 84.3133 (0.675)
Ep: 129, Reward: 461.3538, Test: 629.7412 [314.31], Avg: 86.0912 (0.673)
Ep: 130, Reward: 542.5267, Test: 638.5577 [290.86], Avg: 88.0882 (0.671)
Ep: 131, Reward: 571.0466, Test: 725.0995 [266.56], Avg: 90.8947 (0.669)
Ep: 132, Reward: 528.2164, Test: 632.1659 [244.69], Avg: 93.1246 (0.667)
Ep: 133, Reward: 576.4654, Test: 684.9856 [346.17], Avg: 94.9581 (0.665)
Ep: 134, Reward: 498.2354, Test: 704.1221 [260.49], Avg: 97.5409 (0.663)
Ep: 135, Reward: 639.6409, Test: 430.2019 [313.13], Avg: 97.6845 (0.661)
Ep: 136, Reward: 564.7986, Test: 499.7786 [342.15], Avg: 98.1220 (0.659)
Ep: 137, Reward: 615.4837, Test: 342.0909 [375.71], Avg: 97.1674 (0.657)
Ep: 138, Reward: 578.4684, Test: 568.1684 [303.44], Avg: 98.3729 (0.655)
Ep: 139, Reward: 373.2737, Test: 531.7157 [269.95], Avg: 99.5399 (0.653)
Ep: 140, Reward: 460.1601, Test: 348.1391 [333.26], Avg: 98.9395 (0.651)
Ep: 141, Reward: 565.2182, Test: 398.5147 [360.69], Avg: 98.5092 (0.649)
Ep: 142, Reward: 620.7903, Test: 365.9068 [311.78], Avg: 98.1988 (0.647)
Ep: 143, Reward: 520.1354, Test: 336.1866 [320.93], Avg: 97.6228 (0.645)
Ep: 144, Reward: 538.9303, Test: 301.9120 [380.14], Avg: 96.4100 (0.643)
Ep: 145, Reward: 565.7978, Test: 640.1277 [330.72], Avg: 97.8689 (0.641)
Ep: 146, Reward: 636.9262, Test: 515.8344 [222.06], Avg: 99.2016 (0.639)
Ep: 147, Reward: 461.9894, Test: 658.7862 [248.09], Avg: 101.3063 (0.637)
Ep: 148, Reward: 471.6685, Test: 508.7263 [245.93], Avg: 102.3901 (0.635)
Ep: 149, Reward: 492.2857, Test: 457.6367 [355.56], Avg: 102.3880 (0.633)
Ep: 150, Reward: 507.3971, Test: 586.1017 [295.70], Avg: 103.6331 (0.631)
Ep: 151, Reward: 539.6357, Test: 407.9394 [347.55], Avg: 103.3486 (0.630)
Ep: 152, Reward: 473.0862, Test: 631.3165 [331.91], Avg: 104.6300 (0.628)
Ep: 153, Reward: 583.4332, Test: 501.4321 [256.32], Avg: 105.5422 (0.626)
Ep: 154, Reward: 408.5250, Test: 495.8479 [300.75], Avg: 106.1200 (0.624)
Ep: 155, Reward: 596.4569, Test: 450.3894 [363.47], Avg: 105.9970 (0.622)
Ep: 156, Reward: 270.2162, Test: 512.1827 [369.99], Avg: 106.2275 (0.620)
Ep: 157, Reward: 531.7847, Test: 367.3884 [344.40], Avg: 105.7007 (0.618)
Ep: 158, Reward: 451.4589, Test: 296.7873 [261.52], Avg: 105.2577 (0.616)
Ep: 159, Reward: 529.2589, Test: 365.1395 [238.04], Avg: 105.3943 (0.615)
Ep: 160, Reward: 455.6422, Test: 551.1458 [234.28], Avg: 106.7078 (0.613)
Ep: 161, Reward: 321.6543, Test: 461.9356 [301.33], Avg: 107.0405 (0.611)
Ep: 162, Reward: 510.5504, Test: 451.8720 [279.61], Avg: 107.4406 (0.609)
Ep: 163, Reward: 435.7667, Test: 425.3625 [286.18], Avg: 107.6342 (0.607)
Ep: 164, Reward: 520.2818, Test: 424.3030 [180.61], Avg: 108.4587 (0.605)
Ep: 165, Reward: 450.2202, Test: 552.7283 [240.00], Avg: 109.6893 (0.604)
Ep: 166, Reward: 585.7618, Test: 628.9671 [157.46], Avg: 111.8559 (0.602)
Ep: 167, Reward: 465.6408, Test: 439.4315 [345.60], Avg: 111.7486 (0.600)
Ep: 168, Reward: 485.0864, Test: 455.5406 [265.09], Avg: 112.2143 (0.598)
Ep: 169, Reward: 563.9545, Test: 576.4373 [319.83], Avg: 113.0637 (0.596)
Ep: 170, Reward: 577.2724, Test: 506.8046 [313.35], Avg: 113.5338 (0.595)
Ep: 171, Reward: 434.6006, Test: 595.5046 [304.79], Avg: 114.5639 (0.593)
Ep: 172, Reward: 592.6771, Test: 652.1502 [267.93], Avg: 116.1226 (0.591)
Ep: 173, Reward: 600.3768, Test: 323.6221 [394.18], Avg: 115.0497 (0.589)
Ep: 174, Reward: 616.6108, Test: 679.4325 [268.07], Avg: 116.7429 (0.588)
Ep: 175, Reward: 558.7878, Test: 590.5171 [283.88], Avg: 117.8219 (0.586)
Ep: 176, Reward: 549.2172, Test: 560.9365 [344.44], Avg: 118.3794 (0.584)
Ep: 177, Reward: 495.3691, Test: 579.9839 [310.21], Avg: 119.2299 (0.582)
Ep: 178, Reward: 506.6216, Test: 516.9789 [334.25], Avg: 119.5847 (0.581)
Ep: 179, Reward: 478.8710, Test: 544.1633 [281.18], Avg: 120.3813 (0.579)
Ep: 180, Reward: 379.2456, Test: 406.7645 [332.71], Avg: 120.1254 (0.577)
Ep: 181, Reward: 542.0323, Test: 292.6682 [320.40], Avg: 119.3129 (0.575)
Ep: 182, Reward: 531.6022, Test: 431.8157 [257.63], Avg: 119.6128 (0.574)
Ep: 183, Reward: 732.3112, Test: 638.3038 [294.33], Avg: 120.8321 (0.572)
Ep: 184, Reward: 599.0542, Test: 597.0394 [339.80], Avg: 121.5695 (0.570)
Ep: 185, Reward: 540.2394, Test: 342.6210 [352.96], Avg: 120.8603 (0.568)
Ep: 186, Reward: 564.8645, Test: 451.6906 [402.98], Avg: 120.4744 (0.567)
Ep: 187, Reward: 602.6892, Test: 473.7366 [291.97], Avg: 120.8004 (0.565)
Ep: 188, Reward: 645.1137, Test: 384.1741 [215.06], Avg: 121.0561 (0.563)
Ep: 189, Reward: 548.9860, Test: 495.1398 [339.86], Avg: 121.2362 (0.562)
Ep: 190, Reward: 542.3217, Test: 739.9331 [166.36], Avg: 123.6045 (0.560)
Ep: 191, Reward: 524.5800, Test: 213.5098 [343.14], Avg: 122.2855 (0.558)
Ep: 192, Reward: 537.6147, Test: 653.2568 [213.00], Avg: 123.9331 (0.557)
Ep: 193, Reward: 669.7446, Test: 451.7222 [329.86], Avg: 123.9224 (0.555)
Ep: 194, Reward: 623.3800, Test: 476.0814 [338.09], Avg: 123.9945 (0.553)
Ep: 195, Reward: 617.5829, Test: 545.0108 [340.71], Avg: 124.4043 (0.552)
Ep: 196, Reward: 584.3488, Test: 345.3159 [326.43], Avg: 123.8686 (0.550)
Ep: 197, Reward: 536.1855, Test: 659.9808 [345.09], Avg: 124.8334 (0.548)
Ep: 198, Reward: 636.2467, Test: 627.7234 [272.38], Avg: 125.9917 (0.547)
Ep: 199, Reward: 593.3877, Test: 438.1705 [356.58], Avg: 125.7697 (0.545)
Ep: 200, Reward: 630.0223, Test: 599.1103 [396.36], Avg: 126.1527 (0.543)
Ep: 201, Reward: 618.1964, Test: 668.7696 [338.83], Avg: 127.1615 (0.542)
Ep: 202, Reward: 737.1404, Test: 587.4842 [318.15], Avg: 127.8619 (0.540)
Ep: 203, Reward: 570.6455, Test: 786.6558 [177.50], Avg: 130.2212 (0.539)
Ep: 204, Reward: 777.3938, Test: 773.9156 [109.75], Avg: 132.8258 (0.537)
Ep: 205, Reward: 686.7782, Test: 655.2354 [263.25], Avg: 134.0838 (0.535)
Ep: 206, Reward: 659.6905, Test: 730.9964 [275.92], Avg: 135.6345 (0.534)
Ep: 207, Reward: 636.3339, Test: 579.5538 [295.94], Avg: 136.3460 (0.532)
Ep: 208, Reward: 606.7202, Test: 806.6494 [180.53], Avg: 138.6894 (0.530)
Ep: 209, Reward: 673.5812, Test: 734.3815 [205.83], Avg: 140.5458 (0.529)
Ep: 210, Reward: 794.3999, Test: 690.7605 [358.91], Avg: 141.4525 (0.527)
Ep: 211, Reward: 711.5849, Test: 694.9903 [184.19], Avg: 143.1947 (0.526)
Ep: 212, Reward: 733.0230, Test: 852.4905 [73.74], Avg: 146.1785 (0.524)
Ep: 213, Reward: 821.3679, Test: 806.5695 [162.63], Avg: 148.5045 (0.523)
Ep: 214, Reward: 835.4531, Test: 789.5024 [150.16], Avg: 150.7875 (0.521)
Ep: 215, Reward: 659.8557, Test: 727.0717 [294.59], Avg: 152.0916 (0.519)
Ep: 216, Reward: 810.5913, Test: 792.6281 [63.48], Avg: 154.7508 (0.518)
Ep: 217, Reward: 823.3450, Test: 707.4232 [209.49], Avg: 156.3251 (0.516)
Ep: 218, Reward: 791.5979, Test: 707.1698 [231.40], Avg: 157.7837 (0.515)
Ep: 219, Reward: 699.1567, Test: 750.9369 [95.99], Avg: 160.0435 (0.513)
Ep: 220, Reward: 761.4308, Test: 657.7144 [289.15], Avg: 160.9871 (0.512)
Ep: 221, Reward: 785.2573, Test: 807.7206 [101.66], Avg: 163.4424 (0.510)
Ep: 222, Reward: 784.9669, Test: 697.6352 [104.83], Avg: 165.3678 (0.509)
Ep: 223, Reward: 681.5070, Test: 521.2991 [258.77], Avg: 165.8016 (0.507)
Ep: 224, Reward: 670.4352, Test: 610.5609 [286.73], Avg: 166.5039 (0.506)
Ep: 225, Reward: 656.1368, Test: 717.3095 [186.24], Avg: 168.1170 (0.504)
Ep: 226, Reward: 749.6985, Test: 736.5014 [242.95], Avg: 169.5507 (0.503)
Ep: 227, Reward: 726.4565, Test: 766.6328 [244.69], Avg: 171.0963 (0.501)
Ep: 228, Reward: 631.3054, Test: 742.8291 [220.20], Avg: 172.6313 (0.500)
Ep: 229, Reward: 780.5967, Test: 727.6397 [132.16], Avg: 174.4698 (0.498)
Ep: 230, Reward: 604.8677, Test: 586.2627 [281.27], Avg: 175.0349 (0.497)
Ep: 231, Reward: 606.0732, Test: 621.8095 [249.11], Avg: 175.8868 (0.495)
Ep: 232, Reward: 482.7925, Test: 429.4510 [318.29], Avg: 175.6090 (0.494)
Ep: 233, Reward: 478.0233, Test: 532.3940 [234.97], Avg: 176.1296 (0.492)
Ep: 234, Reward: 522.8275, Test: 508.8722 [237.64], Avg: 176.5343 (0.491)
Ep: 235, Reward: 401.0355, Test: 152.5529 [185.26], Avg: 175.6477 (0.489)
Ep: 236, Reward: 372.9265, Test: 425.1433 [325.37], Avg: 175.3276 (0.488)
Ep: 237, Reward: 586.6261, Test: 668.7105 [217.37], Avg: 176.4873 (0.486)
Ep: 238, Reward: 563.6571, Test: 784.7224 [153.33], Avg: 178.3907 (0.485)
Ep: 239, Reward: 603.3914, Test: 473.3037 [261.91], Avg: 178.5282 (0.483)
Ep: 240, Reward: 615.3157, Test: 582.7683 [306.88], Avg: 178.9322 (0.482)
Ep: 241, Reward: 503.9664, Test: 447.3829 [366.67], Avg: 178.5263 (0.480)
Ep: 242, Reward: 492.0379, Test: 650.4665 [233.85], Avg: 179.5061 (0.479)
Ep: 243, Reward: 511.8931, Test: 702.3886 [269.80], Avg: 180.5433 (0.478)
Ep: 244, Reward: 447.4771, Test: 577.1347 [262.70], Avg: 181.0898 (0.476)
Ep: 245, Reward: 259.4757, Test: 437.9594 [327.99], Avg: 180.8007 (0.475)
Ep: 246, Reward: 469.8542, Test: 411.9973 [202.98], Avg: 180.9150 (0.473)
Ep: 247, Reward: 555.3153, Test: 442.3750 [279.25], Avg: 180.8433 (0.472)
Ep: 248, Reward: 557.2340, Test: 387.6573 [282.86], Avg: 180.5379 (0.470)
Ep: 249, Reward: 461.1099, Test: 454.3448 [338.90], Avg: 180.2775 (0.469)
Ep: 250, Reward: 620.4622, Test: 284.6919 [329.31], Avg: 179.3815 (0.468)
Ep: 251, Reward: 389.7306, Test: 327.3417 [261.36], Avg: 178.9315 (0.466)
Ep: 252, Reward: 440.8272, Test: 573.1183 [226.41], Avg: 179.5946 (0.465)
Ep: 253, Reward: 443.1806, Test: 428.6711 [256.70], Avg: 179.5646 (0.463)
Ep: 254, Reward: 488.0464, Test: 354.3350 [362.81], Avg: 178.8272 (0.462)
Ep: 255, Reward: 432.4942, Test: 477.6621 [292.75], Avg: 178.8510 (0.461)
Ep: 256, Reward: 437.6614, Test: 384.2235 [251.97], Avg: 178.6696 (0.459)
Ep: 257, Reward: 382.2620, Test: 400.5150 [264.35], Avg: 178.5049 (0.458)
Ep: 258, Reward: 318.0036, Test: 224.8334 [241.12], Avg: 177.7528 (0.456)
Ep: 259, Reward: 314.0751, Test: 363.0760 [303.20], Avg: 177.2994 (0.455)
Ep: 260, Reward: 453.8779, Test: 292.9600 [249.29], Avg: 176.7875 (0.454)
Ep: 261, Reward: 359.9181, Test: 412.3972 [265.68], Avg: 176.6727 (0.452)
Ep: 262, Reward: 377.3401, Test: 275.9982 [175.47], Avg: 176.3832 (0.451)
Ep: 263, Reward: 361.5196, Test: 328.6019 [300.14], Avg: 175.8229 (0.450)
Ep: 264, Reward: 316.9707, Test: 33.8347 [155.48], Avg: 174.7003 (0.447)
Ep: 265, Reward: 237.2737, Test: 274.0098 [279.72], Avg: 174.0221 (0.446)
Ep: 266, Reward: 309.3907, Test: 199.2499 [286.93], Avg: 173.0419 (0.444)
Ep: 267, Reward: 367.3018, Test: 336.5232 [220.15], Avg: 172.8305 (0.443)
Ep: 268, Reward: 425.0194, Test: 273.4927 [298.82], Avg: 172.0938 (0.442)
Ep: 269, Reward: 413.0064, Test: 388.1657 [302.17], Avg: 171.7749 (0.440)
Ep: 270, Reward: 413.3847, Test: 388.6411 [308.86], Avg: 171.4355 (0.439)
Ep: 271, Reward: 556.6024, Test: 611.0452 [273.12], Avg: 172.0476 (0.438)
Ep: 272, Reward: 548.9814, Test: 443.3636 [372.43], Avg: 171.6772 (0.436)
Ep: 273, Reward: 586.3735, Test: 319.1806 [341.50], Avg: 170.9692 (0.435)
Ep: 274, Reward: 541.5620, Test: 372.9476 [391.21], Avg: 170.2810 (0.434)
Ep: 275, Reward: 565.2979, Test: 540.0950 [152.42], Avg: 171.0687 (0.432)
Ep: 276, Reward: 525.1368, Test: 715.7782 [179.13], Avg: 172.3885 (0.431)
Ep: 277, Reward: 633.9067, Test: 481.1517 [375.43], Avg: 172.1487 (0.430)
Ep: 278, Reward: 532.9262, Test: 496.5231 [331.29], Avg: 172.1239 (0.429)
Ep: 279, Reward: 628.0659, Test: 373.8148 [402.16], Avg: 171.4079 (0.427)
Ep: 280, Reward: 499.3995, Test: 564.7395 [371.48], Avg: 171.4857 (0.426)
Ep: 281, Reward: 627.9052, Test: 621.4154 [303.61], Avg: 172.0046 (0.425)
Ep: 282, Reward: 703.9372, Test: 590.4209 [314.96], Avg: 172.3702 (0.423)
Ep: 283, Reward: 603.7683, Test: 531.8880 [337.00], Avg: 172.4494 (0.422)
Ep: 284, Reward: 622.7329, Test: 482.6544 [360.78], Avg: 172.2720 (0.421)
Ep: 285, Reward: 537.5606, Test: 446.5983 [392.74], Avg: 171.8580 (0.420)
Ep: 286, Reward: 499.3369, Test: 233.5768 [293.33], Avg: 171.0510 (0.418)
Ep: 287, Reward: 588.6577, Test: 441.3513 [344.65], Avg: 170.7928 (0.417)
Ep: 288, Reward: 533.9285, Test: 531.7534 [290.09], Avg: 171.0380 (0.416)
Ep: 289, Reward: 667.4241, Test: 773.3473 [88.18], Avg: 172.8109 (0.415)
Ep: 290, Reward: 661.8363, Test: 463.7348 [340.85], Avg: 172.6393 (0.413)
Ep: 291, Reward: 583.0476, Test: 448.7540 [346.08], Avg: 172.3997 (0.412)
Ep: 292, Reward: 606.7406, Test: 553.7504 [353.30], Avg: 172.4954 (0.411)
Ep: 293, Reward: 622.5249, Test: 612.3750 [258.18], Avg: 173.1134 (0.410)
Ep: 294, Reward: 679.1054, Test: 652.2983 [321.57], Avg: 173.6477 (0.408)
Ep: 295, Reward: 694.2486, Test: 696.5126 [316.70], Avg: 174.3442 (0.407)
Ep: 296, Reward: 655.8350, Test: 695.9667 [273.42], Avg: 175.1800 (0.406)
Ep: 297, Reward: 806.8826, Test: 728.3240 [177.98], Avg: 176.4389 (0.405)
Ep: 298, Reward: 762.9737, Test: 641.8853 [351.45], Avg: 176.8202 (0.404)
Ep: 299, Reward: 671.2902, Test: 766.9614 [186.75], Avg: 178.1648 (0.402)
Ep: 300, Reward: 581.3331, Test: 641.8603 [299.25], Avg: 178.7111 (0.401)
Ep: 301, Reward: 695.4237, Test: 744.9199 [197.19], Avg: 179.9330 (0.400)
Ep: 302, Reward: 690.9883, Test: 702.3488 [260.63], Avg: 180.7970 (0.399)
Ep: 303, Reward: 712.6854, Test: 527.6621 [360.85], Avg: 180.7510 (0.398)
Ep: 304, Reward: 614.3434, Test: 726.5054 [306.04], Avg: 181.5370 (0.396)
Ep: 305, Reward: 744.3281, Test: 562.2102 [363.66], Avg: 181.5925 (0.395)
Ep: 306, Reward: 738.5829, Test: 437.8190 [373.50], Avg: 181.2105 (0.394)
Ep: 307, Reward: 584.3693, Test: 562.1409 [354.38], Avg: 181.2967 (0.393)
Ep: 308, Reward: 663.2615, Test: 594.2868 [278.78], Avg: 181.7311 (0.392)
Ep: 309, Reward: 554.4285, Test: 565.4946 [306.46], Avg: 181.9804 (0.390)
Ep: 310, Reward: 705.0574, Test: 698.4119 [264.77], Avg: 182.7896 (0.389)
Ep: 311, Reward: 730.6702, Test: 432.8147 [382.67], Avg: 182.3645 (0.388)
Ep: 312, Reward: 684.5965, Test: 666.2949 [301.96], Avg: 182.9459 (0.387)
Ep: 313, Reward: 488.6777, Test: 254.9396 [320.29], Avg: 182.1551 (0.386)
Ep: 314, Reward: 732.8209, Test: 657.9295 [311.61], Avg: 182.6763 (0.385)
Ep: 315, Reward: 674.9850, Test: 720.4164 [261.60], Avg: 183.5501 (0.383)
Ep: 316, Reward: 649.8267, Test: 586.7979 [322.00], Avg: 183.8064 (0.382)
Ep: 317, Reward: 677.7874, Test: 500.4867 [306.19], Avg: 183.8394 (0.381)
Ep: 318, Reward: 606.7287, Test: 344.4524 [323.29], Avg: 183.3294 (0.380)
Ep: 319, Reward: 608.0670, Test: 667.0959 [249.62], Avg: 184.0611 (0.379)
Ep: 320, Reward: 537.0554, Test: 417.7863 [341.50], Avg: 183.7254 (0.378)
Ep: 321, Reward: 597.6333, Test: 536.3039 [126.13], Avg: 184.4287 (0.377)
Ep: 322, Reward: 519.5744, Test: 517.9984 [319.22], Avg: 184.4731 (0.376)
Ep: 323, Reward: 502.9416, Test: 510.8161 [228.81], Avg: 184.7741 (0.374)
Ep: 324, Reward: 566.3715, Test: 451.9254 [355.89], Avg: 184.5011 (0.373)
Ep: 325, Reward: 605.5676, Test: 742.7320 [223.61], Avg: 185.5275 (0.372)
Ep: 326, Reward: 594.1223, Test: 669.7074 [280.23], Avg: 186.1512 (0.371)
Ep: 327, Reward: 697.6158, Test: 584.6106 [329.31], Avg: 186.3620 (0.370)
Ep: 328, Reward: 557.4686, Test: 554.8877 [275.78], Avg: 186.6439 (0.369)
Ep: 329, Reward: 709.7010, Test: 699.6169 [190.75], Avg: 187.6203 (0.368)
Ep: 330, Reward: 508.5141, Test: 583.9187 [327.65], Avg: 187.8278 (0.367)
Ep: 331, Reward: 590.0914, Test: 682.7496 [163.10], Avg: 188.8272 (0.365)
Ep: 332, Reward: 567.1000, Test: 511.6746 [303.57], Avg: 188.8851 (0.364)
Ep: 333, Reward: 783.0337, Test: 713.5330 [111.42], Avg: 190.1223 (0.363)
Ep: 334, Reward: 712.0553, Test: 659.1412 [263.52], Avg: 190.7358 (0.362)
Ep: 335, Reward: 611.9721, Test: 649.8075 [332.65], Avg: 191.1120 (0.361)
Ep: 336, Reward: 746.8781, Test: 598.7177 [304.31], Avg: 191.4185 (0.360)
Ep: 337, Reward: 547.6439, Test: 661.1317 [246.93], Avg: 192.0777 (0.359)
Ep: 338, Reward: 640.1609, Test: 632.3483 [353.83], Avg: 192.3326 (0.358)
Ep: 339, Reward: 673.3861, Test: 625.2538 [303.76], Avg: 192.7125 (0.357)
Ep: 340, Reward: 727.5663, Test: 718.3355 [253.33], Avg: 193.5111 (0.356)
Ep: 341, Reward: 724.8209, Test: 561.4440 [315.22], Avg: 193.6652 (0.355)
Ep: 342, Reward: 760.4414, Test: 494.3516 [289.03], Avg: 193.6992 (0.354)
Ep: 343, Reward: 485.0767, Test: 459.7548 [380.42], Avg: 193.3667 (0.353)
Ep: 344, Reward: 534.6309, Test: 445.5147 [269.04], Avg: 193.3178 (0.351)
Ep: 345, Reward: 607.9944, Test: 689.9226 [212.32], Avg: 194.1394 (0.350)
Ep: 346, Reward: 548.9498, Test: 361.6317 [280.95], Avg: 193.8124 (0.349)
Ep: 347, Reward: 524.4317, Test: 768.1288 [276.39], Avg: 194.6685 (0.348)
Ep: 348, Reward: 621.8322, Test: 693.2601 [209.61], Avg: 195.4966 (0.347)
Ep: 349, Reward: 760.8701, Test: 669.4615 [221.73], Avg: 196.2173 (0.346)
Ep: 350, Reward: 728.6304, Test: 677.6162 [200.30], Avg: 197.0181 (0.345)
Ep: 351, Reward: 666.2942, Test: 607.7113 [270.52], Avg: 197.4163 (0.344)
Ep: 352, Reward: 713.5422, Test: 635.6363 [281.81], Avg: 197.8594 (0.343)
Ep: 353, Reward: 707.5606, Test: 693.0328 [265.76], Avg: 198.5075 (0.342)
Ep: 354, Reward: 807.2994, Test: 610.7234 [241.98], Avg: 198.9870 (0.341)
Ep: 355, Reward: 511.8616, Test: 695.7496 [174.99], Avg: 199.8909 (0.340)
Ep: 356, Reward: 654.9810, Test: 680.5165 [266.72], Avg: 200.4900 (0.339)
Ep: 357, Reward: 720.3983, Test: 581.2490 [208.69], Avg: 200.9707 (0.338)
Ep: 358, Reward: 690.7241, Test: 642.0709 [204.85], Avg: 201.6288 (0.337)
Ep: 359, Reward: 783.1046, Test: 531.7592 [258.97], Avg: 201.8264 (0.336)
Ep: 360, Reward: 695.8015, Test: 661.1505 [256.62], Avg: 202.3879 (0.335)
Ep: 361, Reward: 687.6133, Test: 753.2847 [199.72], Avg: 203.3580 (0.334)
Ep: 362, Reward: 611.9594, Test: 604.5914 [155.90], Avg: 204.0339 (0.333)
Ep: 363, Reward: 673.3128, Test: 621.3606 [261.08], Avg: 204.4631 (0.332)
Ep: 364, Reward: 623.2879, Test: 694.7445 [294.22], Avg: 205.0003 (0.331)
Ep: 365, Reward: 713.4491, Test: 685.1634 [216.67], Avg: 205.7202 (0.330)
Ep: 366, Reward: 666.8287, Test: 538.5942 [202.38], Avg: 206.0757 (0.329)
Ep: 367, Reward: 723.2176, Test: 524.7940 [270.29], Avg: 206.2073 (0.328)
Ep: 368, Reward: 656.2510, Test: 624.7485 [231.55], Avg: 206.7141 (0.327)
Ep: 369, Reward: 692.0740, Test: 710.0291 [187.61], Avg: 207.5673 (0.326)
Ep: 370, Reward: 749.7456, Test: 647.7844 [221.64], Avg: 208.1565 (0.325)
Ep: 371, Reward: 771.7626, Test: 712.4700 [187.27], Avg: 209.0088 (0.324)
Ep: 372, Reward: 499.2199, Test: 740.5008 [273.08], Avg: 209.7016 (0.323)
Ep: 373, Reward: 431.3887, Test: 536.4920 [333.43], Avg: 209.6838 (0.322)
Ep: 374, Reward: 575.8185, Test: 310.1106 [297.31], Avg: 209.1588 (0.321)
Ep: 375, Reward: 403.9378, Test: 435.1193 [316.40], Avg: 208.9183 (0.320)
Ep: 376, Reward: 521.3097, Test: 466.4685 [366.86], Avg: 208.6284 (0.319)
Ep: 377, Reward: 532.3456, Test: 619.4202 [287.86], Avg: 208.9536 (0.318)
Ep: 378, Reward: 473.3991, Test: 410.1870 [333.98], Avg: 208.6033 (0.317)
Ep: 379, Reward: 538.4078, Test: 354.2337 [328.81], Avg: 208.1213 (0.316)
Ep: 380, Reward: 648.3097, Test: 378.2394 [310.66], Avg: 207.7524 (0.315)
Ep: 381, Reward: 619.7024, Test: 558.9505 [343.00], Avg: 207.7739 (0.315)
Ep: 382, Reward: 598.6108, Test: 492.1297 [320.56], Avg: 207.6793 (0.314)
Ep: 383, Reward: 537.9694, Test: 470.5442 [274.98], Avg: 207.6478 (0.313)
Ep: 384, Reward: 454.8055, Test: 350.5451 [370.91], Avg: 207.0555 (0.312)
Ep: 385, Reward: 552.4805, Test: 545.4607 [233.91], Avg: 207.3263 (0.311)
Ep: 386, Reward: 524.9394, Test: 467.8605 [379.93], Avg: 207.0177 (0.310)
Ep: 387, Reward: 581.8520, Test: 466.3256 [388.92], Avg: 206.6837 (0.309)
Ep: 388, Reward: 605.5591, Test: 468.9216 [337.23], Avg: 206.4909 (0.308)
Ep: 389, Reward: 589.2394, Test: 386.8791 [364.92], Avg: 206.0177 (0.307)
Ep: 390, Reward: 501.3184, Test: 605.7332 [266.99], Avg: 206.3572 (0.306)
Ep: 391, Reward: 593.6341, Test: 567.6507 [307.50], Avg: 206.4944 (0.305)
Ep: 392, Reward: 578.0999, Test: 379.1443 [301.11], Avg: 206.1676 (0.304)
Ep: 393, Reward: 609.1323, Test: 506.7652 [279.53], Avg: 206.2210 (0.303)
Ep: 394, Reward: 507.4683, Test: 541.2374 [241.74], Avg: 206.4572 (0.302)
Ep: 395, Reward: 533.9333, Test: 579.9224 [321.36], Avg: 206.5887 (0.302)
Ep: 396, Reward: 628.1254, Test: 456.0980 [305.60], Avg: 206.4475 (0.301)
Ep: 397, Reward: 543.3216, Test: 474.2944 [130.95], Avg: 206.7914 (0.300)
Ep: 398, Reward: 503.8596, Test: 594.7144 [179.19], Avg: 207.3146 (0.299)
Ep: 399, Reward: 572.1119, Test: 512.0945 [255.59], Avg: 207.4375 (0.298)
Ep: 400, Reward: 508.4039, Test: 640.0713 [249.00], Avg: 207.8955 (0.297)
Ep: 401, Reward: 570.1828, Test: 440.4663 [288.33], Avg: 207.7568 (0.296)
Ep: 402, Reward: 531.3235, Test: 666.4753 [170.43], Avg: 208.4721 (0.295)
Ep: 403, Reward: 540.9057, Test: 494.3072 [225.85], Avg: 208.6206 (0.294)
Ep: 404, Reward: 570.2182, Test: 525.2462 [200.58], Avg: 208.9071 (0.294)
Ep: 405, Reward: 522.9207, Test: 455.4092 [265.39], Avg: 208.8606 (0.293)
Ep: 406, Reward: 436.2917, Test: 387.5330 [254.81], Avg: 208.6735 (0.292)
Ep: 407, Reward: 466.3002, Test: 450.9668 [212.55], Avg: 208.7464 (0.291)
Ep: 408, Reward: 319.4672, Test: 442.5076 [256.66], Avg: 208.6904 (0.290)
Ep: 409, Reward: 483.4504, Test: 509.6938 [202.69], Avg: 208.9302 (0.289)
Ep: 410, Reward: 446.7057, Test: 524.8794 [264.78], Avg: 209.0547 (0.288)
Ep: 411, Reward: 496.5748, Test: 276.5269 [192.66], Avg: 208.7509 (0.287)
Ep: 412, Reward: 418.0329, Test: 364.0029 [265.24], Avg: 208.4846 (0.287)
Ep: 413, Reward: 419.5675, Test: 396.0079 [218.28], Avg: 208.4103 (0.286)
Ep: 414, Reward: 436.1013, Test: 417.0913 [240.00], Avg: 208.3348 (0.285)
Ep: 415, Reward: 384.9008, Test: 405.3161 [146.36], Avg: 208.4565 (0.284)
Ep: 416, Reward: 311.3215, Test: 414.3656 [203.21], Avg: 208.4630 (0.283)
Ep: 417, Reward: 322.7339, Test: 438.4552 [151.69], Avg: 208.6503 (0.282)
Ep: 418, Reward: 317.6013, Test: 248.8207 [137.42], Avg: 208.4182 (0.281)
Ep: 419, Reward: 343.1169, Test: 391.1865 [133.54], Avg: 208.5354 (0.281)
Ep: 420, Reward: 390.1754, Test: 278.6758 [163.07], Avg: 208.3147 (0.280)
Ep: 421, Reward: 284.1572, Test: 363.6523 [157.34], Avg: 208.3100 (0.279)
Ep: 422, Reward: 314.2292, Test: 269.3147 [131.47], Avg: 208.1434 (0.278)
Ep: 423, Reward: 428.8381, Test: 314.6423 [107.41], Avg: 208.1412 (0.277)
Ep: 424, Reward: 395.8187, Test: 289.6362 [204.42], Avg: 207.8520 (0.276)
Ep: 425, Reward: 416.5940, Test: 320.0316 [187.04], Avg: 207.6763 (0.276)
Ep: 426, Reward: 399.7601, Test: 349.3480 [185.27], Avg: 207.5742 (0.275)
Ep: 427, Reward: 384.7702, Test: 419.1973 [223.65], Avg: 207.5461 (0.274)
Ep: 428, Reward: 368.6125, Test: 398.2420 [158.39], Avg: 207.6214 (0.273)
Ep: 429, Reward: 390.6413, Test: 236.7738 [154.41], Avg: 207.3301 (0.272)
Ep: 430, Reward: 391.7979, Test: 414.9263 [218.64], Avg: 207.3045 (0.271)
Ep: 431, Reward: 392.2344, Test: 296.7439 [174.13], Avg: 207.1084 (0.271)
Ep: 432, Reward: 351.4631, Test: 373.5940 [251.14], Avg: 206.9129 (0.270)
Ep: 433, Reward: 384.0381, Test: 406.4856 [138.16], Avg: 207.0544 (0.269)
Ep: 434, Reward: 415.8953, Test: 406.6421 [136.05], Avg: 207.2005 (0.268)
Ep: 435, Reward: 411.6165, Test: 390.0015 [129.41], Avg: 207.3229 (0.267)
Ep: 436, Reward: 345.9312, Test: 386.9324 [141.55], Avg: 207.4100 (0.267)
Ep: 437, Reward: 387.3451, Test: 399.0878 [215.80], Avg: 207.3549 (0.266)
Ep: 438, Reward: 396.8122, Test: 385.7989 [165.02], Avg: 207.3855 (0.265)
Ep: 439, Reward: 269.3903, Test: 186.0800 [139.80], Avg: 207.0194 (0.264)
Ep: 440, Reward: 209.5263, Test: 214.6260 [189.62], Avg: 206.6067 (0.263)
Ep: 441, Reward: 218.1084, Test: 225.2422 [70.51], Avg: 206.4893 (0.263)
Ep: 442, Reward: 233.5333, Test: 149.9170 [84.60], Avg: 206.1706 (0.262)
Ep: 443, Reward: 167.8238, Test: 165.9571 [87.56], Avg: 205.8828 (0.261)
Ep: 444, Reward: 173.8835, Test: 237.9465 [143.31], Avg: 205.6328 (0.260)
Ep: 445, Reward: 303.1408, Test: 297.5949 [112.44], Avg: 205.5869 (0.259)
Ep: 446, Reward: 227.5029, Test: 347.0405 [135.50], Avg: 205.6003 (0.259)
Ep: 447, Reward: 261.2538, Test: 252.5289 [139.36], Avg: 205.3939 (0.258)
Ep: 448, Reward: 328.6693, Test: 390.9715 [184.49], Avg: 205.3964 (0.257)
Ep: 449, Reward: 334.2787, Test: 302.8752 [124.52], Avg: 205.3363 (0.256)
Ep: 450, Reward: 321.1249, Test: 389.3851 [159.22], Avg: 205.3913 (0.256)
Ep: 451, Reward: 297.8648, Test: 358.2935 [115.41], Avg: 205.4743 (0.255)
Ep: 452, Reward: 304.6630, Test: 303.6538 [125.48], Avg: 205.4140 (0.254)
Ep: 453, Reward: 287.3222, Test: 219.1511 [108.11], Avg: 205.2061 (0.253)
Ep: 454, Reward: 245.3375, Test: 258.0369 [91.87], Avg: 205.1203 (0.253)
Ep: 455, Reward: 244.9562, Test: 143.9558 [52.39], Avg: 204.8713 (0.252)
Ep: 456, Reward: 163.0900, Test: 242.2976 [102.24], Avg: 204.7295 (0.251)
Ep: 457, Reward: 215.6316, Test: 223.2122 [93.25], Avg: 204.5662 (0.250)
Ep: 458, Reward: 265.6980, Test: 332.7283 [155.27], Avg: 204.5072 (0.250)
Ep: 459, Reward: 322.5446, Test: 299.1223 [121.06], Avg: 204.4497 (0.249)
Ep: 460, Reward: 304.6538, Test: 294.2026 [113.96], Avg: 204.3972 (0.248)
Ep: 461, Reward: 265.1093, Test: 365.4924 [191.50], Avg: 204.3314 (0.247)
Ep: 462, Reward: 361.8166, Test: 389.9694 [194.03], Avg: 204.3132 (0.247)
Ep: 463, Reward: 407.0475, Test: 482.8644 [262.96], Avg: 204.3468 (0.246)
Ep: 464, Reward: 377.8642, Test: 431.1204 [279.87], Avg: 204.2326 (0.245)
Ep: 465, Reward: 477.6120, Test: 434.0093 [179.25], Avg: 204.3411 (0.244)
Ep: 466, Reward: 541.9717, Test: 362.8550 [174.81], Avg: 204.3062 (0.244)
Ep: 467, Reward: 423.9534, Test: 347.7818 [202.68], Avg: 204.1797 (0.243)
Ep: 468, Reward: 402.1932, Test: 474.1545 [175.28], Avg: 204.3816 (0.242)
Ep: 469, Reward: 401.2139, Test: 259.8283 [147.17], Avg: 204.1864 (0.241)
Ep: 470, Reward: 369.1813, Test: 518.3760 [249.44], Avg: 204.3239 (0.241)
Ep: 471, Reward: 438.8988, Test: 386.7232 [279.65], Avg: 204.1178 (0.240)
Ep: 472, Reward: 343.9793, Test: 408.9959 [129.49], Avg: 204.2772 (0.239)
Ep: 473, Reward: 366.7634, Test: 332.3619 [210.90], Avg: 204.1025 (0.239)
Ep: 474, Reward: 368.5981, Test: 287.4593 [154.98], Avg: 203.9517 (0.238)
Ep: 475, Reward: 317.5907, Test: 254.5534 [112.28], Avg: 203.8222 (0.237)
Ep: 476, Reward: 293.4195, Test: 366.3591 [214.56], Avg: 203.7131 (0.236)
Ep: 477, Reward: 407.6079, Test: 336.1801 [210.97], Avg: 203.5489 (0.236)
Ep: 478, Reward: 306.2984, Test: 340.1782 [156.39], Avg: 203.5076 (0.235)
Ep: 479, Reward: 321.3221, Test: 210.9218 [108.01], Avg: 203.2980 (0.234)
Ep: 480, Reward: 402.0441, Test: 333.0464 [176.93], Avg: 203.1999 (0.234)
Ep: 481, Reward: 335.6089, Test: 186.1852 [114.34], Avg: 202.9274 (0.233)
Ep: 482, Reward: 356.1619, Test: 279.2806 [126.64], Avg: 202.8233 (0.232)
Ep: 483, Reward: 301.8810, Test: 290.6727 [115.39], Avg: 202.7664 (0.231)
Ep: 484, Reward: 347.3939, Test: 222.6430 [122.45], Avg: 202.5549 (0.231)
Ep: 485, Reward: 239.7724, Test: 296.6756 [185.09], Avg: 202.3677 (0.230)
Ep: 486, Reward: 250.5828, Test: 291.6692 [96.04], Avg: 202.3539 (0.229)
Ep: 487, Reward: 263.4201, Test: 289.4425 [127.06], Avg: 202.2720 (0.229)
Ep: 488, Reward: 306.3220, Test: 265.0428 [128.20], Avg: 202.1382 (0.228)
Ep: 489, Reward: 323.2431, Test: 261.2754 [164.77], Avg: 201.9226 (0.227)
Ep: 490, Reward: 197.2665, Test: 330.3214 [144.48], Avg: 201.8899 (0.227)
Ep: 491, Reward: 335.6648, Test: -46.8894 [42.94], Avg: 201.2969 (0.226)
Ep: 492, Reward: -70.6418, Test: -71.3448 [8.10], Avg: 200.7275 (0.225)
Ep: 493, Reward: -76.3180, Test: -75.8515 [2.13], Avg: 200.1633 (0.225)
Ep: 494, Reward: -74.9764, Test: -72.0676 [2.24], Avg: 199.6088 (0.224)
Ep: 495, Reward: -71.7611, Test: -69.5845 [2.36], Avg: 199.0613 (0.223)
Ep: 496, Reward: -65.1118, Test: -64.2105 [11.65], Avg: 198.5082 (0.223)
Ep: 497, Reward: -36.6242, Test: 22.1051 [63.87], Avg: 198.0257 (0.222)
Ep: 498, Reward: 10.4398, Test: -72.3884 [2.20], Avg: 197.4794 (0.221)
Ep: 499, Reward: -71.6925, Test: -71.0295 [2.58], Avg: 196.9372 (0.221)
