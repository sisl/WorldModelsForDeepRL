Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 4					# Number of samples to train on for each train step
PPO_EPOCHS = 1					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.01				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) + critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(PPO_EPOCHS):
				for i in range(0, len(self.replay_buffer), BATCH_SIZE):
					state, action, log_prob, target, advantage = self.replay_buffer.index(BATCH_SIZE, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -28.9401, Test: -22.8725 [23.17], Avg: -46.0457 (0.997)
Ep: 1, Reward: -27.2879, Test: -42.0499 [15.46], Avg: -51.7781 (0.994)
Ep: 2, Reward: -28.7633, Test: -85.3585 [18.38], Avg: -69.0972 (0.991)
Ep: 3, Reward: -61.8582, Test: -76.3035 [8.77], Avg: -73.0902 (0.988)
Ep: 4, Reward: -58.2702, Test: -73.5201 [10.80], Avg: -75.3361 (0.985)
Ep: 5, Reward: -62.2935, Test: -114.1875 [16.60], Avg: -84.5779 (0.982)
Ep: 6, Reward: -45.3660, Test: -75.9871 [4.64], Avg: -84.0129 (0.979)
Ep: 7, Reward: -45.4004, Test: -82.8057 [26.94], Avg: -87.2289 (0.976)
Ep: 8, Reward: -58.4281, Test: -57.9622 [40.24], Avg: -88.4483 (0.973)
Ep: 9, Reward: -12.3234, Test: -62.5172 [19.23], Avg: -87.7785 (0.970)
Ep: 10, Reward: -41.9411, Test: -53.1606 [20.87], Avg: -86.5286 (0.967)
Ep: 11, Reward: -21.4434, Test: -14.1751 [78.97], Avg: -87.0803 (0.965)
Ep: 12, Reward: -4.2682, Test: -8.4477 [57.19], Avg: -85.4310 (0.962)
Ep: 13, Reward: -0.5278, Test: 35.4791 [122.55], Avg: -85.5478 (0.959)
Ep: 14, Reward: -24.2881, Test: 239.2423 [207.36], Avg: -77.7191 (0.956)
Ep: 15, Reward: 101.2951, Test: 461.1110 [157.10], Avg: -53.8608 (0.953)
Ep: 16, Reward: 146.8310, Test: 303.0540 [143.48], Avg: -41.3058 (0.950)
Ep: 17, Reward: 274.7759, Test: 312.4263 [92.14], Avg: -26.7729 (0.947)
Ep: 18, Reward: 444.0440, Test: 237.8037 [90.71], Avg: -17.6218 (0.945)
Ep: 19, Reward: 446.1383, Test: 181.6621 [79.98], Avg: -11.6568 (0.942)
Ep: 20, Reward: 366.0025, Test: 216.6433 [121.25], Avg: -6.5592 (0.939)
Ep: 21, Reward: 397.8946, Test: 161.0920 [82.19], Avg: -2.6747 (0.936)
Ep: 22, Reward: 686.5827, Test: 134.1947 [97.68], Avg: -0.9706 (0.933)
Ep: 23, Reward: 434.2366, Test: 151.0579 [83.04], Avg: 1.9038 (0.930)
Ep: 24, Reward: 498.7817, Test: 121.8342 [75.40], Avg: 3.6850 (0.928)
Ep: 25, Reward: 442.6078, Test: 173.8336 [61.78], Avg: 7.8531 (0.925)
Ep: 26, Reward: 509.5655, Test: 207.7370 [68.43], Avg: 12.7219 (0.922)
Ep: 27, Reward: 531.7451, Test: 237.1475 [88.48], Avg: 17.5771 (0.919)
Ep: 28, Reward: 579.5059, Test: 231.1356 [101.94], Avg: 21.4262 (0.917)
Ep: 29, Reward: 557.2866, Test: 375.6723 [136.72], Avg: 28.6771 (0.914)
Ep: 30, Reward: 696.8917, Test: 197.7523 [87.21], Avg: 31.3178 (0.911)
Ep: 31, Reward: 715.9042, Test: 191.4232 [92.99], Avg: 33.4153 (0.908)
Ep: 32, Reward: 509.5625, Test: 195.1735 [75.81], Avg: 36.0197 (0.906)
Ep: 33, Reward: 621.0568, Test: 240.9550 [78.03], Avg: 39.7521 (0.903)
Ep: 34, Reward: 570.6848, Test: 207.2901 [92.81], Avg: 41.8873 (0.900)
Ep: 35, Reward: 592.3963, Test: 193.2551 [89.13], Avg: 43.6161 (0.897)
Ep: 36, Reward: 608.9452, Test: 182.9722 [92.29], Avg: 44.8883 (0.895)
Ep: 37, Reward: 685.4622, Test: 220.7464 [69.41], Avg: 47.6895 (0.892)
Ep: 38, Reward: 632.7081, Test: 212.1880 [79.51], Avg: 49.8688 (0.889)
Ep: 39, Reward: 640.8314, Test: 157.8545 [112.70], Avg: 49.7510 (0.887)
Ep: 40, Reward: 647.0924, Test: 254.4437 [123.23], Avg: 51.7380 (0.884)
Ep: 41, Reward: 662.6487, Test: 250.8658 [57.23], Avg: 55.1164 (0.881)
Ep: 42, Reward: 603.4865, Test: 274.1353 [110.56], Avg: 57.6388 (0.879)
Ep: 43, Reward: 572.6094, Test: 234.0412 [94.01], Avg: 59.5113 (0.876)
Ep: 44, Reward: 645.8115, Test: 212.0568 [109.36], Avg: 60.4711 (0.874)
Ep: 45, Reward: 604.0402, Test: 251.1136 [61.53], Avg: 63.2778 (0.871)
Ep: 46, Reward: 617.7540, Test: 198.4005 [111.04], Avg: 63.7903 (0.868)
Ep: 47, Reward: 556.2284, Test: 236.4359 [81.76], Avg: 65.6837 (0.866)
Ep: 48, Reward: 544.1918, Test: 215.3626 [33.30], Avg: 68.0587 (0.863)
Ep: 49, Reward: 551.5845, Test: 158.3062 [91.05], Avg: 68.0426 (0.861)
Ep: 50, Reward: 438.0961, Test: 208.3724 [63.85], Avg: 69.5421 (0.858)
Ep: 51, Reward: 399.5321, Test: 204.1916 [79.21], Avg: 70.6082 (0.855)
Ep: 52, Reward: 500.6191, Test: 220.4995 [40.58], Avg: 72.6707 (0.853)
Ep: 53, Reward: 699.1048, Test: 225.0851 [72.13], Avg: 74.1574 (0.850)
Ep: 54, Reward: 614.6821, Test: 233.2045 [64.50], Avg: 75.8765 (0.848)
Ep: 55, Reward: 671.8182, Test: 213.3028 [92.94], Avg: 76.6709 (0.845)
Ep: 56, Reward: 715.9521, Test: 190.1714 [85.11], Avg: 77.1690 (0.843)
Ep: 57, Reward: 666.2403, Test: 258.5395 [167.16], Avg: 77.4140 (0.840)
Ep: 58, Reward: 673.8982, Test: 194.1031 [56.08], Avg: 78.4413 (0.838)
Ep: 59, Reward: 707.1474, Test: 225.0624 [123.72], Avg: 78.8231 (0.835)
Ep: 60, Reward: 710.8728, Test: 205.3462 [111.76], Avg: 79.0650 (0.833)
Ep: 61, Reward: 721.5869, Test: 218.2254 [154.65], Avg: 78.8152 (0.830)
Ep: 62, Reward: 789.6250, Test: 306.0897 [133.68], Avg: 80.3008 (0.828)
Ep: 63, Reward: 737.1881, Test: 257.1697 [78.23], Avg: 81.8420 (0.825)
Ep: 64, Reward: 750.3104, Test: 203.5374 [66.39], Avg: 82.6929 (0.823)
Ep: 65, Reward: 735.8470, Test: 184.3889 [113.08], Avg: 82.5204 (0.820)
Ep: 66, Reward: 738.4840, Test: 280.6114 [126.23], Avg: 83.5929 (0.818)
Ep: 67, Reward: 768.3224, Test: 246.9511 [108.86], Avg: 84.3943 (0.815)
Ep: 68, Reward: 784.5239, Test: 213.1757 [116.68], Avg: 84.5697 (0.813)
Ep: 69, Reward: 741.9321, Test: 218.8096 [84.40], Avg: 85.2817 (0.810)
Ep: 70, Reward: 811.8228, Test: 249.3462 [112.28], Avg: 86.0111 (0.808)
Ep: 71, Reward: 746.5079, Test: 209.1821 [91.72], Avg: 86.4479 (0.805)
Ep: 72, Reward: 675.2254, Test: 326.3894 [185.22], Avg: 87.1976 (0.803)
Ep: 73, Reward: 648.2181, Test: 264.7188 [136.47], Avg: 87.7522 (0.801)
Ep: 74, Reward: 730.1695, Test: 249.1318 [92.58], Avg: 88.6695 (0.798)
Ep: 75, Reward: 700.9831, Test: 349.5858 [237.13], Avg: 88.9825 (0.796)
Ep: 76, Reward: 712.5008, Test: 240.4931 [69.30], Avg: 90.0502 (0.793)
Ep: 77, Reward: 605.6557, Test: 222.9016 [49.33], Avg: 91.1210 (0.791)
Ep: 78, Reward: 509.1896, Test: 193.9236 [82.89], Avg: 91.3731 (0.789)
Ep: 79, Reward: 606.1989, Test: 187.3222 [61.80], Avg: 91.8000 (0.786)
Ep: 80, Reward: 533.1288, Test: 197.6040 [103.57], Avg: 91.8276 (0.784)
Ep: 81, Reward: 692.9888, Test: 179.3838 [105.83], Avg: 91.6048 (0.782)
Ep: 82, Reward: 644.7843, Test: 262.7092 [51.19], Avg: 93.0495 (0.779)
Ep: 83, Reward: 734.5676, Test: 323.1820 [136.68], Avg: 94.1620 (0.777)
Ep: 84, Reward: 794.0216, Test: 303.3183 [142.90], Avg: 94.9414 (0.775)
Ep: 85, Reward: 787.1884, Test: 209.6126 [100.98], Avg: 95.1007 (0.772)
Ep: 86, Reward: 839.0515, Test: 210.3161 [62.19], Avg: 95.7102 (0.770)
Ep: 87, Reward: 853.4974, Test: 328.9307 [169.40], Avg: 96.4354 (0.768)
Ep: 88, Reward: 846.7017, Test: 225.2538 [222.72], Avg: 95.3803 (0.765)
Ep: 89, Reward: 778.4208, Test: 284.0714 [135.11], Avg: 95.9757 (0.763)
Ep: 90, Reward: 879.0084, Test: 215.5804 [112.70], Avg: 96.0516 (0.761)
Ep: 91, Reward: 862.8286, Test: 200.4179 [128.34], Avg: 95.7910 (0.758)
Ep: 92, Reward: 776.9356, Test: 224.5424 [125.38], Avg: 95.8272 (0.756)
Ep: 93, Reward: 764.7000, Test: 120.2285 [88.76], Avg: 95.1426 (0.754)
Ep: 94, Reward: 751.6089, Test: 188.9104 [110.94], Avg: 94.9618 (0.752)
Ep: 95, Reward: 578.4417, Test: 225.2197 [61.18], Avg: 95.6814 (0.749)
Ep: 96, Reward: 628.8591, Test: 180.4960 [130.92], Avg: 95.2061 (0.747)
Ep: 97, Reward: 637.1750, Test: 246.6437 [203.77], Avg: 94.6721 (0.745)
Ep: 98, Reward: 592.6007, Test: 222.3774 [101.61], Avg: 94.9357 (0.743)
Ep: 99, Reward: 491.9781, Test: 187.7515 [67.01], Avg: 95.1938 (0.740)
Ep: 100, Reward: 477.5230, Test: 179.6801 [97.40], Avg: 95.0659 (0.738)
Ep: 101, Reward: 768.0067, Test: 243.1189 [111.62], Avg: 95.4231 (0.736)
Ep: 102, Reward: 737.4277, Test: 220.5828 [86.11], Avg: 95.8022 (0.734)
Ep: 103, Reward: 535.9233, Test: 194.3915 [126.78], Avg: 95.5311 (0.732)
Ep: 104, Reward: 467.3658, Test: 205.5055 [116.65], Avg: 95.4675 (0.729)
Ep: 105, Reward: 598.1736, Test: 274.4487 [138.04], Avg: 95.8537 (0.727)
Ep: 106, Reward: 781.3702, Test: 250.6697 [74.06], Avg: 96.6085 (0.725)
Ep: 107, Reward: 664.5320, Test: 268.7026 [76.99], Avg: 97.4890 (0.723)
Ep: 108, Reward: 586.1548, Test: 251.4230 [87.07], Avg: 98.1025 (0.721)
Ep: 109, Reward: 581.9574, Test: 195.8806 [89.51], Avg: 98.1776 (0.719)
Ep: 110, Reward: 567.4812, Test: 215.3895 [81.94], Avg: 98.4954 (0.716)
Ep: 111, Reward: 504.0533, Test: 194.6900 [104.10], Avg: 98.4248 (0.714)
Ep: 112, Reward: 465.3644, Test: 261.4108 [100.21], Avg: 98.9803 (0.712)
Ep: 113, Reward: 541.8425, Test: 198.2510 [68.01], Avg: 99.2545 (0.710)
Ep: 114, Reward: 549.2771, Test: 188.6248 [82.74], Avg: 99.3121 (0.708)
Ep: 115, Reward: 575.7048, Test: 180.2713 [133.27], Avg: 98.8612 (0.706)
Ep: 116, Reward: 619.2294, Test: 175.9434 [135.30], Avg: 98.3636 (0.704)
Ep: 117, Reward: 520.1158, Test: 169.5485 [101.67], Avg: 98.1053 (0.702)
Ep: 118, Reward: 617.9893, Test: 222.5913 [87.24], Avg: 98.4183 (0.699)
Ep: 119, Reward: 525.4827, Test: 122.9508 [101.29], Avg: 97.7786 (0.697)
Ep: 120, Reward: 555.0385, Test: 212.9306 [98.02], Avg: 97.9202 (0.695)
Ep: 121, Reward: 492.5090, Test: 155.5865 [81.18], Avg: 97.7275 (0.693)
Ep: 122, Reward: 580.4963, Test: 191.7092 [84.52], Avg: 97.8045 (0.691)
Ep: 123, Reward: 468.4036, Test: 223.8913 [84.90], Avg: 98.1366 (0.689)
Ep: 124, Reward: 440.0737, Test: 242.2661 [74.36], Avg: 98.6948 (0.687)
Ep: 125, Reward: 422.7273, Test: 205.9228 [66.60], Avg: 99.0173 (0.683)
Ep: 126, Reward: 467.1908, Test: 255.9964 [136.79], Avg: 99.1763 (0.681)
Ep: 127, Reward: 451.4681, Test: 204.5039 [70.60], Avg: 99.4476 (0.679)
Ep: 128, Reward: 409.1866, Test: 173.2185 [92.78], Avg: 99.3003 (0.677)
Ep: 129, Reward: 416.7352, Test: 199.2980 [82.10], Avg: 99.4379 (0.675)
Ep: 130, Reward: 466.1220, Test: 207.5436 [71.41], Avg: 99.7181 (0.673)
Ep: 131, Reward: 426.8915, Test: 166.3924 [75.80], Avg: 99.6489 (0.671)
Ep: 132, Reward: 431.9933, Test: 210.7818 [66.04], Avg: 99.9880 (0.669)
Ep: 133, Reward: 452.7968, Test: 222.3018 [39.10], Avg: 100.6090 (0.667)
Ep: 134, Reward: 464.8984, Test: 229.5802 [41.69], Avg: 101.2555 (0.665)
Ep: 135, Reward: 484.2399, Test: 208.6875 [44.59], Avg: 101.7176 (0.661)
Ep: 136, Reward: 550.3133, Test: 165.2863 [98.06], Avg: 101.4658 (0.659)
Ep: 137, Reward: 498.9271, Test: 216.7457 [79.88], Avg: 101.7223 (0.657)
Ep: 138, Reward: 452.4613, Test: 203.7933 [77.71], Avg: 101.8976 (0.655)
Ep: 139, Reward: 534.9902, Test: 145.7889 [92.38], Avg: 101.5512 (0.653)
Ep: 140, Reward: 547.0983, Test: 198.2695 [59.65], Avg: 101.8141 (0.651)
Ep: 141, Reward: 474.2828, Test: 205.7456 [75.67], Avg: 102.0131 (0.649)
Ep: 142, Reward: 433.6837, Test: 197.2855 [64.52], Avg: 102.2282 (0.647)
Ep: 143, Reward: 482.0288, Test: 219.7447 [65.06], Avg: 102.5924 (0.645)
Ep: 144, Reward: 440.5135, Test: 153.9880 [83.13], Avg: 102.3736 (0.641)
Ep: 145, Reward: 458.1076, Test: 152.9797 [114.02], Avg: 101.9392 (0.639)
Ep: 146, Reward: 436.6314, Test: 222.9343 [99.69], Avg: 102.0842 (0.637)
Ep: 147, Reward: 485.8159, Test: 240.8480 [88.33], Avg: 102.4250 (0.635)
Ep: 148, Reward: 473.2213, Test: 168.2592 [90.33], Avg: 102.2606 (0.633)
Ep: 149, Reward: 559.4028, Test: 151.5949 [63.98], Avg: 102.1629 (0.631)
Ep: 150, Reward: 546.6242, Test: 185.7984 [93.12], Avg: 102.1001 (0.630)
Ep: 151, Reward: 422.1625, Test: 228.8702 [56.76], Avg: 102.5607 (0.628)
Ep: 152, Reward: 464.3356, Test: 198.6207 [100.61], Avg: 102.5310 (0.626)
Ep: 153, Reward: 472.4967, Test: 211.3690 [88.07], Avg: 102.6658 (0.624)
Ep: 154, Reward: 446.0441, Test: 207.8000 [73.98], Avg: 102.8668 (0.622)
Ep: 155, Reward: 443.6414, Test: 203.3624 [120.63], Avg: 102.7378 (0.620)
Ep: 156, Reward: 531.9906, Test: 214.1629 [62.01], Avg: 103.0525 (0.618)
Ep: 157, Reward: 559.0330, Test: 265.3046 [109.98], Avg: 103.3833 (0.616)
Ep: 158, Reward: 470.6026, Test: 217.9668 [180.50], Avg: 102.9687 (0.615)
Ep: 159, Reward: 547.3915, Test: 200.8756 [79.26], Avg: 103.0853 (0.613)
Ep: 160, Reward: 505.4048, Test: 186.0567 [89.18], Avg: 103.0467 (0.611)
Ep: 161, Reward: 557.2783, Test: 248.4767 [48.33], Avg: 103.6461 (0.609)
Ep: 162, Reward: 469.8089, Test: 224.3586 [143.71], Avg: 103.5050 (0.607)
Ep: 163, Reward: 556.6856, Test: 193.4529 [112.91], Avg: 103.3650 (0.605)
Ep: 164, Reward: 485.0387, Test: 187.4180 [80.34], Avg: 103.3875 (0.604)
Ep: 165, Reward: 515.1201, Test: 114.5248 [86.77], Avg: 102.9319 (0.602)
Ep: 166, Reward: 539.5073, Test: 181.2502 [90.14], Avg: 102.8611 (0.600)
Ep: 167, Reward: 484.5218, Test: 147.1731 [88.18], Avg: 102.6000 (0.598)
Ep: 168, Reward: 417.0124, Test: 188.2297 [80.56], Avg: 102.6300 (0.596)
Ep: 169, Reward: 487.4089, Test: 181.8391 [75.05], Avg: 102.6544 (0.595)
Ep: 170, Reward: 547.5704, Test: 240.3605 [82.05], Avg: 102.9799 (0.593)
Ep: 171, Reward: 387.2908, Test: 188.1434 [69.26], Avg: 103.0724 (0.591)
Ep: 172, Reward: 485.3566, Test: 170.0668 [91.71], Avg: 102.9295 (0.589)
Ep: 173, Reward: 429.4569, Test: 208.9282 [63.41], Avg: 103.1743 (0.588)
Ep: 174, Reward: 483.9721, Test: 149.6082 [97.25], Avg: 102.8839 (0.586)
Ep: 175, Reward: 469.3069, Test: 295.4455 [170.21], Avg: 103.0109 (0.584)
Ep: 176, Reward: 525.7803, Test: 185.8051 [101.76], Avg: 102.9037 (0.582)
Ep: 177, Reward: 532.9843, Test: 180.1969 [83.63], Avg: 102.8682 (0.581)
Ep: 178, Reward: 545.5890, Test: 160.1117 [110.88], Avg: 102.5685 (0.579)
Ep: 179, Reward: 563.9777, Test: 171.5764 [80.96], Avg: 102.5021 (0.577)
Ep: 180, Reward: 467.8451, Test: 221.7867 [98.02], Avg: 102.6196 (0.575)
Ep: 181, Reward: 537.9737, Test: 204.2753 [77.92], Avg: 102.7500 (0.574)
Ep: 182, Reward: 509.5751, Test: 247.7079 [41.75], Avg: 103.3140 (0.572)
Ep: 183, Reward: 530.0085, Test: 195.8747 [73.87], Avg: 103.4156 (0.570)
Ep: 184, Reward: 555.6201, Test: 254.1141 [117.27], Avg: 103.5963 (0.568)
Ep: 185, Reward: 516.6265, Test: 212.4721 [111.72], Avg: 103.5810 (0.567)
Ep: 186, Reward: 518.7438, Test: 171.8194 [96.69], Avg: 103.4289 (0.565)
Ep: 187, Reward: 578.6388, Test: 293.8861 [140.61], Avg: 103.6940 (0.563)
Ep: 188, Reward: 532.0185, Test: 219.2202 [117.09], Avg: 103.6857 (0.562)
Ep: 189, Reward: 580.4425, Test: 221.3413 [138.21], Avg: 103.5776 (0.560)
Ep: 190, Reward: 487.2616, Test: 206.8711 [88.46], Avg: 103.6552 (0.558)
Ep: 191, Reward: 453.8313, Test: 198.3200 [80.80], Avg: 103.7275 (0.557)
Ep: 192, Reward: 623.8731, Test: 162.5196 [89.55], Avg: 103.5681 (0.555)
Ep: 193, Reward: 553.8332, Test: 189.0088 [80.57], Avg: 103.5932 (0.553)
Ep: 194, Reward: 539.7475, Test: 242.1082 [98.13], Avg: 103.8002 (0.552)
Ep: 195, Reward: 537.1726, Test: 204.0788 [108.79], Avg: 103.7568 (0.550)
Ep: 196, Reward: 567.5554, Test: 214.9905 [102.45], Avg: 103.8014 (0.548)
Ep: 197, Reward: 522.8715, Test: 291.1059 [122.02], Avg: 104.1311 (0.547)
Ep: 198, Reward: 539.2930, Test: 163.4096 [77.34], Avg: 104.0403 (0.545)
Ep: 199, Reward: 491.2471, Test: 190.7873 [48.01], Avg: 104.2340 (0.543)
Ep: 200, Reward: 497.8489, Test: 232.6761 [77.38], Avg: 104.4881 (0.542)
Ep: 201, Reward: 551.6880, Test: 209.3059 [106.90], Avg: 104.4778 (0.540)
Ep: 202, Reward: 487.0760, Test: 172.9950 [114.33], Avg: 104.2521 (0.539)
Ep: 203, Reward: 559.9723, Test: 230.3846 [64.81], Avg: 104.5527 (0.537)
Ep: 204, Reward: 522.5087, Test: 200.7735 [95.20], Avg: 104.5577 (0.535)
Ep: 205, Reward: 526.3594, Test: 194.8796 [100.50], Avg: 104.5083 (0.534)
Ep: 206, Reward: 515.7964, Test: 221.7108 [98.57], Avg: 104.5983 (0.532)
Ep: 207, Reward: 488.4214, Test: 287.9349 [124.92], Avg: 104.8791 (0.530)
Ep: 208, Reward: 580.1373, Test: 209.5200 [85.37], Avg: 104.9713 (0.529)
Ep: 209, Reward: 557.5778, Test: 239.1289 [111.85], Avg: 105.0776 (0.527)
Ep: 210, Reward: 566.7373, Test: 198.1798 [107.69], Avg: 105.0085 (0.526)
Ep: 211, Reward: 511.1177, Test: 202.3950 [105.68], Avg: 104.9693 (0.524)
Ep: 212, Reward: 544.0860, Test: 204.6070 [109.34], Avg: 104.9238 (0.523)
Ep: 213, Reward: 639.7426, Test: 222.0757 [111.50], Avg: 104.9502 (0.521)
Ep: 214, Reward: 451.2913, Test: 212.6165 [115.15], Avg: 104.9154 (0.519)
Ep: 215, Reward: 530.4211, Test: 208.0743 [75.67], Avg: 105.0427 (0.518)
Ep: 216, Reward: 551.4859, Test: 247.0995 [143.55], Avg: 105.0358 (0.516)
Ep: 217, Reward: 533.5946, Test: 261.2403 [123.38], Avg: 105.1864 (0.515)
Ep: 218, Reward: 469.7241, Test: 216.8315 [103.13], Avg: 105.2253 (0.513)
Ep: 219, Reward: 546.4947, Test: 261.1428 [188.06], Avg: 105.0792 (0.512)
Ep: 220, Reward: 529.6280, Test: 266.6203 [172.68], Avg: 105.0287 (0.510)
Ep: 221, Reward: 495.2125, Test: 247.3243 [124.03], Avg: 105.1110 (0.509)
Ep: 222, Reward: 515.9623, Test: 212.8443 [76.02], Avg: 105.2532 (0.507)
Ep: 223, Reward: 664.5985, Test: 214.6741 [135.41], Avg: 105.1372 (0.506)
Ep: 224, Reward: 477.3125, Test: 184.3899 [116.13], Avg: 104.9733 (0.504)
Ep: 225, Reward: 524.8640, Test: 208.7810 [117.96], Avg: 104.9107 (0.503)
Ep: 226, Reward: 572.5817, Test: 202.6043 [77.48], Avg: 104.9997 (0.501)
Ep: 227, Reward: 500.1598, Test: 207.3746 [153.24], Avg: 104.7766 (0.500)
Ep: 228, Reward: 522.9170, Test: 225.6975 [80.73], Avg: 104.9521 (0.498)
Ep: 229, Reward: 453.2350, Test: 166.2176 [100.73], Avg: 104.7805 (0.497)
Ep: 230, Reward: 430.7141, Test: 189.1458 [110.24], Avg: 104.6685 (0.495)
Ep: 231, Reward: 501.6035, Test: 227.2312 [78.18], Avg: 104.8598 (0.494)
Ep: 232, Reward: 524.1662, Test: 234.1994 [118.17], Avg: 104.9078 (0.492)
Ep: 233, Reward: 504.8462, Test: 211.4014 [84.08], Avg: 105.0036 (0.491)
Ep: 234, Reward: 531.7715, Test: 272.0909 [62.35], Avg: 105.4492 (0.489)
Ep: 235, Reward: 503.1186, Test: 229.6283 [108.67], Avg: 105.5149 (0.488)
Ep: 236, Reward: 532.4097, Test: 282.0389 [92.13], Avg: 105.8710 (0.486)
Ep: 237, Reward: 493.0994, Test: 240.4592 [85.23], Avg: 106.0784 (0.485)
Ep: 238, Reward: 555.6451, Test: 245.1895 [81.81], Avg: 106.3182 (0.483)
Ep: 239, Reward: 466.9432, Test: 285.5358 [87.70], Avg: 106.6995 (0.482)
Ep: 240, Reward: 447.7122, Test: 263.5964 [103.35], Avg: 106.9217 (0.480)
Ep: 241, Reward: 516.4469, Test: 274.9173 [47.36], Avg: 107.4202 (0.479)
Ep: 242, Reward: 494.7833, Test: 224.4682 [90.65], Avg: 107.5289 (0.478)
Ep: 243, Reward: 534.8416, Test: 209.4276 [103.91], Avg: 107.5206 (0.476)
Ep: 244, Reward: 561.2880, Test: 345.3904 [141.99], Avg: 107.9119 (0.475)
Ep: 245, Reward: 587.0303, Test: 264.5976 [93.98], Avg: 108.1668 (0.473)
Ep: 246, Reward: 599.0078, Test: 255.0459 [107.16], Avg: 108.3276 (0.472)
Ep: 247, Reward: 548.6469, Test: 241.6042 [120.03], Avg: 108.3811 (0.470)
Ep: 248, Reward: 513.0248, Test: 217.4213 [107.59], Avg: 108.3869 (0.469)
Ep: 249, Reward: 602.5751, Test: 231.9426 [110.01], Avg: 108.4411 (0.468)
Ep: 250, Reward: 638.3159, Test: 256.9650 [197.82], Avg: 108.2446 (0.466)
Ep: 251, Reward: 518.5774, Test: 293.8692 [122.32], Avg: 108.4959 (0.465)
Ep: 252, Reward: 663.7122, Test: 260.9981 [84.21], Avg: 108.7658 (0.463)
Ep: 253, Reward: 709.4452, Test: 263.0789 [86.02], Avg: 109.0347 (0.462)
Ep: 254, Reward: 561.5354, Test: 289.9231 [61.84], Avg: 109.5015 (0.461)
Ep: 255, Reward: 614.5470, Test: 279.0146 [117.59], Avg: 109.7043 (0.459)
Ep: 256, Reward: 635.0798, Test: 252.9033 [113.50], Avg: 109.8199 (0.458)
Ep: 257, Reward: 668.6522, Test: 236.6821 [148.49], Avg: 109.7361 (0.456)
Ep: 258, Reward: 539.4662, Test: 227.4565 [123.59], Avg: 109.7134 (0.455)
Ep: 259, Reward: 756.4431, Test: 255.0195 [85.24], Avg: 109.9444 (0.454)
Ep: 260, Reward: 562.0742, Test: 230.1433 [99.50], Avg: 110.0237 (0.452)
Ep: 261, Reward: 520.0506, Test: 260.3657 [187.94], Avg: 109.8802 (0.451)
Ep: 262, Reward: 613.7019, Test: 294.9280 [114.68], Avg: 110.1478 (0.450)
Ep: 263, Reward: 653.9324, Test: 303.7147 [66.76], Avg: 110.6281 (0.448)
Ep: 264, Reward: 492.3169, Test: 267.8914 [116.41], Avg: 110.7823 (0.447)
Ep: 265, Reward: 628.2636, Test: 296.8938 [71.42], Avg: 111.2135 (0.446)
Ep: 266, Reward: 623.3055, Test: 221.5278 [72.58], Avg: 111.3548 (0.444)
Ep: 267, Reward: 502.0028, Test: 246.1152 [100.24], Avg: 111.4836 (0.443)
Ep: 268, Reward: 574.8533, Test: 205.0881 [130.48], Avg: 111.3465 (0.442)
Ep: 269, Reward: 558.3342, Test: 350.5039 [183.83], Avg: 111.5514 (0.440)
Ep: 270, Reward: 581.0487, Test: 236.1611 [98.94], Avg: 111.6462 (0.439)
Ep: 271, Reward: 526.9586, Test: 179.2119 [97.13], Avg: 111.5375 (0.438)
Ep: 272, Reward: 472.6004, Test: 240.2774 [121.02], Avg: 111.5657 (0.436)
Ep: 273, Reward: 585.0379, Test: 260.3138 [88.76], Avg: 111.7847 (0.435)
Ep: 274, Reward: 600.2801, Test: 237.3035 [70.99], Avg: 111.9830 (0.434)
Ep: 275, Reward: 661.9578, Test: 253.3230 [122.85], Avg: 112.0499 (0.432)
Ep: 276, Reward: 620.8870, Test: 210.7395 [110.03], Avg: 112.0090 (0.431)
Ep: 277, Reward: 557.0746, Test: 305.1090 [134.96], Avg: 112.2181 (0.430)
Ep: 278, Reward: 625.5822, Test: 243.9752 [120.13], Avg: 112.2598 (0.429)
Ep: 279, Reward: 564.2649, Test: 225.9237 [130.51], Avg: 112.1996 (0.427)
Ep: 280, Reward: 635.9031, Test: 284.4766 [104.29], Avg: 112.4416 (0.426)
Ep: 281, Reward: 587.7790, Test: 230.5403 [130.23], Avg: 112.3986 (0.425)
Ep: 282, Reward: 587.5284, Test: 224.3067 [67.36], Avg: 112.5560 (0.423)
Ep: 283, Reward: 527.8665, Test: 332.4831 [204.79], Avg: 112.6092 (0.422)
Ep: 284, Reward: 510.6715, Test: 240.0298 [102.93], Avg: 112.6952 (0.421)
Ep: 285, Reward: 577.2881, Test: 295.4323 [194.93], Avg: 112.6525 (0.420)
Ep: 286, Reward: 583.7533, Test: 219.7571 [112.51], Avg: 112.6337 (0.418)
Ep: 287, Reward: 485.7330, Test: 167.7772 [104.74], Avg: 112.4615 (0.417)
Ep: 288, Reward: 528.4254, Test: 255.4989 [76.31], Avg: 112.6924 (0.416)
Ep: 289, Reward: 614.1655, Test: 212.1787 [134.04], Avg: 112.5732 (0.415)
Ep: 290, Reward: 651.3563, Test: 215.4062 [150.71], Avg: 112.4087 (0.413)
Ep: 291, Reward: 541.6586, Test: 259.4033 [77.22], Avg: 112.6477 (0.412)
Ep: 292, Reward: 645.4877, Test: 260.8468 [98.78], Avg: 112.8163 (0.411)
Ep: 293, Reward: 554.2837, Test: 337.4591 [154.96], Avg: 113.0534 (0.410)
Ep: 294, Reward: 640.6105, Test: 223.9077 [104.95], Avg: 113.0734 (0.408)
Ep: 295, Reward: 544.1082, Test: 247.0038 [106.79], Avg: 113.1651 (0.407)
Ep: 296, Reward: 567.4158, Test: 228.9014 [85.28], Avg: 113.2676 (0.406)
Ep: 297, Reward: 469.1332, Test: 193.4621 [116.69], Avg: 113.1451 (0.405)
Ep: 298, Reward: 489.9523, Test: 215.4658 [167.94], Avg: 112.9257 (0.404)
Ep: 299, Reward: 408.6600, Test: 251.1714 [107.74], Avg: 113.0273 (0.402)
Ep: 300, Reward: 553.3030, Test: 178.1512 [107.16], Avg: 112.8877 (0.401)
Ep: 301, Reward: 553.3110, Test: 206.7779 [125.50], Avg: 112.7830 (0.400)
Ep: 302, Reward: 593.5132, Test: 268.7929 [119.94], Avg: 112.9021 (0.399)
Ep: 303, Reward: 419.4869, Test: 201.0377 [125.68], Avg: 112.7786 (0.398)
Ep: 304, Reward: 475.1653, Test: 216.8787 [42.13], Avg: 112.9818 (0.396)
Ep: 305, Reward: 520.1234, Test: 195.3409 [97.45], Avg: 112.9325 (0.395)
Ep: 306, Reward: 518.0160, Test: 196.4021 [90.50], Avg: 112.9096 (0.394)
Ep: 307, Reward: 531.3812, Test: 232.4312 [111.14], Avg: 112.9368 (0.393)
Ep: 308, Reward: 473.3519, Test: 245.0073 [127.42], Avg: 112.9518 (0.392)
Ep: 309, Reward: 597.5723, Test: 266.5833 [98.58], Avg: 113.1294 (0.390)
Ep: 310, Reward: 574.4206, Test: 175.6518 [128.04], Avg: 112.9188 (0.389)
Ep: 311, Reward: 503.3220, Test: 254.3983 [148.84], Avg: 112.8952 (0.387)
Ep: 312, Reward: 551.7859, Test: 202.6668 [155.04], Avg: 112.6866 (0.386)
Ep: 313, Reward: 568.6445, Test: 187.8028 [115.55], Avg: 112.5579 (0.385)
Ep: 314, Reward: 567.2590, Test: 232.2282 [71.81], Avg: 112.7098 (0.383)
Ep: 315, Reward: 600.0194, Test: 276.8974 [127.55], Avg: 112.8258 (0.382)
Ep: 316, Reward: 616.6480, Test: 210.8957 [129.29], Avg: 112.7273 (0.381)
Ep: 317, Reward: 631.4569, Test: 198.3935 [111.18], Avg: 112.6471 (0.380)
Ep: 318, Reward: 623.2052, Test: 246.7439 [99.93], Avg: 112.7542 (0.379)
Ep: 319, Reward: 525.3108, Test: 203.4640 [87.91], Avg: 112.7629 (0.378)
Ep: 320, Reward: 507.7816, Test: 243.9910 [117.48], Avg: 112.8058 (0.377)
Ep: 321, Reward: 563.9766, Test: 245.0840 [84.09], Avg: 112.9554 (0.376)
Ep: 322, Reward: 567.6610, Test: 217.8916 [134.17], Avg: 112.8649 (0.374)
Ep: 323, Reward: 561.6608, Test: 235.2080 [106.35], Avg: 112.9143 (0.373)
Ep: 324, Reward: 647.5875, Test: 269.9615 [72.34], Avg: 113.1749 (0.372)
Ep: 325, Reward: 481.6441, Test: 198.5189 [106.19], Avg: 113.1109 (0.371)
Ep: 326, Reward: 571.0757, Test: 252.7811 [55.94], Avg: 113.3670 (0.370)
Ep: 327, Reward: 631.0853, Test: 283.1576 [98.71], Avg: 113.5837 (0.369)
Ep: 328, Reward: 547.2971, Test: 254.2600 [97.02], Avg: 113.7164 (0.368)
Ep: 329, Reward: 583.8697, Test: 242.6487 [102.06], Avg: 113.7978 (0.367)
Ep: 330, Reward: 527.1190, Test: 319.8703 [106.77], Avg: 114.0978 (0.365)
Ep: 331, Reward: 588.5240, Test: 216.9157 [177.69], Avg: 113.8723 (0.364)
Ep: 332, Reward: 648.8521, Test: 228.4197 [155.63], Avg: 113.7490 (0.363)
Ep: 333, Reward: 586.5473, Test: 265.9466 [69.39], Avg: 113.9969 (0.362)
Ep: 334, Reward: 585.8553, Test: 250.6802 [109.11], Avg: 114.0792 (0.361)
Ep: 335, Reward: 638.6758, Test: 304.5528 [175.62], Avg: 114.1234 (0.360)
Ep: 336, Reward: 448.2560, Test: 286.8903 [126.09], Avg: 114.2619 (0.359)
Ep: 337, Reward: 588.9876, Test: 184.4145 [93.32], Avg: 114.1934 (0.358)
Ep: 338, Reward: 491.9058, Test: 286.7518 [123.11], Avg: 114.3392 (0.357)
Ep: 339, Reward: 651.6886, Test: 259.5964 [112.58], Avg: 114.4354 (0.356)
Ep: 340, Reward: 562.8991, Test: 220.3093 [97.34], Avg: 114.4604 (0.355)
Ep: 341, Reward: 664.5740, Test: 340.9474 [136.11], Avg: 114.7247 (0.354)
Ep: 342, Reward: 632.9075, Test: 285.7897 [186.36], Avg: 114.6801 (0.353)
Ep: 343, Reward: 572.8409, Test: 278.2463 [125.83], Avg: 114.7898 (0.351)
Ep: 344, Reward: 611.7198, Test: 284.7806 [61.94], Avg: 115.1029 (0.350)
Ep: 345, Reward: 622.0073, Test: 248.7287 [171.82], Avg: 114.9926 (0.349)
Ep: 346, Reward: 498.0469, Test: 311.8450 [179.50], Avg: 115.0426 (0.348)
Ep: 347, Reward: 620.7338, Test: 275.9551 [115.48], Avg: 115.1731 (0.347)
Ep: 348, Reward: 646.5019, Test: 212.1007 [135.19], Avg: 115.0635 (0.346)
Ep: 349, Reward: 715.5210, Test: 360.2332 [135.14], Avg: 115.3778 (0.345)
Ep: 350, Reward: 602.7120, Test: 226.9699 [141.39], Avg: 115.2929 (0.344)
Ep: 351, Reward: 506.1329, Test: 268.8867 [169.92], Avg: 115.2466 (0.343)
Ep: 352, Reward: 657.6143, Test: 288.4224 [161.50], Avg: 115.2796 (0.342)
Ep: 353, Reward: 511.5276, Test: 321.1347 [140.07], Avg: 115.4655 (0.341)
Ep: 354, Reward: 647.6538, Test: 233.2841 [142.07], Avg: 115.3972 (0.340)
Ep: 355, Reward: 637.8533, Test: 261.5076 [94.79], Avg: 115.5413 (0.339)
Ep: 356, Reward: 671.8164, Test: 360.3450 [94.24], Avg: 115.9631 (0.338)
Ep: 357, Reward: 537.4038, Test: 359.0800 [198.74], Avg: 116.0870 (0.337)
Ep: 358, Reward: 780.7466, Test: 225.4282 [117.81], Avg: 116.0634 (0.336)
Ep: 359, Reward: 662.7851, Test: 300.2213 [154.01], Avg: 116.1472 (0.335)
Ep: 360, Reward: 712.4571, Test: 231.3119 [90.99], Avg: 116.2141 (0.334)
Ep: 361, Reward: 627.8525, Test: 326.0518 [157.86], Avg: 116.3577 (0.333)
Ep: 362, Reward: 709.0809, Test: 315.7418 [224.89], Avg: 116.2875 (0.332)
Ep: 363, Reward: 601.9691, Test: 318.5557 [229.02], Avg: 116.2140 (0.331)
Ep: 364, Reward: 622.9673, Test: 272.3412 [109.75], Avg: 116.3410 (0.330)
Ep: 365, Reward: 712.3817, Test: 311.1067 [177.09], Avg: 116.3893 (0.329)
Ep: 366, Reward: 699.0658, Test: 426.0584 [229.45], Avg: 116.6079 (0.328)
Ep: 367, Reward: 614.1953, Test: 352.0438 [133.74], Avg: 116.8843 (0.327)
Ep: 368, Reward: 616.2948, Test: 271.8700 [149.11], Avg: 116.9002 (0.326)
Ep: 369, Reward: 592.7226, Test: 293.1993 [131.15], Avg: 117.0222 (0.325)
Ep: 370, Reward: 539.2705, Test: 344.5349 [220.72], Avg: 117.0405 (0.324)
Ep: 371, Reward: 642.8673, Test: 382.2219 [253.66], Avg: 117.0715 (0.323)
Ep: 372, Reward: 645.3287, Test: 292.1166 [194.15], Avg: 117.0203 (0.322)
Ep: 373, Reward: 675.2314, Test: 217.3559 [133.91], Avg: 116.9305 (0.321)
Ep: 374, Reward: 702.4484, Test: 396.9283 [174.45], Avg: 117.2120 (0.320)
Ep: 375, Reward: 710.0339, Test: 337.8817 [190.03], Avg: 117.2934 (0.319)
Ep: 376, Reward: 625.1481, Test: 302.9295 [138.91], Avg: 117.4174 (0.318)
Ep: 377, Reward: 706.2187, Test: 278.3310 [119.23], Avg: 117.5277 (0.317)
Ep: 378, Reward: 632.5521, Test: 272.7615 [141.63], Avg: 117.5636 (0.316)
Ep: 379, Reward: 549.2044, Test: 367.3451 [201.76], Avg: 117.6900 (0.315)
Ep: 380, Reward: 634.0739, Test: 370.2798 [216.60], Avg: 117.7844 (0.315)
Ep: 381, Reward: 547.9384, Test: 406.4808 [208.86], Avg: 117.9934 (0.314)
Ep: 382, Reward: 539.0083, Test: 385.4137 [207.63], Avg: 118.1495 (0.313)
Ep: 383, Reward: 662.7514, Test: 277.5905 [191.66], Avg: 118.0656 (0.312)
Ep: 384, Reward: 712.2798, Test: 315.3281 [142.04], Avg: 118.2091 (0.311)
Ep: 385, Reward: 626.2791, Test: 441.5516 [242.56], Avg: 118.4183 (0.310)
Ep: 386, Reward: 735.7742, Test: 431.5680 [149.56], Avg: 118.8411 (0.309)
Ep: 387, Reward: 694.6895, Test: 475.8858 [195.93], Avg: 119.2563 (0.308)
Ep: 388, Reward: 750.2158, Test: 369.6199 [167.12], Avg: 119.4703 (0.307)
Ep: 389, Reward: 717.3089, Test: 370.4603 [115.08], Avg: 119.8188 (0.306)
Ep: 390, Reward: 723.3530, Test: 436.1533 [179.03], Avg: 120.1699 (0.305)
Ep: 391, Reward: 693.2209, Test: 415.0720 [206.50], Avg: 120.3954 (0.304)
Ep: 392, Reward: 603.1898, Test: 329.8772 [108.66], Avg: 120.6520 (0.303)
Ep: 393, Reward: 788.5891, Test: 291.8504 [204.13], Avg: 120.5684 (0.302)
Ep: 394, Reward: 618.3808, Test: 313.9608 [191.37], Avg: 120.5735 (0.302)
Ep: 395, Reward: 637.2780, Test: 269.0918 [239.24], Avg: 120.3444 (0.301)
Ep: 396, Reward: 720.2582, Test: 383.6428 [161.46], Avg: 120.6009 (0.300)
Ep: 397, Reward: 716.7372, Test: 364.6352 [242.28], Avg: 120.6054 (0.299)
Ep: 398, Reward: 673.4434, Test: 304.9221 [101.42], Avg: 120.8131 (0.298)
Ep: 399, Reward: 698.5222, Test: 313.3654 [170.66], Avg: 120.8678 (0.297)
Ep: 400, Reward: 635.5304, Test: 371.0914 [115.19], Avg: 121.2046 (0.296)
Ep: 401, Reward: 740.9834, Test: 468.6341 [146.82], Avg: 121.7036 (0.295)
Ep: 402, Reward: 779.5641, Test: 364.8971 [68.36], Avg: 122.1375 (0.294)
Ep: 403, Reward: 701.7081, Test: 395.3702 [160.87], Avg: 122.4156 (0.294)
Ep: 404, Reward: 715.8489, Test: 261.8554 [111.98], Avg: 122.4834 (0.293)
Ep: 405, Reward: 719.6021, Test: 278.8330 [112.74], Avg: 122.5908 (0.292)
Ep: 406, Reward: 539.2431, Test: 367.7186 [190.36], Avg: 122.7254 (0.291)
Ep: 407, Reward: 665.4224, Test: 414.7817 [158.07], Avg: 123.0538 (0.290)
Ep: 408, Reward: 751.9842, Test: 315.7927 [137.96], Avg: 123.1877 (0.289)
Ep: 409, Reward: 594.7849, Test: 262.9910 [123.03], Avg: 123.2286 (0.288)
Ep: 410, Reward: 636.3530, Test: 265.9400 [103.14], Avg: 123.3249 (0.287)
Ep: 411, Reward: 605.6448, Test: 331.5924 [269.63], Avg: 123.1760 (0.287)
Ep: 412, Reward: 757.6530, Test: 297.4629 [65.95], Avg: 123.4383 (0.286)
Ep: 413, Reward: 676.2402, Test: 360.9035 [173.69], Avg: 123.5923 (0.285)
Ep: 414, Reward: 674.4845, Test: 406.0175 [218.85], Avg: 123.7455 (0.284)
Ep: 415, Reward: 710.5162, Test: 367.5258 [162.45], Avg: 123.9410 (0.283)
Ep: 416, Reward: 722.2140, Test: 290.5460 [57.17], Avg: 124.2035 (0.282)
Ep: 417, Reward: 622.4086, Test: 310.1979 [201.83], Avg: 124.1656 (0.281)
Ep: 418, Reward: 714.1659, Test: 291.7469 [129.95], Avg: 124.2554 (0.281)
Ep: 419, Reward: 700.2305, Test: 368.9082 [151.12], Avg: 124.4781 (0.280)
Ep: 420, Reward: 628.0513, Test: 497.1951 [230.14], Avg: 124.8167 (0.279)
Ep: 421, Reward: 604.1918, Test: 220.5858 [88.39], Avg: 124.8342 (0.278)
Ep: 422, Reward: 737.6852, Test: 278.5207 [137.25], Avg: 124.8731 (0.277)
Ep: 423, Reward: 774.7414, Test: 394.0710 [261.20], Avg: 124.8919 (0.276)
Ep: 424, Reward: 681.2382, Test: 300.3547 [125.18], Avg: 125.0103 (0.276)
Ep: 425, Reward: 688.6362, Test: 344.8028 [147.35], Avg: 125.1803 (0.275)
Ep: 426, Reward: 701.6887, Test: 349.0932 [156.78], Avg: 125.3375 (0.274)
Ep: 427, Reward: 722.8639, Test: 327.0020 [163.20], Avg: 125.4274 (0.273)
Ep: 428, Reward: 693.6867, Test: 380.6567 [205.57], Avg: 125.5432 (0.272)
Ep: 429, Reward: 618.2564, Test: 460.0966 [205.32], Avg: 125.8437 (0.271)
Ep: 430, Reward: 738.6628, Test: 371.5389 [124.26], Avg: 126.1254 (0.271)
Ep: 431, Reward: 642.3571, Test: 305.8856 [76.52], Avg: 126.3644 (0.270)
Ep: 432, Reward: 743.9889, Test: 385.9876 [180.82], Avg: 126.5464 (0.269)
Ep: 433, Reward: 658.1106, Test: 337.6981 [212.83], Avg: 126.5425 (0.268)
Ep: 434, Reward: 749.2384, Test: 352.7184 [112.08], Avg: 126.8048 (0.267)
Ep: 435, Reward: 730.4280, Test: 336.4797 [189.61], Avg: 126.8508 (0.267)
Ep: 436, Reward: 705.9461, Test: 371.0996 [198.02], Avg: 126.9566 (0.266)
Ep: 437, Reward: 710.4980, Test: 456.0689 [212.13], Avg: 127.2237 (0.265)
Ep: 438, Reward: 744.1765, Test: 337.5691 [190.46], Avg: 127.2690 (0.264)
Ep: 439, Reward: 743.6237, Test: 482.6369 [223.73], Avg: 127.5682 (0.263)
Ep: 440, Reward: 789.9576, Test: 524.3837 [184.24], Avg: 128.0502 (0.263)
Ep: 441, Reward: 748.4541, Test: 407.5589 [216.35], Avg: 128.1931 (0.262)
Ep: 442, Reward: 767.5742, Test: 468.4151 [173.28], Avg: 128.5699 (0.261)
Ep: 443, Reward: 712.6326, Test: 418.0956 [139.32], Avg: 128.9082 (0.260)
Ep: 444, Reward: 693.3564, Test: 362.9798 [194.92], Avg: 128.9962 (0.259)
Ep: 445, Reward: 821.3473, Test: 393.2947 [180.91], Avg: 129.1832 (0.259)
Ep: 446, Reward: 782.9198, Test: 457.3304 [204.28], Avg: 129.4603 (0.258)
Ep: 447, Reward: 757.8611, Test: 481.5027 [162.65], Avg: 129.8830 (0.257)
Ep: 448, Reward: 664.3042, Test: 387.2841 [203.01], Avg: 130.0042 (0.256)
Ep: 449, Reward: 711.4553, Test: 430.3642 [134.86], Avg: 130.3719 (0.256)
Ep: 450, Reward: 734.5353, Test: 558.6035 [172.02], Avg: 130.9400 (0.255)
Ep: 451, Reward: 720.4947, Test: 384.3818 [168.66], Avg: 131.1276 (0.254)
Ep: 452, Reward: 801.9334, Test: 500.3967 [203.57], Avg: 131.4934 (0.253)
Ep: 453, Reward: 763.4757, Test: 447.5611 [205.79], Avg: 131.7363 (0.253)
Ep: 454, Reward: 602.5608, Test: 368.2269 [141.18], Avg: 131.9458 (0.252)
Ep: 455, Reward: 652.7373, Test: 544.7427 [230.03], Avg: 132.3466 (0.251)
Ep: 456, Reward: 744.1058, Test: 599.1007 [181.94], Avg: 132.9698 (0.250)
Ep: 457, Reward: 773.1200, Test: 461.9148 [204.67], Avg: 133.2412 (0.250)
Ep: 458, Reward: 761.7183, Test: 470.8379 [165.92], Avg: 133.6152 (0.249)
Ep: 459, Reward: 762.8397, Test: 469.6404 [227.11], Avg: 133.8520 (0.248)
Ep: 460, Reward: 707.3919, Test: 458.0682 [194.78], Avg: 134.1327 (0.247)
Ep: 461, Reward: 781.8299, Test: 499.7994 [182.28], Avg: 134.5297 (0.247)
Ep: 462, Reward: 739.5657, Test: 380.4682 [192.62], Avg: 134.6448 (0.246)
Ep: 463, Reward: 734.9414, Test: 443.3960 [160.20], Avg: 134.9650 (0.245)
Ep: 464, Reward: 759.1036, Test: 461.5579 [205.77], Avg: 135.2248 (0.244)
Ep: 465, Reward: 704.5768, Test: 518.9264 [180.61], Avg: 135.6607 (0.244)
Ep: 466, Reward: 785.9319, Test: 393.8943 [152.87], Avg: 135.8863 (0.243)
Ep: 467, Reward: 791.1443, Test: 395.1950 [189.56], Avg: 136.0353 (0.242)
Ep: 468, Reward: 741.6428, Test: 442.5808 [206.96], Avg: 136.2476 (0.241)
Ep: 469, Reward: 779.5368, Test: 348.4785 [251.22], Avg: 136.1647 (0.241)
Ep: 470, Reward: 732.5827, Test: 436.2363 [170.56], Avg: 136.4397 (0.240)
Ep: 471, Reward: 726.3012, Test: 297.0774 [68.61], Avg: 136.6346 (0.239)
Ep: 472, Reward: 773.2712, Test: 400.7568 [163.73], Avg: 136.8469 (0.239)
Ep: 473, Reward: 787.0838, Test: 391.1255 [223.05], Avg: 136.9128 (0.238)
Ep: 474, Reward: 786.1153, Test: 425.2172 [202.18], Avg: 137.0941 (0.237)
Ep: 475, Reward: 741.8502, Test: 329.6474 [118.76], Avg: 137.2491 (0.236)
Ep: 476, Reward: 795.9656, Test: 430.5496 [226.57], Avg: 137.3890 (0.236)
Ep: 477, Reward: 737.7314, Test: 443.7097 [230.68], Avg: 137.5473 (0.235)
Ep: 478, Reward: 756.9911, Test: 482.1590 [212.39], Avg: 137.8233 (0.234)
Ep: 479, Reward: 772.3496, Test: 424.0111 [162.72], Avg: 138.0805 (0.234)
Ep: 480, Reward: 772.1950, Test: 424.4999 [173.23], Avg: 138.3158 (0.233)
Ep: 481, Reward: 672.4470, Test: 396.9894 [201.27], Avg: 138.4349 (0.232)
Ep: 482, Reward: 767.1221, Test: 485.6431 [242.71], Avg: 138.6513 (0.231)
Ep: 483, Reward: 704.2953, Test: 373.4088 [192.08], Avg: 138.7395 (0.231)
Ep: 484, Reward: 717.5605, Test: 334.0836 [171.18], Avg: 138.7893 (0.230)
Ep: 485, Reward: 755.1106, Test: 460.7095 [216.93], Avg: 139.0053 (0.229)
Ep: 486, Reward: 774.3285, Test: 354.3407 [142.18], Avg: 139.1556 (0.229)
Ep: 487, Reward: 699.0759, Test: 393.8548 [146.56], Avg: 139.3772 (0.228)
Ep: 488, Reward: 731.3997, Test: 362.4542 [210.00], Avg: 139.4039 (0.227)
Ep: 489, Reward: 750.9763, Test: 387.1623 [144.70], Avg: 139.6142 (0.227)
Ep: 490, Reward: 756.9189, Test: 381.4144 [131.11], Avg: 139.8396 (0.226)
Ep: 491, Reward: 754.1077, Test: 397.2050 [220.06], Avg: 139.9155 (0.225)
Ep: 492, Reward: 791.6749, Test: 437.5952 [154.76], Avg: 140.2054 (0.225)
Ep: 493, Reward: 771.8239, Test: 459.3306 [210.61], Avg: 140.4250 (0.224)
Ep: 494, Reward: 720.1385, Test: 419.9636 [155.48], Avg: 140.6756 (0.223)
Ep: 495, Reward: 764.7539, Test: 524.3191 [182.94], Avg: 141.0803 (0.223)
Ep: 496, Reward: 719.0312, Test: 508.8543 [187.53], Avg: 141.4430 (0.222)
Ep: 497, Reward: 749.3777, Test: 399.2039 [110.48], Avg: 141.7387 (0.221)
Ep: 498, Reward: 781.2135, Test: 470.5869 [149.46], Avg: 142.0982 (0.221)
Ep: 499, Reward: 784.6555, Test: 498.9599 [196.49], Avg: 142.4190 (0.220)
