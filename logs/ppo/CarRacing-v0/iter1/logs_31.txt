Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, ADVANTAGE_DECAY

EPS_MIN = 0.1                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 16					# Number of samples to train on for each train step
PPO_EPOCHS = 1					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.01				# The limit of the ratio of new action probabilities to old probabilities
NUM_STEPS = 20  				# The number of steps to collect experience in sequence for each GAE calculation

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= self.update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(PPO_EPOCHS):
				for i in range(0, len(self.replay_buffer), BATCH_SIZE):
					state, action, log_prob, target, advantage = self.replay_buffer.index(BATCH_SIZE, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=16*self.update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -37.8549, Test: -25.9756 [18.24], Avg: -44.2115 (0.997)
Ep: 1, Reward: -30.2901, Test: -19.3603 [21.41], Avg: -42.4920 (0.994)
Ep: 2, Reward: -25.0681, Test: -17.9785 [17.51], Avg: -40.1567 (0.991)
Ep: 3, Reward: -26.2357, Test: -20.6100 [22.35], Avg: -40.8571 (0.988)
Ep: 4, Reward: -22.7358, Test: -18.6889 [10.36], Avg: -38.4952 (0.985)
Ep: 5, Reward: -22.2997, Test: -61.7167 [48.23], Avg: -50.4037 (0.982)
Ep: 6, Reward: -28.6193, Test: -91.8430 [42.26], Avg: -62.3611 (0.979)
Ep: 7, Reward: -33.1205, Test: -117.3391 [9.04], Avg: -70.3633 (0.976)
Ep: 8, Reward: -22.4783, Test: -59.4608 [65.64], Avg: -76.4448 (0.973)
Ep: 9, Reward: -22.9471, Test: -93.5564 [40.46], Avg: -82.2025 (0.970)
Ep: 10, Reward: -28.1801, Test: 195.5777 [105.33], Avg: -66.5255 (0.967)
Ep: 11, Reward: 48.3052, Test: 382.9611 [208.61], Avg: -46.4528 (0.965)
Ep: 12, Reward: 101.2550, Test: 204.8959 [135.04], Avg: -37.5064 (0.962)
Ep: 13, Reward: 156.5643, Test: 121.3067 [130.72], Avg: -35.4998 (0.959)
Ep: 14, Reward: 211.1266, Test: 213.5801 [102.82], Avg: -25.7494 (0.956)
Ep: 15, Reward: 238.4686, Test: 99.9324 [84.56], Avg: -23.1795 (0.953)
Ep: 16, Reward: 295.1956, Test: 113.8867 [111.42], Avg: -21.6710 (0.950)
Ep: 17, Reward: 392.8749, Test: 98.1017 [119.95], Avg: -21.6807 (0.947)
Ep: 18, Reward: 443.6531, Test: 146.1810 [119.91], Avg: -19.1570 (0.945)
Ep: 19, Reward: 544.6584, Test: 83.2430 [103.76], Avg: -19.2251 (0.942)
Ep: 20, Reward: 510.3638, Test: 26.8419 [57.40], Avg: -19.7645 (0.939)
Ep: 21, Reward: 494.2535, Test: 27.3999 [87.28], Avg: -21.5878 (0.936)
Ep: 22, Reward: 283.4235, Test: 20.8494 [74.97], Avg: -23.0021 (0.933)
Ep: 23, Reward: 401.7773, Test: 74.5286 [100.39], Avg: -23.1211 (0.930)
Ep: 24, Reward: 502.7915, Test: 35.4433 [67.17], Avg: -23.4654 (0.928)
Ep: 25, Reward: 488.3667, Test: 85.2221 [123.85], Avg: -24.0486 (0.925)
Ep: 26, Reward: 729.3614, Test: 96.9919 [89.74], Avg: -22.8894 (0.922)
Ep: 27, Reward: 515.8725, Test: 85.4304 [94.99], Avg: -22.4132 (0.919)
Ep: 28, Reward: 707.5232, Test: 99.7130 [108.82], Avg: -21.9544 (0.917)
Ep: 29, Reward: 438.2446, Test: 180.7021 [106.42], Avg: -18.7465 (0.914)
Ep: 30, Reward: 609.1491, Test: 67.0974 [93.44], Avg: -18.9914 (0.911)
Ep: 31, Reward: 610.9947, Test: 43.6454 [51.49], Avg: -18.6430 (0.908)
Ep: 32, Reward: 560.6701, Test: 49.3341 [82.16], Avg: -19.0728 (0.906)
Ep: 33, Reward: 632.6582, Test: 27.6203 [80.66], Avg: -20.0718 (0.903)
Ep: 34, Reward: 453.7048, Test: 113.5084 [80.42], Avg: -18.5528 (0.900)
Ep: 35, Reward: 436.4408, Test: 126.4913 [97.91], Avg: -17.2437 (0.897)
Ep: 36, Reward: 442.7946, Test: 92.2512 [86.26], Avg: -16.6157 (0.895)
Ep: 37, Reward: 422.9727, Test: 84.4380 [79.42], Avg: -16.0464 (0.892)
Ep: 38, Reward: 343.8398, Test: 51.1307 [82.28], Avg: -16.4338 (0.889)
Ep: 39, Reward: 307.7088, Test: 32.9177 [67.36], Avg: -16.8841 (0.887)
Ep: 40, Reward: 334.9120, Test: 45.1881 [74.51], Avg: -17.1876 (0.884)
Ep: 41, Reward: 411.4398, Test: 82.4231 [132.87], Avg: -17.9794 (0.881)
Ep: 42, Reward: 387.7353, Test: 67.1775 [93.97], Avg: -18.1843 (0.879)
Ep: 43, Reward: 518.6609, Test: 20.1068 [12.17], Avg: -17.5906 (0.876)
Ep: 44, Reward: 282.7135, Test: 24.4765 [63.93], Avg: -18.0765 (0.874)
Ep: 45, Reward: 275.7554, Test: -35.9677 [9.06], Avg: -18.6623 (0.871)
Ep: 46, Reward: 404.7332, Test: 5.2293 [73.23], Avg: -19.7121 (0.868)
Ep: 47, Reward: 402.2013, Test: 17.1738 [67.96], Avg: -20.3596 (0.866)
Ep: 48, Reward: 277.0123, Test: 32.3381 [67.79], Avg: -20.6675 (0.863)
Ep: 49, Reward: 314.4012, Test: 11.7794 [64.87], Avg: -21.3161 (0.861)
Ep: 50, Reward: 387.4006, Test: 5.7589 [24.70], Avg: -21.2695 (0.858)
Ep: 51, Reward: 327.9375, Test: -6.6798 [16.38], Avg: -21.3040 (0.855)
Ep: 52, Reward: 288.7706, Test: 39.1314 [76.87], Avg: -21.6142 (0.853)
Ep: 53, Reward: 268.5863, Test: 80.5920 [93.75], Avg: -21.4576 (0.850)
Ep: 54, Reward: 404.3217, Test: 20.7530 [54.40], Avg: -21.6792 (0.848)
Ep: 55, Reward: 243.8896, Test: 67.0477 [73.90], Avg: -21.4144 (0.845)
Ep: 56, Reward: 379.8936, Test: 9.2559 [30.74], Avg: -21.4156 (0.843)
Ep: 57, Reward: 404.4583, Test: 90.2741 [96.71], Avg: -21.1573 (0.840)
Ep: 58, Reward: 479.2392, Test: 139.6675 [103.07], Avg: -20.1784 (0.838)
Ep: 59, Reward: 538.9004, Test: 171.3947 [93.17], Avg: -18.5383 (0.835)
Ep: 60, Reward: 788.5993, Test: 165.3452 [89.18], Avg: -16.9858 (0.833)
Ep: 61, Reward: 590.0208, Test: 223.1591 [97.40], Avg: -14.6835 (0.830)
Ep: 62, Reward: 649.4003, Test: 171.6377 [131.01], Avg: -13.8056 (0.828)
Ep: 63, Reward: 607.5571, Test: 244.8619 [116.09], Avg: -11.5777 (0.825)
Ep: 64, Reward: 649.9908, Test: 244.4301 [104.13], Avg: -9.2412 (0.823)
Ep: 65, Reward: 675.0602, Test: 184.1043 [121.37], Avg: -8.1507 (0.820)
Ep: 66, Reward: 644.7527, Test: 155.8190 [88.28], Avg: -7.0210 (0.818)
Ep: 67, Reward: 565.7729, Test: 146.1207 [112.54], Avg: -6.4239 (0.815)
Ep: 68, Reward: 646.0195, Test: 178.5961 [107.78], Avg: -5.3045 (0.813)
Ep: 69, Reward: 672.5131, Test: 242.6116 [137.89], Avg: -3.7326 (0.810)
Ep: 70, Reward: 608.3030, Test: 366.5089 [149.18], Avg: -0.6190 (0.808)
Ep: 71, Reward: 701.2034, Test: 248.5731 [79.50], Avg: 1.7378 (0.805)
Ep: 72, Reward: 766.6008, Test: 231.3134 [101.38], Avg: 3.4939 (0.803)
Ep: 73, Reward: 730.7658, Test: 236.9626 [63.98], Avg: 5.7843 (0.801)
Ep: 74, Reward: 698.0246, Test: 219.4004 [82.75], Avg: 7.5292 (0.798)
Ep: 75, Reward: 484.9437, Test: 272.9867 [87.99], Avg: 9.8643 (0.796)
Ep: 76, Reward: 613.5262, Test: 216.8593 [88.62], Avg: 11.4017 (0.793)
Ep: 77, Reward: 768.2793, Test: 226.1108 [91.15], Avg: 12.9857 (0.791)
Ep: 78, Reward: 804.5565, Test: 274.3674 [89.89], Avg: 15.1566 (0.789)
Ep: 79, Reward: 738.7179, Test: 296.5677 [102.96], Avg: 17.3872 (0.786)
Ep: 80, Reward: 752.3001, Test: 313.2846 [64.08], Avg: 20.2491 (0.784)
Ep: 81, Reward: 714.4857, Test: 270.1619 [118.11], Avg: 21.8564 (0.782)
Ep: 82, Reward: 653.7046, Test: 328.2738 [57.30], Avg: 24.8578 (0.779)
Ep: 83, Reward: 822.3329, Test: 292.1383 [81.48], Avg: 27.0698 (0.777)
Ep: 84, Reward: 795.8519, Test: 199.6553 [146.49], Avg: 27.3767 (0.775)
Ep: 85, Reward: 740.5103, Test: 222.1779 [98.66], Avg: 28.4947 (0.772)
Ep: 86, Reward: 778.7685, Test: 313.9795 [55.26], Avg: 31.1410 (0.770)
Ep: 87, Reward: 778.1945, Test: 351.1682 [260.62], Avg: 31.8160 (0.768)
Ep: 88, Reward: 816.6851, Test: 356.5255 [151.71], Avg: 33.7598 (0.765)
Ep: 89, Reward: 748.8931, Test: 335.3147 [151.97], Avg: 35.4218 (0.763)
Ep: 90, Reward: 717.9118, Test: 317.2234 [149.91], Avg: 36.8712 (0.761)
Ep: 91, Reward: 840.3247, Test: 336.2610 [204.52], Avg: 37.9024 (0.758)
Ep: 92, Reward: 868.7686, Test: 340.0369 [195.91], Avg: 39.0447 (0.756)
Ep: 93, Reward: 794.0796, Test: 393.8764 [97.64], Avg: 41.7808 (0.754)
Ep: 94, Reward: 644.6170, Test: 364.9567 [229.71], Avg: 42.7647 (0.752)
Ep: 95, Reward: 795.2275, Test: 332.5847 [116.34], Avg: 44.5718 (0.749)
Ep: 96, Reward: 760.2999, Test: 302.6152 [105.39], Avg: 46.1456 (0.747)
Ep: 97, Reward: 856.3898, Test: 321.3027 [141.59], Avg: 47.5085 (0.745)
Ep: 98, Reward: 812.4376, Test: 329.9021 [104.66], Avg: 49.3038 (0.743)
Ep: 99, Reward: 724.7743, Test: 345.1519 [188.60], Avg: 50.3763 (0.740)
Ep: 100, Reward: 793.1641, Test: 320.3829 [110.15], Avg: 51.9590 (0.738)
Ep: 101, Reward: 766.3466, Test: 377.5170 [128.69], Avg: 53.8891 (0.736)
Ep: 102, Reward: 779.4301, Test: 279.5549 [46.16], Avg: 55.6319 (0.734)
Ep: 103, Reward: 777.9954, Test: 326.0470 [97.30], Avg: 57.2964 (0.732)
Ep: 104, Reward: 746.8269, Test: 377.6502 [192.36], Avg: 58.5154 (0.729)
Ep: 105, Reward: 739.9069, Test: 334.3362 [131.40], Avg: 59.8778 (0.727)
Ep: 106, Reward: 809.3644, Test: 272.5149 [95.39], Avg: 60.9736 (0.725)
Ep: 107, Reward: 749.8593, Test: 232.8853 [129.78], Avg: 61.3637 (0.723)
Ep: 108, Reward: 885.2314, Test: 317.1256 [97.78], Avg: 62.8131 (0.721)
Ep: 109, Reward: 914.6611, Test: 286.7883 [92.44], Avg: 64.0088 (0.719)
Ep: 110, Reward: 835.7548, Test: 346.7894 [98.07], Avg: 65.6729 (0.716)
Ep: 111, Reward: 794.6949, Test: 349.3019 [88.38], Avg: 67.4161 (0.714)
Ep: 112, Reward: 866.2174, Test: 276.5762 [99.27], Avg: 68.3886 (0.712)
Ep: 113, Reward: 865.5954, Test: 336.9746 [162.08], Avg: 69.3229 (0.710)
Ep: 114, Reward: 888.1791, Test: 262.6640 [116.52], Avg: 69.9909 (0.708)
Ep: 115, Reward: 884.1922, Test: 332.1994 [226.66], Avg: 70.2974 (0.706)
Ep: 116, Reward: 744.7427, Test: 309.1934 [156.82], Avg: 70.9988 (0.704)
Ep: 117, Reward: 785.4823, Test: 295.4931 [60.88], Avg: 72.3854 (0.702)
Ep: 118, Reward: 854.6172, Test: 218.4775 [109.50], Avg: 72.6928 (0.699)
Ep: 119, Reward: 786.2706, Test: 218.6960 [105.65], Avg: 73.0291 (0.697)
Ep: 120, Reward: 772.9113, Test: 190.7549 [91.37], Avg: 73.2469 (0.695)
Ep: 121, Reward: 816.6951, Test: 161.3051 [89.48], Avg: 73.2352 (0.693)
Ep: 122, Reward: 774.2102, Test: 216.3218 [111.38], Avg: 73.4930 (0.691)
Ep: 123, Reward: 847.7437, Test: 329.1800 [113.67], Avg: 74.6383 (0.689)
Ep: 124, Reward: 849.8415, Test: 187.4490 [103.26], Avg: 74.7146 (0.687)
Ep: 125, Reward: 915.4566, Test: 233.3068 [112.29], Avg: 75.0821 (0.685)
Ep: 126, Reward: 823.1595, Test: 190.6503 [84.28], Avg: 75.3285 (0.683)
Ep: 127, Reward: 769.3832, Test: 255.4430 [91.82], Avg: 76.0183 (0.681)
Ep: 128, Reward: 770.8775, Test: 227.2029 [91.44], Avg: 76.4814 (0.679)
Ep: 129, Reward: 832.0962, Test: 172.4230 [87.99], Avg: 76.5426 (0.677)
Ep: 130, Reward: 765.4955, Test: 127.7173 [88.33], Avg: 76.2590 (0.675)
Ep: 131, Reward: 821.0071, Test: 215.4511 [71.75], Avg: 76.7699 (0.673)
Ep: 132, Reward: 775.9657, Test: 200.1448 [102.53], Avg: 76.9267 (0.671)
Ep: 133, Reward: 789.1476, Test: 246.7904 [78.29], Avg: 77.6101 (0.669)
Ep: 134, Reward: 833.3439, Test: 223.2952 [96.01], Avg: 77.9781 (0.667)
Ep: 135, Reward: 855.7766, Test: 173.9728 [96.68], Avg: 77.9730 (0.665)
Ep: 136, Reward: 690.2399, Test: 196.9562 [110.28], Avg: 78.0366 (0.663)
Ep: 137, Reward: 551.9810, Test: 68.6146 [101.84], Avg: 77.2303 (0.661)
Ep: 138, Reward: 468.6432, Test: 107.4879 [103.01], Avg: 76.7069 (0.659)
Ep: 139, Reward: 557.4384, Test: 98.1926 [84.56], Avg: 76.2563 (0.657)
Ep: 140, Reward: 592.1069, Test: 184.7427 [98.70], Avg: 76.3257 (0.655)
Ep: 141, Reward: 658.2268, Test: 181.0828 [82.87], Avg: 76.4799 (0.653)
Ep: 142, Reward: 845.3023, Test: 191.2977 [79.64], Avg: 76.7259 (0.651)
Ep: 143, Reward: 784.1581, Test: 158.6815 [100.21], Avg: 76.5991 (0.649)
Ep: 144, Reward: 786.4382, Test: 188.0021 [90.42], Avg: 76.7439 (0.647)
Ep: 145, Reward: 821.0183, Test: 173.2251 [120.95], Avg: 76.5763 (0.645)
Ep: 146, Reward: 726.5999, Test: 154.8261 [104.26], Avg: 76.3993 (0.643)
Ep: 147, Reward: 739.3097, Test: 111.0595 [100.94], Avg: 75.9515 (0.641)
Ep: 148, Reward: 634.9442, Test: 104.2258 [101.54], Avg: 75.4598 (0.639)
Ep: 149, Reward: 460.2235, Test: 50.2448 [82.52], Avg: 74.7415 (0.637)
Ep: 150, Reward: 464.4531, Test: 38.7317 [95.03], Avg: 73.8737 (0.635)
Ep: 151, Reward: 349.3325, Test: 75.2596 [94.54], Avg: 73.2609 (0.633)
Ep: 152, Reward: 365.5154, Test: 140.2559 [101.90], Avg: 73.0327 (0.631)
Ep: 153, Reward: 363.5459, Test: 116.9301 [90.47], Avg: 72.7303 (0.630)
Ep: 154, Reward: 495.3715, Test: 141.9348 [99.22], Avg: 72.5366 (0.628)
Ep: 155, Reward: 441.1914, Test: 127.1342 [95.87], Avg: 72.2720 (0.626)
Ep: 156, Reward: 360.5134, Test: 149.4793 [81.83], Avg: 72.2426 (0.624)
Ep: 157, Reward: 351.3973, Test: 101.8088 [86.56], Avg: 71.8819 (0.622)
Ep: 158, Reward: 356.3129, Test: 81.0488 [94.35], Avg: 71.3462 (0.620)
Ep: 159, Reward: 266.0182, Test: 59.1471 [56.06], Avg: 70.9196 (0.618)
Ep: 160, Reward: 394.1942, Test: 132.1504 [87.35], Avg: 70.7573 (0.616)
Ep: 161, Reward: 363.4167, Test: 123.5798 [76.80], Avg: 70.6093 (0.615)
Ep: 162, Reward: 244.5323, Test: 153.5888 [86.81], Avg: 70.5858 (0.613)
Ep: 163, Reward: 316.9039, Test: 133.3018 [88.43], Avg: 70.4290 (0.611)
Ep: 164, Reward: 350.7105, Test: 175.2252 [98.02], Avg: 70.4700 (0.609)
Ep: 165, Reward: 570.2799, Test: 151.3198 [106.22], Avg: 70.3172 (0.607)
Ep: 166, Reward: 438.1362, Test: 188.8312 [74.01], Avg: 70.5837 (0.605)
Ep: 167, Reward: 372.4550, Test: 152.2318 [82.58], Avg: 70.5782 (0.604)
Ep: 168, Reward: 509.2786, Test: 184.2686 [70.10], Avg: 70.8361 (0.602)
Ep: 169, Reward: 506.8921, Test: 188.1068 [55.23], Avg: 71.2011 (0.600)
Ep: 170, Reward: 432.9677, Test: 195.3442 [49.00], Avg: 71.6405 (0.598)
Ep: 171, Reward: 353.5773, Test: 106.8655 [90.14], Avg: 71.3213 (0.596)
Ep: 172, Reward: 457.4509, Test: 175.2756 [91.72], Avg: 71.3920 (0.595)
Ep: 173, Reward: 366.1889, Test: 190.9247 [85.42], Avg: 71.5880 (0.593)
Ep: 174, Reward: 434.0955, Test: 191.3169 [96.70], Avg: 71.7197 (0.591)
Ep: 175, Reward: 656.0654, Test: 199.9729 [90.05], Avg: 71.9367 (0.589)
Ep: 176, Reward: 785.1632, Test: 255.3962 [103.35], Avg: 72.3893 (0.588)
Ep: 177, Reward: 729.3941, Test: 248.6643 [149.53], Avg: 72.5396 (0.586)
Ep: 178, Reward: 693.8617, Test: 283.8716 [155.40], Avg: 72.8521 (0.584)
Ep: 179, Reward: 813.0733, Test: 286.4718 [82.21], Avg: 73.5822 (0.582)
Ep: 180, Reward: 792.7946, Test: 196.4462 [74.96], Avg: 73.8468 (0.581)
Ep: 181, Reward: 821.3477, Test: 299.1640 [96.04], Avg: 74.5571 (0.579)
Ep: 182, Reward: 836.0481, Test: 231.4784 [77.09], Avg: 74.9934 (0.577)
Ep: 183, Reward: 636.1939, Test: 220.0504 [85.56], Avg: 75.3167 (0.575)
Ep: 184, Reward: 669.0728, Test: 180.3181 [81.55], Avg: 75.4435 (0.574)
Ep: 185, Reward: 706.3944, Test: 270.1478 [56.29], Avg: 76.1877 (0.572)
Ep: 186, Reward: 811.3139, Test: 251.5669 [99.87], Avg: 76.5915 (0.570)
Ep: 187, Reward: 724.0844, Test: 245.9507 [132.16], Avg: 76.7894 (0.568)
Ep: 188, Reward: 704.1535, Test: 254.4723 [104.45], Avg: 77.1768 (0.567)
Ep: 189, Reward: 520.3854, Test: 281.1264 [95.61], Avg: 77.7470 (0.565)
Ep: 190, Reward: 639.1174, Test: 198.2158 [131.02], Avg: 77.6918 (0.563)
Ep: 191, Reward: 728.6259, Test: 350.5409 [163.42], Avg: 78.2617 (0.562)
Ep: 192, Reward: 768.2331, Test: 248.0524 [126.87], Avg: 78.4841 (0.560)
Ep: 193, Reward: 629.8128, Test: 212.6714 [45.90], Avg: 78.9392 (0.558)
Ep: 194, Reward: 701.5250, Test: 331.7933 [202.97], Avg: 79.1950 (0.557)
Ep: 195, Reward: 737.6073, Test: 352.9121 [171.89], Avg: 79.7145 (0.555)
Ep: 196, Reward: 693.8338, Test: 265.4620 [178.36], Avg: 79.7520 (0.553)
Ep: 197, Reward: 704.9123, Test: 268.6856 [73.65], Avg: 80.3343 (0.552)
Ep: 198, Reward: 717.8251, Test: 210.1848 [100.30], Avg: 80.4827 (0.550)
Ep: 199, Reward: 761.5719, Test: 159.4472 [111.80], Avg: 80.3186 (0.548)
Ep: 200, Reward: 739.9987, Test: 238.2218 [87.12], Avg: 80.6707 (0.547)
Ep: 201, Reward: 792.4290, Test: 254.5780 [92.48], Avg: 81.0739 (0.545)
Ep: 202, Reward: 836.7171, Test: 240.8346 [97.81], Avg: 81.3790 (0.543)
Ep: 203, Reward: 833.6287, Test: 390.6419 [197.13], Avg: 81.9287 (0.542)
Ep: 204, Reward: 816.3911, Test: 329.5379 [172.26], Avg: 82.2963 (0.540)
Ep: 205, Reward: 820.4892, Test: 222.0832 [57.35], Avg: 82.6964 (0.539)
Ep: 206, Reward: 808.2098, Test: 270.5167 [48.37], Avg: 83.3701 (0.537)
Ep: 207, Reward: 830.6117, Test: 241.4496 [49.21], Avg: 83.8935 (0.535)
Ep: 208, Reward: 767.6806, Test: 252.1466 [43.95], Avg: 84.4883 (0.534)
Ep: 209, Reward: 850.4161, Test: 290.1442 [160.79], Avg: 84.7019 (0.532)
Ep: 210, Reward: 801.5392, Test: 279.6178 [98.07], Avg: 85.1609 (0.530)
Ep: 211, Reward: 811.6703, Test: 295.5584 [50.81], Avg: 85.9137 (0.529)
Ep: 212, Reward: 837.7954, Test: 211.5335 [72.91], Avg: 86.1611 (0.527)
Ep: 213, Reward: 828.7197, Test: 250.1611 [93.45], Avg: 86.4908 (0.526)
Ep: 214, Reward: 855.3306, Test: 220.8220 [84.94], Avg: 86.7205 (0.524)
Ep: 215, Reward: 728.0993, Test: 200.5468 [86.41], Avg: 86.8474 (0.523)
Ep: 216, Reward: 868.1682, Test: 214.6172 [112.76], Avg: 86.9166 (0.521)
Ep: 217, Reward: 827.0008, Test: 233.0041 [131.36], Avg: 86.9842 (0.519)
Ep: 218, Reward: 855.8039, Test: 273.9351 [42.29], Avg: 87.6447 (0.518)
Ep: 219, Reward: 790.0768, Test: 212.4176 [85.68], Avg: 87.8224 (0.516)
Ep: 220, Reward: 664.9121, Test: 257.1097 [105.32], Avg: 88.1119 (0.515)
Ep: 221, Reward: 720.0143, Test: 276.7179 [84.92], Avg: 88.5789 (0.513)
Ep: 222, Reward: 807.4670, Test: 313.4906 [168.60], Avg: 88.8314 (0.512)
Ep: 223, Reward: 761.1349, Test: 240.4765 [86.83], Avg: 89.1208 (0.510)
Ep: 224, Reward: 806.0077, Test: 348.6766 [248.93], Avg: 89.1680 (0.509)
Ep: 225, Reward: 721.0062, Test: 321.3876 [151.51], Avg: 89.5251 (0.507)
Ep: 226, Reward: 701.2090, Test: 283.4267 [50.76], Avg: 90.1557 (0.506)
Ep: 227, Reward: 858.1784, Test: 273.8839 [118.27], Avg: 90.4428 (0.504)
Ep: 228, Reward: 893.2355, Test: 341.8724 [149.15], Avg: 90.8895 (0.503)
Ep: 229, Reward: 751.5565, Test: 341.7917 [123.97], Avg: 91.4413 (0.501)
Ep: 230, Reward: 771.8542, Test: 349.2934 [174.22], Avg: 91.8034 (0.500)
Ep: 231, Reward: 725.9785, Test: 274.4959 [154.92], Avg: 91.9231 (0.498)
Ep: 232, Reward: 630.2267, Test: 239.2551 [53.99], Avg: 92.3237 (0.497)
Ep: 233, Reward: 626.8221, Test: 282.7061 [208.70], Avg: 92.2454 (0.495)
Ep: 234, Reward: 635.3792, Test: 250.1981 [60.68], Avg: 92.6594 (0.494)
Ep: 235, Reward: 427.4662, Test: 161.8092 [55.77], Avg: 92.7160 (0.492)
Ep: 236, Reward: 427.1359, Test: 191.9177 [70.06], Avg: 92.8390 (0.491)
Ep: 237, Reward: 498.8572, Test: 236.9464 [45.71], Avg: 93.2524 (0.489)
Ep: 238, Reward: 578.4444, Test: 177.6426 [61.25], Avg: 93.3492 (0.488)
Ep: 239, Reward: 553.2484, Test: 119.2759 [93.57], Avg: 93.0674 (0.486)
Ep: 240, Reward: 525.9644, Test: 252.5456 [186.96], Avg: 92.9534 (0.485)
Ep: 241, Reward: 621.0159, Test: 289.8133 [153.60], Avg: 93.1321 (0.483)
Ep: 242, Reward: 621.3744, Test: 284.0313 [259.06], Avg: 92.8516 (0.482)
Ep: 243, Reward: 689.6746, Test: 349.2770 [234.38], Avg: 92.9419 (0.480)
Ep: 244, Reward: 811.7731, Test: 346.4572 [193.32], Avg: 93.1876 (0.479)
Ep: 245, Reward: 683.4900, Test: 358.3360 [208.81], Avg: 93.4167 (0.478)
Ep: 246, Reward: 701.0065, Test: 270.3549 [130.76], Avg: 93.6036 (0.476)
Ep: 247, Reward: 813.2175, Test: 266.2393 [118.01], Avg: 93.8239 (0.475)
Ep: 248, Reward: 681.4864, Test: 404.8840 [190.17], Avg: 94.3093 (0.473)
Ep: 249, Reward: 702.2102, Test: 279.0145 [84.68], Avg: 94.7095 (0.472)
Ep: 250, Reward: 688.6925, Test: 302.1540 [176.13], Avg: 94.8342 (0.470)
Ep: 251, Reward: 641.7910, Test: 277.7868 [151.35], Avg: 94.9596 (0.469)
Ep: 252, Reward: 594.6127, Test: 253.3757 [78.52], Avg: 95.2754 (0.468)
Ep: 253, Reward: 650.8599, Test: 326.7143 [144.34], Avg: 95.6183 (0.466)
Ep: 254, Reward: 633.7417, Test: 238.2375 [102.58], Avg: 95.7753 (0.465)
Ep: 255, Reward: 609.3575, Test: 304.4181 [93.51], Avg: 96.2251 (0.463)
Ep: 256, Reward: 657.3675, Test: 314.8760 [185.79], Avg: 96.3529 (0.462)
Ep: 257, Reward: 592.1670, Test: 262.8150 [46.73], Avg: 96.8170 (0.461)
Ep: 258, Reward: 611.5676, Test: 253.7444 [114.26], Avg: 96.9818 (0.459)
Ep: 259, Reward: 744.6913, Test: 202.0822 [75.31], Avg: 97.0963 (0.458)
Ep: 260, Reward: 655.2819, Test: 301.5280 [180.89], Avg: 97.1865 (0.456)
Ep: 261, Reward: 637.9626, Test: 255.2267 [66.88], Avg: 97.5345 (0.455)
Ep: 262, Reward: 734.9601, Test: 341.6034 [186.41], Avg: 97.7537 (0.454)
Ep: 263, Reward: 701.3394, Test: 379.9638 [210.37], Avg: 98.0258 (0.452)
Ep: 264, Reward: 791.6032, Test: 375.5437 [164.89], Avg: 98.4509 (0.451)
Ep: 265, Reward: 804.4772, Test: 312.6317 [163.53], Avg: 98.6413 (0.450)
Ep: 266, Reward: 713.1244, Test: 261.0836 [51.17], Avg: 99.0581 (0.448)
Ep: 267, Reward: 682.4525, Test: 305.1056 [172.50], Avg: 99.1832 (0.447)
Ep: 268, Reward: 669.3443, Test: 210.0010 [63.37], Avg: 99.3596 (0.446)
Ep: 269, Reward: 628.1727, Test: 321.0511 [182.46], Avg: 99.5049 (0.444)
Ep: 270, Reward: 687.0124, Test: 411.6358 [214.38], Avg: 99.8656 (0.443)
Ep: 271, Reward: 729.9807, Test: 311.8841 [154.27], Avg: 100.0780 (0.442)
Ep: 272, Reward: 809.5783, Test: 304.3690 [101.16], Avg: 100.4558 (0.440)
Ep: 273, Reward: 735.8761, Test: 314.1555 [191.46], Avg: 100.5369 (0.439)
Ep: 274, Reward: 681.7783, Test: 231.4803 [54.94], Avg: 100.8133 (0.438)
Ep: 275, Reward: 636.4157, Test: 260.0574 [63.17], Avg: 101.1614 (0.436)
Ep: 276, Reward: 634.5282, Test: 259.6470 [55.60], Avg: 101.5328 (0.435)
Ep: 277, Reward: 658.2533, Test: 368.2780 [147.41], Avg: 101.9621 (0.434)
Ep: 278, Reward: 582.1939, Test: 255.1833 [75.50], Avg: 102.2406 (0.432)
Ep: 279, Reward: 600.0711, Test: 221.0014 [58.55], Avg: 102.4557 (0.431)
Ep: 280, Reward: 597.9191, Test: 304.9326 [150.72], Avg: 102.6398 (0.430)
Ep: 281, Reward: 689.6233, Test: 279.0894 [91.31], Avg: 102.9418 (0.429)
Ep: 282, Reward: 700.4365, Test: 264.8810 [109.17], Avg: 103.1282 (0.427)
Ep: 283, Reward: 748.0672, Test: 348.4328 [180.47], Avg: 103.3565 (0.426)
Ep: 284, Reward: 707.7376, Test: 453.3572 [198.47], Avg: 103.8882 (0.425)
Ep: 285, Reward: 591.9639, Test: 324.6718 [148.33], Avg: 104.1415 (0.423)
Ep: 286, Reward: 791.8076, Test: 355.7831 [103.45], Avg: 104.6579 (0.422)
Ep: 287, Reward: 671.5617, Test: 318.4180 [102.11], Avg: 105.0455 (0.421)
Ep: 288, Reward: 798.4783, Test: 303.8786 [132.46], Avg: 105.2752 (0.420)
Ep: 289, Reward: 761.7347, Test: 278.5474 [91.56], Avg: 105.5570 (0.418)
Ep: 290, Reward: 840.7218, Test: 275.3419 [102.10], Avg: 105.7896 (0.417)
Ep: 291, Reward: 720.8188, Test: 250.1700 [82.05], Avg: 106.0030 (0.416)
Ep: 292, Reward: 780.4334, Test: 317.6796 [118.32], Avg: 106.3216 (0.415)
Ep: 293, Reward: 733.9912, Test: 281.1533 [150.26], Avg: 106.4052 (0.413)
Ep: 294, Reward: 649.8488, Test: 353.6085 [162.68], Avg: 106.6917 (0.412)
Ep: 295, Reward: 689.0302, Test: 308.4958 [137.02], Avg: 106.9106 (0.411)
Ep: 296, Reward: 724.4407, Test: 427.7975 [208.41], Avg: 107.2893 (0.410)
Ep: 297, Reward: 690.8293, Test: 344.1644 [183.18], Avg: 107.4695 (0.408)
Ep: 298, Reward: 763.5009, Test: 347.0536 [122.74], Avg: 107.8603 (0.407)
Ep: 299, Reward: 674.6269, Test: 372.7091 [197.89], Avg: 108.0835 (0.406)
Ep: 300, Reward: 743.0916, Test: 268.1355 [88.88], Avg: 108.3199 (0.405)
Ep: 301, Reward: 716.6079, Test: 313.8816 [142.33], Avg: 108.5293 (0.404)
Ep: 302, Reward: 571.5361, Test: 304.7042 [74.45], Avg: 108.9310 (0.402)
Ep: 303, Reward: 686.9426, Test: 407.9133 [254.98], Avg: 109.0758 (0.401)
Ep: 304, Reward: 710.0618, Test: 389.1911 [221.90], Avg: 109.2666 (0.400)
Ep: 305, Reward: 693.9501, Test: 340.2028 [162.37], Avg: 109.4907 (0.399)
Ep: 306, Reward: 755.0754, Test: 287.5396 [85.06], Avg: 109.7936 (0.398)
Ep: 307, Reward: 787.7805, Test: 453.8784 [226.15], Avg: 110.1765 (0.396)
Ep: 308, Reward: 694.0430, Test: 455.1897 [225.64], Avg: 110.5629 (0.395)
Ep: 309, Reward: 820.0135, Test: 376.2437 [165.10], Avg: 110.8873 (0.394)
Ep: 310, Reward: 688.6565, Test: 357.5774 [231.18], Avg: 110.9372 (0.393)
Ep: 311, Reward: 770.2803, Test: 264.9885 [55.94], Avg: 111.2516 (0.392)
Ep: 312, Reward: 782.1885, Test: 302.2619 [96.85], Avg: 111.5524 (0.390)
Ep: 313, Reward: 657.0777, Test: 263.4230 [95.41], Avg: 111.7323 (0.389)
Ep: 314, Reward: 593.3966, Test: 266.0499 [68.88], Avg: 112.0035 (0.388)
Ep: 315, Reward: 752.6904, Test: 288.0017 [166.62], Avg: 112.0332 (0.387)
Ep: 316, Reward: 693.9784, Test: 279.9040 [157.91], Avg: 112.0646 (0.386)
Ep: 317, Reward: 539.2225, Test: 343.2329 [158.14], Avg: 112.2943 (0.385)
Ep: 318, Reward: 594.2772, Test: 285.0250 [117.37], Avg: 112.4678 (0.383)
Ep: 319, Reward: 634.1930, Test: 282.7602 [82.01], Avg: 112.7437 (0.382)
Ep: 320, Reward: 649.6164, Test: 227.0670 [64.46], Avg: 112.8990 (0.381)
Ep: 321, Reward: 585.3451, Test: 248.3189 [37.72], Avg: 113.2025 (0.380)
Ep: 322, Reward: 551.7426, Test: 220.9336 [61.06], Avg: 113.3469 (0.379)
Ep: 323, Reward: 621.6922, Test: 244.2409 [73.15], Avg: 113.5252 (0.378)
Ep: 324, Reward: 509.9988, Test: 201.1319 [32.79], Avg: 113.6938 (0.377)
Ep: 325, Reward: 477.8810, Test: 291.6002 [132.59], Avg: 113.8328 (0.376)
Ep: 326, Reward: 543.6775, Test: 238.7784 [66.76], Avg: 114.0108 (0.374)
Ep: 327, Reward: 579.9943, Test: 264.8687 [70.08], Avg: 114.2571 (0.373)
Ep: 328, Reward: 591.9176, Test: 319.5802 [186.89], Avg: 114.3131 (0.372)
Ep: 329, Reward: 553.2948, Test: 205.0653 [45.41], Avg: 114.4505 (0.371)
Ep: 330, Reward: 545.2463, Test: 247.3248 [45.41], Avg: 114.7147 (0.370)
Ep: 331, Reward: 591.8692, Test: 232.2321 [84.40], Avg: 114.8145 (0.369)
Ep: 332, Reward: 711.7197, Test: 286.4170 [123.50], Avg: 114.9590 (0.368)
Ep: 333, Reward: 745.0933, Test: 368.3423 [201.65], Avg: 115.1139 (0.367)
Ep: 334, Reward: 645.3264, Test: 278.1608 [106.91], Avg: 115.2814 (0.365)
Ep: 335, Reward: 598.6707, Test: 316.3982 [169.23], Avg: 115.3763 (0.364)
Ep: 336, Reward: 586.4869, Test: 280.8027 [152.42], Avg: 115.4149 (0.363)
Ep: 337, Reward: 514.8024, Test: 280.6444 [167.11], Avg: 115.4094 (0.362)
Ep: 338, Reward: 464.4885, Test: 292.4598 [183.47], Avg: 115.3904 (0.361)
Ep: 339, Reward: 578.2054, Test: 357.4008 [181.04], Avg: 115.5698 (0.360)
Ep: 340, Reward: 623.3424, Test: 248.8930 [57.17], Avg: 115.7931 (0.359)
Ep: 341, Reward: 665.1333, Test: 375.7214 [185.74], Avg: 116.0100 (0.358)
Ep: 342, Reward: 630.8056, Test: 455.4538 [219.13], Avg: 116.3608 (0.357)
Ep: 343, Reward: 764.7322, Test: 452.1753 [167.87], Avg: 116.8490 (0.356)
Ep: 344, Reward: 650.4973, Test: 364.5026 [157.63], Avg: 117.1099 (0.355)
Ep: 345, Reward: 616.3680, Test: 344.7953 [191.08], Avg: 117.2157 (0.354)
Ep: 346, Reward: 663.5479, Test: 293.2405 [176.47], Avg: 117.2144 (0.353)
Ep: 347, Reward: 708.1649, Test: 260.1467 [92.87], Avg: 117.3583 (0.351)
Ep: 348, Reward: 760.4973, Test: 364.0765 [203.23], Avg: 117.4829 (0.350)
Ep: 349, Reward: 671.9098, Test: 392.9602 [226.95], Avg: 117.6215 (0.349)
Ep: 350, Reward: 645.0467, Test: 373.1778 [234.06], Avg: 117.6828 (0.348)
Ep: 351, Reward: 575.4170, Test: 327.8373 [178.70], Avg: 117.7722 (0.347)
Ep: 352, Reward: 716.1331, Test: 374.0438 [214.92], Avg: 117.8893 (0.346)
Ep: 353, Reward: 725.6906, Test: 373.9639 [191.07], Avg: 118.0730 (0.345)
Ep: 354, Reward: 726.5309, Test: 390.9920 [226.00], Avg: 118.2051 (0.344)
Ep: 355, Reward: 742.5424, Test: 532.0453 [266.93], Avg: 118.6178 (0.343)
Ep: 356, Reward: 737.3501, Test: 599.9645 [252.21], Avg: 119.2597 (0.342)
Ep: 357, Reward: 839.6723, Test: 608.6829 [195.78], Avg: 120.0799 (0.341)
Ep: 358, Reward: 774.8030, Test: 504.5397 [176.01], Avg: 120.6605 (0.340)
Ep: 359, Reward: 763.1563, Test: 498.4314 [220.47], Avg: 121.0975 (0.339)
Ep: 360, Reward: 811.4705, Test: 472.1994 [210.07], Avg: 121.4881 (0.338)
Ep: 361, Reward: 791.2866, Test: 545.6715 [282.79], Avg: 121.8787 (0.337)
Ep: 362, Reward: 883.5951, Test: 535.4178 [252.71], Avg: 122.3218 (0.336)
Ep: 363, Reward: 826.4267, Test: 791.2013 [148.41], Avg: 123.7516 (0.335)
Ep: 364, Reward: 939.8694, Test: 564.8069 [191.71], Avg: 124.4348 (0.334)
Ep: 365, Reward: 765.4802, Test: 634.0479 [267.81], Avg: 125.0954 (0.333)
Ep: 366, Reward: 764.6589, Test: 584.7440 [183.23], Avg: 125.8486 (0.332)
Ep: 367, Reward: 815.8816, Test: 678.2702 [167.36], Avg: 126.8950 (0.331)
Ep: 368, Reward: 830.4802, Test: 733.0629 [231.06], Avg: 127.9115 (0.330)
Ep: 369, Reward: 839.4963, Test: 619.6076 [273.26], Avg: 128.5019 (0.329)
Ep: 370, Reward: 840.1867, Test: 674.2382 [204.80], Avg: 129.4209 (0.328)
Ep: 371, Reward: 783.4296, Test: 748.6466 [108.46], Avg: 130.7939 (0.327)
Ep: 372, Reward: 791.1766, Test: 443.3012 [216.81], Avg: 131.0504 (0.326)
Ep: 373, Reward: 755.1314, Test: 384.5613 [172.46], Avg: 131.2671 (0.325)
Ep: 374, Reward: 640.3517, Test: 425.9900 [188.88], Avg: 131.5494 (0.324)
Ep: 375, Reward: 758.1119, Test: 499.0514 [236.25], Avg: 131.8985 (0.323)
Ep: 376, Reward: 819.8975, Test: 650.4725 [120.83], Avg: 132.9535 (0.322)
Ep: 377, Reward: 846.9146, Test: 533.0748 [203.64], Avg: 133.4733 (0.321)
Ep: 378, Reward: 761.6018, Test: 571.6487 [208.18], Avg: 134.0801 (0.320)
Ep: 379, Reward: 803.7081, Test: 491.2072 [217.23], Avg: 134.4482 (0.319)
Ep: 380, Reward: 739.5157, Test: 400.4300 [209.04], Avg: 134.5977 (0.318)
Ep: 381, Reward: 801.2075, Test: 613.2860 [226.76], Avg: 135.2572 (0.317)
Ep: 382, Reward: 679.2296, Test: 547.2255 [197.40], Avg: 135.8174 (0.316)
Ep: 383, Reward: 808.6467, Test: 507.5814 [235.41], Avg: 136.1725 (0.315)
Ep: 384, Reward: 821.9748, Test: 715.1296 [187.50], Avg: 137.1893 (0.315)
Ep: 385, Reward: 834.1550, Test: 639.5050 [196.83], Avg: 137.9807 (0.314)
Ep: 386, Reward: 787.7523, Test: 640.0618 [252.19], Avg: 138.6264 (0.313)
Ep: 387, Reward: 816.6666, Test: 682.0083 [217.83], Avg: 139.4655 (0.312)
Ep: 388, Reward: 685.2260, Test: 652.0918 [263.33], Avg: 140.1063 (0.311)
Ep: 389, Reward: 829.9731, Test: 642.6599 [245.92], Avg: 140.7644 (0.310)
Ep: 390, Reward: 912.7981, Test: 662.3907 [276.57], Avg: 141.3911 (0.309)
Ep: 391, Reward: 746.8085, Test: 651.4770 [234.74], Avg: 142.0935 (0.308)
Ep: 392, Reward: 777.6486, Test: 763.9561 [65.13], Avg: 143.5101 (0.307)
Ep: 393, Reward: 859.9567, Test: 738.2152 [185.65], Avg: 144.5483 (0.306)
Ep: 394, Reward: 747.0393, Test: 615.9660 [226.06], Avg: 145.1695 (0.305)
Ep: 395, Reward: 830.0187, Test: 664.1082 [197.45], Avg: 145.9813 (0.304)
Ep: 396, Reward: 809.5423, Test: 677.6984 [174.23], Avg: 146.8818 (0.303)
Ep: 397, Reward: 822.5742, Test: 545.0041 [213.76], Avg: 147.3450 (0.302)
Ep: 398, Reward: 748.6423, Test: 570.4542 [244.36], Avg: 147.7930 (0.302)
Ep: 399, Reward: 751.4740, Test: 584.6048 [234.19], Avg: 148.2996 (0.301)
Ep: 400, Reward: 814.9770, Test: 563.2677 [236.66], Avg: 148.7442 (0.300)
Ep: 401, Reward: 692.1415, Test: 399.3301 [189.04], Avg: 148.8973 (0.299)
Ep: 402, Reward: 610.7617, Test: 473.8122 [236.20], Avg: 149.1175 (0.298)
Ep: 403, Reward: 755.2256, Test: 354.6382 [214.94], Avg: 149.0942 (0.297)
Ep: 404, Reward: 852.6843, Test: 426.2337 [260.46], Avg: 149.1353 (0.296)
Ep: 405, Reward: 682.5124, Test: 562.8129 [294.76], Avg: 149.4282 (0.295)
Ep: 406, Reward: 829.7898, Test: 534.4450 [243.72], Avg: 149.7754 (0.294)
Ep: 407, Reward: 762.0015, Test: 456.2279 [265.64], Avg: 149.8755 (0.294)
Ep: 408, Reward: 783.6524, Test: 323.9617 [194.13], Avg: 149.8264 (0.293)
Ep: 409, Reward: 725.1010, Test: 466.6278 [267.56], Avg: 149.9465 (0.292)
Ep: 410, Reward: 758.1211, Test: 555.5391 [221.89], Avg: 150.3935 (0.291)
Ep: 411, Reward: 837.7810, Test: 504.9304 [243.34], Avg: 150.6634 (0.290)
Ep: 412, Reward: 827.3984, Test: 627.9412 [216.59], Avg: 151.2946 (0.289)
Ep: 413, Reward: 802.0980, Test: 567.0015 [242.24], Avg: 151.7136 (0.288)
Ep: 414, Reward: 784.0725, Test: 357.6111 [167.00], Avg: 151.8073 (0.287)
Ep: 415, Reward: 822.7971, Test: 482.0265 [237.04], Avg: 152.0313 (0.287)
Ep: 416, Reward: 783.4526, Test: 567.9207 [284.24], Avg: 152.3470 (0.286)
Ep: 417, Reward: 690.9516, Test: 342.9000 [211.35], Avg: 152.2973 (0.285)
Ep: 418, Reward: 796.8278, Test: 355.1972 [235.80], Avg: 152.2188 (0.284)
Ep: 419, Reward: 777.4068, Test: 343.5961 [217.80], Avg: 152.1559 (0.283)
Ep: 420, Reward: 752.4503, Test: 451.0040 [288.18], Avg: 152.1812 (0.282)
Ep: 421, Reward: 809.9032, Test: 526.7374 [318.48], Avg: 152.3141 (0.281)
Ep: 422, Reward: 742.1109, Test: 587.5626 [302.97], Avg: 152.6268 (0.281)
Ep: 423, Reward: 882.2624, Test: 445.2631 [213.19], Avg: 152.8142 (0.280)
Ep: 424, Reward: 823.7743, Test: 388.4480 [238.45], Avg: 152.8076 (0.279)
Ep: 425, Reward: 854.4628, Test: 640.0019 [240.04], Avg: 153.3877 (0.278)
Ep: 426, Reward: 797.9697, Test: 480.9234 [256.45], Avg: 153.5542 (0.277)
Ep: 427, Reward: 790.6435, Test: 523.8470 [263.63], Avg: 153.8034 (0.276)
Ep: 428, Reward: 784.3105, Test: 504.0736 [219.90], Avg: 154.1073 (0.276)
Ep: 429, Reward: 787.0418, Test: 441.6144 [193.81], Avg: 154.3252 (0.275)
Ep: 430, Reward: 776.9696, Test: 634.4819 [314.69], Avg: 154.7091 (0.274)
Ep: 431, Reward: 753.8806, Test: 475.1632 [206.77], Avg: 154.9723 (0.273)
Ep: 432, Reward: 718.3896, Test: 606.8592 [267.15], Avg: 155.3989 (0.272)
Ep: 433, Reward: 771.1042, Test: 441.7237 [225.65], Avg: 155.5387 (0.271)
Ep: 434, Reward: 869.7274, Test: 624.0203 [229.01], Avg: 156.0892 (0.271)
Ep: 435, Reward: 850.9010, Test: 665.7151 [186.75], Avg: 156.8298 (0.270)
Ep: 436, Reward: 781.8878, Test: 702.6671 [180.03], Avg: 157.6668 (0.269)
Ep: 437, Reward: 784.9048, Test: 665.9978 [228.53], Avg: 158.3057 (0.268)
Ep: 438, Reward: 822.5807, Test: 690.6783 [247.14], Avg: 158.9554 (0.267)
Ep: 439, Reward: 885.6043, Test: 720.5633 [220.12], Avg: 159.7315 (0.267)
Ep: 440, Reward: 750.0636, Test: 763.1364 [76.39], Avg: 160.9265 (0.266)
Ep: 441, Reward: 759.0001, Test: 685.7717 [217.22], Avg: 161.6225 (0.265)
Ep: 442, Reward: 807.7806, Test: 697.3202 [240.08], Avg: 162.2898 (0.264)
Ep: 443, Reward: 850.8841, Test: 494.9844 [277.03], Avg: 162.4152 (0.263)
Ep: 444, Reward: 861.8132, Test: 535.4450 [256.43], Avg: 162.6772 (0.263)
Ep: 445, Reward: 842.2494, Test: 789.7780 [174.93], Avg: 163.6911 (0.262)
Ep: 446, Reward: 848.3654, Test: 633.9757 [257.31], Avg: 164.1675 (0.261)
Ep: 447, Reward: 805.1268, Test: 726.2248 [201.24], Avg: 164.9729 (0.260)
Ep: 448, Reward: 856.8334, Test: 665.2596 [231.33], Avg: 165.5719 (0.259)
Ep: 449, Reward: 804.4192, Test: 742.0908 [209.69], Avg: 166.3871 (0.259)
Ep: 450, Reward: 793.9972, Test: 612.1356 [231.15], Avg: 166.8629 (0.258)
Ep: 451, Reward: 857.7489, Test: 621.8081 [265.47], Avg: 167.2821 (0.257)
Ep: 452, Reward: 860.2202, Test: 672.1025 [227.31], Avg: 167.8947 (0.256)
Ep: 453, Reward: 850.3615, Test: 585.7511 [224.92], Avg: 168.3197 (0.256)
Ep: 454, Reward: 791.5930, Test: 556.0143 [199.74], Avg: 168.7328 (0.255)
Ep: 455, Reward: 827.6686, Test: 500.5208 [214.15], Avg: 168.9908 (0.254)
Ep: 456, Reward: 859.3205, Test: 542.1856 [217.49], Avg: 169.3315 (0.253)
Ep: 457, Reward: 812.1614, Test: 543.2371 [261.37], Avg: 169.5772 (0.253)
Ep: 458, Reward: 779.2839, Test: 487.2730 [247.00], Avg: 169.7312 (0.252)
Ep: 459, Reward: 835.3085, Test: 512.5837 [250.99], Avg: 169.9309 (0.251)
Ep: 460, Reward: 833.8635, Test: 324.0424 [146.94], Avg: 169.9465 (0.250)
Ep: 461, Reward: 806.0280, Test: 511.0211 [253.56], Avg: 170.1359 (0.250)
Ep: 462, Reward: 749.9538, Test: 546.2985 [267.35], Avg: 170.3709 (0.249)
Ep: 463, Reward: 802.3533, Test: 771.4429 [199.39], Avg: 171.2366 (0.248)
Ep: 464, Reward: 826.9053, Test: 660.1606 [216.03], Avg: 171.8235 (0.247)
Ep: 465, Reward: 836.8135, Test: 626.4794 [227.80], Avg: 172.3103 (0.247)
Ep: 466, Reward: 836.1702, Test: 765.8736 [72.74], Avg: 173.4255 (0.246)
Ep: 467, Reward: 850.3263, Test: 450.1671 [220.57], Avg: 173.5456 (0.245)
Ep: 468, Reward: 825.0894, Test: 662.2154 [166.07], Avg: 174.2334 (0.244)
Ep: 469, Reward: 847.5808, Test: 610.0519 [243.38], Avg: 174.6428 (0.244)
Ep: 470, Reward: 862.8093, Test: 619.8231 [219.37], Avg: 175.1223 (0.243)
Ep: 471, Reward: 827.0528, Test: 640.6663 [236.88], Avg: 175.6067 (0.242)
Ep: 472, Reward: 818.5922, Test: 359.3713 [177.11], Avg: 175.6208 (0.241)
Ep: 473, Reward: 764.4223, Test: 587.1885 [230.23], Avg: 176.0034 (0.241)
Ep: 474, Reward: 830.7075, Test: 336.4930 [224.49], Avg: 175.8686 (0.240)
Ep: 475, Reward: 817.7979, Test: 397.7810 [185.69], Avg: 175.9447 (0.239)
Ep: 476, Reward: 841.1352, Test: 540.7226 [243.53], Avg: 176.1989 (0.239)
Ep: 477, Reward: 778.5334, Test: 608.5634 [200.94], Avg: 176.6830 (0.238)
Ep: 478, Reward: 842.2789, Test: 426.1871 [204.30], Avg: 176.7774 (0.237)
Ep: 479, Reward: 817.9166, Test: 632.6803 [228.10], Avg: 177.2520 (0.236)
Ep: 480, Reward: 817.0504, Test: 465.6425 [274.76], Avg: 177.2803 (0.236)
Ep: 481, Reward: 796.6333, Test: 440.2096 [204.47], Avg: 177.4016 (0.235)
Ep: 482, Reward: 821.5729, Test: 538.5981 [153.22], Avg: 177.8322 (0.234)
Ep: 483, Reward: 829.8765, Test: 526.7888 [191.09], Avg: 178.1584 (0.234)
Ep: 484, Reward: 811.5320, Test: 448.1336 [236.03], Avg: 178.2284 (0.233)
Ep: 485, Reward: 760.4921, Test: 380.4512 [195.99], Avg: 178.2412 (0.232)
Ep: 486, Reward: 814.3225, Test: 444.8821 [217.31], Avg: 178.3425 (0.231)
Ep: 487, Reward: 783.9651, Test: 529.2604 [221.86], Avg: 178.6069 (0.231)
Ep: 488, Reward: 823.7506, Test: 529.6418 [245.85], Avg: 178.8220 (0.230)
Ep: 489, Reward: 780.6314, Test: 534.7387 [247.82], Avg: 179.0426 (0.229)
Ep: 490, Reward: 772.6506, Test: 541.6363 [161.07], Avg: 179.4531 (0.229)
Ep: 491, Reward: 740.9810, Test: 446.4067 [203.30], Avg: 179.5825 (0.228)
Ep: 492, Reward: 774.0158, Test: 542.9931 [190.83], Avg: 179.9325 (0.227)
Ep: 493, Reward: 703.8780, Test: 463.3326 [190.51], Avg: 180.1206 (0.227)
Ep: 494, Reward: 744.1498, Test: 433.0268 [203.47], Avg: 180.2204 (0.226)
Ep: 495, Reward: 714.4166, Test: 429.3277 [234.70], Avg: 180.2495 (0.225)
Ep: 496, Reward: 768.9558, Test: 442.7415 [230.39], Avg: 180.3141 (0.225)
Ep: 497, Reward: 757.0764, Test: 432.7136 [250.15], Avg: 180.3186 (0.224)
Ep: 498, Reward: 769.6796, Test: 338.0330 [188.54], Avg: 180.2568 (0.223)
Ep: 499, Reward: 721.8375, Test: 458.2509 [201.04], Avg: 180.4107 (0.223)
