Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.100                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.02				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(PPO_EPOCHS):
				for i in range(0, len(self.replay_buffer), BATCH_SIZE):
					state, action, log_prob, target, advantage = self.replay_buffer.index(BATCH_SIZE, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -33.4730, Test: -22.3110 [8.32], Avg: -30.6303 (0.997)
Ep: 1, Reward: -23.6005, Test: -32.1701 [12.93], Avg: -37.8671 (0.994)
Ep: 2, Reward: -31.2419, Test: -24.9198 [8.65], Avg: -36.4352 (0.991)
Ep: 3, Reward: -23.3838, Test: -6.1198 [14.98], Avg: -32.6003 (0.988)
Ep: 4, Reward: -13.1017, Test: -21.3183 [27.04], Avg: -35.7517 (0.985)
Ep: 5, Reward: -8.1980, Test: -7.4787 [33.52], Avg: -36.6264 (0.982)
Ep: 6, Reward: -36.6759, Test: -1.6942 [53.33], Avg: -39.2542 (0.979)
Ep: 7, Reward: -8.4004, Test: 28.5411 [36.46], Avg: -35.3374 (0.976)
Ep: 8, Reward: 10.1953, Test: 73.7753 [93.01], Avg: -33.5485 (0.973)
Ep: 9, Reward: 27.9487, Test: 125.5856 [87.02], Avg: -26.3367 (0.970)
Ep: 10, Reward: 74.3913, Test: 218.2456 [163.88], Avg: -18.9999 (0.967)
Ep: 11, Reward: 185.0504, Test: 214.7425 [184.98], Avg: -14.9364 (0.965)
Ep: 12, Reward: 381.5505, Test: 233.9081 [154.42], Avg: -7.6728 (0.962)
Ep: 13, Reward: 248.0327, Test: 203.5894 [153.14], Avg: -3.5211 (0.959)
Ep: 14, Reward: 289.0112, Test: 280.1164 [204.79], Avg: 1.7357 (0.956)
Ep: 15, Reward: 332.2190, Test: 331.9707 [128.31], Avg: 14.3560 (0.953)
Ep: 16, Reward: 216.8534, Test: 345.4870 [134.70], Avg: 25.9107 (0.950)
Ep: 17, Reward: 338.3230, Test: 419.0855 [199.22], Avg: 36.6860 (0.947)
Ep: 18, Reward: 319.7623, Test: 283.6178 [113.98], Avg: 43.6834 (0.945)
Ep: 19, Reward: 346.7019, Test: 333.6557 [124.84], Avg: 51.9403 (0.942)
Ep: 20, Reward: 304.9904, Test: 446.2926 [159.56], Avg: 63.1208 (0.939)
Ep: 21, Reward: 465.3737, Test: 651.1326 [232.22], Avg: 79.2931 (0.936)
Ep: 22, Reward: 435.1570, Test: 686.0883 [220.21], Avg: 96.1010 (0.933)
Ep: 23, Reward: 653.7985, Test: 710.1796 [184.44], Avg: 114.0026 (0.930)
Ep: 24, Reward: 627.2549, Test: 786.7608 [134.77], Avg: 135.5222 (0.928)
Ep: 25, Reward: 718.7590, Test: 733.6364 [238.92], Avg: 149.3372 (0.925)
Ep: 26, Reward: 816.2144, Test: 724.7461 [163.61], Avg: 164.5890 (0.922)
Ep: 27, Reward: 756.2375, Test: 748.7163 [194.16], Avg: 178.5163 (0.919)
Ep: 28, Reward: 725.9171, Test: 608.2187 [229.93], Avg: 185.4049 (0.917)
Ep: 29, Reward: 845.0855, Test: 772.0031 [178.14], Avg: 199.0200 (0.914)
Ep: 30, Reward: 811.3495, Test: 805.1343 [133.99], Avg: 214.2497 (0.911)
Ep: 31, Reward: 829.7564, Test: 762.3967 [192.79], Avg: 225.3548 (0.908)
Ep: 32, Reward: 809.5831, Test: 778.3307 [157.13], Avg: 237.3502 (0.906)
Ep: 33, Reward: 632.4954, Test: 613.0452 [219.99], Avg: 241.9297 (0.903)
Ep: 34, Reward: 598.5630, Test: 495.9735 [186.56], Avg: 243.8578 (0.900)
Ep: 35, Reward: 484.0893, Test: 431.7474 [163.76], Avg: 244.5282 (0.897)
Ep: 36, Reward: 619.1851, Test: 626.6390 [212.55], Avg: 249.1110 (0.895)
Ep: 37, Reward: 580.3671, Test: 676.4105 [177.19], Avg: 255.6929 (0.892)
Ep: 38, Reward: 664.5482, Test: 800.9310 [110.54], Avg: 266.8389 (0.889)
Ep: 39, Reward: 696.1390, Test: 697.5952 [212.68], Avg: 272.2910 (0.887)
Ep: 40, Reward: 721.6400, Test: 705.8229 [237.47], Avg: 277.0729 (0.884)
Ep: 41, Reward: 786.0913, Test: 796.9139 [175.84], Avg: 285.2635 (0.881)
Ep: 42, Reward: 719.2396, Test: 658.3265 [164.55], Avg: 290.1125 (0.879)
Ep: 43, Reward: 742.7043, Test: 622.2812 [154.33], Avg: 294.1542 (0.876)
Ep: 44, Reward: 622.5611, Test: 544.1524 [299.87], Avg: 293.0459 (0.874)
Ep: 45, Reward: 801.6594, Test: 596.3774 [212.92], Avg: 295.0113 (0.871)
Ep: 46, Reward: 757.6756, Test: 637.6946 [260.22], Avg: 296.7658 (0.868)
Ep: 47, Reward: 864.8993, Test: 822.1441 [89.56], Avg: 305.8454 (0.866)
Ep: 48, Reward: 762.0947, Test: 787.7661 [123.10], Avg: 313.1683 (0.863)
Ep: 49, Reward: 787.4783, Test: 787.9920 [96.72], Avg: 320.7304 (0.861)
Ep: 50, Reward: 776.6372, Test: 743.4854 [134.71], Avg: 326.3783 (0.858)
Ep: 51, Reward: 785.0234, Test: 866.8613 [33.31], Avg: 336.1317 (0.855)
Ep: 52, Reward: 829.8143, Test: 853.7609 [36.75], Avg: 345.2050 (0.853)
Ep: 53, Reward: 792.3459, Test: 791.6108 [119.54], Avg: 351.2580 (0.850)
Ep: 54, Reward: 769.4034, Test: 818.7544 [53.85], Avg: 358.7789 (0.848)
Ep: 55, Reward: 755.0445, Test: 839.2526 [37.11], Avg: 366.6962 (0.845)
Ep: 56, Reward: 822.5417, Test: 786.6408 [169.61], Avg: 371.0880 (0.843)
Ep: 57, Reward: 841.2315, Test: 825.5657 [73.31], Avg: 377.6598 (0.840)
Ep: 58, Reward: 850.7526, Test: 848.1978 [67.56], Avg: 384.4900 (0.838)
Ep: 59, Reward: 896.2211, Test: 831.2380 [98.01], Avg: 390.3023 (0.835)
Ep: 60, Reward: 837.8575, Test: 838.2314 [86.02], Avg: 396.2352 (0.833)
Ep: 61, Reward: 831.0676, Test: 841.7627 [62.34], Avg: 402.4157 (0.830)
Ep: 62, Reward: 849.2106, Test: 807.1839 [133.24], Avg: 406.7256 (0.828)
Ep: 63, Reward: 793.1797, Test: 732.6574 [171.75], Avg: 409.1347 (0.825)
Ep: 64, Reward: 774.2554, Test: 708.7772 [206.05], Avg: 410.5746 (0.823)
Ep: 65, Reward: 847.0919, Test: 712.8471 [207.94], Avg: 412.0039 (0.820)
Ep: 66, Reward: 765.0410, Test: 866.0179 [46.36], Avg: 418.0883 (0.818)
Ep: 67, Reward: 821.1809, Test: 790.7417 [147.30], Avg: 421.4022 (0.815)
Ep: 68, Reward: 846.8307, Test: 786.8067 [166.55], Avg: 424.2843 (0.813)
Ep: 69, Reward: 835.0004, Test: 707.2508 [159.48], Avg: 426.0484 (0.810)
Ep: 70, Reward: 836.7446, Test: 868.8325 [44.74], Avg: 431.6547 (0.808)
Ep: 71, Reward: 894.1362, Test: 756.8276 [169.00], Avg: 433.8237 (0.805)
Ep: 72, Reward: 858.2988, Test: 718.5933 [162.50], Avg: 435.4986 (0.803)
Ep: 73, Reward: 733.8210, Test: 737.6663 [166.20], Avg: 437.3361 (0.801)
Ep: 74, Reward: 708.6901, Test: 773.4818 [155.42], Avg: 439.7457 (0.798)
Ep: 75, Reward: 780.1513, Test: 732.3898 [219.77], Avg: 440.7046 (0.796)
Ep: 76, Reward: 613.9035, Test: 687.2986 [194.03], Avg: 441.3872 (0.793)
Ep: 77, Reward: 654.6525, Test: 742.5817 [212.70], Avg: 442.5217 (0.791)
Ep: 78, Reward: 697.1456, Test: 672.3572 [161.44], Avg: 443.3874 (0.789)
Ep: 79, Reward: 791.4981, Test: 823.4672 [145.55], Avg: 446.3190 (0.786)
Ep: 80, Reward: 740.6816, Test: 728.8422 [160.34], Avg: 447.8274 (0.784)
Ep: 81, Reward: 841.2109, Test: 767.6697 [126.41], Avg: 450.1863 (0.782)
Ep: 82, Reward: 787.1524, Test: 752.3326 [159.81], Avg: 451.9012 (0.779)
Ep: 83, Reward: 813.1156, Test: 752.2363 [220.12], Avg: 452.8562 (0.777)
Ep: 84, Reward: 798.3039, Test: 820.2613 [122.25], Avg: 455.7403 (0.775)
Ep: 85, Reward: 665.0980, Test: 801.6969 [125.68], Avg: 458.3017 (0.772)
Ep: 86, Reward: 790.0626, Test: 845.9132 [75.47], Avg: 461.8896 (0.770)
Ep: 87, Reward: 782.8976, Test: 773.0200 [174.35], Avg: 463.4439 (0.768)
Ep: 88, Reward: 796.7709, Test: 760.2627 [172.46], Avg: 464.8411 (0.765)
Ep: 89, Reward: 806.2193, Test: 819.2705 [89.56], Avg: 467.7841 (0.763)
Ep: 90, Reward: 874.3556, Test: 853.1151 [72.85], Avg: 471.2180 (0.761)
Ep: 91, Reward: 791.6779, Test: 873.9290 [45.05], Avg: 475.1056 (0.758)
Ep: 92, Reward: 839.9993, Test: 827.4157 [66.32], Avg: 478.1808 (0.756)
Ep: 93, Reward: 786.2813, Test: 883.7283 [30.59], Avg: 482.1697 (0.754)
Ep: 94, Reward: 809.9561, Test: 815.0489 [59.96], Avg: 485.0425 (0.752)
Ep: 95, Reward: 833.6059, Test: 807.7370 [145.60], Avg: 486.8873 (0.749)
Ep: 96, Reward: 834.2921, Test: 801.4215 [120.22], Avg: 488.8905 (0.747)
Ep: 97, Reward: 821.6159, Test: 768.8225 [135.04], Avg: 490.3690 (0.745)
Ep: 98, Reward: 825.0972, Test: 776.8719 [109.80], Avg: 492.1539 (0.743)
Ep: 99, Reward: 806.9047, Test: 860.2081 [32.26], Avg: 495.5118 (0.740)
Ep: 100, Reward: 803.9593, Test: 824.2336 [100.53], Avg: 497.7712 (0.738)
Ep: 101, Reward: 788.4099, Test: 808.9403 [153.26], Avg: 499.3193 (0.736)
Ep: 102, Reward: 797.7668, Test: 800.7124 [137.14], Avg: 500.9139 (0.734)
Ep: 103, Reward: 857.3461, Test: 793.7580 [142.98], Avg: 502.3549 (0.732)
Ep: 104, Reward: 775.7600, Test: 726.4584 [162.37], Avg: 502.9429 (0.729)
Ep: 105, Reward: 713.5228, Test: 782.6514 [123.08], Avg: 504.4205 (0.727)
Ep: 106, Reward: 714.4080, Test: 812.2005 [108.08], Avg: 506.2868 (0.725)
Ep: 107, Reward: 751.4491, Test: 736.7179 [157.60], Avg: 506.9612 (0.723)
Ep: 108, Reward: 780.9167, Test: 702.7079 [195.27], Avg: 506.9655 (0.721)
Ep: 109, Reward: 726.8402, Test: 807.1068 [156.61], Avg: 508.2704 (0.719)
Ep: 110, Reward: 789.9211, Test: 716.9621 [163.13], Avg: 508.6808 (0.716)
Ep: 111, Reward: 768.2581, Test: 800.7753 [97.12], Avg: 510.4217 (0.714)
Ep: 112, Reward: 818.7075, Test: 704.9769 [207.66], Avg: 510.3057 (0.712)
Ep: 113, Reward: 737.7253, Test: 745.2118 [162.39], Avg: 510.9419 (0.710)
Ep: 114, Reward: 774.5116, Test: 840.0863 [83.13], Avg: 513.0811 (0.708)
Ep: 115, Reward: 728.1472, Test: 795.2653 [92.07], Avg: 514.7201 (0.706)
Ep: 116, Reward: 738.1886, Test: 814.4516 [110.62], Avg: 516.3364 (0.704)
Ep: 117, Reward: 730.1962, Test: 719.8508 [182.39], Avg: 516.5154 (0.702)
Ep: 118, Reward: 827.6615, Test: 808.4045 [95.65], Avg: 518.1644 (0.699)
Ep: 119, Reward: 787.3055, Test: 789.1957 [112.97], Avg: 519.4815 (0.697)
Ep: 120, Reward: 756.7753, Test: 763.8585 [150.81], Avg: 520.2549 (0.695)
Ep: 121, Reward: 771.6552, Test: 692.7450 [182.85], Avg: 520.1699 (0.693)
Ep: 122, Reward: 684.9832, Test: 754.5542 [180.85], Avg: 520.6052 (0.691)
Ep: 123, Reward: 723.7645, Test: 815.6212 [132.38], Avg: 521.9167 (0.689)
Ep: 124, Reward: 849.3064, Test: 718.3407 [159.84], Avg: 522.2094 (0.687)
Ep: 125, Reward: 767.6526, Test: 786.4211 [96.97], Avg: 523.5367 (0.685)
Ep: 126, Reward: 769.9712, Test: 751.5955 [158.28], Avg: 524.0861 (0.683)
Ep: 127, Reward: 756.9615, Test: 769.4707 [89.96], Avg: 525.3004 (0.681)
Ep: 128, Reward: 719.6998, Test: 784.5952 [170.55], Avg: 525.9884 (0.679)
Ep: 129, Reward: 767.1824, Test: 760.0358 [113.25], Avg: 526.9175 (0.677)
Ep: 130, Reward: 825.8117, Test: 728.0621 [139.17], Avg: 527.3906 (0.675)
Ep: 131, Reward: 801.9014, Test: 757.0039 [162.43], Avg: 527.8996 (0.673)
Ep: 132, Reward: 754.0742, Test: 823.6095 [113.29], Avg: 529.2712 (0.671)
Ep: 133, Reward: 846.2620, Test: 768.8111 [201.21], Avg: 529.5572 (0.669)
Ep: 134, Reward: 809.7024, Test: 834.0897 [110.48], Avg: 530.9946 (0.667)
Ep: 135, Reward: 828.2258, Test: 738.9769 [154.68], Avg: 531.3865 (0.665)
Ep: 136, Reward: 887.0851, Test: 829.4037 [93.06], Avg: 532.8826 (0.663)
Ep: 137, Reward: 857.9962, Test: 881.5779 [24.70], Avg: 535.2304 (0.661)
Ep: 138, Reward: 887.3127, Test: 843.4821 [77.03], Avg: 536.8939 (0.659)
Ep: 139, Reward: 882.2529, Test: 870.9917 [64.43], Avg: 538.8200 (0.657)
Ep: 140, Reward: 833.9464, Test: 814.1988 [145.33], Avg: 539.7424 (0.655)
Ep: 141, Reward: 855.1135, Test: 852.6640 [66.38], Avg: 541.4786 (0.653)
Ep: 142, Reward: 811.2251, Test: 792.2771 [133.51], Avg: 542.2988 (0.651)
Ep: 143, Reward: 845.9411, Test: 835.2112 [95.84], Avg: 543.6673 (0.649)
Ep: 144, Reward: 898.2920, Test: 854.3785 [65.05], Avg: 545.3616 (0.647)
Ep: 145, Reward: 847.6014, Test: 863.8721 [71.20], Avg: 547.0555 (0.645)
Ep: 146, Reward: 859.4349, Test: 810.6157 [142.36], Avg: 547.8800 (0.643)
Ep: 147, Reward: 879.8429, Test: 674.3004 [186.25], Avg: 547.4757 (0.641)
Ep: 148, Reward: 848.0210, Test: 803.3727 [115.60], Avg: 548.4173 (0.639)
Ep: 149, Reward: 855.2376, Test: 797.4970 [125.25], Avg: 549.2428 (0.637)
Ep: 150, Reward: 819.4409, Test: 826.5344 [127.94], Avg: 550.2319 (0.635)
Ep: 151, Reward: 873.6981, Test: 859.8023 [74.18], Avg: 551.7806 (0.633)
Ep: 152, Reward: 821.5960, Test: 869.2084 [94.40], Avg: 553.2383 (0.631)
Ep: 153, Reward: 866.4016, Test: 873.9339 [66.97], Avg: 554.8859 (0.630)
Ep: 154, Reward: 855.5174, Test: 774.5846 [169.58], Avg: 555.2092 (0.628)
Ep: 155, Reward: 889.0190, Test: 799.6382 [179.81], Avg: 555.6235 (0.626)
Ep: 156, Reward: 876.1227, Test: 845.6507 [124.78], Avg: 556.6760 (0.624)
Ep: 157, Reward: 874.6281, Test: 823.9535 [187.88], Avg: 557.1785 (0.622)
Ep: 158, Reward: 867.8214, Test: 801.6030 [164.48], Avg: 557.6813 (0.620)
Ep: 159, Reward: 821.7042, Test: 850.8661 [96.17], Avg: 558.9126 (0.618)
Ep: 160, Reward: 919.0245, Test: 802.4415 [128.72], Avg: 559.6257 (0.616)
Ep: 161, Reward: 872.9952, Test: 786.5767 [171.80], Avg: 559.9662 (0.615)
Ep: 162, Reward: 870.9687, Test: 798.5248 [148.63], Avg: 560.5179 (0.613)
Ep: 163, Reward: 820.1893, Test: 811.2861 [123.92], Avg: 561.2913 (0.611)
Ep: 164, Reward: 889.3712, Test: 853.3990 [98.51], Avg: 562.4647 (0.609)
Ep: 165, Reward: 842.0185, Test: 880.4454 [30.91], Avg: 564.1940 (0.607)
Ep: 166, Reward: 856.9483, Test: 715.5724 [228.26], Avg: 563.7337 (0.605)
Ep: 167, Reward: 844.6590, Test: 845.2228 [133.42], Avg: 564.6150 (0.604)
Ep: 168, Reward: 801.8651, Test: 792.1741 [157.20], Avg: 565.0313 (0.602)
Ep: 169, Reward: 789.7499, Test: 848.0286 [89.15], Avg: 566.1716 (0.600)
Ep: 170, Reward: 699.7492, Test: 831.7430 [117.37], Avg: 567.0383 (0.598)
Ep: 171, Reward: 807.1829, Test: 705.3299 [204.77], Avg: 566.6518 (0.596)
Ep: 172, Reward: 766.0019, Test: 675.7867 [205.18], Avg: 566.0967 (0.595)
Ep: 173, Reward: 774.4593, Test: 772.2754 [159.39], Avg: 566.3655 (0.593)
Ep: 174, Reward: 709.7664, Test: 824.4183 [122.87], Avg: 567.1380 (0.591)
Ep: 175, Reward: 867.1887, Test: 810.6000 [150.02], Avg: 567.6689 (0.589)
Ep: 176, Reward: 806.4930, Test: 806.3545 [114.45], Avg: 568.3708 (0.588)
Ep: 177, Reward: 778.8043, Test: 785.5088 [178.26], Avg: 568.5892 (0.586)
Ep: 178, Reward: 814.5142, Test: 841.4219 [89.43], Avg: 569.6138 (0.584)
Ep: 179, Reward: 799.6476, Test: 851.8107 [45.93], Avg: 570.9264 (0.582)
Ep: 180, Reward: 733.1802, Test: 744.8047 [179.63], Avg: 570.8946 (0.581)
Ep: 181, Reward: 836.4614, Test: 736.3292 [178.91], Avg: 570.8206 (0.579)
Ep: 182, Reward: 841.5511, Test: 809.9491 [116.87], Avg: 571.4887 (0.577)
Ep: 183, Reward: 778.1958, Test: 792.6356 [101.47], Avg: 572.1391 (0.575)
Ep: 184, Reward: 736.2904, Test: 740.7127 [173.08], Avg: 572.1147 (0.574)
Ep: 185, Reward: 758.6510, Test: 738.5256 [190.29], Avg: 571.9863 (0.572)
Ep: 186, Reward: 782.7315, Test: 815.8957 [117.60], Avg: 572.6618 (0.570)
Ep: 187, Reward: 832.6476, Test: 798.7857 [107.32], Avg: 573.2937 (0.568)
Ep: 188, Reward: 905.3919, Test: 727.6698 [165.76], Avg: 573.2335 (0.567)
Ep: 189, Reward: 809.8789, Test: 784.3291 [126.27], Avg: 573.6800 (0.565)
Ep: 190, Reward: 849.5170, Test: 859.1567 [78.72], Avg: 574.7625 (0.563)
Ep: 191, Reward: 831.7383, Test: 820.9673 [93.45], Avg: 575.5581 (0.562)
Ep: 192, Reward: 819.3299, Test: 873.5720 [62.08], Avg: 576.7806 (0.560)
Ep: 193, Reward: 830.7060, Test: 844.9024 [72.53], Avg: 577.7888 (0.558)
Ep: 194, Reward: 802.2857, Test: 816.8664 [176.97], Avg: 578.1072 (0.557)
Ep: 195, Reward: 838.2247, Test: 813.0234 [150.19], Avg: 578.5395 (0.555)
Ep: 196, Reward: 817.9674, Test: 868.4528 [48.22], Avg: 579.7664 (0.553)
Ep: 197, Reward: 884.5931, Test: 787.8695 [156.42], Avg: 580.0274 (0.552)
Ep: 198, Reward: 796.6483, Test: 802.3988 [153.54], Avg: 580.3733 (0.550)
Ep: 199, Reward: 783.6644, Test: 889.2016 [33.47], Avg: 581.7501 (0.548)
Ep: 200, Reward: 830.8642, Test: 813.3657 [160.52], Avg: 582.1038 (0.547)
Ep: 201, Reward: 909.6838, Test: 795.9763 [177.97], Avg: 582.2815 (0.545)
Ep: 202, Reward: 843.4592, Test: 842.2303 [103.69], Avg: 583.0513 (0.543)
Ep: 203, Reward: 814.7482, Test: 840.5617 [102.77], Avg: 583.8098 (0.542)
Ep: 204, Reward: 810.2075, Test: 748.6812 [156.64], Avg: 583.8500 (0.540)
Ep: 205, Reward: 741.2908, Test: 827.5800 [89.45], Avg: 584.5990 (0.539)
Ep: 206, Reward: 777.2506, Test: 782.3089 [107.46], Avg: 585.0349 (0.537)
Ep: 207, Reward: 802.0716, Test: 699.3093 [214.93], Avg: 584.5510 (0.535)
Ep: 208, Reward: 760.2755, Test: 765.8449 [204.00], Avg: 584.4424 (0.534)
Ep: 209, Reward: 806.6676, Test: 801.3335 [156.84], Avg: 584.7283 (0.532)
Ep: 210, Reward: 787.2096, Test: 760.1400 [148.75], Avg: 584.8547 (0.530)
Ep: 211, Reward: 849.7737, Test: 899.0862 [25.83], Avg: 586.2151 (0.529)
Ep: 212, Reward: 952.8029, Test: 812.1780 [114.24], Avg: 586.7396 (0.527)
Ep: 213, Reward: 811.3040, Test: 767.8199 [152.06], Avg: 586.8752 (0.526)
Ep: 214, Reward: 890.0137, Test: 851.5731 [88.60], Avg: 587.6943 (0.524)
Ep: 215, Reward: 849.8921, Test: 800.9186 [144.36], Avg: 588.0131 (0.523)
Ep: 216, Reward: 895.7591, Test: 790.4919 [167.98], Avg: 588.1721 (0.521)
Ep: 217, Reward: 881.7395, Test: 829.0807 [159.82], Avg: 588.5440 (0.519)
Ep: 218, Reward: 851.6847, Test: 858.1951 [110.03], Avg: 589.2729 (0.518)
Ep: 219, Reward: 933.8155, Test: 777.3289 [152.19], Avg: 589.4360 (0.516)
Ep: 220, Reward: 840.9135, Test: 878.6595 [53.70], Avg: 590.5017 (0.515)
Ep: 221, Reward: 844.8175, Test: 775.0558 [165.17], Avg: 590.5890 (0.513)
Ep: 222, Reward: 893.4567, Test: 799.0527 [182.55], Avg: 590.7052 (0.512)
Ep: 223, Reward: 857.3125, Test: 822.4313 [126.64], Avg: 591.1743 (0.510)
Ep: 224, Reward: 975.7381, Test: 859.4335 [92.56], Avg: 591.9552 (0.509)
Ep: 225, Reward: 843.7300, Test: 836.3512 [79.54], Avg: 592.6847 (0.507)
Ep: 226, Reward: 870.6446, Test: 872.5661 [24.24], Avg: 593.8109 (0.506)
Ep: 227, Reward: 869.8446, Test: 828.2785 [91.61], Avg: 594.4375 (0.504)
Ep: 228, Reward: 839.3270, Test: 804.5862 [163.77], Avg: 594.6400 (0.503)
Ep: 229, Reward: 862.3449, Test: 827.6059 [154.24], Avg: 594.9823 (0.501)
Ep: 230, Reward: 808.6213, Test: 778.0164 [154.91], Avg: 595.1040 (0.500)
Ep: 231, Reward: 889.7970, Test: 867.4488 [43.94], Avg: 596.0886 (0.498)
Ep: 232, Reward: 914.0381, Test: 851.4122 [103.65], Avg: 596.7395 (0.497)
Ep: 233, Reward: 859.6622, Test: 834.0949 [116.08], Avg: 597.2578 (0.495)
Ep: 234, Reward: 859.9180, Test: 822.5221 [121.46], Avg: 597.6995 (0.494)
Ep: 235, Reward: 855.1891, Test: 867.0456 [49.90], Avg: 598.6294 (0.492)
Ep: 236, Reward: 894.9533, Test: 839.6299 [89.01], Avg: 599.2707 (0.491)
Ep: 237, Reward: 844.4125, Test: 817.3829 [137.27], Avg: 599.6104 (0.489)
Ep: 238, Reward: 853.0560, Test: 886.8278 [36.00], Avg: 600.6615 (0.488)
Ep: 239, Reward: 943.7954, Test: 806.6424 [104.44], Avg: 601.0846 (0.486)
Ep: 240, Reward: 865.9699, Test: 688.0524 [183.98], Avg: 600.6820 (0.485)
Ep: 241, Reward: 851.8474, Test: 722.1537 [244.73], Avg: 600.1727 (0.483)
Ep: 242, Reward: 865.1784, Test: 830.0300 [70.18], Avg: 600.8298 (0.482)
Ep: 243, Reward: 787.9649, Test: 851.4607 [53.20], Avg: 601.6389 (0.480)
Ep: 244, Reward: 862.7150, Test: 789.8135 [200.89], Avg: 601.5871 (0.479)
Ep: 245, Reward: 845.2695, Test: 806.5506 [124.81], Avg: 601.9129 (0.478)
Ep: 246, Reward: 901.6869, Test: 816.5352 [106.89], Avg: 602.3491 (0.476)
Ep: 247, Reward: 803.5376, Test: 846.8554 [95.06], Avg: 602.9517 (0.475)
Ep: 248, Reward: 887.0614, Test: 846.1498 [119.45], Avg: 603.4486 (0.473)
Ep: 249, Reward: 885.1994, Test: 730.1621 [167.21], Avg: 603.2867 (0.472)
Ep: 250, Reward: 881.2461, Test: 843.5504 [76.79], Avg: 603.9380 (0.470)
Ep: 251, Reward: 937.7542, Test: 855.5108 [27.54], Avg: 604.8270 (0.469)
Ep: 252, Reward: 822.8099, Test: 784.0283 [162.66], Avg: 604.8924 (0.468)
Ep: 253, Reward: 872.7645, Test: 828.8158 [82.43], Avg: 605.4494 (0.466)
Ep: 254, Reward: 853.5606, Test: 885.4854 [20.55], Avg: 606.4670 (0.465)
Ep: 255, Reward: 863.4101, Test: 847.4986 [65.98], Avg: 607.1508 (0.463)
Ep: 256, Reward: 832.5245, Test: 794.6718 [154.78], Avg: 607.2782 (0.462)
Ep: 257, Reward: 851.3911, Test: 841.2457 [110.53], Avg: 607.7566 (0.461)
Ep: 258, Reward: 882.7978, Test: 817.1828 [148.51], Avg: 607.9918 (0.459)
Ep: 259, Reward: 867.5810, Test: 856.2715 [59.87], Avg: 608.7165 (0.458)
Ep: 260, Reward: 854.5464, Test: 817.9680 [154.00], Avg: 608.9282 (0.456)
Ep: 261, Reward: 887.3655, Test: 829.4712 [78.96], Avg: 609.4686 (0.455)
Ep: 262, Reward: 893.4324, Test: 844.5200 [87.07], Avg: 610.0313 (0.454)
Ep: 263, Reward: 824.5194, Test: 840.0233 [69.86], Avg: 610.6378 (0.452)
Ep: 264, Reward: 896.2262, Test: 811.4810 [81.88], Avg: 611.0868 (0.451)
Ep: 265, Reward: 806.2985, Test: 824.7377 [129.75], Avg: 611.4022 (0.450)
Ep: 266, Reward: 899.3255, Test: 842.6403 [89.84], Avg: 611.9318 (0.448)
Ep: 267, Reward: 835.6456, Test: 843.3638 [99.80], Avg: 612.4229 (0.447)
Ep: 268, Reward: 815.9972, Test: 768.7967 [112.87], Avg: 612.5847 (0.446)
Ep: 269, Reward: 836.1666, Test: 783.4518 [165.83], Avg: 612.6033 (0.444)
Ep: 270, Reward: 836.2960, Test: 797.1017 [97.32], Avg: 612.9250 (0.443)
Ep: 271, Reward: 828.2320, Test: 756.4205 [173.47], Avg: 612.8148 (0.442)
Ep: 272, Reward: 804.8619, Test: 751.1567 [201.15], Avg: 612.5847 (0.440)
Ep: 273, Reward: 810.6555, Test: 805.2874 [102.57], Avg: 612.9137 (0.439)
Ep: 274, Reward: 836.2845, Test: 841.9596 [63.37], Avg: 613.5161 (0.438)
Ep: 275, Reward: 826.6966, Test: 799.7794 [137.51], Avg: 613.6928 (0.436)
Ep: 276, Reward: 801.0178, Test: 760.6232 [185.69], Avg: 613.5528 (0.435)
Ep: 277, Reward: 797.6988, Test: 827.4587 [145.09], Avg: 613.8004 (0.434)
Ep: 278, Reward: 842.2376, Test: 798.5754 [133.06], Avg: 613.9857 (0.432)
Ep: 279, Reward: 872.0619, Test: 792.1715 [87.57], Avg: 614.3094 (0.431)
Ep: 280, Reward: 911.5703, Test: 815.4818 [153.67], Avg: 614.4784 (0.430)
Ep: 281, Reward: 842.6161, Test: 810.0587 [108.53], Avg: 614.7871 (0.429)
Ep: 282, Reward: 838.8949, Test: 894.2150 [20.14], Avg: 615.7033 (0.427)
Ep: 283, Reward: 821.5409, Test: 832.9225 [104.82], Avg: 616.0991 (0.426)
Ep: 284, Reward: 833.0708, Test: 808.6001 [127.28], Avg: 616.3279 (0.425)
Ep: 285, Reward: 812.6607, Test: 843.1286 [63.34], Avg: 616.8995 (0.423)
Ep: 286, Reward: 862.6201, Test: 783.9504 [104.49], Avg: 617.1174 (0.422)
Ep: 287, Reward: 796.2761, Test: 800.0545 [133.45], Avg: 617.2893 (0.421)
Ep: 288, Reward: 823.7746, Test: 784.6222 [230.87], Avg: 617.0694 (0.420)
Ep: 289, Reward: 877.6487, Test: 791.5991 [110.92], Avg: 617.2888 (0.418)
Ep: 290, Reward: 856.2821, Test: 823.9733 [115.00], Avg: 617.6038 (0.417)
Ep: 291, Reward: 809.5409, Test: 816.6771 [120.24], Avg: 617.8738 (0.416)
Ep: 292, Reward: 822.3349, Test: 809.8069 [149.57], Avg: 618.0184 (0.415)
Ep: 293, Reward: 830.8810, Test: 831.1370 [116.88], Avg: 618.3457 (0.413)
Ep: 294, Reward: 741.0499, Test: 767.6082 [146.32], Avg: 618.3557 (0.412)
Ep: 295, Reward: 814.2631, Test: 836.7923 [84.23], Avg: 618.8091 (0.411)
Ep: 296, Reward: 821.0912, Test: 863.0407 [59.31], Avg: 619.4317 (0.410)
Ep: 297, Reward: 796.5805, Test: 836.0427 [82.18], Avg: 619.8828 (0.408)
Ep: 298, Reward: 799.7253, Test: 821.6804 [148.28], Avg: 620.0618 (0.407)
Ep: 299, Reward: 798.9611, Test: 841.1074 [59.06], Avg: 620.6018 (0.406)
Ep: 300, Reward: 837.6333, Test: 841.7634 [66.24], Avg: 621.1164 (0.405)
Ep: 301, Reward: 774.0206, Test: 763.2293 [140.68], Avg: 621.1212 (0.404)
Ep: 302, Reward: 822.4683, Test: 838.0726 [98.40], Avg: 621.5124 (0.402)
Ep: 303, Reward: 759.5005, Test: 767.1699 [104.13], Avg: 621.6490 (0.401)
Ep: 304, Reward: 831.7501, Test: 831.3497 [114.95], Avg: 621.9597 (0.400)
Ep: 305, Reward: 745.1039, Test: 822.5398 [124.46], Avg: 622.2084 (0.399)
Ep: 306, Reward: 849.6616, Test: 716.7150 [176.09], Avg: 621.9427 (0.398)
Ep: 307, Reward: 805.2649, Test: 851.4290 [78.50], Avg: 622.4329 (0.396)
Ep: 308, Reward: 887.6959, Test: 835.6397 [81.52], Avg: 622.8591 (0.395)
Ep: 309, Reward: 811.8624, Test: 843.1199 [87.16], Avg: 623.2884 (0.394)
Ep: 310, Reward: 834.1496, Test: 745.3608 [163.42], Avg: 623.1555 (0.393)
Ep: 311, Reward: 810.8420, Test: 786.9990 [153.20], Avg: 623.1896 (0.392)
Ep: 312, Reward: 809.4570, Test: 767.1586 [134.21], Avg: 623.2208 (0.390)
Ep: 313, Reward: 836.9664, Test: 738.7272 [137.41], Avg: 623.1510 (0.389)
Ep: 314, Reward: 848.1507, Test: 838.6601 [56.19], Avg: 623.6568 (0.388)
Ep: 315, Reward: 818.2062, Test: 776.4701 [136.83], Avg: 623.7074 (0.387)
Ep: 316, Reward: 840.6420, Test: 862.9406 [83.28], Avg: 624.1993 (0.386)
Ep: 317, Reward: 817.1403, Test: 841.8093 [82.71], Avg: 624.6236 (0.385)
Ep: 318, Reward: 831.9497, Test: 738.6022 [183.29], Avg: 624.4063 (0.383)
Ep: 319, Reward: 909.6198, Test: 843.4766 [61.70], Avg: 624.8981 (0.382)
Ep: 320, Reward: 847.8513, Test: 837.2054 [109.76], Avg: 625.2176 (0.381)
Ep: 321, Reward: 847.0982, Test: 760.4731 [192.48], Avg: 625.0398 (0.380)
Ep: 322, Reward: 821.2951, Test: 821.6527 [129.18], Avg: 625.2486 (0.379)
Ep: 323, Reward: 869.8491, Test: 874.7798 [33.35], Avg: 625.9158 (0.378)
Ep: 324, Reward: 802.4168, Test: 846.8189 [50.49], Avg: 626.4402 (0.377)
Ep: 325, Reward: 827.4676, Test: 828.7290 [86.47], Avg: 626.7954 (0.376)
Ep: 326, Reward: 848.6833, Test: 848.9748 [63.89], Avg: 627.2795 (0.374)
Ep: 327, Reward: 849.8785, Test: 793.8939 [177.27], Avg: 627.2470 (0.373)
Ep: 328, Reward: 821.0052, Test: 705.3145 [189.01], Avg: 626.9098 (0.372)
Ep: 329, Reward: 824.2013, Test: 780.5009 [132.72], Avg: 626.9730 (0.371)
Ep: 330, Reward: 793.5645, Test: 796.8523 [97.94], Avg: 627.1904 (0.370)
Ep: 331, Reward: 810.3251, Test: 821.5541 [57.62], Avg: 627.6022 (0.369)
Ep: 332, Reward: 804.4580, Test: 837.3542 [52.79], Avg: 628.0736 (0.368)
Ep: 333, Reward: 835.4819, Test: 854.9971 [42.23], Avg: 628.6266 (0.367)
Ep: 334, Reward: 765.5181, Test: 799.7789 [80.74], Avg: 628.8965 (0.365)
Ep: 335, Reward: 806.3260, Test: 855.1882 [99.69], Avg: 629.2733 (0.364)
Ep: 336, Reward: 860.3626, Test: 823.0760 [79.36], Avg: 629.6129 (0.363)
Ep: 337, Reward: 787.1734, Test: 765.1499 [210.28], Avg: 629.3918 (0.362)
Ep: 338, Reward: 828.2157, Test: 787.7989 [163.44], Avg: 629.3769 (0.361)
Ep: 339, Reward: 803.1144, Test: 778.1842 [92.90], Avg: 629.5413 (0.360)
Ep: 340, Reward: 832.9356, Test: 862.3630 [53.64], Avg: 630.0668 (0.359)
Ep: 341, Reward: 852.7742, Test: 716.2551 [166.70], Avg: 629.8314 (0.358)
Ep: 342, Reward: 828.6349, Test: 828.8409 [84.38], Avg: 630.1656 (0.357)
Ep: 343, Reward: 823.8767, Test: 846.1399 [44.78], Avg: 630.6633 (0.356)
Ep: 344, Reward: 814.1080, Test: 816.6175 [103.84], Avg: 630.9013 (0.355)
Ep: 345, Reward: 821.6189, Test: 846.8361 [70.43], Avg: 631.3218 (0.354)
Ep: 346, Reward: 805.5612, Test: 799.3744 [105.27], Avg: 631.5028 (0.353)
Ep: 347, Reward: 792.3058, Test: 879.6451 [26.99], Avg: 632.1383 (0.351)
Ep: 348, Reward: 804.0518, Test: 857.9836 [52.52], Avg: 632.6349 (0.350)
Ep: 349, Reward: 824.5874, Test: 844.2914 [45.12], Avg: 633.1107 (0.349)
Ep: 350, Reward: 819.6501, Test: 858.4339 [56.05], Avg: 633.5930 (0.348)
Ep: 351, Reward: 830.9791, Test: 844.6599 [58.99], Avg: 634.0250 (0.347)
Ep: 352, Reward: 860.3673, Test: 864.5808 [48.64], Avg: 634.5404 (0.346)
Ep: 353, Reward: 831.0650, Test: 853.5375 [68.01], Avg: 634.9669 (0.345)
Ep: 354, Reward: 831.9359, Test: 833.2169 [102.42], Avg: 635.2368 (0.344)
Ep: 355, Reward: 824.8647, Test: 768.3656 [135.27], Avg: 635.2308 (0.343)
Ep: 356, Reward: 833.6386, Test: 840.1479 [86.93], Avg: 635.5613 (0.342)
Ep: 357, Reward: 902.0744, Test: 879.8115 [21.72], Avg: 636.1829 (0.341)
Ep: 358, Reward: 854.4673, Test: 864.2698 [58.49], Avg: 636.6553 (0.340)
Ep: 359, Reward: 831.0397, Test: 863.5039 [35.73], Avg: 637.1862 (0.339)
Ep: 360, Reward: 860.3917, Test: 827.7041 [91.45], Avg: 637.4606 (0.338)
Ep: 361, Reward: 898.7732, Test: 796.8259 [152.78], Avg: 637.4788 (0.337)
Ep: 362, Reward: 834.1591, Test: 819.0068 [101.70], Avg: 637.6988 (0.336)
Ep: 363, Reward: 787.1395, Test: 892.7295 [19.83], Avg: 638.3449 (0.335)
Ep: 364, Reward: 868.3030, Test: 779.0327 [188.36], Avg: 638.2143 (0.334)
Ep: 365, Reward: 889.3807, Test: 882.0244 [24.80], Avg: 638.8127 (0.333)
Ep: 366, Reward: 891.7665, Test: 812.8409 [134.10], Avg: 638.9215 (0.332)
Ep: 367, Reward: 830.2550, Test: 897.4080 [20.47], Avg: 639.5682 (0.331)
Ep: 368, Reward: 917.4581, Test: 847.7370 [72.19], Avg: 639.9368 (0.330)
Ep: 369, Reward: 903.4765, Test: 870.4524 [14.68], Avg: 640.5201 (0.329)
Ep: 370, Reward: 894.2158, Test: 837.4527 [93.88], Avg: 640.7979 (0.328)
Ep: 371, Reward: 829.8925, Test: 830.4831 [107.25], Avg: 641.0195 (0.327)
Ep: 372, Reward: 884.6481, Test: 752.7082 [145.49], Avg: 640.9288 (0.326)
Ep: 373, Reward: 881.6196, Test: 804.7511 [210.56], Avg: 640.8039 (0.325)
Ep: 374, Reward: 845.4677, Test: 843.0620 [109.58], Avg: 641.0510 (0.324)
Ep: 375, Reward: 906.0219, Test: 827.2488 [124.15], Avg: 641.2160 (0.323)
Ep: 376, Reward: 870.0270, Test: 884.0546 [66.77], Avg: 641.6831 (0.322)
Ep: 377, Reward: 889.1937, Test: 875.4548 [60.38], Avg: 642.1418 (0.321)
Ep: 378, Reward: 880.1063, Test: 879.0321 [31.61], Avg: 642.6834 (0.320)
Ep: 379, Reward: 937.8470, Test: 840.6379 [119.28], Avg: 642.8905 (0.319)
Ep: 380, Reward: 897.1368, Test: 868.5374 [59.69], Avg: 643.3260 (0.318)
Ep: 381, Reward: 879.2980, Test: 816.9043 [102.03], Avg: 643.5133 (0.317)
Ep: 382, Reward: 822.3556, Test: 883.3171 [51.99], Avg: 644.0037 (0.316)
Ep: 383, Reward: 889.5790, Test: 852.9857 [88.42], Avg: 644.3177 (0.315)
Ep: 384, Reward: 962.6154, Test: 853.6572 [81.23], Avg: 644.6504 (0.315)
Ep: 385, Reward: 934.2407, Test: 836.2880 [105.94], Avg: 644.8725 (0.314)
Ep: 386, Reward: 941.9035, Test: 889.7944 [65.44], Avg: 645.3362 (0.313)
Ep: 387, Reward: 857.2782, Test: 829.1424 [130.19], Avg: 645.4744 (0.312)
Ep: 388, Reward: 875.0315, Test: 816.1728 [102.24], Avg: 645.6504 (0.311)
Ep: 389, Reward: 934.1724, Test: 870.8866 [75.03], Avg: 646.0355 (0.310)
Ep: 390, Reward: 883.4478, Test: 813.1066 [141.90], Avg: 646.0999 (0.309)
Ep: 391, Reward: 929.9289, Test: 838.7629 [106.69], Avg: 646.3192 (0.308)
Ep: 392, Reward: 898.7194, Test: 893.3192 [24.25], Avg: 646.8860 (0.307)
Ep: 393, Reward: 873.3535, Test: 847.0036 [119.73], Avg: 647.0901 (0.306)
Ep: 394, Reward: 868.1162, Test: 792.1458 [150.83], Avg: 647.0754 (0.305)
Ep: 395, Reward: 842.5743, Test: 851.2013 [150.20], Avg: 647.2116 (0.304)
Ep: 396, Reward: 895.8080, Test: 851.6361 [63.76], Avg: 647.5659 (0.303)
Ep: 397, Reward: 815.2245, Test: 849.3711 [68.19], Avg: 647.9017 (0.302)
Ep: 398, Reward: 868.0672, Test: 880.4764 [61.87], Avg: 648.3295 (0.302)
Ep: 399, Reward: 900.8760, Test: 853.1226 [63.46], Avg: 648.6828 (0.301)
Ep: 400, Reward: 847.6625, Test: 836.3342 [101.24], Avg: 648.8983 (0.300)
Ep: 401, Reward: 867.4567, Test: 790.8398 [137.89], Avg: 648.9084 (0.299)
Ep: 402, Reward: 929.6702, Test: 814.0332 [110.52], Avg: 649.0439 (0.298)
Ep: 403, Reward: 938.4075, Test: 856.1000 [82.41], Avg: 649.3524 (0.297)
Ep: 404, Reward: 913.1417, Test: 861.9678 [57.09], Avg: 649.7364 (0.296)
Ep: 405, Reward: 849.2049, Test: 841.5587 [158.51], Avg: 649.8184 (0.295)
Ep: 406, Reward: 901.1898, Test: 829.2470 [107.01], Avg: 649.9964 (0.294)
Ep: 407, Reward: 789.0924, Test: 814.1211 [137.45], Avg: 650.0617 (0.294)
Ep: 408, Reward: 839.6947, Test: 795.5599 [114.22], Avg: 650.1382 (0.293)
Ep: 409, Reward: 937.1373, Test: 869.0829 [85.77], Avg: 650.4630 (0.292)
Ep: 410, Reward: 905.9700, Test: 815.5141 [165.85], Avg: 650.4611 (0.291)
Ep: 411, Reward: 957.6777, Test: 746.4404 [145.52], Avg: 650.3408 (0.290)
Ep: 412, Reward: 904.4368, Test: 866.9758 [63.32], Avg: 650.7120 (0.289)
Ep: 413, Reward: 970.4460, Test: 836.9101 [111.30], Avg: 650.8930 (0.288)
Ep: 414, Reward: 893.3569, Test: 843.5496 [101.66], Avg: 651.1122 (0.287)
Ep: 415, Reward: 911.1379, Test: 862.0012 [78.56], Avg: 651.4303 (0.287)
Ep: 416, Reward: 900.0293, Test: 898.6377 [21.62], Avg: 651.9713 (0.286)
Ep: 417, Reward: 906.9562, Test: 821.3913 [150.83], Avg: 652.0158 (0.285)
Ep: 418, Reward: 923.3122, Test: 876.3235 [31.22], Avg: 652.4766 (0.284)
Ep: 419, Reward: 829.6217, Test: 828.0849 [105.85], Avg: 652.6427 (0.283)
Ep: 420, Reward: 883.2552, Test: 883.0196 [31.02], Avg: 653.1162 (0.282)
Ep: 421, Reward: 918.1307, Test: 890.2632 [33.54], Avg: 653.5987 (0.281)
Ep: 422, Reward: 886.4129, Test: 881.6116 [31.75], Avg: 654.0627 (0.281)
Ep: 423, Reward: 916.1794, Test: 873.0697 [77.54], Avg: 654.3963 (0.280)
Ep: 424, Reward: 908.8989, Test: 853.7082 [71.01], Avg: 654.6982 (0.279)
Ep: 425, Reward: 863.3480, Test: 846.7212 [78.97], Avg: 654.9636 (0.278)
Ep: 426, Reward: 903.6120, Test: 847.0798 [95.82], Avg: 655.1891 (0.277)
Ep: 427, Reward: 924.9520, Test: 789.2561 [168.46], Avg: 655.1088 (0.276)
Ep: 428, Reward: 884.7878, Test: 893.4801 [24.03], Avg: 655.6084 (0.276)
Ep: 429, Reward: 904.3026, Test: 743.8937 [208.18], Avg: 655.3296 (0.275)
Ep: 430, Reward: 802.9698, Test: 799.3643 [113.61], Avg: 655.4002 (0.274)
Ep: 431, Reward: 863.4511, Test: 799.9399 [173.29], Avg: 655.3336 (0.273)
Ep: 432, Reward: 818.5245, Test: 867.4505 [50.04], Avg: 655.7079 (0.272)
Ep: 433, Reward: 909.6483, Test: 791.6404 [143.47], Avg: 655.6906 (0.271)
Ep: 434, Reward: 938.5037, Test: 868.3891 [72.23], Avg: 656.0135 (0.271)
Ep: 435, Reward: 956.8527, Test: 812.8324 [176.83], Avg: 655.9676 (0.270)
Ep: 436, Reward: 890.8931, Test: 795.3888 [128.28], Avg: 655.9931 (0.269)
Ep: 437, Reward: 859.1463, Test: 872.7243 [47.84], Avg: 656.3787 (0.268)
Ep: 438, Reward: 859.7978, Test: 832.7413 [76.06], Avg: 656.6072 (0.267)
Ep: 439, Reward: 811.8729, Test: 870.6116 [61.33], Avg: 656.9542 (0.267)
Ep: 440, Reward: 885.2418, Test: 881.4163 [39.90], Avg: 657.3727 (0.266)
Ep: 441, Reward: 901.1554, Test: 825.2911 [125.04], Avg: 657.4697 (0.265)
Ep: 442, Reward: 870.3248, Test: 865.9419 [91.45], Avg: 657.7338 (0.264)
Ep: 443, Reward: 867.3148, Test: 865.4847 [68.71], Avg: 658.0470 (0.263)
Ep: 444, Reward: 864.7048, Test: 786.6296 [147.12], Avg: 658.0053 (0.263)
Ep: 445, Reward: 929.7308, Test: 851.2355 [109.82], Avg: 658.1923 (0.262)
Ep: 446, Reward: 883.4009, Test: 893.3792 [24.90], Avg: 658.6628 (0.261)
Ep: 447, Reward: 848.6623, Test: 847.7102 [80.58], Avg: 658.9049 (0.260)
Ep: 448, Reward: 873.7109, Test: 895.4263 [29.32], Avg: 659.3664 (0.259)
Ep: 449, Reward: 909.0322, Test: 757.8470 [242.44], Avg: 659.0465 (0.259)
Ep: 450, Reward: 875.8110, Test: 818.3106 [122.64], Avg: 659.1277 (0.258)
Ep: 451, Reward: 826.4841, Test: 839.9963 [95.19], Avg: 659.3172 (0.257)
Ep: 452, Reward: 870.1112, Test: 851.9837 [107.58], Avg: 659.5051 (0.256)
Ep: 453, Reward: 846.1080, Test: 877.6389 [49.18], Avg: 659.8772 (0.256)
Ep: 454, Reward: 890.6150, Test: 803.7990 [113.59], Avg: 659.9439 (0.255)
Ep: 455, Reward: 880.6825, Test: 835.6745 [116.74], Avg: 660.0733 (0.254)
Ep: 456, Reward: 784.9402, Test: 886.6568 [24.76], Avg: 660.5149 (0.253)
Ep: 457, Reward: 873.1848, Test: 850.7825 [87.56], Avg: 660.7391 (0.253)
Ep: 458, Reward: 898.9407, Test: 861.3966 [53.34], Avg: 661.0601 (0.252)
Ep: 459, Reward: 842.8369, Test: 842.2332 [86.48], Avg: 661.2660 (0.251)
Ep: 460, Reward: 897.9216, Test: 832.7352 [75.65], Avg: 661.4738 (0.250)
Ep: 461, Reward: 835.3677, Test: 844.6857 [128.11], Avg: 661.5931 (0.250)
Ep: 462, Reward: 909.2497, Test: 771.3077 [192.81], Avg: 661.4136 (0.249)
Ep: 463, Reward: 855.5295, Test: 852.0074 [67.52], Avg: 661.6788 (0.248)
Ep: 464, Reward: 883.8654, Test: 838.6660 [71.46], Avg: 661.9058 (0.247)
Ep: 465, Reward: 858.6715, Test: 712.6063 [164.82], Avg: 661.6609 (0.247)
Ep: 466, Reward: 827.0493, Test: 797.9228 [132.73], Avg: 661.6685 (0.246)
Ep: 467, Reward: 872.7905, Test: 742.7307 [155.10], Avg: 661.5103 (0.245)
Ep: 468, Reward: 914.8633, Test: 858.5950 [78.52], Avg: 661.7631 (0.244)
Ep: 469, Reward: 845.3963, Test: 807.1963 [90.42], Avg: 661.8801 (0.244)
Ep: 470, Reward: 839.3256, Test: 817.6396 [118.31], Avg: 661.9596 (0.243)
Ep: 471, Reward: 798.1051, Test: 864.1057 [47.18], Avg: 662.2879 (0.242)
Ep: 472, Reward: 862.6618, Test: 833.9712 [111.95], Avg: 662.4142 (0.241)
Ep: 473, Reward: 841.6153, Test: 844.3560 [118.52], Avg: 662.5480 (0.241)
Ep: 474, Reward: 828.7029, Test: 875.7944 [35.91], Avg: 662.9214 (0.240)
Ep: 475, Reward: 902.3502, Test: 863.1852 [29.33], Avg: 663.2805 (0.239)
Ep: 476, Reward: 870.2687, Test: 826.4370 [98.70], Avg: 663.4156 (0.239)
Ep: 477, Reward: 891.3542, Test: 809.4350 [171.18], Avg: 663.3630 (0.238)
Ep: 478, Reward: 843.6516, Test: 757.6788 [201.13], Avg: 663.1400 (0.237)
Ep: 479, Reward: 821.6308, Test: 841.9800 [113.41], Avg: 663.2763 (0.236)
Ep: 480, Reward: 893.5783, Test: 791.5230 [157.99], Avg: 663.2145 (0.236)
Ep: 481, Reward: 862.9400, Test: 837.2519 [73.90], Avg: 663.4222 (0.235)
Ep: 482, Reward: 869.3599, Test: 878.1457 [62.69], Avg: 663.7370 (0.234)
Ep: 483, Reward: 898.4788, Test: 783.2857 [118.01], Avg: 663.7402 (0.234)
Ep: 484, Reward: 872.3422, Test: 780.7583 [189.17], Avg: 663.5914 (0.233)
Ep: 485, Reward: 885.3480, Test: 826.6622 [111.73], Avg: 663.6971 (0.232)
Ep: 486, Reward: 776.6971, Test: 754.4970 [135.41], Avg: 663.6055 (0.231)
Ep: 487, Reward: 812.3249, Test: 826.9254 [103.74], Avg: 663.7276 (0.231)
Ep: 488, Reward: 839.3597, Test: 845.0803 [65.16], Avg: 663.9652 (0.230)
Ep: 489, Reward: 908.7661, Test: 735.6786 [101.27], Avg: 663.9048 (0.229)
Ep: 490, Reward: 771.0960, Test: 733.3606 [136.46], Avg: 663.7684 (0.229)
Ep: 491, Reward: 809.0578, Test: 818.4772 [85.42], Avg: 663.9092 (0.228)
Ep: 492, Reward: 830.0113, Test: 765.3591 [182.61], Avg: 663.7446 (0.227)
Ep: 493, Reward: 870.0721, Test: 714.5057 [179.46], Avg: 663.4841 (0.227)
Ep: 494, Reward: 878.9755, Test: 869.4969 [64.13], Avg: 663.7707 (0.226)
Ep: 495, Reward: 841.9869, Test: 861.1217 [73.12], Avg: 664.0212 (0.225)
Ep: 496, Reward: 841.6113, Test: 810.4843 [140.85], Avg: 664.0325 (0.225)
Ep: 497, Reward: 817.4982, Test: 837.9410 [106.87], Avg: 664.1671 (0.224)
Ep: 498, Reward: 835.4987, Test: 809.2605 [127.97], Avg: 664.2014 (0.223)
Ep: 499, Reward: 858.5747, Test: 874.4676 [66.55], Avg: 664.4888 (0.223)
