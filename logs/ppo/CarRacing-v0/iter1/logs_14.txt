Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.2                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 5					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.005				# The limit of the ratio of new action probabilities to old probabilities
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 20					# The number of steps to collect experience in sequence for each GAE calculation
ADVANTAGE_DECAY = 0.99			# The discount factor for the cumulative GAE calculation

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			value = self.critic_local(state.to(self.device))
			return value

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=1, clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) + critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)
		self.replay_buffer = PrioritizedReplayBuffer()
		self.ppo_epochs = PPO_EPOCHS
		self.ppo_batch = BATCH_SIZE

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**0.0)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(zip(states, actions, log_probs, targets, advantages))
			for _ in range(self.ppo_epochs):
				self.replay_buffer.reset_priorities()
				for _ in range(update_freq):
					(state, action, log_prob, target, advantage), indices, importances = self.replay_buffer.sample(self.ppo_batch, dtype=torch.stack)
					errors = self.network.optimize(state, action, log_prob, target, advantage, importances**(1-self.eps), scale=self.eps)
					self.replay_buffer.update_priorities(indices, errors)
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.0225               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -38.4436, Test: -20.3907 [13.31], Avg: -33.7016 (0.997)
Ep: 1, Reward: -35.2669, Test: -17.9105 [17.71], Avg: -34.6628 (0.994)
Ep: 2, Reward: -35.2740, Test: -27.4558 [5.90], Avg: -34.2275 (0.991)
Ep: 3, Reward: -31.2171, Test: -29.7794 [2.31], Avg: -33.6940 (0.988)
Ep: 4, Reward: -34.5278, Test: -23.8711 [13.79], Avg: -34.4872 (0.985)
Ep: 5, Reward: -34.7570, Test: -18.9411 [14.51], Avg: -34.3143 (0.982)
Ep: 6, Reward: -31.2761, Test: -22.1478 [13.93], Avg: -34.5667 (0.979)
Ep: 7, Reward: -34.8490, Test: -31.1797 [4.71], Avg: -34.7326 (0.976)
Ep: 8, Reward: -34.9678, Test: -20.7178 [33.13], Avg: -36.8561 (0.973)
Ep: 9, Reward: -36.9924, Test: -76.6560 [38.16], Avg: -44.6524 (0.970)
Ep: 10, Reward: -39.6253, Test: -112.8325 [40.74], Avg: -54.5546 (0.967)
Ep: 11, Reward: -46.2700, Test: -62.0167 [4.15], Avg: -55.5218 (0.965)
Ep: 12, Reward: -45.2717, Test: -72.3250 [30.40], Avg: -59.1526 (0.962)
Ep: 13, Reward: -36.2790, Test: -70.9070 [28.01], Avg: -61.9929 (0.959)
Ep: 14, Reward: -42.0466, Test: -46.2492 [85.79], Avg: -66.6625 (0.956)
Ep: 15, Reward: -39.9141, Test: -50.9657 [90.57], Avg: -71.3422 (0.953)
Ep: 16, Reward: -32.2076, Test: -44.5175 [27.00], Avg: -71.3522 (0.950)
Ep: 17, Reward: -39.8631, Test: -94.5262 [22.95], Avg: -73.9149 (0.947)
Ep: 18, Reward: -53.8495, Test: -74.6770 [32.71], Avg: -75.6768 (0.945)
Ep: 19, Reward: -49.8007, Test: -77.7546 [59.79], Avg: -78.7704 (0.942)
Ep: 20, Reward: -41.0017, Test: -22.3050 [62.91], Avg: -79.0773 (0.939)
Ep: 21, Reward: -36.4407, Test: -25.1901 [75.17], Avg: -80.0449 (0.936)
Ep: 22, Reward: -22.1036, Test: 42.0233 [139.46], Avg: -80.8011 (0.933)
Ep: 23, Reward: -20.3698, Test: 41.6410 [87.80], Avg: -79.3575 (0.930)
Ep: 24, Reward: -13.7595, Test: 32.5116 [88.66], Avg: -78.4290 (0.928)
Ep: 25, Reward: 8.9002, Test: 11.4888 [28.79], Avg: -76.0778 (0.925)
Ep: 26, Reward: 52.1035, Test: 229.4212 [184.37], Avg: -71.5914 (0.922)
Ep: 27, Reward: 31.4496, Test: 44.8283 [67.82], Avg: -69.8559 (0.919)
Ep: 28, Reward: 85.7857, Test: 146.7450 [149.46], Avg: -67.5405 (0.917)
Ep: 29, Reward: 45.4084, Test: 106.9935 [81.64], Avg: -64.4439 (0.914)
Ep: 30, Reward: 135.2813, Test: 225.5951 [122.12], Avg: -59.0272 (0.911)
Ep: 31, Reward: 217.6616, Test: 191.7103 [193.49], Avg: -57.2382 (0.908)
Ep: 32, Reward: 336.8361, Test: 110.6214 [86.36], Avg: -54.7684 (0.906)
Ep: 33, Reward: 323.5879, Test: 182.2972 [157.52], Avg: -52.4289 (0.903)
Ep: 34, Reward: 309.7330, Test: 253.7158 [143.08], Avg: -47.7700 (0.900)
Ep: 35, Reward: 564.5257, Test: 255.8735 [119.70], Avg: -42.6604 (0.897)
Ep: 36, Reward: 678.5300, Test: 241.1937 [123.44], Avg: -38.3249 (0.895)
Ep: 37, Reward: 528.2086, Test: 315.5705 [198.73], Avg: -34.2415 (0.892)
Ep: 38, Reward: 457.0866, Test: 213.6517 [119.67], Avg: -30.9539 (0.889)
Ep: 39, Reward: 350.4016, Test: 333.9593 [119.60], Avg: -24.8209 (0.887)
Ep: 40, Reward: 529.2376, Test: 330.7064 [150.50], Avg: -19.8203 (0.884)
Ep: 41, Reward: 509.6673, Test: 361.6295 [111.39], Avg: -13.3902 (0.881)
Ep: 42, Reward: 476.0458, Test: 289.8169 [147.49], Avg: -9.7689 (0.879)
Ep: 43, Reward: 495.6126, Test: 263.4554 [196.12], Avg: -8.0164 (0.876)
Ep: 44, Reward: 441.7738, Test: 305.8794 [166.34], Avg: -4.7374 (0.874)
Ep: 45, Reward: 527.2271, Test: 368.9145 [190.62], Avg: -0.7585 (0.871)
Ep: 46, Reward: 590.0739, Test: 393.3891 [250.09], Avg: 2.3065 (0.868)
Ep: 47, Reward: 591.4382, Test: 397.2328 [192.37], Avg: 6.5264 (0.866)
Ep: 48, Reward: 563.6083, Test: 478.7359 [161.72], Avg: 12.8629 (0.863)
Ep: 49, Reward: 648.0575, Test: 412.0252 [310.59], Avg: 14.6344 (0.861)
Ep: 50, Reward: 539.1952, Test: 649.4710 [238.23], Avg: 22.4110 (0.858)
Ep: 51, Reward: 672.1696, Test: 378.8016 [263.80], Avg: 24.1916 (0.855)
Ep: 52, Reward: 609.3012, Test: 398.9937 [294.21], Avg: 25.7122 (0.853)
Ep: 53, Reward: 725.7941, Test: 593.4146 [217.13], Avg: 32.2044 (0.850)
Ep: 54, Reward: 713.6591, Test: 435.0640 [345.30], Avg: 33.2510 (0.848)
Ep: 55, Reward: 638.8856, Test: 264.5848 [187.48], Avg: 34.0341 (0.845)
Ep: 56, Reward: 537.8233, Test: 263.2879 [109.11], Avg: 36.1419 (0.843)
Ep: 57, Reward: 551.3352, Test: 353.4660 [205.08], Avg: 38.0772 (0.840)
Ep: 58, Reward: 539.5815, Test: 270.3836 [141.60], Avg: 39.6146 (0.838)
Ep: 59, Reward: 315.9673, Test: 200.2879 [232.12], Avg: 38.4239 (0.835)
Ep: 60, Reward: 459.0999, Test: 201.0365 [122.88], Avg: 39.0753 (0.833)
Ep: 61, Reward: 399.4403, Test: 220.2311 [132.94], Avg: 39.8529 (0.828)
Ep: 62, Reward: 414.6227, Test: 236.6167 [225.26], Avg: 39.4006 (0.825)
Ep: 63, Reward: 344.8210, Test: 223.5025 [127.31], Avg: 40.2880 (0.823)
Ep: 64, Reward: 333.8322, Test: 312.3959 [266.01], Avg: 40.3818 (0.820)
Ep: 65, Reward: 376.1516, Test: 269.2157 [150.37], Avg: 41.5706 (0.818)
Ep: 66, Reward: 366.1745, Test: 360.8311 [190.51], Avg: 43.4923 (0.815)
Ep: 67, Reward: 363.2058, Test: 318.2004 [49.75], Avg: 46.8005 (0.813)
Ep: 68, Reward: 307.4953, Test: 229.1653 [161.41], Avg: 47.1041 (0.810)
Ep: 69, Reward: 302.4003, Test: 273.0909 [144.07], Avg: 48.2743 (0.808)
Ep: 70, Reward: 337.4390, Test: 247.5886 [102.09], Avg: 49.6436 (0.805)
Ep: 71, Reward: 330.7026, Test: 337.9511 [188.92], Avg: 51.0240 (0.803)
Ep: 72, Reward: 361.4617, Test: 284.5774 [105.07], Avg: 52.7841 (0.801)
Ep: 73, Reward: 286.6435, Test: 340.1270 [78.66], Avg: 55.6041 (0.798)
Ep: 74, Reward: 363.5572, Test: 279.7584 [175.38], Avg: 56.2545 (0.796)
Ep: 75, Reward: 257.6596, Test: 346.1032 [274.23], Avg: 56.4600 (0.793)
Ep: 76, Reward: 349.3086, Test: 552.0567 [202.78], Avg: 60.2628 (0.791)
Ep: 77, Reward: 443.4490, Test: 633.0351 [214.63], Avg: 64.8544 (0.789)
Ep: 78, Reward: 359.0624, Test: 215.5224 [112.37], Avg: 65.3392 (0.786)
Ep: 79, Reward: 288.1115, Test: 296.9050 [156.14], Avg: 66.2820 (0.784)
Ep: 80, Reward: 317.4572, Test: 240.2054 [149.72], Avg: 66.5808 (0.782)
Ep: 81, Reward: 289.3454, Test: 258.9574 [158.73], Avg: 66.9911 (0.779)
Ep: 82, Reward: 236.4054, Test: 234.1113 [96.90], Avg: 67.8371 (0.777)
Ep: 83, Reward: 246.2562, Test: 212.7413 [97.63], Avg: 68.4000 (0.775)
Ep: 84, Reward: 204.9306, Test: 148.2261 [115.92], Avg: 67.9754 (0.772)
Ep: 85, Reward: 158.1764, Test: 120.6963 [84.96], Avg: 67.6005 (0.770)
Ep: 86, Reward: 231.1980, Test: 158.3065 [118.53], Avg: 67.2806 (0.768)
Ep: 87, Reward: 197.7995, Test: 209.9688 [50.49], Avg: 68.3283 (0.765)
Ep: 88, Reward: 227.1739, Test: 159.9586 [86.96], Avg: 68.3807 (0.763)
Ep: 89, Reward: 209.8979, Test: 162.7004 [108.63], Avg: 68.2217 (0.761)
Ep: 90, Reward: 255.1137, Test: 203.7963 [122.54], Avg: 68.3650 (0.758)
Ep: 91, Reward: 303.8579, Test: 233.8210 [143.95], Avg: 68.5987 (0.756)
Ep: 92, Reward: 243.3631, Test: 144.0231 [136.33], Avg: 67.9439 (0.754)
Ep: 93, Reward: 59.4374, Test: 82.0665 [116.88], Avg: 66.8507 (0.752)
Ep: 94, Reward: 52.5493, Test: 122.0944 [118.69], Avg: 66.1828 (0.749)
Ep: 95, Reward: 116.1108, Test: 102.4499 [118.45], Avg: 65.3268 (0.747)
Ep: 96, Reward: 89.4459, Test: 150.0018 [147.37], Avg: 64.6805 (0.745)
Ep: 97, Reward: 119.3359, Test: 27.5779 [74.59], Avg: 63.5408 (0.743)
Ep: 98, Reward: 44.5011, Test: -23.5385 [77.57], Avg: 61.8776 (0.740)
Ep: 99, Reward: 34.0224, Test: -39.6734 [37.88], Avg: 60.4833 (0.738)
Ep: 100, Reward: -58.9730, Test: -67.3860 [18.56], Avg: 59.0335 (0.736)
Ep: 101, Reward: -30.5141, Test: -46.7006 [65.01], Avg: 57.3595 (0.734)
Ep: 102, Reward: -38.9924, Test: -46.5861 [37.30], Avg: 55.9882 (0.732)
Ep: 103, Reward: -40.0163, Test: -40.6248 [55.05], Avg: 54.5300 (0.729)
Ep: 104, Reward: -30.1291, Test: -58.4638 [27.66], Avg: 53.1904 (0.727)
Ep: 105, Reward: -41.6069, Test: 5.0826 [94.60], Avg: 51.8441 (0.725)
Ep: 106, Reward: -31.9401, Test: -3.7408 [70.27], Avg: 50.6679 (0.723)
Ep: 107, Reward: -56.3007, Test: -50.4668 [54.31], Avg: 49.2286 (0.721)
Ep: 108, Reward: -43.3079, Test: -69.4629 [29.43], Avg: 47.8696 (0.719)
Ep: 109, Reward: -54.3535, Test: -79.2665 [4.33], Avg: 46.6745 (0.716)
Ep: 110, Reward: -69.8211, Test: -60.4205 [51.06], Avg: 45.2496 (0.714)
Ep: 111, Reward: -57.0704, Test: -69.3894 [36.69], Avg: 43.8985 (0.712)
Ep: 112, Reward: -79.4072, Test: -54.2295 [54.28], Avg: 42.5497 (0.710)
Ep: 113, Reward: -65.3238, Test: -79.5757 [5.49], Avg: 41.4302 (0.708)
Ep: 114, Reward: -62.8990, Test: -71.6413 [21.01], Avg: 40.2643 (0.706)
Ep: 115, Reward: -71.4252, Test: -75.4435 [17.31], Avg: 39.1176 (0.704)
Ep: 116, Reward: -44.6612, Test: -67.1906 [37.57], Avg: 37.8879 (0.702)
Ep: 117, Reward: -70.6538, Test: -64.2964 [44.56], Avg: 36.6443 (0.699)
Ep: 118, Reward: -65.6588, Test: -56.3790 [48.76], Avg: 35.4528 (0.697)
Ep: 119, Reward: -56.8843, Test: -67.3258 [32.11], Avg: 34.3288 (0.695)
Ep: 120, Reward: -64.4546, Test: -60.2860 [44.96], Avg: 33.1752 (0.693)
Ep: 121, Reward: -45.0291, Test: -11.2690 [52.33], Avg: 32.3819 (0.691)
Ep: 122, Reward: -53.1956, Test: -66.4580 [43.78], Avg: 31.2224 (0.689)
Ep: 123, Reward: -67.6031, Test: -57.2405 [37.05], Avg: 30.2102 (0.687)
Ep: 124, Reward: -59.1325, Test: -76.1582 [13.66], Avg: 29.2501 (0.685)
Ep: 125, Reward: -60.6227, Test: -72.6494 [19.62], Avg: 28.2856 (0.683)
Ep: 126, Reward: -63.3098, Test: -36.3077 [58.48], Avg: 27.3165 (0.681)
Ep: 127, Reward: -72.9356, Test: -75.6201 [19.29], Avg: 26.3616 (0.679)
Ep: 128, Reward: -81.0485, Test: -71.9293 [31.92], Avg: 25.3522 (0.677)
Ep: 129, Reward: -51.7554, Test: -48.6460 [48.81], Avg: 24.4076 (0.675)
Ep: 130, Reward: -75.3163, Test: -68.7049 [36.39], Avg: 23.4190 (0.673)
Ep: 131, Reward: -70.8101, Test: -79.2524 [6.54], Avg: 22.5917 (0.671)
Ep: 132, Reward: -72.5565, Test: -81.3112 [3.82], Avg: 21.7817 (0.669)
Ep: 133, Reward: -72.0499, Test: -81.6327 [2.00], Avg: 20.9951 (0.667)
Ep: 134, Reward: -68.3045, Test: -82.5786 [2.40], Avg: 20.2101 (0.665)
Ep: 135, Reward: -82.1562, Test: -80.0005 [7.11], Avg: 19.4209 (0.663)
Ep: 136, Reward: -77.8227, Test: -53.8734 [49.65], Avg: 18.5236 (0.661)
Ep: 137, Reward: -50.6503, Test: -71.4363 [27.37], Avg: 17.6734 (0.659)
Ep: 138, Reward: -71.7832, Test: -55.0176 [46.34], Avg: 16.8170 (0.657)
Ep: 139, Reward: -73.5110, Test: -65.2082 [39.25], Avg: 15.9508 (0.655)
Ep: 140, Reward: -72.0974, Test: -31.3122 [57.20], Avg: 15.2099 (0.653)
Ep: 141, Reward: -74.2218, Test: -68.9794 [27.58], Avg: 14.4228 (0.651)
Ep: 142, Reward: -64.6513, Test: -74.3434 [17.12], Avg: 13.6824 (0.649)
Ep: 143, Reward: -54.5383, Test: -60.7911 [40.37], Avg: 12.8849 (0.647)
Ep: 144, Reward: -67.4548, Test: -68.4647 [36.90], Avg: 12.0694 (0.645)
Ep: 145, Reward: -77.4520, Test: -54.5080 [43.93], Avg: 11.3125 (0.643)
Ep: 146, Reward: -70.0872, Test: -58.7269 [41.24], Avg: 10.5555 (0.641)
Ep: 147, Reward: -56.0601, Test: -53.0548 [52.44], Avg: 9.7713 (0.639)
Ep: 148, Reward: -62.4246, Test: -53.8681 [45.27], Avg: 9.0404 (0.637)
Ep: 149, Reward: -75.5900, Test: -65.7384 [37.32], Avg: 8.2931 (0.635)
Ep: 150, Reward: -80.3579, Test: -68.8761 [38.67], Avg: 7.5259 (0.633)
Ep: 151, Reward: -75.9284, Test: -64.8995 [41.45], Avg: 6.7767 (0.631)
Ep: 152, Reward: -57.7600, Test: -67.4048 [38.06], Avg: 6.0431 (0.630)
Ep: 153, Reward: -45.0143, Test: -20.9085 [66.10], Avg: 5.4389 (0.628)
Ep: 154, Reward: -48.4479, Test: -54.4554 [36.40], Avg: 4.8176 (0.626)
Ep: 155, Reward: -66.7475, Test: -64.5288 [35.79], Avg: 4.1437 (0.624)
Ep: 156, Reward: -47.7753, Test: -60.7130 [39.94], Avg: 3.4762 (0.622)
Ep: 157, Reward: -58.7639, Test: -12.1719 [67.75], Avg: 2.9484 (0.620)
Ep: 158, Reward: -61.7267, Test: -45.9037 [43.07], Avg: 2.3702 (0.618)
Ep: 159, Reward: -42.8156, Test: -42.5077 [53.94], Avg: 1.7526 (0.616)
Ep: 160, Reward: -32.2371, Test: -11.6773 [61.01], Avg: 1.2903 (0.615)
Ep: 161, Reward: -47.8717, Test: -70.5694 [13.07], Avg: 0.7660 (0.613)
Ep: 162, Reward: -54.9304, Test: -13.9444 [70.39], Avg: 0.2439 (0.611)
Ep: 163, Reward: -35.5520, Test: -30.3890 [52.27], Avg: -0.2615 (0.609)
Ep: 164, Reward: -53.8183, Test: -55.3401 [17.65], Avg: -0.7023 (0.607)
Ep: 165, Reward: -55.6139, Test: -35.2255 [32.71], Avg: -1.1073 (0.605)
Ep: 166, Reward: 3.8421, Test: -33.5374 [42.68], Avg: -1.5571 (0.602)
Ep: 167, Reward: -53.4785, Test: -25.2334 [45.51], Avg: -1.9690 (0.600)
Ep: 168, Reward: -55.7417, Test: -27.9534 [25.62], Avg: -2.2743 (0.598)
Ep: 169, Reward: -29.5901, Test: -25.9959 [38.01], Avg: -2.6375 (0.596)
Ep: 170, Reward: -36.1322, Test: -24.5290 [40.59], Avg: -3.0029 (0.595)
Ep: 171, Reward: -12.4663, Test: -55.8419 [16.88], Avg: -3.4082 (0.593)
Ep: 172, Reward: -56.5673, Test: 8.3432 [76.45], Avg: -3.7822 (0.591)
Ep: 173, Reward: -13.5156, Test: -32.1181 [33.18], Avg: -4.1358 (0.589)
Ep: 174, Reward: -17.6424, Test: 37.0759 [94.07], Avg: -4.4378 (0.588)
Ep: 175, Reward: 11.7972, Test: 50.5949 [102.78], Avg: -4.7091 (0.586)
Ep: 176, Reward: -2.7007, Test: 96.5959 [133.31], Avg: -4.8900 (0.584)
Ep: 177, Reward: 3.7403, Test: 102.2695 [137.20], Avg: -5.0587 (0.582)
Ep: 178, Reward: 63.0950, Test: 120.4388 [116.68], Avg: -5.0095 (0.581)
Ep: 179, Reward: 64.1764, Test: 164.0251 [104.68], Avg: -4.6519 (0.579)
Ep: 180, Reward: 32.0313, Test: 15.4884 [77.97], Avg: -4.9714 (0.577)
Ep: 181, Reward: 102.7214, Test: 17.4697 [91.40], Avg: -5.3503 (0.575)
Ep: 182, Reward: 72.1787, Test: 51.4509 [83.39], Avg: -5.4956 (0.574)
Ep: 183, Reward: 98.0711, Test: 104.0424 [133.22], Avg: -5.6243 (0.572)
Ep: 184, Reward: 63.0915, Test: 121.8811 [130.26], Avg: -5.6393 (0.570)
Ep: 185, Reward: 48.5309, Test: 195.2887 [84.23], Avg: -5.0118 (0.568)
Ep: 186, Reward: 131.2839, Test: 131.6723 [112.15], Avg: -4.8806 (0.567)
Ep: 187, Reward: 122.6130, Test: 173.2721 [100.84], Avg: -4.4694 (0.565)
Ep: 188, Reward: 195.1214, Test: 237.9123 [89.34], Avg: -3.6596 (0.563)
Ep: 189, Reward: 226.5971, Test: 164.7938 [125.81], Avg: -3.4352 (0.562)
Ep: 190, Reward: 292.0924, Test: 143.4735 [118.28], Avg: -3.2853 (0.560)
Ep: 191, Reward: 286.6761, Test: 255.1294 [90.57], Avg: -2.4111 (0.558)
Ep: 192, Reward: 228.6873, Test: 192.3798 [120.71], Avg: -2.0273 (0.557)
Ep: 193, Reward: 245.6572, Test: 226.6631 [68.74], Avg: -1.2028 (0.555)
Ep: 194, Reward: 287.4644, Test: 178.3211 [110.06], Avg: -0.8465 (0.553)
Ep: 195, Reward: 314.3840, Test: 203.3131 [71.30], Avg: -0.1687 (0.552)
Ep: 196, Reward: 301.5283, Test: 247.2822 [91.59], Avg: 0.6225 (0.550)
Ep: 197, Reward: 317.6097, Test: 230.1907 [106.20], Avg: 1.2456 (0.548)
Ep: 198, Reward: 365.3085, Test: 231.4849 [145.88], Avg: 1.6695 (0.547)
Ep: 199, Reward: 300.4092, Test: 262.7877 [113.89], Avg: 2.4056 (0.545)
Ep: 200, Reward: 256.0302, Test: 171.3647 [79.19], Avg: 2.8523 (0.543)
Ep: 201, Reward: 267.0511, Test: 197.0263 [119.99], Avg: 3.2195 (0.542)
Ep: 202, Reward: 320.2729, Test: 232.0914 [121.52], Avg: 3.7484 (0.540)
Ep: 203, Reward: 262.4751, Test: 156.2328 [120.43], Avg: 3.9055 (0.539)
Ep: 204, Reward: 288.2312, Test: 198.9230 [96.63], Avg: 4.3854 (0.537)
Ep: 205, Reward: 323.9079, Test: 187.3613 [89.01], Avg: 4.8416 (0.535)
Ep: 206, Reward: 232.5875, Test: 260.3710 [112.19], Avg: 5.5340 (0.534)
Ep: 207, Reward: 267.4514, Test: 188.9172 [95.41], Avg: 5.9570 (0.532)
Ep: 208, Reward: 259.5344, Test: 230.8565 [104.96], Avg: 6.5309 (0.530)
Ep: 209, Reward: 251.5671, Test: 156.0854 [135.72], Avg: 6.5968 (0.529)
Ep: 210, Reward: 291.6098, Test: 227.4618 [117.17], Avg: 7.0882 (0.526)
Ep: 211, Reward: 255.9545, Test: 212.3885 [89.38], Avg: 7.6351 (0.524)
Ep: 212, Reward: 270.2662, Test: 147.3482 [110.00], Avg: 7.7746 (0.523)
Ep: 213, Reward: 221.2079, Test: 211.0813 [73.29], Avg: 8.3821 (0.521)
Ep: 214, Reward: 225.1375, Test: 152.7251 [86.86], Avg: 8.6495 (0.519)
Ep: 215, Reward: 176.9039, Test: 103.1201 [108.71], Avg: 8.5836 (0.518)
Ep: 216, Reward: 203.8371, Test: 183.8731 [103.47], Avg: 8.9145 (0.516)
Ep: 217, Reward: 256.1737, Test: 175.2452 [111.22], Avg: 9.1673 (0.515)
Ep: 218, Reward: 149.3023, Test: 192.9996 [93.06], Avg: 9.5818 (0.513)
Ep: 219, Reward: 211.9859, Test: 171.8181 [92.48], Avg: 9.8989 (0.512)
Ep: 220, Reward: 213.3043, Test: 204.7662 [67.47], Avg: 10.4754 (0.510)
Ep: 221, Reward: 265.2413, Test: 191.7115 [102.50], Avg: 10.8301 (0.509)
Ep: 222, Reward: 196.2823, Test: 130.4701 [118.57], Avg: 10.8349 (0.507)
Ep: 223, Reward: 211.4907, Test: 171.7436 [87.98], Avg: 11.1604 (0.506)
Ep: 224, Reward: 207.6637, Test: 193.0215 [87.06], Avg: 11.5818 (0.504)
Ep: 225, Reward: 136.7233, Test: 188.3118 [51.54], Avg: 12.1357 (0.503)
Ep: 226, Reward: 184.3983, Test: 154.4723 [118.94], Avg: 12.2387 (0.501)
Ep: 227, Reward: 196.0870, Test: 177.1359 [108.22], Avg: 12.4873 (0.500)
Ep: 228, Reward: 225.9062, Test: 155.9681 [110.38], Avg: 12.6319 (0.498)
Ep: 229, Reward: 212.4631, Test: 202.4125 [101.21], Avg: 13.0170 (0.497)
Ep: 230, Reward: 210.3894, Test: 265.4198 [59.29], Avg: 13.8530 (0.495)
Ep: 231, Reward: 248.0264, Test: 125.1207 [112.35], Avg: 13.8483 (0.494)
Ep: 232, Reward: 242.2905, Test: 259.6996 [103.78], Avg: 14.4580 (0.492)
Ep: 233, Reward: 306.2923, Test: 205.9194 [127.76], Avg: 14.7303 (0.491)
Ep: 234, Reward: 254.4574, Test: 207.5210 [129.45], Avg: 14.9998 (0.489)
Ep: 235, Reward: 330.9930, Test: 238.6962 [84.56], Avg: 15.5893 (0.488)
Ep: 236, Reward: 218.5257, Test: 221.4398 [131.75], Avg: 15.9020 (0.486)
Ep: 237, Reward: 262.3417, Test: 254.6373 [46.20], Avg: 16.7109 (0.485)
Ep: 238, Reward: 264.6903, Test: 185.4280 [137.51], Avg: 16.8415 (0.483)
Ep: 239, Reward: 240.7248, Test: 223.6510 [115.85], Avg: 17.2205 (0.482)
Ep: 240, Reward: 231.8372, Test: 200.3539 [102.98], Avg: 17.5531 (0.480)
Ep: 241, Reward: 275.1867, Test: 230.9223 [97.72], Avg: 18.0309 (0.479)
Ep: 242, Reward: 269.3525, Test: 209.2635 [120.49], Avg: 18.3221 (0.478)
Ep: 243, Reward: 199.9431, Test: 137.7744 [128.90], Avg: 18.2833 (0.476)
Ep: 244, Reward: 238.0994, Test: 248.0998 [57.27], Avg: 18.9876 (0.475)
Ep: 245, Reward: 222.7571, Test: 154.0752 [91.01], Avg: 19.1668 (0.473)
Ep: 246, Reward: 201.9313, Test: 226.1159 [109.24], Avg: 19.5624 (0.472)
Ep: 247, Reward: 247.3610, Test: 252.9811 [49.64], Avg: 20.3034 (0.470)
Ep: 248, Reward: 261.6956, Test: 171.3272 [128.30], Avg: 20.3947 (0.469)
Ep: 249, Reward: 233.4509, Test: 184.0458 [121.43], Avg: 20.5636 (0.468)
Ep: 250, Reward: 244.2831, Test: 171.0980 [128.01], Avg: 20.6533 (0.466)
Ep: 251, Reward: 205.6960, Test: 212.2252 [119.71], Avg: 20.9384 (0.465)
Ep: 252, Reward: 281.9207, Test: 203.9062 [124.55], Avg: 21.1693 (0.463)
Ep: 253, Reward: 214.0818, Test: 228.2324 [93.21], Avg: 21.6176 (0.462)
Ep: 254, Reward: 195.0782, Test: 248.7843 [121.47], Avg: 22.0321 (0.459)
Ep: 255, Reward: 241.5411, Test: 209.9480 [86.78], Avg: 22.4271 (0.458)
Ep: 256, Reward: 194.8002, Test: 236.0244 [45.79], Avg: 23.0801 (0.456)
Ep: 257, Reward: 268.8176, Test: 200.3030 [138.12], Avg: 23.2316 (0.455)
Ep: 258, Reward: 241.0789, Test: 235.9706 [100.71], Avg: 23.6642 (0.454)
Ep: 259, Reward: 250.9715, Test: 232.2158 [105.27], Avg: 24.0614 (0.452)
Ep: 260, Reward: 269.1999, Test: 266.7533 [77.58], Avg: 24.6940 (0.451)
Ep: 261, Reward: 288.5802, Test: 304.0196 [166.72], Avg: 25.1238 (0.450)
Ep: 262, Reward: 289.0210, Test: 199.3252 [125.14], Avg: 25.3104 (0.448)
Ep: 263, Reward: 301.9915, Test: 230.0944 [87.91], Avg: 25.7531 (0.447)
Ep: 264, Reward: 277.5759, Test: 268.6576 [152.00], Avg: 26.0961 (0.446)
Ep: 265, Reward: 327.0086, Test: 351.2213 [151.78], Avg: 26.7478 (0.444)
Ep: 266, Reward: 309.6116, Test: 360.8297 [176.84], Avg: 27.3367 (0.443)
Ep: 267, Reward: 365.6380, Test: 468.5918 [182.33], Avg: 28.3029 (0.442)
Ep: 268, Reward: 431.3970, Test: 255.8682 [174.91], Avg: 28.4986 (0.440)
Ep: 269, Reward: 444.7748, Test: 340.5367 [200.08], Avg: 28.9133 (0.439)
Ep: 270, Reward: 536.0020, Test: 332.1595 [179.62], Avg: 29.3695 (0.438)
Ep: 271, Reward: 494.0841, Test: 583.9220 [233.54], Avg: 30.5497 (0.436)
Ep: 272, Reward: 587.2094, Test: 479.9229 [180.08], Avg: 31.5361 (0.435)
Ep: 273, Reward: 670.9931, Test: 454.8110 [244.61], Avg: 32.1881 (0.434)
Ep: 274, Reward: 535.8525, Test: 419.0762 [204.01], Avg: 32.8531 (0.432)
Ep: 275, Reward: 537.8576, Test: 479.6260 [205.24], Avg: 33.7283 (0.431)
Ep: 276, Reward: 492.3430, Test: 488.6585 [246.07], Avg: 34.4823 (0.430)
Ep: 277, Reward: 466.9243, Test: 474.0716 [268.76], Avg: 35.0968 (0.429)
Ep: 278, Reward: 568.7318, Test: 520.0382 [246.88], Avg: 35.9500 (0.427)
Ep: 279, Reward: 434.2338, Test: 453.7234 [285.96], Avg: 36.4208 (0.426)
Ep: 280, Reward: 456.8058, Test: 326.9646 [178.89], Avg: 36.8181 (0.425)
Ep: 281, Reward: 543.4696, Test: 486.9849 [231.31], Avg: 37.5942 (0.423)
Ep: 282, Reward: 494.6629, Test: 560.5360 [220.40], Avg: 38.6633 (0.422)
Ep: 283, Reward: 591.0231, Test: 553.2595 [272.08], Avg: 39.5172 (0.421)
Ep: 284, Reward: 594.7158, Test: 453.1863 [213.76], Avg: 40.2186 (0.420)
Ep: 285, Reward: 531.8379, Test: 590.1048 [219.93], Avg: 41.3723 (0.418)
Ep: 286, Reward: 452.2954, Test: 667.3988 [216.17], Avg: 42.8004 (0.417)
Ep: 287, Reward: 379.6562, Test: 513.8739 [223.79], Avg: 43.6590 (0.416)
Ep: 288, Reward: 553.9182, Test: 562.3275 [276.88], Avg: 44.4957 (0.415)
Ep: 289, Reward: 516.3048, Test: 467.2002 [233.00], Avg: 45.1498 (0.413)
Ep: 290, Reward: 511.4839, Test: 484.8426 [259.30], Avg: 45.7697 (0.412)
Ep: 291, Reward: 510.4681, Test: 431.8366 [207.67], Avg: 46.3807 (0.411)
Ep: 292, Reward: 558.5675, Test: 513.2899 [187.17], Avg: 47.3355 (0.410)
Ep: 293, Reward: 589.6135, Test: 658.5736 [272.43], Avg: 48.4879 (0.408)
Ep: 294, Reward: 485.6876, Test: 704.1307 [151.36], Avg: 50.1973 (0.407)
Ep: 295, Reward: 565.2740, Test: 551.2972 [253.85], Avg: 51.0326 (0.406)
Ep: 296, Reward: 504.7755, Test: 519.3846 [269.62], Avg: 51.7017 (0.405)
Ep: 297, Reward: 522.1646, Test: 337.1513 [251.66], Avg: 51.8152 (0.404)
Ep: 298, Reward: 362.7006, Test: 158.5479 [207.66], Avg: 51.4776 (0.402)
Ep: 299, Reward: 288.4055, Test: 148.4175 [178.40], Avg: 51.2061 (0.401)
Ep: 300, Reward: 318.7946, Test: 204.7705 [200.65], Avg: 51.0497 (0.400)
Ep: 301, Reward: 390.1508, Test: 180.3333 [176.08], Avg: 50.8947 (0.399)
Ep: 302, Reward: 300.4423, Test: 229.8691 [215.76], Avg: 50.7733 (0.398)
Ep: 303, Reward: 47.5366, Test: -13.9763 [68.96], Avg: 50.3335 (0.396)
Ep: 304, Reward: 43.5500, Test: -31.9651 [46.71], Avg: 49.9105 (0.395)
Ep: 305, Reward: 16.1605, Test: 3.3791 [90.45], Avg: 49.4628 (0.394)
Ep: 306, Reward: -17.8245, Test: -10.1276 [69.02], Avg: 49.0439 (0.393)
Ep: 307, Reward: 12.6031, Test: -40.5221 [61.68], Avg: 48.5528 (0.392)
Ep: 308, Reward: 10.5091, Test: -45.9556 [20.11], Avg: 48.1819 (0.390)
Ep: 309, Reward: -1.7417, Test: 2.3387 [41.60], Avg: 47.8998 (0.388)
Ep: 310, Reward: 80.2773, Test: 77.4356 [132.15], Avg: 47.5699 (0.387)
Ep: 311, Reward: 120.2363, Test: 27.4322 [55.15], Avg: 47.3286 (0.386)
Ep: 312, Reward: 65.0666, Test: 32.2917 [90.63], Avg: 46.9910 (0.385)
Ep: 313, Reward: 83.8330, Test: 160.6375 [125.02], Avg: 46.9547 (0.383)
Ep: 314, Reward: 166.9623, Test: 181.7918 [132.95], Avg: 46.9608 (0.382)
Ep: 315, Reward: 166.3507, Test: 192.4382 [109.92], Avg: 47.0733 (0.381)
Ep: 316, Reward: 226.7577, Test: 124.3477 [109.04], Avg: 46.9731 (0.380)
Ep: 317, Reward: 245.6596, Test: 298.1021 [119.06], Avg: 47.3884 (0.379)
Ep: 318, Reward: 355.1278, Test: 429.3200 [115.15], Avg: 48.2247 (0.378)
Ep: 319, Reward: 426.0334, Test: 465.8200 [160.72], Avg: 49.0274 (0.377)
Ep: 320, Reward: 416.7970, Test: 433.7065 [116.77], Avg: 49.8620 (0.376)
Ep: 321, Reward: 429.0252, Test: 501.2369 [139.81], Avg: 50.8296 (0.374)
Ep: 322, Reward: 422.2183, Test: 603.2928 [147.54], Avg: 52.0833 (0.373)
Ep: 323, Reward: 442.5795, Test: 501.2139 [207.50], Avg: 52.8291 (0.372)
Ep: 324, Reward: 454.8459, Test: 430.2465 [166.58], Avg: 53.4778 (0.371)
Ep: 325, Reward: 525.2612, Test: 467.6417 [220.63], Avg: 54.0714 (0.370)
Ep: 326, Reward: 499.8628, Test: 434.8315 [168.60], Avg: 54.7202 (0.369)
Ep: 327, Reward: 371.9212, Test: 411.2285 [254.12], Avg: 55.0324 (0.368)
Ep: 328, Reward: 499.9115, Test: 352.5981 [150.45], Avg: 55.4796 (0.367)
Ep: 329, Reward: 411.8524, Test: 391.2274 [173.47], Avg: 55.9713 (0.365)
Ep: 330, Reward: 456.0915, Test: 513.7815 [158.31], Avg: 56.8761 (0.364)
Ep: 331, Reward: 361.3252, Test: 303.7419 [121.20], Avg: 57.2547 (0.363)
Ep: 332, Reward: 366.8302, Test: 113.6717 [132.92], Avg: 57.0249 (0.362)
Ep: 333, Reward: 314.1457, Test: 276.6215 [178.98], Avg: 57.1465 (0.361)
Ep: 334, Reward: 175.9830, Test: 183.3919 [148.58], Avg: 57.0799 (0.360)
Ep: 335, Reward: 367.5097, Test: 187.0921 [187.25], Avg: 56.9095 (0.359)
Ep: 336, Reward: 241.8963, Test: 261.2023 [182.35], Avg: 56.9746 (0.358)
Ep: 337, Reward: 258.2547, Test: 294.8608 [180.81], Avg: 57.1435 (0.357)
Ep: 338, Reward: 333.6519, Test: 268.1537 [179.18], Avg: 57.2374 (0.356)
Ep: 339, Reward: 358.0182, Test: 254.1906 [146.79], Avg: 57.3849 (0.355)
Ep: 340, Reward: 221.8934, Test: 218.7308 [170.45], Avg: 57.3582 (0.354)
Ep: 341, Reward: 362.8035, Test: 310.0165 [158.53], Avg: 57.6335 (0.353)
Ep: 342, Reward: 381.7152, Test: 313.1003 [233.77], Avg: 57.6967 (0.351)
Ep: 343, Reward: 434.7741, Test: 430.8728 [133.60], Avg: 58.3932 (0.350)
Ep: 344, Reward: 417.6318, Test: 345.4696 [137.91], Avg: 58.8255 (0.349)
Ep: 345, Reward: 399.4572, Test: 350.5485 [189.57], Avg: 59.1208 (0.348)
Ep: 346, Reward: 308.4871, Test: 309.9324 [144.22], Avg: 59.4280 (0.347)
Ep: 347, Reward: 369.6553, Test: 385.9087 [137.38], Avg: 59.9714 (0.346)
Ep: 348, Reward: 390.4859, Test: 272.2918 [167.13], Avg: 60.1009 (0.345)
Ep: 349, Reward: 427.9216, Test: 317.5597 [140.67], Avg: 60.4345 (0.344)
Ep: 350, Reward: 336.8717, Test: 448.7222 [219.13], Avg: 60.9165 (0.343)
Ep: 351, Reward: 325.1208, Test: 393.8068 [134.40], Avg: 61.4804 (0.342)
Ep: 352, Reward: 256.3157, Test: 372.1766 [197.49], Avg: 61.8011 (0.341)
Ep: 353, Reward: 359.1062, Test: 394.1362 [193.76], Avg: 62.1925 (0.340)
Ep: 354, Reward: 389.6327, Test: 371.3372 [217.45], Avg: 62.4508 (0.339)
Ep: 355, Reward: 302.0418, Test: 209.8586 [109.64], Avg: 62.5569 (0.338)
Ep: 356, Reward: 335.1916, Test: 274.0392 [178.96], Avg: 62.6480 (0.337)
Ep: 357, Reward: 303.8500, Test: 301.9573 [124.45], Avg: 62.9688 (0.336)
Ep: 358, Reward: 283.7318, Test: 297.2799 [156.90], Avg: 63.1845 (0.335)
Ep: 359, Reward: 170.6081, Test: 159.3671 [141.44], Avg: 63.0588 (0.334)
Ep: 360, Reward: 156.5040, Test: 122.9154 [106.90], Avg: 62.9284 (0.333)
Ep: 361, Reward: 141.1628, Test: 218.1541 [65.24], Avg: 63.1770 (0.332)
Ep: 362, Reward: 145.7132, Test: 156.3514 [108.83], Avg: 63.1339 (0.331)
Ep: 363, Reward: 191.3038, Test: 198.4030 [63.80], Avg: 63.3303 (0.330)
Ep: 364, Reward: 135.3650, Test: 141.8350 [116.27], Avg: 63.2268 (0.329)
Ep: 365, Reward: 178.6932, Test: 180.6474 [119.57], Avg: 63.2209 (0.328)
Ep: 366, Reward: 242.9922, Test: 262.3531 [141.23], Avg: 63.3787 (0.327)
Ep: 367, Reward: 402.5812, Test: 422.7278 [153.06], Avg: 63.9392 (0.326)
Ep: 368, Reward: 306.8720, Test: 325.6450 [157.92], Avg: 64.2205 (0.325)
Ep: 369, Reward: 276.6925, Test: 276.7954 [139.14], Avg: 64.4189 (0.324)
Ep: 370, Reward: 345.6805, Test: 276.0537 [192.56], Avg: 64.4703 (0.323)
Ep: 371, Reward: 352.8593, Test: 352.4385 [170.36], Avg: 64.7865 (0.322)
Ep: 372, Reward: 338.8945, Test: 330.0863 [202.29], Avg: 64.9554 (0.321)
Ep: 373, Reward: 290.8650, Test: 268.1081 [152.22], Avg: 65.0916 (0.320)
Ep: 374, Reward: 329.1314, Test: 335.1019 [122.79], Avg: 65.4842 (0.319)
Ep: 375, Reward: 312.9584, Test: 358.9181 [144.52], Avg: 65.8803 (0.318)
Ep: 376, Reward: 253.5471, Test: 277.3823 [194.93], Avg: 65.9242 (0.317)
Ep: 377, Reward: 301.1164, Test: 234.4486 [196.96], Avg: 65.8490 (0.316)
Ep: 378, Reward: 238.2201, Test: 335.2859 [137.21], Avg: 66.1979 (0.315)
Ep: 379, Reward: 347.3773, Test: 237.0462 [114.69], Avg: 66.3457 (0.315)
Ep: 380, Reward: 247.0730, Test: 179.3609 [122.35], Avg: 66.3212 (0.314)
Ep: 381, Reward: 90.1285, Test: 134.1323 [88.96], Avg: 66.2658 (0.313)
Ep: 382, Reward: 136.0898, Test: 94.5432 [139.00], Avg: 65.9767 (0.312)
Ep: 383, Reward: 84.1358, Test: 167.5023 [135.17], Avg: 65.8891 (0.311)
Ep: 384, Reward: 126.4741, Test: 254.2470 [153.32], Avg: 65.9801 (0.310)
Ep: 385, Reward: 231.6488, Test: 154.9467 [195.70], Avg: 65.7036 (0.309)
Ep: 386, Reward: 292.0869, Test: 157.2538 [177.89], Avg: 65.4805 (0.308)
Ep: 387, Reward: 131.1680, Test: 18.1725 [145.94], Avg: 64.9824 (0.307)
Ep: 388, Reward: 63.5372, Test: 54.3084 [147.11], Avg: 64.5768 (0.306)
Ep: 389, Reward: 130.0593, Test: -63.8579 [41.34], Avg: 64.1415 (0.305)
Ep: 390, Reward: -13.2667, Test: -1.8368 [110.18], Avg: 63.6909 (0.304)
Ep: 391, Reward: 25.7027, Test: -33.7878 [43.78], Avg: 63.3306 (0.303)
Ep: 392, Reward: 5.3463, Test: 89.0368 [115.74], Avg: 63.1015 (0.302)
Ep: 393, Reward: 31.0445, Test: 102.9070 [168.95], Avg: 62.7737 (0.302)
Ep: 394, Reward: 63.2737, Test: 63.9526 [49.66], Avg: 62.6510 (0.301)
Ep: 395, Reward: 55.2009, Test: 128.9659 [130.72], Avg: 62.4884 (0.300)
Ep: 396, Reward: 76.9460, Test: 35.8350 [68.79], Avg: 62.2479 (0.299)
Ep: 397, Reward: 55.2588, Test: -26.2589 [67.02], Avg: 61.8572 (0.298)
Ep: 398, Reward: 52.1727, Test: 58.8263 [59.88], Avg: 61.6995 (0.297)
Ep: 399, Reward: 84.2157, Test: -43.2088 [62.83], Avg: 61.2802 (0.296)
Ep: 400, Reward: 17.7822, Test: -78.9704 [74.81], Avg: 60.7438 (0.295)
Ep: 401, Reward: -6.4176, Test: -9.6837 [60.28], Avg: 60.4187 (0.294)
Ep: 402, Reward: -16.4026, Test: -99.3980 [41.85], Avg: 59.9183 (0.294)
Ep: 403, Reward: -52.3638, Test: -74.0212 [71.12], Avg: 59.4107 (0.293)
Ep: 404, Reward: -45.6584, Test: -77.2523 [50.91], Avg: 58.9476 (0.292)
Ep: 405, Reward: -70.2704, Test: -88.3510 [25.29], Avg: 58.5225 (0.291)
Ep: 406, Reward: -65.0770, Test: -107.3186 [29.32], Avg: 58.0429 (0.290)
Ep: 407, Reward: -77.2319, Test: -46.6537 [54.67], Avg: 57.6524 (0.289)
Ep: 408, Reward: -66.5717, Test: -96.2352 [38.10], Avg: 57.1830 (0.288)
Ep: 409, Reward: -83.3501, Test: -94.2893 [36.87], Avg: 56.7236 (0.287)
Ep: 410, Reward: -69.9094, Test: -75.4334 [64.32], Avg: 56.2455 (0.287)
Ep: 411, Reward: -46.3772, Test: -59.7185 [46.46], Avg: 55.8513 (0.286)
Ep: 412, Reward: -26.7220, Test: 16.6687 [71.38], Avg: 55.5836 (0.285)
Ep: 413, Reward: 59.1848, Test: 3.9425 [80.01], Avg: 55.2656 (0.284)
Ep: 414, Reward: 61.4889, Test: 45.7122 [55.78], Avg: 55.1082 (0.283)
Ep: 415, Reward: 9.5061, Test: -0.6946 [76.33], Avg: 54.7905 (0.282)
Ep: 416, Reward: 2.4228, Test: -52.0481 [66.43], Avg: 54.3750 (0.281)
Ep: 417, Reward: -36.6080, Test: -40.0876 [73.64], Avg: 53.9729 (0.281)
Ep: 418, Reward: -17.9779, Test: -2.1984 [94.74], Avg: 53.6127 (0.280)
Ep: 419, Reward: -42.6868, Test: -68.5606 [68.79], Avg: 53.1580 (0.279)
Ep: 420, Reward: -43.6696, Test: -52.6243 [70.58], Avg: 52.7391 (0.278)
Ep: 421, Reward: -58.9838, Test: -74.0549 [79.16], Avg: 52.2511 (0.277)
Ep: 422, Reward: -61.1171, Test: -7.8205 [82.24], Avg: 51.9146 (0.276)
Ep: 423, Reward: -34.6990, Test: -52.6109 [54.20], Avg: 51.5403 (0.276)
Ep: 424, Reward: -48.8593, Test: -72.4652 [60.49], Avg: 51.1062 (0.275)
Ep: 425, Reward: -27.8231, Test: -69.3571 [62.83], Avg: 50.6759 (0.274)
Ep: 426, Reward: -24.9933, Test: -91.5290 [58.47], Avg: 50.2059 (0.273)
Ep: 427, Reward: -47.3102, Test: -76.3523 [41.86], Avg: 49.8124 (0.272)
Ep: 428, Reward: -60.5980, Test: -105.0312 [36.42], Avg: 49.3666 (0.271)
Ep: 429, Reward: -87.3164, Test: -109.7187 [36.79], Avg: 48.9111 (0.271)
Ep: 430, Reward: -80.4425, Test: -108.0092 [33.78], Avg: 48.4686 (0.270)
Ep: 431, Reward: -62.5534, Test: -45.1289 [35.49], Avg: 48.1698 (0.269)
Ep: 432, Reward: -68.4345, Test: -99.3643 [42.85], Avg: 47.7301 (0.268)
Ep: 433, Reward: -75.4724, Test: -88.6911 [40.89], Avg: 47.3215 (0.267)
Ep: 434, Reward: -80.9159, Test: -89.2487 [50.58], Avg: 46.8913 (0.267)
Ep: 435, Reward: -57.6363, Test: -80.5452 [42.83], Avg: 46.5008 (0.266)
Ep: 436, Reward: -71.0576, Test: -74.1983 [42.08], Avg: 46.1283 (0.265)
Ep: 437, Reward: -56.3176, Test: -41.3836 [30.70], Avg: 45.8584 (0.264)
Ep: 438, Reward: -30.1852, Test: -40.9269 [30.86], Avg: 45.5904 (0.263)
Ep: 439, Reward: -49.1609, Test: -69.7923 [41.16], Avg: 45.2346 (0.263)
Ep: 440, Reward: -24.3771, Test: -29.6654 [24.64], Avg: 45.0089 (0.262)
Ep: 441, Reward: -30.0463, Test: -53.7593 [26.13], Avg: 44.7263 (0.261)
Ep: 442, Reward: -20.6916, Test: -39.6122 [38.48], Avg: 44.4491 (0.260)
Ep: 443, Reward: -27.4513, Test: -28.1721 [14.43], Avg: 44.2530 (0.259)
Ep: 444, Reward: -25.1098, Test: -46.5537 [44.62], Avg: 43.9487 (0.259)
Ep: 445, Reward: -32.2477, Test: -53.3945 [42.80], Avg: 43.6345 (0.258)
Ep: 446, Reward: -36.1187, Test: -20.7747 [4.55], Avg: 43.4802 (0.257)
Ep: 447, Reward: -25.7546, Test: -21.2677 [15.78], Avg: 43.3004 (0.256)
Ep: 448, Reward: -32.8535, Test: -14.8634 [18.17], Avg: 43.1304 (0.256)
Ep: 449, Reward: -45.3054, Test: -45.9041 [49.68], Avg: 42.8222 (0.255)
Ep: 450, Reward: -42.7732, Test: -34.1390 [31.87], Avg: 42.5809 (0.254)
Ep: 451, Reward: -26.8153, Test: -50.0584 [44.41], Avg: 42.2777 (0.253)
Ep: 452, Reward: -28.2373, Test: -30.1350 [33.31], Avg: 42.0443 (0.253)
Ep: 453, Reward: -6.6772, Test: -35.1055 [30.35], Avg: 41.8075 (0.252)
Ep: 454, Reward: -28.3378, Test: -20.4697 [13.48], Avg: 41.6410 (0.251)
Ep: 455, Reward: -21.1598, Test: -26.3443 [10.73], Avg: 41.4684 (0.250)
Ep: 456, Reward: -9.1463, Test: -30.0658 [6.73], Avg: 41.2971 (0.250)
Ep: 457, Reward: -7.9721, Test: -17.7945 [21.05], Avg: 41.1222 (0.249)
Ep: 458, Reward: -17.8365, Test: -38.3443 [28.83], Avg: 40.8862 (0.248)
Ep: 459, Reward: -19.2686, Test: -5.4130 [39.06], Avg: 40.7007 (0.247)
Ep: 460, Reward: -17.1227, Test: -29.0598 [5.84], Avg: 40.5367 (0.247)
Ep: 461, Reward: -19.8997, Test: -29.6037 [8.18], Avg: 40.3672 (0.246)
Ep: 462, Reward: -23.0512, Test: -20.3969 [12.64], Avg: 40.2086 (0.245)
Ep: 463, Reward: -33.4985, Test: -29.1493 [31.98], Avg: 39.9902 (0.244)
Ep: 464, Reward: -28.1140, Test: -4.2245 [29.80], Avg: 39.8310 (0.244)
Ep: 465, Reward: -18.8959, Test: -12.9902 [27.06], Avg: 39.6596 (0.243)
Ep: 466, Reward: -40.5914, Test: -12.9350 [23.61], Avg: 39.4964 (0.242)
Ep: 467, Reward: -26.9638, Test: -47.3773 [43.67], Avg: 39.2175 (0.241)
Ep: 468, Reward: -26.4416, Test: -19.3316 [48.21], Avg: 38.9899 (0.241)
Ep: 469, Reward: -15.6805, Test: -44.6975 [50.61], Avg: 38.7041 (0.240)
Ep: 470, Reward: -36.4883, Test: -46.3284 [55.22], Avg: 38.4064 (0.239)
Ep: 471, Reward: -6.1126, Test: -23.9859 [57.86], Avg: 38.1516 (0.239)
Ep: 472, Reward: -31.5597, Test: -41.3567 [79.91], Avg: 37.8146 (0.238)
Ep: 473, Reward: -25.0237, Test: -29.3951 [29.39], Avg: 37.6108 (0.237)
Ep: 474, Reward: -15.2264, Test: -10.2895 [25.62], Avg: 37.4560 (0.236)
Ep: 475, Reward: -19.6952, Test: -24.4098 [19.84], Avg: 37.2843 (0.236)
Ep: 476, Reward: -17.6567, Test: -30.8872 [34.46], Avg: 37.0692 (0.235)
Ep: 477, Reward: -4.9764, Test: -20.7121 [10.49], Avg: 36.9263 (0.234)
Ep: 478, Reward: -17.3740, Test: -26.7413 [5.16], Avg: 36.7826 (0.234)
Ep: 479, Reward: -16.0890, Test: -25.2680 [3.89], Avg: 36.6453 (0.233)
Ep: 480, Reward: -1.4083, Test: -42.3045 [40.86], Avg: 36.3962 (0.232)
Ep: 481, Reward: -22.8409, Test: -33.1890 [30.98], Avg: 36.1875 (0.231)
Ep: 482, Reward: -6.1528, Test: -29.2434 [32.16], Avg: 35.9855 (0.231)
Ep: 483, Reward: -8.3531, Test: -29.0961 [17.59], Avg: 35.8147 (0.230)
Ep: 484, Reward: -6.6452, Test: -16.6137 [9.54], Avg: 35.6869 (0.229)
Ep: 485, Reward: -23.6556, Test: -25.5476 [4.08], Avg: 35.5525 (0.229)
Ep: 486, Reward: -21.1403, Test: -34.4259 [10.26], Avg: 35.3878 (0.228)
Ep: 487, Reward: -20.1988, Test: -32.5364 [13.81], Avg: 35.2203 (0.227)
Ep: 488, Reward: -23.1149, Test: -27.3588 [7.32], Avg: 35.0774 (0.227)
Ep: 489, Reward: -14.6902, Test: -23.9429 [6.48], Avg: 34.9437 (0.226)
Ep: 490, Reward: -23.0534, Test: -33.3630 [31.46], Avg: 34.7405 (0.225)
Ep: 491, Reward: -17.8594, Test: -24.1791 [7.57], Avg: 34.6053 (0.225)
Ep: 492, Reward: -10.6410, Test: -20.9433 [6.67], Avg: 34.4791 (0.224)
Ep: 493, Reward: -12.7400, Test: -40.8463 [40.89], Avg: 34.2439 (0.223)
Ep: 494, Reward: -16.9451, Test: -21.9015 [9.00], Avg: 34.1123 (0.223)
Ep: 495, Reward: -15.0979, Test: -26.2037 [5.67], Avg: 33.9793 (0.222)
Ep: 496, Reward: -26.0590, Test: -22.7913 [9.89], Avg: 33.8451 (0.221)
Ep: 497, Reward: -23.2896, Test: -37.3471 [31.98], Avg: 33.6380 (0.221)
Ep: 498, Reward: -13.4611, Test: -27.8308 [2.43], Avg: 33.5099 (0.220)
Ep: 499, Reward: -21.2607, Test: -19.3680 [14.31], Avg: 33.3755 (0.219)
