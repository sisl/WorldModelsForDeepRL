Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.100                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 16					# Number of samples to train on for each train step
PPO_EPOCHS = 1					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.02				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range(PPO_EPOCHS):
				for i in range(0, len(self.replay_buffer), BATCH_SIZE):
					state, action, log_prob, target, advantage = self.replay_buffer.index(BATCH_SIZE, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -25.2268, Test: -20.7222 [8.26], Avg: -28.9775 (0.997)
Ep: 1, Reward: -22.4787, Test: -19.4190 [28.57], Avg: -38.4857 (0.994)
Ep: 2, Reward: -36.3404, Test: -40.3306 [35.36], Avg: -50.8858 (0.991)
Ep: 3, Reward: -15.0022, Test: -23.5617 [36.39], Avg: -53.1529 (0.988)
Ep: 4, Reward: 47.9035, Test: 61.9650 [95.66], Avg: -49.2619 (0.985)
Ep: 5, Reward: 241.2731, Test: 418.0811 [253.01], Avg: -13.5405 (0.982)
Ep: 6, Reward: 567.1994, Test: 451.4368 [289.98], Avg: 11.4597 (0.979)
Ep: 7, Reward: 453.7850, Test: 618.2131 [222.52], Avg: 59.4883 (0.976)
Ep: 8, Reward: 627.5733, Test: 499.4899 [308.02], Avg: 74.1525 (0.973)
Ep: 9, Reward: 609.0942, Test: 749.0360 [166.41], Avg: 125.0000 (0.970)
Ep: 10, Reward: 655.6154, Test: 649.4087 [274.08], Avg: 147.7569 (0.967)
Ep: 11, Reward: 692.8700, Test: 537.9765 [298.21], Avg: 155.4243 (0.965)
Ep: 12, Reward: 689.1065, Test: 589.7283 [235.06], Avg: 170.7511 (0.962)
Ep: 13, Reward: 728.7768, Test: 774.8063 [163.33], Avg: 202.2312 (0.959)
Ep: 14, Reward: 778.4453, Test: 494.0149 [308.90], Avg: 201.0898 (0.956)
Ep: 15, Reward: 432.9345, Test: 695.8129 [190.97], Avg: 220.0743 (0.953)
Ep: 16, Reward: 676.1361, Test: 569.5182 [220.82], Avg: 227.6402 (0.950)
Ep: 17, Reward: 532.6515, Test: 463.7707 [183.41], Avg: 230.5694 (0.947)
Ep: 18, Reward: 553.5828, Test: 681.3881 [199.42], Avg: 243.8010 (0.945)
Ep: 19, Reward: 644.6922, Test: 473.6722 [191.78], Avg: 245.7054 (0.942)
Ep: 20, Reward: 567.3327, Test: 651.4718 [230.70], Avg: 254.0420 (0.939)
Ep: 21, Reward: 587.5176, Test: 745.8939 [174.90], Avg: 268.4487 (0.936)
Ep: 22, Reward: 607.0993, Test: 656.6460 [182.98], Avg: 277.3713 (0.933)
Ep: 23, Reward: 496.2401, Test: 560.7265 [199.76], Avg: 280.8543 (0.930)
Ep: 24, Reward: 413.2736, Test: 531.5328 [169.98], Avg: 284.0822 (0.928)
Ep: 25, Reward: 521.8898, Test: 388.4068 [124.79], Avg: 283.2951 (0.925)
Ep: 26, Reward: 451.8646, Test: 444.8208 [214.08], Avg: 281.3488 (0.922)
Ep: 27, Reward: 442.6608, Test: 347.0264 [88.85], Avg: 280.5211 (0.919)
Ep: 28, Reward: 568.5279, Test: 526.5380 [217.47], Avg: 281.5055 (0.917)
Ep: 29, Reward: 546.3030, Test: 663.5583 [155.86], Avg: 289.0453 (0.914)
Ep: 30, Reward: 665.8396, Test: 610.6424 [168.89], Avg: 293.9713 (0.911)
Ep: 31, Reward: 583.6668, Test: 557.1570 [177.13], Avg: 296.6604 (0.908)
Ep: 32, Reward: 518.4076, Test: 488.8491 [185.50], Avg: 296.8631 (0.906)
Ep: 33, Reward: 587.1253, Test: 493.7998 [219.32], Avg: 296.2049 (0.903)
Ep: 34, Reward: 516.3326, Test: 399.8385 [218.28], Avg: 292.9294 (0.900)
Ep: 35, Reward: 463.6266, Test: 482.1014 [226.74], Avg: 291.8857 (0.897)
Ep: 36, Reward: 423.6826, Test: 601.7767 [176.96], Avg: 295.4786 (0.895)
Ep: 37, Reward: 490.5200, Test: 517.9364 [175.34], Avg: 296.7186 (0.892)
Ep: 38, Reward: 565.1570, Test: 525.3814 [226.96], Avg: 296.7623 (0.889)
Ep: 39, Reward: 648.1868, Test: 548.5825 [245.86], Avg: 296.9112 (0.887)
Ep: 40, Reward: 670.2967, Test: 546.2535 [168.71], Avg: 298.8778 (0.884)
Ep: 41, Reward: 571.5291, Test: 573.7546 [243.68], Avg: 299.6206 (0.881)
Ep: 42, Reward: 729.6187, Test: 572.8766 [130.77], Avg: 302.9342 (0.879)
Ep: 43, Reward: 575.9845, Test: 673.8016 [166.72], Avg: 307.5739 (0.876)
Ep: 44, Reward: 714.9745, Test: 784.6493 [69.16], Avg: 316.6386 (0.874)
Ep: 45, Reward: 789.3682, Test: 839.2045 [84.00], Avg: 326.1727 (0.871)
Ep: 46, Reward: 811.9972, Test: 766.0953 [161.82], Avg: 332.0898 (0.868)
Ep: 47, Reward: 789.6570, Test: 766.9685 [184.65], Avg: 337.3029 (0.866)
Ep: 48, Reward: 764.9634, Test: 753.8423 [197.21], Avg: 341.7790 (0.863)
Ep: 49, Reward: 810.2366, Test: 714.5957 [193.96], Avg: 345.3561 (0.861)
Ep: 50, Reward: 706.3076, Test: 889.6885 [30.32], Avg: 355.4348 (0.858)
Ep: 51, Reward: 777.8080, Test: 762.1656 [161.24], Avg: 360.1558 (0.855)
Ep: 52, Reward: 822.3113, Test: 842.4880 [115.05], Avg: 367.0855 (0.853)
Ep: 53, Reward: 792.1933, Test: 850.1563 [40.47], Avg: 375.2819 (0.850)
Ep: 54, Reward: 811.1283, Test: 780.5430 [145.57], Avg: 380.0035 (0.848)
Ep: 55, Reward: 768.6774, Test: 683.7367 [211.19], Avg: 381.6560 (0.845)
Ep: 56, Reward: 821.5359, Test: 811.7455 [129.09], Avg: 386.9368 (0.843)
Ep: 57, Reward: 812.6181, Test: 836.0415 [98.36], Avg: 392.9840 (0.840)
Ep: 58, Reward: 767.6819, Test: 806.4745 [168.78], Avg: 397.1318 (0.838)
Ep: 59, Reward: 818.6217, Test: 816.2864 [105.85], Avg: 402.3535 (0.835)
Ep: 60, Reward: 824.5754, Test: 785.3905 [115.38], Avg: 406.7413 (0.833)
Ep: 61, Reward: 783.8950, Test: 739.6448 [154.85], Avg: 409.6132 (0.830)
Ep: 62, Reward: 691.1024, Test: 771.1038 [152.98], Avg: 412.9228 (0.828)
Ep: 63, Reward: 757.2416, Test: 813.0653 [197.92], Avg: 416.0825 (0.825)
Ep: 64, Reward: 813.7170, Test: 835.4636 [67.65], Avg: 421.4937 (0.823)
Ep: 65, Reward: 831.2208, Test: 762.9466 [132.78], Avg: 424.6554 (0.820)
Ep: 66, Reward: 862.5677, Test: 802.3472 [96.01], Avg: 428.8596 (0.818)
Ep: 67, Reward: 819.2301, Test: 733.6474 [177.85], Avg: 430.7264 (0.815)
Ep: 68, Reward: 748.2187, Test: 695.7666 [192.23], Avg: 431.7816 (0.813)
Ep: 69, Reward: 737.0177, Test: 760.1469 [158.58], Avg: 434.2071 (0.810)
Ep: 70, Reward: 816.4831, Test: 740.1918 [196.49], Avg: 435.7492 (0.808)
Ep: 71, Reward: 708.5181, Test: 588.6634 [175.51], Avg: 435.4354 (0.805)
Ep: 72, Reward: 689.6726, Test: 615.6548 [172.10], Avg: 435.5467 (0.803)
Ep: 73, Reward: 618.2115, Test: 600.4977 [206.75], Avg: 434.9819 (0.801)
Ep: 74, Reward: 651.2975, Test: 556.8125 [193.92], Avg: 434.0206 (0.798)
Ep: 75, Reward: 585.5696, Test: 544.9970 [190.32], Avg: 432.9766 (0.796)
Ep: 76, Reward: 534.6356, Test: 508.8830 [208.06], Avg: 431.2604 (0.793)
Ep: 77, Reward: 581.5196, Test: 469.8065 [206.68], Avg: 429.1048 (0.791)
Ep: 78, Reward: 513.3988, Test: 542.4221 [171.93], Avg: 428.3629 (0.789)
Ep: 79, Reward: 516.0213, Test: 574.5445 [164.61], Avg: 428.1325 (0.786)
Ep: 80, Reward: 565.3456, Test: 642.0841 [115.25], Avg: 429.3511 (0.784)
Ep: 81, Reward: 493.6810, Test: 389.1592 [128.44], Avg: 427.2946 (0.782)
Ep: 82, Reward: 484.2851, Test: 505.0624 [102.02], Avg: 427.0024 (0.779)
Ep: 83, Reward: 479.4793, Test: 509.9134 [198.61], Avg: 425.6250 (0.777)
Ep: 84, Reward: 574.6833, Test: 585.7258 [178.98], Avg: 425.4029 (0.775)
Ep: 85, Reward: 577.3626, Test: 619.8132 [186.99], Avg: 425.4891 (0.772)
Ep: 86, Reward: 608.1386, Test: 485.6803 [128.10], Avg: 424.7086 (0.770)
Ep: 87, Reward: 701.5053, Test: 622.7770 [204.65], Avg: 424.6338 (0.768)
Ep: 88, Reward: 657.3633, Test: 607.4345 [194.77], Avg: 424.4993 (0.765)
Ep: 89, Reward: 717.7389, Test: 697.3528 [143.31], Avg: 425.9387 (0.763)
Ep: 90, Reward: 626.0709, Test: 601.6023 [170.30], Avg: 425.9977 (0.761)
Ep: 91, Reward: 487.2716, Test: 582.0851 [166.71], Avg: 425.8822 (0.758)
Ep: 92, Reward: 590.5654, Test: 722.3892 [102.46], Avg: 427.9688 (0.756)
Ep: 93, Reward: 719.2160, Test: 633.0017 [215.07], Avg: 427.8619 (0.754)
Ep: 94, Reward: 664.5931, Test: 642.2716 [173.85], Avg: 428.2888 (0.752)
Ep: 95, Reward: 763.9637, Test: 722.5692 [149.26], Avg: 429.7994 (0.749)
Ep: 96, Reward: 731.3924, Test: 650.2641 [155.16], Avg: 430.4727 (0.747)
Ep: 97, Reward: 718.9419, Test: 661.4717 [196.01], Avg: 430.8297 (0.745)
Ep: 98, Reward: 683.6154, Test: 617.0031 [139.64], Avg: 431.2998 (0.743)
Ep: 99, Reward: 748.8484, Test: 597.3643 [164.03], Avg: 431.3201 (0.740)
Ep: 100, Reward: 718.3817, Test: 619.5816 [191.32], Avg: 431.2899 (0.738)
Ep: 101, Reward: 735.8586, Test: 634.2862 [153.21], Avg: 431.7779 (0.736)
Ep: 102, Reward: 661.6418, Test: 645.5008 [137.44], Avg: 432.5186 (0.734)
Ep: 103, Reward: 633.3358, Test: 759.5193 [137.95], Avg: 434.3364 (0.732)
Ep: 104, Reward: 739.0785, Test: 666.8658 [124.20], Avg: 435.3681 (0.729)
Ep: 105, Reward: 788.8251, Test: 701.2786 [115.19], Avg: 436.7900 (0.727)
Ep: 106, Reward: 671.6918, Test: 744.4262 [131.80], Avg: 438.4334 (0.725)
Ep: 107, Reward: 755.4859, Test: 665.1940 [175.79], Avg: 438.9053 (0.723)
Ep: 108, Reward: 714.4941, Test: 815.6478 [72.03], Avg: 441.7008 (0.721)
Ep: 109, Reward: 774.8467, Test: 792.8986 [125.57], Avg: 443.7520 (0.719)
Ep: 110, Reward: 734.8648, Test: 721.6377 [153.97], Avg: 444.8683 (0.716)
Ep: 111, Reward: 711.5530, Test: 745.7109 [90.24], Avg: 446.7487 (0.714)
Ep: 112, Reward: 689.1073, Test: 694.9468 [125.45], Avg: 447.8350 (0.712)
Ep: 113, Reward: 791.2101, Test: 783.2660 [99.07], Avg: 449.9083 (0.710)
Ep: 114, Reward: 701.1243, Test: 773.2043 [163.72], Avg: 451.2959 (0.708)
Ep: 115, Reward: 780.9257, Test: 753.4235 [147.70], Avg: 452.6272 (0.706)
Ep: 116, Reward: 760.7798, Test: 789.1440 [80.82], Avg: 454.8127 (0.704)
Ep: 117, Reward: 803.9275, Test: 737.4117 [141.41], Avg: 456.0093 (0.702)
Ep: 118, Reward: 704.7763, Test: 753.0745 [99.09], Avg: 457.6729 (0.699)
Ep: 119, Reward: 688.3314, Test: 746.6276 [102.81], Avg: 459.2241 (0.697)
Ep: 120, Reward: 768.1636, Test: 655.2320 [126.98], Avg: 459.7946 (0.695)
Ep: 121, Reward: 759.4369, Test: 825.7992 [85.74], Avg: 462.0918 (0.693)
Ep: 122, Reward: 779.7801, Test: 690.7667 [205.19], Avg: 462.2827 (0.691)
Ep: 123, Reward: 688.8366, Test: 726.6627 [204.55], Avg: 462.7652 (0.689)
Ep: 124, Reward: 732.4850, Test: 726.1190 [170.44], Avg: 463.5085 (0.687)
Ep: 125, Reward: 740.8570, Test: 694.5288 [168.08], Avg: 464.0080 (0.685)
Ep: 126, Reward: 766.2482, Test: 750.9610 [70.49], Avg: 465.7125 (0.683)
Ep: 127, Reward: 654.6179, Test: 774.4878 [88.45], Avg: 467.4338 (0.681)
Ep: 128, Reward: 724.3878, Test: 762.5216 [209.45], Avg: 468.0976 (0.679)
Ep: 129, Reward: 740.9321, Test: 710.5976 [161.35], Avg: 468.7218 (0.677)
Ep: 130, Reward: 771.7330, Test: 788.3808 [99.45], Avg: 470.4028 (0.675)
Ep: 131, Reward: 645.0635, Test: 744.0792 [147.28], Avg: 471.3604 (0.673)
Ep: 132, Reward: 727.1219, Test: 772.7838 [134.63], Avg: 472.6144 (0.671)
Ep: 133, Reward: 673.6673, Test: 706.2818 [166.48], Avg: 473.1158 (0.669)
Ep: 134, Reward: 733.5471, Test: 857.0887 [39.00], Avg: 475.6712 (0.667)
Ep: 135, Reward: 723.1327, Test: 775.8377 [98.14], Avg: 477.1567 (0.665)
Ep: 136, Reward: 714.1167, Test: 751.2369 [190.16], Avg: 477.7692 (0.663)
Ep: 137, Reward: 777.8870, Test: 763.3979 [105.94], Avg: 479.0713 (0.661)
Ep: 138, Reward: 614.7377, Test: 745.8988 [153.13], Avg: 479.8893 (0.659)
Ep: 139, Reward: 700.1022, Test: 804.9876 [92.88], Avg: 481.5481 (0.657)
Ep: 140, Reward: 736.5893, Test: 731.8347 [166.39], Avg: 482.1431 (0.655)
Ep: 141, Reward: 782.9710, Test: 681.0411 [148.12], Avg: 482.5007 (0.653)
Ep: 142, Reward: 721.5967, Test: 710.1811 [182.40], Avg: 482.8173 (0.651)
Ep: 143, Reward: 778.8437, Test: 574.2068 [190.07], Avg: 482.1320 (0.649)
Ep: 144, Reward: 725.2672, Test: 699.4796 [155.94], Avg: 482.5555 (0.647)
Ep: 145, Reward: 638.3930, Test: 727.1410 [156.14], Avg: 483.1613 (0.645)
Ep: 146, Reward: 694.0770, Test: 772.4485 [142.78], Avg: 484.1579 (0.643)
Ep: 147, Reward: 716.1912, Test: 726.4589 [165.04], Avg: 484.6799 (0.641)
Ep: 148, Reward: 780.2193, Test: 643.6484 [193.42], Avg: 484.4487 (0.639)
Ep: 149, Reward: 740.8972, Test: 742.4617 [146.71], Avg: 485.1907 (0.637)
Ep: 150, Reward: 709.9282, Test: 661.2218 [191.32], Avg: 485.0894 (0.635)
Ep: 151, Reward: 697.4776, Test: 630.4695 [177.43], Avg: 484.8786 (0.633)
Ep: 152, Reward: 718.4019, Test: 714.6109 [157.49], Avg: 485.3507 (0.631)
Ep: 153, Reward: 687.6615, Test: 688.1338 [151.74], Avg: 485.6822 (0.630)
Ep: 154, Reward: 699.5806, Test: 640.7824 [228.64], Avg: 485.2077 (0.628)
Ep: 155, Reward: 687.2716, Test: 584.9555 [196.05], Avg: 484.5904 (0.626)
Ep: 156, Reward: 765.9109, Test: 587.2569 [196.04], Avg: 483.9957 (0.624)
Ep: 157, Reward: 669.9792, Test: 767.6779 [104.29], Avg: 485.1311 (0.622)
Ep: 158, Reward: 676.8469, Test: 769.5422 [71.33], Avg: 486.4712 (0.620)
Ep: 159, Reward: 752.6624, Test: 592.3682 [161.24], Avg: 486.1253 (0.618)
Ep: 160, Reward: 627.6693, Test: 693.7698 [175.40], Avg: 486.3255 (0.616)
Ep: 161, Reward: 718.3887, Test: 721.3554 [136.49], Avg: 486.9338 (0.615)
Ep: 162, Reward: 718.1350, Test: 641.9992 [191.32], Avg: 486.7114 (0.613)
Ep: 163, Reward: 722.9876, Test: 721.6079 [117.28], Avg: 487.4286 (0.611)
Ep: 164, Reward: 655.3107, Test: 717.4429 [130.54], Avg: 488.0314 (0.609)
Ep: 165, Reward: 737.0915, Test: 643.2307 [184.49], Avg: 487.8550 (0.607)
Ep: 166, Reward: 675.0491, Test: 715.5643 [114.10], Avg: 488.5353 (0.605)
Ep: 167, Reward: 680.1815, Test: 803.8171 [49.54], Avg: 490.1171 (0.604)
Ep: 168, Reward: 749.3603, Test: 687.3928 [153.90], Avg: 490.3738 (0.602)
Ep: 169, Reward: 680.9814, Test: 618.0024 [201.89], Avg: 489.9369 (0.600)
Ep: 170, Reward: 740.2090, Test: 746.5768 [154.69], Avg: 490.5331 (0.598)
Ep: 171, Reward: 729.7200, Test: 810.2792 [101.98], Avg: 491.7992 (0.596)
Ep: 172, Reward: 734.1749, Test: 719.7863 [148.58], Avg: 492.2582 (0.595)
Ep: 173, Reward: 771.7184, Test: 783.3132 [82.27], Avg: 493.4581 (0.593)
Ep: 174, Reward: 779.6679, Test: 721.8035 [180.10], Avg: 493.7338 (0.591)
Ep: 175, Reward: 750.6131, Test: 619.0460 [171.37], Avg: 493.4721 (0.589)
Ep: 176, Reward: 838.8792, Test: 695.4980 [182.11], Avg: 493.5846 (0.588)
Ep: 177, Reward: 831.4944, Test: 826.7486 [67.02], Avg: 495.0798 (0.586)
Ep: 178, Reward: 775.4467, Test: 822.3610 [105.84], Avg: 496.3169 (0.584)
Ep: 179, Reward: 782.9910, Test: 778.1379 [115.18], Avg: 497.2426 (0.582)
Ep: 180, Reward: 815.4670, Test: 739.0082 [159.69], Avg: 497.6961 (0.581)
Ep: 181, Reward: 759.9685, Test: 781.2234 [156.21], Avg: 498.3956 (0.579)
Ep: 182, Reward: 813.8231, Test: 816.3747 [113.45], Avg: 499.5133 (0.577)
Ep: 183, Reward: 782.2724, Test: 774.7462 [148.89], Avg: 500.1999 (0.575)
Ep: 184, Reward: 822.6080, Test: 790.0413 [112.37], Avg: 501.1593 (0.574)
Ep: 185, Reward: 807.5430, Test: 809.2564 [62.07], Avg: 502.4820 (0.572)
Ep: 186, Reward: 797.3787, Test: 768.1418 [117.34], Avg: 503.2752 (0.570)
Ep: 187, Reward: 839.7377, Test: 835.6978 [63.17], Avg: 504.7074 (0.568)
Ep: 188, Reward: 796.2036, Test: 865.8252 [21.57], Avg: 506.5039 (0.567)
Ep: 189, Reward: 857.7052, Test: 772.9807 [174.69], Avg: 506.9870 (0.565)
Ep: 190, Reward: 779.0535, Test: 814.8117 [47.95], Avg: 508.3477 (0.563)
Ep: 191, Reward: 836.7719, Test: 781.8451 [108.15], Avg: 509.2089 (0.562)
Ep: 192, Reward: 789.3877, Test: 839.3610 [23.12], Avg: 510.7997 (0.560)
Ep: 193, Reward: 774.5395, Test: 772.3296 [77.12], Avg: 511.7503 (0.558)
Ep: 194, Reward: 786.7602, Test: 677.2571 [160.05], Avg: 511.7782 (0.557)
Ep: 195, Reward: 729.1847, Test: 801.1198 [121.15], Avg: 512.6364 (0.555)
Ep: 196, Reward: 775.6946, Test: 758.4079 [127.03], Avg: 513.2391 (0.553)
Ep: 197, Reward: 771.6484, Test: 820.7833 [27.55], Avg: 514.6533 (0.552)
Ep: 198, Reward: 739.0399, Test: 771.2495 [159.68], Avg: 515.1403 (0.550)
Ep: 199, Reward: 814.6036, Test: 836.7902 [19.89], Avg: 516.6491 (0.548)
Ep: 200, Reward: 775.4776, Test: 864.6291 [33.46], Avg: 518.2139 (0.547)
Ep: 201, Reward: 737.8000, Test: 776.6465 [130.81], Avg: 518.8457 (0.545)
Ep: 202, Reward: 797.2817, Test: 723.1099 [196.89], Avg: 518.8820 (0.543)
Ep: 203, Reward: 759.1356, Test: 787.9135 [72.58], Avg: 519.8450 (0.542)
Ep: 204, Reward: 793.5265, Test: 745.8606 [141.13], Avg: 520.2590 (0.540)
Ep: 205, Reward: 789.7401, Test: 804.1327 [128.90], Avg: 521.0113 (0.539)
Ep: 206, Reward: 745.4145, Test: 781.0327 [107.04], Avg: 521.7504 (0.537)
Ep: 207, Reward: 789.4073, Test: 802.6645 [85.19], Avg: 522.6914 (0.535)
Ep: 208, Reward: 786.3321, Test: 677.3927 [183.17], Avg: 522.5552 (0.534)
Ep: 209, Reward: 751.1957, Test: 750.3418 [139.17], Avg: 522.9771 (0.532)
Ep: 210, Reward: 775.8008, Test: 760.8898 [105.13], Avg: 523.6064 (0.530)
Ep: 211, Reward: 795.1613, Test: 811.3936 [51.63], Avg: 524.7204 (0.529)
Ep: 212, Reward: 749.8357, Test: 730.4194 [134.21], Avg: 525.0560 (0.527)
Ep: 213, Reward: 785.5943, Test: 786.8403 [125.11], Avg: 525.6946 (0.526)
Ep: 214, Reward: 779.9276, Test: 801.8516 [66.83], Avg: 526.6682 (0.524)
Ep: 215, Reward: 698.8213, Test: 678.5719 [149.43], Avg: 526.6797 (0.523)
Ep: 216, Reward: 833.1204, Test: 791.2128 [122.54], Avg: 527.3340 (0.521)
Ep: 217, Reward: 729.5329, Test: 778.4839 [117.48], Avg: 527.9472 (0.519)
Ep: 218, Reward: 822.6973, Test: 761.9739 [161.27], Avg: 528.2794 (0.518)
Ep: 219, Reward: 695.6684, Test: 712.7606 [161.03], Avg: 528.3860 (0.516)
Ep: 220, Reward: 811.5688, Test: 730.9440 [161.29], Avg: 528.5728 (0.515)
Ep: 221, Reward: 819.3589, Test: 846.7975 [42.91], Avg: 529.8130 (0.513)
Ep: 222, Reward: 846.6902, Test: 822.6168 [46.74], Avg: 530.9164 (0.512)
Ep: 223, Reward: 744.1363, Test: 719.7644 [139.12], Avg: 531.1384 (0.510)
Ep: 224, Reward: 760.9614, Test: 779.3857 [117.53], Avg: 531.7193 (0.509)
Ep: 225, Reward: 775.1885, Test: 840.3639 [17.71], Avg: 533.0066 (0.507)
Ep: 226, Reward: 803.5906, Test: 697.4665 [210.94], Avg: 532.8019 (0.506)
Ep: 227, Reward: 786.4052, Test: 785.9829 [81.39], Avg: 533.5553 (0.504)
Ep: 228, Reward: 819.9064, Test: 750.0875 [179.07], Avg: 533.7189 (0.503)
Ep: 229, Reward: 799.6715, Test: 756.5482 [152.80], Avg: 534.0234 (0.501)
Ep: 230, Reward: 761.3167, Test: 793.8160 [70.54], Avg: 534.8427 (0.500)
Ep: 231, Reward: 693.4879, Test: 767.4956 [121.62], Avg: 535.3212 (0.498)
Ep: 232, Reward: 884.8137, Test: 771.6000 [114.09], Avg: 535.8456 (0.497)
Ep: 233, Reward: 783.9571, Test: 790.1604 [143.38], Avg: 536.3197 (0.495)
Ep: 234, Reward: 817.2941, Test: 768.2584 [130.00], Avg: 536.7535 (0.494)
Ep: 235, Reward: 783.9015, Test: 742.1093 [147.88], Avg: 536.9971 (0.492)
Ep: 236, Reward: 724.5855, Test: 809.9238 [69.58], Avg: 537.8551 (0.491)
Ep: 237, Reward: 817.0383, Test: 816.1917 [97.02], Avg: 538.6169 (0.489)
Ep: 238, Reward: 785.4303, Test: 767.0782 [77.49], Avg: 539.2486 (0.488)
Ep: 239, Reward: 847.1517, Test: 675.4882 [160.11], Avg: 539.1491 (0.486)
Ep: 240, Reward: 800.4780, Test: 801.8012 [69.30], Avg: 539.9514 (0.485)
Ep: 241, Reward: 698.7395, Test: 838.1452 [35.49], Avg: 541.0370 (0.483)
Ep: 242, Reward: 782.2391, Test: 685.9350 [198.46], Avg: 540.8166 (0.482)
Ep: 243, Reward: 780.1250, Test: 702.4548 [169.88], Avg: 540.7828 (0.480)
Ep: 244, Reward: 700.9261, Test: 776.0487 [155.18], Avg: 541.1097 (0.479)
Ep: 245, Reward: 789.8010, Test: 757.2599 [128.57], Avg: 541.4657 (0.478)
Ep: 246, Reward: 798.6424, Test: 699.2665 [165.58], Avg: 541.4342 (0.476)
Ep: 247, Reward: 832.0530, Test: 767.3132 [121.81], Avg: 541.8538 (0.475)
Ep: 248, Reward: 772.1680, Test: 805.8643 [73.70], Avg: 542.6181 (0.473)
Ep: 249, Reward: 746.2217, Test: 697.0450 [180.64], Avg: 542.5133 (0.472)
Ep: 250, Reward: 799.8169, Test: 734.5961 [152.93], Avg: 542.6692 (0.470)
Ep: 251, Reward: 768.0562, Test: 778.5905 [137.91], Avg: 543.0582 (0.469)
Ep: 252, Reward: 800.5240, Test: 798.8229 [134.55], Avg: 543.5373 (0.468)
Ep: 253, Reward: 751.0764, Test: 783.6866 [143.44], Avg: 543.9180 (0.466)
Ep: 254, Reward: 762.8123, Test: 733.7587 [150.27], Avg: 544.0732 (0.465)
Ep: 255, Reward: 759.5348, Test: 848.0783 [51.89], Avg: 545.0580 (0.463)
Ep: 256, Reward: 802.4471, Test: 713.8864 [194.08], Avg: 544.9598 (0.462)
Ep: 257, Reward: 781.2425, Test: 801.8208 [84.10], Avg: 545.6294 (0.461)
Ep: 258, Reward: 760.8822, Test: 797.9724 [94.67], Avg: 546.2382 (0.459)
Ep: 259, Reward: 790.6193, Test: 802.1880 [133.27], Avg: 546.7100 (0.458)
Ep: 260, Reward: 810.0562, Test: 842.5422 [60.27], Avg: 547.6125 (0.456)
Ep: 261, Reward: 797.9310, Test: 817.0637 [68.37], Avg: 548.3800 (0.455)
Ep: 262, Reward: 826.0950, Test: 711.6124 [205.91], Avg: 548.2178 (0.454)
Ep: 263, Reward: 764.0133, Test: 766.9810 [169.63], Avg: 548.4039 (0.452)
Ep: 264, Reward: 731.8253, Test: 818.2312 [81.64], Avg: 549.1140 (0.451)
Ep: 265, Reward: 762.6877, Test: 769.9459 [137.71], Avg: 549.4265 (0.450)
Ep: 266, Reward: 828.5834, Test: 708.2044 [125.17], Avg: 549.5524 (0.448)
Ep: 267, Reward: 861.1541, Test: 820.4424 [107.23], Avg: 550.1631 (0.447)
Ep: 268, Reward: 798.2790, Test: 799.3393 [91.52], Avg: 550.7491 (0.446)
Ep: 269, Reward: 818.7149, Test: 828.8356 [44.49], Avg: 551.6143 (0.444)
Ep: 270, Reward: 774.4348, Test: 821.1660 [56.20], Avg: 552.4016 (0.443)
Ep: 271, Reward: 867.0208, Test: 841.6151 [87.66], Avg: 553.1426 (0.442)
Ep: 272, Reward: 818.8620, Test: 821.4201 [49.97], Avg: 553.9423 (0.440)
Ep: 273, Reward: 830.6027, Test: 791.3012 [165.40], Avg: 554.2049 (0.439)
Ep: 274, Reward: 803.7419, Test: 859.9787 [34.30], Avg: 555.1921 (0.438)
Ep: 275, Reward: 824.2699, Test: 843.8449 [64.79], Avg: 556.0031 (0.436)
Ep: 276, Reward: 769.5302, Test: 727.3341 [164.76], Avg: 556.0269 (0.435)
Ep: 277, Reward: 851.6248, Test: 837.4980 [51.57], Avg: 556.8538 (0.434)
Ep: 278, Reward: 833.5171, Test: 663.7553 [173.47], Avg: 556.6152 (0.432)
Ep: 279, Reward: 812.2303, Test: 797.8289 [63.65], Avg: 557.2494 (0.431)
Ep: 280, Reward: 775.9616, Test: 801.0658 [108.63], Avg: 557.7305 (0.430)
Ep: 281, Reward: 800.7575, Test: 783.5564 [95.91], Avg: 558.1912 (0.429)
Ep: 282, Reward: 752.1987, Test: 768.1268 [107.18], Avg: 558.5543 (0.427)
Ep: 283, Reward: 815.5469, Test: 733.9919 [149.96], Avg: 558.6440 (0.426)
Ep: 284, Reward: 812.5728, Test: 810.0277 [101.40], Avg: 559.1702 (0.425)
Ep: 285, Reward: 812.0616, Test: 765.2561 [157.27], Avg: 559.3409 (0.423)
Ep: 286, Reward: 766.8124, Test: 725.0259 [160.74], Avg: 559.3582 (0.422)
Ep: 287, Reward: 708.9397, Test: 714.6426 [158.47], Avg: 559.3471 (0.421)
Ep: 288, Reward: 734.4250, Test: 721.4299 [194.27], Avg: 559.2357 (0.420)
Ep: 289, Reward: 792.5761, Test: 769.6711 [120.93], Avg: 559.5444 (0.418)
Ep: 290, Reward: 826.1303, Test: 717.9221 [169.19], Avg: 559.5072 (0.417)
Ep: 291, Reward: 813.8128, Test: 768.1116 [113.36], Avg: 559.8334 (0.416)
Ep: 292, Reward: 830.7132, Test: 717.1384 [179.14], Avg: 559.7589 (0.415)
Ep: 293, Reward: 817.2565, Test: 786.2296 [104.74], Avg: 560.1729 (0.413)
Ep: 294, Reward: 692.9990, Test: 691.7764 [190.30], Avg: 559.9739 (0.412)
Ep: 295, Reward: 821.0702, Test: 743.2730 [143.46], Avg: 560.1085 (0.411)
Ep: 296, Reward: 772.7148, Test: 792.3301 [147.12], Avg: 560.3951 (0.410)
Ep: 297, Reward: 758.3734, Test: 764.5835 [102.14], Avg: 560.7375 (0.408)
Ep: 298, Reward: 844.0236, Test: 830.1574 [34.60], Avg: 561.5229 (0.407)
Ep: 299, Reward: 792.2458, Test: 794.2712 [110.30], Avg: 561.9310 (0.406)
Ep: 300, Reward: 818.6705, Test: 807.9748 [78.88], Avg: 562.4864 (0.405)
Ep: 301, Reward: 799.2446, Test: 811.0470 [79.38], Avg: 563.0466 (0.404)
Ep: 302, Reward: 758.8434, Test: 819.3472 [88.90], Avg: 563.5991 (0.402)
Ep: 303, Reward: 849.7941, Test: 850.9906 [27.37], Avg: 564.4544 (0.401)
Ep: 304, Reward: 844.5284, Test: 761.6499 [146.29], Avg: 564.6213 (0.400)
Ep: 305, Reward: 784.7619, Test: 784.2810 [92.78], Avg: 565.0359 (0.399)
Ep: 306, Reward: 770.0836, Test: 834.8365 [49.42], Avg: 565.7538 (0.398)
Ep: 307, Reward: 817.0796, Test: 811.6131 [112.23], Avg: 566.1876 (0.396)
Ep: 308, Reward: 776.7025, Test: 740.2839 [149.83], Avg: 566.2662 (0.395)
Ep: 309, Reward: 772.0918, Test: 816.3703 [82.21], Avg: 566.8078 (0.394)
Ep: 310, Reward: 831.5074, Test: 789.5526 [175.59], Avg: 566.9594 (0.393)
Ep: 311, Reward: 829.4741, Test: 773.3039 [146.37], Avg: 567.1516 (0.392)
Ep: 312, Reward: 808.3679, Test: 806.9368 [62.37], Avg: 567.7184 (0.390)
Ep: 313, Reward: 829.9797, Test: 807.7167 [67.90], Avg: 568.2665 (0.389)
Ep: 314, Reward: 806.7824, Test: 848.2351 [38.74], Avg: 569.0323 (0.388)
Ep: 315, Reward: 816.6852, Test: 784.8820 [115.87], Avg: 569.3487 (0.387)
Ep: 316, Reward: 802.9088, Test: 789.7394 [114.80], Avg: 569.6818 (0.386)
Ep: 317, Reward: 806.1901, Test: 816.2289 [76.97], Avg: 570.2151 (0.385)
Ep: 318, Reward: 791.9080, Test: 828.0603 [56.46], Avg: 570.8464 (0.383)
Ep: 319, Reward: 817.3674, Test: 804.8279 [65.81], Avg: 571.3719 (0.382)
Ep: 320, Reward: 812.0788, Test: 849.9544 [25.16], Avg: 572.1614 (0.381)
Ep: 321, Reward: 807.6675, Test: 821.6054 [71.53], Avg: 572.7139 (0.380)
Ep: 322, Reward: 754.1160, Test: 849.4452 [15.14], Avg: 573.5238 (0.379)
Ep: 323, Reward: 845.2834, Test: 831.8617 [78.84], Avg: 574.0778 (0.378)
Ep: 324, Reward: 804.3521, Test: 844.4589 [36.07], Avg: 574.7988 (0.377)
Ep: 325, Reward: 815.2972, Test: 832.3800 [74.84], Avg: 575.3593 (0.376)
Ep: 326, Reward: 816.2001, Test: 833.5156 [52.28], Avg: 575.9889 (0.374)
Ep: 327, Reward: 799.6241, Test: 844.7979 [65.39], Avg: 576.6091 (0.373)
Ep: 328, Reward: 778.4003, Test: 821.5580 [71.55], Avg: 577.1362 (0.372)
Ep: 329, Reward: 790.4083, Test: 825.4397 [41.97], Avg: 577.7614 (0.371)
Ep: 330, Reward: 769.4520, Test: 837.8134 [53.27], Avg: 578.3861 (0.370)
Ep: 331, Reward: 822.4133, Test: 848.8984 [24.57], Avg: 579.1269 (0.369)
Ep: 332, Reward: 765.5626, Test: 763.7759 [135.43], Avg: 579.2747 (0.368)
Ep: 333, Reward: 821.4749, Test: 822.0349 [47.85], Avg: 579.8583 (0.367)
Ep: 334, Reward: 862.3694, Test: 839.2190 [68.61], Avg: 580.4277 (0.365)
Ep: 335, Reward: 765.4268, Test: 847.7442 [57.63], Avg: 581.0518 (0.364)
Ep: 336, Reward: 834.3358, Test: 807.9179 [76.44], Avg: 581.4981 (0.363)
Ep: 337, Reward: 804.4232, Test: 869.4196 [30.69], Avg: 582.2591 (0.362)
Ep: 338, Reward: 848.4885, Test: 867.1156 [33.02], Avg: 583.0020 (0.361)
Ep: 339, Reward: 781.5710, Test: 862.8508 [23.29], Avg: 583.7566 (0.360)
Ep: 340, Reward: 861.4048, Test: 864.8898 [62.64], Avg: 584.3974 (0.359)
Ep: 341, Reward: 852.6547, Test: 859.8565 [20.33], Avg: 585.1434 (0.358)
Ep: 342, Reward: 901.9624, Test: 839.3328 [69.33], Avg: 585.6823 (0.357)
Ep: 343, Reward: 841.3693, Test: 816.7594 [101.78], Avg: 586.0582 (0.356)
Ep: 344, Reward: 845.0202, Test: 850.0225 [31.89], Avg: 586.7309 (0.355)
Ep: 345, Reward: 863.3275, Test: 856.1685 [70.23], Avg: 587.3066 (0.354)
Ep: 346, Reward: 948.4663, Test: 809.2157 [138.41], Avg: 587.5473 (0.353)
Ep: 347, Reward: 859.7784, Test: 870.4607 [40.88], Avg: 588.2428 (0.351)
Ep: 348, Reward: 870.6516, Test: 792.1775 [127.54], Avg: 588.4617 (0.350)
Ep: 349, Reward: 899.0462, Test: 867.6932 [39.47], Avg: 589.1467 (0.349)
Ep: 350, Reward: 851.2393, Test: 851.4574 [58.94], Avg: 589.7261 (0.348)
Ep: 351, Reward: 919.2610, Test: 859.8190 [21.43], Avg: 590.4326 (0.347)
Ep: 352, Reward: 836.7198, Test: 869.4122 [41.92], Avg: 591.1041 (0.346)
Ep: 353, Reward: 803.4412, Test: 853.7542 [37.51], Avg: 591.7401 (0.345)
Ep: 354, Reward: 945.9327, Test: 839.7924 [55.99], Avg: 592.2811 (0.344)
Ep: 355, Reward: 895.6809, Test: 845.8023 [109.89], Avg: 592.6846 (0.343)
Ep: 356, Reward: 866.5512, Test: 840.5865 [62.49], Avg: 593.2039 (0.342)
Ep: 357, Reward: 895.5414, Test: 855.7008 [48.82], Avg: 593.8008 (0.341)
Ep: 358, Reward: 896.1550, Test: 854.4081 [69.30], Avg: 594.3337 (0.340)
Ep: 359, Reward: 928.6968, Test: 860.1777 [41.80], Avg: 594.9560 (0.339)
Ep: 360, Reward: 880.3854, Test: 879.5954 [38.13], Avg: 595.6389 (0.338)
Ep: 361, Reward: 867.8002, Test: 879.4423 [28.35], Avg: 596.3445 (0.337)
Ep: 362, Reward: 869.0597, Test: 827.2394 [142.77], Avg: 596.5873 (0.336)
Ep: 363, Reward: 878.8178, Test: 853.0026 [18.19], Avg: 597.2418 (0.335)
Ep: 364, Reward: 908.3058, Test: 815.6589 [99.70], Avg: 597.5670 (0.334)
Ep: 365, Reward: 885.5700, Test: 821.3269 [103.46], Avg: 597.8957 (0.333)
Ep: 366, Reward: 893.2031, Test: 805.3863 [92.96], Avg: 598.2078 (0.332)
Ep: 367, Reward: 878.9922, Test: 823.2179 [99.68], Avg: 598.5483 (0.331)
Ep: 368, Reward: 877.2365, Test: 848.4373 [35.22], Avg: 599.1301 (0.330)
Ep: 369, Reward: 896.1421, Test: 782.1734 [176.25], Avg: 599.1485 (0.329)
Ep: 370, Reward: 848.0269, Test: 829.8470 [96.53], Avg: 599.5101 (0.328)
Ep: 371, Reward: 844.2201, Test: 864.5619 [26.46], Avg: 600.1515 (0.327)
Ep: 372, Reward: 850.9219, Test: 859.2501 [43.42], Avg: 600.7297 (0.326)
Ep: 373, Reward: 852.1155, Test: 830.3534 [67.38], Avg: 601.1635 (0.325)
Ep: 374, Reward: 882.0553, Test: 881.6433 [34.50], Avg: 601.8194 (0.324)
Ep: 375, Reward: 878.7097, Test: 886.5213 [21.14], Avg: 602.5204 (0.323)
Ep: 376, Reward: 915.2036, Test: 867.6901 [30.90], Avg: 603.1418 (0.322)
Ep: 377, Reward: 858.7575, Test: 863.2152 [29.36], Avg: 603.7522 (0.321)
Ep: 378, Reward: 839.6557, Test: 870.6436 [33.17], Avg: 604.3689 (0.320)
Ep: 379, Reward: 853.0940, Test: 876.2287 [25.09], Avg: 605.0182 (0.319)
Ep: 380, Reward: 866.2767, Test: 846.5234 [72.03], Avg: 605.4631 (0.318)
Ep: 381, Reward: 947.2864, Test: 895.5351 [27.27], Avg: 606.1510 (0.317)
Ep: 382, Reward: 881.5357, Test: 885.4417 [25.59], Avg: 606.8134 (0.316)
Ep: 383, Reward: 854.3844, Test: 878.2704 [47.41], Avg: 607.3969 (0.315)
Ep: 384, Reward: 877.9804, Test: 879.5921 [38.83], Avg: 608.0030 (0.315)
Ep: 385, Reward: 932.3414, Test: 828.7170 [116.02], Avg: 608.2743 (0.314)
Ep: 386, Reward: 890.4233, Test: 873.7864 [24.65], Avg: 608.8966 (0.313)
Ep: 387, Reward: 845.9263, Test: 809.7009 [152.24], Avg: 609.0218 (0.312)
Ep: 388, Reward: 902.4963, Test: 838.1568 [65.04], Avg: 609.4436 (0.311)
Ep: 389, Reward: 821.0623, Test: 859.6663 [22.84], Avg: 610.0267 (0.310)
Ep: 390, Reward: 902.2543, Test: 854.7245 [32.79], Avg: 610.5687 (0.309)
Ep: 391, Reward: 861.1916, Test: 839.1693 [47.75], Avg: 611.0300 (0.308)
Ep: 392, Reward: 896.8712, Test: 818.5372 [136.18], Avg: 611.2115 (0.307)
Ep: 393, Reward: 935.4811, Test: 875.7940 [35.83], Avg: 611.7921 (0.306)
Ep: 394, Reward: 782.6174, Test: 871.4400 [36.70], Avg: 612.3565 (0.305)
Ep: 395, Reward: 869.6529, Test: 846.4811 [108.79], Avg: 612.6731 (0.304)
Ep: 396, Reward: 928.6593, Test: 878.8128 [11.68], Avg: 613.3140 (0.303)
Ep: 397, Reward: 892.0503, Test: 851.3391 [53.42], Avg: 613.7778 (0.302)
Ep: 398, Reward: 871.7583, Test: 865.7704 [72.02], Avg: 614.2289 (0.302)
Ep: 399, Reward: 822.6892, Test: 869.7018 [19.67], Avg: 614.8184 (0.301)
Ep: 400, Reward: 858.6415, Test: 828.8392 [98.65], Avg: 615.1061 (0.300)
Ep: 401, Reward: 835.3915, Test: 858.9325 [72.99], Avg: 615.5311 (0.299)
Ep: 402, Reward: 864.3370, Test: 817.8708 [95.47], Avg: 615.7963 (0.298)
Ep: 403, Reward: 851.3878, Test: 844.2170 [88.15], Avg: 616.1435 (0.297)
Ep: 404, Reward: 836.6323, Test: 867.6416 [39.34], Avg: 616.6673 (0.296)
Ep: 405, Reward: 852.1728, Test: 853.2702 [75.96], Avg: 617.0630 (0.295)
Ep: 406, Reward: 882.1977, Test: 809.1524 [76.61], Avg: 617.3468 (0.294)
Ep: 407, Reward: 911.6351, Test: 837.5133 [103.96], Avg: 617.6316 (0.294)
Ep: 408, Reward: 880.3022, Test: 843.4872 [90.74], Avg: 617.9619 (0.293)
Ep: 409, Reward: 857.9145, Test: 801.6052 [129.57], Avg: 618.0938 (0.292)
Ep: 410, Reward: 871.6620, Test: 795.4776 [113.98], Avg: 618.2481 (0.291)
Ep: 411, Reward: 883.5222, Test: 815.8307 [151.75], Avg: 618.3593 (0.290)
Ep: 412, Reward: 840.4876, Test: 814.0347 [175.71], Avg: 618.4077 (0.289)
Ep: 413, Reward: 860.5827, Test: 876.4183 [34.59], Avg: 618.9474 (0.288)
Ep: 414, Reward: 838.3005, Test: 861.4298 [43.38], Avg: 619.4271 (0.287)
Ep: 415, Reward: 886.0721, Test: 859.7630 [37.12], Avg: 619.9156 (0.287)
Ep: 416, Reward: 901.1030, Test: 878.7758 [25.37], Avg: 620.4756 (0.286)
Ep: 417, Reward: 957.4573, Test: 856.5881 [71.26], Avg: 620.8700 (0.285)
Ep: 418, Reward: 946.2860, Test: 815.3131 [91.76], Avg: 621.1150 (0.284)
Ep: 419, Reward: 910.5161, Test: 838.7443 [91.74], Avg: 621.4148 (0.283)
Ep: 420, Reward: 886.7963, Test: 830.9068 [84.87], Avg: 621.7108 (0.282)
Ep: 421, Reward: 865.1614, Test: 853.5102 [53.13], Avg: 622.1342 (0.281)
Ep: 422, Reward: 872.8373, Test: 852.6981 [34.13], Avg: 622.5986 (0.281)
Ep: 423, Reward: 876.8403, Test: 863.8441 [57.59], Avg: 623.0317 (0.280)
Ep: 424, Reward: 908.9818, Test: 881.3075 [27.26], Avg: 623.5753 (0.279)
Ep: 425, Reward: 898.4181, Test: 823.4513 [102.64], Avg: 623.8035 (0.278)
Ep: 426, Reward: 876.0458, Test: 843.3044 [78.99], Avg: 624.1326 (0.277)
Ep: 427, Reward: 873.4190, Test: 881.0352 [23.19], Avg: 624.6786 (0.276)
Ep: 428, Reward: 881.2769, Test: 879.1174 [35.30], Avg: 625.1895 (0.276)
Ep: 429, Reward: 882.9971, Test: 802.1219 [107.31], Avg: 625.3514 (0.275)
Ep: 430, Reward: 933.5535, Test: 862.1091 [50.50], Avg: 625.7835 (0.274)
Ep: 431, Reward: 819.4700, Test: 889.8116 [27.96], Avg: 626.3300 (0.273)
Ep: 432, Reward: 929.4681, Test: 887.1083 [17.10], Avg: 626.8927 (0.272)
Ep: 433, Reward: 885.6080, Test: 868.5096 [28.93], Avg: 627.3828 (0.271)
Ep: 434, Reward: 875.4552, Test: 868.4746 [56.51], Avg: 627.8071 (0.271)
Ep: 435, Reward: 850.9584, Test: 871.3921 [29.93], Avg: 628.2972 (0.270)
Ep: 436, Reward: 826.6290, Test: 854.8093 [76.60], Avg: 628.6402 (0.269)
Ep: 437, Reward: 888.8516, Test: 778.4173 [171.65], Avg: 628.5903 (0.268)
Ep: 438, Reward: 930.5640, Test: 821.8693 [164.97], Avg: 628.6547 (0.267)
Ep: 439, Reward: 913.9203, Test: 865.0489 [32.40], Avg: 629.1184 (0.267)
Ep: 440, Reward: 826.8747, Test: 841.3322 [80.51], Avg: 629.4170 (0.266)
Ep: 441, Reward: 918.7114, Test: 892.7574 [21.60], Avg: 629.9639 (0.265)
Ep: 442, Reward: 850.3440, Test: 851.1285 [60.55], Avg: 630.3265 (0.264)
Ep: 443, Reward: 903.8900, Test: 817.0686 [139.64], Avg: 630.4326 (0.263)
Ep: 444, Reward: 895.1009, Test: 866.5938 [21.17], Avg: 630.9157 (0.263)
Ep: 445, Reward: 915.1142, Test: 863.6948 [56.97], Avg: 631.3099 (0.262)
Ep: 446, Reward: 919.8828, Test: 883.6519 [29.71], Avg: 631.8080 (0.261)
Ep: 447, Reward: 903.4210, Test: 870.4371 [23.51], Avg: 632.2881 (0.260)
Ep: 448, Reward: 872.0109, Test: 857.6324 [64.34], Avg: 632.6467 (0.259)
Ep: 449, Reward: 850.6068, Test: 827.1856 [127.12], Avg: 632.7965 (0.259)
Ep: 450, Reward: 893.2754, Test: 814.7243 [127.20], Avg: 632.9179 (0.258)
Ep: 451, Reward: 898.2452, Test: 859.7272 [83.56], Avg: 633.2348 (0.257)
Ep: 452, Reward: 921.2254, Test: 883.4415 [18.32], Avg: 633.7467 (0.256)
Ep: 453, Reward: 854.5034, Test: 853.5551 [70.71], Avg: 634.0751 (0.256)
Ep: 454, Reward: 893.0722, Test: 868.0873 [39.52], Avg: 634.5025 (0.255)
Ep: 455, Reward: 873.0317, Test: 885.5433 [24.87], Avg: 634.9985 (0.254)
Ep: 456, Reward: 877.7833, Test: 833.9348 [55.39], Avg: 635.3126 (0.253)
Ep: 457, Reward: 898.2175, Test: 855.6628 [29.62], Avg: 635.7291 (0.253)
Ep: 458, Reward: 858.2852, Test: 851.2933 [28.15], Avg: 636.1374 (0.252)
Ep: 459, Reward: 874.4049, Test: 880.4306 [17.15], Avg: 636.6312 (0.251)
Ep: 460, Reward: 969.6528, Test: 780.9468 [169.71], Avg: 636.5761 (0.250)
Ep: 461, Reward: 873.1783, Test: 879.2105 [56.64], Avg: 636.9787 (0.250)
Ep: 462, Reward: 933.8362, Test: 882.8629 [23.35], Avg: 637.4593 (0.249)
Ep: 463, Reward: 868.0813, Test: 827.4471 [126.16], Avg: 637.5969 (0.248)
Ep: 464, Reward: 870.2332, Test: 816.5891 [139.30], Avg: 637.6822 (0.247)
Ep: 465, Reward: 824.8799, Test: 820.6079 [76.57], Avg: 637.9105 (0.247)
Ep: 466, Reward: 823.2368, Test: 877.7844 [20.11], Avg: 638.3810 (0.246)
Ep: 467, Reward: 887.1723, Test: 824.8040 [107.32], Avg: 638.5501 (0.245)
Ep: 468, Reward: 893.6919, Test: 842.1926 [102.85], Avg: 638.7650 (0.244)
Ep: 469, Reward: 916.6777, Test: 852.3342 [45.37], Avg: 639.1228 (0.244)
Ep: 470, Reward: 839.7753, Test: 869.2891 [77.85], Avg: 639.4462 (0.243)
Ep: 471, Reward: 900.7105, Test: 869.6382 [65.64], Avg: 639.7949 (0.242)
Ep: 472, Reward: 927.2198, Test: 851.1305 [76.37], Avg: 640.0802 (0.241)
Ep: 473, Reward: 840.2492, Test: 891.7145 [21.11], Avg: 640.5665 (0.241)
Ep: 474, Reward: 924.8324, Test: 888.5540 [23.61], Avg: 641.0389 (0.240)
Ep: 475, Reward: 938.8489, Test: 878.6490 [20.07], Avg: 641.4959 (0.239)
Ep: 476, Reward: 915.3080, Test: 882.5212 [38.96], Avg: 641.9195 (0.239)
Ep: 477, Reward: 919.0676, Test: 855.3801 [88.23], Avg: 642.1815 (0.238)
Ep: 478, Reward: 902.9821, Test: 874.2784 [34.00], Avg: 642.5951 (0.237)
Ep: 479, Reward: 841.1519, Test: 840.4501 [108.79], Avg: 642.7806 (0.236)
Ep: 480, Reward: 952.3965, Test: 876.0948 [40.39], Avg: 643.1817 (0.236)
Ep: 481, Reward: 899.1340, Test: 843.7882 [62.94], Avg: 643.4673 (0.235)
Ep: 482, Reward: 871.2593, Test: 854.1909 [128.54], Avg: 643.6375 (0.234)
Ep: 483, Reward: 891.9159, Test: 875.6874 [27.66], Avg: 644.0598 (0.234)
Ep: 484, Reward: 872.7937, Test: 889.0111 [17.38], Avg: 644.5290 (0.233)
Ep: 485, Reward: 864.2667, Test: 859.2175 [85.80], Avg: 644.7942 (0.232)
Ep: 486, Reward: 878.3321, Test: 862.9552 [33.28], Avg: 645.1738 (0.231)
Ep: 487, Reward: 872.2212, Test: 858.9256 [48.28], Avg: 645.5129 (0.231)
Ep: 488, Reward: 862.4833, Test: 869.8481 [70.97], Avg: 645.8265 (0.230)
Ep: 489, Reward: 971.4365, Test: 840.3598 [101.35], Avg: 646.0167 (0.229)
Ep: 490, Reward: 869.5193, Test: 880.4220 [43.73], Avg: 646.4050 (0.229)
Ep: 491, Reward: 886.8799, Test: 864.9133 [60.02], Avg: 646.7272 (0.228)
Ep: 492, Reward: 891.9986, Test: 850.7172 [54.92], Avg: 647.0295 (0.227)
Ep: 493, Reward: 967.2456, Test: 861.2348 [57.98], Avg: 647.3458 (0.227)
Ep: 494, Reward: 929.0609, Test: 883.2619 [27.23], Avg: 647.7674 (0.226)
Ep: 495, Reward: 958.5921, Test: 837.4337 [93.31], Avg: 647.9616 (0.225)
Ep: 496, Reward: 923.8950, Test: 886.3429 [25.19], Avg: 648.3906 (0.225)
Ep: 497, Reward: 889.2318, Test: 889.0446 [34.18], Avg: 648.8052 (0.224)
Ep: 498, Reward: 909.8680, Test: 869.6591 [69.56], Avg: 649.1084 (0.223)
Ep: 499, Reward: 951.6924, Test: 886.8607 [65.24], Avg: 649.4534 (0.223)
