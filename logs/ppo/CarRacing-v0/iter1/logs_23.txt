Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 4					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.01				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = action_mu if not sample else dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True, use_target=False):
		with torch.enable_grad() if grad else torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) + critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())
		self.soft_copy(self.critic_local, self.critic_target)

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)
		self.ppo_epochs = PPO_EPOCHS
		self.ppo_batch = BATCH_SIZE

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(zip(states, actions, log_probs, targets, advantages))
			for _ in range(self.ppo_epochs):
				for i in range(0, len(self.replay_buffer), self.ppo_batch):
					state, action, log_prob, target, advantage = self.replay_buffer.index(self.ppo_batch, i, torch.stack)
					self.network.optimize(state, action, log_prob, target, advantage, e_weight=self.eps*ENTROPY_WEIGHT, scale=16*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -31.6852, Test: -22.2072 [18.74], Avg: -40.9494 (0.995)
Ep: 1, Reward: -20.7306, Test: -29.0263 [5.27], Avg: -37.6243 (0.990)
Ep: 2, Reward: -19.9354, Test: -12.9606 [11.89], Avg: -33.3675 (0.985)
Ep: 3, Reward: -30.6379, Test: -8.9672 [14.94], Avg: -31.0017 (0.980)
Ep: 4, Reward: -44.7217, Test: -61.9642 [38.36], Avg: -44.8659 (0.975)
Ep: 5, Reward: -43.4751, Test: -64.2377 [10.94], Avg: -49.9181 (0.970)
Ep: 6, Reward: -50.4699, Test: -74.8932 [4.14], Avg: -54.0777 (0.966)
Ep: 7, Reward: -18.4473, Test: 113.4690 [89.03], Avg: -44.2629 (0.961)
Ep: 8, Reward: 0.2210, Test: 71.3873 [83.55], Avg: -40.6963 (0.956)
Ep: 9, Reward: -4.9763, Test: 157.1642 [95.41], Avg: -30.4510 (0.951)
Ep: 10, Reward: 67.3425, Test: 119.0726 [131.90], Avg: -28.8485 (0.946)
Ep: 11, Reward: 133.0296, Test: 125.0239 [109.08], Avg: -25.1162 (0.942)
Ep: 12, Reward: 141.5944, Test: 105.5705 [95.75], Avg: -22.4289 (0.937)
Ep: 13, Reward: 276.4312, Test: 93.6471 [80.92], Avg: -19.9175 (0.932)
Ep: 14, Reward: 468.4250, Test: 95.4666 [100.77], Avg: -18.9430 (0.928)
Ep: 15, Reward: 473.0528, Test: 84.4855 [90.94], Avg: -18.1627 (0.923)
Ep: 16, Reward: 576.7454, Test: 86.4664 [78.93], Avg: -16.6511 (0.918)
Ep: 17, Reward: 466.0148, Test: 191.3051 [94.77], Avg: -10.3629 (0.914)
Ep: 18, Reward: 554.6065, Test: 53.0441 [97.65], Avg: -12.1650 (0.909)
Ep: 19, Reward: 333.2751, Test: 87.9024 [103.76], Avg: -12.3495 (0.905)
Ep: 20, Reward: 382.2793, Test: 140.0131 [119.55], Avg: -10.7872 (0.900)
Ep: 21, Reward: 457.5385, Test: 132.1064 [119.15], Avg: -9.7081 (0.896)
Ep: 22, Reward: 461.2320, Test: 111.2583 [112.40], Avg: -9.3357 (0.891)
Ep: 23, Reward: 402.6695, Test: 141.6244 [90.88], Avg: -6.8324 (0.887)
Ep: 24, Reward: 426.6648, Test: 234.1469 [77.35], Avg: -0.2872 (0.882)
Ep: 25, Reward: 476.8392, Test: 151.5023 [95.72], Avg: 1.8693 (0.878)
Ep: 26, Reward: 381.3166, Test: 198.6489 [90.54], Avg: 5.8041 (0.873)
Ep: 27, Reward: 427.6946, Test: 202.1402 [86.84], Avg: 9.7148 (0.869)
Ep: 28, Reward: 469.1009, Test: 184.6344 [96.93], Avg: 12.4041 (0.865)
Ep: 29, Reward: 503.0721, Test: 172.0442 [130.19], Avg: 13.3858 (0.860)
Ep: 30, Reward: 493.3373, Test: 222.2346 [93.39], Avg: 17.1101 (0.856)
Ep: 31, Reward: 538.3121, Test: 309.6911 [83.63], Avg: 23.6397 (0.852)
Ep: 32, Reward: 469.7993, Test: 211.8537 [108.05], Avg: 26.0688 (0.848)
Ep: 33, Reward: 435.0463, Test: 195.7091 [98.40], Avg: 28.1640 (0.843)
Ep: 34, Reward: 399.8332, Test: 230.7842 [99.97], Avg: 31.0968 (0.839)
Ep: 35, Reward: 433.4647, Test: 275.9268 [181.85], Avg: 32.8463 (0.835)
Ep: 36, Reward: 421.4014, Test: 239.8040 [87.57], Avg: 36.0729 (0.831)
Ep: 37, Reward: 361.3231, Test: 193.6894 [73.89], Avg: 38.2761 (0.827)
Ep: 38, Reward: 449.3968, Test: 283.1905 [123.09], Avg: 41.3998 (0.822)
Ep: 39, Reward: 416.9736, Test: 256.1024 [88.71], Avg: 44.5496 (0.818)
Ep: 40, Reward: 464.4977, Test: 249.2384 [101.27], Avg: 47.0720 (0.814)
Ep: 41, Reward: 426.4223, Test: 331.5856 [102.48], Avg: 51.4061 (0.810)
Ep: 42, Reward: 367.0146, Test: 257.5932 [199.73], Avg: 51.5561 (0.806)
Ep: 43, Reward: 416.2847, Test: 372.4482 [173.23], Avg: 54.9122 (0.802)
Ep: 44, Reward: 477.1607, Test: 274.2151 [67.23], Avg: 58.2916 (0.798)
Ep: 45, Reward: 404.2665, Test: 392.0969 [199.49], Avg: 61.2116 (0.794)
Ep: 46, Reward: 479.1380, Test: 260.8607 [137.36], Avg: 62.5368 (0.790)
Ep: 47, Reward: 406.0592, Test: 342.8754 [186.67], Avg: 64.4883 (0.786)
Ep: 48, Reward: 422.7285, Test: 369.7093 [122.59], Avg: 68.2154 (0.782)
Ep: 49, Reward: 372.3935, Test: 224.1941 [141.63], Avg: 68.5024 (0.778)
Ep: 50, Reward: 345.6317, Test: 257.8546 [104.23], Avg: 70.1714 (0.774)
Ep: 51, Reward: 468.7228, Test: 367.4815 [151.47], Avg: 72.9761 (0.771)
Ep: 52, Reward: 394.3738, Test: 261.5052 [71.54], Avg: 75.1834 (0.767)
Ep: 53, Reward: 380.9089, Test: 306.9497 [134.98], Avg: 76.9757 (0.763)
Ep: 54, Reward: 474.0798, Test: 281.3939 [145.71], Avg: 78.0431 (0.759)
Ep: 55, Reward: 446.0993, Test: 388.7438 [140.78], Avg: 81.0775 (0.755)
Ep: 56, Reward: 373.4891, Test: 321.4469 [157.35], Avg: 82.5339 (0.751)
Ep: 57, Reward: 443.7295, Test: 498.8567 [162.49], Avg: 86.9104 (0.748)
Ep: 58, Reward: 416.8913, Test: 346.3833 [196.23], Avg: 87.9824 (0.744)
Ep: 59, Reward: 473.3781, Test: 275.6985 [117.28], Avg: 89.1563 (0.740)
Ep: 60, Reward: 443.4033, Test: 416.9208 [147.64], Avg: 92.1091 (0.737)
Ep: 61, Reward: 408.1330, Test: 281.2285 [170.54], Avg: 92.4087 (0.733)
Ep: 62, Reward: 420.3556, Test: 363.5050 [155.20], Avg: 94.2484 (0.729)
Ep: 63, Reward: 397.2044, Test: 290.8517 [166.39], Avg: 94.7204 (0.726)
Ep: 64, Reward: 405.5265, Test: 255.1187 [153.04], Avg: 94.8337 (0.722)
Ep: 65, Reward: 285.5718, Test: 286.0127 [122.86], Avg: 95.8688 (0.718)
Ep: 66, Reward: 379.1104, Test: 279.3385 [150.15], Avg: 96.3661 (0.715)
Ep: 67, Reward: 320.3965, Test: 346.1450 [147.94], Avg: 97.8637 (0.711)
Ep: 68, Reward: 356.0946, Test: 257.8424 [112.37], Avg: 98.5537 (0.708)
Ep: 69, Reward: 420.7622, Test: 321.1426 [171.60], Avg: 99.2820 (0.704)
Ep: 70, Reward: 324.1487, Test: 250.0964 [101.89], Avg: 99.9712 (0.701)
Ep: 71, Reward: 335.7785, Test: 220.9951 [100.61], Avg: 100.2547 (0.697)
Ep: 72, Reward: 348.4722, Test: 246.1620 [91.93], Avg: 100.9941 (0.694)
Ep: 73, Reward: 358.0809, Test: 173.0702 [107.52], Avg: 100.5151 (0.690)
Ep: 74, Reward: 302.7460, Test: 228.5992 [141.69], Avg: 100.3337 (0.687)
Ep: 75, Reward: 313.0215, Test: 313.3116 [126.43], Avg: 101.4725 (0.683)
Ep: 76, Reward: 334.0544, Test: 219.0210 [124.65], Avg: 101.3803 (0.680)
Ep: 77, Reward: 379.5204, Test: 302.9863 [42.91], Avg: 103.4149 (0.676)
Ep: 78, Reward: 290.5332, Test: 265.4255 [93.42], Avg: 104.2830 (0.673)
Ep: 79, Reward: 329.3866, Test: 214.7441 [91.37], Avg: 104.5217 (0.670)
Ep: 80, Reward: 333.4212, Test: 236.4046 [110.58], Avg: 104.7847 (0.666)
Ep: 81, Reward: 384.0720, Test: 303.2625 [88.46], Avg: 106.1263 (0.663)
Ep: 82, Reward: 322.6370, Test: 271.7774 [101.87], Avg: 106.8948 (0.660)
Ep: 83, Reward: 379.3548, Test: 353.8814 [131.07], Avg: 108.2747 (0.656)
Ep: 84, Reward: 387.7894, Test: 333.1687 [188.05], Avg: 108.7081 (0.653)
Ep: 85, Reward: 418.8896, Test: 308.9604 [86.30], Avg: 110.0331 (0.650)
Ep: 86, Reward: 391.5552, Test: 283.5792 [180.98], Avg: 109.9476 (0.647)
Ep: 87, Reward: 455.6610, Test: 249.5237 [147.49], Avg: 109.8577 (0.643)
Ep: 88, Reward: 399.0420, Test: 278.5982 [75.78], Avg: 110.9022 (0.640)
Ep: 89, Reward: 414.8364, Test: 241.8051 [93.40], Avg: 111.3189 (0.637)
Ep: 90, Reward: 434.7255, Test: 246.4654 [149.72], Avg: 111.1587 (0.634)
Ep: 91, Reward: 405.9289, Test: 236.9398 [74.75], Avg: 111.7134 (0.631)
Ep: 92, Reward: 323.0008, Test: 297.1247 [123.63], Avg: 112.3777 (0.627)
Ep: 93, Reward: 411.6608, Test: 209.0082 [114.18], Avg: 112.1911 (0.624)
Ep: 94, Reward: 408.2904, Test: 250.0089 [131.52], Avg: 112.2573 (0.621)
Ep: 95, Reward: 402.0822, Test: 178.1066 [136.19], Avg: 111.5246 (0.618)
Ep: 96, Reward: 384.0910, Test: 292.7848 [109.98], Avg: 112.2595 (0.615)
Ep: 97, Reward: 409.0982, Test: 248.3132 [145.67], Avg: 112.1613 (0.612)
Ep: 98, Reward: 448.9747, Test: 315.5422 [112.90], Avg: 113.0753 (0.609)
Ep: 99, Reward: 419.3458, Test: 290.1235 [138.43], Avg: 113.4615 (0.606)
Ep: 100, Reward: 468.2617, Test: 365.4073 [61.50], Avg: 115.3471 (0.603)
Ep: 101, Reward: 430.7908, Test: 296.1505 [82.07], Avg: 116.3151 (0.600)
Ep: 102, Reward: 459.8108, Test: 274.6986 [121.21], Avg: 116.6760 (0.597)
Ep: 103, Reward: 455.7159, Test: 269.4317 [106.31], Avg: 117.1226 (0.594)
Ep: 104, Reward: 366.3398, Test: 344.8023 [75.78], Avg: 118.5693 (0.591)
Ep: 105, Reward: 481.4397, Test: 323.5515 [111.75], Avg: 119.4488 (0.588)
Ep: 106, Reward: 462.3862, Test: 229.1083 [132.25], Avg: 119.2377 (0.585)
Ep: 107, Reward: 429.2331, Test: 373.4870 [77.22], Avg: 120.8769 (0.582)
Ep: 108, Reward: 454.9439, Test: 301.0399 [197.70], Avg: 120.7160 (0.579)
Ep: 109, Reward: 386.6514, Test: 365.6905 [159.64], Avg: 121.4918 (0.576)
Ep: 110, Reward: 452.5491, Test: 341.3277 [49.88], Avg: 123.0229 (0.573)
Ep: 111, Reward: 400.9798, Test: 310.8062 [228.67], Avg: 122.6579 (0.570)
Ep: 112, Reward: 491.1941, Test: 324.7293 [123.38], Avg: 123.3543 (0.568)
Ep: 113, Reward: 467.8691, Test: 286.3304 [100.60], Avg: 123.9014 (0.565)
Ep: 114, Reward: 425.6489, Test: 385.5133 [98.20], Avg: 125.3224 (0.562)
Ep: 115, Reward: 396.5052, Test: 345.3514 [165.67], Avg: 125.7910 (0.559)
Ep: 116, Reward: 468.0829, Test: 364.0984 [101.40], Avg: 126.9612 (0.556)
Ep: 117, Reward: 409.8295, Test: 322.3593 [130.31], Avg: 127.5127 (0.554)
Ep: 118, Reward: 467.2592, Test: 325.1327 [147.77], Avg: 127.9316 (0.551)
Ep: 119, Reward: 509.0160, Test: 345.5090 [140.46], Avg: 128.5743 (0.548)
Ep: 120, Reward: 418.0055, Test: 300.0145 [84.11], Avg: 129.2960 (0.545)
Ep: 121, Reward: 480.5325, Test: 398.1524 [157.52], Avg: 130.2086 (0.543)
Ep: 122, Reward: 361.4971, Test: 324.5684 [102.29], Avg: 130.9571 (0.540)
Ep: 123, Reward: 438.6566, Test: 310.6153 [160.44], Avg: 131.1121 (0.537)
Ep: 124, Reward: 476.2751, Test: 324.1855 [128.51], Avg: 131.6287 (0.534)
Ep: 125, Reward: 478.1473, Test: 363.1063 [90.39], Avg: 132.7484 (0.532)
Ep: 126, Reward: 377.7940, Test: 300.8356 [109.94], Avg: 133.2062 (0.529)
Ep: 127, Reward: 414.4042, Test: 271.9159 [142.60], Avg: 133.1759 (0.526)
Ep: 128, Reward: 419.7343, Test: 299.0942 [200.74], Avg: 132.9059 (0.524)
Ep: 129, Reward: 476.1476, Test: 331.6076 [90.92], Avg: 133.7350 (0.521)
Ep: 130, Reward: 411.1175, Test: 387.3951 [104.15], Avg: 134.8763 (0.519)
Ep: 131, Reward: 430.3756, Test: 370.5677 [77.39], Avg: 136.0755 (0.516)
Ep: 132, Reward: 396.8548, Test: 316.0147 [79.55], Avg: 136.8303 (0.513)
Ep: 133, Reward: 476.7870, Test: 371.2608 [170.37], Avg: 137.3084 (0.511)
Ep: 134, Reward: 478.2108, Test: 361.0823 [115.37], Avg: 138.1113 (0.508)
Ep: 135, Reward: 408.1532, Test: 384.4088 [102.12], Avg: 139.1715 (0.506)
Ep: 136, Reward: 516.2586, Test: 371.6892 [108.80], Avg: 140.0745 (0.503)
Ep: 137, Reward: 543.5759, Test: 367.6002 [149.23], Avg: 140.6419 (0.501)
Ep: 138, Reward: 435.9227, Test: 319.9641 [83.74], Avg: 141.3295 (0.498)
Ep: 139, Reward: 490.1265, Test: 348.0303 [84.80], Avg: 142.2002 (0.496)
Ep: 140, Reward: 393.3869, Test: 432.4757 [158.90], Avg: 143.1320 (0.493)
Ep: 141, Reward: 416.4981, Test: 501.0400 [174.36], Avg: 144.4246 (0.491)
Ep: 142, Reward: 482.6113, Test: 393.5158 [126.87], Avg: 145.2793 (0.488)
Ep: 143, Reward: 491.6746, Test: 421.0143 [183.10], Avg: 145.9226 (0.486)
Ep: 144, Reward: 430.6801, Test: 394.7167 [146.28], Avg: 146.6295 (0.483)
Ep: 145, Reward: 425.2253, Test: 491.0581 [141.51], Avg: 148.0194 (0.481)
Ep: 146, Reward: 480.5932, Test: 308.4091 [147.02], Avg: 148.1103 (0.479)
Ep: 147, Reward: 500.5659, Test: 352.8933 [161.68], Avg: 148.4015 (0.476)
Ep: 148, Reward: 422.1627, Test: 397.9023 [84.25], Avg: 149.5106 (0.474)
Ep: 149, Reward: 442.4547, Test: 459.4643 [145.26], Avg: 150.6086 (0.471)
Ep: 150, Reward: 445.0694, Test: 393.7137 [101.94], Avg: 151.5435 (0.469)
Ep: 151, Reward: 412.7021, Test: 356.2431 [118.91], Avg: 152.1079 (0.467)
Ep: 152, Reward: 498.6540, Test: 406.6613 [176.50], Avg: 152.6180 (0.464)
Ep: 153, Reward: 455.2127, Test: 333.4934 [136.74], Avg: 152.9046 (0.462)
Ep: 154, Reward: 396.6562, Test: 398.0780 [139.17], Avg: 153.5884 (0.460)
Ep: 155, Reward: 413.2107, Test: 354.3469 [137.05], Avg: 153.9968 (0.458)
Ep: 156, Reward: 472.8376, Test: 340.5530 [91.06], Avg: 154.6051 (0.455)
Ep: 157, Reward: 423.8728, Test: 254.0024 [131.25], Avg: 154.4035 (0.453)
Ep: 158, Reward: 492.5305, Test: 360.7639 [125.90], Avg: 154.9095 (0.451)
Ep: 159, Reward: 385.8869, Test: 315.3123 [118.90], Avg: 155.1689 (0.448)
Ep: 160, Reward: 390.7506, Test: 324.5900 [148.96], Avg: 155.2960 (0.446)
Ep: 161, Reward: 375.4949, Test: 188.3253 [153.47], Avg: 154.5526 (0.444)
Ep: 162, Reward: 427.5930, Test: 201.0175 [59.66], Avg: 154.4716 (0.440)
Ep: 163, Reward: 435.6807, Test: 343.9984 [94.81], Avg: 155.0491 (0.437)
Ep: 164, Reward: 451.7073, Test: 295.5528 [72.77], Avg: 155.4596 (0.435)
Ep: 165, Reward: 393.0377, Test: 210.2551 [99.05], Avg: 155.1930 (0.433)
Ep: 166, Reward: 454.9629, Test: 218.5540 [138.02], Avg: 154.7460 (0.431)
Ep: 167, Reward: 376.9140, Test: 295.2707 [228.64], Avg: 154.2215 (0.429)
Ep: 168, Reward: 464.2502, Test: 323.5797 [163.63], Avg: 154.2554 (0.427)
Ep: 169, Reward: 416.7095, Test: 250.3659 [137.29], Avg: 154.0131 (0.424)
Ep: 170, Reward: 416.8889, Test: 307.0930 [110.56], Avg: 154.2618 (0.422)
Ep: 171, Reward: 480.4953, Test: 232.9904 [89.90], Avg: 154.1969 (0.418)
Ep: 172, Reward: 426.5797, Test: 260.2909 [147.08], Avg: 153.9599 (0.414)
Ep: 173, Reward: 433.4073, Test: 392.1979 [217.97], Avg: 154.0764 (0.412)
Ep: 174, Reward: 464.8870, Test: 208.0524 [85.29], Avg: 153.8975 (0.410)
Ep: 175, Reward: 419.8427, Test: 266.7154 [133.06], Avg: 153.7825 (0.408)
Ep: 176, Reward: 389.5396, Test: 437.2334 [181.43], Avg: 154.3589 (0.406)
Ep: 177, Reward: 588.8999, Test: 292.0095 [107.40], Avg: 154.5288 (0.404)
Ep: 178, Reward: 488.6776, Test: 247.4095 [80.65], Avg: 154.5972 (0.402)
Ep: 179, Reward: 449.1923, Test: 291.8739 [55.41], Avg: 155.0520 (0.400)
Ep: 180, Reward: 491.8857, Test: 292.8860 [177.04], Avg: 154.8353 (0.398)
Ep: 181, Reward: 494.9242, Test: 308.6698 [140.45], Avg: 154.9089 (0.396)
Ep: 182, Reward: 463.4108, Test: 271.2549 [118.55], Avg: 154.8969 (0.394)
Ep: 183, Reward: 482.0779, Test: 327.9089 [171.34], Avg: 154.9059 (0.392)
Ep: 184, Reward: 542.1617, Test: 233.4246 [144.21], Avg: 154.5509 (0.390)
Ep: 185, Reward: 523.4089, Test: 359.0041 [150.36], Avg: 154.8417 (0.388)
Ep: 186, Reward: 374.6702, Test: 484.7243 [249.87], Avg: 155.2695 (0.386)
Ep: 187, Reward: 425.8645, Test: 413.1995 [185.72], Avg: 155.6536 (0.384)
Ep: 188, Reward: 460.4269, Test: 407.1032 [190.30], Avg: 155.9772 (0.382)
Ep: 189, Reward: 501.1610, Test: 451.6158 [120.08], Avg: 156.9012 (0.380)
Ep: 190, Reward: 513.5569, Test: 481.7617 [167.30], Avg: 157.7261 (0.378)
Ep: 191, Reward: 447.4380, Test: 362.5043 [151.72], Avg: 158.0025 (0.376)
Ep: 192, Reward: 491.3015, Test: 367.0291 [107.85], Avg: 158.5267 (0.374)
Ep: 193, Reward: 571.6294, Test: 454.3939 [117.89], Avg: 159.4441 (0.373)
Ep: 194, Reward: 380.3681, Test: 385.0298 [168.85], Avg: 159.7351 (0.371)
Ep: 195, Reward: 512.1125, Test: 403.1500 [216.97], Avg: 159.8700 (0.369)
Ep: 196, Reward: 505.7483, Test: 466.3937 [172.58], Avg: 160.5499 (0.367)
Ep: 197, Reward: 485.4077, Test: 330.6878 [123.02], Avg: 160.7879 (0.363)
Ep: 198, Reward: 437.7452, Test: 413.9265 [169.08], Avg: 161.2103 (0.361)
Ep: 199, Reward: 519.0472, Test: 398.9506 [128.35], Avg: 161.7572 (0.360)
Ep: 200, Reward: 464.6171, Test: 432.1700 [210.09], Avg: 162.0573 (0.358)
Ep: 201, Reward: 539.3975, Test: 330.5486 [183.74], Avg: 161.9818 (0.354)
Ep: 202, Reward: 458.0684, Test: 423.8506 [152.18], Avg: 162.5222 (0.353)
Ep: 203, Reward: 447.8414, Test: 428.4997 [118.57], Avg: 163.2447 (0.351)
Ep: 204, Reward: 452.8180, Test: 477.6500 [134.19], Avg: 164.1238 (0.349)
Ep: 205, Reward: 527.8684, Test: 379.6421 [173.44], Avg: 164.3281 (0.347)
Ep: 206, Reward: 424.9378, Test: 486.9635 [112.68], Avg: 165.3424 (0.346)
Ep: 207, Reward: 619.0217, Test: 290.4990 [155.42], Avg: 165.1969 (0.344)
Ep: 208, Reward: 550.3321, Test: 415.7513 [120.70], Avg: 165.8182 (0.342)
Ep: 209, Reward: 517.7228, Test: 405.6473 [171.14], Avg: 166.1453 (0.340)
Ep: 210, Reward: 488.0081, Test: 408.7826 [141.05], Avg: 166.6268 (0.339)
Ep: 211, Reward: 464.8638, Test: 426.1180 [171.38], Avg: 167.0423 (0.337)
Ep: 212, Reward: 522.9237, Test: 363.9470 [138.95], Avg: 167.3144 (0.335)
Ep: 213, Reward: 522.5480, Test: 377.3382 [149.98], Avg: 167.5950 (0.334)
Ep: 214, Reward: 568.7575, Test: 424.0992 [203.30], Avg: 167.8425 (0.332)
Ep: 215, Reward: 415.7551, Test: 397.5396 [128.23], Avg: 168.3123 (0.330)
Ep: 216, Reward: 540.7548, Test: 458.2820 [194.49], Avg: 168.7523 (0.329)
Ep: 217, Reward: 522.6497, Test: 388.2029 [151.85], Avg: 169.0623 (0.327)
Ep: 218, Reward: 379.0055, Test: 492.0089 [160.53], Avg: 169.8040 (0.325)
Ep: 219, Reward: 525.1994, Test: 339.0785 [98.21], Avg: 170.1270 (0.324)
Ep: 220, Reward: 539.5125, Test: 366.6778 [84.32], Avg: 170.6348 (0.322)
Ep: 221, Reward: 584.5192, Test: 410.4791 [107.12], Avg: 171.2327 (0.321)
Ep: 222, Reward: 548.2275, Test: 394.4845 [136.97], Avg: 171.6196 (0.319)
Ep: 223, Reward: 405.7124, Test: 382.3640 [100.36], Avg: 172.1124 (0.317)
Ep: 224, Reward: 541.5886, Test: 444.8118 [162.85], Avg: 172.6006 (0.316)
Ep: 225, Reward: 538.0610, Test: 341.5830 [146.58], Avg: 172.6997 (0.314)
Ep: 226, Reward: 530.2887, Test: 547.0559 [105.04], Avg: 173.8861 (0.313)
Ep: 227, Reward: 484.2636, Test: 404.9322 [140.55], Avg: 174.2830 (0.311)
Ep: 228, Reward: 599.4633, Test: 386.9375 [119.56], Avg: 174.6896 (0.309)
Ep: 229, Reward: 563.6488, Test: 396.6841 [150.87], Avg: 174.9988 (0.308)
Ep: 230, Reward: 497.6429, Test: 440.9988 [159.57], Avg: 175.4596 (0.306)
Ep: 231, Reward: 551.5922, Test: 420.9696 [108.20], Avg: 176.0514 (0.305)
Ep: 232, Reward: 454.4571, Test: 429.2684 [82.67], Avg: 176.7834 (0.303)
Ep: 233, Reward: 530.7002, Test: 441.8709 [114.08], Avg: 177.4287 (0.302)
Ep: 234, Reward: 538.2858, Test: 307.9590 [126.21], Avg: 177.4471 (0.300)
Ep: 235, Reward: 518.1763, Test: 385.2646 [123.40], Avg: 177.8048 (0.299)
Ep: 236, Reward: 563.7933, Test: 390.0354 [99.68], Avg: 178.2797 (0.297)
Ep: 237, Reward: 586.5175, Test: 387.9185 [87.14], Avg: 178.7944 (0.296)
Ep: 238, Reward: 630.5444, Test: 395.5895 [159.22], Avg: 179.0353 (0.294)
Ep: 239, Reward: 524.3337, Test: 441.0583 [141.38], Avg: 179.5380 (0.293)
Ep: 240, Reward: 619.3494, Test: 445.5347 [150.07], Avg: 180.0190 (0.291)
Ep: 241, Reward: 495.7327, Test: 485.4465 [153.47], Avg: 180.6469 (0.290)
Ep: 242, Reward: 649.3397, Test: 345.1043 [166.72], Avg: 180.6376 (0.288)
Ep: 243, Reward: 482.7781, Test: 378.4742 [164.47], Avg: 180.7744 (0.287)
Ep: 244, Reward: 534.6633, Test: 409.5959 [156.31], Avg: 181.0703 (0.286)
Ep: 245, Reward: 607.4648, Test: 526.8492 [134.31], Avg: 181.9300 (0.284)
Ep: 246, Reward: 386.8388, Test: 403.2028 [150.49], Avg: 182.2165 (0.283)
Ep: 247, Reward: 537.8480, Test: 442.6306 [108.58], Avg: 182.8288 (0.281)
Ep: 248, Reward: 578.4304, Test: 466.4441 [185.55], Avg: 183.2226 (0.280)
Ep: 249, Reward: 588.5542, Test: 347.3388 [156.05], Avg: 183.2549 (0.279)
Ep: 250, Reward: 499.9786, Test: 282.7646 [144.74], Avg: 183.0747 (0.277)
Ep: 251, Reward: 486.1254, Test: 589.3043 [111.18], Avg: 184.2455 (0.276)
Ep: 252, Reward: 535.3333, Test: 417.9724 [132.93], Avg: 184.6439 (0.274)
Ep: 253, Reward: 577.0998, Test: 526.8760 [178.77], Avg: 185.2875 (0.273)
Ep: 254, Reward: 546.3484, Test: 432.1113 [164.12], Avg: 185.6118 (0.272)
Ep: 255, Reward: 596.2301, Test: 425.3325 [135.36], Avg: 186.0194 (0.270)
Ep: 256, Reward: 620.2303, Test: 377.9400 [154.47], Avg: 186.1652 (0.269)
Ep: 257, Reward: 526.1900, Test: 368.1740 [151.01], Avg: 186.2853 (0.268)
Ep: 258, Reward: 550.4137, Test: 459.3220 [143.67], Avg: 186.7848 (0.266)
Ep: 259, Reward: 434.1617, Test: 428.5420 [133.96], Avg: 187.1994 (0.265)
Ep: 260, Reward: 488.0216, Test: 382.8249 [124.77], Avg: 187.4709 (0.264)
Ep: 261, Reward: 540.4887, Test: 429.0754 [116.24], Avg: 187.9494 (0.262)
Ep: 262, Reward: 526.2048, Test: 448.2618 [86.51], Avg: 188.6102 (0.261)
Ep: 263, Reward: 584.7592, Test: 415.3554 [163.56], Avg: 188.8496 (0.260)
Ep: 264, Reward: 590.3016, Test: 430.8909 [155.29], Avg: 189.1769 (0.258)
Ep: 265, Reward: 558.8413, Test: 422.0113 [145.90], Avg: 189.5038 (0.257)
Ep: 266, Reward: 615.1949, Test: 401.1188 [123.72], Avg: 189.8329 (0.256)
Ep: 267, Reward: 536.9982, Test: 386.7666 [118.61], Avg: 190.1252 (0.255)
Ep: 268, Reward: 558.1515, Test: 424.7452 [119.71], Avg: 190.5524 (0.253)
Ep: 269, Reward: 531.4318, Test: 481.3724 [132.27], Avg: 191.1396 (0.252)
Ep: 270, Reward: 582.0412, Test: 493.1673 [134.33], Avg: 191.7584 (0.251)
Ep: 271, Reward: 647.7216, Test: 433.0477 [109.55], Avg: 192.2428 (0.249)
Ep: 272, Reward: 583.0595, Test: 386.9230 [137.48], Avg: 192.4523 (0.248)
Ep: 273, Reward: 557.8184, Test: 414.6291 [125.65], Avg: 192.8046 (0.247)
Ep: 274, Reward: 573.2326, Test: 490.5674 [142.85], Avg: 193.3679 (0.246)
Ep: 275, Reward: 586.8193, Test: 429.3793 [115.36], Avg: 193.8050 (0.245)
Ep: 276, Reward: 658.7150, Test: 347.4852 [110.68], Avg: 193.9602 (0.243)
Ep: 277, Reward: 652.7337, Test: 458.8515 [127.85], Avg: 194.4532 (0.242)
Ep: 278, Reward: 537.7636, Test: 548.0367 [98.63], Avg: 195.3670 (0.241)
Ep: 279, Reward: 551.5168, Test: 349.4242 [139.96], Avg: 195.4173 (0.240)
Ep: 280, Reward: 607.0299, Test: 444.0023 [137.12], Avg: 195.8140 (0.238)
Ep: 281, Reward: 586.6652, Test: 495.6428 [136.16], Avg: 196.3944 (0.237)
Ep: 282, Reward: 601.3308, Test: 437.3363 [140.28], Avg: 196.7501 (0.236)
Ep: 283, Reward: 634.9822, Test: 475.4253 [124.86], Avg: 197.2917 (0.235)
Ep: 284, Reward: 597.0309, Test: 464.3377 [107.15], Avg: 197.8528 (0.234)
Ep: 285, Reward: 639.0374, Test: 442.5901 [216.08], Avg: 197.9530 (0.233)
Ep: 286, Reward: 566.4800, Test: 500.1427 [161.07], Avg: 198.4447 (0.231)
Ep: 287, Reward: 545.1035, Test: 456.9951 [154.99], Avg: 198.8043 (0.230)
Ep: 288, Reward: 578.0796, Test: 366.0847 [124.32], Avg: 198.9529 (0.229)
Ep: 289, Reward: 486.6414, Test: 510.7575 [175.42], Avg: 199.4232 (0.228)
Ep: 290, Reward: 558.2759, Test: 388.9530 [149.04], Avg: 199.5623 (0.227)
Ep: 291, Reward: 521.9103, Test: 345.0006 [178.29], Avg: 199.4498 (0.226)
Ep: 292, Reward: 629.0514, Test: 489.6549 [129.20], Avg: 199.9993 (0.225)
Ep: 293, Reward: 575.8701, Test: 429.6880 [211.48], Avg: 200.0612 (0.223)
Ep: 294, Reward: 515.2099, Test: 375.6948 [146.82], Avg: 200.1589 (0.222)
Ep: 295, Reward: 511.1401, Test: 448.3649 [109.58], Avg: 200.6272 (0.221)
Ep: 296, Reward: 620.9706, Test: 468.2509 [132.26], Avg: 201.0830 (0.220)
Ep: 297, Reward: 562.3229, Test: 398.0134 [100.56], Avg: 201.4064 (0.219)
Ep: 298, Reward: 515.9605, Test: 382.3149 [215.80], Avg: 201.2897 (0.218)
Ep: 299, Reward: 518.1709, Test: 376.4293 [139.50], Avg: 201.4085 (0.217)
Ep: 300, Reward: 541.1408, Test: 430.6347 [188.80], Avg: 201.5428 (0.216)
Ep: 301, Reward: 578.7987, Test: 487.9985 [164.89], Avg: 201.9453 (0.215)
Ep: 302, Reward: 590.7830, Test: 519.2431 [137.59], Avg: 202.5384 (0.214)
Ep: 303, Reward: 533.8364, Test: 402.0899 [132.37], Avg: 202.7594 (0.212)
Ep: 304, Reward: 559.8960, Test: 448.8785 [136.00], Avg: 203.1205 (0.211)
Ep: 305, Reward: 587.8902, Test: 553.0240 [178.02], Avg: 203.6822 (0.210)
Ep: 306, Reward: 575.5699, Test: 408.7277 [158.39], Avg: 203.8341 (0.209)
Ep: 307, Reward: 576.4810, Test: 452.6008 [176.46], Avg: 204.0689 (0.208)
Ep: 308, Reward: 665.4967, Test: 375.2645 [125.09], Avg: 204.2181 (0.207)
Ep: 309, Reward: 530.8053, Test: 488.0537 [129.91], Avg: 204.7147 (0.206)
Ep: 310, Reward: 534.7564, Test: 499.9831 [149.43], Avg: 205.1836 (0.205)
Ep: 311, Reward: 529.3413, Test: 367.7256 [134.54], Avg: 205.2733 (0.204)
Ep: 312, Reward: 550.6651, Test: 481.9416 [209.86], Avg: 205.4868 (0.203)
Ep: 313, Reward: 574.7215, Test: 457.1871 [117.77], Avg: 205.9133 (0.202)
Ep: 314, Reward: 547.8857, Test: 351.4384 [107.71], Avg: 206.0334 (0.201)
Ep: 315, Reward: 599.7395, Test: 443.5397 [125.89], Avg: 206.3866 (0.200)
Ep: 316, Reward: 550.3580, Test: 386.3589 [159.31], Avg: 206.4518 (0.199)
Ep: 317, Reward: 506.4045, Test: 415.4410 [101.67], Avg: 206.7892 (0.198)
Ep: 318, Reward: 600.5886, Test: 276.3379 [87.78], Avg: 206.7321 (0.197)
Ep: 319, Reward: 595.8154, Test: 421.0708 [164.73], Avg: 206.8871 (0.196)
Ep: 320, Reward: 505.8974, Test: 435.3999 [154.37], Avg: 207.1181 (0.195)
Ep: 321, Reward: 556.5394, Test: 458.8461 [156.16], Avg: 207.4149 (0.194)
Ep: 322, Reward: 628.9764, Test: 445.4123 [133.94], Avg: 207.7370 (0.193)
Ep: 323, Reward: 560.9561, Test: 425.2376 [100.76], Avg: 208.0974 (0.192)
Ep: 324, Reward: 503.9213, Test: 437.7010 [198.21], Avg: 208.1940 (0.191)
Ep: 325, Reward: 579.0555, Test: 390.4556 [188.91], Avg: 208.1736 (0.190)
Ep: 326, Reward: 571.8607, Test: 518.2954 [124.17], Avg: 208.7422 (0.189)
Ep: 327, Reward: 658.5644, Test: 347.2394 [134.32], Avg: 208.7550 (0.188)
Ep: 328, Reward: 617.5280, Test: 499.2186 [150.69], Avg: 209.1798 (0.187)
Ep: 329, Reward: 600.2974, Test: 395.5512 [126.40], Avg: 209.3615 (0.187)
Ep: 330, Reward: 613.9785, Test: 384.8451 [174.71], Avg: 209.3639 (0.186)
Ep: 331, Reward: 553.9849, Test: 401.4792 [93.49], Avg: 209.6609 (0.185)
Ep: 332, Reward: 614.4675, Test: 471.8620 [170.63], Avg: 209.9359 (0.184)
Ep: 333, Reward: 496.5372, Test: 368.6233 [128.44], Avg: 210.0264 (0.183)
Ep: 334, Reward: 578.5981, Test: 428.1894 [127.41], Avg: 210.2973 (0.182)
Ep: 335, Reward: 557.5344, Test: 491.1137 [191.65], Avg: 210.5627 (0.181)
Ep: 336, Reward: 584.4163, Test: 423.3623 [197.84], Avg: 210.6071 (0.180)
Ep: 337, Reward: 547.6601, Test: 436.4221 [188.84], Avg: 210.7165 (0.179)
Ep: 338, Reward: 563.2210, Test: 386.0392 [147.90], Avg: 210.7974 (0.178)
Ep: 339, Reward: 650.3304, Test: 342.1969 [194.82], Avg: 210.6109 (0.177)
Ep: 340, Reward: 586.6622, Test: 394.6769 [118.97], Avg: 210.8018 (0.177)
Ep: 341, Reward: 547.0185, Test: 360.6495 [125.61], Avg: 210.8726 (0.176)
Ep: 342, Reward: 577.4716, Test: 354.9154 [174.48], Avg: 210.7839 (0.175)
Ep: 343, Reward: 611.7320, Test: 449.3283 [128.93], Avg: 211.1025 (0.174)
Ep: 344, Reward: 531.6580, Test: 410.5538 [114.18], Avg: 211.3497 (0.173)
Ep: 345, Reward: 561.5559, Test: 319.5059 [140.40], Avg: 211.2565 (0.172)
Ep: 346, Reward: 445.4488, Test: 353.8804 [123.65], Avg: 211.3112 (0.171)
Ep: 347, Reward: 471.4786, Test: 399.6219 [125.90], Avg: 211.4905 (0.170)
Ep: 348, Reward: 616.9135, Test: 324.3838 [108.90], Avg: 211.5019 (0.170)
Ep: 349, Reward: 556.3850, Test: 473.3411 [156.08], Avg: 211.8041 (0.169)
Ep: 350, Reward: 572.3807, Test: 377.4839 [129.91], Avg: 211.9060 (0.168)
Ep: 351, Reward: 629.0666, Test: 425.2143 [116.40], Avg: 212.1813 (0.167)
Ep: 352, Reward: 580.2410, Test: 461.6911 [72.27], Avg: 212.6834 (0.166)
Ep: 353, Reward: 526.4208, Test: 385.2775 [127.80], Avg: 212.8100 (0.165)
Ep: 354, Reward: 583.0124, Test: 279.8794 [133.16], Avg: 212.6238 (0.165)
Ep: 355, Reward: 605.1947, Test: 459.0440 [115.75], Avg: 212.9908 (0.164)
Ep: 356, Reward: 558.7787, Test: 499.5113 [134.59], Avg: 213.4164 (0.163)
Ep: 357, Reward: 556.9451, Test: 427.1528 [107.53], Avg: 213.7131 (0.162)
Ep: 358, Reward: 563.4571, Test: 424.3594 [182.54], Avg: 213.7914 (0.161)
Ep: 359, Reward: 539.8128, Test: 386.1948 [179.25], Avg: 213.7724 (0.160)
Ep: 360, Reward: 524.4186, Test: 477.3928 [204.04], Avg: 213.9374 (0.160)
Ep: 361, Reward: 625.5188, Test: 374.1709 [168.30], Avg: 213.9151 (0.159)
Ep: 362, Reward: 587.6540, Test: 363.2005 [155.64], Avg: 213.8976 (0.158)
Ep: 363, Reward: 552.9772, Test: 336.3890 [143.13], Avg: 213.8409 (0.157)
Ep: 364, Reward: 511.4840, Test: 373.3057 [157.53], Avg: 213.8462 (0.157)
Ep: 365, Reward: 520.3294, Test: 385.0317 [184.97], Avg: 213.8085 (0.156)
Ep: 366, Reward: 536.7185, Test: 369.1470 [161.09], Avg: 213.7929 (0.155)
Ep: 367, Reward: 568.3019, Test: 456.9453 [197.44], Avg: 213.9171 (0.154)
Ep: 368, Reward: 434.4669, Test: 446.9201 [166.91], Avg: 214.0962 (0.153)
Ep: 369, Reward: 512.7463, Test: 414.8337 [99.81], Avg: 214.3689 (0.153)
Ep: 370, Reward: 566.3157, Test: 349.9507 [73.89], Avg: 214.5352 (0.152)
Ep: 371, Reward: 532.9980, Test: 370.8841 [123.64], Avg: 214.6232 (0.151)
Ep: 372, Reward: 522.3288, Test: 560.9753 [187.99], Avg: 215.0477 (0.150)
Ep: 373, Reward: 592.8352, Test: 420.0944 [165.81], Avg: 215.1526 (0.150)
Ep: 374, Reward: 488.8869, Test: 427.2128 [117.73], Avg: 215.4042 (0.149)
Ep: 375, Reward: 578.1666, Test: 385.8512 [121.72], Avg: 215.5338 (0.148)
Ep: 376, Reward: 513.0497, Test: 318.8134 [117.95], Avg: 215.4949 (0.147)
Ep: 377, Reward: 581.9221, Test: 412.6331 [180.33], Avg: 215.5393 (0.147)
Ep: 378, Reward: 535.6277, Test: 376.4000 [105.47], Avg: 215.6855 (0.146)
Ep: 379, Reward: 500.9718, Test: 365.6937 [156.68], Avg: 215.6679 (0.145)
Ep: 380, Reward: 616.3317, Test: 399.4559 [187.48], Avg: 215.6582 (0.144)
Ep: 381, Reward: 552.2804, Test: 428.8120 [200.76], Avg: 215.6907 (0.144)
Ep: 382, Reward: 550.1467, Test: 411.7130 [140.98], Avg: 215.8344 (0.143)
Ep: 383, Reward: 510.4308, Test: 347.2944 [97.92], Avg: 215.9217 (0.142)
Ep: 384, Reward: 510.0297, Test: 442.0388 [170.44], Avg: 216.0663 (0.142)
Ep: 385, Reward: 583.1374, Test: 359.1785 [159.72], Avg: 216.0233 (0.141)
Ep: 386, Reward: 517.8187, Test: 448.5515 [181.43], Avg: 216.1554 (0.140)
Ep: 387, Reward: 508.3361, Test: 407.5584 [142.01], Avg: 216.2827 (0.139)
Ep: 388, Reward: 424.4846, Test: 291.8452 [144.49], Avg: 216.1055 (0.139)
Ep: 389, Reward: 539.4267, Test: 327.0252 [94.09], Avg: 216.1486 (0.138)
Ep: 390, Reward: 529.7171, Test: 379.2042 [127.02], Avg: 216.2408 (0.137)
Ep: 391, Reward: 515.5160, Test: 362.1571 [109.80], Avg: 216.3329 (0.137)
Ep: 392, Reward: 452.4396, Test: 284.6080 [113.37], Avg: 216.2182 (0.136)
Ep: 393, Reward: 574.6327, Test: 333.5634 [126.44], Avg: 216.1951 (0.135)
Ep: 394, Reward: 511.4030, Test: 437.5595 [218.32], Avg: 216.2028 (0.135)
Ep: 395, Reward: 491.1066, Test: 303.0827 [90.78], Avg: 216.1929 (0.134)
Ep: 396, Reward: 537.5918, Test: 399.3999 [143.74], Avg: 216.2924 (0.133)
Ep: 397, Reward: 540.1252, Test: 441.9430 [167.35], Avg: 216.4388 (0.133)
Ep: 398, Reward: 563.9249, Test: 302.9572 [120.00], Avg: 216.3549 (0.132)
Ep: 399, Reward: 507.6576, Test: 397.7735 [138.23], Avg: 216.4629 (0.131)
Ep: 400, Reward: 491.6563, Test: 344.5224 [103.14], Avg: 216.5250 (0.131)
Ep: 401, Reward: 516.4204, Test: 401.2509 [109.22], Avg: 216.7129 (0.130)
Ep: 402, Reward: 449.6680, Test: 355.2703 [77.18], Avg: 216.8652 (0.129)
Ep: 403, Reward: 513.6416, Test: 456.0852 [179.74], Avg: 217.0124 (0.129)
Ep: 404, Reward: 556.3179, Test: 457.2624 [116.98], Avg: 217.3168 (0.128)
Ep: 405, Reward: 437.5026, Test: 403.7882 [235.60], Avg: 217.1958 (0.127)
Ep: 406, Reward: 511.7321, Test: 391.0241 [114.31], Avg: 217.3420 (0.127)
Ep: 407, Reward: 506.3548, Test: 311.6405 [158.89], Avg: 217.1837 (0.126)
Ep: 408, Reward: 518.8580, Test: 464.7101 [157.27], Avg: 217.4044 (0.126)
Ep: 409, Reward: 530.2797, Test: 360.4664 [206.00], Avg: 217.2509 (0.125)
Ep: 410, Reward: 502.0413, Test: 365.8226 [165.97], Avg: 217.2085 (0.124)
Ep: 411, Reward: 491.6048, Test: 371.6021 [150.83], Avg: 217.2172 (0.124)
Ep: 412, Reward: 543.4578, Test: 279.6527 [118.25], Avg: 217.0821 (0.123)
Ep: 413, Reward: 461.9502, Test: 464.8016 [147.95], Avg: 217.3230 (0.122)
Ep: 414, Reward: 540.1057, Test: 406.1577 [101.27], Avg: 217.5340 (0.122)
Ep: 415, Reward: 498.5880, Test: 515.7267 [204.08], Avg: 217.7603 (0.121)
Ep: 416, Reward: 524.9827, Test: 302.8506 [98.16], Avg: 217.7289 (0.121)
Ep: 417, Reward: 504.9324, Test: 428.2666 [212.07], Avg: 217.7253 (0.120)
Ep: 418, Reward: 486.3496, Test: 348.5305 [95.83], Avg: 217.8087 (0.119)
Ep: 419, Reward: 551.2259, Test: 362.5783 [87.31], Avg: 217.9456 (0.119)
Ep: 420, Reward: 483.0946, Test: 379.8693 [76.99], Avg: 218.1473 (0.118)
Ep: 421, Reward: 533.9545, Test: 379.8837 [207.49], Avg: 218.0389 (0.118)
Ep: 422, Reward: 481.2600, Test: 329.8257 [135.26], Avg: 217.9834 (0.117)
Ep: 423, Reward: 435.2593, Test: 358.5755 [79.84], Avg: 218.1267 (0.116)
Ep: 424, Reward: 448.3094, Test: 365.3560 [147.41], Avg: 218.1262 (0.116)
Ep: 425, Reward: 551.0267, Test: 295.3125 [109.12], Avg: 218.0513 (0.115)
Ep: 426, Reward: 483.4476, Test: 339.9596 [175.36], Avg: 217.9261 (0.115)
Ep: 427, Reward: 509.1916, Test: 430.6130 [251.71], Avg: 217.8349 (0.114)
Ep: 428, Reward: 510.4890, Test: 375.5827 [206.81], Avg: 217.7205 (0.114)
Ep: 429, Reward: 510.1187, Test: 283.3970 [166.35], Avg: 217.4864 (0.113)
Ep: 430, Reward: 337.4904, Test: 306.9853 [137.67], Avg: 217.3747 (0.112)
Ep: 431, Reward: 529.5064, Test: 355.8608 [180.86], Avg: 217.2766 (0.112)
Ep: 432, Reward: 426.6800, Test: 288.6793 [160.95], Avg: 217.0698 (0.111)
Ep: 433, Reward: 398.0016, Test: 266.4540 [79.97], Avg: 216.9993 (0.111)
Ep: 434, Reward: 434.5115, Test: 346.7233 [148.38], Avg: 216.9564 (0.110)
Ep: 435, Reward: 339.3865, Test: 312.7101 [170.64], Avg: 216.7847 (0.110)
Ep: 436, Reward: 355.0249, Test: 355.1674 [72.11], Avg: 216.9363 (0.109)
Ep: 437, Reward: 493.4751, Test: 268.3155 [87.77], Avg: 216.8532 (0.109)
Ep: 438, Reward: 434.1022, Test: 370.2161 [148.39], Avg: 216.8645 (0.108)
Ep: 439, Reward: 482.4521, Test: 417.7104 [124.93], Avg: 217.0371 (0.107)
Ep: 440, Reward: 465.4246, Test: 249.1724 [110.66], Avg: 216.8590 (0.107)
Ep: 441, Reward: 396.7375, Test: 364.4795 [200.86], Avg: 216.7385 (0.106)
Ep: 442, Reward: 465.6863, Test: 344.0848 [145.42], Avg: 216.6978 (0.106)
Ep: 443, Reward: 359.2783, Test: 348.2840 [148.98], Avg: 216.6586 (0.105)
Ep: 444, Reward: 461.6947, Test: 328.2305 [194.16], Avg: 216.4730 (0.105)
Ep: 445, Reward: 415.4308, Test: 308.6557 [78.81], Avg: 216.5030 (0.104)
Ep: 446, Reward: 389.4880, Test: 292.6105 [122.78], Avg: 216.3986 (0.104)
Ep: 447, Reward: 453.8157, Test: 316.0402 [94.70], Avg: 216.4096 (0.103)
Ep: 448, Reward: 353.8681, Test: 274.5586 [71.09], Avg: 216.3808 (0.103)
Ep: 449, Reward: 414.7593, Test: 274.0177 [126.11], Avg: 216.2286 (0.102)
Ep: 450, Reward: 529.3729, Test: 342.5400 [93.70], Avg: 216.3010 (0.102)
Ep: 451, Reward: 470.7694, Test: 370.8343 [216.18], Avg: 216.1646 (0.101)
Ep: 452, Reward: 393.2408, Test: 377.1173 [99.40], Avg: 216.3005 (0.101)
Ep: 453, Reward: 440.9924, Test: 398.8747 [149.56], Avg: 216.3732 (0.100)
Ep: 454, Reward: 419.7000, Test: 442.8589 [132.48], Avg: 216.5798 (0.100)
Ep: 455, Reward: 428.6376, Test: 363.6763 [177.06], Avg: 216.5141 (0.100)
Ep: 456, Reward: 406.4280, Test: 306.0144 [128.97], Avg: 216.4277 (0.100)
Ep: 457, Reward: 392.4371, Test: 305.5068 [100.69], Avg: 216.4024 (0.100)
Ep: 458, Reward: 421.9508, Test: 346.1556 [110.87], Avg: 216.4435 (0.100)
Ep: 459, Reward: 442.5094, Test: 389.6313 [138.17], Avg: 216.5196 (0.100)
Ep: 460, Reward: 442.2926, Test: 357.1438 [131.59], Avg: 216.5392 (0.100)
Ep: 461, Reward: 436.7785, Test: 294.3081 [116.26], Avg: 216.4559 (0.100)
Ep: 462, Reward: 460.1153, Test: 361.5213 [175.76], Avg: 216.3896 (0.100)
Ep: 463, Reward: 395.5313, Test: 339.6607 [96.67], Avg: 216.4470 (0.100)
Ep: 464, Reward: 451.1822, Test: 305.3477 [224.51], Avg: 216.1553 (0.100)
Ep: 465, Reward: 450.1662, Test: 324.3893 [187.66], Avg: 215.9849 (0.100)
Ep: 466, Reward: 477.4382, Test: 278.3908 [139.61], Avg: 215.8195 (0.100)
Ep: 467, Reward: 468.8057, Test: 332.6156 [120.72], Avg: 215.8112 (0.100)
Ep: 468, Reward: 452.3561, Test: 411.6554 [180.21], Avg: 215.8445 (0.100)
Ep: 469, Reward: 513.8425, Test: 401.4134 [169.24], Avg: 215.8792 (0.100)
Ep: 470, Reward: 369.0266, Test: 272.7228 [92.33], Avg: 215.8039 (0.100)
Ep: 471, Reward: 417.7651, Test: 375.4140 [97.28], Avg: 215.9360 (0.100)
Ep: 472, Reward: 457.0686, Test: 306.2596 [112.91], Avg: 215.8882 (0.100)
Ep: 473, Reward: 403.7434, Test: 392.9503 [180.40], Avg: 215.8812 (0.100)
Ep: 474, Reward: 435.7536, Test: 295.4056 [142.49], Avg: 215.7486 (0.100)
Ep: 475, Reward: 383.3352, Test: 322.0279 [116.22], Avg: 215.7277 (0.100)
Ep: 476, Reward: 456.9672, Test: 384.7921 [143.78], Avg: 215.7807 (0.100)
Ep: 477, Reward: 404.2098, Test: 298.6148 [143.51], Avg: 215.6538 (0.100)
Ep: 478, Reward: 497.8647, Test: 320.9126 [181.44], Avg: 215.4948 (0.100)
Ep: 479, Reward: 451.2263, Test: 351.9547 [86.75], Avg: 215.5983 (0.100)
Ep: 480, Reward: 359.2907, Test: 386.9860 [157.34], Avg: 215.6275 (0.100)
Ep: 481, Reward: 472.0791, Test: 296.9292 [166.25], Avg: 215.4513 (0.100)
Ep: 482, Reward: 467.5275, Test: 354.7005 [168.62], Avg: 215.3905 (0.100)
Ep: 483, Reward: 394.2065, Test: 284.8806 [77.00], Avg: 215.3750 (0.100)
Ep: 484, Reward: 465.2356, Test: 319.4639 [162.90], Avg: 215.2537 (0.100)
Ep: 485, Reward: 477.1508, Test: 309.5758 [144.72], Avg: 215.1500 (0.100)
Ep: 486, Reward: 483.4818, Test: 344.8911 [166.39], Avg: 215.0747 (0.100)
Ep: 487, Reward: 441.2750, Test: 348.1108 [145.29], Avg: 215.0496 (0.100)
Ep: 488, Reward: 447.0063, Test: 321.0585 [201.46], Avg: 214.8545 (0.100)
Ep: 489, Reward: 439.2039, Test: 363.1937 [122.03], Avg: 214.9082 (0.100)
Ep: 490, Reward: 395.3968, Test: 391.9710 [116.53], Avg: 215.0314 (0.100)
Ep: 491, Reward: 421.4514, Test: 355.2288 [144.02], Avg: 215.0237 (0.100)
Ep: 492, Reward: 437.2023, Test: 394.1596 [230.15], Avg: 214.9202 (0.100)
Ep: 493, Reward: 421.5127, Test: 339.4731 [182.98], Avg: 214.8019 (0.100)
Ep: 494, Reward: 344.9099, Test: 323.9092 [178.68], Avg: 214.6613 (0.100)
Ep: 495, Reward: 418.6791, Test: 329.1509 [119.67], Avg: 214.6509 (0.100)
Ep: 496, Reward: 381.0812, Test: 336.2832 [177.03], Avg: 214.5394 (0.100)
Ep: 497, Reward: 427.5470, Test: 382.5468 [157.01], Avg: 214.5615 (0.100)
Ep: 498, Reward: 417.0504, Test: 419.4443 [163.25], Avg: 214.6450 (0.100)
Ep: 499, Reward: 452.9288, Test: 332.7455 [130.12], Avg: 214.6209 (0.100)
