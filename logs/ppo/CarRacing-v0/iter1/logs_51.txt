Model: <class 'models.ppo.PPOAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

EPS_MIN = 0.1                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.997             	# The rate at which eps decays from EPS_MAX to EPS_MIN
BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.05				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu() + state
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages).mean() + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss)
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		update_freq = int(self.update_freq * (1 - self.eps + EPS_MIN)**2)
		if len(self.buffer) >= update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((len(self.replay_buffer)*PPO_EPOCHS)//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=2*update_freq/len(self.replay_buffer))
		if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -23.2655, Test: -24.0588 [8.49], Avg: -32.5507 (0.997)
Ep: 1, Reward: -21.8793, Test: -20.6291 [22.53], Avg: -37.8550 (0.994)
Ep: 2, Reward: 16.8777, Test: 132.2754 [69.43], Avg: -4.2896 (0.991)
Ep: 3, Reward: 41.1150, Test: -32.7968 [31.66], Avg: -19.3316 (0.988)
Ep: 4, Reward: -29.5276, Test: 142.6394 [47.63], Avg: 3.5367 (0.985)
Ep: 5, Reward: 71.5890, Test: 35.5550 [40.97], Avg: 2.0452 (0.982)
Ep: 6, Reward: 232.8542, Test: 558.4050 [114.90], Avg: 65.1111 (0.979)
Ep: 7, Reward: 584.1226, Test: 312.4122 [195.85], Avg: 71.5431 (0.976)
Ep: 8, Reward: 205.6119, Test: 232.1019 [120.26], Avg: 76.0208 (0.973)
Ep: 9, Reward: 226.8975, Test: 309.7508 [138.60], Avg: 85.5334 (0.970)
Ep: 10, Reward: 358.2704, Test: 278.8763 [191.85], Avg: 85.6688 (0.967)
Ep: 11, Reward: 239.7584, Test: 209.2735 [44.61], Avg: 92.2519 (0.965)
Ep: 12, Reward: 231.0204, Test: 290.3984 [143.27], Avg: 96.4728 (0.962)
Ep: 13, Reward: 289.1781, Test: 227.5795 [78.36], Avg: 100.2402 (0.959)
Ep: 14, Reward: 350.0874, Test: 299.8088 [247.94], Avg: 97.0153 (0.956)
Ep: 15, Reward: 343.4630, Test: 330.2014 [279.03], Avg: 94.1502 (0.953)
Ep: 16, Reward: 529.1996, Test: 676.8857 [109.24], Avg: 122.0027 (0.950)
Ep: 17, Reward: 686.1650, Test: 578.2193 [225.78], Avg: 134.8049 (0.947)
Ep: 18, Reward: 582.4520, Test: 573.8422 [144.49], Avg: 150.3075 (0.945)
Ep: 19, Reward: 621.7230, Test: 629.9246 [251.03], Avg: 161.7367 (0.942)
Ep: 20, Reward: 635.7530, Test: 553.0512 [228.66], Avg: 169.4824 (0.939)
Ep: 21, Reward: 667.0447, Test: 652.8186 [312.03], Avg: 177.2690 (0.936)
Ep: 22, Reward: 641.3927, Test: 479.6514 [273.83], Avg: 178.5103 (0.933)
Ep: 23, Reward: 309.9785, Test: 431.1764 [226.03], Avg: 179.6202 (0.930)
Ep: 24, Reward: 625.1686, Test: 732.0068 [183.02], Avg: 194.3946 (0.928)
Ep: 25, Reward: 660.2256, Test: 635.1224 [266.97], Avg: 201.0775 (0.925)
Ep: 26, Reward: 602.0368, Test: 754.0750 [146.85], Avg: 216.1202 (0.922)
Ep: 27, Reward: 745.0674, Test: 705.3892 [191.75], Avg: 226.7457 (0.919)
Ep: 28, Reward: 657.9896, Test: 414.2623 [252.52], Avg: 224.5041 (0.917)
Ep: 29, Reward: 533.8404, Test: 663.4742 [153.86], Avg: 234.0079 (0.914)
Ep: 30, Reward: 686.2094, Test: 557.4146 [328.23], Avg: 233.8525 (0.911)
Ep: 31, Reward: 481.6974, Test: 520.6989 [279.42], Avg: 234.0845 (0.908)
Ep: 32, Reward: 671.8259, Test: 661.6401 [180.82], Avg: 241.5612 (0.906)
Ep: 33, Reward: 720.6635, Test: 732.0551 [194.73], Avg: 250.2601 (0.903)
Ep: 34, Reward: 645.1144, Test: 552.0350 [344.04], Avg: 249.0526 (0.900)
Ep: 35, Reward: 798.2102, Test: 690.1968 [266.04], Avg: 253.9165 (0.897)
Ep: 36, Reward: 647.4033, Test: 694.5089 [209.22], Avg: 260.1699 (0.895)
Ep: 37, Reward: 855.4890, Test: 809.3189 [143.74], Avg: 270.8386 (0.892)
Ep: 38, Reward: 817.3505, Test: 856.8446 [74.38], Avg: 283.9572 (0.889)
Ep: 39, Reward: 632.4928, Test: 859.6499 [41.28], Avg: 297.3175 (0.887)
Ep: 40, Reward: 730.2868, Test: 852.1130 [64.55], Avg: 309.2746 (0.884)
Ep: 41, Reward: 711.8281, Test: 797.2565 [53.23], Avg: 319.6259 (0.881)
Ep: 42, Reward: 553.4067, Test: 595.5869 [105.32], Avg: 323.5944 (0.879)
Ep: 43, Reward: 682.0257, Test: 615.5737 [193.45], Avg: 325.8336 (0.876)
Ep: 44, Reward: 617.1325, Test: 669.7049 [119.00], Avg: 330.8306 (0.874)
Ep: 45, Reward: 748.6075, Test: 770.6279 [99.95], Avg: 338.2186 (0.871)
Ep: 46, Reward: 635.9961, Test: 599.3762 [111.89], Avg: 341.3945 (0.868)
Ep: 47, Reward: 589.5850, Test: 662.2552 [49.08], Avg: 347.0566 (0.866)
Ep: 48, Reward: 755.2849, Test: 721.0344 [76.72], Avg: 353.1230 (0.863)
Ep: 49, Reward: 695.1087, Test: 608.1463 [224.29], Avg: 353.7378 (0.861)
Ep: 50, Reward: 612.5305, Test: 627.2753 [147.55], Avg: 356.2081 (0.858)
Ep: 51, Reward: 729.0237, Test: 719.8111 [168.51], Avg: 359.9599 (0.855)
Ep: 52, Reward: 667.5118, Test: 690.5518 [254.34], Avg: 361.3987 (0.853)
Ep: 53, Reward: 808.2508, Test: 714.5617 [171.46], Avg: 364.7635 (0.850)
Ep: 54, Reward: 765.2553, Test: 651.6557 [176.68], Avg: 366.7675 (0.848)
Ep: 55, Reward: 660.4030, Test: 548.5019 [211.87], Avg: 366.2294 (0.845)
Ep: 56, Reward: 580.2149, Test: 468.8197 [269.86], Avg: 363.2948 (0.843)
Ep: 57, Reward: 744.7740, Test: 765.8234 [143.17], Avg: 367.7665 (0.840)
Ep: 58, Reward: 776.4213, Test: 665.1915 [298.23], Avg: 367.7528 (0.838)
Ep: 59, Reward: 676.4891, Test: 737.7229 [165.75], Avg: 371.1564 (0.835)
Ep: 60, Reward: 806.4228, Test: 853.0192 [94.35], Avg: 377.5091 (0.833)
Ep: 61, Reward: 848.9665, Test: 884.1723 [21.59], Avg: 385.3328 (0.830)
Ep: 62, Reward: 834.4967, Test: 790.6508 [179.90], Avg: 388.9108 (0.828)
Ep: 63, Reward: 818.8554, Test: 851.0584 [97.79], Avg: 394.6039 (0.825)
Ep: 64, Reward: 765.3725, Test: 791.3828 [117.03], Avg: 398.9077 (0.823)
Ep: 65, Reward: 810.5896, Test: 825.9672 [102.14], Avg: 403.8307 (0.820)
Ep: 66, Reward: 646.2782, Test: 716.5604 [93.93], Avg: 407.0963 (0.818)
Ep: 67, Reward: 674.4061, Test: 676.5932 [165.96], Avg: 408.6190 (0.815)
Ep: 68, Reward: 552.4312, Test: 618.6036 [153.84], Avg: 409.4327 (0.813)
Ep: 69, Reward: 611.2591, Test: 525.2315 [199.80], Avg: 408.2327 (0.810)
Ep: 70, Reward: 537.6742, Test: 528.3465 [182.61], Avg: 407.3525 (0.808)
Ep: 71, Reward: 586.3779, Test: 446.8438 [249.40], Avg: 404.4371 (0.805)
Ep: 72, Reward: 835.2876, Test: 786.5331 [116.05], Avg: 408.0816 (0.803)
Ep: 73, Reward: 607.0102, Test: 610.3162 [130.81], Avg: 409.0468 (0.801)
Ep: 74, Reward: 576.2658, Test: 688.3666 [124.19], Avg: 411.1152 (0.798)
Ep: 75, Reward: 756.6969, Test: 745.5542 [139.49], Avg: 413.6803 (0.796)
Ep: 76, Reward: 625.4960, Test: 692.3908 [197.54], Avg: 414.7344 (0.793)
Ep: 77, Reward: 688.9724, Test: 596.7037 [217.14], Avg: 414.2835 (0.791)
Ep: 78, Reward: 572.7205, Test: 606.4821 [186.57], Avg: 414.3549 (0.789)
Ep: 79, Reward: 649.4646, Test: 643.7002 [249.78], Avg: 414.0994 (0.786)
Ep: 80, Reward: 636.2205, Test: 642.5503 [224.41], Avg: 414.1492 (0.784)
Ep: 81, Reward: 712.6805, Test: 645.8931 [177.01], Avg: 414.8167 (0.782)
Ep: 82, Reward: 491.8788, Test: 640.7943 [231.28], Avg: 414.7529 (0.779)
Ep: 83, Reward: 776.1149, Test: 656.9023 [210.20], Avg: 415.1332 (0.777)
Ep: 84, Reward: 592.5695, Test: 727.2899 [142.59], Avg: 417.1281 (0.775)
Ep: 85, Reward: 572.4658, Test: 641.3127 [181.22], Avg: 417.6277 (0.772)
Ep: 86, Reward: 544.5955, Test: 573.6840 [234.63], Avg: 416.7246 (0.770)
Ep: 87, Reward: 526.7567, Test: 601.1565 [249.74], Avg: 415.9824 (0.768)
Ep: 88, Reward: 605.0805, Test: 505.1997 [233.19], Avg: 414.3647 (0.765)
Ep: 89, Reward: 392.4590, Test: 393.5259 [186.12], Avg: 412.0651 (0.763)
Ep: 90, Reward: 562.9275, Test: 476.2022 [214.12], Avg: 410.4170 (0.761)
Ep: 91, Reward: 532.8922, Test: 515.7467 [218.71], Avg: 409.1846 (0.758)
Ep: 92, Reward: 353.8710, Test: 426.1449 [251.46], Avg: 406.6631 (0.756)
Ep: 93, Reward: 443.5204, Test: 398.4884 [210.73], Avg: 404.3342 (0.754)
Ep: 94, Reward: 395.9887, Test: 512.9973 [224.53], Avg: 403.1146 (0.752)
Ep: 95, Reward: 491.2747, Test: 414.0341 [224.64], Avg: 400.8883 (0.749)
Ep: 96, Reward: 321.8435, Test: 196.2306 [88.54], Avg: 397.8657 (0.747)
Ep: 97, Reward: 275.2417, Test: 270.0218 [177.29], Avg: 394.7521 (0.745)
Ep: 98, Reward: 233.2563, Test: 243.7402 [148.73], Avg: 391.7244 (0.743)
Ep: 99, Reward: 199.0563, Test: 178.2338 [88.56], Avg: 388.7038 (0.740)
Ep: 100, Reward: 156.8971, Test: 204.6741 [123.89], Avg: 385.6551 (0.738)
Ep: 101, Reward: 180.9860, Test: 203.2602 [80.59], Avg: 383.0769 (0.736)
Ep: 102, Reward: 161.5607, Test: 121.7449 [91.20], Avg: 379.6543 (0.734)
Ep: 103, Reward: 115.8921, Test: 110.0138 [102.40], Avg: 376.0770 (0.732)
Ep: 104, Reward: 119.3685, Test: 118.4686 [68.99], Avg: 372.9666 (0.729)
Ep: 105, Reward: 166.4439, Test: 161.0864 [95.30], Avg: 370.0687 (0.727)
Ep: 106, Reward: 104.8527, Test: 117.8509 [70.36], Avg: 367.0539 (0.725)
Ep: 107, Reward: 125.9492, Test: 151.3752 [96.46], Avg: 364.1638 (0.723)
Ep: 108, Reward: 170.2603, Test: 202.8313 [65.76], Avg: 362.0804 (0.721)
Ep: 109, Reward: 192.2836, Test: 145.8837 [94.04], Avg: 359.2600 (0.719)
Ep: 110, Reward: 158.1542, Test: 181.1734 [82.56], Avg: 356.9118 (0.716)
Ep: 111, Reward: 259.5899, Test: 209.5611 [62.06], Avg: 355.0421 (0.714)
Ep: 112, Reward: 170.6409, Test: 211.4689 [82.53], Avg: 353.0412 (0.712)
Ep: 113, Reward: 246.9576, Test: 292.2374 [149.76], Avg: 351.1942 (0.710)
Ep: 114, Reward: 189.0402, Test: 251.9076 [62.75], Avg: 349.7852 (0.708)
Ep: 115, Reward: 199.4789, Test: 285.3712 [54.51], Avg: 348.7599 (0.706)
Ep: 116, Reward: 210.1371, Test: 182.7843 [94.01], Avg: 346.5378 (0.704)
Ep: 117, Reward: 200.8686, Test: 252.4734 [109.36], Avg: 344.8138 (0.702)
Ep: 118, Reward: 163.0665, Test: 294.5671 [110.38], Avg: 343.4640 (0.699)
Ep: 119, Reward: 207.0603, Test: 241.0677 [140.27], Avg: 341.4418 (0.697)
Ep: 120, Reward: 215.8473, Test: 228.9431 [112.76], Avg: 339.5801 (0.695)
Ep: 121, Reward: 198.4489, Test: 179.7224 [108.35], Avg: 337.3818 (0.693)
Ep: 122, Reward: 141.9617, Test: 171.0237 [116.06], Avg: 335.0857 (0.691)
Ep: 123, Reward: 227.5560, Test: 157.0241 [112.45], Avg: 332.7429 (0.689)
Ep: 124, Reward: 217.3081, Test: 192.1748 [131.89], Avg: 330.5632 (0.687)
Ep: 125, Reward: 162.2327, Test: 197.9692 [102.29], Avg: 328.6990 (0.685)
Ep: 126, Reward: 166.3761, Test: 182.7438 [81.95], Avg: 326.9045 (0.683)
Ep: 127, Reward: 161.5354, Test: 164.0642 [90.43], Avg: 324.9258 (0.681)
Ep: 128, Reward: 141.1622, Test: 231.8055 [104.29], Avg: 323.3955 (0.679)
Ep: 129, Reward: 138.9902, Test: 203.8638 [63.84], Avg: 321.9849 (0.677)
Ep: 130, Reward: 230.5598, Test: 156.7906 [121.96], Avg: 319.7929 (0.675)
Ep: 131, Reward: 182.6689, Test: 180.7407 [166.36], Avg: 317.4792 (0.673)
Ep: 132, Reward: 151.3739, Test: 219.5057 [140.01], Avg: 315.6899 (0.671)
Ep: 133, Reward: 176.7442, Test: 283.0687 [140.78], Avg: 314.3959 (0.669)
Ep: 134, Reward: 244.0949, Test: 205.3226 [137.83], Avg: 312.5670 (0.667)
Ep: 135, Reward: 188.2241, Test: 258.5006 [128.94], Avg: 311.2213 (0.665)
Ep: 136, Reward: 204.6939, Test: 176.2145 [87.27], Avg: 309.5989 (0.663)
Ep: 137, Reward: 329.8339, Test: 355.0243 [125.54], Avg: 309.0183 (0.661)
Ep: 138, Reward: 447.6992, Test: 364.6124 [174.52], Avg: 308.1628 (0.659)
Ep: 139, Reward: 349.9359, Test: 287.5599 [104.12], Avg: 307.2719 (0.657)
Ep: 140, Reward: 486.1673, Test: 364.3095 [197.87], Avg: 306.2731 (0.655)
Ep: 141, Reward: 316.5206, Test: 252.3522 [170.39], Avg: 304.6934 (0.653)
Ep: 142, Reward: 342.7537, Test: 304.6554 [113.72], Avg: 303.8979 (0.651)
Ep: 143, Reward: 349.4156, Test: 281.8472 [179.26], Avg: 302.4999 (0.649)
Ep: 144, Reward: 283.3032, Test: 327.8537 [171.07], Avg: 301.4950 (0.647)
Ep: 145, Reward: 314.9635, Test: 268.1003 [62.24], Avg: 300.8399 (0.645)
Ep: 146, Reward: 340.0733, Test: 208.4083 [110.67], Avg: 299.4583 (0.643)
Ep: 147, Reward: 303.5083, Test: 344.1102 [136.33], Avg: 298.8389 (0.641)
Ep: 148, Reward: 281.0094, Test: 286.5859 [227.04], Avg: 297.2329 (0.639)
Ep: 149, Reward: 312.5349, Test: 277.3711 [150.25], Avg: 296.0988 (0.637)
Ep: 150, Reward: 283.2316, Test: 282.7541 [166.53], Avg: 294.9075 (0.635)
Ep: 151, Reward: 328.6426, Test: 385.8586 [190.70], Avg: 294.2513 (0.633)
Ep: 152, Reward: 325.8435, Test: 364.1209 [183.67], Avg: 293.5075 (0.631)
Ep: 153, Reward: 357.5763, Test: 242.5893 [192.15], Avg: 291.9292 (0.630)
Ep: 154, Reward: 365.8963, Test: 434.0560 [222.29], Avg: 291.4120 (0.628)
Ep: 155, Reward: 347.3899, Test: 338.0887 [175.41], Avg: 290.5868 (0.626)
Ep: 156, Reward: 324.6656, Test: 292.3113 [137.05], Avg: 289.7248 (0.624)
Ep: 157, Reward: 367.4488, Test: 292.5292 [95.81], Avg: 289.1361 (0.622)
Ep: 158, Reward: 294.9480, Test: 251.7076 [120.28], Avg: 288.1443 (0.620)
Ep: 159, Reward: 313.4152, Test: 198.1388 [194.20], Avg: 286.3680 (0.618)
Ep: 160, Reward: 265.5208, Test: 196.6617 [115.19], Avg: 285.0954 (0.616)
Ep: 161, Reward: 348.8790, Test: 336.2596 [89.45], Avg: 284.8591 (0.615)
Ep: 162, Reward: 400.0736, Test: 322.5947 [161.40], Avg: 284.1004 (0.613)
Ep: 163, Reward: 266.3528, Test: 318.7691 [195.86], Avg: 283.1175 (0.611)
Ep: 164, Reward: 356.9265, Test: 355.0144 [127.85], Avg: 282.7784 (0.609)
Ep: 165, Reward: 350.3356, Test: 337.1562 [206.95], Avg: 281.8593 (0.607)
Ep: 166, Reward: 305.8118, Test: 243.3495 [188.59], Avg: 280.4994 (0.605)
Ep: 167, Reward: 265.1636, Test: 192.6754 [133.14], Avg: 279.1842 (0.604)
Ep: 168, Reward: 252.1880, Test: 223.5982 [210.72], Avg: 277.6084 (0.602)
Ep: 169, Reward: 329.7824, Test: 221.7586 [105.09], Avg: 276.6617 (0.600)
Ep: 170, Reward: 283.9037, Test: 395.9790 [206.47], Avg: 276.1520 (0.596)
Ep: 171, Reward: 367.3385, Test: 320.9195 [161.23], Avg: 275.4749 (0.595)
Ep: 172, Reward: 286.4239, Test: 261.5833 [204.11], Avg: 274.2148 (0.593)
Ep: 173, Reward: 281.4856, Test: 336.3069 [169.50], Avg: 273.5975 (0.591)
Ep: 174, Reward: 252.3352, Test: -9.3645 [34.01], Avg: 271.7862 (0.589)
Ep: 175, Reward: 209.9969, Test: 216.8149 [225.18], Avg: 270.1945 (0.588)
Ep: 176, Reward: 138.0766, Test: 148.1351 [177.73], Avg: 268.5008 (0.586)
Ep: 177, Reward: 118.4295, Test: 191.8254 [169.98], Avg: 267.1151 (0.584)
Ep: 178, Reward: 200.6980, Test: 198.7393 [172.46], Avg: 265.7696 (0.582)
Ep: 179, Reward: 151.2431, Test: 116.6574 [152.34], Avg: 264.0948 (0.581)
Ep: 180, Reward: 167.5941, Test: 120.1110 [166.20], Avg: 262.3811 (0.579)
Ep: 181, Reward: 202.9786, Test: 146.5891 [209.89], Avg: 260.5917 (0.577)
Ep: 182, Reward: 255.0441, Test: 201.8565 [218.95], Avg: 259.0743 (0.575)
Ep: 183, Reward: 191.0754, Test: 212.2210 [99.67], Avg: 258.2779 (0.574)
Ep: 184, Reward: 238.2910, Test: 7.6125 [81.32], Avg: 256.4834 (0.572)
Ep: 185, Reward: 84.7041, Test: 549.5214 [282.34], Avg: 256.5409 (0.570)
Ep: 186, Reward: 384.8138, Test: 657.4316 [219.50], Avg: 257.5109 (0.568)
Ep: 187, Reward: 676.6261, Test: 589.7185 [239.04], Avg: 258.0065 (0.567)
Ep: 188, Reward: 530.9216, Test: 480.2623 [306.34], Avg: 257.5616 (0.565)
Ep: 189, Reward: 460.2572, Test: 369.6520 [317.34], Avg: 256.4813 (0.563)
Ep: 190, Reward: 476.8557, Test: 503.3076 [278.58], Avg: 256.3151 (0.562)
Ep: 191, Reward: 414.3741, Test: 2.4583 [64.23], Avg: 254.6584 (0.560)
Ep: 192, Reward: 112.2332, Test: 57.3758 [133.11], Avg: 252.9465 (0.558)
Ep: 193, Reward: 184.3079, Test: 108.3862 [124.85], Avg: 251.5578 (0.557)
Ep: 194, Reward: 203.9188, Test: 228.2971 [199.50], Avg: 250.4155 (0.555)
Ep: 195, Reward: 200.1499, Test: 179.2634 [266.36], Avg: 248.6935 (0.553)
Ep: 196, Reward: 116.0639, Test: 34.1691 [107.55], Avg: 247.0586 (0.552)
Ep: 197, Reward: 52.4969, Test: 95.3002 [197.57], Avg: 245.2943 (0.550)
Ep: 198, Reward: 58.8694, Test: 75.7189 [140.01], Avg: 243.7386 (0.548)
Ep: 199, Reward: 27.9072, Test: 117.3780 [138.76], Avg: 242.4130 (0.547)
Ep: 200, Reward: 202.3421, Test: 114.9988 [125.78], Avg: 241.1533 (0.545)
Ep: 201, Reward: 119.6142, Test: 244.0355 [249.04], Avg: 239.9347 (0.543)
Ep: 202, Reward: 282.7570, Test: 37.5852 [106.88], Avg: 238.4114 (0.542)
Ep: 203, Reward: 174.3849, Test: 284.5075 [302.29], Avg: 237.1556 (0.540)
Ep: 204, Reward: 210.2813, Test: 254.0637 [245.26], Avg: 236.0417 (0.539)
Ep: 205, Reward: 245.1525, Test: 357.5958 [149.73], Avg: 235.9049 (0.537)
Ep: 206, Reward: 132.1261, Test: 239.2610 [213.72], Avg: 234.8887 (0.535)
Ep: 207, Reward: 221.8479, Test: 439.7893 [275.46], Avg: 234.5494 (0.534)
Ep: 208, Reward: 285.1967, Test: 248.3272 [167.21], Avg: 233.8153 (0.532)
Ep: 209, Reward: 237.4436, Test: 456.6795 [270.50], Avg: 233.5885 (0.530)
Ep: 210, Reward: 339.1921, Test: 284.4534 [155.54], Avg: 233.0924 (0.529)
Ep: 211, Reward: 263.1807, Test: 336.1011 [235.04], Avg: 232.4696 (0.527)
Ep: 212, Reward: 391.8853, Test: 392.6847 [186.37], Avg: 232.3468 (0.526)
Ep: 213, Reward: 498.6032, Test: 412.0171 [195.24], Avg: 232.2740 (0.524)
Ep: 214, Reward: 437.3655, Test: 507.6791 [267.08], Avg: 232.3128 (0.523)
Ep: 215, Reward: 383.8583, Test: 498.8358 [233.66], Avg: 232.4649 (0.521)
Ep: 216, Reward: 488.2525, Test: 574.3030 [245.65], Avg: 232.9082 (0.519)
Ep: 217, Reward: 470.4069, Test: 481.3868 [251.11], Avg: 232.8961 (0.518)
Ep: 218, Reward: 473.7927, Test: 301.8594 [222.79], Avg: 232.1937 (0.516)
Ep: 219, Reward: 418.5211, Test: 364.6372 [218.77], Avg: 231.8013 (0.515)
Ep: 220, Reward: 147.1517, Test: 547.3771 [276.01], Avg: 231.9804 (0.513)
Ep: 221, Reward: 309.1351, Test: 369.5220 [268.13], Avg: 231.3921 (0.512)
Ep: 222, Reward: 455.3813, Test: 531.4409 [280.07], Avg: 231.4817 (0.510)
Ep: 223, Reward: 424.2368, Test: 525.7227 [306.42], Avg: 231.4274 (0.509)
Ep: 224, Reward: 498.4236, Test: 578.0604 [226.14], Avg: 231.9629 (0.507)
Ep: 225, Reward: 400.1779, Test: 452.7885 [243.75], Avg: 231.8615 (0.506)
Ep: 226, Reward: 540.1566, Test: 312.6653 [238.79], Avg: 231.1655 (0.504)
Ep: 227, Reward: 503.5224, Test: 495.0388 [289.82], Avg: 231.0517 (0.503)
Ep: 228, Reward: 580.4709, Test: 552.4440 [252.33], Avg: 231.3533 (0.501)
Ep: 229, Reward: 539.0088, Test: 465.7931 [290.72], Avg: 231.1086 (0.500)
Ep: 230, Reward: 587.9036, Test: 680.1547 [226.49], Avg: 232.0720 (0.498)
Ep: 231, Reward: 772.0907, Test: 771.9943 [113.08], Avg: 233.9119 (0.497)
Ep: 232, Reward: 752.3987, Test: 668.0013 [284.54], Avg: 234.5537 (0.495)
Ep: 233, Reward: 762.7297, Test: 755.6345 [201.89], Avg: 235.9178 (0.494)
Ep: 234, Reward: 650.4996, Test: 858.1474 [73.30], Avg: 238.2536 (0.492)
Ep: 235, Reward: 731.6010, Test: 815.9756 [77.92], Avg: 240.3714 (0.491)
Ep: 236, Reward: 750.2234, Test: 685.9156 [222.84], Avg: 241.3111 (0.489)
Ep: 237, Reward: 770.2319, Test: 708.9812 [204.43], Avg: 242.4172 (0.488)
Ep: 238, Reward: 732.8153, Test: 846.3006 [97.13], Avg: 244.5375 (0.486)
Ep: 239, Reward: 782.4366, Test: 810.2325 [125.03], Avg: 246.3736 (0.485)
Ep: 240, Reward: 600.6601, Test: 828.3330 [117.06], Avg: 248.3027 (0.483)
Ep: 241, Reward: 847.7032, Test: 734.7955 [249.25], Avg: 249.2830 (0.482)
Ep: 242, Reward: 804.9116, Test: 741.3212 [221.82], Avg: 250.3950 (0.480)
Ep: 243, Reward: 747.5575, Test: 794.0671 [136.12], Avg: 252.0653 (0.479)
Ep: 244, Reward: 834.3007, Test: 774.2034 [165.84], Avg: 253.5196 (0.478)
Ep: 245, Reward: 779.0305, Test: 779.2785 [172.57], Avg: 254.9553 (0.476)
Ep: 246, Reward: 789.8515, Test: 827.5903 [98.88], Avg: 256.8733 (0.475)
Ep: 247, Reward: 721.2775, Test: 602.0069 [218.87], Avg: 257.3825 (0.473)
Ep: 248, Reward: 688.2176, Test: 758.5307 [199.94], Avg: 258.5921 (0.472)
Ep: 249, Reward: 819.5525, Test: 709.5758 [195.46], Avg: 259.6142 (0.470)
Ep: 250, Reward: 633.6372, Test: 675.2670 [251.71], Avg: 260.2673 (0.469)
Ep: 251, Reward: 782.7946, Test: 658.3348 [262.45], Avg: 260.8055 (0.468)
Ep: 252, Reward: 632.7900, Test: 541.4879 [274.79], Avg: 260.8288 (0.466)
Ep: 253, Reward: 734.4208, Test: 540.9116 [251.25], Avg: 260.9423 (0.465)
Ep: 254, Reward: 629.9682, Test: 548.8468 [267.04], Avg: 261.0242 (0.463)
Ep: 255, Reward: 473.2153, Test: 576.3460 [272.80], Avg: 261.1903 (0.462)
Ep: 256, Reward: 625.0309, Test: 621.8369 [303.32], Avg: 261.4133 (0.461)
Ep: 257, Reward: 516.2187, Test: 541.8837 [270.19], Avg: 261.4532 (0.459)
Ep: 258, Reward: 573.6729, Test: 488.9768 [305.77], Avg: 261.1511 (0.458)
Ep: 259, Reward: 520.8716, Test: 351.2168 [221.64], Avg: 260.6450 (0.456)
Ep: 260, Reward: 276.5490, Test: 49.2004 [141.11], Avg: 259.2943 (0.455)
Ep: 261, Reward: 79.2012, Test: -46.1550 [28.44], Avg: 258.0199 (0.454)
Ep: 262, Reward: 36.3735, Test: -11.8924 [44.92], Avg: 256.8228 (0.452)
Ep: 263, Reward: -21.3368, Test: 76.5101 [182.39], Avg: 255.4489 (0.451)
Ep: 264, Reward: 258.0034, Test: 156.2700 [285.81], Avg: 253.9961 (0.450)
Ep: 265, Reward: 107.1052, Test: 281.3731 [257.91], Avg: 253.1294 (0.448)
Ep: 266, Reward: 275.6977, Test: 321.0512 [249.26], Avg: 252.4502 (0.447)
Ep: 267, Reward: 304.9416, Test: 375.8426 [234.44], Avg: 252.0359 (0.446)
Ep: 268, Reward: 296.5139, Test: 222.3800 [209.42], Avg: 251.1472 (0.444)
Ep: 269, Reward: 368.0537, Test: 383.3928 [274.06], Avg: 250.6219 (0.443)
Ep: 270, Reward: 390.1812, Test: 278.8737 [141.56], Avg: 250.2038 (0.442)
Ep: 271, Reward: 262.8775, Test: 260.6106 [160.99], Avg: 249.6502 (0.440)
Ep: 272, Reward: 331.0045, Test: 186.9253 [151.74], Avg: 248.8646 (0.439)
Ep: 273, Reward: 350.0726, Test: 379.6440 [238.96], Avg: 248.4698 (0.438)
Ep: 274, Reward: 351.9529, Test: 305.0214 [175.96], Avg: 248.0356 (0.436)
Ep: 275, Reward: 323.4809, Test: 532.2267 [311.65], Avg: 247.9361 (0.435)
Ep: 276, Reward: 434.9192, Test: 316.8717 [237.74], Avg: 247.3267 (0.434)
Ep: 277, Reward: 277.1977, Test: 316.6452 [106.99], Avg: 247.1912 (0.432)
Ep: 278, Reward: 407.6828, Test: 452.8913 [237.80], Avg: 247.0761 (0.431)
Ep: 279, Reward: 417.5409, Test: 374.3403 [210.83], Avg: 246.7777 (0.430)
Ep: 280, Reward: 406.5740, Test: 419.5365 [207.19], Avg: 246.6551 (0.429)
Ep: 281, Reward: 368.4178, Test: 299.3243 [156.04], Avg: 246.2886 (0.427)
Ep: 282, Reward: 350.8697, Test: 540.3210 [195.00], Avg: 246.6385 (0.426)
Ep: 283, Reward: 291.0642, Test: 380.6491 [175.60], Avg: 246.4921 (0.425)
Ep: 284, Reward: 361.9801, Test: 381.4186 [197.30], Avg: 246.2732 (0.423)
Ep: 285, Reward: 326.1341, Test: 264.8584 [138.06], Avg: 245.8555 (0.422)
Ep: 286, Reward: 295.1013, Test: 312.5225 [85.70], Avg: 245.7892 (0.421)
Ep: 287, Reward: 314.7453, Test: 334.1574 [228.04], Avg: 245.3042 (0.420)
Ep: 288, Reward: 392.4614, Test: 312.5119 [181.97], Avg: 244.9071 (0.418)
Ep: 289, Reward: 431.4614, Test: 355.1710 [163.93], Avg: 244.7221 (0.417)
Ep: 290, Reward: 395.9125, Test: 425.0201 [245.91], Avg: 244.4966 (0.416)
Ep: 291, Reward: 375.1810, Test: 387.8546 [160.64], Avg: 244.4374 (0.415)
Ep: 292, Reward: 415.5958, Test: 441.3640 [205.27], Avg: 244.4090 (0.413)
Ep: 293, Reward: 367.6312, Test: 278.0587 [118.27], Avg: 244.1211 (0.412)
Ep: 294, Reward: 334.2985, Test: 390.9734 [217.34], Avg: 243.8822 (0.411)
Ep: 295, Reward: 388.4870, Test: 491.8876 [202.84], Avg: 244.0348 (0.410)
Ep: 296, Reward: 404.4037, Test: 366.2422 [184.04], Avg: 243.8266 (0.408)
Ep: 297, Reward: 345.5358, Test: 498.3581 [227.23], Avg: 243.9182 (0.407)
Ep: 298, Reward: 411.3957, Test: 439.9642 [253.26], Avg: 243.7269 (0.406)
Ep: 299, Reward: 331.3591, Test: 508.6672 [242.90], Avg: 243.8003 (0.405)
Ep: 300, Reward: 285.5484, Test: 360.1467 [226.22], Avg: 243.4353 (0.404)
Ep: 301, Reward: 476.8438, Test: 527.2256 [186.57], Avg: 243.7572 (0.402)
Ep: 302, Reward: 422.2839, Test: 315.7044 [167.03], Avg: 243.4434 (0.401)
Ep: 303, Reward: 398.7439, Test: 264.8795 [168.36], Avg: 242.9601 (0.400)
Ep: 304, Reward: 467.5028, Test: 368.6452 [171.50], Avg: 242.8098 (0.399)
Ep: 305, Reward: 490.7534, Test: 507.4552 [198.36], Avg: 243.0264 (0.398)
Ep: 306, Reward: 454.0805, Test: 458.7480 [192.09], Avg: 243.1034 (0.396)
Ep: 307, Reward: 467.7987, Test: 332.7941 [159.32], Avg: 242.8774 (0.395)
Ep: 308, Reward: 426.4434, Test: 383.1376 [167.95], Avg: 242.7877 (0.394)
Ep: 309, Reward: 402.9974, Test: 336.2606 [203.86], Avg: 242.4317 (0.393)
Ep: 310, Reward: 364.0828, Test: 407.8813 [198.22], Avg: 242.3263 (0.392)
Ep: 311, Reward: 366.7503, Test: 395.9724 [193.86], Avg: 242.1974 (0.390)
Ep: 312, Reward: 355.9395, Test: 413.2449 [221.91], Avg: 242.0349 (0.389)
Ep: 313, Reward: 445.5748, Test: 297.4019 [168.47], Avg: 241.6747 (0.388)
Ep: 314, Reward: 386.3490, Test: 493.1571 [197.19], Avg: 241.8470 (0.387)
Ep: 315, Reward: 462.1098, Test: 370.6677 [209.58], Avg: 241.5915 (0.386)
Ep: 316, Reward: 357.7262, Test: 374.3379 [201.76], Avg: 241.3738 (0.385)
Ep: 317, Reward: 391.1712, Test: 331.8545 [170.21], Avg: 241.1230 (0.383)
Ep: 318, Reward: 370.9520, Test: 322.1688 [177.49], Avg: 240.8207 (0.382)
Ep: 319, Reward: 441.9107, Test: 483.2525 [215.84], Avg: 240.9038 (0.381)
Ep: 320, Reward: 387.4882, Test: 365.7329 [190.21], Avg: 240.7001 (0.380)
Ep: 321, Reward: 365.0331, Test: 405.8075 [197.56], Avg: 240.5993 (0.379)
Ep: 322, Reward: 438.8120, Test: 413.0594 [200.05], Avg: 240.5139 (0.378)
Ep: 323, Reward: 417.7905, Test: 280.5854 [156.48], Avg: 240.1546 (0.377)
Ep: 324, Reward: 422.8881, Test: 325.2589 [168.38], Avg: 239.8984 (0.376)
Ep: 325, Reward: 351.2638, Test: 354.4399 [201.48], Avg: 239.6317 (0.374)
Ep: 326, Reward: 353.9523, Test: 252.1386 [145.21], Avg: 239.2259 (0.373)
Ep: 327, Reward: 319.6202, Test: 195.0124 [148.54], Avg: 238.6382 (0.372)
Ep: 328, Reward: 347.4692, Test: 282.5545 [179.53], Avg: 238.2260 (0.371)
Ep: 329, Reward: 294.0450, Test: 297.1071 [152.97], Avg: 237.9409 (0.370)
Ep: 330, Reward: 283.2656, Test: 229.0812 [144.61], Avg: 237.4773 (0.369)
Ep: 331, Reward: 287.2911, Test: 275.8365 [61.32], Avg: 237.4081 (0.368)
Ep: 332, Reward: 299.9407, Test: 295.5947 [186.77], Avg: 237.0220 (0.367)
Ep: 333, Reward: 356.4088, Test: 281.0310 [145.11], Avg: 236.7193 (0.365)
Ep: 334, Reward: 374.3716, Test: 317.6976 [138.00], Avg: 236.5490 (0.364)
Ep: 335, Reward: 288.1822, Test: 316.5968 [92.86], Avg: 236.5109 (0.363)
Ep: 336, Reward: 309.1420, Test: 191.4012 [79.15], Avg: 236.1422 (0.362)
Ep: 337, Reward: 290.6404, Test: 254.0497 [151.28], Avg: 235.7476 (0.361)
Ep: 338, Reward: 284.3450, Test: 299.9227 [160.22], Avg: 235.4643 (0.360)
Ep: 339, Reward: 269.7130, Test: 333.1805 [136.53], Avg: 235.3501 (0.359)
Ep: 340, Reward: 363.8860, Test: 282.2505 [183.91], Avg: 234.9483 (0.358)
Ep: 341, Reward: 271.0725, Test: 188.6296 [124.06], Avg: 234.4501 (0.357)
Ep: 342, Reward: 364.1741, Test: 312.6165 [146.84], Avg: 234.2499 (0.356)
Ep: 343, Reward: 296.1333, Test: 211.3667 [212.16], Avg: 233.5667 (0.355)
Ep: 344, Reward: 219.2195, Test: 320.4394 [155.34], Avg: 233.3682 (0.354)
Ep: 345, Reward: 256.2536, Test: 219.7798 [77.95], Avg: 233.1036 (0.353)
Ep: 346, Reward: 210.4494, Test: 385.2761 [178.85], Avg: 233.0267 (0.351)
Ep: 347, Reward: 238.7444, Test: 156.8159 [97.54], Avg: 232.5275 (0.350)
Ep: 348, Reward: 306.2961, Test: 240.5162 [210.66], Avg: 231.9467 (0.349)
Ep: 349, Reward: 246.4002, Test: 281.5573 [108.48], Avg: 231.7785 (0.348)
Ep: 350, Reward: 283.9066, Test: 254.2687 [139.18], Avg: 231.4461 (0.347)
Ep: 351, Reward: 261.5107, Test: 321.4946 [60.62], Avg: 231.5297 (0.346)
Ep: 352, Reward: 322.1233, Test: 236.3503 [101.73], Avg: 231.2552 (0.345)
Ep: 353, Reward: 248.8355, Test: 271.3302 [126.09], Avg: 231.0122 (0.344)
Ep: 354, Reward: 251.2985, Test: 253.6433 [117.26], Avg: 230.7456 (0.343)
Ep: 355, Reward: 293.5241, Test: 191.0456 [163.89], Avg: 230.1738 (0.342)
Ep: 356, Reward: 310.2576, Test: 250.3136 [204.54], Avg: 229.6572 (0.341)
Ep: 357, Reward: 198.5196, Test: 296.0826 [154.02], Avg: 229.4126 (0.340)
Ep: 358, Reward: 296.2884, Test: 245.2271 [75.96], Avg: 229.2450 (0.339)
Ep: 359, Reward: 275.3518, Test: 197.0432 [96.79], Avg: 228.8867 (0.338)
Ep: 360, Reward: 221.9757, Test: 278.3290 [105.03], Avg: 228.7327 (0.337)
Ep: 361, Reward: 325.3665, Test: 188.8190 [85.20], Avg: 228.3871 (0.336)
Ep: 362, Reward: 269.0667, Test: 257.5447 [107.32], Avg: 228.1718 (0.335)
Ep: 363, Reward: 286.7820, Test: 238.8913 [103.36], Avg: 227.9173 (0.334)
Ep: 364, Reward: 262.9198, Test: 215.0643 [146.44], Avg: 227.4809 (0.333)
Ep: 365, Reward: 252.1466, Test: 234.9731 [116.06], Avg: 227.1842 (0.332)
Ep: 366, Reward: 209.7203, Test: 287.2399 [211.74], Avg: 226.7709 (0.331)
Ep: 367, Reward: 288.0277, Test: 272.6051 [143.96], Avg: 226.5043 (0.330)
Ep: 368, Reward: 290.4694, Test: 185.3505 [122.90], Avg: 226.0597 (0.329)
Ep: 369, Reward: 312.4289, Test: 262.7323 [194.02], Avg: 225.6344 (0.328)
Ep: 370, Reward: 181.2239, Test: 276.3552 [105.22], Avg: 225.4875 (0.327)
Ep: 371, Reward: 240.6792, Test: 273.7982 [154.53], Avg: 225.2019 (0.326)
Ep: 372, Reward: 329.1158, Test: 287.8817 [139.11], Avg: 224.9970 (0.325)
Ep: 373, Reward: 210.6561, Test: 271.3457 [94.53], Avg: 224.8682 (0.324)
Ep: 374, Reward: 181.6599, Test: 220.1352 [108.66], Avg: 224.5658 (0.323)
Ep: 375, Reward: 212.6709, Test: 274.7103 [135.76], Avg: 224.3382 (0.322)
Ep: 376, Reward: 263.0216, Test: 251.6290 [106.38], Avg: 224.1284 (0.321)
Ep: 377, Reward: 254.6851, Test: 285.3605 [178.96], Avg: 223.8169 (0.320)
Ep: 378, Reward: 304.0074, Test: 369.3055 [127.40], Avg: 223.8647 (0.319)
Ep: 379, Reward: 204.2118, Test: 354.1622 [139.29], Avg: 223.8410 (0.318)
Ep: 380, Reward: 248.9143, Test: 234.8219 [83.70], Avg: 223.6501 (0.317)
Ep: 381, Reward: 351.9928, Test: 230.0590 [67.10], Avg: 223.4913 (0.316)
Ep: 382, Reward: 322.9843, Test: 206.6175 [97.64], Avg: 223.1923 (0.315)
Ep: 383, Reward: 346.8035, Test: 265.6722 [54.83], Avg: 223.1601 (0.315)
Ep: 384, Reward: 289.2782, Test: 258.0015 [136.53], Avg: 222.8960 (0.314)
Ep: 385, Reward: 349.8489, Test: 180.4631 [108.62], Avg: 222.5046 (0.313)
Ep: 386, Reward: 246.3498, Test: 246.4025 [182.46], Avg: 222.0949 (0.312)
Ep: 387, Reward: 282.0504, Test: 242.2154 [141.85], Avg: 221.7812 (0.311)
Ep: 388, Reward: 300.5585, Test: 226.9254 [103.14], Avg: 221.5292 (0.310)
Ep: 389, Reward: 264.2913, Test: 238.6421 [106.33], Avg: 221.3005 (0.309)
Ep: 390, Reward: 216.6253, Test: 249.4724 [190.37], Avg: 220.8856 (0.308)
Ep: 391, Reward: 187.4865, Test: 209.0225 [124.04], Avg: 220.5390 (0.307)
Ep: 392, Reward: 347.4661, Test: 275.6632 [82.00], Avg: 220.4706 (0.306)
Ep: 393, Reward: 289.3653, Test: 304.3016 [132.33], Avg: 220.3475 (0.305)
Ep: 394, Reward: 268.9323, Test: 349.3002 [143.43], Avg: 220.3108 (0.304)
Ep: 395, Reward: 205.5755, Test: 273.7210 [109.56], Avg: 220.1690 (0.303)
Ep: 396, Reward: 322.5587, Test: 249.8350 [118.69], Avg: 219.9448 (0.302)
Ep: 397, Reward: 255.3417, Test: 276.0205 [115.25], Avg: 219.7961 (0.302)
Ep: 398, Reward: 304.2956, Test: 340.3282 [171.70], Avg: 219.6679 (0.301)
Ep: 399, Reward: 242.9201, Test: 253.4907 [181.59], Avg: 219.2985 (0.300)
Ep: 400, Reward: 285.7904, Test: 321.2387 [175.14], Avg: 219.1159 (0.299)
Ep: 401, Reward: 300.3516, Test: 349.1627 [226.78], Avg: 218.8753 (0.298)
Ep: 402, Reward: 343.7479, Test: 337.1692 [186.35], Avg: 218.7064 (0.297)
Ep: 403, Reward: 333.4972, Test: 418.1885 [261.32], Avg: 218.5534 (0.296)
Ep: 404, Reward: 308.2241, Test: 240.9266 [193.83], Avg: 218.1300 (0.295)
Ep: 405, Reward: 254.9892, Test: 250.6204 [147.62], Avg: 217.8464 (0.294)
Ep: 406, Reward: 326.4384, Test: 220.6651 [152.23], Avg: 217.4793 (0.294)
Ep: 407, Reward: 335.8005, Test: 262.8346 [75.97], Avg: 217.4043 (0.293)
Ep: 408, Reward: 282.2307, Test: 371.8609 [158.92], Avg: 217.3934 (0.292)
Ep: 409, Reward: 308.5274, Test: 314.3125 [138.05], Avg: 217.2931 (0.291)
Ep: 410, Reward: 326.7879, Test: 343.4928 [202.31], Avg: 217.1079 (0.290)
Ep: 411, Reward: 345.2653, Test: 296.1238 [132.16], Avg: 216.9789 (0.289)
Ep: 412, Reward: 314.1311, Test: 241.1562 [125.08], Avg: 216.7346 (0.288)
Ep: 413, Reward: 307.1981, Test: 220.7759 [120.95], Avg: 216.4522 (0.287)
Ep: 414, Reward: 344.3128, Test: 239.1468 [140.16], Avg: 216.1691 (0.287)
Ep: 415, Reward: 330.7943, Test: 254.3853 [159.17], Avg: 215.8784 (0.286)
