Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 32,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.0225               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 200000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -58.4559, Test: -56.0086 [24.24], Avg: -80.2441 (0.980)
Ep: 1, Reward: -56.4878, Test: -56.1576 [15.54], Avg: -75.9729 (0.960)
Ep: 2, Reward: -45.3885, Test: -60.2010 [17.12], Avg: -76.4226 (0.941)
Ep: 3, Reward: -55.4958, Test: -67.0986 [36.38], Avg: -83.1877 (0.922)
Ep: 4, Reward: -58.9674, Test: -32.1245 [26.26], Avg: -78.2271 (0.904)
Ep: 5, Reward: -57.2592, Test: -55.2992 [27.53], Avg: -78.9947 (0.886)
Ep: 6, Reward: -42.3227, Test: -39.9898 [23.86], Avg: -76.8317 (0.868)
Ep: 7, Reward: -54.5064, Test: -63.9928 [39.31], Avg: -80.1410 (0.851)
Ep: 8, Reward: -60.8743, Test: -52.2043 [27.61], Avg: -80.1046 (0.834)
Ep: 9, Reward: -47.6716, Test: -51.6727 [31.53], Avg: -80.4144 (0.817)
Ep: 10, Reward: -56.5709, Test: -38.3318 [21.71], Avg: -78.5621 (0.801)
Ep: 11, Reward: -59.0755, Test: -44.3676 [21.20], Avg: -77.4792 (0.785)
Ep: 12, Reward: -53.4326, Test: -52.6751 [18.63], Avg: -77.0046 (0.769)
Ep: 13, Reward: -47.1371, Test: -49.2874 [24.11], Avg: -76.7467 (0.754)
Ep: 14, Reward: -54.3733, Test: -55.6432 [25.11], Avg: -77.0139 (0.739)
Ep: 15, Reward: -51.6932, Test: -49.8793 [13.57], Avg: -76.1662 (0.724)
Ep: 16, Reward: -50.5238, Test: -65.6051 [53.34], Avg: -78.6825 (0.709)
Ep: 17, Reward: -41.6214, Test: -43.8909 [17.09], Avg: -77.6992 (0.695)
Ep: 18, Reward: -34.8421, Test: -58.4455 [30.30], Avg: -78.2803 (0.681)
Ep: 19, Reward: -46.5807, Test: -56.9133 [39.79], Avg: -79.2014 (0.668)
Ep: 20, Reward: -47.7499, Test: -47.4254 [20.45], Avg: -78.6620 (0.654)
Ep: 21, Reward: -42.7076, Test: -40.5919 [36.36], Avg: -78.5842 (0.641)
Ep: 22, Reward: -40.0794, Test: -38.3643 [37.20], Avg: -78.4530 (0.628)
Ep: 23, Reward: -33.1754, Test: -34.2715 [25.10], Avg: -77.6580 (0.616)
Ep: 24, Reward: -49.3595, Test: -25.1165 [57.64], Avg: -77.8619 (0.603)
Ep: 25, Reward: -46.0400, Test: -39.6837 [52.17], Avg: -78.4000 (0.591)
Ep: 26, Reward: -58.7923, Test: -35.1025 [23.22], Avg: -77.6564 (0.580)
Ep: 27, Reward: -28.6733, Test: -16.5229 [43.25], Avg: -77.0176 (0.568)
Ep: 28, Reward: -24.1188, Test: -44.5039 [63.51], Avg: -78.0864 (0.557)
Ep: 29, Reward: -22.7432, Test: -26.3923 [41.97], Avg: -77.7624 (0.545)
Ep: 30, Reward: -11.1549, Test: 9.5804 [51.22], Avg: -76.5970 (0.535)
Ep: 31, Reward: -9.0084, Test: -10.1852 [68.51], Avg: -76.6626 (0.524)
Ep: 32, Reward: 14.5450, Test: 36.2150 [54.21], Avg: -74.8849 (0.513)
Ep: 33, Reward: 26.4462, Test: 16.3216 [67.46], Avg: -74.1865 (0.503)
Ep: 34, Reward: 16.8423, Test: 30.6614 [53.33], Avg: -72.7145 (0.493)
Ep: 35, Reward: 43.3854, Test: 30.7199 [53.13], Avg: -71.3170 (0.483)
Ep: 36, Reward: 30.8741, Test: 26.1156 [68.51], Avg: -70.5352 (0.474)
Ep: 37, Reward: 46.6209, Test: 113.3224 [102.44], Avg: -68.3927 (0.464)
Ep: 38, Reward: 29.6037, Test: 57.6513 [101.03], Avg: -67.7512 (0.455)
Ep: 39, Reward: 67.8097, Test: 86.4030 [115.83], Avg: -66.7932 (0.446)
Ep: 40, Reward: 33.5490, Test: 74.5881 [82.98], Avg: -65.3687 (0.437)
Ep: 41, Reward: 65.1111, Test: 36.1177 [71.02], Avg: -64.6432 (0.428)
Ep: 42, Reward: 30.8995, Test: 147.5887 [169.73], Avg: -63.6548 (0.419)
Ep: 43, Reward: 91.8823, Test: 133.5858 [139.53], Avg: -62.3432 (0.411)
Ep: 44, Reward: 54.7628, Test: 70.6591 [140.54], Avg: -62.5107 (0.403)
Ep: 45, Reward: 58.0035, Test: 185.2890 [201.60], Avg: -61.5063 (0.395)
Ep: 46, Reward: 86.8555, Test: 137.0221 [148.64], Avg: -60.4448 (0.387)
Ep: 47, Reward: 99.6940, Test: 177.9189 [140.09], Avg: -58.3974 (0.379)
Ep: 48, Reward: 107.0627, Test: 48.1897 [97.81], Avg: -58.2184 (0.372)
Ep: 49, Reward: 104.9533, Test: 24.5855 [75.02], Avg: -58.0627 (0.364)
Ep: 50, Reward: 156.7734, Test: 190.6779 [140.12], Avg: -55.9329 (0.357)
Ep: 51, Reward: 174.8206, Test: 90.4775 [133.05], Avg: -55.6760 (0.350)
Ep: 52, Reward: 154.7775, Test: 143.3900 [172.92], Avg: -55.1827 (0.343)
Ep: 53, Reward: 156.6053, Test: 213.9522 [155.91], Avg: -53.0860 (0.336)
Ep: 54, Reward: 140.9726, Test: 326.3930 [192.91], Avg: -49.6939 (0.329)
Ep: 55, Reward: 115.1305, Test: 344.4757 [194.72], Avg: -46.1324 (0.323)
Ep: 56, Reward: 79.2942, Test: 209.1699 [121.73], Avg: -43.7889 (0.316)
Ep: 57, Reward: 224.8723, Test: 192.9545 [202.46], Avg: -43.1978 (0.310)
Ep: 58, Reward: 195.8163, Test: 267.5594 [175.17], Avg: -40.8998 (0.304)
Ep: 59, Reward: 182.9785, Test: 171.1813 [180.95], Avg: -40.3809 (0.298)
Ep: 60, Reward: 223.6337, Test: 247.6860 [173.55], Avg: -38.5036 (0.292)
Ep: 61, Reward: 203.0054, Test: 141.4204 [224.80], Avg: -39.2273 (0.286)
Ep: 62, Reward: 282.0869, Test: 178.3294 [197.33], Avg: -38.9063 (0.280)
Ep: 63, Reward: 268.3097, Test: 332.7716 [218.82], Avg: -36.5179 (0.274)
Ep: 64, Reward: 229.1013, Test: 433.5018 [212.30], Avg: -32.5530 (0.269)
Ep: 65, Reward: 264.6712, Test: 129.1408 [134.87], Avg: -32.1465 (0.264)
Ep: 66, Reward: 204.1184, Test: 366.3635 [269.34], Avg: -30.2185 (0.258)
Ep: 67, Reward: 178.0488, Test: 287.7652 [219.46], Avg: -28.7697 (0.253)
Ep: 68, Reward: 239.4558, Test: 291.8102 [283.45], Avg: -28.2316 (0.248)
Ep: 69, Reward: 236.0643, Test: 273.5843 [168.86], Avg: -26.3323 (0.243)
Ep: 70, Reward: 255.3049, Test: 281.8338 [136.93], Avg: -23.9205 (0.238)
Ep: 71, Reward: 268.6742, Test: 461.2529 [182.35], Avg: -19.7146 (0.233)
Ep: 72, Reward: 305.3841, Test: 230.4362 [140.13], Avg: -18.2075 (0.229)
Ep: 73, Reward: 347.7996, Test: 302.0242 [255.04], Avg: -17.3266 (0.224)
Ep: 74, Reward: 417.4636, Test: 303.0809 [184.03], Avg: -15.5083 (0.220)
Ep: 75, Reward: 465.5087, Test: 623.7721 [172.47], Avg: -9.3661 (0.215)
Ep: 76, Reward: 409.5046, Test: 503.3685 [115.64], Avg: -4.2090 (0.211)
Ep: 77, Reward: 406.0910, Test: 582.6419 [231.86], Avg: 0.3421 (0.207)
Ep: 78, Reward: 492.8413, Test: 501.9623 [287.10], Avg: 3.0575 (0.203)
Ep: 79, Reward: 403.1409, Test: 373.8981 [285.26], Avg: 4.1272 (0.199)
Ep: 80, Reward: 518.6040, Test: 611.8963 [151.48], Avg: 9.7605 (0.195)
Ep: 81, Reward: 541.8925, Test: 667.6024 [129.95], Avg: 16.1982 (0.191)
Ep: 82, Reward: 547.3261, Test: 509.4754 [224.33], Avg: 19.4385 (0.187)
Ep: 83, Reward: 559.1471, Test: 596.7778 [181.59], Avg: 24.1497 (0.183)
Ep: 84, Reward: 531.3682, Test: 545.0266 [219.48], Avg: 27.6956 (0.180)
Ep: 85, Reward: 607.4626, Test: 424.3958 [313.65], Avg: 28.6613 (0.176)
Ep: 86, Reward: 429.0956, Test: 384.1700 [190.69], Avg: 30.5557 (0.172)
Ep: 87, Reward: 512.9881, Test: 488.1344 [234.67], Avg: 33.0888 (0.169)
Ep: 88, Reward: 512.2601, Test: 379.7748 [258.01], Avg: 34.0851 (0.166)
Ep: 89, Reward: 446.2445, Test: 362.8986 [226.83], Avg: 35.2183 (0.162)
Ep: 90, Reward: 555.4117, Test: 504.8494 [338.02], Avg: 36.6646 (0.159)
Ep: 91, Reward: 500.4130, Test: 336.5969 [259.00], Avg: 37.1096 (0.156)
Ep: 92, Reward: 469.0709, Test: 421.3968 [252.41], Avg: 38.5276 (0.153)
Ep: 93, Reward: 541.8746, Test: 587.3496 [205.84], Avg: 42.1763 (0.150)
Ep: 94, Reward: 477.1452, Test: 508.0117 [246.02], Avg: 44.4902 (0.147)
Ep: 95, Reward: 480.5128, Test: 406.3176 [259.97], Avg: 45.5511 (0.144)
Ep: 96, Reward: 437.7277, Test: 415.4469 [289.00], Avg: 46.3851 (0.141)
Ep: 97, Reward: 511.4327, Test: 444.8930 [233.31], Avg: 48.0708 (0.138)
Ep: 98, Reward: 572.1786, Test: 539.0129 [198.49], Avg: 51.0248 (0.135)
Ep: 99, Reward: 516.1149, Test: 481.6196 [250.00], Avg: 52.8308 (0.133)
Ep: 100, Reward: 477.5590, Test: 471.5747 [231.00], Avg: 54.6897 (0.130)
Ep: 101, Reward: 542.1280, Test: 512.1166 [190.55], Avg: 57.3061 (0.127)
Ep: 102, Reward: 454.3176, Test: 605.8623 [213.40], Avg: 60.5600 (0.125)
Ep: 103, Reward: 519.4238, Test: 507.0127 [190.95], Avg: 63.0168 (0.122)
Ep: 104, Reward: 443.0288, Test: 519.2082 [250.45], Avg: 64.9762 (0.120)
Ep: 105, Reward: 479.6443, Test: 555.0143 [224.63], Avg: 67.4801 (0.117)
Ep: 106, Reward: 404.5760, Test: 467.4439 [162.15], Avg: 69.7027 (0.115)
Ep: 107, Reward: 488.4648, Test: 479.7685 [166.08], Avg: 71.9618 (0.113)
Ep: 108, Reward: 476.6416, Test: 367.0790 [211.55], Avg: 72.7285 (0.111)
Ep: 109, Reward: 387.4123, Test: 547.9456 [244.89], Avg: 74.8223 (0.108)
Ep: 110, Reward: 536.3659, Test: 459.6430 [218.61], Avg: 76.3197 (0.106)
Ep: 111, Reward: 487.7707, Test: 518.4009 [153.34], Avg: 78.8977 (0.104)
Ep: 112, Reward: 504.6535, Test: 530.6671 [180.48], Avg: 81.2985 (0.102)
Ep: 113, Reward: 503.6396, Test: 461.0226 [215.89], Avg: 82.7357 (0.100)
Ep: 114, Reward: 444.3217, Test: 433.1847 [180.16], Avg: 84.2164 (0.098)
Ep: 115, Reward: 535.5791, Test: 569.0933 [179.35], Avg: 86.8502 (0.096)
Ep: 116, Reward: 500.2905, Test: 354.2521 [174.67], Avg: 87.6428 (0.094)
Ep: 117, Reward: 448.4607, Test: 518.8111 [205.31], Avg: 89.5568 (0.092)
Ep: 118, Reward: 392.5030, Test: 400.8464 [255.15], Avg: 90.0285 (0.090)
Ep: 119, Reward: 400.4929, Test: 338.6071 [256.05], Avg: 89.9663 (0.089)
Ep: 120, Reward: 319.3308, Test: 370.5862 [263.83], Avg: 90.1050 (0.087)
Ep: 121, Reward: 406.9241, Test: 454.4356 [178.13], Avg: 91.6313 (0.085)
Ep: 122, Reward: 365.0285, Test: 421.9223 [198.12], Avg: 92.7058 (0.083)
Ep: 123, Reward: 378.6224, Test: 395.6977 [159.02], Avg: 93.8669 (0.082)
Ep: 124, Reward: 379.1239, Test: 430.5832 [160.85], Avg: 95.2738 (0.080)
Ep: 125, Reward: 420.3584, Test: 347.7004 [156.06], Avg: 96.0386 (0.078)
Ep: 126, Reward: 405.8493, Test: 599.2982 [148.01], Avg: 98.8358 (0.077)
Ep: 127, Reward: 472.2839, Test: 411.8430 [130.22], Avg: 100.2639 (0.075)
Ep: 128, Reward: 429.8568, Test: 309.3869 [147.06], Avg: 100.7449 (0.074)
Ep: 129, Reward: 419.7094, Test: 448.0056 [138.54], Avg: 102.3505 (0.072)
Ep: 130, Reward: 387.0685, Test: 346.9218 [157.58], Avg: 103.0146 (0.071)
Ep: 131, Reward: 414.6221, Test: 418.3068 [178.97], Avg: 104.0473 (0.069)
Ep: 132, Reward: 377.2172, Test: 452.5887 [169.97], Avg: 105.3900 (0.068)
Ep: 133, Reward: 471.8426, Test: 397.8801 [233.54], Avg: 105.8299 (0.067)
Ep: 134, Reward: 378.1917, Test: 413.0123 [170.04], Avg: 106.8458 (0.065)
Ep: 135, Reward: 401.4978, Test: 444.7428 [146.52], Avg: 108.2530 (0.064)
Ep: 136, Reward: 396.1220, Test: 382.8074 [230.74], Avg: 108.5728 (0.063)
Ep: 137, Reward: 443.0382, Test: 340.9268 [189.23], Avg: 108.8853 (0.062)
Ep: 138, Reward: 390.7484, Test: 354.6949 [149.68], Avg: 109.5769 (0.060)
Ep: 139, Reward: 389.8078, Test: 353.2077 [174.25], Avg: 110.0725 (0.059)
Ep: 140, Reward: 333.9019, Test: 291.5125 [165.77], Avg: 110.1837 (0.058)
Ep: 141, Reward: 379.0904, Test: 435.4129 [215.30], Avg: 110.9578 (0.057)
Ep: 142, Reward: 446.7330, Test: 523.9253 [277.40], Avg: 111.9059 (0.056)
Ep: 143, Reward: 476.0903, Test: 504.7463 [240.89], Avg: 112.9611 (0.055)
Ep: 144, Reward: 561.9393, Test: 516.0922 [311.78], Avg: 113.5911 (0.053)
Ep: 145, Reward: 515.9609, Test: 569.4542 [220.99], Avg: 115.1998 (0.052)
Ep: 146, Reward: 584.1996, Test: 536.2800 [233.40], Avg: 116.4765 (0.051)
Ep: 147, Reward: 602.8312, Test: 704.5816 [201.60], Avg: 119.0881 (0.050)
Ep: 148, Reward: 651.0016, Test: 658.4331 [163.92], Avg: 121.6077 (0.049)
Ep: 149, Reward: 727.8511, Test: 764.1610 [139.19], Avg: 124.9635 (0.048)
Ep: 150, Reward: 736.0533, Test: 805.7032 [89.60], Avg: 128.8783 (0.047)
Ep: 151, Reward: 860.1033, Test: 742.2291 [186.40], Avg: 131.6872 (0.046)
Ep: 152, Reward: 865.0924, Test: 844.8534 [128.05], Avg: 135.5115 (0.045)
Ep: 153, Reward: 856.1179, Test: 847.6763 [46.45], Avg: 139.8343 (0.045)
Ep: 154, Reward: 789.4009, Test: 839.2151 [39.03], Avg: 144.0947 (0.044)
Ep: 155, Reward: 752.4048, Test: 827.9693 [28.11], Avg: 148.2983 (0.043)
Ep: 156, Reward: 744.4579, Test: 656.7176 [269.42], Avg: 149.8206 (0.042)
Ep: 157, Reward: 575.4390, Test: 616.0078 [188.73], Avg: 151.5766 (0.041)
Ep: 158, Reward: 588.3105, Test: 603.8507 [209.60], Avg: 153.1029 (0.040)
Ep: 159, Reward: 510.3452, Test: 523.4803 [305.15], Avg: 153.5106 (0.039)
Ep: 160, Reward: 546.8947, Test: 581.5539 [288.83], Avg: 154.3753 (0.039)
Ep: 161, Reward: 472.6952, Test: 698.5652 [161.80], Avg: 156.7357 (0.038)
Ep: 162, Reward: 575.9764, Test: 530.6941 [233.54], Avg: 157.5972 (0.037)
Ep: 163, Reward: 679.7952, Test: 634.4837 [231.93], Avg: 159.0908 (0.036)
Ep: 164, Reward: 713.8939, Test: 668.2193 [223.14], Avg: 160.8241 (0.036)
Ep: 165, Reward: 753.2711, Test: 712.3118 [206.48], Avg: 162.9024 (0.035)
Ep: 166, Reward: 713.1303, Test: 657.6220 [228.11], Avg: 164.4989 (0.034)
Ep: 167, Reward: 710.0349, Test: 598.9316 [195.84], Avg: 165.9190 (0.034)
Ep: 168, Reward: 674.1750, Test: 557.1219 [231.95], Avg: 166.8614 (0.033)
Ep: 169, Reward: 549.8931, Test: 511.1577 [274.63], Avg: 167.2712 (0.032)
Ep: 170, Reward: 496.2089, Test: 481.2988 [260.66], Avg: 167.5833 (0.032)
Ep: 171, Reward: 469.8253, Test: 530.4311 [221.32], Avg: 168.4061 (0.031)
Ep: 172, Reward: 536.3212, Test: 543.2670 [216.45], Avg: 169.3218 (0.030)
Ep: 173, Reward: 443.2174, Test: 409.4469 [255.24], Avg: 169.2349 (0.030)
Ep: 174, Reward: 525.6587, Test: 601.5883 [158.26], Avg: 170.8012 (0.029)
Ep: 175, Reward: 546.9311, Test: 366.3093 [270.25], Avg: 170.3765 (0.029)
Ep: 176, Reward: 434.3629, Test: 455.2342 [302.31], Avg: 170.2779 (0.028)
Ep: 177, Reward: 540.7370, Test: 718.9705 [217.99], Avg: 172.1358 (0.027)
Ep: 178, Reward: 714.9698, Test: 710.2577 [214.80], Avg: 173.9421 (0.027)
Ep: 179, Reward: 744.0323, Test: 723.2183 [227.53], Avg: 175.7296 (0.026)
Ep: 180, Reward: 817.4160, Test: 614.8862 [236.79], Avg: 176.8476 (0.026)
Ep: 181, Reward: 562.7288, Test: 501.5263 [252.40], Avg: 177.2447 (0.025)
Ep: 182, Reward: 489.8087, Test: 615.2532 [200.40], Avg: 178.5431 (0.025)
Ep: 183, Reward: 551.3596, Test: 418.3726 [275.58], Avg: 178.3489 (0.024)
Ep: 184, Reward: 543.6080, Test: 451.9049 [204.42], Avg: 178.7226 (0.024)
Ep: 185, Reward: 537.9907, Test: 526.0133 [245.30], Avg: 179.2709 (0.023)
Ep: 186, Reward: 487.3974, Test: 521.5113 [210.94], Avg: 179.9731 (0.023)
Ep: 187, Reward: 449.9149, Test: 476.3131 [255.66], Avg: 180.1894 (0.022)
Ep: 188, Reward: 489.6654, Test: 556.6744 [178.84], Avg: 181.2352 (0.022)
Ep: 189, Reward: 578.3749, Test: 552.1589 [178.81], Avg: 182.2463 (0.022)
Ep: 190, Reward: 607.7139, Test: 558.7095 [169.79], Avg: 183.3283 (0.021)
Ep: 191, Reward: 654.2912, Test: 571.9774 [239.78], Avg: 184.1037 (0.021)
Ep: 192, Reward: 544.7154, Test: 543.1775 [279.56], Avg: 184.5157 (0.020)
Ep: 193, Reward: 653.3055, Test: 606.1285 [192.01], Avg: 185.6992 (0.020)
Ep: 194, Reward: 569.0772, Test: 533.0537 [160.06], Avg: 186.6597 (0.020)
Ep: 195, Reward: 645.0323, Test: 473.3743 [209.57], Avg: 187.0533 (0.020)
Ep: 196, Reward: 518.2852, Test: 603.9173 [204.04], Avg: 188.1336 (0.020)
Ep: 197, Reward: 561.7699, Test: 532.1087 [218.23], Avg: 188.7687 (0.020)
Ep: 198, Reward: 557.3851, Test: 534.1041 [232.11], Avg: 189.3377 (0.020)
Ep: 199, Reward: 469.1713, Test: 686.3137 [159.40], Avg: 191.0255 (0.020)
Ep: 200, Reward: 419.3220, Test: 428.7416 [129.63], Avg: 191.5633 (0.020)
Ep: 201, Reward: 521.7947, Test: 373.5930 [199.01], Avg: 191.4792 (0.020)
Ep: 202, Reward: 486.0602, Test: 498.4153 [227.76], Avg: 191.8692 (0.020)
Ep: 203, Reward: 620.8591, Test: 702.9886 [206.87], Avg: 193.3606 (0.020)
Ep: 204, Reward: 590.0951, Test: 489.5062 [250.59], Avg: 193.5828 (0.020)
Ep: 205, Reward: 469.1495, Test: 466.5588 [243.82], Avg: 193.7244 (0.020)
Ep: 206, Reward: 487.3225, Test: 588.9560 [216.53], Avg: 194.5877 (0.020)
Ep: 207, Reward: 556.8071, Test: 556.5454 [244.33], Avg: 195.1532 (0.020)
Ep: 208, Reward: 565.3601, Test: 483.8347 [241.25], Avg: 195.3801 (0.020)
Ep: 209, Reward: 603.1528, Test: 443.0389 [238.58], Avg: 195.4234 (0.020)
Ep: 210, Reward: 533.4019, Test: 577.4786 [268.72], Avg: 195.9605 (0.020)
Ep: 211, Reward: 610.9259, Test: 581.8123 [220.14], Avg: 196.7422 (0.020)
Ep: 212, Reward: 588.3287, Test: 576.0822 [224.78], Avg: 197.4678 (0.020)
Ep: 213, Reward: 537.1610, Test: 641.2221 [264.93], Avg: 198.3035 (0.020)
Ep: 214, Reward: 564.3477, Test: 620.6658 [240.89], Avg: 199.1475 (0.020)
Ep: 215, Reward: 539.1228, Test: 605.6221 [172.30], Avg: 200.2316 (0.020)
Ep: 216, Reward: 561.3067, Test: 606.6008 [219.71], Avg: 201.0918 (0.020)
Ep: 217, Reward: 558.0551, Test: 555.5189 [197.13], Avg: 201.8134 (0.020)
Ep: 218, Reward: 588.7755, Test: 514.3677 [224.90], Avg: 202.2136 (0.020)
Ep: 219, Reward: 471.1797, Test: 512.3435 [210.65], Avg: 202.6658 (0.020)
Ep: 220, Reward: 551.7314, Test: 475.3292 [194.91], Avg: 203.0177 (0.020)
Ep: 221, Reward: 482.6213, Test: 491.1640 [247.15], Avg: 203.2023 (0.020)
Ep: 222, Reward: 453.6949, Test: 459.8043 [180.34], Avg: 203.5443 (0.020)
Ep: 223, Reward: 613.8789, Test: 467.6788 [194.64], Avg: 203.8545 (0.020)
Ep: 224, Reward: 611.8602, Test: 594.1686 [187.62], Avg: 204.7554 (0.020)
Ep: 225, Reward: 616.1254, Test: 683.9786 [153.75], Avg: 206.1956 (0.020)
Ep: 226, Reward: 612.1845, Test: 689.7422 [150.66], Avg: 207.6620 (0.020)
Ep: 227, Reward: 631.5733, Test: 599.2159 [233.73], Avg: 208.3542 (0.020)
Ep: 228, Reward: 731.1936, Test: 670.1628 [225.23], Avg: 209.3873 (0.020)
Ep: 229, Reward: 707.1548, Test: 704.2826 [194.16], Avg: 210.6948 (0.020)
Ep: 230, Reward: 674.7666, Test: 838.9658 [93.15], Avg: 213.0114 (0.020)
Ep: 231, Reward: 746.8842, Test: 757.3101 [207.84], Avg: 214.4616 (0.020)
Ep: 232, Reward: 739.7714, Test: 595.9819 [250.99], Avg: 215.0218 (0.020)
Ep: 233, Reward: 830.0239, Test: 753.6562 [148.81], Avg: 216.6877 (0.020)
Ep: 234, Reward: 711.4511, Test: 733.6853 [205.89], Avg: 218.0116 (0.020)
Ep: 235, Reward: 687.5634, Test: 713.9729 [185.47], Avg: 219.3272 (0.020)
Ep: 236, Reward: 775.8019, Test: 554.2100 [195.44], Avg: 219.9156 (0.020)
Ep: 237, Reward: 710.4288, Test: 705.6351 [189.45], Avg: 221.1604 (0.020)
Ep: 238, Reward: 925.4215, Test: 740.4206 [181.95], Avg: 222.5718 (0.020)
Ep: 239, Reward: 731.6364, Test: 766.4987 [174.99], Avg: 224.1090 (0.020)
Ep: 240, Reward: 688.0129, Test: 585.2727 [306.69], Avg: 224.3350 (0.020)
Ep: 241, Reward: 803.5797, Test: 792.0822 [113.13], Avg: 226.2136 (0.020)
Ep: 242, Reward: 774.6359, Test: 776.3017 [89.51], Avg: 228.1090 (0.020)
Ep: 243, Reward: 759.3964, Test: 826.5238 [99.75], Avg: 230.1527 (0.020)
Ep: 244, Reward: 797.3134, Test: 785.6725 [106.91], Avg: 231.9838 (0.020)
Ep: 245, Reward: 630.5777, Test: 709.2428 [194.29], Avg: 233.1341 (0.020)
Ep: 246, Reward: 665.4057, Test: 632.0595 [233.50], Avg: 233.8038 (0.020)
Ep: 247, Reward: 619.5010, Test: 645.8245 [233.62], Avg: 234.5232 (0.020)
Ep: 248, Reward: 695.0683, Test: 735.2922 [162.66], Avg: 235.8811 (0.020)
Ep: 249, Reward: 551.9925, Test: 754.5981 [181.80], Avg: 237.2287 (0.020)
Ep: 250, Reward: 638.6274, Test: 603.6000 [221.85], Avg: 237.8045 (0.020)
Ep: 251, Reward: 765.3453, Test: 723.7603 [249.45], Avg: 238.7430 (0.020)
Ep: 252, Reward: 708.6380, Test: 738.5377 [205.78], Avg: 239.9051 (0.020)
Ep: 253, Reward: 762.5120, Test: 637.0694 [235.07], Avg: 240.5433 (0.020)
Ep: 254, Reward: 703.7943, Test: 769.4575 [136.07], Avg: 242.0839 (0.020)
Ep: 255, Reward: 600.8338, Test: 652.2166 [238.00], Avg: 242.7563 (0.020)
Ep: 256, Reward: 620.7739, Test: 601.4148 [245.81], Avg: 243.1954 (0.020)
Ep: 257, Reward: 691.6160, Test: 749.0157 [208.71], Avg: 244.3470 (0.020)
Ep: 258, Reward: 660.8642, Test: 710.1687 [209.95], Avg: 245.3349 (0.020)
Ep: 259, Reward: 587.3702, Test: 678.0368 [256.00], Avg: 246.0145 (0.020)
Ep: 260, Reward: 741.6402, Test: 541.5873 [311.16], Avg: 245.9548 (0.020)
Ep: 261, Reward: 603.1038, Test: 567.1373 [281.52], Avg: 246.1062 (0.020)
Ep: 262, Reward: 663.5692, Test: 607.5704 [118.63], Avg: 247.0295 (0.020)
Ep: 263, Reward: 707.2862, Test: 690.1980 [185.35], Avg: 248.0061 (0.020)
Ep: 264, Reward: 676.3800, Test: 722.6705 [187.75], Avg: 249.0888 (0.020)
Ep: 265, Reward: 691.7906, Test: 658.5562 [230.74], Avg: 249.7607 (0.020)
Ep: 266, Reward: 644.1995, Test: 574.3381 [284.55], Avg: 249.9106 (0.020)
Ep: 267, Reward: 620.8807, Test: 680.9898 [207.82], Avg: 250.7436 (0.020)
Ep: 268, Reward: 630.8498, Test: 574.6675 [209.15], Avg: 251.1703 (0.020)
Ep: 269, Reward: 587.7520, Test: 513.2378 [259.01], Avg: 251.1816 (0.020)
Ep: 270, Reward: 532.3790, Test: 444.9947 [219.50], Avg: 251.0868 (0.020)
Ep: 271, Reward: 552.6537, Test: 480.2414 [212.24], Avg: 251.1490 (0.020)
Ep: 272, Reward: 565.0278, Test: 407.6493 [219.53], Avg: 250.9181 (0.020)
Ep: 273, Reward: 469.3357, Test: 553.0292 [134.68], Avg: 251.5292 (0.020)
Ep: 274, Reward: 484.4439, Test: 401.2241 [223.42], Avg: 251.2611 (0.020)
Ep: 275, Reward: 507.1888, Test: 428.8916 [232.58], Avg: 251.0620 (0.020)
Ep: 276, Reward: 468.8330, Test: 516.9202 [215.20], Avg: 251.2449 (0.020)
Ep: 277, Reward: 412.6271, Test: 579.7924 [284.20], Avg: 251.4044 (0.020)
Ep: 278, Reward: 559.1267, Test: 472.7087 [291.67], Avg: 251.1522 (0.020)
Ep: 279, Reward: 558.9393, Test: 689.3251 [232.64], Avg: 251.8862 (0.020)
Ep: 280, Reward: 742.1523, Test: 697.6970 [256.45], Avg: 252.5601 (0.020)
Ep: 281, Reward: 580.1696, Test: 670.0149 [240.37], Avg: 253.1881 (0.020)
Ep: 282, Reward: 765.2256, Test: 609.8260 [231.07], Avg: 253.6318 (0.020)
Ep: 283, Reward: 648.1242, Test: 558.7400 [209.07], Avg: 253.9699 (0.020)
Ep: 284, Reward: 661.0449, Test: 484.8112 [215.72], Avg: 254.0230 (0.020)
Ep: 285, Reward: 647.1041, Test: 607.7235 [302.64], Avg: 254.2015 (0.020)
Ep: 286, Reward: 636.0549, Test: 770.9114 [118.98], Avg: 255.5873 (0.020)
Ep: 287, Reward: 716.4583, Test: 660.3243 [250.73], Avg: 256.1221 (0.020)
Ep: 288, Reward: 780.1084, Test: 749.5962 [253.74], Avg: 256.9516 (0.020)
Ep: 289, Reward: 689.6547, Test: 777.9270 [138.31], Avg: 258.2711 (0.020)
Ep: 290, Reward: 697.8694, Test: 802.9834 [133.97], Avg: 259.6826 (0.020)
Ep: 291, Reward: 632.8944, Test: 796.8730 [114.05], Avg: 261.1317 (0.020)
Ep: 292, Reward: 582.1552, Test: 644.9523 [236.37], Avg: 261.6350 (0.020)
Ep: 293, Reward: 587.3907, Test: 748.5468 [171.94], Avg: 262.7063 (0.020)
Ep: 294, Reward: 709.2845, Test: 419.0086 [271.80], Avg: 262.3148 (0.020)
Ep: 295, Reward: 598.3080, Test: 773.5733 [157.96], Avg: 263.5084 (0.020)
Ep: 296, Reward: 746.0838, Test: 782.3005 [114.55], Avg: 264.8694 (0.020)
Ep: 297, Reward: 869.1962, Test: 696.6616 [227.68], Avg: 265.5544 (0.020)
Ep: 298, Reward: 702.0833, Test: 725.9322 [233.43], Avg: 266.3134 (0.020)
Ep: 299, Reward: 763.7496, Test: 724.6887 [209.61], Avg: 267.1426 (0.020)
Ep: 300, Reward: 781.9130, Test: 556.8240 [230.00], Avg: 267.3409 (0.020)
Ep: 301, Reward: 714.4377, Test: 588.5003 [307.52], Avg: 267.3861 (0.020)
Ep: 302, Reward: 641.1826, Test: 583.0277 [262.71], Avg: 267.5608 (0.020)
Ep: 303, Reward: 380.0237, Test: 475.7104 [274.43], Avg: 267.3427 (0.020)
Ep: 304, Reward: 638.6583, Test: 588.8983 [296.31], Avg: 267.4255 (0.020)
Ep: 305, Reward: 555.3570, Test: 601.5090 [243.99], Avg: 267.7199 (0.020)
Ep: 306, Reward: 605.2734, Test: 625.5216 [222.26], Avg: 268.1614 (0.020)
Ep: 307, Reward: 485.6716, Test: 515.0791 [265.46], Avg: 268.1012 (0.020)
Ep: 308, Reward: 631.4412, Test: 725.6530 [136.51], Avg: 269.1402 (0.020)
Ep: 309, Reward: 673.8949, Test: 652.4168 [219.87], Avg: 269.6673 (0.020)
Ep: 310, Reward: 718.6059, Test: 800.0940 [103.54], Avg: 271.0399 (0.020)
Ep: 311, Reward: 627.4150, Test: 655.9170 [247.48], Avg: 271.4803 (0.020)
Ep: 312, Reward: 719.5696, Test: 810.6106 [110.84], Avg: 272.8486 (0.020)
Ep: 313, Reward: 896.0259, Test: 813.5149 [136.59], Avg: 274.1354 (0.020)
Ep: 314, Reward: 888.4733, Test: 843.9569 [87.06], Avg: 275.6680 (0.020)
Ep: 315, Reward: 789.1947, Test: 707.5508 [141.70], Avg: 276.5863 (0.020)
Ep: 316, Reward: 788.1683, Test: 747.4984 [173.62], Avg: 277.5242 (0.020)
Ep: 317, Reward: 803.5701, Test: 754.7645 [173.13], Avg: 278.4805 (0.020)
Ep: 318, Reward: 714.3067, Test: 785.9125 [197.51], Avg: 279.4520 (0.020)
Ep: 319, Reward: 873.7712, Test: 690.4065 [224.27], Avg: 280.0354 (0.020)
Ep: 320, Reward: 855.7216, Test: 771.9030 [211.07], Avg: 280.9102 (0.020)
Ep: 321, Reward: 817.1364, Test: 810.1124 [191.26], Avg: 281.9597 (0.020)
Ep: 322, Reward: 952.4431, Test: 785.6644 [110.93], Avg: 283.1757 (0.020)
Ep: 323, Reward: 811.6986, Test: 867.2238 [76.57], Avg: 284.7420 (0.020)
Ep: 324, Reward: 851.2624, Test: 717.7004 [221.66], Avg: 285.3921 (0.020)
Ep: 325, Reward: 958.4044, Test: 785.9320 [180.93], Avg: 286.3725 (0.020)
Ep: 326, Reward: 934.1798, Test: 818.4829 [77.36], Avg: 287.7632 (0.020)
Ep: 327, Reward: 770.1495, Test: 691.7483 [241.09], Avg: 288.2598 (0.020)
Ep: 328, Reward: 871.3719, Test: 796.5099 [154.43], Avg: 289.3352 (0.020)
Ep: 329, Reward: 844.7249, Test: 774.2194 [151.82], Avg: 290.3445 (0.020)
Ep: 330, Reward: 807.8886, Test: 712.8683 [235.92], Avg: 290.9083 (0.020)
Ep: 331, Reward: 870.9080, Test: 825.9409 [83.57], Avg: 292.2681 (0.020)
Ep: 332, Reward: 781.2953, Test: 820.5005 [107.52], Avg: 293.5315 (0.020)
Ep: 333, Reward: 756.1509, Test: 632.8047 [242.65], Avg: 293.8208 (0.020)
Ep: 334, Reward: 811.1272, Test: 773.0084 [187.41], Avg: 294.6918 (0.020)
Ep: 335, Reward: 758.2217, Test: 663.1342 [212.14], Avg: 295.1570 (0.020)
Ep: 336, Reward: 793.1003, Test: 726.3290 [216.27], Avg: 295.7947 (0.020)
Ep: 337, Reward: 733.4958, Test: 684.3007 [221.77], Avg: 296.2880 (0.020)
Ep: 338, Reward: 803.3383, Test: 803.3051 [103.19], Avg: 297.4792 (0.020)
Ep: 339, Reward: 867.0370, Test: 796.7962 [184.87], Avg: 298.4041 (0.020)
Ep: 340, Reward: 917.9303, Test: 821.5720 [133.92], Avg: 299.5456 (0.020)
Ep: 341, Reward: 924.4345, Test: 808.5892 [189.72], Avg: 300.4793 (0.020)
Ep: 342, Reward: 961.4470, Test: 861.3029 [74.38], Avg: 301.8975 (0.020)
Ep: 343, Reward: 844.7369, Test: 878.8702 [66.53], Avg: 303.3813 (0.020)
Ep: 344, Reward: 935.8830, Test: 824.1967 [165.80], Avg: 304.4104 (0.020)
Ep: 345, Reward: 832.5825, Test: 795.6505 [98.87], Avg: 305.5444 (0.020)
Ep: 346, Reward: 708.2683, Test: 711.3225 [222.45], Avg: 306.0727 (0.020)
Ep: 347, Reward: 678.2823, Test: 789.2711 [128.68], Avg: 307.0914 (0.020)
Ep: 348, Reward: 702.8976, Test: 678.9499 [253.53], Avg: 307.4305 (0.020)
Ep: 349, Reward: 744.1210, Test: 811.7087 [186.13], Avg: 308.3395 (0.020)
Ep: 350, Reward: 776.5177, Test: 848.8337 [69.89], Avg: 309.6802 (0.020)
Ep: 351, Reward: 810.0498, Test: 785.9251 [123.18], Avg: 310.6833 (0.020)
Ep: 352, Reward: 786.3043, Test: 792.8021 [147.23], Avg: 311.6319 (0.020)
Ep: 353, Reward: 756.4756, Test: 795.9771 [100.55], Avg: 312.7161 (0.020)
Ep: 354, Reward: 865.8220, Test: 785.6933 [84.35], Avg: 313.8108 (0.020)
Ep: 355, Reward: 883.8772, Test: 797.1688 [138.70], Avg: 314.7790 (0.020)
Ep: 356, Reward: 897.3639, Test: 700.3439 [193.13], Avg: 315.3180 (0.020)
Ep: 357, Reward: 860.2452, Test: 708.2905 [198.33], Avg: 315.8617 (0.020)
Ep: 358, Reward: 811.9361, Test: 787.4623 [164.40], Avg: 316.7174 (0.020)
Ep: 359, Reward: 829.8769, Test: 801.6222 [183.98], Avg: 317.5533 (0.020)
Ep: 360, Reward: 981.1580, Test: 607.1563 [299.83], Avg: 317.5250 (0.020)
Ep: 361, Reward: 958.5618, Test: 746.2492 [200.26], Avg: 318.1561 (0.020)
Ep: 362, Reward: 939.4062, Test: 824.6028 [77.48], Avg: 319.3379 (0.020)
Ep: 363, Reward: 866.2258, Test: 785.1911 [194.74], Avg: 320.0827 (0.020)
Ep: 364, Reward: 839.5358, Test: 668.0545 [319.00], Avg: 320.1620 (0.020)
Ep: 365, Reward: 801.1245, Test: 729.3949 [228.80], Avg: 320.6550 (0.020)
Ep: 366, Reward: 825.4913, Test: 613.3658 [258.04], Avg: 320.7495 (0.020)
Ep: 367, Reward: 694.5050, Test: 698.0594 [245.66], Avg: 321.1072 (0.020)
Ep: 368, Reward: 779.5870, Test: 790.7908 [134.30], Avg: 322.0161 (0.020)
Ep: 369, Reward: 814.1117, Test: 673.9365 [248.61], Avg: 322.2953 (0.020)
Ep: 370, Reward: 825.2289, Test: 761.3602 [185.97], Avg: 322.9775 (0.020)
Ep: 371, Reward: 858.3401, Test: 556.6995 [284.97], Avg: 322.8398 (0.020)
Ep: 372, Reward: 856.3418, Test: 572.5567 [279.84], Avg: 322.7590 (0.020)
Ep: 373, Reward: 844.3447, Test: 782.0340 [200.62], Avg: 323.4506 (0.020)
Ep: 374, Reward: 741.4766, Test: 854.5180 [82.68], Avg: 324.6463 (0.020)
Ep: 375, Reward: 717.6903, Test: 761.1180 [153.48], Avg: 325.3990 (0.020)
Ep: 376, Reward: 810.2628, Test: 825.1206 [125.79], Avg: 326.3908 (0.020)
Ep: 377, Reward: 970.4739, Test: 879.5936 [32.99], Avg: 327.7671 (0.020)
Ep: 378, Reward: 869.9034, Test: 844.4217 [79.24], Avg: 328.9212 (0.020)
Ep: 379, Reward: 958.3136, Test: 777.4150 [198.11], Avg: 329.5801 (0.020)
Ep: 380, Reward: 861.0420, Test: 780.2721 [155.24], Avg: 330.3556 (0.020)
Ep: 381, Reward: 890.4061, Test: 827.9710 [169.57], Avg: 331.2144 (0.020)
Ep: 382, Reward: 879.5347, Test: 848.8660 [77.45], Avg: 332.3637 (0.020)
Ep: 383, Reward: 839.5949, Test: 791.3741 [148.59], Avg: 333.1721 (0.020)
Ep: 384, Reward: 911.8526, Test: 825.0123 [87.86], Avg: 334.2214 (0.020)
Ep: 385, Reward: 850.3707, Test: 771.6734 [187.61], Avg: 334.8686 (0.020)
Ep: 386, Reward: 863.5647, Test: 777.5584 [187.06], Avg: 335.5292 (0.020)
Ep: 387, Reward: 754.0671, Test: 601.8445 [224.12], Avg: 335.6379 (0.020)
Ep: 388, Reward: 587.0771, Test: 548.8582 [265.54], Avg: 335.5034 (0.020)
Ep: 389, Reward: 782.5421, Test: 634.8652 [228.11], Avg: 335.6861 (0.020)
Ep: 390, Reward: 704.9002, Test: 609.5518 [253.11], Avg: 335.7392 (0.020)
Ep: 391, Reward: 724.1727, Test: 667.8206 [273.14], Avg: 335.8895 (0.020)
Ep: 392, Reward: 672.1679, Test: 844.1387 [145.67], Avg: 336.8121 (0.020)
Ep: 393, Reward: 670.9499, Test: 767.2910 [176.60], Avg: 337.4565 (0.020)
Ep: 394, Reward: 683.2291, Test: 841.3694 [172.16], Avg: 338.2964 (0.020)
Ep: 395, Reward: 951.8003, Test: 813.8798 [122.97], Avg: 339.1868 (0.020)
Ep: 396, Reward: 946.5701, Test: 782.3408 [106.24], Avg: 340.0355 (0.020)
Ep: 397, Reward: 1005.4355, Test: 864.3237 [45.21], Avg: 341.2392 (0.020)
Ep: 398, Reward: 930.0067, Test: 775.4586 [243.57], Avg: 341.7170 (0.020)
Ep: 399, Reward: 905.1282, Test: 874.0478 [43.80], Avg: 342.9383 (0.020)
Ep: 400, Reward: 1013.5755, Test: 888.9844 [51.63], Avg: 344.1713 (0.020)
Ep: 401, Reward: 947.6194, Test: 880.7789 [31.50], Avg: 345.4278 (0.020)
Ep: 402, Reward: 855.9681, Test: 765.8922 [217.46], Avg: 345.9315 (0.020)
Ep: 403, Reward: 861.2845, Test: 777.5181 [173.72], Avg: 346.5698 (0.020)
Ep: 404, Reward: 847.5199, Test: 839.1517 [97.05], Avg: 347.5464 (0.020)
Ep: 405, Reward: 764.1578, Test: 819.0284 [119.25], Avg: 348.4140 (0.020)
Ep: 406, Reward: 547.4550, Test: 791.5933 [193.14], Avg: 349.0283 (0.020)
Ep: 407, Reward: 892.7150, Test: 764.8119 [208.69], Avg: 349.5359 (0.020)
Ep: 408, Reward: 958.0278, Test: 879.4178 [52.04], Avg: 350.7042 (0.020)
Ep: 409, Reward: 926.2939, Test: 839.4114 [170.34], Avg: 351.4807 (0.020)
Ep: 410, Reward: 931.2299, Test: 790.9383 [136.75], Avg: 352.2172 (0.020)
Ep: 411, Reward: 848.0619, Test: 907.8948 [33.52], Avg: 353.4846 (0.020)
Ep: 412, Reward: 930.2826, Test: 734.7218 [170.15], Avg: 353.9957 (0.020)
Ep: 413, Reward: 987.3726, Test: 749.2423 [225.56], Avg: 354.4056 (0.020)
Ep: 414, Reward: 630.3816, Test: 560.1246 [251.43], Avg: 354.2954 (0.020)
Ep: 415, Reward: 659.8233, Test: 792.6501 [137.06], Avg: 355.0197 (0.020)
Ep: 416, Reward: 825.7511, Test: 766.5067 [191.38], Avg: 355.5475 (0.020)
Ep: 417, Reward: 707.9519, Test: 684.3588 [221.31], Avg: 355.8047 (0.020)
Ep: 418, Reward: 816.8114, Test: 801.5536 [186.15], Avg: 356.4243 (0.020)
Ep: 419, Reward: 723.8111, Test: 746.5070 [172.62], Avg: 356.9421 (0.020)
Ep: 420, Reward: 757.8737, Test: 832.7110 [62.43], Avg: 357.9239 (0.020)
Ep: 421, Reward: 676.5496, Test: 671.6221 [298.84], Avg: 357.9591 (0.020)
Ep: 422, Reward: 785.1259, Test: 567.9760 [232.55], Avg: 357.9058 (0.020)
Ep: 423, Reward: 868.7668, Test: 780.9685 [120.01], Avg: 358.6206 (0.020)
Ep: 424, Reward: 760.4208, Test: 828.7529 [94.06], Avg: 359.5054 (0.020)
Ep: 425, Reward: 973.6101, Test: 779.6774 [245.82], Avg: 359.9147 (0.020)
Ep: 426, Reward: 827.7889, Test: 875.1465 [81.84], Avg: 360.9297 (0.020)
Ep: 427, Reward: 955.1645, Test: 847.0067 [85.13], Avg: 361.8665 (0.020)
Ep: 428, Reward: 788.7397, Test: 866.5762 [83.79], Avg: 362.8476 (0.020)
Ep: 429, Reward: 839.4746, Test: 767.2562 [239.58], Avg: 363.2310 (0.020)
Ep: 430, Reward: 693.2002, Test: 664.5183 [377.12], Avg: 363.0550 (0.020)
Ep: 431, Reward: 851.0075, Test: 721.6535 [225.39], Avg: 363.3634 (0.020)
Ep: 432, Reward: 766.6748, Test: 781.4941 [101.72], Avg: 364.0941 (0.020)
Ep: 433, Reward: 709.2667, Test: 796.2425 [152.26], Avg: 364.7390 (0.020)
Ep: 434, Reward: 812.1435, Test: 783.6677 [212.85], Avg: 365.2128 (0.020)
Ep: 435, Reward: 843.2444, Test: 790.1226 [128.06], Avg: 365.8936 (0.020)
Ep: 436, Reward: 857.1153, Test: 767.1115 [138.87], Avg: 366.4939 (0.020)
Ep: 437, Reward: 891.3651, Test: 646.7135 [230.91], Avg: 366.6065 (0.020)
Ep: 438, Reward: 791.9682, Test: 775.4444 [156.94], Avg: 367.1803 (0.020)
Ep: 439, Reward: 880.5448, Test: 754.6086 [226.96], Avg: 367.5450 (0.020)
Ep: 440, Reward: 869.7737, Test: 830.9918 [142.16], Avg: 368.2736 (0.020)
Ep: 441, Reward: 901.1088, Test: 833.6893 [133.86], Avg: 369.0237 (0.020)
Ep: 442, Reward: 939.6878, Test: 731.4531 [228.71], Avg: 369.3255 (0.020)
Ep: 443, Reward: 687.3458, Test: 860.1054 [93.62], Avg: 370.2200 (0.020)
Ep: 444, Reward: 839.4183, Test: 800.7160 [116.20], Avg: 370.9263 (0.020)
Ep: 445, Reward: 711.9054, Test: 770.2552 [161.70], Avg: 371.4591 (0.020)
Ep: 446, Reward: 905.3511, Test: 905.7619 [20.14], Avg: 372.6094 (0.020)
Ep: 447, Reward: 935.5144, Test: 890.2749 [17.09], Avg: 373.7267 (0.020)
Ep: 448, Reward: 1013.5749, Test: 765.1301 [206.04], Avg: 374.1396 (0.020)
Ep: 449, Reward: 858.2065, Test: 838.1174 [132.10], Avg: 374.8771 (0.020)
Ep: 450, Reward: 928.4775, Test: 798.4655 [120.16], Avg: 375.5499 (0.020)
Ep: 451, Reward: 1024.8153, Test: 876.4601 [110.42], Avg: 376.4138 (0.020)
Ep: 452, Reward: 982.7838, Test: 821.0191 [186.61], Avg: 376.9833 (0.020)
Ep: 453, Reward: 958.6705, Test: 850.2596 [142.08], Avg: 377.7128 (0.020)
Ep: 454, Reward: 935.9902, Test: 877.1967 [76.20], Avg: 378.6431 (0.020)
Ep: 455, Reward: 980.8688, Test: 772.9980 [162.14], Avg: 379.1524 (0.020)
Ep: 456, Reward: 936.9908, Test: 874.4008 [31.55], Avg: 380.1670 (0.020)
Ep: 457, Reward: 918.5205, Test: 846.9298 [169.10], Avg: 380.8169 (0.020)
Ep: 458, Reward: 991.9341, Test: 899.7401 [33.09], Avg: 381.8754 (0.020)
Ep: 459, Reward: 1117.5673, Test: 851.2168 [100.01], Avg: 382.6783 (0.020)
Ep: 460, Reward: 1005.0279, Test: 830.2373 [176.11], Avg: 383.2671 (0.020)
Ep: 461, Reward: 972.0652, Test: 908.0148 [21.04], Avg: 384.3574 (0.020)
Ep: 462, Reward: 923.8750, Test: 797.7510 [88.72], Avg: 385.0586 (0.020)
Ep: 463, Reward: 835.1460, Test: 835.7207 [124.42], Avg: 385.7617 (0.020)
Ep: 464, Reward: 991.2420, Test: 733.5725 [227.28], Avg: 386.0209 (0.020)
Ep: 465, Reward: 735.0444, Test: 786.5360 [97.94], Avg: 386.6702 (0.020)
Ep: 466, Reward: 805.3385, Test: 848.3239 [90.91], Avg: 387.4641 (0.020)
Ep: 467, Reward: 854.5508, Test: 753.0959 [223.16], Avg: 387.7685 (0.020)
Ep: 468, Reward: 913.9504, Test: 709.2483 [252.10], Avg: 387.9165 (0.020)
Ep: 469, Reward: 632.1092, Test: 670.3284 [261.02], Avg: 387.9620 (0.020)
Ep: 470, Reward: 762.6207, Test: 728.0265 [170.92], Avg: 388.3211 (0.020)
Ep: 471, Reward: 718.6371, Test: 611.9784 [233.59], Avg: 388.3000 (0.020)
Ep: 472, Reward: 760.6428, Test: 760.2124 [224.76], Avg: 388.6111 (0.020)
Ep: 473, Reward: 675.2568, Test: 745.5863 [203.83], Avg: 388.9342 (0.020)
Ep: 474, Reward: 688.1444, Test: 684.4772 [198.53], Avg: 389.1385 (0.020)
Ep: 475, Reward: 660.8201, Test: 808.3825 [193.98], Avg: 389.6117 (0.020)
Ep: 476, Reward: 785.9659, Test: 789.9722 [138.54], Avg: 390.1606 (0.020)
Ep: 477, Reward: 726.3693, Test: 590.1369 [257.11], Avg: 390.0411 (0.020)
Ep: 478, Reward: 745.8432, Test: 754.7155 [216.38], Avg: 390.3507 (0.020)
Ep: 479, Reward: 796.4983, Test: 689.1622 [261.84], Avg: 390.4277 (0.020)
Ep: 480, Reward: 732.5903, Test: 687.0646 [242.24], Avg: 390.5408 (0.020)
Ep: 481, Reward: 814.6143, Test: 774.6228 [171.54], Avg: 390.9817 (0.020)
Ep: 482, Reward: 750.0523, Test: 750.1606 [167.38], Avg: 391.3788 (0.020)
Ep: 483, Reward: 674.7588, Test: 626.0670 [281.30], Avg: 391.2825 (0.020)
Ep: 484, Reward: 622.5367, Test: 458.9488 [232.08], Avg: 390.9435 (0.020)
Ep: 485, Reward: 659.7535, Test: 450.3635 [247.39], Avg: 390.5568 (0.020)
Ep: 486, Reward: 631.2747, Test: 789.6803 [102.70], Avg: 391.1654 (0.020)
Ep: 487, Reward: 770.5491, Test: 627.3329 [237.32], Avg: 391.1631 (0.020)
Ep: 488, Reward: 791.9169, Test: 737.3694 [173.44], Avg: 391.5164 (0.020)
Ep: 489, Reward: 727.0785, Test: 581.6199 [260.37], Avg: 391.3730 (0.020)
Ep: 490, Reward: 603.0072, Test: 525.9843 [307.42], Avg: 391.0210 (0.020)
Ep: 491, Reward: 653.4702, Test: 432.8108 [263.11], Avg: 390.5712 (0.020)
Ep: 492, Reward: 389.5189, Test: 602.9150 [204.77], Avg: 390.5866 (0.020)
Ep: 493, Reward: 486.8595, Test: 627.4865 [189.03], Avg: 390.6835 (0.020)
Ep: 494, Reward: 591.7379, Test: 450.2537 [211.85], Avg: 390.3758 (0.020)
Ep: 495, Reward: 581.1940, Test: 601.2429 [229.06], Avg: 390.3391 (0.020)
Ep: 496, Reward: 622.1127, Test: 733.9693 [148.88], Avg: 390.7310 (0.020)
Ep: 497, Reward: 639.5787, Test: 741.7489 [110.21], Avg: 391.2145 (0.020)
Ep: 498, Reward: 643.1946, Test: 632.4968 [262.11], Avg: 391.1728 (0.020)
Ep: 499, Reward: 548.3045, Test: 572.3041 [232.98], Avg: 391.0691 (0.020)
