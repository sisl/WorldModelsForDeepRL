Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, NUM_STEPS

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 16        	# How many experience tuples to sample from the buffer for each train step

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(list(zip(states, actions, targets, advantages)), shuffle=True)	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -53.7726, Test: -53.6279 [25.20], Avg: -78.8296 (0.980)
Ep: 1, Reward: -53.9603, Test: -63.9808 [18.58], Avg: -80.6967 (0.960)
Ep: 2, Reward: -56.1552, Test: -52.4780 [14.39], Avg: -76.0856 (0.941)
Ep: 3, Reward: -58.8071, Test: -58.9894 [20.41], Avg: -76.9151 (0.922)
Ep: 4, Reward: -65.2942, Test: -54.5172 [17.30], Avg: -75.8953 (0.904)
Ep: 5, Reward: -53.1268, Test: -63.3229 [17.47], Avg: -76.7108 (0.886)
Ep: 6, Reward: -44.1714, Test: -61.1295 [21.19], Avg: -77.5127 (0.868)
Ep: 7, Reward: -57.0665, Test: -41.3225 [23.27], Avg: -75.8983 (0.851)
Ep: 8, Reward: -44.0603, Test: -48.4014 [20.30], Avg: -75.0988 (0.834)
Ep: 9, Reward: -60.8797, Test: -69.4690 [22.08], Avg: -76.7436 (0.817)
Ep: 10, Reward: -50.3126, Test: -76.8367 [29.59], Avg: -79.4424 (0.801)
Ep: 11, Reward: -62.8495, Test: -48.6476 [26.36], Avg: -79.0724 (0.785)
Ep: 12, Reward: -58.1774, Test: -44.1752 [22.66], Avg: -78.1309 (0.769)
Ep: 13, Reward: -60.8466, Test: -31.7710 [53.05], Avg: -78.6085 (0.754)
Ep: 14, Reward: -44.0269, Test: -56.5235 [18.39], Avg: -78.3625 (0.739)
Ep: 15, Reward: -33.2479, Test: -66.0854 [35.30], Avg: -79.8016 (0.724)
Ep: 16, Reward: -34.4936, Test: -54.0571 [34.42], Avg: -80.3117 (0.709)
Ep: 17, Reward: -48.3124, Test: -54.8116 [42.27], Avg: -81.2436 (0.695)
Ep: 18, Reward: -48.3063, Test: -56.1024 [21.40], Avg: -81.0467 (0.681)
Ep: 19, Reward: -55.5239, Test: -63.8327 [36.40], Avg: -82.0061 (0.668)
Ep: 20, Reward: -34.3291, Test: -52.7620 [19.98], Avg: -81.5650 (0.654)
Ep: 21, Reward: -43.1287, Test: -36.1565 [37.29], Avg: -81.1959 (0.641)
Ep: 22, Reward: -47.8291, Test: -19.0377 [66.92], Avg: -81.4032 (0.628)
Ep: 23, Reward: -38.1695, Test: -17.4388 [38.44], Avg: -80.3397 (0.616)
Ep: 24, Reward: -48.1498, Test: -48.4073 [61.45], Avg: -81.5205 (0.603)
Ep: 25, Reward: -32.0378, Test: -34.9247 [68.26], Avg: -82.3537 (0.591)
Ep: 26, Reward: -11.8247, Test: -30.6673 [42.24], Avg: -82.0038 (0.580)
Ep: 27, Reward: -31.9273, Test: -6.4008 [39.90], Avg: -80.7287 (0.568)
Ep: 28, Reward: -31.7900, Test: -11.3103 [56.53], Avg: -80.2844 (0.557)
Ep: 29, Reward: -15.1908, Test: -19.3567 [46.09], Avg: -79.7899 (0.545)
Ep: 30, Reward: -14.1247, Test: -3.7804 [65.82], Avg: -79.4612 (0.535)
Ep: 31, Reward: -25.8085, Test: -16.9880 [42.43], Avg: -78.8348 (0.524)
Ep: 32, Reward: 22.5288, Test: -7.7112 [50.43], Avg: -78.2077 (0.513)
Ep: 33, Reward: 8.6111, Test: 34.1835 [55.42], Avg: -76.5322 (0.503)
Ep: 34, Reward: 17.3543, Test: 64.5238 [70.95], Avg: -74.5293 (0.493)
Ep: 35, Reward: 5.7160, Test: 28.7482 [67.14], Avg: -73.5255 (0.483)
Ep: 36, Reward: 27.7062, Test: 16.5164 [70.59], Avg: -72.9997 (0.474)
Ep: 37, Reward: 44.3774, Test: -8.1204 [51.31], Avg: -72.6426 (0.464)
Ep: 38, Reward: 33.9082, Test: 17.5180 [78.76], Avg: -72.3502 (0.455)
Ep: 39, Reward: 66.3898, Test: 17.7880 [59.33], Avg: -71.5800 (0.446)
Ep: 40, Reward: 67.0942, Test: 62.1714 [108.57], Avg: -70.9658 (0.437)
Ep: 41, Reward: 32.9516, Test: 60.2596 [84.16], Avg: -69.8453 (0.428)
Ep: 42, Reward: 32.5445, Test: 16.4647 [32.43], Avg: -68.5923 (0.419)
Ep: 43, Reward: 17.0194, Test: -2.5584 [62.38], Avg: -68.5092 (0.411)
Ep: 44, Reward: 32.2329, Test: 83.2592 [101.38], Avg: -67.3894 (0.403)
Ep: 45, Reward: 45.3771, Test: 63.9112 [103.93], Avg: -66.7944 (0.395)
Ep: 46, Reward: 82.0760, Test: 54.4671 [97.07], Avg: -66.2797 (0.387)
Ep: 47, Reward: 56.6044, Test: 76.8161 [117.81], Avg: -65.7530 (0.379)
Ep: 48, Reward: 47.4085, Test: 36.5188 [97.89], Avg: -65.6635 (0.372)
Ep: 49, Reward: 50.8149, Test: 123.7114 [150.67], Avg: -64.8893 (0.364)
Ep: 50, Reward: 115.8229, Test: 150.4705 [120.57], Avg: -63.0307 (0.357)
Ep: 51, Reward: 60.6942, Test: 143.5748 [127.41], Avg: -61.5076 (0.350)
Ep: 52, Reward: 68.4141, Test: 121.0943 [112.17], Avg: -60.1786 (0.343)
Ep: 53, Reward: 110.1543, Test: 136.1114 [121.65], Avg: -58.7965 (0.336)
Ep: 54, Reward: 106.0336, Test: 169.3393 [206.73], Avg: -58.4072 (0.329)
Ep: 55, Reward: 120.6010, Test: 164.6325 [149.70], Avg: -57.0975 (0.323)
Ep: 56, Reward: 82.1344, Test: 181.1943 [123.69], Avg: -55.0869 (0.316)
Ep: 57, Reward: 271.2639, Test: 83.9862 [120.30], Avg: -54.7632 (0.310)
Ep: 58, Reward: 130.3920, Test: 242.9999 [114.31], Avg: -51.6539 (0.304)
Ep: 59, Reward: 169.9839, Test: 134.6803 [193.60], Avg: -51.7750 (0.298)
Ep: 60, Reward: 147.3974, Test: 235.8986 [98.16], Avg: -48.6682 (0.292)
Ep: 61, Reward: 239.1773, Test: 153.7685 [145.24], Avg: -47.7457 (0.286)
Ep: 62, Reward: 217.4758, Test: 209.1967 [148.94], Avg: -46.0314 (0.280)
Ep: 63, Reward: 279.8075, Test: 242.8990 [189.29], Avg: -44.4745 (0.274)
Ep: 64, Reward: 269.6308, Test: 303.6619 [103.43], Avg: -40.7097 (0.269)
Ep: 65, Reward: 251.4102, Test: 313.1264 [141.02], Avg: -37.4853 (0.264)
Ep: 66, Reward: 315.5200, Test: 298.0023 [125.38], Avg: -34.3494 (0.258)
Ep: 67, Reward: 316.2717, Test: 249.5815 [147.79], Avg: -32.3473 (0.253)
Ep: 68, Reward: 333.0637, Test: 322.4651 [144.99], Avg: -29.3065 (0.248)
Ep: 69, Reward: 337.8289, Test: 297.3570 [149.97], Avg: -26.7823 (0.243)
Ep: 70, Reward: 328.9642, Test: 351.1260 [245.70], Avg: -24.9202 (0.238)
Ep: 71, Reward: 292.9193, Test: 451.2205 [196.39], Avg: -21.0347 (0.233)
Ep: 72, Reward: 327.7080, Test: 324.3893 [161.98], Avg: -18.5218 (0.229)
Ep: 73, Reward: 347.1104, Test: 461.9054 [267.90], Avg: -15.6497 (0.224)
Ep: 74, Reward: 422.6394, Test: 407.1959 [194.57], Avg: -12.6061 (0.220)
Ep: 75, Reward: 392.5710, Test: 379.3657 [196.51], Avg: -10.0342 (0.215)
Ep: 76, Reward: 277.8281, Test: 412.0568 [166.36], Avg: -6.7131 (0.211)
Ep: 77, Reward: 320.3908, Test: 565.1671 [188.53], Avg: -1.7983 (0.207)
Ep: 78, Reward: 381.0387, Test: 486.8690 [204.33], Avg: 1.8009 (0.203)
Ep: 79, Reward: 494.3041, Test: 432.3959 [248.71], Avg: 4.0744 (0.199)
Ep: 80, Reward: 486.8522, Test: 506.7560 [123.05], Avg: 8.7612 (0.195)
Ep: 81, Reward: 516.3839, Test: 475.5263 [246.87], Avg: 11.4429 (0.191)
Ep: 82, Reward: 601.6733, Test: 578.3945 [199.63], Avg: 15.8685 (0.187)
Ep: 83, Reward: 611.9674, Test: 726.2730 [138.75], Avg: 22.6739 (0.183)
Ep: 84, Reward: 515.6247, Test: 603.7388 [165.86], Avg: 27.5586 (0.180)
Ep: 85, Reward: 508.5465, Test: 682.3276 [136.59], Avg: 33.5839 (0.176)
Ep: 86, Reward: 547.0147, Test: 587.0584 [149.76], Avg: 38.2243 (0.172)
Ep: 87, Reward: 615.3121, Test: 556.9905 [233.61], Avg: 41.4647 (0.169)
Ep: 88, Reward: 587.1068, Test: 647.0850 [201.62], Avg: 46.0041 (0.166)
Ep: 89, Reward: 658.4465, Test: 720.8924 [113.22], Avg: 52.2448 (0.162)
Ep: 90, Reward: 489.2062, Test: 611.3295 [215.61], Avg: 56.0192 (0.159)
Ep: 91, Reward: 603.4435, Test: 647.0220 [151.80], Avg: 60.7931 (0.156)
Ep: 92, Reward: 654.3976, Test: 728.3936 [110.43], Avg: 66.7842 (0.153)
Ep: 93, Reward: 631.6642, Test: 705.6226 [132.16], Avg: 72.1744 (0.150)
Ep: 94, Reward: 479.6200, Test: 660.6187 [175.89], Avg: 76.5171 (0.147)
Ep: 95, Reward: 599.8889, Test: 570.0800 [307.99], Avg: 78.4501 (0.144)
Ep: 96, Reward: 633.7490, Test: 616.0302 [150.47], Avg: 82.4409 (0.141)
Ep: 97, Reward: 545.0295, Test: 497.1365 [224.93], Avg: 84.3773 (0.138)
Ep: 98, Reward: 616.5048, Test: 661.8179 [160.57], Avg: 88.5881 (0.135)
Ep: 99, Reward: 674.3523, Test: 564.9402 [120.26], Avg: 92.1490 (0.133)
Ep: 100, Reward: 578.6898, Test: 621.8067 [184.80], Avg: 95.5634 (0.130)
Ep: 101, Reward: 598.5319, Test: 567.7807 [210.40], Avg: 98.1303 (0.127)
Ep: 102, Reward: 633.9309, Test: 540.8517 [130.47], Avg: 101.1619 (0.125)
Ep: 103, Reward: 516.6269, Test: 613.8238 [159.45], Avg: 104.5581 (0.122)
Ep: 104, Reward: 599.3230, Test: 664.1783 [145.05], Avg: 108.5064 (0.120)
Ep: 105, Reward: 604.2587, Test: 454.0571 [134.39], Avg: 110.4984 (0.117)
Ep: 106, Reward: 596.8669, Test: 702.4498 [140.07], Avg: 114.7216 (0.115)
Ep: 107, Reward: 628.0536, Test: 653.6617 [215.91], Avg: 117.7126 (0.113)
Ep: 108, Reward: 741.1692, Test: 591.9754 [204.61], Avg: 120.1864 (0.111)
Ep: 109, Reward: 558.3261, Test: 630.5253 [202.60], Avg: 122.9841 (0.108)
Ep: 110, Reward: 571.5641, Test: 644.1645 [171.35], Avg: 126.1357 (0.106)
Ep: 111, Reward: 646.4079, Test: 531.3981 [228.96], Avg: 127.7098 (0.104)
Ep: 112, Reward: 545.8657, Test: 699.3380 [151.27], Avg: 131.4298 (0.102)
Ep: 113, Reward: 731.2315, Test: 676.8153 [124.35], Avg: 135.1232 (0.100)
Ep: 114, Reward: 740.0066, Test: 637.8375 [188.79], Avg: 137.8530 (0.098)
Ep: 115, Reward: 672.8322, Test: 567.8117 [205.90], Avg: 139.7845 (0.096)
Ep: 116, Reward: 625.5022, Test: 707.0843 [148.78], Avg: 143.3616 (0.094)
Ep: 117, Reward: 756.6237, Test: 798.8405 [108.79], Avg: 147.9945 (0.092)
Ep: 118, Reward: 593.3066, Test: 573.6012 [166.86], Avg: 150.1688 (0.090)
Ep: 119, Reward: 661.2359, Test: 582.6407 [182.60], Avg: 152.2511 (0.089)
Ep: 120, Reward: 676.5097, Test: 584.4442 [145.91], Avg: 154.6172 (0.087)
Ep: 121, Reward: 640.0573, Test: 653.0916 [199.92], Avg: 157.0643 (0.085)
Ep: 122, Reward: 678.8762, Test: 707.3848 [172.26], Avg: 160.1379 (0.083)
Ep: 123, Reward: 739.7928, Test: 832.0945 [80.08], Avg: 164.9111 (0.082)
Ep: 124, Reward: 825.0925, Test: 832.7028 [36.73], Avg: 169.9596 (0.080)
Ep: 125, Reward: 843.2383, Test: 849.0084 [29.96], Avg: 175.1111 (0.078)
Ep: 126, Reward: 863.2851, Test: 863.2426 [20.17], Avg: 180.3707 (0.077)
Ep: 127, Reward: 839.2774, Test: 873.0766 [26.65], Avg: 185.5743 (0.075)
Ep: 128, Reward: 749.1452, Test: 845.1547 [44.18], Avg: 190.3448 (0.074)
Ep: 129, Reward: 780.9539, Test: 678.6663 [163.40], Avg: 192.8441 (0.072)
Ep: 130, Reward: 723.0216, Test: 736.0829 [108.33], Avg: 196.1641 (0.071)
Ep: 131, Reward: 769.6461, Test: 809.5008 [65.56], Avg: 200.3139 (0.069)
Ep: 132, Reward: 799.1998, Test: 720.7707 [128.31], Avg: 203.2624 (0.068)
Ep: 133, Reward: 725.0713, Test: 835.9221 [41.59], Avg: 207.6734 (0.067)
Ep: 134, Reward: 790.7807, Test: 663.7935 [176.81], Avg: 209.7423 (0.065)
Ep: 135, Reward: 799.8474, Test: 796.0832 [95.22], Avg: 213.3535 (0.064)
Ep: 136, Reward: 783.7740, Test: 794.2542 [121.14], Avg: 216.7095 (0.063)
Ep: 137, Reward: 845.3415, Test: 747.6384 [141.02], Avg: 219.5349 (0.062)
Ep: 138, Reward: 845.0333, Test: 830.3084 [102.71], Avg: 223.1900 (0.060)
Ep: 139, Reward: 834.2925, Test: 794.1345 [170.20], Avg: 226.0524 (0.059)
Ep: 140, Reward: 796.2423, Test: 772.3481 [122.47], Avg: 229.0583 (0.058)
Ep: 141, Reward: 716.7271, Test: 802.9047 [98.84], Avg: 232.4034 (0.057)
Ep: 142, Reward: 737.9962, Test: 816.3419 [159.09], Avg: 235.3743 (0.056)
Ep: 143, Reward: 762.3116, Test: 825.9681 [82.53], Avg: 238.9026 (0.055)
Ep: 144, Reward: 793.7414, Test: 829.9164 [55.87], Avg: 242.5932 (0.053)
Ep: 145, Reward: 742.5020, Test: 843.1516 [66.62], Avg: 246.2503 (0.052)
Ep: 146, Reward: 781.4879, Test: 713.1898 [219.88], Avg: 247.9309 (0.051)
Ep: 147, Reward: 825.9911, Test: 849.2723 [61.80], Avg: 251.5765 (0.050)
Ep: 148, Reward: 764.3269, Test: 755.3137 [110.40], Avg: 254.2163 (0.049)
Ep: 149, Reward: 742.5622, Test: 817.8063 [45.03], Avg: 257.6734 (0.048)
Ep: 150, Reward: 823.6532, Test: 871.8757 [26.66], Avg: 261.5644 (0.047)
Ep: 151, Reward: 808.8446, Test: 748.3219 [172.36], Avg: 263.6328 (0.046)
Ep: 152, Reward: 857.3354, Test: 845.9147 [37.22], Avg: 267.1953 (0.045)
Ep: 153, Reward: 818.7453, Test: 813.7837 [88.00], Avg: 270.1731 (0.045)
Ep: 154, Reward: 732.4525, Test: 753.6855 [208.88], Avg: 271.9449 (0.044)
Ep: 155, Reward: 791.9775, Test: 788.5127 [203.07], Avg: 273.9545 (0.043)
Ep: 156, Reward: 815.3555, Test: 794.2381 [57.98], Avg: 276.8991 (0.042)
Ep: 157, Reward: 721.3844, Test: 798.5734 [131.82], Avg: 279.3666 (0.041)
Ep: 158, Reward: 856.0782, Test: 843.0785 [54.35], Avg: 282.5701 (0.040)
Ep: 159, Reward: 804.6713, Test: 746.8798 [120.50], Avg: 284.7189 (0.039)
Ep: 160, Reward: 718.7967, Test: 856.6031 [40.40], Avg: 288.0201 (0.039)
Ep: 161, Reward: 869.3791, Test: 790.2763 [142.83], Avg: 290.2387 (0.038)
Ep: 162, Reward: 944.2386, Test: 792.9293 [156.68], Avg: 292.3615 (0.037)
Ep: 163, Reward: 910.9029, Test: 827.1303 [72.82], Avg: 295.1783 (0.036)
Ep: 164, Reward: 784.0628, Test: 811.9875 [125.60], Avg: 297.5492 (0.036)
Ep: 165, Reward: 797.6397, Test: 771.5437 [103.32], Avg: 299.7822 (0.035)
Ep: 166, Reward: 855.9302, Test: 849.8789 [73.33], Avg: 302.6371 (0.034)
Ep: 167, Reward: 751.8042, Test: 754.6443 [161.45], Avg: 304.3666 (0.034)
Ep: 168, Reward: 717.6964, Test: 812.4220 [113.53], Avg: 306.7011 (0.033)
Ep: 169, Reward: 849.0442, Test: 819.9223 [35.12], Avg: 309.5134 (0.032)
Ep: 170, Reward: 754.2536, Test: 808.6635 [44.95], Avg: 312.1696 (0.032)
Ep: 171, Reward: 813.4508, Test: 808.3784 [54.72], Avg: 314.7364 (0.031)
Ep: 172, Reward: 850.7356, Test: 846.2203 [50.55], Avg: 317.5163 (0.030)
Ep: 173, Reward: 831.7003, Test: 737.4757 [214.22], Avg: 318.6987 (0.030)
Ep: 174, Reward: 853.8192, Test: 887.9874 [40.74], Avg: 321.7190 (0.029)
Ep: 175, Reward: 795.3780, Test: 861.9065 [72.59], Avg: 324.3758 (0.029)
Ep: 176, Reward: 872.6079, Test: 891.5710 [46.42], Avg: 327.3180 (0.028)
Ep: 177, Reward: 860.4691, Test: 882.9748 [27.39], Avg: 330.2858 (0.027)
Ep: 178, Reward: 786.6499, Test: 789.2837 [200.70], Avg: 331.7288 (0.027)
Ep: 179, Reward: 986.1717, Test: 890.9765 [22.91], Avg: 334.7085 (0.026)
Ep: 180, Reward: 935.4222, Test: 747.6419 [89.76], Avg: 336.4940 (0.026)
Ep: 181, Reward: 804.9881, Test: 827.5119 [86.30], Avg: 338.7177 (0.025)
Ep: 182, Reward: 795.3106, Test: 865.8805 [44.33], Avg: 341.3562 (0.025)
Ep: 183, Reward: 878.8288, Test: 808.3101 [151.34], Avg: 343.0715 (0.024)
Ep: 184, Reward: 853.1536, Test: 829.4142 [38.35], Avg: 345.4931 (0.024)
Ep: 185, Reward: 830.5318, Test: 813.3564 [86.21], Avg: 347.5450 (0.023)
Ep: 186, Reward: 859.4062, Test: 830.2592 [39.06], Avg: 349.9175 (0.023)
Ep: 187, Reward: 780.5934, Test: 854.5606 [24.18], Avg: 352.4731 (0.022)
Ep: 188, Reward: 846.7342, Test: 869.1236 [24.74], Avg: 355.0758 (0.022)
Ep: 189, Reward: 866.1229, Test: 888.8502 [39.80], Avg: 357.6757 (0.022)
Ep: 190, Reward: 873.1010, Test: 809.5997 [144.22], Avg: 359.2867 (0.021)
Ep: 191, Reward: 883.3393, Test: 807.7797 [78.93], Avg: 361.2115 (0.021)
Ep: 192, Reward: 915.2144, Test: 750.5322 [199.83], Avg: 362.1933 (0.020)
Ep: 193, Reward: 901.3147, Test: 798.3213 [181.03], Avg: 363.5083 (0.020)
Ep: 194, Reward: 762.6910, Test: 674.3586 [233.40], Avg: 363.9054 (0.020)
Ep: 195, Reward: 791.8120, Test: 762.0839 [179.56], Avg: 365.0209 (0.020)
Ep: 196, Reward: 676.3945, Test: 820.1303 [46.37], Avg: 367.0957 (0.020)
Ep: 197, Reward: 742.4296, Test: 670.9324 [246.12], Avg: 367.3871 (0.020)
Ep: 198, Reward: 935.8134, Test: 801.9472 [133.41], Avg: 368.9004 (0.020)
Ep: 199, Reward: 774.8148, Test: 731.9674 [214.08], Avg: 369.6454 (0.020)
Ep: 200, Reward: 765.6199, Test: 705.3497 [246.72], Avg: 370.0881 (0.020)
Ep: 201, Reward: 771.9601, Test: 481.2154 [227.54], Avg: 369.5118 (0.020)
Ep: 202, Reward: 733.6974, Test: 690.3788 [240.85], Avg: 369.9059 (0.020)
Ep: 203, Reward: 647.2120, Test: 760.3366 [210.38], Avg: 370.7885 (0.020)
Ep: 204, Reward: 799.2129, Test: 807.2234 [130.54], Avg: 372.2807 (0.020)
Ep: 205, Reward: 829.2933, Test: 848.2028 [65.98], Avg: 374.2707 (0.020)
Ep: 206, Reward: 816.5266, Test: 751.9672 [153.99], Avg: 375.3514 (0.020)
Ep: 207, Reward: 647.1392, Test: 855.5898 [47.55], Avg: 377.4316 (0.020)
Ep: 208, Reward: 842.7809, Test: 827.8526 [62.37], Avg: 379.2883 (0.020)
Ep: 209, Reward: 769.3990, Test: 758.1174 [219.43], Avg: 380.0473 (0.020)
Ep: 210, Reward: 898.0669, Test: 860.2315 [94.27], Avg: 381.8763 (0.020)
Ep: 211, Reward: 811.1058, Test: 827.6812 [62.10], Avg: 383.6862 (0.020)
Ep: 212, Reward: 818.3002, Test: 833.0638 [57.87], Avg: 385.5243 (0.020)
Ep: 213, Reward: 825.0009, Test: 851.9547 [65.85], Avg: 387.3962 (0.020)
Ep: 214, Reward: 871.9507, Test: 763.0996 [95.45], Avg: 388.6997 (0.020)
Ep: 215, Reward: 790.4254, Test: 781.8741 [159.92], Avg: 389.7796 (0.020)
Ep: 216, Reward: 875.4905, Test: 814.0440 [70.34], Avg: 391.4105 (0.020)
Ep: 217, Reward: 783.5202, Test: 721.5452 [179.59], Avg: 392.1011 (0.020)
Ep: 218, Reward: 776.3215, Test: 701.9132 [182.22], Avg: 392.6837 (0.020)
Ep: 219, Reward: 799.3903, Test: 762.7237 [76.29], Avg: 394.0190 (0.020)
Ep: 220, Reward: 858.4996, Test: 753.8255 [124.06], Avg: 395.0857 (0.020)
Ep: 221, Reward: 720.2965, Test: 802.2421 [74.69], Avg: 396.5833 (0.020)
Ep: 222, Reward: 876.8657, Test: 820.0608 [94.48], Avg: 398.0586 (0.020)
Ep: 223, Reward: 836.2129, Test: 836.1424 [67.85], Avg: 399.7114 (0.020)
Ep: 224, Reward: 838.7566, Test: 872.5853 [11.92], Avg: 401.7601 (0.020)
Ep: 225, Reward: 796.6203, Test: 757.4444 [158.09], Avg: 402.6344 (0.020)
Ep: 226, Reward: 841.6502, Test: 810.5793 [80.51], Avg: 404.0768 (0.020)
Ep: 227, Reward: 747.4694, Test: 823.5988 [48.23], Avg: 405.7053 (0.020)
Ep: 228, Reward: 808.7997, Test: 799.0567 [153.25], Avg: 406.7538 (0.020)
Ep: 229, Reward: 828.4202, Test: 859.9409 [42.61], Avg: 408.5389 (0.020)
Ep: 230, Reward: 836.8962, Test: 818.3691 [79.70], Avg: 409.9680 (0.020)
Ep: 231, Reward: 826.4208, Test: 811.4518 [88.65], Avg: 411.3164 (0.020)
Ep: 232, Reward: 769.5317, Test: 808.3851 [35.94], Avg: 412.8663 (0.020)
Ep: 233, Reward: 884.8707, Test: 797.3876 [163.09], Avg: 413.8126 (0.020)
Ep: 234, Reward: 822.8946, Test: 869.9436 [16.24], Avg: 415.6845 (0.020)
Ep: 235, Reward: 852.4793, Test: 815.5009 [71.53], Avg: 417.0756 (0.020)
Ep: 236, Reward: 839.5481, Test: 852.4379 [27.01], Avg: 418.7986 (0.020)
Ep: 237, Reward: 822.2245, Test: 873.6543 [17.52], Avg: 420.6361 (0.020)
Ep: 238, Reward: 893.4286, Test: 871.2937 [39.15], Avg: 422.3579 (0.020)
Ep: 239, Reward: 877.1362, Test: 874.7671 [28.95], Avg: 424.1223 (0.020)
Ep: 240, Reward: 944.8188, Test: 866.1193 [66.18], Avg: 425.6817 (0.020)
Ep: 241, Reward: 950.6173, Test: 844.7757 [34.48], Avg: 427.2710 (0.020)
Ep: 242, Reward: 890.9272, Test: 880.5812 [33.83], Avg: 428.9973 (0.020)
Ep: 243, Reward: 1032.1138, Test: 890.0628 [33.28], Avg: 430.7505 (0.020)
Ep: 244, Reward: 1019.4105, Test: 877.0505 [27.72], Avg: 432.4590 (0.020)
Ep: 245, Reward: 879.6013, Test: 687.9284 [219.24], Avg: 432.6063 (0.020)
Ep: 246, Reward: 844.9383, Test: 821.6406 [83.60], Avg: 433.8428 (0.020)
Ep: 247, Reward: 784.5721, Test: 830.2234 [118.82], Avg: 434.9620 (0.020)
Ep: 248, Reward: 854.9980, Test: 833.4979 [199.65], Avg: 435.7608 (0.020)
Ep: 249, Reward: 902.7482, Test: 850.7279 [56.19], Avg: 437.1959 (0.020)
Ep: 250, Reward: 843.9987, Test: 804.1249 [167.77], Avg: 437.9893 (0.020)
Ep: 251, Reward: 1006.8298, Test: 624.5502 [252.75], Avg: 437.7267 (0.020)
Ep: 252, Reward: 884.5755, Test: 879.7548 [27.31], Avg: 439.3659 (0.020)
Ep: 253, Reward: 827.4709, Test: 858.1728 [45.12], Avg: 440.8371 (0.020)
Ep: 254, Reward: 830.6699, Test: 770.8567 [200.03], Avg: 441.3469 (0.020)
Ep: 255, Reward: 826.8860, Test: 835.5284 [90.28], Avg: 442.5340 (0.020)
Ep: 256, Reward: 873.0519, Test: 864.0436 [46.15], Avg: 443.9946 (0.020)
Ep: 257, Reward: 859.6530, Test: 850.8941 [45.69], Avg: 445.3946 (0.020)
Ep: 258, Reward: 885.7285, Test: 833.3993 [34.65], Avg: 446.7589 (0.020)
Ep: 259, Reward: 828.5149, Test: 873.9105 [72.58], Avg: 448.1226 (0.020)
Ep: 260, Reward: 994.0717, Test: 887.8814 [28.95], Avg: 449.6966 (0.020)
Ep: 261, Reward: 987.7738, Test: 902.7845 [27.64], Avg: 451.3205 (0.020)
Ep: 262, Reward: 889.4616, Test: 326.7872 [444.79], Avg: 449.1557 (0.020)
Ep: 263, Reward: 316.0684, Test: 672.3280 [294.38], Avg: 448.8860 (0.020)
Ep: 264, Reward: 885.7205, Test: 881.8118 [36.05], Avg: 450.3836 (0.020)
Ep: 265, Reward: 949.6258, Test: 881.5169 [25.14], Avg: 451.9099 (0.020)
Ep: 266, Reward: 873.4594, Test: 832.3187 [74.45], Avg: 453.0558 (0.020)
Ep: 267, Reward: 855.2515, Test: 827.3842 [66.39], Avg: 454.2049 (0.020)
Ep: 268, Reward: 877.2268, Test: 816.0735 [92.92], Avg: 455.2047 (0.020)
Ep: 269, Reward: 750.2308, Test: 806.9716 [97.23], Avg: 456.1474 (0.020)
Ep: 270, Reward: 848.2821, Test: 732.5557 [146.44], Avg: 456.6270 (0.020)
Ep: 271, Reward: 815.4643, Test: 690.2512 [216.42], Avg: 456.6902 (0.020)
Ep: 272, Reward: 867.1784, Test: 865.4955 [40.65], Avg: 458.0388 (0.020)
Ep: 273, Reward: 922.1417, Test: 771.3125 [141.54], Avg: 458.6656 (0.020)
Ep: 274, Reward: 830.4680, Test: 841.9944 [74.45], Avg: 459.7887 (0.020)
Ep: 275, Reward: 907.2441, Test: 848.6935 [35.12], Avg: 461.0705 (0.020)
Ep: 276, Reward: 857.4906, Test: 875.7994 [30.92], Avg: 462.4561 (0.020)
Ep: 277, Reward: 895.4193, Test: 832.8395 [188.84], Avg: 463.1092 (0.020)
Ep: 278, Reward: 885.9515, Test: 853.9448 [37.75], Avg: 464.3747 (0.020)
Ep: 279, Reward: 981.3509, Test: 873.4051 [42.71], Avg: 465.6830 (0.020)
Ep: 280, Reward: 927.7797, Test: 824.4213 [91.05], Avg: 466.6356 (0.020)
Ep: 281, Reward: 1017.9931, Test: 854.7042 [18.86], Avg: 467.9449 (0.020)
Ep: 282, Reward: 908.8342, Test: 894.5623 [23.49], Avg: 469.3694 (0.020)
Ep: 283, Reward: 916.4348, Test: 896.1305 [33.80], Avg: 470.7530 (0.020)
Ep: 284, Reward: 1047.4444, Test: 743.1202 [265.60], Avg: 470.7768 (0.020)
Ep: 285, Reward: 847.4767, Test: 793.4265 [174.76], Avg: 471.2939 (0.020)
Ep: 286, Reward: 839.0464, Test: 767.1584 [241.78], Avg: 471.4824 (0.020)
Ep: 287, Reward: 681.4221, Test: 682.5136 [274.15], Avg: 471.2632 (0.020)
Ep: 288, Reward: 899.6739, Test: 854.2272 [58.40], Avg: 472.3863 (0.020)
Ep: 289, Reward: 1018.0764, Test: 697.7586 [234.96], Avg: 472.3532 (0.020)
Ep: 290, Reward: 893.9302, Test: 814.9559 [88.32], Avg: 473.2270 (0.020)
Ep: 291, Reward: 852.2902, Test: 889.5993 [37.41], Avg: 474.5248 (0.020)
Ep: 292, Reward: 861.1837, Test: 874.5718 [42.33], Avg: 475.7457 (0.020)
Ep: 293, Reward: 843.7976, Test: 898.6323 [33.95], Avg: 477.0686 (0.020)
Ep: 294, Reward: 1001.1780, Test: 899.9249 [26.36], Avg: 478.4127 (0.020)
Ep: 295, Reward: 954.3392, Test: 872.5314 [96.15], Avg: 479.4193 (0.020)
Ep: 296, Reward: 1027.5550, Test: 902.8545 [18.43], Avg: 480.7829 (0.020)
Ep: 297, Reward: 897.9215, Test: 900.4322 [18.21], Avg: 482.1300 (0.020)
Ep: 298, Reward: 888.7733, Test: 854.9943 [123.19], Avg: 482.9651 (0.020)
Ep: 299, Reward: 871.3591, Test: 890.1069 [22.14], Avg: 484.2484 (0.020)
Ep: 300, Reward: 886.9490, Test: 870.8480 [13.29], Avg: 485.4886 (0.020)
Ep: 301, Reward: 877.4489, Test: 741.9474 [272.81], Avg: 485.4345 (0.020)
Ep: 302, Reward: 864.9794, Test: 820.3361 [152.57], Avg: 486.0362 (0.020)
Ep: 303, Reward: 902.3509, Test: 697.6049 [239.97], Avg: 485.9428 (0.020)
Ep: 304, Reward: 825.6907, Test: 834.1252 [220.28], Avg: 486.3622 (0.020)
Ep: 305, Reward: 1005.4388, Test: 880.0553 [46.22], Avg: 487.4977 (0.020)
Ep: 306, Reward: 1016.4116, Test: 765.1789 [182.36], Avg: 487.8082 (0.020)
Ep: 307, Reward: 888.9845, Test: 749.8867 [243.10], Avg: 487.8698 (0.020)
Ep: 308, Reward: 976.7259, Test: 842.8859 [170.70], Avg: 488.4663 (0.020)
Ep: 309, Reward: 817.0417, Test: 724.7084 [241.90], Avg: 488.4481 (0.020)
Ep: 310, Reward: 862.0708, Test: 663.7232 [265.30], Avg: 488.1586 (0.020)
Ep: 311, Reward: 617.2181, Test: 747.6047 [112.85], Avg: 488.6284 (0.020)
Ep: 312, Reward: 760.8913, Test: 684.7186 [169.31], Avg: 488.7140 (0.020)
Ep: 313, Reward: 832.8872, Test: 857.4441 [24.08], Avg: 489.8116 (0.020)
Ep: 314, Reward: 886.5440, Test: 867.5777 [42.24], Avg: 490.8768 (0.020)
Ep: 315, Reward: 846.5829, Test: 881.1191 [33.50], Avg: 492.0057 (0.020)
Ep: 316, Reward: 893.6041, Test: 881.9347 [29.09], Avg: 493.1440 (0.020)
Ep: 317, Reward: 916.4038, Test: 882.5244 [32.63], Avg: 494.2659 (0.020)
Ep: 318, Reward: 1072.2840, Test: 905.4401 [34.63], Avg: 495.4463 (0.020)
Ep: 319, Reward: 882.6482, Test: 863.1674 [30.93], Avg: 496.4987 (0.020)
Ep: 320, Reward: 922.1481, Test: 876.6096 [28.81], Avg: 497.5931 (0.020)
Ep: 321, Reward: 1041.7279, Test: 900.3449 [36.38], Avg: 498.7309 (0.020)
Ep: 322, Reward: 1056.9710, Test: 884.9696 [36.22], Avg: 499.8145 (0.020)
Ep: 323, Reward: 993.9922, Test: 887.1803 [30.08], Avg: 500.9173 (0.020)
Ep: 324, Reward: 903.0895, Test: 843.4853 [199.75], Avg: 501.3567 (0.020)
Ep: 325, Reward: 984.1128, Test: 908.0382 [27.92], Avg: 502.5186 (0.020)
Ep: 326, Reward: 893.7639, Test: 824.8435 [67.38], Avg: 503.2982 (0.020)
Ep: 327, Reward: 872.3995, Test: 820.7943 [142.40], Avg: 503.8321 (0.020)
Ep: 328, Reward: 955.1531, Test: 772.6356 [211.82], Avg: 504.0052 (0.020)
Ep: 329, Reward: 841.8408, Test: 653.2954 [319.05], Avg: 503.4908 (0.020)
Ep: 330, Reward: 890.3248, Test: 657.9721 [235.11], Avg: 503.2472 (0.020)
Ep: 331, Reward: 798.6696, Test: 811.1376 [153.23], Avg: 503.7131 (0.020)
Ep: 332, Reward: 811.8408, Test: 702.6375 [223.05], Avg: 503.6406 (0.020)
Ep: 333, Reward: 724.5101, Test: 828.3117 [151.69], Avg: 504.1585 (0.020)
Ep: 334, Reward: 853.3577, Test: 727.8208 [211.22], Avg: 504.1957 (0.020)
Ep: 335, Reward: 840.9859, Test: 820.8196 [184.45], Avg: 504.5891 (0.020)
Ep: 336, Reward: 825.2328, Test: 520.4040 [257.24], Avg: 503.8727 (0.020)
Ep: 337, Reward: 912.0288, Test: 811.8315 [180.77], Avg: 504.2490 (0.020)
Ep: 338, Reward: 994.9474, Test: 728.3041 [247.70], Avg: 504.1792 (0.020)
Ep: 339, Reward: 985.3089, Test: 651.7508 [209.55], Avg: 503.9969 (0.020)
Ep: 340, Reward: 686.6200, Test: 734.4641 [232.04], Avg: 503.9923 (0.020)
Ep: 341, Reward: 974.3633, Test: 741.0294 [241.33], Avg: 503.9797 (0.020)
Ep: 342, Reward: 852.9031, Test: 904.0513 [33.96], Avg: 505.0471 (0.020)
Ep: 343, Reward: 1101.4042, Test: 750.3141 [220.43], Avg: 505.1193 (0.020)
Ep: 344, Reward: 759.1212, Test: 866.4993 [49.29], Avg: 506.0239 (0.020)
Ep: 345, Reward: 871.4627, Test: 883.7498 [29.11], Avg: 507.0315 (0.020)
Ep: 346, Reward: 881.8171, Test: 773.4993 [160.23], Avg: 507.3376 (0.020)
Ep: 347, Reward: 1023.0422, Test: 856.2897 [99.75], Avg: 508.0537 (0.020)
Ep: 348, Reward: 928.0002, Test: 884.8601 [17.37], Avg: 509.0836 (0.020)
Ep: 349, Reward: 891.9183, Test: 868.1153 [26.61], Avg: 510.0334 (0.020)
Ep: 350, Reward: 868.3648, Test: 901.8607 [20.47], Avg: 511.0914 (0.020)
Ep: 351, Reward: 970.4327, Test: 888.0273 [65.49], Avg: 511.9762 (0.020)
Ep: 352, Reward: 954.3992, Test: 906.1103 [25.07], Avg: 513.0217 (0.020)
Ep: 353, Reward: 1050.3004, Test: 895.9579 [19.47], Avg: 514.0484 (0.020)
Ep: 354, Reward: 1065.9206, Test: 886.8686 [31.36], Avg: 515.0103 (0.020)
Ep: 355, Reward: 980.5105, Test: 892.8190 [31.09], Avg: 515.9842 (0.020)
Ep: 356, Reward: 1037.4497, Test: 900.4405 [23.39], Avg: 516.9956 (0.020)
Ep: 357, Reward: 1050.4073, Test: 898.9821 [30.10], Avg: 517.9785 (0.020)
Ep: 358, Reward: 1087.4812, Test: 842.3136 [206.03], Avg: 518.3081 (0.020)
Ep: 359, Reward: 990.1306, Test: 884.5686 [46.02], Avg: 519.1976 (0.020)
Ep: 360, Reward: 1009.6933, Test: 912.8554 [23.52], Avg: 520.2230 (0.020)
Ep: 361, Reward: 1122.3844, Test: 917.2902 [18.52], Avg: 521.2687 (0.020)
Ep: 362, Reward: 978.6259, Test: 865.0495 [85.46], Avg: 521.9803 (0.020)
Ep: 363, Reward: 908.0685, Test: 899.5407 [33.45], Avg: 522.9257 (0.020)
Ep: 364, Reward: 953.8201, Test: 868.5566 [105.94], Avg: 523.5823 (0.020)
Ep: 365, Reward: 928.6554, Test: 887.9220 [20.60], Avg: 524.5215 (0.020)
Ep: 366, Reward: 1033.5350, Test: 832.1364 [107.61], Avg: 525.0665 (0.020)
Ep: 367, Reward: 936.7430, Test: 880.8324 [37.13], Avg: 525.9324 (0.020)
Ep: 368, Reward: 950.1179, Test: 863.5559 [37.32], Avg: 526.7462 (0.020)
Ep: 369, Reward: 925.2333, Test: 882.7336 [27.52], Avg: 527.6340 (0.020)
Ep: 370, Reward: 950.8488, Test: 902.3551 [32.60], Avg: 528.5561 (0.020)
Ep: 371, Reward: 1106.3498, Test: 905.9936 [34.08], Avg: 529.4791 (0.020)
Ep: 372, Reward: 1122.9206, Test: 918.2144 [28.91], Avg: 530.4438 (0.020)
Ep: 373, Reward: 1077.7855, Test: 886.0353 [19.66], Avg: 531.3420 (0.020)
Ep: 374, Reward: 1047.7918, Test: 862.2860 [51.57], Avg: 532.0870 (0.020)
Ep: 375, Reward: 883.9848, Test: 887.8085 [69.30], Avg: 532.8488 (0.020)
Ep: 376, Reward: 897.8094, Test: 904.7477 [31.68], Avg: 533.7512 (0.020)
Ep: 377, Reward: 1086.9588, Test: 842.1884 [99.19], Avg: 534.3048 (0.020)
Ep: 378, Reward: 871.7685, Test: 769.8518 [119.58], Avg: 534.6108 (0.020)
Ep: 379, Reward: 980.9563, Test: 892.0645 [36.14], Avg: 535.4563 (0.020)
Ep: 380, Reward: 994.5433, Test: 870.6428 [96.96], Avg: 536.0816 (0.020)
Ep: 381, Reward: 1102.3612, Test: 812.7839 [113.37], Avg: 536.5092 (0.020)
Ep: 382, Reward: 864.4476, Test: 830.2739 [169.34], Avg: 536.8340 (0.020)
Ep: 383, Reward: 900.7242, Test: 898.8497 [21.80], Avg: 537.7200 (0.020)
Ep: 384, Reward: 877.1836, Test: 799.4850 [248.45], Avg: 537.7546 (0.020)
Ep: 385, Reward: 892.5922, Test: 663.3184 [211.01], Avg: 537.5332 (0.020)
Ep: 386, Reward: 775.2108, Test: 766.5523 [122.96], Avg: 537.8073 (0.020)
Ep: 387, Reward: 760.1390, Test: 815.7166 [188.49], Avg: 538.0377 (0.020)
Ep: 388, Reward: 770.1207, Test: 862.8809 [20.54], Avg: 538.8200 (0.020)
Ep: 389, Reward: 757.4458, Test: 821.3351 [153.37], Avg: 539.1512 (0.020)
Ep: 390, Reward: 797.2941, Test: 750.4916 [205.33], Avg: 539.1665 (0.020)
Ep: 391, Reward: 712.9160, Test: 706.2638 [210.64], Avg: 539.0554 (0.020)
Ep: 392, Reward: 841.4926, Test: 848.1663 [26.78], Avg: 539.7738 (0.020)
Ep: 393, Reward: 824.3999, Test: 661.6273 [201.99], Avg: 539.5704 (0.020)
Ep: 394, Reward: 786.5489, Test: 713.2184 [232.81], Avg: 539.4207 (0.020)
Ep: 395, Reward: 883.2162, Test: 822.3486 [138.67], Avg: 539.7849 (0.020)
Ep: 396, Reward: 849.4977, Test: 845.4213 [109.08], Avg: 540.2800 (0.020)
Ep: 397, Reward: 911.6729, Test: 800.9732 [204.84], Avg: 540.4204 (0.020)
Ep: 398, Reward: 952.3343, Test: 865.9951 [26.33], Avg: 541.1703 (0.020)
Ep: 399, Reward: 885.2571, Test: 859.4889 [36.87], Avg: 541.8740 (0.020)
Ep: 400, Reward: 836.9250, Test: 891.1305 [32.75], Avg: 542.6633 (0.020)
Ep: 401, Reward: 812.2490, Test: 784.9751 [164.38], Avg: 542.8571 (0.020)
Ep: 402, Reward: 1011.2152, Test: 877.4323 [30.64], Avg: 543.6113 (0.020)
Ep: 403, Reward: 907.3977, Test: 735.6103 [207.79], Avg: 543.5722 (0.020)
Ep: 404, Reward: 801.3211, Test: 855.6698 [24.64], Avg: 544.2820 (0.020)
Ep: 405, Reward: 789.5377, Test: 801.2624 [98.84], Avg: 544.6715 (0.020)
Ep: 406, Reward: 781.6659, Test: 787.4149 [180.90], Avg: 544.8234 (0.020)
Ep: 407, Reward: 835.2751, Test: 743.3504 [206.03], Avg: 544.8050 (0.020)
Ep: 408, Reward: 638.2737, Test: 810.7501 [73.09], Avg: 545.2766 (0.020)
Ep: 409, Reward: 835.7016, Test: 826.4376 [52.74], Avg: 545.8337 (0.020)
Ep: 410, Reward: 723.7412, Test: 807.0200 [122.74], Avg: 546.1706 (0.020)
Ep: 411, Reward: 738.0726, Test: 760.5767 [167.35], Avg: 546.2848 (0.020)
Ep: 412, Reward: 690.6376, Test: 769.9767 [203.54], Avg: 546.3336 (0.020)
Ep: 413, Reward: 742.0551, Test: 868.9744 [40.34], Avg: 547.0155 (0.020)
Ep: 414, Reward: 729.1008, Test: 778.4365 [176.98], Avg: 547.1467 (0.020)
Ep: 415, Reward: 874.9114, Test: 698.0370 [230.67], Avg: 546.9549 (0.020)
Ep: 416, Reward: 714.1680, Test: 816.4435 [124.10], Avg: 547.3035 (0.020)
Ep: 417, Reward: 856.3276, Test: 826.5681 [92.93], Avg: 547.7493 (0.020)
Ep: 418, Reward: 918.8021, Test: 817.9304 [85.97], Avg: 548.1890 (0.020)
Ep: 419, Reward: 836.3654, Test: 870.2814 [37.53], Avg: 548.8665 (0.020)
Ep: 420, Reward: 820.4443, Test: 811.3492 [198.95], Avg: 549.0174 (0.020)
Ep: 421, Reward: 856.6065, Test: 816.3126 [139.97], Avg: 549.3191 (0.020)
Ep: 422, Reward: 918.1772, Test: 874.2120 [53.23], Avg: 549.9614 (0.020)
Ep: 423, Reward: 852.2554, Test: 846.6245 [43.36], Avg: 550.5588 (0.020)
Ep: 424, Reward: 776.1370, Test: 651.2415 [240.19], Avg: 550.2305 (0.020)
Ep: 425, Reward: 762.6807, Test: 714.2827 [179.98], Avg: 550.1931 (0.020)
Ep: 426, Reward: 774.9194, Test: 830.2426 [60.17], Avg: 550.7081 (0.020)
Ep: 427, Reward: 810.8387, Test: 791.0146 [42.70], Avg: 551.1698 (0.020)
Ep: 428, Reward: 785.0144, Test: 839.7146 [24.89], Avg: 551.7844 (0.020)
Ep: 429, Reward: 762.3708, Test: 769.0007 [153.73], Avg: 551.9320 (0.020)
Ep: 430, Reward: 723.3631, Test: 646.4807 [222.21], Avg: 551.6358 (0.020)
Ep: 431, Reward: 620.2399, Test: 761.1993 [133.55], Avg: 551.8118 (0.020)
Ep: 432, Reward: 644.5639, Test: 676.4241 [213.43], Avg: 551.6066 (0.020)
Ep: 433, Reward: 591.1701, Test: 531.8491 [248.79], Avg: 550.9879 (0.020)
Ep: 434, Reward: 665.1357, Test: 640.7351 [263.21], Avg: 550.5891 (0.020)
Ep: 435, Reward: 714.7901, Test: 697.3396 [168.38], Avg: 550.5395 (0.020)
Ep: 436, Reward: 811.8166, Test: 529.2556 [276.73], Avg: 549.8576 (0.020)
Ep: 437, Reward: 750.5083, Test: 655.7044 [211.42], Avg: 549.6165 (0.020)
Ep: 438, Reward: 758.9498, Test: 783.3732 [211.42], Avg: 549.6674 (0.020)
Ep: 439, Reward: 895.9461, Test: 851.1353 [71.92], Avg: 550.1891 (0.020)
Ep: 440, Reward: 965.5621, Test: 854.1966 [28.94], Avg: 550.8128 (0.020)
Ep: 441, Reward: 847.4682, Test: 856.2285 [62.12], Avg: 551.3633 (0.020)
Ep: 442, Reward: 1029.1205, Test: 879.6211 [25.41], Avg: 552.0469 (0.020)
Ep: 443, Reward: 1046.0178, Test: 842.0190 [105.53], Avg: 552.4623 (0.020)
Ep: 444, Reward: 930.8447, Test: 892.6803 [33.91], Avg: 553.1506 (0.020)
Ep: 445, Reward: 1089.3809, Test: 870.1031 [76.18], Avg: 553.6905 (0.020)
Ep: 446, Reward: 1050.8962, Test: 890.7950 [25.60], Avg: 554.3874 (0.020)
Ep: 447, Reward: 1127.5769, Test: 878.2319 [78.66], Avg: 554.9347 (0.020)
Ep: 448, Reward: 1003.4473, Test: 895.2209 [30.28], Avg: 555.6251 (0.020)
Ep: 449, Reward: 1018.2735, Test: 895.2840 [22.82], Avg: 556.3292 (0.020)
Ep: 450, Reward: 994.7740, Test: 839.9409 [118.59], Avg: 556.6951 (0.020)
Ep: 451, Reward: 904.1046, Test: 895.4241 [22.91], Avg: 557.3938 (0.020)
Ep: 452, Reward: 894.1008, Test: 879.0662 [43.83], Avg: 558.0071 (0.020)
Ep: 453, Reward: 967.6260, Test: 891.1180 [84.93], Avg: 558.5538 (0.020)
Ep: 454, Reward: 1024.3778, Test: 881.3777 [47.42], Avg: 559.1591 (0.020)
Ep: 455, Reward: 1032.8641, Test: 899.8755 [31.15], Avg: 559.8379 (0.020)
Ep: 456, Reward: 1045.4472, Test: 898.8043 [23.06], Avg: 560.5292 (0.020)
Ep: 457, Reward: 935.8172, Test: 893.4141 [39.16], Avg: 561.1705 (0.020)
Ep: 458, Reward: 898.6166, Test: 897.9368 [20.86], Avg: 561.8588 (0.020)
Ep: 459, Reward: 965.0154, Test: 888.5092 [18.27], Avg: 562.5292 (0.020)
Ep: 460, Reward: 936.5864, Test: 896.2983 [18.23], Avg: 563.2136 (0.020)
Ep: 461, Reward: 899.3455, Test: 880.1952 [36.71], Avg: 563.8203 (0.020)
Ep: 462, Reward: 951.4096, Test: 836.4597 [50.78], Avg: 564.2995 (0.020)
Ep: 463, Reward: 738.0447, Test: 865.4290 [24.89], Avg: 564.8948 (0.020)
Ep: 464, Reward: 855.0511, Test: 877.6712 [30.64], Avg: 565.5015 (0.020)
Ep: 465, Reward: 905.0581, Test: 813.1344 [110.29], Avg: 565.7963 (0.020)
Ep: 466, Reward: 913.9178, Test: 703.9606 [248.06], Avg: 565.5609 (0.020)
Ep: 467, Reward: 825.3443, Test: 794.6085 [87.75], Avg: 565.8629 (0.020)
Ep: 468, Reward: 867.4298, Test: 759.5766 [165.52], Avg: 565.9230 (0.020)
Ep: 469, Reward: 776.9755, Test: 869.5929 [34.85], Avg: 566.4949 (0.020)
Ep: 470, Reward: 848.4304, Test: 840.4251 [134.30], Avg: 566.7914 (0.020)
Ep: 471, Reward: 956.4038, Test: 756.0738 [133.40], Avg: 566.9098 (0.020)
Ep: 472, Reward: 922.3783, Test: 846.5926 [59.24], Avg: 567.3758 (0.020)
Ep: 473, Reward: 930.6949, Test: 759.3948 [193.94], Avg: 567.3718 (0.020)
Ep: 474, Reward: 870.4113, Test: 889.5701 [39.31], Avg: 567.9673 (0.020)
Ep: 475, Reward: 811.0344, Test: 847.1647 [77.71], Avg: 568.3906 (0.020)
Ep: 476, Reward: 861.4010, Test: 830.0843 [58.01], Avg: 568.8176 (0.020)
Ep: 477, Reward: 922.2040, Test: 745.3009 [109.40], Avg: 568.9580 (0.020)
Ep: 478, Reward: 758.2877, Test: 820.6351 [89.49], Avg: 569.2966 (0.020)
Ep: 479, Reward: 822.2288, Test: 757.5775 [144.86], Avg: 569.3870 (0.020)
Ep: 480, Reward: 905.0774, Test: 805.0601 [105.37], Avg: 569.6579 (0.020)
Ep: 481, Reward: 824.4218, Test: 856.0115 [22.89], Avg: 570.2045 (0.020)
Ep: 482, Reward: 888.0766, Test: 864.3563 [31.70], Avg: 570.7479 (0.020)
Ep: 483, Reward: 916.4664, Test: 838.7544 [28.84], Avg: 571.2421 (0.020)
Ep: 484, Reward: 924.8979, Test: 890.8758 [36.15], Avg: 571.8266 (0.020)
Ep: 485, Reward: 949.8232, Test: 838.6788 [137.21], Avg: 572.0933 (0.020)
Ep: 486, Reward: 893.6860, Test: 809.4052 [154.73], Avg: 572.2629 (0.020)
Ep: 487, Reward: 1011.5324, Test: 877.5896 [16.29], Avg: 572.8552 (0.020)
Ep: 488, Reward: 860.5337, Test: 816.5529 [142.91], Avg: 573.0613 (0.020)
Ep: 489, Reward: 665.7068, Test: 698.5284 [262.69], Avg: 572.7812 (0.020)
Ep: 490, Reward: 859.1043, Test: 771.7527 [173.59], Avg: 572.8329 (0.020)
Ep: 491, Reward: 993.9067, Test: 862.7683 [61.01], Avg: 573.2982 (0.020)
Ep: 492, Reward: 844.6735, Test: 860.3028 [147.25], Avg: 573.5817 (0.020)
Ep: 493, Reward: 854.5206, Test: 590.9350 [302.77], Avg: 573.0039 (0.020)
Ep: 494, Reward: 1021.5263, Test: 748.8808 [201.54], Avg: 572.9521 (0.020)
Ep: 495, Reward: 939.0371, Test: 850.0548 [140.24], Avg: 573.2280 (0.020)
Ep: 496, Reward: 957.5818, Test: 901.0643 [31.23], Avg: 573.8248 (0.020)
Ep: 497, Reward: 979.7910, Test: 868.7050 [59.60], Avg: 574.2973 (0.020)
Ep: 498, Reward: 959.5090, Test: 880.0456 [13.32], Avg: 574.8833 (0.020)
Ep: 499, Reward: 949.3963, Test: 824.1850 [63.82], Avg: 575.2543 (0.020)
