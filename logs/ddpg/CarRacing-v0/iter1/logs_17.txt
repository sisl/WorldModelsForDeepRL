Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.98			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.0225               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -56.5536, Test: -54.3795 [25.71], Avg: -80.0881 (0.980)
Ep: 1, Reward: -64.4206, Test: -56.5383 [18.08], Avg: -77.3517 (0.960)
Ep: 2, Reward: -52.2318, Test: -48.6996 [27.05], Avg: -76.8186 (0.941)
Ep: 3, Reward: -57.5402, Test: -53.0314 [22.02], Avg: -76.3759 (0.922)
Ep: 4, Reward: -52.9401, Test: -52.9083 [16.26], Avg: -74.9346 (0.904)
Ep: 5, Reward: -55.3915, Test: -56.8938 [26.08], Avg: -76.2747 (0.886)
Ep: 6, Reward: -54.1770, Test: -56.9973 [17.83], Avg: -76.0684 (0.868)
Ep: 7, Reward: -60.7000, Test: -62.5749 [18.78], Avg: -76.7286 (0.851)
Ep: 8, Reward: -51.4956, Test: -64.7935 [53.02], Avg: -81.2937 (0.834)
Ep: 9, Reward: -54.2417, Test: -57.6968 [22.62], Avg: -81.1963 (0.817)
Ep: 10, Reward: -41.8694, Test: -55.2986 [18.91], Avg: -80.5607 (0.801)
Ep: 11, Reward: -43.9100, Test: -45.0277 [24.46], Avg: -79.6377 (0.785)
Ep: 12, Reward: -53.0629, Test: -43.9772 [26.46], Avg: -78.9301 (0.769)
Ep: 13, Reward: -41.0360, Test: -58.4654 [38.36], Avg: -80.2085 (0.754)
Ep: 14, Reward: -41.1399, Test: -53.3079 [16.55], Avg: -79.5182 (0.739)
Ep: 15, Reward: -45.1921, Test: -45.6220 [15.71], Avg: -78.3816 (0.724)
Ep: 16, Reward: -53.8366, Test: -60.6745 [40.17], Avg: -79.7028 (0.709)
Ep: 17, Reward: -32.4571, Test: -43.8721 [27.34], Avg: -79.2312 (0.695)
Ep: 18, Reward: -44.6983, Test: -32.7216 [32.28], Avg: -78.4825 (0.681)
Ep: 19, Reward: -48.5906, Test: -30.3602 [33.85], Avg: -77.7690 (0.668)
Ep: 20, Reward: -49.0366, Test: -42.6153 [40.51], Avg: -78.0242 (0.654)
Ep: 21, Reward: -57.7489, Test: -26.4902 [52.13], Avg: -78.0513 (0.641)
Ep: 22, Reward: -21.6782, Test: -33.5693 [31.92], Avg: -77.5052 (0.628)
Ep: 23, Reward: -39.3188, Test: -38.4406 [24.04], Avg: -76.8793 (0.616)
Ep: 24, Reward: -27.6338, Test: -26.2059 [10.88], Avg: -75.2876 (0.603)
Ep: 25, Reward: -27.5917, Test: -14.6213 [26.26], Avg: -73.9643 (0.591)
Ep: 26, Reward: -52.8767, Test: -24.7019 [37.00], Avg: -73.5103 (0.580)
Ep: 27, Reward: -6.7300, Test: 3.2063 [69.14], Avg: -73.2396 (0.568)
Ep: 28, Reward: -8.3874, Test: 1.1370 [38.98], Avg: -72.0192 (0.557)
Ep: 29, Reward: -20.6099, Test: -15.4129 [58.18], Avg: -72.0718 (0.545)
Ep: 30, Reward: -9.8894, Test: 28.5607 [76.73], Avg: -71.3007 (0.535)
Ep: 31, Reward: 6.4588, Test: -10.6504 [38.38], Avg: -70.6047 (0.524)
Ep: 32, Reward: 2.5637, Test: 56.1780 [68.54], Avg: -68.8397 (0.513)
Ep: 33, Reward: 38.9479, Test: -18.5928 [31.37], Avg: -68.2846 (0.503)
Ep: 34, Reward: -10.3936, Test: 44.2481 [70.67], Avg: -67.0886 (0.493)
Ep: 35, Reward: 9.5233, Test: 64.3823 [69.14], Avg: -65.3570 (0.483)
Ep: 36, Reward: -1.3772, Test: 91.1526 [123.92], Avg: -64.4762 (0.474)
Ep: 37, Reward: 21.8915, Test: 49.4280 [56.18], Avg: -62.9571 (0.464)
Ep: 38, Reward: 51.8593, Test: -5.4607 [82.37], Avg: -63.5949 (0.455)
Ep: 39, Reward: 32.6088, Test: 147.3408 [117.56], Avg: -61.2605 (0.446)
Ep: 40, Reward: 72.0438, Test: 85.9746 [90.18], Avg: -59.8690 (0.437)
Ep: 41, Reward: 114.5776, Test: 87.2449 [137.17], Avg: -59.6322 (0.428)
Ep: 42, Reward: 83.0295, Test: 130.3149 [112.02], Avg: -57.8200 (0.419)
Ep: 43, Reward: 115.9591, Test: 66.3653 [99.08], Avg: -57.2494 (0.411)
Ep: 44, Reward: 45.7600, Test: 105.3964 [103.90], Avg: -55.9439 (0.403)
Ep: 45, Reward: 89.0715, Test: 69.9846 [84.43], Avg: -55.0418 (0.395)
Ep: 46, Reward: 97.5126, Test: 57.6978 [81.22], Avg: -54.3712 (0.387)
Ep: 47, Reward: 78.2169, Test: -5.0411 [62.60], Avg: -54.6477 (0.379)
Ep: 48, Reward: 86.6216, Test: 77.6106 [139.82], Avg: -54.8019 (0.372)
Ep: 49, Reward: 97.2638, Test: 143.2246 [128.57], Avg: -53.4127 (0.364)
Ep: 50, Reward: 80.7150, Test: 121.1163 [146.24], Avg: -52.8580 (0.357)
Ep: 51, Reward: 154.8350, Test: 130.4239 [131.40], Avg: -51.8603 (0.350)
Ep: 52, Reward: 127.0275, Test: 211.1181 [161.79], Avg: -49.9511 (0.343)
Ep: 53, Reward: 143.7361, Test: 201.6956 [120.53], Avg: -47.5230 (0.336)
Ep: 54, Reward: 159.1086, Test: 159.9643 [192.08], Avg: -47.2428 (0.329)
Ep: 55, Reward: 108.1314, Test: 198.0299 [137.34], Avg: -45.3154 (0.323)
Ep: 56, Reward: 147.0096, Test: 106.7974 [82.15], Avg: -44.0880 (0.316)
Ep: 57, Reward: 162.7500, Test: 136.9026 [92.38], Avg: -42.5603 (0.310)
Ep: 58, Reward: 146.6832, Test: 183.5255 [136.44], Avg: -41.0408 (0.304)
Ep: 59, Reward: 268.7932, Test: 241.4667 [163.00], Avg: -39.0491 (0.298)
Ep: 60, Reward: 269.4174, Test: 213.6182 [119.63], Avg: -36.8681 (0.292)
Ep: 61, Reward: 261.1728, Test: 231.6890 [76.26], Avg: -33.7666 (0.286)
Ep: 62, Reward: 261.8750, Test: 209.2849 [136.45], Avg: -32.0745 (0.280)
Ep: 63, Reward: 235.4592, Test: 217.0025 [175.21], Avg: -30.9204 (0.274)
Ep: 64, Reward: 241.1454, Test: 186.5519 [158.82], Avg: -30.0180 (0.269)
Ep: 65, Reward: 168.8205, Test: 243.4933 [81.34], Avg: -27.1063 (0.264)
Ep: 66, Reward: 215.2026, Test: 344.7091 [125.51], Avg: -23.4301 (0.258)
Ep: 67, Reward: 181.5530, Test: 245.2197 [206.09], Avg: -22.5100 (0.253)
Ep: 68, Reward: 291.1338, Test: 222.1288 [146.08], Avg: -21.0816 (0.248)
Ep: 69, Reward: 242.6357, Test: 245.1675 [166.25], Avg: -19.6530 (0.243)
Ep: 70, Reward: 191.6908, Test: 261.8784 [110.74], Avg: -17.2475 (0.238)
Ep: 71, Reward: 217.0885, Test: 286.9749 [180.92], Avg: -15.5350 (0.233)
Ep: 72, Reward: 272.6773, Test: 320.1418 [158.90], Avg: -13.1134 (0.229)
Ep: 73, Reward: 389.6046, Test: 265.6934 [201.86], Avg: -12.0736 (0.224)
Ep: 74, Reward: 330.5244, Test: 320.7916 [221.34], Avg: -10.5866 (0.220)
Ep: 75, Reward: 383.2810, Test: 268.7542 [236.97], Avg: -10.0291 (0.215)
Ep: 76, Reward: 428.8857, Test: 405.4569 [125.24], Avg: -6.2597 (0.211)
Ep: 77, Reward: 486.9911, Test: 107.2775 [218.03], Avg: -7.5993 (0.207)
Ep: 78, Reward: 424.4488, Test: 460.7122 [122.04], Avg: -3.2161 (0.203)
Ep: 79, Reward: 282.3074, Test: 216.8024 [185.94], Avg: -2.7901 (0.199)
Ep: 80, Reward: 418.0374, Test: 425.4037 [226.05], Avg: -0.2944 (0.195)
Ep: 81, Reward: 336.9681, Test: 494.0067 [227.02], Avg: 2.9651 (0.191)
Ep: 82, Reward: 502.2019, Test: 432.3561 [183.49], Avg: 5.9277 (0.187)
Ep: 83, Reward: 373.1623, Test: 401.8792 [204.67], Avg: 8.2049 (0.183)
Ep: 84, Reward: 427.7691, Test: 425.4218 [292.49], Avg: 9.6723 (0.180)
Ep: 85, Reward: 542.4994, Test: 448.6489 [238.62], Avg: 12.0021 (0.176)
Ep: 86, Reward: 485.4952, Test: 429.8893 [239.08], Avg: 14.0573 (0.172)
Ep: 87, Reward: 443.2700, Test: 456.1294 [222.45], Avg: 16.5530 (0.169)
Ep: 88, Reward: 401.9039, Test: 466.0293 [200.24], Avg: 19.3534 (0.166)
Ep: 89, Reward: 454.4823, Test: 632.1002 [209.03], Avg: 23.8392 (0.162)
Ep: 90, Reward: 451.2415, Test: 389.7008 [230.24], Avg: 25.3296 (0.159)
Ep: 91, Reward: 557.7549, Test: 431.3581 [124.99], Avg: 28.3843 (0.156)
Ep: 92, Reward: 524.4121, Test: 673.4692 [157.86], Avg: 33.6233 (0.153)
Ep: 93, Reward: 574.5417, Test: 441.3353 [202.53], Avg: 35.8061 (0.150)
Ep: 94, Reward: 520.1811, Test: 454.7484 [188.15], Avg: 38.2355 (0.147)
Ep: 95, Reward: 588.5319, Test: 548.4337 [197.57], Avg: 41.4921 (0.144)
Ep: 96, Reward: 639.5409, Test: 545.6116 [224.50], Avg: 44.3748 (0.141)
Ep: 97, Reward: 635.0840, Test: 600.0536 [190.66], Avg: 48.0994 (0.138)
Ep: 98, Reward: 580.4654, Test: 497.0298 [169.78], Avg: 50.9191 (0.135)
Ep: 99, Reward: 598.1850, Test: 686.4818 [173.08], Avg: 55.5440 (0.133)
Ep: 100, Reward: 611.5905, Test: 540.0712 [208.02], Avg: 58.2817 (0.130)
Ep: 101, Reward: 539.7410, Test: 440.4811 [232.59], Avg: 59.7485 (0.127)
Ep: 102, Reward: 572.8488, Test: 559.4884 [175.53], Avg: 62.8961 (0.125)
Ep: 103, Reward: 548.2121, Test: 465.6614 [205.34], Avg: 64.7945 (0.122)
Ep: 104, Reward: 567.9735, Test: 655.0396 [169.87], Avg: 68.7980 (0.120)
Ep: 105, Reward: 581.0735, Test: 680.5337 [144.72], Avg: 73.2039 (0.117)
Ep: 106, Reward: 456.5136, Test: 394.1244 [220.07], Avg: 74.1464 (0.115)
Ep: 107, Reward: 692.4007, Test: 456.6018 [146.74], Avg: 76.3289 (0.113)
Ep: 108, Reward: 567.8488, Test: 606.2342 [99.42], Avg: 80.2783 (0.111)
Ep: 109, Reward: 539.1883, Test: 514.7678 [280.77], Avg: 81.6758 (0.108)
Ep: 110, Reward: 505.5162, Test: 536.2190 [203.60], Avg: 83.9365 (0.106)
Ep: 111, Reward: 513.5916, Test: 644.9231 [166.85], Avg: 87.4556 (0.104)
Ep: 112, Reward: 518.8371, Test: 540.9814 [162.49], Avg: 90.0311 (0.102)
Ep: 113, Reward: 549.1894, Test: 537.5079 [267.53], Avg: 91.6096 (0.100)
Ep: 114, Reward: 604.1287, Test: 581.4630 [184.89], Avg: 94.2614 (0.098)
Ep: 115, Reward: 547.1132, Test: 652.2378 [130.41], Avg: 97.9474 (0.096)
Ep: 116, Reward: 485.0084, Test: 586.1369 [201.13], Avg: 100.4009 (0.094)
Ep: 117, Reward: 567.3722, Test: 581.0938 [222.64], Avg: 102.5878 (0.092)
Ep: 118, Reward: 565.6379, Test: 664.5601 [192.74], Avg: 105.6906 (0.090)
Ep: 119, Reward: 621.2869, Test: 501.3913 [190.56], Avg: 107.4001 (0.089)
Ep: 120, Reward: 636.7572, Test: 635.4333 [132.53], Avg: 110.6687 (0.087)
Ep: 121, Reward: 551.4827, Test: 418.5817 [180.50], Avg: 111.7131 (0.085)
Ep: 122, Reward: 593.4347, Test: 440.3489 [197.93], Avg: 112.7758 (0.083)
Ep: 123, Reward: 534.7181, Test: 433.4569 [213.11], Avg: 113.6433 (0.082)
Ep: 124, Reward: 551.5552, Test: 471.8921 [312.26], Avg: 114.0112 (0.080)
Ep: 125, Reward: 572.7294, Test: 569.7955 [166.14], Avg: 116.3099 (0.078)
Ep: 126, Reward: 548.8920, Test: 570.3344 [174.26], Avg: 118.5128 (0.077)
Ep: 127, Reward: 615.8320, Test: 557.4592 [206.18], Avg: 120.3313 (0.075)
Ep: 128, Reward: 592.6326, Test: 446.9750 [286.31], Avg: 120.6439 (0.074)
Ep: 129, Reward: 526.3027, Test: 498.2521 [175.55], Avg: 122.1982 (0.072)
Ep: 130, Reward: 559.5927, Test: 588.0493 [175.32], Avg: 124.4160 (0.071)
Ep: 131, Reward: 546.6269, Test: 605.5924 [166.40], Avg: 126.8007 (0.069)
Ep: 132, Reward: 606.0036, Test: 495.5351 [203.06], Avg: 128.0464 (0.068)
Ep: 133, Reward: 522.3991, Test: 536.6967 [155.72], Avg: 129.9339 (0.067)
Ep: 134, Reward: 473.9172, Test: 409.8486 [181.32], Avg: 130.6643 (0.065)
Ep: 135, Reward: 522.8203, Test: 299.3788 [118.15], Avg: 131.0361 (0.064)
Ep: 136, Reward: 518.5563, Test: 499.1335 [195.52], Avg: 132.2958 (0.063)
Ep: 137, Reward: 492.2476, Test: 457.3928 [164.12], Avg: 133.4623 (0.062)
Ep: 138, Reward: 496.8619, Test: 392.6719 [191.51], Avg: 133.9493 (0.060)
Ep: 139, Reward: 468.2768, Test: 422.7136 [146.11], Avg: 134.9683 (0.059)
Ep: 140, Reward: 388.5466, Test: 417.0529 [194.91], Avg: 135.5866 (0.058)
Ep: 141, Reward: 545.6567, Test: 570.9608 [180.70], Avg: 137.3800 (0.057)
Ep: 142, Reward: 550.8993, Test: 495.8088 [138.72], Avg: 138.9165 (0.056)
Ep: 143, Reward: 553.5364, Test: 467.9710 [276.31], Avg: 139.2828 (0.055)
Ep: 144, Reward: 452.2167, Test: 526.3562 [240.25], Avg: 140.2953 (0.053)
Ep: 145, Reward: 588.8651, Test: 495.8453 [295.88], Avg: 140.7040 (0.052)
Ep: 146, Reward: 614.9400, Test: 587.3942 [288.56], Avg: 141.7797 (0.051)
Ep: 147, Reward: 649.7901, Test: 767.4255 [139.54], Avg: 145.0642 (0.050)
Ep: 148, Reward: 769.8412, Test: 683.8275 [194.17], Avg: 147.3770 (0.049)
Ep: 149, Reward: 782.9094, Test: 700.1491 [184.84], Avg: 149.8299 (0.048)
Ep: 150, Reward: 792.7674, Test: 778.9061 [161.06], Avg: 152.9293 (0.047)
Ep: 151, Reward: 670.7658, Test: 793.8628 [163.90], Avg: 156.0676 (0.046)
Ep: 152, Reward: 683.2602, Test: 789.8734 [137.10], Avg: 159.3141 (0.045)
Ep: 153, Reward: 726.5816, Test: 648.2457 [231.26], Avg: 160.9873 (0.045)
Ep: 154, Reward: 695.7401, Test: 610.9447 [177.01], Avg: 162.7482 (0.044)
Ep: 155, Reward: 711.9753, Test: 719.4397 [225.00], Avg: 164.8744 (0.043)
Ep: 156, Reward: 702.0469, Test: 658.6662 [233.57], Avg: 166.5319 (0.042)
Ep: 157, Reward: 640.4915, Test: 792.5915 [168.38], Avg: 169.4286 (0.041)
Ep: 158, Reward: 687.0783, Test: 733.3797 [150.34], Avg: 172.0299 (0.040)
Ep: 159, Reward: 878.3743, Test: 689.8426 [254.90], Avg: 173.6731 (0.039)
Ep: 160, Reward: 776.2184, Test: 807.4851 [104.37], Avg: 176.9616 (0.039)
Ep: 161, Reward: 855.4613, Test: 850.5321 [26.86], Avg: 180.9537 (0.038)
Ep: 162, Reward: 728.0575, Test: 755.7369 [177.60], Avg: 183.3904 (0.037)
Ep: 163, Reward: 809.8295, Test: 799.3137 [105.79], Avg: 186.5009 (0.036)
Ep: 164, Reward: 834.9016, Test: 839.8360 [87.89], Avg: 189.9279 (0.036)
Ep: 165, Reward: 835.3905, Test: 846.8371 [39.60], Avg: 193.6466 (0.035)
Ep: 166, Reward: 787.7520, Test: 692.4633 [208.48], Avg: 195.3851 (0.034)
Ep: 167, Reward: 780.3567, Test: 726.9372 [172.73], Avg: 197.5209 (0.034)
Ep: 168, Reward: 754.2875, Test: 592.2909 [225.64], Avg: 198.5217 (0.033)
Ep: 169, Reward: 732.6512, Test: 714.6326 [147.63], Avg: 200.6892 (0.032)
Ep: 170, Reward: 667.2016, Test: 784.8243 [129.81], Avg: 203.3461 (0.032)
Ep: 171, Reward: 770.5507, Test: 774.4653 [95.62], Avg: 206.1106 (0.031)
Ep: 172, Reward: 835.8272, Test: 859.5980 [31.63], Avg: 209.7051 (0.030)
Ep: 173, Reward: 832.7711, Test: 790.5396 [132.93], Avg: 212.2793 (0.030)
Ep: 174, Reward: 792.4648, Test: 827.6480 [67.48], Avg: 215.4101 (0.029)
Ep: 175, Reward: 906.9279, Test: 825.7264 [64.72], Avg: 218.5100 (0.029)
Ep: 176, Reward: 887.9159, Test: 861.0596 [37.23], Avg: 221.9300 (0.028)
Ep: 177, Reward: 891.3192, Test: 871.7665 [49.39], Avg: 225.3032 (0.027)
Ep: 178, Reward: 882.1796, Test: 851.8139 [100.56], Avg: 228.2415 (0.027)
Ep: 179, Reward: 890.4788, Test: 809.8621 [121.92], Avg: 230.7954 (0.026)
Ep: 180, Reward: 873.5545, Test: 882.0283 [37.48], Avg: 234.1863 (0.026)
Ep: 181, Reward: 814.0049, Test: 752.0407 [135.88], Avg: 236.2850 (0.025)
Ep: 182, Reward: 816.7245, Test: 720.8672 [184.80], Avg: 237.9232 (0.025)
Ep: 183, Reward: 850.9550, Test: 780.2850 [170.16], Avg: 239.9460 (0.024)
Ep: 184, Reward: 759.7431, Test: 804.5468 [166.77], Avg: 242.0965 (0.024)
Ep: 185, Reward: 855.4047, Test: 856.1176 [31.74], Avg: 245.2270 (0.023)
Ep: 186, Reward: 922.4865, Test: 870.7501 [29.67], Avg: 248.4134 (0.023)
Ep: 187, Reward: 895.7790, Test: 833.2873 [71.90], Avg: 251.1420 (0.022)
Ep: 188, Reward: 918.8971, Test: 867.8822 [41.91], Avg: 254.1834 (0.022)
Ep: 189, Reward: 1010.2369, Test: 865.6491 [30.50], Avg: 257.2411 (0.022)
Ep: 190, Reward: 983.8508, Test: 891.7583 [19.25], Avg: 260.4624 (0.021)
Ep: 191, Reward: 1028.3531, Test: 790.5531 [203.35], Avg: 262.1642 (0.021)
Ep: 192, Reward: 908.0380, Test: 864.4370 [44.57], Avg: 265.0539 (0.020)
Ep: 193, Reward: 961.0896, Test: 877.7651 [26.84], Avg: 268.0738 (0.020)
Ep: 194, Reward: 1034.2831, Test: 881.6930 [76.10], Avg: 270.8303 (0.020)
Ep: 195, Reward: 949.9829, Test: 875.8836 [16.50], Avg: 273.8332 (0.020)
Ep: 196, Reward: 861.9985, Test: 897.3909 [23.95], Avg: 276.8768 (0.020)
Ep: 197, Reward: 914.0422, Test: 892.2653 [24.16], Avg: 279.8628 (0.020)
Ep: 198, Reward: 918.5559, Test: 902.1732 [23.71], Avg: 282.8709 (0.020)
Ep: 199, Reward: 1019.1083, Test: 853.5754 [116.56], Avg: 285.1416 (0.020)
Ep: 200, Reward: 1072.0830, Test: 895.5382 [31.66], Avg: 288.0209 (0.020)
Ep: 201, Reward: 988.8584, Test: 818.7687 [147.42], Avg: 289.9185 (0.020)
Ep: 202, Reward: 887.3809, Test: 843.3305 [69.80], Avg: 292.3009 (0.020)
Ep: 203, Reward: 921.2694, Test: 843.1366 [117.80], Avg: 294.4236 (0.020)
Ep: 204, Reward: 790.3298, Test: 876.8319 [92.78], Avg: 296.8120 (0.020)
Ep: 205, Reward: 1053.6623, Test: 884.8236 [49.62], Avg: 299.4256 (0.020)
Ep: 206, Reward: 862.1638, Test: 864.2297 [64.97], Avg: 301.8402 (0.020)
Ep: 207, Reward: 949.2223, Test: 880.0200 [21.83], Avg: 304.5150 (0.020)
Ep: 208, Reward: 944.2063, Test: 858.4097 [48.44], Avg: 306.9334 (0.020)
Ep: 209, Reward: 909.4568, Test: 873.4675 [14.53], Avg: 309.5621 (0.020)
Ep: 210, Reward: 976.1681, Test: 872.9291 [53.59], Avg: 311.9781 (0.020)
Ep: 211, Reward: 982.9377, Test: 848.7673 [175.13], Avg: 313.6840 (0.020)
Ep: 212, Reward: 922.7195, Test: 876.9959 [42.89], Avg: 316.1273 (0.020)
Ep: 213, Reward: 868.8778, Test: 834.2916 [130.70], Avg: 317.9379 (0.020)
Ep: 214, Reward: 950.7028, Test: 905.2628 [20.18], Avg: 320.5758 (0.020)
Ep: 215, Reward: 1136.6328, Test: 848.1706 [158.56], Avg: 322.2843 (0.020)
Ep: 216, Reward: 866.9715, Test: 906.7042 [22.28], Avg: 324.8748 (0.020)
Ep: 217, Reward: 1111.1092, Test: 875.4992 [72.12], Avg: 327.0697 (0.020)
Ep: 218, Reward: 929.8256, Test: 888.3288 [21.92], Avg: 329.5325 (0.020)
Ep: 219, Reward: 1108.5201, Test: 845.3624 [81.07], Avg: 331.5087 (0.020)
Ep: 220, Reward: 1078.7628, Test: 875.1315 [81.12], Avg: 333.6014 (0.020)
Ep: 221, Reward: 794.0789, Test: 825.7465 [191.99], Avg: 334.9535 (0.020)
Ep: 222, Reward: 1031.1091, Test: 874.3944 [64.04], Avg: 337.0853 (0.020)
Ep: 223, Reward: 937.6780, Test: 917.9350 [20.20], Avg: 339.5882 (0.020)
Ep: 224, Reward: 1036.8493, Test: 882.8648 [67.84], Avg: 341.7012 (0.020)
Ep: 225, Reward: 943.3046, Test: 917.2349 [19.93], Avg: 344.1597 (0.020)
Ep: 226, Reward: 1109.1385, Test: 915.4804 [13.67], Avg: 346.6163 (0.020)
Ep: 227, Reward: 1004.1545, Test: 891.5174 [21.64], Avg: 348.9113 (0.020)
Ep: 228, Reward: 984.8755, Test: 828.4279 [132.21], Avg: 350.4279 (0.020)
Ep: 229, Reward: 911.2340, Test: 869.4775 [82.51], Avg: 352.3259 (0.020)
Ep: 230, Reward: 951.8535, Test: 884.8453 [28.47], Avg: 354.5079 (0.020)
Ep: 231, Reward: 997.7463, Test: 891.5703 [22.76], Avg: 356.7247 (0.020)
Ep: 232, Reward: 985.8085, Test: 906.8579 [22.84], Avg: 358.9877 (0.020)
Ep: 233, Reward: 962.4369, Test: 871.6767 [19.98], Avg: 361.0933 (0.020)
Ep: 234, Reward: 1041.1185, Test: 906.0825 [16.98], Avg: 363.3402 (0.020)
Ep: 235, Reward: 1006.0446, Test: 893.0572 [45.37], Avg: 365.3925 (0.020)
Ep: 236, Reward: 1043.9792, Test: 900.7503 [44.09], Avg: 367.4653 (0.020)
Ep: 237, Reward: 989.9411, Test: 914.4627 [32.82], Avg: 369.6257 (0.020)
Ep: 238, Reward: 985.8740, Test: 804.8487 [233.23], Avg: 370.4709 (0.020)
Ep: 239, Reward: 1014.5065, Test: 908.0906 [27.94], Avg: 372.5946 (0.020)
Ep: 240, Reward: 1046.3113, Test: 891.6917 [46.42], Avg: 374.5559 (0.020)
Ep: 241, Reward: 972.1324, Test: 886.1131 [24.59], Avg: 376.5681 (0.020)
Ep: 242, Reward: 937.1386, Test: 891.2185 [15.60], Avg: 378.6218 (0.020)
Ep: 243, Reward: 1024.0746, Test: 809.6047 [181.11], Avg: 379.6459 (0.020)
Ep: 244, Reward: 1033.1483, Test: 831.9554 [150.77], Avg: 380.8766 (0.020)
Ep: 245, Reward: 929.9176, Test: 807.5336 [176.10], Avg: 381.8951 (0.020)
Ep: 246, Reward: 1064.9018, Test: 922.0681 [14.34], Avg: 384.0240 (0.020)
Ep: 247, Reward: 1062.9746, Test: 880.0184 [146.37], Avg: 385.4338 (0.020)
Ep: 248, Reward: 981.5694, Test: 884.0043 [100.27], Avg: 387.0334 (0.020)
Ep: 249, Reward: 1142.5361, Test: 918.4716 [11.10], Avg: 389.1148 (0.020)
Ep: 250, Reward: 1138.0959, Test: 903.7987 [20.81], Avg: 391.0824 (0.020)
Ep: 251, Reward: 1096.8799, Test: 920.1030 [12.59], Avg: 393.1318 (0.020)
Ep: 252, Reward: 1004.1957, Test: 910.6767 [15.47], Avg: 395.1162 (0.020)
Ep: 253, Reward: 1016.8848, Test: 847.3039 [196.32], Avg: 396.1236 (0.020)
Ep: 254, Reward: 1042.3030, Test: 848.8002 [122.96], Avg: 397.4166 (0.020)
Ep: 255, Reward: 1065.5803, Test: 850.0017 [161.06], Avg: 398.5554 (0.020)
Ep: 256, Reward: 1001.9823, Test: 819.3201 [156.64], Avg: 399.5831 (0.020)
Ep: 257, Reward: 971.2954, Test: 760.1686 [210.84], Avg: 400.1635 (0.020)
Ep: 258, Reward: 753.3940, Test: 635.4788 [234.26], Avg: 400.1676 (0.020)
Ep: 259, Reward: 777.1996, Test: 848.5925 [102.08], Avg: 401.4997 (0.020)
Ep: 260, Reward: 981.3526, Test: 779.2640 [241.58], Avg: 402.0214 (0.020)
Ep: 261, Reward: 939.8487, Test: 740.4179 [244.50], Avg: 402.3798 (0.020)
Ep: 262, Reward: 718.9659, Test: 717.8055 [196.41], Avg: 402.8323 (0.020)
Ep: 263, Reward: 762.7859, Test: 633.6050 [278.09], Avg: 402.6531 (0.020)
Ep: 264, Reward: 691.3770, Test: 774.6283 [214.31], Avg: 403.2481 (0.020)
Ep: 265, Reward: 821.1923, Test: 812.4405 [205.43], Avg: 404.0141 (0.020)
Ep: 266, Reward: 788.4307, Test: 676.5555 [300.01], Avg: 403.9112 (0.020)
Ep: 267, Reward: 834.4116, Test: 628.1361 [240.29], Avg: 403.8513 (0.020)
Ep: 268, Reward: 650.8782, Test: 814.4789 [80.30], Avg: 405.0793 (0.020)
Ep: 269, Reward: 833.7170, Test: 830.4777 [189.52], Avg: 405.9529 (0.020)
Ep: 270, Reward: 792.3842, Test: 754.9762 [164.44], Avg: 406.6340 (0.020)
Ep: 271, Reward: 796.7607, Test: 799.7819 [120.39], Avg: 407.6368 (0.020)
Ep: 272, Reward: 809.5246, Test: 764.0192 [235.32], Avg: 408.0803 (0.020)
Ep: 273, Reward: 850.5747, Test: 878.4479 [45.86], Avg: 409.6296 (0.020)
Ep: 274, Reward: 825.8411, Test: 778.8656 [206.91], Avg: 410.2199 (0.020)
Ep: 275, Reward: 800.1088, Test: 741.6287 [257.56], Avg: 410.4874 (0.020)
Ep: 276, Reward: 720.2099, Test: 876.7138 [15.59], Avg: 412.1143 (0.020)
Ep: 277, Reward: 829.0825, Test: 808.9509 [159.44], Avg: 412.9682 (0.020)
Ep: 278, Reward: 818.9953, Test: 747.8053 [262.76], Avg: 413.2265 (0.020)
Ep: 279, Reward: 902.6815, Test: 878.1087 [12.69], Avg: 414.8415 (0.020)
Ep: 280, Reward: 892.5121, Test: 781.6488 [204.65], Avg: 415.4186 (0.020)
Ep: 281, Reward: 870.4696, Test: 874.4841 [17.37], Avg: 416.9849 (0.020)
Ep: 282, Reward: 871.8961, Test: 832.0752 [17.55], Avg: 418.3896 (0.020)
Ep: 283, Reward: 801.1445, Test: 810.3519 [183.18], Avg: 419.1247 (0.020)
Ep: 284, Reward: 892.6307, Test: 833.4512 [131.02], Avg: 420.1188 (0.020)
Ep: 285, Reward: 957.0984, Test: 877.7109 [102.72], Avg: 421.3596 (0.020)
Ep: 286, Reward: 931.2371, Test: 878.6774 [19.87], Avg: 422.8838 (0.020)
Ep: 287, Reward: 980.7843, Test: 796.6469 [256.50], Avg: 423.2910 (0.020)
Ep: 288, Reward: 971.9952, Test: 788.9282 [221.08], Avg: 423.7912 (0.020)
Ep: 289, Reward: 655.8250, Test: 856.5778 [57.53], Avg: 425.0852 (0.020)
Ep: 290, Reward: 823.1893, Test: 839.2299 [148.63], Avg: 425.9976 (0.020)
Ep: 291, Reward: 717.8298, Test: 722.8878 [210.44], Avg: 426.2937 (0.020)
Ep: 292, Reward: 808.6191, Test: 882.7038 [23.88], Avg: 427.7699 (0.020)
Ep: 293, Reward: 888.0347, Test: 831.5035 [154.54], Avg: 428.6175 (0.020)
Ep: 294, Reward: 853.5111, Test: 806.6898 [182.57], Avg: 429.2802 (0.020)
Ep: 295, Reward: 945.3840, Test: 716.8577 [224.65], Avg: 429.4928 (0.020)
Ep: 296, Reward: 1013.9171, Test: 813.2510 [173.08], Avg: 430.2022 (0.020)
Ep: 297, Reward: 944.3780, Test: 884.9408 [17.10], Avg: 431.6707 (0.020)
Ep: 298, Reward: 870.3195, Test: 882.0306 [21.21], Avg: 433.1060 (0.020)
Ep: 299, Reward: 878.8924, Test: 882.1154 [16.01], Avg: 434.5494 (0.020)
Ep: 300, Reward: 924.1012, Test: 886.0795 [19.34], Avg: 435.9852 (0.020)
Ep: 301, Reward: 1041.8784, Test: 890.2457 [22.86], Avg: 437.4137 (0.020)
Ep: 302, Reward: 850.4959, Test: 833.2812 [147.57], Avg: 438.2332 (0.020)
Ep: 303, Reward: 903.8206, Test: 754.8243 [204.02], Avg: 438.6035 (0.020)
Ep: 304, Reward: 855.7917, Test: 882.2039 [56.53], Avg: 439.8726 (0.020)
Ep: 305, Reward: 882.9352, Test: 747.4160 [152.33], Avg: 440.3798 (0.020)
Ep: 306, Reward: 783.0217, Test: 692.8631 [233.80], Avg: 440.4406 (0.020)
Ep: 307, Reward: 937.1833, Test: 868.6275 [17.08], Avg: 441.7754 (0.020)
Ep: 308, Reward: 720.9457, Test: 788.1455 [214.66], Avg: 442.2017 (0.020)
Ep: 309, Reward: 921.7789, Test: 779.8882 [213.75], Avg: 442.6015 (0.020)
Ep: 310, Reward: 905.9822, Test: 878.0894 [54.95], Avg: 443.8251 (0.020)
Ep: 311, Reward: 765.9947, Test: 885.1549 [23.78], Avg: 445.1634 (0.020)
Ep: 312, Reward: 902.9139, Test: 900.9816 [20.57], Avg: 446.5539 (0.020)
Ep: 313, Reward: 835.3708, Test: 824.1176 [171.78], Avg: 447.2093 (0.020)
Ep: 314, Reward: 901.3970, Test: 731.1463 [179.96], Avg: 447.5394 (0.020)
Ep: 315, Reward: 858.9250, Test: 861.2155 [47.20], Avg: 448.6991 (0.020)
Ep: 316, Reward: 820.3569, Test: 818.2810 [81.90], Avg: 449.6066 (0.020)
Ep: 317, Reward: 828.3415, Test: 840.5138 [50.97], Avg: 450.6756 (0.020)
Ep: 318, Reward: 864.6005, Test: 877.1125 [9.55], Avg: 451.9824 (0.020)
Ep: 319, Reward: 885.3886, Test: 887.2482 [31.41], Avg: 453.2445 (0.020)
Ep: 320, Reward: 901.4774, Test: 884.3163 [51.85], Avg: 454.4259 (0.020)
Ep: 321, Reward: 922.8309, Test: 865.6071 [53.99], Avg: 455.5352 (0.020)
Ep: 322, Reward: 864.7887, Test: 844.5596 [66.84], Avg: 456.5326 (0.020)
Ep: 323, Reward: 832.4370, Test: 779.7982 [132.56], Avg: 457.1212 (0.020)
Ep: 324, Reward: 824.3501, Test: 808.4117 [155.31], Avg: 457.7243 (0.020)
Ep: 325, Reward: 814.9538, Test: 876.7571 [14.00], Avg: 458.9667 (0.020)
Ep: 326, Reward: 880.0391, Test: 780.0987 [159.73], Avg: 459.4603 (0.020)
Ep: 327, Reward: 811.7189, Test: 847.7365 [64.01], Avg: 460.4489 (0.020)
Ep: 328, Reward: 856.2808, Test: 787.2050 [118.16], Avg: 461.0829 (0.020)
Ep: 329, Reward: 823.7202, Test: 845.3722 [134.97], Avg: 461.8385 (0.020)
Ep: 330, Reward: 896.8442, Test: 801.2318 [283.25], Avg: 462.0081 (0.020)
Ep: 331, Reward: 903.5599, Test: 807.9100 [201.04], Avg: 462.4444 (0.020)
Ep: 332, Reward: 908.4120, Test: 852.5616 [117.12], Avg: 463.2642 (0.020)
Ep: 333, Reward: 885.7390, Test: 802.9570 [274.48], Avg: 463.4595 (0.020)
Ep: 334, Reward: 957.1911, Test: 740.1605 [285.59], Avg: 463.4329 (0.020)
Ep: 335, Reward: 922.2424, Test: 873.1835 [37.29], Avg: 464.5415 (0.020)
Ep: 336, Reward: 859.8466, Test: 802.7046 [114.33], Avg: 465.2057 (0.020)
Ep: 337, Reward: 735.0222, Test: 732.3505 [252.35], Avg: 465.2494 (0.020)
Ep: 338, Reward: 861.9306, Test: 860.0310 [52.36], Avg: 466.2595 (0.020)
Ep: 339, Reward: 733.7066, Test: 871.0334 [15.01], Avg: 467.4059 (0.020)
Ep: 340, Reward: 755.4266, Test: 791.8758 [162.59], Avg: 467.8806 (0.020)
Ep: 341, Reward: 944.8270, Test: 878.8461 [23.81], Avg: 469.0127 (0.020)
Ep: 342, Reward: 898.5143, Test: 892.8929 [22.88], Avg: 470.1818 (0.020)
Ep: 343, Reward: 913.7254, Test: 884.7413 [31.98], Avg: 471.2939 (0.020)
Ep: 344, Reward: 744.8443, Test: 774.2987 [226.63], Avg: 471.5153 (0.020)
Ep: 345, Reward: 919.3298, Test: 723.5762 [190.29], Avg: 471.6938 (0.020)
Ep: 346, Reward: 856.0297, Test: 902.1357 [22.98], Avg: 472.8681 (0.020)
Ep: 347, Reward: 1062.1248, Test: 888.8181 [25.94], Avg: 473.9888 (0.020)
Ep: 348, Reward: 936.6596, Test: 883.0449 [18.42], Avg: 475.1081 (0.020)
Ep: 349, Reward: 1001.0135, Test: 892.4575 [18.61], Avg: 476.2473 (0.020)
Ep: 350, Reward: 910.8267, Test: 882.7339 [15.56], Avg: 477.3611 (0.020)
Ep: 351, Reward: 900.6014, Test: 876.3786 [45.71], Avg: 478.3648 (0.020)
Ep: 352, Reward: 924.6909, Test: 894.1622 [11.43], Avg: 479.5103 (0.020)
Ep: 353, Reward: 981.4544, Test: 908.2016 [20.07], Avg: 480.6646 (0.020)
Ep: 354, Reward: 1049.4943, Test: 895.7897 [16.36], Avg: 481.7879 (0.020)
Ep: 355, Reward: 1034.5671, Test: 909.0890 [11.92], Avg: 482.9547 (0.020)
Ep: 356, Reward: 1086.2429, Test: 904.7881 [15.25], Avg: 484.0936 (0.020)
Ep: 357, Reward: 1019.2387, Test: 741.7146 [327.46], Avg: 483.8985 (0.020)
Ep: 358, Reward: 1083.0839, Test: 831.2886 [262.44], Avg: 484.1352 (0.020)
Ep: 359, Reward: 1075.5138, Test: 907.9208 [17.50], Avg: 485.2637 (0.020)
Ep: 360, Reward: 1094.0128, Test: 882.8205 [31.38], Avg: 486.2781 (0.020)
Ep: 361, Reward: 902.5585, Test: 686.0832 [286.00], Avg: 486.0399 (0.020)
Ep: 362, Reward: 728.9642, Test: 712.3572 [178.30], Avg: 486.1722 (0.020)
Ep: 363, Reward: 943.2422, Test: 867.1497 [61.59], Avg: 487.0497 (0.020)
Ep: 364, Reward: 751.3480, Test: 864.8919 [36.73], Avg: 487.9842 (0.020)
Ep: 365, Reward: 885.1976, Test: 871.1458 [90.10], Avg: 488.7849 (0.020)
Ep: 366, Reward: 988.1784, Test: 895.2391 [28.42], Avg: 489.8150 (0.020)
Ep: 367, Reward: 912.1992, Test: 905.1888 [33.29], Avg: 490.8532 (0.020)
Ep: 368, Reward: 1011.2145, Test: 794.3743 [181.45], Avg: 491.1841 (0.020)
Ep: 369, Reward: 1013.8517, Test: 864.1141 [129.03], Avg: 491.8433 (0.020)
Ep: 370, Reward: 969.1316, Test: 887.1647 [33.26], Avg: 492.8192 (0.020)
Ep: 371, Reward: 906.3891, Test: 883.7976 [32.83], Avg: 493.7819 (0.020)
Ep: 372, Reward: 861.4592, Test: 737.9014 [213.78], Avg: 493.8633 (0.020)
Ep: 373, Reward: 850.2721, Test: 775.9298 [216.48], Avg: 494.0386 (0.020)
Ep: 374, Reward: 938.0418, Test: 847.6948 [138.06], Avg: 494.6136 (0.020)
Ep: 375, Reward: 887.8936, Test: 897.6113 [20.18], Avg: 495.6317 (0.020)
Ep: 376, Reward: 973.7736, Test: 866.6278 [114.27], Avg: 496.3127 (0.020)
Ep: 377, Reward: 979.5062, Test: 893.5740 [37.64], Avg: 497.2641 (0.020)
Ep: 378, Reward: 946.8710, Test: 907.0206 [33.24], Avg: 498.2575 (0.020)
Ep: 379, Reward: 1053.1124, Test: 902.2328 [18.96], Avg: 499.2707 (0.020)
Ep: 380, Reward: 904.3471, Test: 847.6172 [76.87], Avg: 499.9832 (0.020)
Ep: 381, Reward: 898.5085, Test: 879.8196 [31.83], Avg: 500.8943 (0.020)
Ep: 382, Reward: 878.2684, Test: 879.4360 [20.53], Avg: 501.8290 (0.020)
Ep: 383, Reward: 910.3707, Test: 802.3520 [135.67], Avg: 502.2583 (0.020)
Ep: 384, Reward: 865.5097, Test: 835.2933 [134.57], Avg: 502.7738 (0.020)
Ep: 385, Reward: 855.4576, Test: 852.4918 [108.99], Avg: 503.3975 (0.020)
Ep: 386, Reward: 885.9687, Test: 828.7402 [107.74], Avg: 503.9597 (0.020)
Ep: 387, Reward: 844.6491, Test: 802.9208 [194.22], Avg: 504.2297 (0.020)
Ep: 388, Reward: 885.5465, Test: 868.5783 [33.33], Avg: 505.0807 (0.020)
Ep: 389, Reward: 903.4655, Test: 882.9919 [18.14], Avg: 506.0032 (0.020)
Ep: 390, Reward: 827.2740, Test: 710.3822 [244.40], Avg: 505.9008 (0.020)
Ep: 391, Reward: 901.4472, Test: 860.0710 [55.91], Avg: 506.6617 (0.020)
Ep: 392, Reward: 879.6490, Test: 893.8092 [24.50], Avg: 507.5844 (0.020)
Ep: 393, Reward: 952.3610, Test: 692.6268 [218.83], Avg: 507.4987 (0.020)
Ep: 394, Reward: 693.2867, Test: 685.4251 [156.81], Avg: 507.5521 (0.020)
Ep: 395, Reward: 763.1568, Test: 555.3388 [185.77], Avg: 507.2037 (0.020)
Ep: 396, Reward: 719.8505, Test: 653.0415 [193.77], Avg: 507.0830 (0.020)
Ep: 397, Reward: 618.0664, Test: 604.9296 [233.07], Avg: 506.7432 (0.020)
Ep: 398, Reward: 689.1114, Test: 685.1756 [246.20], Avg: 506.5734 (0.020)
Ep: 399, Reward: 818.2997, Test: 778.5883 [243.52], Avg: 506.6446 (0.020)
Ep: 400, Reward: 844.2087, Test: 743.4201 [177.51], Avg: 506.7924 (0.020)
Ep: 401, Reward: 800.6105, Test: 866.2337 [122.15], Avg: 507.3827 (0.020)
Ep: 402, Reward: 970.2005, Test: 716.7044 [256.15], Avg: 507.2665 (0.020)
Ep: 403, Reward: 671.7721, Test: 780.1495 [202.55], Avg: 507.4406 (0.020)
Ep: 404, Reward: 616.9983, Test: 649.4130 [291.96], Avg: 507.0703 (0.020)
Ep: 405, Reward: 752.0878, Test: 814.9910 [147.27], Avg: 507.4659 (0.020)
Ep: 406, Reward: 847.9062, Test: 889.2225 [23.56], Avg: 508.3460 (0.020)
Ep: 407, Reward: 820.7732, Test: 886.7778 [58.11], Avg: 509.1311 (0.020)
Ep: 408, Reward: 912.5765, Test: 716.3283 [231.96], Avg: 509.0706 (0.020)
Ep: 409, Reward: 881.5716, Test: 846.3546 [87.32], Avg: 509.6802 (0.020)
Ep: 410, Reward: 856.0787, Test: 715.5063 [216.00], Avg: 509.6555 (0.020)
Ep: 411, Reward: 978.4593, Test: 744.9131 [232.76], Avg: 509.6615 (0.020)
Ep: 412, Reward: 761.3151, Test: 877.4869 [15.76], Avg: 510.5140 (0.020)
Ep: 413, Reward: 902.2571, Test: 868.5270 [71.14], Avg: 511.2069 (0.020)
Ep: 414, Reward: 888.6153, Test: 859.3196 [108.60], Avg: 511.7841 (0.020)
Ep: 415, Reward: 870.2907, Test: 880.2547 [16.58], Avg: 512.6300 (0.020)
Ep: 416, Reward: 864.3867, Test: 907.9527 [17.98], Avg: 513.5349 (0.020)
Ep: 417, Reward: 953.3278, Test: 896.5444 [18.61], Avg: 514.4066 (0.020)
Ep: 418, Reward: 1092.4902, Test: 883.6887 [82.34], Avg: 515.0914 (0.020)
Ep: 419, Reward: 1111.9290, Test: 543.1422 [318.93], Avg: 514.3989 (0.020)
Ep: 420, Reward: 720.6744, Test: 583.5735 [311.19], Avg: 513.8240 (0.020)
Ep: 421, Reward: 597.2840, Test: 584.5252 [255.45], Avg: 513.3862 (0.020)
Ep: 422, Reward: 624.0959, Test: 580.3872 [234.23], Avg: 512.9909 (0.020)
Ep: 423, Reward: 678.8656, Test: 608.0723 [227.51], Avg: 512.6785 (0.020)
Ep: 424, Reward: 842.5430, Test: 826.4528 [144.58], Avg: 513.0767 (0.020)
Ep: 425, Reward: 810.5328, Test: 852.8961 [141.05], Avg: 513.5432 (0.020)
Ep: 426, Reward: 957.7612, Test: 779.9847 [204.09], Avg: 513.6893 (0.020)
Ep: 427, Reward: 950.4809, Test: 729.4083 [207.55], Avg: 513.7084 (0.020)
Ep: 428, Reward: 875.3624, Test: 868.4170 [86.75], Avg: 514.3330 (0.020)
Ep: 429, Reward: 1133.0869, Test: 924.2006 [11.37], Avg: 515.2597 (0.020)
Ep: 430, Reward: 1000.6555, Test: 924.8500 [5.63], Avg: 516.1970 (0.020)
Ep: 431, Reward: 1074.9587, Test: 876.7705 [114.21], Avg: 516.7673 (0.020)
Ep: 432, Reward: 913.3492, Test: 880.7036 [14.34], Avg: 517.5747 (0.020)
Ep: 433, Reward: 853.5256, Test: 901.3710 [26.90], Avg: 518.3970 (0.020)
Ep: 434, Reward: 1059.2975, Test: 917.4438 [17.87], Avg: 519.2733 (0.020)
Ep: 435, Reward: 1150.5746, Test: 792.3053 [199.72], Avg: 519.4414 (0.020)
Ep: 436, Reward: 930.9037, Test: 899.2407 [25.41], Avg: 520.2524 (0.020)
Ep: 437, Reward: 994.7371, Test: 919.9173 [19.88], Avg: 521.1195 (0.020)
Ep: 438, Reward: 1047.0534, Test: 733.1656 [262.38], Avg: 521.0048 (0.020)
Ep: 439, Reward: 1059.4127, Test: 825.0935 [208.43], Avg: 521.2222 (0.020)
Ep: 440, Reward: 995.2943, Test: 766.6974 [267.60], Avg: 521.1721 (0.020)
Ep: 441, Reward: 840.9387, Test: 732.3939 [238.86], Avg: 521.1095 (0.020)
Ep: 442, Reward: 875.8315, Test: 839.3406 [111.79], Avg: 521.5755 (0.020)
Ep: 443, Reward: 953.1043, Test: 625.9229 [304.22], Avg: 521.1254 (0.020)
Ep: 444, Reward: 890.7827, Test: 857.6366 [224.19], Avg: 521.3778 (0.020)
Ep: 445, Reward: 727.3967, Test: 784.2627 [167.96], Avg: 521.5906 (0.020)
Ep: 446, Reward: 798.5837, Test: 672.2527 [238.57], Avg: 521.3940 (0.020)
Ep: 447, Reward: 984.8178, Test: 813.6132 [184.14], Avg: 521.6352 (0.020)
Ep: 448, Reward: 1171.3531, Test: 821.3935 [202.48], Avg: 521.8519 (0.020)
Ep: 449, Reward: 1057.3607, Test: 727.4015 [296.16], Avg: 521.6505 (0.020)
Ep: 450, Reward: 1067.2720, Test: 833.4566 [216.67], Avg: 521.8615 (0.020)
Ep: 451, Reward: 1147.1925, Test: 872.3209 [123.97], Avg: 522.3625 (0.020)
Ep: 452, Reward: 1017.5656, Test: 802.9820 [190.32], Avg: 522.5619 (0.020)
Ep: 453, Reward: 866.5207, Test: 869.7914 [102.44], Avg: 523.1011 (0.020)
Ep: 454, Reward: 1027.7750, Test: 893.3665 [70.49], Avg: 523.7599 (0.020)
Ep: 455, Reward: 1018.0479, Test: 903.5309 [28.85], Avg: 524.5295 (0.020)
Ep: 456, Reward: 1017.9775, Test: 903.8653 [15.11], Avg: 525.3265 (0.020)
Ep: 457, Reward: 1017.4816, Test: 882.5956 [31.87], Avg: 526.0369 (0.020)
Ep: 458, Reward: 934.4025, Test: 820.3604 [175.44], Avg: 526.2959 (0.020)
Ep: 459, Reward: 844.7648, Test: 889.9872 [12.85], Avg: 527.0586 (0.020)
Ep: 460, Reward: 915.7951, Test: 803.5584 [153.44], Avg: 527.3256 (0.020)
Ep: 461, Reward: 918.6093, Test: 804.0864 [214.31], Avg: 527.4608 (0.020)
Ep: 462, Reward: 1021.8792, Test: 670.0098 [356.01], Avg: 526.9997 (0.020)
Ep: 463, Reward: 984.6601, Test: 845.9217 [233.21], Avg: 527.1845 (0.020)
Ep: 464, Reward: 886.6141, Test: 708.1104 [351.97], Avg: 526.8166 (0.020)
Ep: 465, Reward: 1028.4539, Test: 578.5799 [398.42], Avg: 526.0727 (0.020)
Ep: 466, Reward: 801.5802, Test: 914.7380 [22.44], Avg: 526.8569 (0.020)
Ep: 467, Reward: 960.2635, Test: 886.0020 [87.89], Avg: 527.4365 (0.020)
Ep: 468, Reward: 1058.6864, Test: 803.5819 [214.51], Avg: 527.5680 (0.020)
Ep: 469, Reward: 998.6331, Test: 888.5874 [29.09], Avg: 528.2742 (0.020)
Ep: 470, Reward: 964.6753, Test: 862.7321 [55.19], Avg: 528.8671 (0.020)
Ep: 471, Reward: 992.2457, Test: 909.4774 [20.73], Avg: 529.6296 (0.020)
Ep: 472, Reward: 920.5456, Test: 833.9523 [210.44], Avg: 529.8281 (0.020)
Ep: 473, Reward: 842.4750, Test: 615.4025 [315.26], Avg: 529.3435 (0.020)
Ep: 474, Reward: 943.3369, Test: 735.4704 [158.30], Avg: 529.4442 (0.020)
Ep: 475, Reward: 801.1165, Test: 699.8651 [199.12], Avg: 529.3839 (0.020)
Ep: 476, Reward: 697.1388, Test: 660.9020 [267.18], Avg: 529.0995 (0.020)
Ep: 477, Reward: 801.3799, Test: 749.9997 [269.09], Avg: 528.9987 (0.020)
Ep: 478, Reward: 838.9073, Test: 737.9756 [200.39], Avg: 529.0166 (0.020)
Ep: 479, Reward: 658.6435, Test: 855.7467 [125.24], Avg: 529.4364 (0.020)
Ep: 480, Reward: 897.5851, Test: 786.5668 [159.80], Avg: 529.6387 (0.020)
Ep: 481, Reward: 916.7301, Test: 806.9168 [204.04], Avg: 529.7907 (0.020)
Ep: 482, Reward: 923.9631, Test: 809.4536 [221.52], Avg: 529.9111 (0.020)
Ep: 483, Reward: 889.5108, Test: 746.6496 [177.91], Avg: 529.9913 (0.020)
Ep: 484, Reward: 822.7617, Test: 801.6388 [117.33], Avg: 530.3095 (0.020)
Ep: 485, Reward: 753.5739, Test: 684.2533 [227.69], Avg: 530.1577 (0.020)
Ep: 486, Reward: 750.3548, Test: 690.2424 [278.47], Avg: 529.9146 (0.020)
Ep: 487, Reward: 944.7908, Test: 801.5068 [197.93], Avg: 530.0656 (0.020)
Ep: 488, Reward: 923.9671, Test: 829.5272 [67.52], Avg: 530.5399 (0.020)
Ep: 489, Reward: 882.4041, Test: 874.7165 [11.59], Avg: 531.2186 (0.020)
Ep: 490, Reward: 886.8005, Test: 749.3868 [192.15], Avg: 531.2716 (0.020)
Ep: 491, Reward: 973.4216, Test: 749.2276 [276.39], Avg: 531.1529 (0.020)
Ep: 492, Reward: 905.8236, Test: 657.6989 [278.89], Avg: 530.8439 (0.020)
Ep: 493, Reward: 915.5119, Test: 883.6751 [70.75], Avg: 531.4149 (0.020)
Ep: 494, Reward: 948.4978, Test: 863.8414 [57.06], Avg: 531.9712 (0.020)
Ep: 495, Reward: 925.3800, Test: 867.6541 [34.32], Avg: 532.5787 (0.020)
Ep: 496, Reward: 847.9894, Test: 694.2031 [348.58], Avg: 532.2026 (0.020)
Ep: 497, Reward: 796.9372, Test: 813.2399 [107.86], Avg: 532.5503 (0.020)
Ep: 498, Reward: 748.6521, Test: 807.3377 [133.61], Avg: 532.8332 (0.020)
Ep: 499, Reward: 915.4965, Test: 844.7613 [128.62], Avg: 533.1998 (0.020)
