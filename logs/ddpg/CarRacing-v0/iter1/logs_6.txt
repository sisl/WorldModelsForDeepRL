Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/


import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.01                # The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             # The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        # How many experience tuples to sample from the buffer for each train step

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) == self.update_freq:
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 100					# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.1                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.99			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

Ep: 0, Reward: -53.8256, Test: -45.4788 [19.14], Avg: -64.6162 (0.980)
Ep: 1, Reward: -63.6799, Test: -54.4593 [18.45], Avg: -68.7632 (0.960)
Ep: 2, Reward: -59.4709, Test: -39.7340 [22.41], Avg: -66.5556 (0.941)
Ep: 3, Reward: -57.0299, Test: -56.3422 [17.29], Avg: -68.3257 (0.922)
Ep: 4, Reward: -49.5425, Test: -70.6686 [32.84], Avg: -75.3615 (0.904)
Ep: 5, Reward: -50.0894, Test: -52.6203 [23.13], Avg: -75.4269 (0.886)
Ep: 6, Reward: -56.9428, Test: -47.7172 [19.57], Avg: -74.2635 (0.868)
Ep: 7, Reward: -52.6201, Test: -53.9254 [19.22], Avg: -74.1241 (0.851)
Ep: 8, Reward: -45.5590, Test: -34.9052 [44.06], Avg: -74.6614 (0.834)
Ep: 9, Reward: -51.4632, Test: -53.3095 [31.62], Avg: -75.6880 (0.817)
Ep: 10, Reward: -39.0789, Test: -50.2879 [18.49], Avg: -75.0597 (0.801)
Ep: 11, Reward: -49.7593, Test: -64.1142 [33.49], Avg: -76.9381 (0.785)
Ep: 12, Reward: -56.3024, Test: -40.7502 [30.99], Avg: -76.5386 (0.769)
Ep: 13, Reward: -49.9480, Test: -60.2458 [16.08], Avg: -76.5234 (0.754)
Ep: 14, Reward: -51.6978, Test: -72.2697 [35.40], Avg: -78.5995 (0.739)
Ep: 15, Reward: -60.8929, Test: -67.0800 [35.04], Avg: -80.0698 (0.724)
Ep: 16, Reward: -49.8956, Test: -46.0944 [26.94], Avg: -79.6559 (0.709)
Ep: 17, Reward: -40.3819, Test: -29.6967 [54.25], Avg: -79.8943 (0.695)
Ep: 18, Reward: -36.5527, Test: -36.3600 [22.59], Avg: -78.7918 (0.681)
Ep: 19, Reward: -35.1095, Test: -41.3937 [37.83], Avg: -78.8135 (0.668)
Ep: 20, Reward: -62.1625, Test: -40.7446 [29.30], Avg: -78.3957 (0.654)
Ep: 21, Reward: -36.9292, Test: -15.0551 [22.20], Avg: -76.5259 (0.641)
Ep: 22, Reward: -33.6843, Test: -48.8946 [14.85], Avg: -75.9700 (0.628)
Ep: 23, Reward: -54.5207, Test: -74.3042 [33.37], Avg: -77.2909 (0.616)
Ep: 24, Reward: -43.7141, Test: -19.6298 [13.37], Avg: -75.5194 (0.603)
Ep: 25, Reward: -29.8016, Test: -35.6319 [15.93], Avg: -74.5981 (0.591)
Ep: 26, Reward: -25.9855, Test: -6.9252 [40.34], Avg: -73.5859 (0.580)
Ep: 27, Reward: -34.6757, Test: -21.4512 [39.93], Avg: -73.1498 (0.568)
Ep: 28, Reward: -28.2233, Test: -6.7794 [68.91], Avg: -73.2373 (0.557)
Ep: 29, Reward: -31.6148, Test: -20.2395 [45.76], Avg: -72.9959 (0.545)
Ep: 30, Reward: -40.3715, Test: -43.8052 [13.89], Avg: -72.5022 (0.535)
Ep: 31, Reward: 1.8448, Test: -42.1388 [13.40], Avg: -71.9722 (0.524)
Ep: 32, Reward: -8.1866, Test: -25.6221 [55.71], Avg: -72.2558 (0.513)
Ep: 33, Reward: -24.1670, Test: -0.3225 [67.57], Avg: -72.1274 (0.503)
Ep: 34, Reward: 15.7762, Test: 2.7799 [49.53], Avg: -71.4022 (0.493)
Ep: 35, Reward: -8.5725, Test: -0.4134 [78.25], Avg: -71.6040 (0.483)
Ep: 36, Reward: -2.7695, Test: 6.8716 [37.55], Avg: -70.4980 (0.474)
Ep: 37, Reward: 16.9781, Test: 96.4510 [86.88], Avg: -68.3910 (0.464)
Ep: 38, Reward: 15.1888, Test: 9.2192 [77.36], Avg: -68.3847 (0.455)
Ep: 39, Reward: 46.0668, Test: -7.3606 [39.33], Avg: -67.8424 (0.446)
Ep: 40, Reward: 29.2377, Test: 60.6296 [78.84], Avg: -66.6319 (0.437)
Ep: 41, Reward: 31.4829, Test: 25.0508 [84.19], Avg: -66.4536 (0.428)
Ep: 42, Reward: -3.1399, Test: 95.5359 [124.64], Avg: -65.5851 (0.419)
Ep: 43, Reward: 7.7626, Test: 18.1296 [70.99], Avg: -65.2959 (0.411)
Ep: 44, Reward: 41.0915, Test: 45.2568 [64.61], Avg: -64.2750 (0.403)
Ep: 45, Reward: 36.7143, Test: 32.4943 [62.22], Avg: -63.5239 (0.395)
Ep: 46, Reward: 66.3146, Test: 28.0923 [69.24], Avg: -63.0477 (0.387)
Ep: 47, Reward: 102.1040, Test: 77.6674 [87.24], Avg: -61.9336 (0.379)
Ep: 48, Reward: 77.8754, Test: 149.3473 [186.71], Avg: -61.4321 (0.372)
Ep: 49, Reward: 115.2688, Test: 97.4966 [108.34], Avg: -60.4204 (0.364)
Ep: 50, Reward: 144.0654, Test: 74.3930 [84.92], Avg: -59.4421 (0.357)
Ep: 51, Reward: 84.7299, Test: 132.9517 [115.36], Avg: -57.9606 (0.350)
Ep: 52, Reward: 63.7010, Test: 99.6833 [107.64], Avg: -57.0172 (0.343)
Ep: 53, Reward: 105.0175, Test: 139.1015 [123.04], Avg: -55.6639 (0.336)
Ep: 54, Reward: 64.5910, Test: 90.8231 [117.18], Avg: -55.1310 (0.323)
Ep: 55, Reward: 140.1592, Test: 167.0404 [163.87], Avg: -54.0898 (0.316)
Ep: 56, Reward: 182.4292, Test: 158.6365 [162.84], Avg: -53.2146 (0.310)
Ep: 57, Reward: 125.1804, Test: 177.3272 [166.33], Avg: -52.1075 (0.304)
Ep: 58, Reward: 123.4917, Test: 229.7559 [246.97], Avg: -51.5160 (0.298)
Ep: 59, Reward: 191.1737, Test: 232.1326 [174.46], Avg: -49.6962 (0.292)
Ep: 60, Reward: 274.1227, Test: 326.5559 [180.02], Avg: -46.4793 (0.286)
Ep: 61, Reward: 151.0803, Test: 178.0559 [169.25], Avg: -45.5876 (0.280)
Ep: 62, Reward: 172.3409, Test: 213.4514 [219.11], Avg: -44.9539 (0.274)
Ep: 63, Reward: 222.4741, Test: 74.5842 [133.62], Avg: -45.1739 (0.269)
Ep: 64, Reward: 198.5693, Test: 249.7261 [208.76], Avg: -43.8487 (0.264)
Ep: 65, Reward: 318.5772, Test: 234.7437 [179.88], Avg: -42.3530 (0.258)
Ep: 66, Reward: 269.2071, Test: 218.4920 [220.11], Avg: -41.7449 (0.253)
Ep: 67, Reward: 318.0121, Test: 250.8833 [205.76], Avg: -40.4674 (0.248)
Ep: 68, Reward: 237.0203, Test: 259.5216 [124.10], Avg: -37.9183 (0.243)
Ep: 69, Reward: 284.6989, Test: 220.3521 [158.14], Avg: -36.4878 (0.238)
Ep: 70, Reward: 318.1553, Test: 260.1132 [237.19], Avg: -35.6510 (0.233)
Ep: 71, Reward: 365.1879, Test: 305.4666 [200.28], Avg: -33.6949 (0.229)
Ep: 72, Reward: 418.2470, Test: 324.9896 [190.38], Avg: -31.3894 (0.224)
Ep: 73, Reward: 380.6509, Test: 368.2373 [220.75], Avg: -28.9720 (0.220)
Ep: 74, Reward: 495.5932, Test: 461.9618 [237.89], Avg: -25.5982 (0.215)
Ep: 75, Reward: 436.9814, Test: 429.1491 [167.51], Avg: -21.8187 (0.211)
Ep: 76, Reward: 524.9011, Test: 316.0100 [223.26], Avg: -20.3308 (0.207)
Ep: 77, Reward: 363.9559, Test: 398.3604 [217.17], Avg: -17.7472 (0.203)
Ep: 78, Reward: 255.6272, Test: 352.7600 [239.30], Avg: -16.0863 (0.199)
Ep: 79, Reward: 384.2291, Test: 352.5658 [174.33], Avg: -13.6572 (0.195)
Ep: 80, Reward: 454.4951, Test: 331.9936 [218.28], Avg: -12.0848 (0.191)
Ep: 81, Reward: 468.0145, Test: 551.3638 [267.56], Avg: -8.4764 (0.187)
Ep: 82, Reward: 424.8215, Test: 567.1294 [190.11], Avg: -3.8318 (0.183)
Ep: 83, Reward: 400.1999, Test: 393.5170 [217.24], Avg: -1.6876 (0.180)
Ep: 84, Reward: 493.1108, Test: 502.6575 [151.67], Avg: 2.4615 (0.176)
Ep: 85, Reward: 591.9088, Test: 540.0632 [148.02], Avg: 6.9915 (0.172)
Ep: 86, Reward: 566.5868, Test: 548.7166 [158.36], Avg: 11.3980 (0.169)
Ep: 87, Reward: 577.0545, Test: 604.7773 [221.75], Avg: 15.6211 (0.166)
Ep: 88, Reward: 503.3156, Test: 481.6137 [157.95], Avg: 19.0822 (0.162)
Ep: 89, Reward: 523.8263, Test: 627.1365 [203.58], Avg: 23.5764 (0.159)
Ep: 90, Reward: 448.9362, Test: 585.3708 [196.52], Avg: 27.5903 (0.156)
Ep: 91, Reward: 677.0635, Test: 500.8035 [264.61], Avg: 29.8577 (0.153)
Ep: 92, Reward: 643.9144, Test: 503.5667 [216.61], Avg: 32.6223 (0.150)
Ep: 93, Reward: 630.7827, Test: 528.0472 [124.84], Avg: 36.5647 (0.147)
Ep: 94, Reward: 670.9469, Test: 507.5092 [235.49], Avg: 39.0431 (0.144)
Ep: 95, Reward: 673.6022, Test: 527.2763 [246.01], Avg: 41.5662 (0.141)
Ep: 96, Reward: 564.1915, Test: 589.9003 [251.26], Avg: 44.6289 (0.138)
Ep: 97, Reward: 539.1612, Test: 642.5351 [192.56], Avg: 48.7650 (0.133)
Ep: 98, Reward: 466.6767, Test: 546.9195 [275.69], Avg: 51.0121 (0.130)
Ep: 99, Reward: 605.6132, Test: 526.6549 [202.36], Avg: 53.7450 (0.127)
Ep: 100, Reward: 460.3149, Test: 495.0834 [221.52], Avg: 55.9214 (0.125)
Ep: 101, Reward: 554.0719, Test: 373.4335 [252.08], Avg: 56.5629 (0.122)
Ep: 102, Reward: 551.9313, Test: 515.2025 [163.63], Avg: 59.4270 (0.120)
Ep: 103, Reward: 553.2230, Test: 524.8841 [302.76], Avg: 60.9914 (0.117)
Ep: 104, Reward: 551.6209, Test: 481.1517 [152.50], Avg: 63.5406 (0.115)
Ep: 105, Reward: 476.4056, Test: 567.0249 [206.47], Avg: 66.3426 (0.113)
Ep: 106, Reward: 486.6202, Test: 464.8235 [137.03], Avg: 68.7861 (0.111)
Ep: 107, Reward: 555.7804, Test: 484.6923 [155.55], Avg: 71.1968 (0.108)
Ep: 108, Reward: 529.9029, Test: 576.9387 [202.49], Avg: 73.9789 (0.106)
Ep: 109, Reward: 500.6966, Test: 477.4472 [208.37], Avg: 75.7525 (0.104)
Ep: 110, Reward: 508.6067, Test: 570.0232 [192.67], Avg: 78.4697 (0.102)
Ep: 111, Reward: 583.0802, Test: 451.9255 [183.42], Avg: 80.1664 (0.100)
Ep: 112, Reward: 469.9525, Test: 584.7269 [177.10], Avg: 83.0643 (0.098)
Ep: 113, Reward: 570.9565, Test: 531.2496 [145.75], Avg: 85.7172 (0.096)
Ep: 114, Reward: 548.8092, Test: 532.9988 [160.68], Avg: 88.2094 (0.094)
Ep: 115, Reward: 516.6261, Test: 512.1785 [217.89], Avg: 89.9859 (0.092)
Ep: 116, Reward: 550.1788, Test: 522.1903 [211.99], Avg: 91.8681 (0.090)
Ep: 117, Reward: 534.0904, Test: 550.9439 [248.41], Avg: 93.6535 (0.089)
Ep: 118, Reward: 555.3372, Test: 518.0983 [192.54], Avg: 95.6022 (0.087)
Ep: 119, Reward: 613.3742, Test: 463.9970 [263.27], Avg: 96.4783 (0.085)
Ep: 120, Reward: 478.6596, Test: 581.1476 [209.56], Avg: 98.7520 (0.083)
Ep: 121, Reward: 533.9345, Test: 527.7793 [184.08], Avg: 100.7598 (0.082)
Ep: 122, Reward: 516.0312, Test: 628.6113 [151.85], Avg: 103.8167 (0.080)
Ep: 123, Reward: 641.4753, Test: 590.4740 [178.50], Avg: 106.3019 (0.078)
Ep: 124, Reward: 549.0853, Test: 654.0526 [205.25], Avg: 109.0419 (0.077)
Ep: 125, Reward: 558.9111, Test: 622.5441 [219.60], Avg: 111.3745 (0.075)
Ep: 126, Reward: 497.7804, Test: 624.5659 [123.98], Avg: 114.4391 (0.074)
Ep: 127, Reward: 585.8310, Test: 686.1446 [168.29], Avg: 117.5908 (0.072)
Ep: 128, Reward: 792.8813, Test: 548.4416 [234.25], Avg: 119.1148 (0.071)
Ep: 129, Reward: 694.9089, Test: 767.7782 [175.00], Avg: 122.7584 (0.069)
Ep: 130, Reward: 706.9856, Test: 840.8850 [29.01], Avg: 128.0188 (0.068)
Ep: 131, Reward: 818.6747, Test: 778.5269 [179.15], Avg: 131.5897 (0.067)
Ep: 132, Reward: 845.3140, Test: 712.8309 [212.19], Avg: 134.3645 (0.065)
Ep: 133, Reward: 816.8131, Test: 806.9450 [65.58], Avg: 138.8943 (0.064)
Ep: 134, Reward: 830.0143, Test: 868.7585 [25.73], Avg: 144.1101 (0.063)
Ep: 135, Reward: 756.7843, Test: 732.7261 [182.46], Avg: 147.0965 (0.062)
Ep: 136, Reward: 755.8057, Test: 731.9859 [145.90], Avg: 150.3008 (0.060)
Ep: 137, Reward: 710.5163, Test: 851.8232 [28.87], Avg: 155.1751 (0.059)
Ep: 138, Reward: 850.7573, Test: 835.3923 [60.95], Avg: 159.6303 (0.058)
Ep: 139, Reward: 764.4906, Test: 826.9760 [83.03], Avg: 163.8040 (0.057)
Ep: 140, Reward: 825.6747, Test: 857.2927 [16.28], Avg: 168.6069 (0.056)
Ep: 141, Reward: 823.6540, Test: 667.6515 [159.01], Avg: 171.0015 (0.055)
Ep: 142, Reward: 769.0200, Test: 818.5447 [29.17], Avg: 175.3258 (0.053)
Ep: 143, Reward: 805.2922, Test: 735.9952 [126.69], Avg: 178.3395 (0.052)
Ep: 144, Reward: 771.8043, Test: 767.5430 [137.09], Avg: 181.4575 (0.051)
Ep: 145, Reward: 802.8535, Test: 683.8764 [179.19], Avg: 183.6714 (0.050)
Ep: 146, Reward: 875.0085, Test: 819.2935 [62.32], Avg: 187.5715 (0.049)
Ep: 147, Reward: 771.0133, Test: 764.1682 [168.87], Avg: 190.3264 (0.048)
Ep: 148, Reward: 814.8135, Test: 795.7338 [66.44], Avg: 193.9436 (0.047)
Ep: 149, Reward: 770.1124, Test: 758.5833 [172.93], Avg: 196.5550 (0.046)
Ep: 150, Reward: 742.2736, Test: 834.0654 [66.84], Avg: 200.3343 (0.045)
Ep: 151, Reward: 719.8738, Test: 762.3776 [138.62], Avg: 203.1199 (0.045)
Ep: 152, Reward: 773.7596, Test: 738.1626 [166.65], Avg: 205.5277 (0.044)
Ep: 153, Reward: 853.9341, Test: 694.4420 [183.83], Avg: 207.5088 (0.043)
Ep: 154, Reward: 773.7770, Test: 791.9792 [121.34], Avg: 210.4967 (0.042)
Ep: 155, Reward: 822.7656, Test: 725.7890 [203.14], Avg: 212.4977 (0.041)
Ep: 156, Reward: 881.7078, Test: 822.7629 [38.71], Avg: 216.1382 (0.040)
Ep: 157, Reward: 793.5270, Test: 751.0368 [151.20], Avg: 218.5666 (0.039)
Ep: 158, Reward: 857.7649, Test: 834.1404 [61.43], Avg: 222.0518 (0.039)
Ep: 159, Reward: 858.2744, Test: 728.7457 [176.95], Avg: 224.1127 (0.038)
Ep: 160, Reward: 807.7953, Test: 764.8966 [156.04], Avg: 226.5025 (0.037)
Ep: 161, Reward: 845.7909, Test: 848.8950 [67.04], Avg: 229.9305 (0.036)
Ep: 162, Reward: 781.5546, Test: 832.7981 [33.26], Avg: 233.4251 (0.036)
Ep: 163, Reward: 797.9464, Test: 805.4677 [138.97], Avg: 236.0657 (0.035)
Ep: 164, Reward: 823.5300, Test: 859.4859 [19.70], Avg: 239.7246 (0.034)
Ep: 165, Reward: 744.8302, Test: 848.4434 [39.03], Avg: 243.1565 (0.034)
Ep: 166, Reward: 815.3923, Test: 806.4705 [87.63], Avg: 246.0049 (0.033)
Ep: 167, Reward: 792.1756, Test: 715.4885 [206.14], Avg: 247.5724 (0.032)
Ep: 168, Reward: 724.8579, Test: 812.8147 [68.06], Avg: 250.5143 (0.032)
Ep: 169, Reward: 732.4105, Test: 713.7199 [241.17], Avg: 251.8204 (0.031)
Ep: 170, Reward: 824.9711, Test: 765.7145 [171.02], Avg: 253.8255 (0.030)
Ep: 171, Reward: 737.2940, Test: 764.8156 [93.31], Avg: 256.2539 (0.030)
Ep: 172, Reward: 724.7395, Test: 799.0557 [81.58], Avg: 258.9199 (0.029)
Ep: 173, Reward: 736.5633, Test: 732.5987 [165.55], Avg: 260.6907 (0.029)
Ep: 174, Reward: 692.9161, Test: 801.3604 [55.35], Avg: 263.4640 (0.028)
Ep: 175, Reward: 829.0149, Test: 793.4215 [93.75], Avg: 265.9425 (0.027)
Ep: 176, Reward: 800.3557, Test: 756.0994 [147.47], Avg: 267.8786 (0.027)
Ep: 177, Reward: 813.2031, Test: 870.5690 [30.46], Avg: 271.0934 (0.026)
Ep: 178, Reward: 814.5426, Test: 752.6557 [60.95], Avg: 273.4431 (0.026)
Ep: 179, Reward: 778.1867, Test: 807.8303 [140.31], Avg: 275.6325 (0.025)
Ep: 180, Reward: 803.8845, Test: 789.1425 [121.29], Avg: 277.7994 (0.025)
Ep: 181, Reward: 721.4388, Test: 786.9946 [85.36], Avg: 280.1281 (0.024)
Ep: 182, Reward: 772.2688, Test: 635.3467 [282.88], Avg: 280.5234 (0.024)
Ep: 183, Reward: 690.2341, Test: 785.4469 [152.51], Avg: 282.4387 (0.023)
Ep: 184, Reward: 799.0236, Test: 755.8672 [91.34], Avg: 284.5040 (0.023)
Ep: 185, Reward: 771.4626, Test: 824.8815 [76.58], Avg: 286.9976 (0.022)
Ep: 186, Reward: 864.8054, Test: 839.6650 [61.10], Avg: 289.6263 (0.022)
Ep: 187, Reward: 710.2271, Test: 677.7344 [288.74], Avg: 290.1548 (0.022)
Ep: 188, Reward: 749.8903, Test: 746.8349 [124.97], Avg: 291.9099 (0.021)
Ep: 189, Reward: 822.6563, Test: 754.0713 [186.67], Avg: 293.3598 (0.021)
Ep: 190, Reward: 739.4748, Test: 703.7911 [207.63], Avg: 294.4216 (0.020)
Ep: 191, Reward: 698.8954, Test: 776.5184 [161.32], Avg: 296.0923 (0.020)
Ep: 192, Reward: 698.9373, Test: 829.9790 [69.77], Avg: 298.4971 (0.019)
Ep: 193, Reward: 798.1914, Test: 657.0070 [165.59], Avg: 299.4915 (0.019)
Ep: 194, Reward: 729.5514, Test: 850.8612 [37.97], Avg: 302.1243 (0.019)
Ep: 195, Reward: 777.6488, Test: 867.1814 [11.55], Avg: 304.9484 (0.018)
Ep: 196, Reward: 777.6230, Test: 795.6598 [108.38], Avg: 306.8892 (0.018)
Ep: 197, Reward: 862.4948, Test: 872.0827 [43.54], Avg: 309.5238 (0.018)
Ep: 198, Reward: 849.7950, Test: 789.5536 [112.29], Avg: 311.3717 (0.017)
Ep: 199, Reward: 787.3690, Test: 787.1749 [68.40], Avg: 313.4087 (0.017)
Ep: 200, Reward: 883.7053, Test: 857.0383 [59.64], Avg: 315.8166 (0.017)
Ep: 201, Reward: 814.0591, Test: 749.1267 [258.86], Avg: 316.6802 (0.016)
Ep: 202, Reward: 830.3888, Test: 825.2763 [98.07], Avg: 318.7025 (0.016)
Ep: 203, Reward: 809.2584, Test: 874.0108 [17.69], Avg: 321.3379 (0.016)
Ep: 204, Reward: 853.7192, Test: 816.3525 [135.42], Avg: 323.0920 (0.015)
Ep: 205, Reward: 888.2294, Test: 861.4175 [55.44], Avg: 325.4361 (0.015)
Ep: 206, Reward: 842.8297, Test: 871.8087 [39.44], Avg: 327.8851 (0.015)
Ep: 207, Reward: 832.4616, Test: 792.5703 [126.59], Avg: 329.5105 (0.014)
Ep: 208, Reward: 738.4924, Test: 856.3132 [52.55], Avg: 331.7797 (0.014)
Ep: 209, Reward: 780.6434, Test: 793.0419 [187.22], Avg: 333.0846 (0.014)
Ep: 210, Reward: 701.6689, Test: 828.8814 [148.73], Avg: 334.7295 (0.014)
Ep: 211, Reward: 674.2141, Test: 578.7631 [241.72], Avg: 334.7404 (0.013)
Ep: 212, Reward: 557.9770, Test: 775.2578 [189.35], Avg: 335.9196 (0.013)
Ep: 213, Reward: 755.0210, Test: 739.6677 [198.93], Avg: 336.8766 (0.013)
Ep: 214, Reward: 836.7631, Test: 646.2098 [245.52], Avg: 337.1735 (0.012)
Ep: 215, Reward: 835.9739, Test: 674.4333 [262.54], Avg: 337.5194 (0.012)
Ep: 216, Reward: 792.6668, Test: 803.6813 [123.54], Avg: 339.0983 (0.012)
Ep: 217, Reward: 677.6353, Test: 697.0314 [186.91], Avg: 339.8828 (0.012)
Ep: 218, Reward: 820.8391, Test: 835.4917 [157.94], Avg: 341.4247 (0.012)
Ep: 219, Reward: 796.1843, Test: 886.3848 [18.07], Avg: 343.8196 (0.011)
Ep: 220, Reward: 719.3701, Test: 896.0744 [13.97], Avg: 346.2553 (0.011)
Ep: 221, Reward: 795.0967, Test: 818.6180 [115.69], Avg: 347.8619 (0.011)
Ep: 222, Reward: 731.7923, Test: 844.0437 [73.35], Avg: 349.7580 (0.011)
Ep: 223, Reward: 816.8543, Test: 728.7488 [206.95], Avg: 350.5261 (0.010)
Ep: 224, Reward: 833.7045, Test: 736.1450 [179.38], Avg: 351.4427 (0.010)
Ep: 225, Reward: 811.5624, Test: 785.0210 [151.61], Avg: 352.6903 (0.010)
Ep: 226, Reward: 850.7500, Test: 866.7150 [23.03], Avg: 354.8533 (0.010)
Ep: 227, Reward: 788.6214, Test: 805.7439 [156.47], Avg: 356.1446 (0.010)
Ep: 228, Reward: 858.0688, Test: 782.9769 [177.47], Avg: 357.2335 (0.010)
Ep: 229, Reward: 780.8291, Test: 661.0676 [220.65], Avg: 357.5952 (0.010)
Ep: 230, Reward: 801.0380, Test: 750.0182 [197.65], Avg: 358.4384 (0.010)
Ep: 231, Reward: 853.8044, Test: 753.0731 [208.24], Avg: 359.2418 (0.010)
Ep: 232, Reward: 814.0022, Test: 745.6088 [238.43], Avg: 359.8767 (0.010)
Ep: 233, Reward: 867.6129, Test: 732.5118 [193.22], Avg: 360.6434 (0.010)
Ep: 234, Reward: 763.9803, Test: 666.9591 [189.58], Avg: 361.1402 (0.010)
Ep: 235, Reward: 818.6005, Test: 751.3585 [153.20], Avg: 362.1445 (0.010)
Ep: 236, Reward: 742.9138, Test: 619.9624 [242.66], Avg: 362.2084 (0.010)
Ep: 237, Reward: 756.9165, Test: 599.5762 [244.33], Avg: 362.1792 (0.010)
Ep: 238, Reward: 705.7430, Test: 757.9580 [175.84], Avg: 363.0994 (0.010)
Ep: 239, Reward: 776.0875, Test: 718.0096 [163.33], Avg: 363.8977 (0.010)
Ep: 240, Reward: 755.3217, Test: 724.4098 [285.50], Avg: 364.2089 (0.010)
Ep: 241, Reward: 804.0417, Test: 738.2280 [211.29], Avg: 364.8813 (0.010)
Ep: 242, Reward: 839.8073, Test: 861.8377 [15.89], Avg: 366.8610 (0.010)
Ep: 243, Reward: 903.2548, Test: 830.7539 [94.31], Avg: 368.3757 (0.010)
Ep: 244, Reward: 760.2792, Test: 865.2640 [28.03], Avg: 370.2894 (0.010)
Ep: 245, Reward: 897.8694, Test: 860.8140 [43.92], Avg: 372.1049 (0.010)
Ep: 246, Reward: 801.7725, Test: 770.8003 [154.97], Avg: 373.0916 (0.010)
Ep: 247, Reward: 836.5941, Test: 818.0964 [72.96], Avg: 374.5918 (0.010)
Ep: 248, Reward: 813.4405, Test: 868.0528 [80.05], Avg: 376.2521 (0.010)
Ep: 249, Reward: 893.8511, Test: 775.8155 [169.33], Avg: 377.1731 (0.010)
Ep: 250, Reward: 817.8411, Test: 871.4057 [33.82], Avg: 379.0074 (0.010)
Ep: 251, Reward: 781.1777, Test: 877.0876 [25.73], Avg: 380.8818 (0.010)
Ep: 252, Reward: 884.0144, Test: 873.9137 [12.36], Avg: 382.7817 (0.010)
Ep: 253, Reward: 925.0135, Test: 834.6406 [70.05], Avg: 384.2849 (0.010)
Ep: 254, Reward: 881.1716, Test: 862.0000 [13.41], Avg: 386.1057 (0.010)
Ep: 255, Reward: 745.2544, Test: 867.5169 [19.34], Avg: 387.9107 (0.010)
Ep: 256, Reward: 880.7727, Test: 821.3099 [171.07], Avg: 388.9314 (0.010)
Ep: 257, Reward: 816.2494, Test: 840.7056 [91.94], Avg: 390.3261 (0.010)
Ep: 258, Reward: 876.7450, Test: 877.5703 [30.82], Avg: 392.0884 (0.010)
Ep: 259, Reward: 909.3006, Test: 870.5353 [49.78], Avg: 393.7371 (0.010)
Ep: 260, Reward: 942.5073, Test: 879.8294 [56.15], Avg: 395.3844 (0.010)
Ep: 261, Reward: 921.1453, Test: 878.3187 [30.07], Avg: 397.1129 (0.010)
Ep: 262, Reward: 904.5370, Test: 791.3407 [178.18], Avg: 397.9344 (0.010)
Ep: 263, Reward: 927.7188, Test: 871.1425 [66.21], Avg: 399.4761 (0.010)
Ep: 264, Reward: 894.7438, Test: 704.9255 [236.23], Avg: 399.7373 (0.010)
Ep: 265, Reward: 877.5967, Test: 819.9975 [163.93], Avg: 400.7009 (0.010)
Ep: 266, Reward: 755.5382, Test: 746.5436 [211.40], Avg: 401.2045 (0.010)
Ep: 267, Reward: 833.9330, Test: 678.0428 [292.19], Avg: 401.1472 (0.010)
Ep: 268, Reward: 873.1172, Test: 673.3587 [231.29], Avg: 401.2993 (0.010)
Ep: 269, Reward: 822.9734, Test: 688.9850 [217.14], Avg: 401.5606 (0.010)
Ep: 270, Reward: 798.4466, Test: 886.5257 [33.16], Avg: 403.2278 (0.010)
Ep: 271, Reward: 832.8986, Test: 838.2044 [58.09], Avg: 404.6134 (0.010)
Ep: 272, Reward: 841.1471, Test: 850.2785 [72.78], Avg: 405.9793 (0.010)
Ep: 273, Reward: 845.4421, Test: 840.6635 [50.87], Avg: 407.3801 (0.010)
Ep: 274, Reward: 859.6689, Test: 874.3716 [32.07], Avg: 408.9616 (0.010)
Ep: 275, Reward: 813.8288, Test: 851.3524 [58.29], Avg: 410.3532 (0.010)
Ep: 276, Reward: 777.5286, Test: 619.2883 [191.54], Avg: 410.4160 (0.010)
Ep: 277, Reward: 839.0062, Test: 699.8495 [220.55], Avg: 410.6638 (0.010)
Ep: 278, Reward: 638.7532, Test: 830.0970 [100.94], Avg: 411.8054 (0.010)
Ep: 279, Reward: 663.7796, Test: 749.0417 [128.55], Avg: 412.5507 (0.010)
Ep: 280, Reward: 777.3376, Test: 849.9564 [57.78], Avg: 413.9016 (0.010)
Ep: 281, Reward: 800.2330, Test: 865.9800 [30.32], Avg: 415.3972 (0.010)
Ep: 282, Reward: 797.8754, Test: 827.5647 [119.11], Avg: 416.4328 (0.010)
Ep: 283, Reward: 811.9904, Test: 756.9478 [168.97], Avg: 417.0368 (0.010)
Ep: 284, Reward: 904.0945, Test: 774.3894 [233.38], Avg: 417.4718 (0.010)
Ep: 285, Reward: 800.8388, Test: 831.3081 [15.97], Avg: 418.8630 (0.010)
Ep: 286, Reward: 887.5367, Test: 849.3285 [44.27], Avg: 420.2086 (0.010)
Ep: 287, Reward: 838.0312, Test: 821.4710 [96.33], Avg: 421.2674 (0.010)
Ep: 288, Reward: 849.0540, Test: 798.9559 [81.90], Avg: 422.2909 (0.010)
Ep: 289, Reward: 819.7924, Test: 743.3192 [191.72], Avg: 422.7368 (0.010)
Ep: 290, Reward: 757.5640, Test: 836.3703 [59.44], Avg: 423.9540 (0.010)
Ep: 291, Reward: 878.2379, Test: 855.6329 [53.87], Avg: 425.2478 (0.010)
Ep: 292, Reward: 799.6070, Test: 811.2608 [89.80], Avg: 426.2588 (0.010)
Ep: 293, Reward: 812.6581, Test: 443.5874 [190.32], Avg: 425.6704 (0.010)
Ep: 294, Reward: 702.2613, Test: 791.6597 [33.21], Avg: 426.7984 (0.010)
Ep: 295, Reward: 730.4797, Test: 866.0259 [29.04], Avg: 428.1842 (0.010)
Ep: 296, Reward: 847.2836, Test: 845.5319 [47.61], Avg: 429.4291 (0.010)
Ep: 297, Reward: 775.8612, Test: 777.5072 [157.36], Avg: 430.0691 (0.010)
Ep: 298, Reward: 829.3879, Test: 736.2788 [148.28], Avg: 430.5973 (0.010)
Ep: 299, Reward: 799.8893, Test: 845.6337 [108.33], Avg: 431.6196 (0.010)
Ep: 300, Reward: 858.7972, Test: 846.8854 [96.14], Avg: 432.6798 (0.010)
Ep: 301, Reward: 879.6354, Test: 847.1130 [50.33], Avg: 433.8855 (0.010)
Ep: 302, Reward: 841.1050, Test: 785.1993 [166.79], Avg: 434.4945 (0.010)
Ep: 303, Reward: 885.9271, Test: 739.6364 [184.71], Avg: 434.8906 (0.010)
Ep: 304, Reward: 861.4343, Test: 757.6832 [137.45], Avg: 435.4983 (0.010)
Ep: 305, Reward: 785.9338, Test: 789.1850 [155.44], Avg: 436.1462 (0.010)
Ep: 306, Reward: 724.8331, Test: 698.5366 [190.90], Avg: 436.3790 (0.010)
Ep: 307, Reward: 798.2349, Test: 597.1011 [225.27], Avg: 436.1695 (0.010)
Ep: 308, Reward: 707.1086, Test: 532.9745 [249.07], Avg: 435.6767 (0.010)
Ep: 309, Reward: 609.5446, Test: 577.9674 [240.64], Avg: 435.3595 (0.010)
Ep: 310, Reward: 552.3066, Test: 713.2809 [185.45], Avg: 435.6568 (0.010)
Ep: 311, Reward: 818.5132, Test: 721.0211 [226.95], Avg: 435.8440 (0.010)
Ep: 312, Reward: 718.7755, Test: 800.0772 [68.43], Avg: 436.7891 (0.010)
Ep: 313, Reward: 773.8857, Test: 665.9119 [152.62], Avg: 437.0327 (0.010)
Ep: 314, Reward: 780.2015, Test: 628.8482 [291.37], Avg: 436.7167 (0.010)
Ep: 315, Reward: 768.7863, Test: 709.4692 [216.30], Avg: 436.8953 (0.010)
Ep: 316, Reward: 821.3160, Test: 731.2814 [219.89], Avg: 437.1303 (0.010)
Ep: 317, Reward: 854.9786, Test: 798.9005 [162.52], Avg: 437.7569 (0.010)
Ep: 318, Reward: 771.7358, Test: 846.5578 [83.24], Avg: 438.7775 (0.010)
Ep: 319, Reward: 823.7697, Test: 766.8097 [199.62], Avg: 439.1788 (0.010)
Ep: 320, Reward: 703.5838, Test: 873.2984 [20.55], Avg: 440.4671 (0.010)
Ep: 321, Reward: 869.6663, Test: 817.9953 [160.61], Avg: 441.1408 (0.010)
Ep: 322, Reward: 853.1647, Test: 853.5928 [22.15], Avg: 442.3492 (0.010)
Ep: 323, Reward: 892.7210, Test: 870.3454 [24.01], Avg: 443.5960 (0.010)
Ep: 324, Reward: 895.1159, Test: 803.6057 [202.99], Avg: 444.0792 (0.010)
Ep: 325, Reward: 855.0628, Test: 872.7824 [22.01], Avg: 445.3267 (0.010)
Ep: 326, Reward: 918.8316, Test: 766.5926 [188.46], Avg: 445.7328 (0.010)
Ep: 327, Reward: 833.4727, Test: 849.9043 [63.74], Avg: 446.7707 (0.010)
Ep: 328, Reward: 827.4286, Test: 891.7760 [17.36], Avg: 448.0706 (0.010)
Ep: 329, Reward: 908.0992, Test: 879.3131 [24.97], Avg: 449.3017 (0.010)
Ep: 330, Reward: 794.0210, Test: 890.3005 [27.49], Avg: 450.5509 (0.010)
Ep: 331, Reward: 931.7811, Test: 857.3382 [102.78], Avg: 451.4666 (0.010)
Ep: 332, Reward: 916.8721, Test: 847.9411 [49.14], Avg: 452.5097 (0.010)
Ep: 333, Reward: 909.8227, Test: 874.7264 [40.39], Avg: 453.6529 (0.010)
Ep: 334, Reward: 908.6148, Test: 862.0478 [25.03], Avg: 454.7972 (0.010)
Ep: 335, Reward: 887.8817, Test: 887.2943 [27.36], Avg: 456.0030 (0.010)
Ep: 336, Reward: 848.5075, Test: 812.0524 [171.51], Avg: 456.5506 (0.010)
Ep: 337, Reward: 875.6112, Test: 866.6523 [74.28], Avg: 457.5441 (0.010)
Ep: 338, Reward: 845.4003, Test: 867.5509 [36.31], Avg: 458.6465 (0.010)
Ep: 339, Reward: 859.3152, Test: 878.7102 [24.52], Avg: 459.8098 (0.010)
Ep: 340, Reward: 773.6195, Test: 793.8333 [149.19], Avg: 460.3519 (0.010)
Ep: 341, Reward: 905.0208, Test: 845.1196 [59.24], Avg: 461.3037 (0.010)
Ep: 342, Reward: 884.5075, Test: 902.8184 [16.46], Avg: 462.5429 (0.010)
Ep: 343, Reward: 963.8715, Test: 842.2922 [172.96], Avg: 463.1441 (0.010)
Ep: 344, Reward: 898.1342, Test: 905.2844 [14.96], Avg: 464.3823 (0.010)
Ep: 345, Reward: 971.5115, Test: 819.4888 [132.93], Avg: 465.0244 (0.010)
Ep: 346, Reward: 901.7165, Test: 880.8008 [27.94], Avg: 466.1421 (0.010)
Ep: 347, Reward: 957.8771, Test: 885.5289 [23.29], Avg: 467.2803 (0.010)
Ep: 348, Reward: 873.5081, Test: 868.5657 [70.46], Avg: 468.2282 (0.010)
Ep: 349, Reward: 873.0839, Test: 896.6972 [24.82], Avg: 469.3815 (0.010)
Ep: 350, Reward: 924.0457, Test: 862.4176 [56.02], Avg: 470.3417 (0.010)
Ep: 351, Reward: 933.8665, Test: 879.7190 [63.66], Avg: 471.3238 (0.010)
Ep: 352, Reward: 860.6661, Test: 896.4433 [25.96], Avg: 472.4546 (0.010)
Ep: 353, Reward: 886.0687, Test: 827.7464 [173.95], Avg: 472.9669 (0.010)
Ep: 354, Reward: 883.5132, Test: 900.3703 [15.22], Avg: 474.1279 (0.010)
Ep: 355, Reward: 887.8133, Test: 892.8619 [25.23], Avg: 475.2333 (0.010)
Ep: 356, Reward: 876.7825, Test: 812.5670 [152.14], Avg: 475.7520 (0.010)
Ep: 357, Reward: 894.1654, Test: 867.5029 [61.52], Avg: 476.6744 (0.010)
Ep: 358, Reward: 847.3771, Test: 885.2519 [18.54], Avg: 477.7609 (0.010)
Ep: 359, Reward: 851.7810, Test: 710.4142 [245.69], Avg: 477.7247 (0.010)
Ep: 360, Reward: 873.6298, Test: 837.9428 [57.65], Avg: 478.5628 (0.010)
Ep: 361, Reward: 869.7151, Test: 769.0051 [192.22], Avg: 478.8342 (0.010)
Ep: 362, Reward: 822.4373, Test: 685.5608 [225.70], Avg: 478.7819 (0.010)
Ep: 363, Reward: 858.5202, Test: 834.8618 [69.52], Avg: 479.5691 (0.010)
Ep: 364, Reward: 831.1242, Test: 866.9775 [40.08], Avg: 480.5207 (0.010)
Ep: 365, Reward: 855.8772, Test: 856.1081 [46.78], Avg: 481.4191 (0.010)
Ep: 366, Reward: 831.9828, Test: 838.6729 [97.17], Avg: 482.1278 (0.010)
Ep: 367, Reward: 887.1747, Test: 878.2657 [19.03], Avg: 483.1526 (0.010)
Ep: 368, Reward: 957.0569, Test: 883.5652 [38.43], Avg: 484.1335 (0.010)
Ep: 369, Reward: 771.1759, Test: 841.6309 [68.99], Avg: 484.9133 (0.010)
Ep: 370, Reward: 856.8130, Test: 852.8092 [41.94], Avg: 485.7919 (0.010)
Ep: 371, Reward: 844.3201, Test: 760.3880 [191.91], Avg: 486.0142 (0.010)
Ep: 372, Reward: 844.9571, Test: 839.9110 [87.32], Avg: 486.7288 (0.010)
Ep: 373, Reward: 863.8477, Test: 878.6490 [13.16], Avg: 487.7416 (0.010)
Ep: 374, Reward: 881.0840, Test: 876.2449 [31.56], Avg: 488.6934 (0.010)
Ep: 375, Reward: 814.7617, Test: 736.8109 [253.27], Avg: 488.6797 (0.010)
Ep: 376, Reward: 821.4896, Test: 772.7181 [148.51], Avg: 489.0392 (0.010)
Ep: 377, Reward: 792.8893, Test: 689.6325 [207.53], Avg: 489.0209 (0.010)
Ep: 378, Reward: 816.6337, Test: 742.9780 [205.54], Avg: 489.1486 (0.010)
Ep: 379, Reward: 817.7417, Test: 850.3949 [28.16], Avg: 490.0251 (0.010)
Ep: 380, Reward: 851.6695, Test: 839.1445 [74.78], Avg: 490.7452 (0.010)
Ep: 381, Reward: 851.9588, Test: 784.1447 [183.15], Avg: 491.0338 (0.010)
Ep: 382, Reward: 786.3159, Test: 845.0085 [50.82], Avg: 491.8253 (0.010)
Ep: 383, Reward: 841.4006, Test: 862.6252 [16.66], Avg: 492.7476 (0.010)
Ep: 384, Reward: 890.8885, Test: 855.4229 [59.69], Avg: 493.5345 (0.010)
Ep: 385, Reward: 850.6517, Test: 870.4329 [47.10], Avg: 494.3889 (0.010)
Ep: 386, Reward: 887.1764, Test: 869.4070 [24.05], Avg: 495.2958 (0.010)
Ep: 387, Reward: 848.9984, Test: 825.3882 [114.29], Avg: 495.8520 (0.010)
Ep: 388, Reward: 818.5244, Test: 741.0466 [249.68], Avg: 495.8405 (0.010)
Ep: 389, Reward: 674.4342, Test: 751.0796 [209.20], Avg: 495.9585 (0.010)
Ep: 390, Reward: 913.1823, Test: 791.3486 [124.33], Avg: 496.3960 (0.010)
Ep: 391, Reward: 802.8762, Test: 884.6755 [26.59], Avg: 497.3187 (0.010)
Ep: 392, Reward: 934.4319, Test: 818.0518 [168.35], Avg: 497.7065 (0.010)
Ep: 393, Reward: 939.2793, Test: 882.4626 [37.96], Avg: 498.5867 (0.010)
Ep: 394, Reward: 900.8335, Test: 904.3958 [21.13], Avg: 499.5605 (0.010)
Ep: 395, Reward: 926.2299, Test: 871.6808 [62.81], Avg: 500.3416 (0.010)
Ep: 396, Reward: 985.8897, Test: 836.5541 [129.09], Avg: 500.8634 (0.010)
Ep: 397, Reward: 947.1083, Test: 903.6666 [17.75], Avg: 501.8308 (0.010)
Ep: 398, Reward: 964.2563, Test: 887.3072 [24.46], Avg: 502.7356 (0.010)
Ep: 399, Reward: 861.5475, Test: 823.0370 [125.39], Avg: 503.2229 (0.010)
Ep: 400, Reward: 809.4101, Test: 836.4527 [73.68], Avg: 503.8702 (0.010)
Ep: 401, Reward: 807.8251, Test: 742.4531 [197.61], Avg: 503.9721 (0.010)
Ep: 402, Reward: 872.2286, Test: 845.9690 [99.77], Avg: 504.5732 (0.010)
Ep: 403, Reward: 900.7391, Test: 853.0641 [50.64], Avg: 505.3104 (0.010)
Ep: 404, Reward: 883.4736, Test: 789.0686 [151.85], Avg: 505.6361 (0.010)
Ep: 405, Reward: 764.2497, Test: 801.9699 [174.01], Avg: 505.9374 (0.010)
Ep: 406, Reward: 917.9926, Test: 884.4236 [40.95], Avg: 506.7667 (0.010)
Ep: 407, Reward: 1016.9754, Test: 836.1568 [217.28], Avg: 507.0415 (0.010)
Ep: 408, Reward: 1057.2315, Test: 836.2953 [99.66], Avg: 507.6028 (0.010)
Ep: 409, Reward: 855.0772, Test: 804.5609 [130.97], Avg: 508.0077 (0.010)
Ep: 410, Reward: 921.1267, Test: 906.6018 [23.12], Avg: 508.9213 (0.010)
Ep: 411, Reward: 834.2819, Test: 707.9805 [274.97], Avg: 508.7370 (0.010)
Ep: 412, Reward: 860.4178, Test: 867.0456 [48.78], Avg: 509.4865 (0.010)
Ep: 413, Reward: 871.6686, Test: 783.1423 [185.38], Avg: 509.6997 (0.010)
Ep: 414, Reward: 821.0474, Test: 837.4867 [100.26], Avg: 510.2480 (0.010)
Ep: 415, Reward: 881.7545, Test: 892.8199 [33.20], Avg: 511.0878 (0.010)
Ep: 416, Reward: 887.5410, Test: 890.4926 [66.15], Avg: 511.8390 (0.010)
Ep: 417, Reward: 872.4922, Test: 827.9953 [135.28], Avg: 512.2717 (0.010)
Ep: 418, Reward: 871.8513, Test: 807.1818 [164.99], Avg: 512.5818 (0.010)
Ep: 419, Reward: 867.1751, Test: 876.6171 [36.75], Avg: 513.3611 (0.010)
Ep: 420, Reward: 823.8244, Test: 802.9772 [153.69], Avg: 513.6839 (0.010)
Ep: 421, Reward: 899.3948, Test: 836.8874 [115.74], Avg: 514.1755 (0.010)
Ep: 422, Reward: 861.1995, Test: 870.4981 [35.72], Avg: 514.9335 (0.010)
Ep: 423, Reward: 857.6066, Test: 843.6848 [130.87], Avg: 515.4002 (0.010)
Ep: 424, Reward: 864.3246, Test: 828.6561 [148.50], Avg: 515.7878 (0.010)
Ep: 425, Reward: 922.1731, Test: 783.9742 [190.86], Avg: 515.9693 (0.010)
Ep: 426, Reward: 854.4117, Test: 880.5131 [20.41], Avg: 516.7753 (0.010)
Ep: 427, Reward: 897.9042, Test: 827.4130 [80.08], Avg: 517.3140 (0.010)
Ep: 428, Reward: 812.6064, Test: 816.0019 [159.57], Avg: 517.6382 (0.010)
Ep: 429, Reward: 833.0791, Test: 821.0568 [128.32], Avg: 518.0455 (0.010)
Ep: 430, Reward: 860.3738, Test: 659.2757 [191.24], Avg: 517.9294 (0.010)
Ep: 431, Reward: 813.0694, Test: 874.7219 [60.89], Avg: 518.6144 (0.010)
Ep: 432, Reward: 925.0524, Test: 900.2884 [23.15], Avg: 519.4424 (0.010)
Ep: 433, Reward: 926.9403, Test: 845.9779 [34.01], Avg: 520.1164 (0.010)
Ep: 434, Reward: 732.1864, Test: 791.9803 [186.43], Avg: 520.3128 (0.010)
Ep: 435, Reward: 850.4867, Test: 869.6960 [68.93], Avg: 520.9560 (0.010)
Ep: 436, Reward: 882.4392, Test: 752.0163 [179.73], Avg: 521.0735 (0.010)
Ep: 437, Reward: 839.3696, Test: 885.5074 [27.92], Avg: 521.8418 (0.010)
Ep: 438, Reward: 887.8301, Test: 852.3850 [79.58], Avg: 522.4134 (0.010)
Ep: 439, Reward: 831.2181, Test: 799.6964 [137.78], Avg: 522.7305 (0.010)
Ep: 440, Reward: 848.1935, Test: 772.0021 [176.05], Avg: 522.8965 (0.010)
Ep: 441, Reward: 827.4725, Test: 906.5849 [21.76], Avg: 523.7154 (0.010)
Ep: 442, Reward: 894.9319, Test: 827.8066 [166.49], Avg: 524.0260 (0.010)
Ep: 443, Reward: 883.6890, Test: 866.0588 [95.52], Avg: 524.5812 (0.010)
Ep: 444, Reward: 815.4922, Test: 782.1816 [189.20], Avg: 524.7349 (0.010)
Ep: 445, Reward: 843.0162, Test: 824.4319 [142.51], Avg: 525.0873 (0.010)
Ep: 446, Reward: 898.3701, Test: 829.0024 [73.36], Avg: 525.6031 (0.010)
Ep: 447, Reward: 833.5256, Test: 871.3745 [28.05], Avg: 526.3123 (0.010)
Ep: 448, Reward: 858.0118, Test: 757.3217 [200.41], Avg: 526.3805 (0.010)
Ep: 449, Reward: 765.0604, Test: 757.7645 [182.01], Avg: 526.4902 (0.010)
Ep: 450, Reward: 827.1915, Test: 791.2736 [163.18], Avg: 526.7155 (0.010)
Ep: 451, Reward: 752.6423, Test: 574.4144 [218.97], Avg: 526.3366 (0.010)
Ep: 452, Reward: 703.9513, Test: 780.9785 [150.21], Avg: 526.5671 (0.010)
Ep: 453, Reward: 843.6058, Test: 770.2362 [140.12], Avg: 526.7952 (0.010)
Ep: 454, Reward: 768.6073, Test: 709.0772 [226.82], Avg: 526.6973 (0.010)
Ep: 455, Reward: 781.0883, Test: 818.3057 [179.15], Avg: 526.9439 (0.010)
Ep: 456, Reward: 782.3380, Test: 850.8530 [21.77], Avg: 527.6051 (0.010)
Ep: 457, Reward: 875.6788, Test: 846.8791 [75.04], Avg: 528.1383 (0.010)
Ep: 458, Reward: 834.1268, Test: 866.6461 [14.93], Avg: 528.8433 (0.010)
Ep: 459, Reward: 820.0050, Test: 855.5561 [24.35], Avg: 529.5006 (0.010)
Ep: 460, Reward: 853.5074, Test: 885.0025 [26.42], Avg: 530.2144 (0.010)
Ep: 461, Reward: 870.1694, Test: 877.6196 [47.58], Avg: 530.8634 (0.010)
Ep: 462, Reward: 823.1501, Test: 888.0708 [31.60], Avg: 531.5667 (0.010)
Ep: 463, Reward: 878.8280, Test: 862.3302 [27.57], Avg: 532.2201 (0.010)
Ep: 464, Reward: 912.9905, Test: 865.3808 [26.70], Avg: 532.8792 (0.010)
Ep: 465, Reward: 811.7907, Test: 864.0050 [53.11], Avg: 533.4758 (0.010)
Ep: 466, Reward: 888.7210, Test: 801.2110 [192.33], Avg: 533.6372 (0.010)
Ep: 467, Reward: 750.2451, Test: 897.4202 [26.33], Avg: 534.3583 (0.010)
Ep: 468, Reward: 887.4621, Test: 800.2312 [160.38], Avg: 534.5832 (0.010)
Ep: 469, Reward: 862.2352, Test: 856.2248 [16.57], Avg: 535.2323 (0.010)
Ep: 470, Reward: 776.6709, Test: 825.4474 [116.25], Avg: 535.6017 (0.010)
Ep: 471, Reward: 782.0480, Test: 791.9933 [176.26], Avg: 535.7714 (0.010)
Ep: 472, Reward: 792.5238, Test: 844.0201 [29.27], Avg: 536.3612 (0.010)
Ep: 473, Reward: 743.6618, Test: 772.9526 [132.16], Avg: 536.5816 (0.010)
Ep: 474, Reward: 973.1537, Test: 891.1350 [32.68], Avg: 537.2592 (0.010)
Ep: 475, Reward: 942.9298, Test: 884.0082 [14.69], Avg: 537.9568 (0.010)
Ep: 476, Reward: 861.7898, Test: 812.4121 [203.96], Avg: 538.1046 (0.010)
Ep: 477, Reward: 918.1074, Test: 811.9669 [166.14], Avg: 538.3300 (0.010)
Ep: 478, Reward: 884.7876, Test: 806.0525 [206.45], Avg: 538.4579 (0.010)
Ep: 479, Reward: 780.7050, Test: 854.5298 [33.20], Avg: 539.0472 (0.010)
Ep: 480, Reward: 754.9236, Test: 720.4109 [224.51], Avg: 538.9575 (0.010)
Ep: 481, Reward: 658.0194, Test: 547.8008 [279.71], Avg: 538.3955 (0.010)
Ep: 482, Reward: 847.3185, Test: 836.3018 [112.89], Avg: 538.7786 (0.010)
Ep: 483, Reward: 839.4050, Test: 859.8771 [26.62], Avg: 539.3870 (0.010)
Ep: 484, Reward: 746.4863, Test: 689.7805 [231.68], Avg: 539.2194 (0.010)
Ep: 485, Reward: 751.5445, Test: 694.4232 [242.48], Avg: 539.0398 (0.010)
Ep: 486, Reward: 689.6548, Test: 877.1989 [27.28], Avg: 539.6782 (0.010)
Ep: 487, Reward: 795.3343, Test: 785.3738 [186.23], Avg: 539.8000 (0.010)
Ep: 488, Reward: 805.4361, Test: 815.5861 [155.47], Avg: 540.0461 (0.010)
Ep: 489, Reward: 702.8296, Test: 668.6754 [253.80], Avg: 539.7906 (0.010)
Ep: 490, Reward: 807.6129, Test: 786.8305 [117.54], Avg: 540.0544 (0.010)
Ep: 491, Reward: 714.3096, Test: 780.5741 [104.25], Avg: 540.3313 (0.010)
Ep: 492, Reward: 757.6013, Test: 768.0264 [206.26], Avg: 540.3748 (0.010)
Ep: 493, Reward: 781.1828, Test: 809.2129 [171.81], Avg: 540.5712 (0.010)
Ep: 494, Reward: 693.5501, Test: 645.6379 [249.82], Avg: 540.2788 (0.010)
Ep: 495, Reward: 547.9296, Test: 613.8909 [256.19], Avg: 539.9107 (0.010)
Ep: 496, Reward: 721.8476, Test: 760.7513 [216.40], Avg: 539.9196 (0.010)
Ep: 497, Reward: 758.7661, Test: 619.7697 [286.61], Avg: 539.5045 (0.010)
Ep: 498, Reward: 720.9208, Test: 721.7942 [255.06], Avg: 539.3586 (0.010)
Ep: 499, Reward: 657.5550, Test: 617.0178 [202.56], Avg: 539.1088 (0.010)
