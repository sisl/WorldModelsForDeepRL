Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.99			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -65.7590, Test: -61.2409 [16.81], Avg: -78.0500 (0.980)
Ep: 1, Reward: -57.2530, Test: -55.7779 [21.65], Avg: -77.7413 (0.960)
Ep: 2, Reward: -51.6672, Test: -57.6514 [14.73], Avg: -75.9543 (0.941)
Ep: 3, Reward: -54.3300, Test: -49.9405 [17.35], Avg: -73.7882 (0.922)
Ep: 4, Reward: -52.6219, Test: -43.0792 [28.68], Avg: -73.3827 (0.904)
Ep: 5, Reward: -45.5967, Test: -65.8238 [25.66], Avg: -76.4002 (0.886)
Ep: 6, Reward: -52.6897, Test: -60.2311 [20.55], Avg: -77.0255 (0.868)
Ep: 7, Reward: -50.6840, Test: -48.2446 [39.39], Avg: -78.3521 (0.851)
Ep: 8, Reward: -50.4237, Test: -45.3552 [20.77], Avg: -76.9939 (0.834)
Ep: 9, Reward: -48.0761, Test: -59.1095 [14.61], Avg: -76.6660 (0.817)
Ep: 10, Reward: -45.1647, Test: -43.8003 [17.11], Avg: -75.2335 (0.801)
Ep: 11, Reward: -46.2088, Test: -41.9091 [47.48], Avg: -76.4132 (0.785)
Ep: 12, Reward: -48.2720, Test: -36.0148 [26.83], Avg: -75.3696 (0.769)
Ep: 13, Reward: -42.6927, Test: -51.0469 [23.59], Avg: -75.3175 (0.754)
Ep: 14, Reward: -47.5868, Test: -61.1729 [16.50], Avg: -75.4744 (0.739)
Ep: 15, Reward: -46.5663, Test: -31.1219 [33.76], Avg: -74.8123 (0.724)
Ep: 16, Reward: -37.3217, Test: -37.6535 [28.07], Avg: -74.2775 (0.709)
Ep: 17, Reward: -48.7947, Test: -24.7270 [29.08], Avg: -73.1404 (0.695)
Ep: 18, Reward: -31.3169, Test: -45.2466 [15.64], Avg: -72.4952 (0.681)
Ep: 19, Reward: -25.8988, Test: -23.7827 [49.60], Avg: -72.5397 (0.668)
Ep: 20, Reward: -33.4170, Test: -41.2710 [26.87], Avg: -72.3304 (0.654)
Ep: 21, Reward: -31.3810, Test: -35.6947 [35.66], Avg: -72.2860 (0.641)
Ep: 22, Reward: -22.2660, Test: -34.5831 [22.28], Avg: -71.6153 (0.628)
Ep: 23, Reward: -43.9666, Test: 5.0178 [38.83], Avg: -70.0403 (0.616)
Ep: 24, Reward: -15.1683, Test: -18.8547 [40.09], Avg: -69.5965 (0.603)
Ep: 25, Reward: -33.1605, Test: -14.8101 [27.47], Avg: -68.5459 (0.591)
Ep: 26, Reward: -18.2283, Test: -39.4745 [39.54], Avg: -68.9335 (0.580)
Ep: 27, Reward: -11.0165, Test: -11.2708 [54.41], Avg: -68.8175 (0.568)
Ep: 28, Reward: -22.5678, Test: -19.4435 [16.28], Avg: -67.6762 (0.557)
Ep: 29, Reward: -41.8120, Test: -28.8414 [35.87], Avg: -67.5774 (0.545)
Ep: 30, Reward: -10.8176, Test: -12.6726 [69.03], Avg: -68.0331 (0.535)
Ep: 31, Reward: 3.8440, Test: 13.0570 [37.19], Avg: -66.6612 (0.524)
Ep: 32, Reward: 20.0923, Test: 1.5419 [58.14], Avg: -66.3563 (0.513)
Ep: 33, Reward: 12.4285, Test: 8.9406 [38.56], Avg: -65.2759 (0.503)
Ep: 34, Reward: 3.5077, Test: -24.8300 [52.00], Avg: -65.6061 (0.493)
Ep: 35, Reward: 14.4532, Test: 77.2125 [118.49], Avg: -64.9304 (0.483)
Ep: 36, Reward: 6.7843, Test: 27.8447 [81.69], Avg: -64.6307 (0.474)
Ep: 37, Reward: 4.7823, Test: 7.6125 [42.91], Avg: -63.8589 (0.464)
Ep: 38, Reward: 14.4741, Test: 32.5760 [79.42], Avg: -63.4227 (0.455)
Ep: 39, Reward: 42.4233, Test: 72.8517 [121.87], Avg: -63.0625 (0.446)
Ep: 40, Reward: 43.0492, Test: 76.5620 [106.67], Avg: -62.2586 (0.437)
Ep: 41, Reward: 105.3900, Test: 51.9513 [47.27], Avg: -60.6649 (0.428)
Ep: 42, Reward: 37.0132, Test: 90.1238 [95.11], Avg: -59.3699 (0.419)
Ep: 43, Reward: 88.5358, Test: 74.2319 [97.34], Avg: -58.5458 (0.411)
Ep: 44, Reward: 44.2763, Test: 57.8959 [116.42], Avg: -58.5454 (0.403)
Ep: 45, Reward: 112.7049, Test: 70.5899 [62.72], Avg: -57.1016 (0.395)
Ep: 46, Reward: 92.9872, Test: 46.4894 [60.73], Avg: -56.1897 (0.387)
Ep: 47, Reward: 135.8474, Test: 147.8669 [96.76], Avg: -53.9544 (0.379)
Ep: 48, Reward: 109.0219, Test: 124.6822 [84.86], Avg: -52.0406 (0.372)
Ep: 49, Reward: 105.8085, Test: 186.1056 [102.52], Avg: -49.3282 (0.364)
Ep: 50, Reward: 93.5200, Test: 118.0021 [131.26], Avg: -48.6208 (0.357)
Ep: 51, Reward: 190.7136, Test: 135.8358 [117.75], Avg: -47.3381 (0.350)
Ep: 52, Reward: 133.2309, Test: 103.2717 [131.19], Avg: -46.9716 (0.343)
Ep: 53, Reward: 141.5958, Test: 147.0617 [122.83], Avg: -45.6530 (0.336)
Ep: 54, Reward: 122.8798, Test: 203.7053 [115.30], Avg: -43.2156 (0.329)
Ep: 55, Reward: 132.7506, Test: 75.8983 [136.86], Avg: -43.5326 (0.323)
Ep: 56, Reward: 173.6392, Test: 168.8262 [152.37], Avg: -42.4802 (0.316)
Ep: 57, Reward: 111.9154, Test: 192.1731 [156.65], Avg: -41.1353 (0.310)
Ep: 58, Reward: 184.2617, Test: 147.1116 [130.95], Avg: -40.1641 (0.304)
Ep: 59, Reward: 202.6185, Test: 133.5317 [129.86], Avg: -39.4335 (0.298)
Ep: 60, Reward: 87.0603, Test: 204.9437 [180.38], Avg: -38.3844 (0.292)
Ep: 61, Reward: 228.9434, Test: 258.1417 [168.11], Avg: -36.3132 (0.286)
Ep: 62, Reward: 252.5539, Test: 225.9800 [84.00], Avg: -33.4832 (0.280)
Ep: 63, Reward: 271.4710, Test: 214.0447 [178.61], Avg: -32.4063 (0.274)
Ep: 64, Reward: 166.7935, Test: 202.8174 [160.80], Avg: -31.2612 (0.269)
Ep: 65, Reward: 424.8162, Test: 327.7499 [122.81], Avg: -27.6824 (0.264)
Ep: 66, Reward: 365.5300, Test: 330.3249 [171.19], Avg: -24.8941 (0.258)
Ep: 67, Reward: 348.6935, Test: 349.9800 [184.21], Avg: -22.0902 (0.253)
Ep: 68, Reward: 380.7886, Test: 359.6804 [99.67], Avg: -18.0018 (0.248)
Ep: 69, Reward: 324.7798, Test: 385.1617 [217.28], Avg: -15.3463 (0.243)
Ep: 70, Reward: 382.3289, Test: 448.4945 [199.02], Avg: -11.6164 (0.238)
Ep: 71, Reward: 453.9805, Test: 442.0188 [262.37], Avg: -8.9600 (0.233)
Ep: 72, Reward: 413.4496, Test: 411.4859 [167.51], Avg: -5.4952 (0.229)
Ep: 73, Reward: 477.6099, Test: 431.4630 [164.69], Avg: -1.8158 (0.224)
Ep: 74, Reward: 384.2891, Test: 381.2945 [210.18], Avg: 0.4899 (0.220)
Ep: 75, Reward: 422.3361, Test: 266.4876 [270.45], Avg: 0.4314 (0.215)
Ep: 76, Reward: 463.4219, Test: 338.4291 [173.41], Avg: 2.5688 (0.211)
Ep: 77, Reward: 455.5774, Test: 454.6705 [191.66], Avg: 5.9078 (0.207)
Ep: 78, Reward: 536.5398, Test: 480.1121 [244.49], Avg: 8.8156 (0.203)
Ep: 79, Reward: 502.9961, Test: 538.0772 [170.47], Avg: 13.3005 (0.199)
Ep: 80, Reward: 482.8258, Test: 484.0030 [176.68], Avg: 16.9304 (0.195)
Ep: 81, Reward: 490.7156, Test: 533.4900 [216.48], Avg: 20.5899 (0.191)
Ep: 82, Reward: 503.5362, Test: 618.5815 [161.25], Avg: 25.8518 (0.187)
Ep: 83, Reward: 457.4303, Test: 611.4217 [126.05], Avg: 31.3223 (0.183)
Ep: 84, Reward: 587.4108, Test: 622.3191 [181.70], Avg: 36.1375 (0.180)
Ep: 85, Reward: 623.8964, Test: 501.0205 [186.09], Avg: 39.3792 (0.176)
Ep: 86, Reward: 584.8008, Test: 434.3627 [209.37], Avg: 41.5127 (0.172)
Ep: 87, Reward: 619.1394, Test: 530.3410 [247.95], Avg: 44.2500 (0.169)
Ep: 88, Reward: 546.9464, Test: 486.2848 [194.31], Avg: 47.0334 (0.166)
Ep: 89, Reward: 562.3574, Test: 580.6022 [204.41], Avg: 50.6907 (0.162)
Ep: 90, Reward: 688.8287, Test: 607.0261 [189.57], Avg: 54.7211 (0.159)
Ep: 91, Reward: 656.9192, Test: 618.9729 [200.84], Avg: 58.6712 (0.156)
Ep: 92, Reward: 515.6202, Test: 514.9872 [254.43], Avg: 60.8420 (0.153)
Ep: 93, Reward: 545.3731, Test: 718.4135 [151.09], Avg: 66.2302 (0.150)
Ep: 94, Reward: 674.8864, Test: 592.8065 [221.23], Avg: 69.4444 (0.147)
Ep: 95, Reward: 712.9297, Test: 655.2757 [219.32], Avg: 73.2622 (0.144)
Ep: 96, Reward: 650.1624, Test: 665.0280 [176.80], Avg: 77.5402 (0.141)
Ep: 97, Reward: 733.2874, Test: 654.2481 [179.80], Avg: 81.5903 (0.138)
Ep: 98, Reward: 557.7233, Test: 707.9442 [121.10], Avg: 86.6938 (0.135)
Ep: 99, Reward: 596.0261, Test: 671.1257 [164.03], Avg: 90.8978 (0.133)
Ep: 100, Reward: 595.4900, Test: 497.8252 [181.11], Avg: 93.1336 (0.130)
Ep: 101, Reward: 469.9863, Test: 429.8107 [130.05], Avg: 95.1594 (0.127)
Ep: 102, Reward: 636.3394, Test: 488.0268 [149.72], Avg: 97.5200 (0.125)
Ep: 103, Reward: 579.6676, Test: 474.8584 [241.35], Avg: 98.8276 (0.122)
Ep: 104, Reward: 597.9398, Test: 577.0248 [173.34], Avg: 101.7311 (0.120)
Ep: 105, Reward: 596.4265, Test: 630.6707 [225.24], Avg: 104.5962 (0.117)
Ep: 106, Reward: 660.7839, Test: 710.1373 [122.46], Avg: 109.1109 (0.115)
Ep: 107, Reward: 593.9228, Test: 697.9217 [195.92], Avg: 112.7488 (0.113)
Ep: 108, Reward: 661.2815, Test: 694.5605 [172.03], Avg: 116.5083 (0.111)
Ep: 109, Reward: 667.3811, Test: 718.7498 [83.96], Avg: 121.2199 (0.108)
Ep: 110, Reward: 771.7237, Test: 787.9042 [71.67], Avg: 126.5804 (0.106)
Ep: 111, Reward: 821.2621, Test: 798.7956 [47.02], Avg: 132.1625 (0.104)
Ep: 112, Reward: 829.9936, Test: 851.7993 [74.83], Avg: 137.8688 (0.102)
Ep: 113, Reward: 792.0319, Test: 848.5424 [21.53], Avg: 143.9139 (0.100)
Ep: 114, Reward: 775.9151, Test: 810.4705 [47.99], Avg: 149.2928 (0.098)
Ep: 115, Reward: 793.5742, Test: 781.9704 [65.91], Avg: 154.1787 (0.096)
Ep: 116, Reward: 820.0219, Test: 849.8631 [39.52], Avg: 159.7869 (0.094)
Ep: 117, Reward: 805.0341, Test: 846.6500 [39.88], Avg: 165.2698 (0.092)
Ep: 118, Reward: 787.0635, Test: 812.6244 [85.35], Avg: 169.9925 (0.090)
Ep: 119, Reward: 826.4104, Test: 830.1666 [70.31], Avg: 174.9080 (0.089)
Ep: 120, Reward: 826.7053, Test: 801.0228 [146.30], Avg: 178.8734 (0.087)
Ep: 121, Reward: 769.7639, Test: 731.9841 [202.79], Avg: 181.7449 (0.085)
Ep: 122, Reward: 851.1198, Test: 757.5010 [143.00], Avg: 185.2632 (0.083)
Ep: 123, Reward: 865.1824, Test: 855.4962 [75.09], Avg: 190.0628 (0.082)
Ep: 124, Reward: 732.5440, Test: 844.8507 [85.77], Avg: 194.6149 (0.080)
Ep: 125, Reward: 866.0804, Test: 858.9385 [44.22], Avg: 199.5364 (0.078)
Ep: 126, Reward: 882.9767, Test: 797.4996 [176.95], Avg: 202.8514 (0.077)
Ep: 127, Reward: 841.2381, Test: 792.8890 [156.83], Avg: 206.2359 (0.075)
Ep: 128, Reward: 831.9894, Test: 786.7901 [90.81], Avg: 210.0323 (0.074)
Ep: 129, Reward: 864.4353, Test: 859.1451 [22.54], Avg: 214.8522 (0.072)
Ep: 130, Reward: 872.7663, Test: 864.6318 [41.04], Avg: 219.4990 (0.071)
Ep: 131, Reward: 921.7124, Test: 750.2579 [158.96], Avg: 222.3157 (0.069)
Ep: 132, Reward: 862.7552, Test: 875.1408 [28.44], Avg: 227.0103 (0.068)
Ep: 133, Reward: 906.5751, Test: 873.0453 [40.15], Avg: 231.5319 (0.067)
Ep: 134, Reward: 912.9975, Test: 855.2881 [25.74], Avg: 235.9617 (0.065)
Ep: 135, Reward: 898.1307, Test: 853.1691 [35.79], Avg: 240.2368 (0.064)
Ep: 136, Reward: 869.4047, Test: 883.7800 [14.76], Avg: 244.8264 (0.063)
Ep: 137, Reward: 958.1895, Test: 894.5001 [22.88], Avg: 249.3684 (0.062)
Ep: 138, Reward: 960.3276, Test: 832.4166 [180.76], Avg: 252.2626 (0.060)
Ep: 139, Reward: 994.4013, Test: 888.9211 [23.61], Avg: 256.6415 (0.059)
Ep: 140, Reward: 921.6315, Test: 863.6957 [45.14], Avg: 260.6267 (0.058)
Ep: 141, Reward: 883.5232, Test: 875.9075 [37.48], Avg: 264.6957 (0.057)
Ep: 142, Reward: 898.9183, Test: 895.9718 [16.69], Avg: 268.9935 (0.056)
Ep: 143, Reward: 943.2776, Test: 879.6532 [37.21], Avg: 272.9758 (0.055)
Ep: 144, Reward: 903.1494, Test: 898.8257 [23.23], Avg: 277.1318 (0.053)
Ep: 145, Reward: 887.8367, Test: 881.5327 [30.16], Avg: 281.0650 (0.052)
Ep: 146, Reward: 881.1749, Test: 866.2711 [57.51], Avg: 284.6547 (0.051)
Ep: 147, Reward: 890.2473, Test: 859.3540 [57.51], Avg: 288.1493 (0.050)
Ep: 148, Reward: 891.4105, Test: 889.8569 [33.67], Avg: 291.9616 (0.049)
Ep: 149, Reward: 883.8884, Test: 881.5196 [38.70], Avg: 295.6340 (0.048)
Ep: 150, Reward: 897.5295, Test: 852.6503 [82.93], Avg: 298.7736 (0.047)
Ep: 151, Reward: 877.4902, Test: 882.0765 [15.33], Avg: 302.5103 (0.046)
Ep: 152, Reward: 888.4604, Test: 851.8032 [47.56], Avg: 305.7896 (0.045)
Ep: 153, Reward: 883.8565, Test: 849.4229 [105.64], Avg: 308.6337 (0.045)
Ep: 154, Reward: 903.3497, Test: 880.6862 [42.74], Avg: 312.0486 (0.044)
Ep: 155, Reward: 833.4913, Test: 781.0521 [101.34], Avg: 314.4055 (0.043)
Ep: 156, Reward: 811.5936, Test: 848.7033 [25.16], Avg: 317.6484 (0.042)
Ep: 157, Reward: 833.2529, Test: 849.9289 [42.09], Avg: 320.7508 (0.041)
Ep: 158, Reward: 770.3033, Test: 757.5342 [159.99], Avg: 322.4917 (0.040)
Ep: 159, Reward: 745.7786, Test: 782.6772 [154.32], Avg: 324.4034 (0.039)
Ep: 160, Reward: 802.7745, Test: 892.2072 [17.94], Avg: 327.8187 (0.039)
Ep: 161, Reward: 908.0146, Test: 746.1781 [50.74], Avg: 330.0879 (0.038)
Ep: 162, Reward: 821.3774, Test: 826.6337 [45.43], Avg: 332.8556 (0.037)
Ep: 163, Reward: 860.2020, Test: 717.2769 [126.44], Avg: 334.4286 (0.036)
Ep: 164, Reward: 847.6984, Test: 811.3295 [167.08], Avg: 336.3063 (0.036)
Ep: 165, Reward: 873.3649, Test: 885.7937 [28.67], Avg: 339.4437 (0.035)
Ep: 166, Reward: 824.5726, Test: 843.2542 [83.38], Avg: 341.9613 (0.034)
Ep: 167, Reward: 787.8697, Test: 843.4685 [31.32], Avg: 344.7600 (0.034)
Ep: 168, Reward: 729.1564, Test: 798.0446 [155.31], Avg: 346.5232 (0.033)
Ep: 169, Reward: 812.1335, Test: 777.3831 [105.14], Avg: 348.4392 (0.032)
Ep: 170, Reward: 777.6329, Test: 817.6987 [53.88], Avg: 350.8684 (0.032)
Ep: 171, Reward: 788.3164, Test: 834.9579 [88.10], Avg: 353.1706 (0.031)
Ep: 172, Reward: 847.0283, Test: 840.6968 [20.35], Avg: 355.8711 (0.030)
Ep: 173, Reward: 834.3352, Test: 839.7520 [24.49], Avg: 358.5113 (0.030)
Ep: 174, Reward: 834.3747, Test: 859.7604 [15.18], Avg: 361.2888 (0.029)
Ep: 175, Reward: 841.0337, Test: 861.7584 [14.29], Avg: 364.0512 (0.029)
Ep: 176, Reward: 895.5178, Test: 861.7334 [18.44], Avg: 366.7588 (0.028)
Ep: 177, Reward: 855.8889, Test: 840.0332 [36.31], Avg: 369.2136 (0.027)
Ep: 178, Reward: 838.5867, Test: 811.2230 [129.27], Avg: 370.9608 (0.027)
Ep: 179, Reward: 802.6603, Test: 849.0458 [32.94], Avg: 373.4338 (0.026)
Ep: 180, Reward: 799.1067, Test: 868.0227 [28.11], Avg: 376.0110 (0.026)
Ep: 181, Reward: 817.1888, Test: 799.5173 [76.81], Avg: 377.9159 (0.025)
Ep: 182, Reward: 823.8336, Test: 863.7640 [35.91], Avg: 380.3746 (0.025)
Ep: 183, Reward: 868.9235, Test: 838.4171 [35.83], Avg: 382.6692 (0.024)
Ep: 184, Reward: 773.6323, Test: 810.7545 [68.83], Avg: 384.6111 (0.024)
Ep: 185, Reward: 855.4922, Test: 851.6807 [53.26], Avg: 386.8359 (0.023)
Ep: 186, Reward: 916.7449, Test: 855.0473 [35.79], Avg: 389.1483 (0.023)
Ep: 187, Reward: 952.4221, Test: 835.0451 [62.49], Avg: 391.1877 (0.022)
Ep: 188, Reward: 853.8390, Test: 827.9940 [62.37], Avg: 393.1689 (0.022)
Ep: 189, Reward: 757.4724, Test: 869.2970 [25.83], Avg: 395.5389 (0.022)
Ep: 190, Reward: 831.9385, Test: 792.4520 [63.59], Avg: 397.2840 (0.021)
Ep: 191, Reward: 877.6552, Test: 866.7862 [40.64], Avg: 399.5177 (0.021)
Ep: 192, Reward: 884.0150, Test: 858.0704 [19.38], Avg: 401.7932 (0.020)
Ep: 193, Reward: 865.3949, Test: 868.2020 [56.21], Avg: 403.9076 (0.020)
Ep: 194, Reward: 825.8124, Test: 871.3214 [47.24], Avg: 406.0623 (0.020)
Ep: 195, Reward: 883.3878, Test: 881.1590 [24.08], Avg: 408.3634 (0.020)
Ep: 196, Reward: 881.1944, Test: 861.9110 [27.75], Avg: 410.5249 (0.020)
Ep: 197, Reward: 816.4103, Test: 859.3996 [40.68], Avg: 412.5864 (0.020)
Ep: 198, Reward: 892.9171, Test: 832.3593 [65.33], Avg: 414.3675 (0.020)
Ep: 199, Reward: 886.5454, Test: 860.5539 [28.57], Avg: 416.4556 (0.020)
Ep: 200, Reward: 868.5415, Test: 857.8292 [38.81], Avg: 418.4585 (0.020)
Ep: 201, Reward: 849.1105, Test: 786.0985 [88.95], Avg: 419.8381 (0.020)
Ep: 202, Reward: 780.8229, Test: 854.6568 [35.28], Avg: 421.8063 (0.020)
Ep: 203, Reward: 864.2236, Test: 866.8116 [18.55], Avg: 423.8968 (0.020)
Ep: 204, Reward: 857.7175, Test: 798.2062 [175.49], Avg: 424.8666 (0.020)
Ep: 205, Reward: 880.0233, Test: 840.7796 [27.04], Avg: 426.7543 (0.020)
Ep: 206, Reward: 820.7738, Test: 859.4852 [15.98], Avg: 428.7676 (0.020)
Ep: 207, Reward: 886.9513, Test: 870.8403 [25.80], Avg: 430.7689 (0.020)
Ep: 208, Reward: 867.8446, Test: 858.7091 [19.60], Avg: 432.7227 (0.020)
Ep: 209, Reward: 841.4451, Test: 870.8986 [30.23], Avg: 434.6653 (0.020)
Ep: 210, Reward: 861.1694, Test: 847.1654 [55.88], Avg: 436.3554 (0.020)
Ep: 211, Reward: 866.2716, Test: 866.6544 [16.15], Avg: 438.3090 (0.020)
Ep: 212, Reward: 898.0488, Test: 859.1635 [40.55], Avg: 440.0945 (0.020)
Ep: 213, Reward: 867.0791, Test: 844.9310 [20.18], Avg: 441.8919 (0.020)
Ep: 214, Reward: 898.6056, Test: 840.5998 [40.10], Avg: 443.5599 (0.020)
Ep: 215, Reward: 853.8332, Test: 839.3187 [77.32], Avg: 445.0342 (0.020)
Ep: 216, Reward: 836.4638, Test: 815.7856 [53.61], Avg: 446.4957 (0.020)
Ep: 217, Reward: 752.8611, Test: 820.6608 [80.56], Avg: 447.8425 (0.020)
Ep: 218, Reward: 883.0079, Test: 817.0337 [65.65], Avg: 449.2285 (0.020)
Ep: 219, Reward: 846.3983, Test: 862.7493 [40.66], Avg: 450.9233 (0.020)
Ep: 220, Reward: 848.6970, Test: 825.2501 [41.74], Avg: 452.4283 (0.020)
Ep: 221, Reward: 843.7838, Test: 791.8368 [55.01], Avg: 453.7093 (0.020)
Ep: 222, Reward: 806.1206, Test: 870.2825 [15.72], Avg: 455.5069 (0.020)
Ep: 223, Reward: 807.7648, Test: 818.2723 [56.74], Avg: 456.8730 (0.020)
Ep: 224, Reward: 798.8160, Test: 765.0264 [156.16], Avg: 457.5486 (0.020)
Ep: 225, Reward: 790.6282, Test: 832.3118 [64.94], Avg: 458.9195 (0.020)
Ep: 226, Reward: 787.6323, Test: 773.5088 [159.25], Avg: 459.6038 (0.020)
Ep: 227, Reward: 859.8045, Test: 849.5737 [36.04], Avg: 461.1561 (0.020)
Ep: 228, Reward: 875.0046, Test: 861.1791 [14.40], Avg: 462.8401 (0.020)
Ep: 229, Reward: 897.6974, Test: 866.5319 [18.87], Avg: 464.5132 (0.020)
Ep: 230, Reward: 833.5388, Test: 824.0810 [142.51], Avg: 465.4529 (0.020)
Ep: 231, Reward: 876.8650, Test: 805.6171 [35.58], Avg: 466.7657 (0.020)
Ep: 232, Reward: 901.5894, Test: 854.5999 [49.07], Avg: 468.2196 (0.020)
Ep: 233, Reward: 789.9442, Test: 837.9420 [66.25], Avg: 469.5165 (0.020)
Ep: 234, Reward: 828.5376, Test: 845.7240 [46.56], Avg: 470.9193 (0.020)
Ep: 235, Reward: 905.6568, Test: 868.0756 [24.87], Avg: 472.4968 (0.020)
Ep: 236, Reward: 867.1316, Test: 836.1956 [86.05], Avg: 473.6683 (0.020)
Ep: 237, Reward: 815.5602, Test: 880.7769 [22.50], Avg: 475.2843 (0.020)
Ep: 238, Reward: 882.5714, Test: 875.9512 [24.99], Avg: 476.8561 (0.020)
Ep: 239, Reward: 869.4615, Test: 886.0072 [25.99], Avg: 478.4527 (0.020)
Ep: 240, Reward: 877.8483, Test: 871.3086 [39.39], Avg: 479.9193 (0.020)
Ep: 241, Reward: 859.8567, Test: 875.1015 [12.87], Avg: 481.4991 (0.020)
Ep: 242, Reward: 856.7366, Test: 832.6153 [91.08], Avg: 482.5692 (0.020)
Ep: 243, Reward: 832.2052, Test: 841.9218 [68.67], Avg: 483.7605 (0.020)
Ep: 244, Reward: 831.8670, Test: 850.2827 [42.66], Avg: 485.0824 (0.020)
Ep: 245, Reward: 853.9159, Test: 855.4211 [22.48], Avg: 486.4965 (0.020)
Ep: 246, Reward: 866.7603, Test: 825.4700 [47.80], Avg: 487.6754 (0.020)
Ep: 247, Reward: 827.4270, Test: 849.6973 [36.76], Avg: 488.9869 (0.020)
Ep: 248, Reward: 882.7566, Test: 866.4603 [27.70], Avg: 490.3916 (0.020)
Ep: 249, Reward: 897.2168, Test: 895.2808 [17.53], Avg: 491.9411 (0.020)
Ep: 250, Reward: 893.2371, Test: 860.0032 [65.52], Avg: 493.1464 (0.020)
Ep: 251, Reward: 868.6865, Test: 862.1861 [34.94], Avg: 494.4722 (0.020)
Ep: 252, Reward: 848.9517, Test: 851.5191 [59.45], Avg: 495.6485 (0.020)
Ep: 253, Reward: 857.2247, Test: 882.8708 [17.62], Avg: 497.1036 (0.020)
Ep: 254, Reward: 818.2818, Test: 865.4441 [34.36], Avg: 498.4134 (0.020)
Ep: 255, Reward: 881.3113, Test: 883.1583 [16.95], Avg: 499.8501 (0.020)
Ep: 256, Reward: 860.2570, Test: 801.5727 [137.08], Avg: 500.4907 (0.020)
Ep: 257, Reward: 843.3242, Test: 842.9665 [69.79], Avg: 501.5476 (0.020)
Ep: 258, Reward: 834.2395, Test: 863.1362 [33.69], Avg: 502.8136 (0.020)
Ep: 259, Reward: 851.9541, Test: 840.0394 [48.58], Avg: 503.9238 (0.020)
Ep: 260, Reward: 835.0305, Test: 742.0104 [234.80], Avg: 503.9364 (0.020)
Ep: 261, Reward: 837.6477, Test: 828.7758 [69.91], Avg: 504.9094 (0.020)
Ep: 262, Reward: 801.6546, Test: 796.4732 [100.34], Avg: 505.6365 (0.020)
Ep: 263, Reward: 857.0375, Test: 802.2369 [155.60], Avg: 506.1706 (0.020)
Ep: 264, Reward: 875.7738, Test: 834.9996 [66.82], Avg: 507.1593 (0.020)
Ep: 265, Reward: 802.4818, Test: 805.9595 [55.75], Avg: 508.0730 (0.020)
Ep: 266, Reward: 847.5521, Test: 861.1448 [37.45], Avg: 509.2551 (0.020)
Ep: 267, Reward: 885.4647, Test: 817.4176 [165.33], Avg: 509.7880 (0.020)
Ep: 268, Reward: 853.9062, Test: 835.9419 [63.15], Avg: 510.7658 (0.020)
Ep: 269, Reward: 828.6501, Test: 865.6641 [17.80], Avg: 512.0143 (0.020)
Ep: 270, Reward: 853.8570, Test: 877.5005 [17.81], Avg: 513.2972 (0.020)
Ep: 271, Reward: 856.2237, Test: 904.5483 [15.34], Avg: 514.6792 (0.020)
Ep: 272, Reward: 866.7755, Test: 846.3203 [39.09], Avg: 515.7508 (0.020)
Ep: 273, Reward: 870.4076, Test: 842.5228 [65.84], Avg: 516.7031 (0.020)
Ep: 274, Reward: 873.6736, Test: 855.9548 [54.71], Avg: 517.7378 (0.020)
Ep: 275, Reward: 824.4549, Test: 853.0197 [97.97], Avg: 518.5976 (0.020)
Ep: 276, Reward: 906.6537, Test: 819.8634 [158.64], Avg: 519.1125 (0.020)
Ep: 277, Reward: 839.3534, Test: 872.7292 [22.16], Avg: 520.3048 (0.020)
Ep: 278, Reward: 883.9519, Test: 802.7913 [108.49], Avg: 520.9284 (0.020)
Ep: 279, Reward: 882.4821, Test: 832.5241 [68.60], Avg: 521.7963 (0.020)
Ep: 280, Reward: 875.4585, Test: 850.4146 [38.17], Avg: 522.8299 (0.020)
Ep: 281, Reward: 775.2224, Test: 800.0995 [118.59], Avg: 523.3926 (0.020)
Ep: 282, Reward: 933.0890, Test: 896.0394 [14.04], Avg: 524.6597 (0.020)
Ep: 283, Reward: 912.4901, Test: 886.3771 [25.84], Avg: 525.8424 (0.020)
Ep: 284, Reward: 918.2609, Test: 803.6454 [108.99], Avg: 526.4347 (0.020)
Ep: 285, Reward: 884.8973, Test: 902.4550 [23.02], Avg: 527.6690 (0.020)
Ep: 286, Reward: 962.6849, Test: 905.7931 [18.77], Avg: 528.9211 (0.020)
Ep: 287, Reward: 995.4754, Test: 894.3682 [15.83], Avg: 530.1350 (0.020)
Ep: 288, Reward: 935.9839, Test: 864.2099 [20.94], Avg: 531.2185 (0.020)
Ep: 289, Reward: 909.4512, Test: 872.5462 [16.98], Avg: 532.3370 (0.020)
Ep: 290, Reward: 948.7745, Test: 880.9585 [12.28], Avg: 533.4928 (0.020)
Ep: 291, Reward: 884.6217, Test: 842.9649 [85.15], Avg: 534.2610 (0.020)
Ep: 292, Reward: 874.9390, Test: 868.6474 [33.69], Avg: 535.2873 (0.020)
Ep: 293, Reward: 904.4664, Test: 872.5739 [53.47], Avg: 536.2527 (0.020)
Ep: 294, Reward: 863.2855, Test: 870.0372 [16.25], Avg: 537.3290 (0.020)
Ep: 295, Reward: 824.6375, Test: 806.0589 [50.53], Avg: 538.0662 (0.020)
Ep: 296, Reward: 830.7074, Test: 766.1544 [81.07], Avg: 538.5612 (0.020)
Ep: 297, Reward: 819.2332, Test: 815.2890 [36.77], Avg: 539.3665 (0.020)
Ep: 298, Reward: 801.1978, Test: 885.1551 [14.40], Avg: 540.4748 (0.020)
Ep: 299, Reward: 863.0175, Test: 785.4783 [111.76], Avg: 540.9189 (0.020)
Ep: 300, Reward: 852.6856, Test: 791.6241 [112.86], Avg: 541.3769 (0.020)
Ep: 301, Reward: 861.3637, Test: 868.1211 [43.48], Avg: 542.3149 (0.020)
Ep: 302, Reward: 842.9331, Test: 846.3970 [57.83], Avg: 543.1276 (0.020)
Ep: 303, Reward: 905.0249, Test: 853.7120 [58.10], Avg: 543.9581 (0.020)
Ep: 304, Reward: 876.8791, Test: 888.6507 [23.39], Avg: 545.0115 (0.020)
Ep: 305, Reward: 893.3553, Test: 866.1634 [104.84], Avg: 545.7184 (0.020)
Ep: 306, Reward: 981.1599, Test: 891.2359 [42.21], Avg: 546.7064 (0.020)
Ep: 307, Reward: 896.3866, Test: 808.8994 [73.44], Avg: 547.3193 (0.020)
Ep: 308, Reward: 915.4410, Test: 792.7889 [122.51], Avg: 547.7172 (0.020)
Ep: 309, Reward: 877.6509, Test: 874.9301 [35.72], Avg: 548.6575 (0.020)
Ep: 310, Reward: 881.6309, Test: 852.5439 [47.31], Avg: 549.4825 (0.020)
Ep: 311, Reward: 840.8480, Test: 829.7130 [196.30], Avg: 549.7515 (0.020)
Ep: 312, Reward: 908.7752, Test: 866.7378 [23.81], Avg: 550.6882 (0.020)
Ep: 313, Reward: 906.5304, Test: 889.2006 [25.42], Avg: 551.6853 (0.020)
Ep: 314, Reward: 1007.6047, Test: 867.4750 [47.17], Avg: 552.5381 (0.020)
Ep: 315, Reward: 870.8692, Test: 871.9884 [39.50], Avg: 553.4240 (0.020)
Ep: 316, Reward: 890.4373, Test: 866.8102 [30.13], Avg: 554.3175 (0.020)
Ep: 317, Reward: 878.9483, Test: 885.4981 [19.13], Avg: 555.2988 (0.020)
Ep: 318, Reward: 844.1238, Test: 876.5504 [29.29], Avg: 556.2141 (0.020)
Ep: 319, Reward: 855.0904, Test: 826.8013 [22.73], Avg: 556.9886 (0.020)
Ep: 320, Reward: 889.7321, Test: 853.3829 [20.83], Avg: 557.8471 (0.020)
Ep: 321, Reward: 873.2310, Test: 846.6232 [83.49], Avg: 558.4846 (0.020)
Ep: 322, Reward: 891.5671, Test: 853.5215 [81.49], Avg: 559.1458 (0.020)
Ep: 323, Reward: 910.8284, Test: 893.8469 [20.35], Avg: 560.1160 (0.020)
Ep: 324, Reward: 835.4389, Test: 876.8176 [102.90], Avg: 560.7738 (0.020)
Ep: 325, Reward: 934.5693, Test: 878.3678 [69.13], Avg: 561.5360 (0.020)
Ep: 326, Reward: 967.4849, Test: 876.7574 [45.44], Avg: 562.3610 (0.020)
Ep: 327, Reward: 903.8426, Test: 865.4836 [42.35], Avg: 563.1560 (0.020)
Ep: 328, Reward: 881.5984, Test: 868.4362 [16.60], Avg: 564.0335 (0.020)
Ep: 329, Reward: 877.5818, Test: 882.9177 [35.88], Avg: 564.8911 (0.020)
Ep: 330, Reward: 933.0053, Test: 870.3225 [20.52], Avg: 565.7519 (0.020)
Ep: 331, Reward: 878.9837, Test: 872.1161 [32.75], Avg: 566.5760 (0.020)
Ep: 332, Reward: 906.7354, Test: 885.8294 [23.69], Avg: 567.4636 (0.020)
Ep: 333, Reward: 902.4530, Test: 839.3152 [105.34], Avg: 567.9621 (0.020)
Ep: 334, Reward: 871.7358, Test: 887.9590 [41.02], Avg: 568.7949 (0.020)
Ep: 335, Reward: 936.1853, Test: 836.8610 [180.71], Avg: 569.0549 (0.020)
Ep: 336, Reward: 979.3460, Test: 894.4452 [22.63], Avg: 569.9533 (0.020)
Ep: 337, Reward: 883.9415, Test: 872.2042 [33.01], Avg: 570.7498 (0.020)
Ep: 338, Reward: 946.2123, Test: 883.0272 [20.27], Avg: 571.6112 (0.020)
Ep: 339, Reward: 912.3500, Test: 876.1628 [36.48], Avg: 572.3996 (0.020)
Ep: 340, Reward: 900.3839, Test: 884.3759 [18.11], Avg: 573.2614 (0.020)
Ep: 341, Reward: 858.6377, Test: 869.9009 [22.20], Avg: 574.0639 (0.020)
Ep: 342, Reward: 825.4450, Test: 867.8875 [16.68], Avg: 574.8718 (0.020)
Ep: 343, Reward: 789.0531, Test: 896.0551 [22.82], Avg: 575.7392 (0.020)
Ep: 344, Reward: 886.2201, Test: 855.2521 [19.73], Avg: 576.4922 (0.020)
Ep: 345, Reward: 788.0838, Test: 858.0605 [30.60], Avg: 577.2175 (0.020)
Ep: 346, Reward: 767.6107, Test: 740.5082 [156.75], Avg: 577.2364 (0.020)
Ep: 347, Reward: 888.1750, Test: 788.5078 [159.67], Avg: 577.3846 (0.020)
Ep: 348, Reward: 909.6213, Test: 823.4320 [71.48], Avg: 577.8848 (0.020)
Ep: 349, Reward: 841.3296, Test: 681.8214 [206.91], Avg: 577.5906 (0.020)
Ep: 350, Reward: 832.1925, Test: 725.0665 [221.74], Avg: 577.3790 (0.020)
Ep: 351, Reward: 853.5286, Test: 830.0666 [162.35], Avg: 577.6357 (0.020)
Ep: 352, Reward: 904.0648, Test: 889.5852 [35.99], Avg: 578.4174 (0.020)
Ep: 353, Reward: 957.0904, Test: 885.1880 [14.47], Avg: 579.2431 (0.020)
Ep: 354, Reward: 852.1370, Test: 770.8935 [48.52], Avg: 579.6463 (0.020)
Ep: 355, Reward: 857.6593, Test: 864.6917 [46.66], Avg: 580.3160 (0.020)
Ep: 356, Reward: 863.8148, Test: 808.7198 [150.47], Avg: 580.5343 (0.020)
Ep: 357, Reward: 926.2646, Test: 839.6119 [148.72], Avg: 580.8425 (0.020)
Ep: 358, Reward: 805.0416, Test: 838.0085 [137.63], Avg: 581.1755 (0.020)
Ep: 359, Reward: 912.2162, Test: 879.6022 [11.86], Avg: 581.9715 (0.020)
Ep: 360, Reward: 877.7211, Test: 735.7432 [231.04], Avg: 581.7575 (0.020)
Ep: 361, Reward: 882.9879, Test: 866.9962 [40.56], Avg: 582.4334 (0.020)
Ep: 362, Reward: 817.1573, Test: 867.1503 [24.84], Avg: 583.1493 (0.020)
Ep: 363, Reward: 854.7105, Test: 862.6571 [30.35], Avg: 583.8338 (0.020)
Ep: 364, Reward: 885.0147, Test: 838.5697 [50.32], Avg: 584.3938 (0.020)
Ep: 365, Reward: 839.7647, Test: 838.0533 [34.03], Avg: 584.9939 (0.020)
Ep: 366, Reward: 828.1056, Test: 859.5169 [17.78], Avg: 585.6934 (0.020)
Ep: 367, Reward: 852.7409, Test: 842.0052 [159.50], Avg: 585.9565 (0.020)
Ep: 368, Reward: 855.1377, Test: 785.1586 [273.72], Avg: 585.7546 (0.020)
Ep: 369, Reward: 798.7479, Test: 847.6464 [30.02], Avg: 586.3812 (0.020)
Ep: 370, Reward: 863.2160, Test: 871.8377 [22.47], Avg: 587.0901 (0.020)
Ep: 371, Reward: 897.1450, Test: 826.3631 [46.67], Avg: 587.6078 (0.020)
Ep: 372, Reward: 841.3337, Test: 845.9975 [19.98], Avg: 588.2470 (0.020)
Ep: 373, Reward: 826.3204, Test: 795.7810 [130.79], Avg: 588.4522 (0.020)
Ep: 374, Reward: 827.4246, Test: 821.1197 [127.57], Avg: 588.7325 (0.020)
Ep: 375, Reward: 922.3711, Test: 887.1760 [21.66], Avg: 589.4686 (0.020)
Ep: 376, Reward: 922.7192, Test: 882.0624 [34.68], Avg: 590.1527 (0.020)
Ep: 377, Reward: 824.7279, Test: 848.1018 [35.14], Avg: 590.7422 (0.020)
Ep: 378, Reward: 840.3138, Test: 844.9658 [34.39], Avg: 591.3222 (0.020)
Ep: 379, Reward: 851.1168, Test: 665.0680 [94.16], Avg: 591.2685 (0.020)
Ep: 380, Reward: 722.5763, Test: 774.7954 [58.78], Avg: 591.5959 (0.020)
Ep: 381, Reward: 816.4091, Test: 875.2573 [26.99], Avg: 592.2678 (0.020)
Ep: 382, Reward: 877.4053, Test: 886.9543 [53.12], Avg: 592.8986 (0.020)
Ep: 383, Reward: 950.5342, Test: 870.3373 [81.66], Avg: 593.4084 (0.020)
Ep: 384, Reward: 913.9925, Test: 889.8149 [26.73], Avg: 594.1089 (0.020)
Ep: 385, Reward: 903.0063, Test: 864.7477 [70.21], Avg: 594.6281 (0.020)
Ep: 386, Reward: 872.1130, Test: 857.6346 [24.07], Avg: 595.2455 (0.020)
Ep: 387, Reward: 895.6274, Test: 868.4472 [31.00], Avg: 595.8698 (0.020)
Ep: 388, Reward: 884.9767, Test: 893.3714 [17.32], Avg: 596.5900 (0.020)
Ep: 389, Reward: 882.0224, Test: 809.1045 [158.75], Avg: 596.7279 (0.020)
Ep: 390, Reward: 824.3202, Test: 847.5232 [105.04], Avg: 597.1006 (0.020)
Ep: 391, Reward: 878.1176, Test: 855.2506 [82.18], Avg: 597.5496 (0.020)
Ep: 392, Reward: 904.5046, Test: 885.2428 [18.78], Avg: 598.2338 (0.020)
Ep: 393, Reward: 884.3832, Test: 886.5309 [29.41], Avg: 598.8909 (0.020)
Ep: 394, Reward: 943.9443, Test: 839.8736 [64.57], Avg: 599.3375 (0.020)
Ep: 395, Reward: 870.1174, Test: 825.8733 [99.48], Avg: 599.6584 (0.020)
Ep: 396, Reward: 836.6878, Test: 859.9726 [50.75], Avg: 600.1862 (0.020)
Ep: 397, Reward: 858.3302, Test: 832.3911 [72.54], Avg: 600.5874 (0.020)
Ep: 398, Reward: 885.5990, Test: 834.4270 [97.48], Avg: 600.9291 (0.020)
Ep: 399, Reward: 884.2787, Test: 745.4417 [194.83], Avg: 600.8033 (0.020)
Ep: 400, Reward: 869.5815, Test: 840.1106 [73.19], Avg: 601.2176 (0.020)
Ep: 401, Reward: 892.3771, Test: 836.0307 [116.47], Avg: 601.5120 (0.020)
Ep: 402, Reward: 814.2383, Test: 865.3292 [31.71], Avg: 602.0879 (0.020)
Ep: 403, Reward: 883.5721, Test: 857.1307 [63.60], Avg: 602.5618 (0.020)
Ep: 404, Reward: 746.7991, Test: 848.7456 [61.25], Avg: 603.0184 (0.020)
Ep: 405, Reward: 847.3909, Test: 843.4606 [70.52], Avg: 603.4369 (0.020)
Ep: 406, Reward: 890.9062, Test: 878.4259 [37.80], Avg: 604.0197 (0.020)
Ep: 407, Reward: 984.4541, Test: 824.0960 [64.93], Avg: 604.4000 (0.020)
Ep: 408, Reward: 791.9339, Test: 803.0000 [78.07], Avg: 604.6947 (0.020)
Ep: 409, Reward: 837.0257, Test: 834.7716 [51.22], Avg: 605.1309 (0.020)
Ep: 410, Reward: 843.1541, Test: 804.7609 [124.26], Avg: 605.3143 (0.020)
Ep: 411, Reward: 841.8836, Test: 830.6746 [23.92], Avg: 605.8032 (0.020)
Ep: 412, Reward: 839.0251, Test: 858.8839 [20.88], Avg: 606.3655 (0.020)
Ep: 413, Reward: 847.6049, Test: 796.7618 [88.97], Avg: 606.6105 (0.020)
Ep: 414, Reward: 823.4540, Test: 849.1525 [39.95], Avg: 607.0986 (0.020)
Ep: 415, Reward: 883.0871, Test: 885.5606 [36.59], Avg: 607.6801 (0.020)
Ep: 416, Reward: 909.5950, Test: 817.0273 [160.33], Avg: 607.7976 (0.020)
Ep: 417, Reward: 842.0950, Test: 822.5217 [143.24], Avg: 607.9686 (0.020)
Ep: 418, Reward: 902.9087, Test: 829.9757 [85.38], Avg: 608.2947 (0.020)
Ep: 419, Reward: 867.8619, Test: 884.6811 [28.06], Avg: 608.8860 (0.020)
Ep: 420, Reward: 924.1250, Test: 856.3463 [38.61], Avg: 609.3821 (0.020)
Ep: 421, Reward: 806.8197, Test: 825.8866 [161.97], Avg: 609.5113 (0.020)
Ep: 422, Reward: 860.0194, Test: 881.0584 [42.98], Avg: 610.0516 (0.020)
Ep: 423, Reward: 859.8025, Test: 850.6379 [47.70], Avg: 610.5065 (0.020)
Ep: 424, Reward: 854.8358, Test: 754.5694 [88.61], Avg: 610.6370 (0.020)
Ep: 425, Reward: 822.4921, Test: 777.5175 [74.99], Avg: 610.8527 (0.020)
Ep: 426, Reward: 792.0894, Test: 829.2898 [33.70], Avg: 611.2854 (0.020)
Ep: 427, Reward: 815.7632, Test: 828.3390 [64.14], Avg: 611.6426 (0.020)
Ep: 428, Reward: 786.4411, Test: 843.1963 [32.10], Avg: 612.1076 (0.020)
Ep: 429, Reward: 854.6677, Test: 826.4862 [49.25], Avg: 612.4916 (0.020)
Ep: 430, Reward: 860.2335, Test: 868.9672 [24.67], Avg: 613.0294 (0.020)
Ep: 431, Reward: 846.5744, Test: 815.8659 [80.34], Avg: 613.3130 (0.020)
Ep: 432, Reward: 812.4755, Test: 782.7989 [71.15], Avg: 613.5401 (0.020)
Ep: 433, Reward: 760.3651, Test: 792.0230 [73.37], Avg: 613.7823 (0.020)
Ep: 434, Reward: 834.2447, Test: 664.0127 [127.80], Avg: 613.6040 (0.020)
Ep: 435, Reward: 805.4896, Test: 812.5352 [72.98], Avg: 613.8929 (0.020)
Ep: 436, Reward: 809.6497, Test: 723.5112 [170.74], Avg: 613.7530 (0.020)
Ep: 437, Reward: 772.5508, Test: 856.7110 [40.92], Avg: 614.2143 (0.020)
Ep: 438, Reward: 822.1142, Test: 805.4583 [58.61], Avg: 614.5164 (0.020)
Ep: 439, Reward: 837.7512, Test: 789.8522 [147.45], Avg: 614.5798 (0.020)
Ep: 440, Reward: 824.8177, Test: 842.5955 [22.99], Avg: 615.0447 (0.020)
Ep: 441, Reward: 850.4196, Test: 787.4771 [41.72], Avg: 615.3404 (0.020)
Ep: 442, Reward: 872.9513, Test: 857.3675 [33.54], Avg: 615.8111 (0.020)
Ep: 443, Reward: 842.2312, Test: 868.2410 [20.96], Avg: 616.3324 (0.020)
Ep: 444, Reward: 831.0560, Test: 832.4012 [45.12], Avg: 616.7165 (0.020)
Ep: 445, Reward: 849.0174, Test: 837.5677 [70.58], Avg: 617.0535 (0.020)
Ep: 446, Reward: 795.1826, Test: 693.2029 [245.43], Avg: 616.6748 (0.020)
Ep: 447, Reward: 673.2412, Test: 808.1276 [101.68], Avg: 616.8751 (0.020)
Ep: 448, Reward: 792.6084, Test: 865.1759 [31.23], Avg: 617.3586 (0.020)
Ep: 449, Reward: 759.0223, Test: 818.8006 [84.21], Avg: 617.6191 (0.020)
Ep: 450, Reward: 813.3651, Test: 865.8386 [32.51], Avg: 618.0974 (0.020)
Ep: 451, Reward: 856.9831, Test: 810.2346 [155.01], Avg: 618.1796 (0.020)
Ep: 452, Reward: 878.7107, Test: 596.0010 [162.25], Avg: 617.7724 (0.020)
Ep: 453, Reward: 836.4146, Test: 685.2964 [184.71], Avg: 617.5143 (0.020)
Ep: 454, Reward: 727.9670, Test: 777.2403 [149.57], Avg: 617.5366 (0.020)
Ep: 455, Reward: 740.0001, Test: 803.0927 [114.34], Avg: 617.6928 (0.020)
Ep: 456, Reward: 855.8469, Test: 801.8466 [99.94], Avg: 617.8771 (0.020)
Ep: 457, Reward: 809.2578, Test: 792.3527 [147.41], Avg: 617.9362 (0.020)
Ep: 458, Reward: 847.0070, Test: 737.2416 [214.87], Avg: 617.7280 (0.020)
Ep: 459, Reward: 889.9524, Test: 705.1609 [183.81], Avg: 617.5185 (0.020)
Ep: 460, Reward: 805.4856, Test: 796.9618 [147.94], Avg: 617.5868 (0.020)
Ep: 461, Reward: 762.3112, Test: 403.9961 [216.28], Avg: 616.6563 (0.020)
Ep: 462, Reward: 634.2427, Test: 842.8774 [62.85], Avg: 617.0092 (0.020)
Ep: 463, Reward: 908.2740, Test: 842.0722 [84.68], Avg: 617.3117 (0.020)
Ep: 464, Reward: 861.2745, Test: 902.8118 [23.96], Avg: 617.8742 (0.020)
Ep: 465, Reward: 891.4941, Test: 894.1091 [19.38], Avg: 618.4254 (0.020)
Ep: 466, Reward: 914.7597, Test: 855.6608 [70.32], Avg: 618.7828 (0.020)
Ep: 467, Reward: 895.0274, Test: 834.6751 [127.83], Avg: 618.9710 (0.020)
Ep: 468, Reward: 864.9449, Test: 873.5107 [17.36], Avg: 619.4767 (0.020)
Ep: 469, Reward: 934.3232, Test: 858.6871 [39.68], Avg: 619.9012 (0.020)
Ep: 470, Reward: 829.3267, Test: 777.0225 [141.17], Avg: 619.9351 (0.020)
Ep: 471, Reward: 855.8793, Test: 883.2748 [18.40], Avg: 620.4540 (0.020)
Ep: 472, Reward: 923.4873, Test: 855.0509 [83.66], Avg: 620.7731 (0.020)
Ep: 473, Reward: 902.5426, Test: 872.7609 [48.21], Avg: 621.2031 (0.020)
Ep: 474, Reward: 892.6951, Test: 818.2028 [114.03], Avg: 621.3777 (0.020)
Ep: 475, Reward: 932.1342, Test: 874.8209 [32.78], Avg: 621.8413 (0.020)
Ep: 476, Reward: 737.4333, Test: 843.9746 [68.58], Avg: 622.1632 (0.020)
Ep: 477, Reward: 888.3996, Test: 704.9776 [239.18], Avg: 621.8361 (0.020)
Ep: 478, Reward: 834.4284, Test: 869.7510 [55.88], Avg: 622.2370 (0.020)
Ep: 479, Reward: 885.5126, Test: 845.4936 [72.56], Avg: 622.5510 (0.020)
Ep: 480, Reward: 890.1265, Test: 880.1007 [24.84], Avg: 623.0348 (0.020)
Ep: 481, Reward: 809.1235, Test: 719.8093 [130.54], Avg: 622.9647 (0.020)
Ep: 482, Reward: 790.1819, Test: 820.5501 [165.74], Avg: 623.0306 (0.020)
Ep: 483, Reward: 829.6952, Test: 864.0052 [33.67], Avg: 623.4590 (0.020)
Ep: 484, Reward: 889.9745, Test: 857.7708 [32.67], Avg: 623.8747 (0.020)
Ep: 485, Reward: 900.1740, Test: 883.3063 [31.99], Avg: 624.3427 (0.020)
Ep: 486, Reward: 937.9742, Test: 841.2918 [144.25], Avg: 624.4920 (0.020)
Ep: 487, Reward: 890.2876, Test: 876.3007 [51.79], Avg: 624.9018 (0.020)
Ep: 488, Reward: 870.3404, Test: 813.5000 [94.10], Avg: 625.0951 (0.020)
Ep: 489, Reward: 871.1248, Test: 860.1086 [112.79], Avg: 625.3445 (0.020)
Ep: 490, Reward: 924.5129, Test: 881.6040 [37.62], Avg: 625.7898 (0.020)
Ep: 491, Reward: 830.0242, Test: 883.0613 [33.21], Avg: 626.2452 (0.020)
Ep: 492, Reward: 908.9516, Test: 858.6927 [92.16], Avg: 626.5298 (0.020)
Ep: 493, Reward: 867.9696, Test: 806.8497 [156.83], Avg: 626.5773 (0.020)
Ep: 494, Reward: 726.0058, Test: 839.2482 [40.85], Avg: 626.9245 (0.020)
Ep: 495, Reward: 784.9491, Test: 807.2384 [95.14], Avg: 627.0962 (0.020)
Ep: 496, Reward: 753.4115, Test: 767.5988 [112.83], Avg: 627.1519 (0.020)
Ep: 497, Reward: 754.8526, Test: 738.1917 [76.19], Avg: 627.2218 (0.020)
Ep: 498, Reward: 765.1944, Test: 812.5669 [33.26], Avg: 627.5266 (0.020)
Ep: 499, Reward: 806.5361, Test: 818.5789 [27.56], Avg: 627.8536 (0.020)
