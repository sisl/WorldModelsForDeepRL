Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, NUM_STEPS

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 16        	# How many experience tuples to sample from the buffer for each train step

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(list(zip(states, actions, targets, advantages)), shuffle=True)	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -61.7284, Test: -52.1327 [20.75], Avg: -72.8778 (0.980)
Ep: 1, Reward: -53.6359, Test: -51.1249 [27.36], Avg: -75.6826 (0.960)
Ep: 2, Reward: -60.9548, Test: -59.6072 [20.96], Avg: -77.3102 (0.941)
Ep: 3, Reward: -59.6350, Test: -61.0108 [16.20], Avg: -77.2846 (0.922)
Ep: 4, Reward: -51.7305, Test: -47.7095 [20.59], Avg: -75.4875 (0.904)
Ep: 5, Reward: -45.3946, Test: -63.6169 [20.81], Avg: -76.9778 (0.886)
Ep: 6, Reward: -72.6103, Test: -48.5991 [29.15], Avg: -77.0880 (0.868)
Ep: 7, Reward: -59.2374, Test: -46.7296 [30.71], Avg: -77.1317 (0.851)
Ep: 8, Reward: -53.5971, Test: -48.5426 [22.42], Avg: -76.4465 (0.834)
Ep: 9, Reward: -56.0450, Test: -44.4577 [39.44], Avg: -77.1912 (0.817)
Ep: 10, Reward: -58.6329, Test: -38.3270 [23.57], Avg: -75.8004 (0.801)
Ep: 11, Reward: -52.0447, Test: -44.4297 [26.30], Avg: -75.3776 (0.785)
Ep: 12, Reward: -44.2708, Test: -53.8611 [18.87], Avg: -75.1737 (0.769)
Ep: 13, Reward: -58.6432, Test: -53.8398 [20.58], Avg: -75.1202 (0.754)
Ep: 14, Reward: -44.6892, Test: -60.8398 [16.54], Avg: -75.2710 (0.739)
Ep: 15, Reward: -50.1286, Test: -46.6837 [23.90], Avg: -74.9778 (0.724)
Ep: 16, Reward: -41.8446, Test: -47.7635 [22.42], Avg: -74.6961 (0.709)
Ep: 17, Reward: -48.2223, Test: -51.4181 [15.62], Avg: -74.2708 (0.695)
Ep: 18, Reward: -70.7081, Test: -60.3265 [23.93], Avg: -74.7963 (0.681)
Ep: 19, Reward: -54.4617, Test: -43.0060 [19.68], Avg: -74.1908 (0.668)
Ep: 20, Reward: -62.8539, Test: -48.5427 [23.48], Avg: -74.0875 (0.654)
Ep: 21, Reward: -49.5100, Test: -56.4640 [31.06], Avg: -74.6983 (0.641)
Ep: 22, Reward: -41.4469, Test: -41.9593 [35.92], Avg: -74.8365 (0.628)
Ep: 23, Reward: -27.2556, Test: -45.6683 [24.17], Avg: -74.6281 (0.616)
Ep: 24, Reward: -27.6649, Test: -37.2002 [37.72], Avg: -74.6398 (0.603)
Ep: 25, Reward: -23.1778, Test: -31.2187 [40.40], Avg: -74.5237 (0.591)
Ep: 26, Reward: -23.7351, Test: -33.8073 [20.34], Avg: -73.7691 (0.580)
Ep: 27, Reward: -37.4794, Test: -16.2691 [52.94], Avg: -73.6063 (0.568)
Ep: 28, Reward: -39.4702, Test: -36.2890 [37.23], Avg: -73.6034 (0.557)
Ep: 29, Reward: -8.0967, Test: -41.7616 [41.30], Avg: -73.9188 (0.545)
Ep: 30, Reward: -24.4499, Test: -33.3793 [24.81], Avg: -73.4114 (0.535)
Ep: 31, Reward: -14.4698, Test: -19.4206 [25.12], Avg: -72.5093 (0.524)
Ep: 32, Reward: -6.8726, Test: -23.1766 [47.21], Avg: -72.4448 (0.513)
Ep: 33, Reward: -14.8322, Test: -6.6700 [71.63], Avg: -72.6171 (0.503)
Ep: 34, Reward: 15.9379, Test: 38.7771 [58.88], Avg: -71.1168 (0.493)
Ep: 35, Reward: 33.8785, Test: 6.8200 [52.96], Avg: -70.4229 (0.483)
Ep: 36, Reward: -14.8774, Test: -9.0863 [36.81], Avg: -69.7599 (0.474)
Ep: 37, Reward: -9.5771, Test: -6.6789 [53.65], Avg: -69.5117 (0.464)
Ep: 38, Reward: 29.3262, Test: 8.3121 [74.55], Avg: -69.4279 (0.455)
Ep: 39, Reward: 48.1134, Test: 25.5630 [80.33], Avg: -69.0613 (0.446)
Ep: 40, Reward: 34.1182, Test: 106.8845 [128.07], Avg: -67.8937 (0.437)
Ep: 41, Reward: 51.7250, Test: 8.5885 [155.19], Avg: -69.7677 (0.428)
Ep: 42, Reward: 28.2979, Test: 29.2082 [116.14], Avg: -70.1668 (0.419)
Ep: 43, Reward: 26.2489, Test: 26.7967 [89.87], Avg: -70.0055 (0.411)
Ep: 44, Reward: 90.2650, Test: 91.8942 [110.29], Avg: -68.8586 (0.403)
Ep: 45, Reward: 87.8300, Test: 81.2534 [111.21], Avg: -68.0128 (0.395)
Ep: 46, Reward: 47.6077, Test: 48.4626 [57.28], Avg: -66.7534 (0.387)
Ep: 47, Reward: 72.8466, Test: 161.4136 [125.44], Avg: -64.6134 (0.379)
Ep: 48, Reward: 92.7724, Test: 224.8015 [204.02], Avg: -62.8707 (0.372)
Ep: 49, Reward: 104.8051, Test: 196.2427 [86.29], Avg: -59.4141 (0.364)
Ep: 50, Reward: 122.4490, Test: 212.6943 [112.37], Avg: -56.2820 (0.357)
Ep: 51, Reward: 139.8411, Test: 98.9440 [101.98], Avg: -55.2580 (0.350)
Ep: 52, Reward: 119.9313, Test: 143.8263 [123.67], Avg: -53.8352 (0.343)
Ep: 53, Reward: 160.6122, Test: 161.6636 [155.40], Avg: -52.7223 (0.336)
Ep: 54, Reward: 156.1288, Test: 227.1818 [138.75], Avg: -50.1558 (0.329)
Ep: 55, Reward: 157.6269, Test: 257.1584 [142.29], Avg: -47.2090 (0.323)
Ep: 56, Reward: 204.1341, Test: 263.4345 [161.50], Avg: -44.5925 (0.316)
Ep: 57, Reward: 219.0282, Test: 240.4458 [154.95], Avg: -42.3495 (0.310)
Ep: 58, Reward: 167.2367, Test: 215.8588 [153.08], Avg: -40.5678 (0.304)
Ep: 59, Reward: 204.6750, Test: 250.5257 [125.28], Avg: -37.8043 (0.298)
Ep: 60, Reward: 159.2973, Test: 241.7366 [147.25], Avg: -35.6356 (0.292)
Ep: 61, Reward: 229.3172, Test: 223.0743 [154.87], Avg: -33.9608 (0.286)
Ep: 62, Reward: 228.4605, Test: 278.3794 [142.57], Avg: -31.2660 (0.280)
Ep: 63, Reward: 241.5038, Test: 219.9942 [138.97], Avg: -29.5114 (0.274)
Ep: 64, Reward: 278.8033, Test: 142.3125 [95.82], Avg: -28.3421 (0.269)
Ep: 65, Reward: 345.2367, Test: 261.0301 [226.20], Avg: -27.3849 (0.264)
Ep: 66, Reward: 289.3192, Test: 379.5732 [202.34], Avg: -24.3309 (0.258)
Ep: 67, Reward: 365.9050, Test: 374.9901 [162.31], Avg: -20.8454 (0.253)
Ep: 68, Reward: 398.5690, Test: 473.7223 [193.26], Avg: -16.4786 (0.248)
Ep: 69, Reward: 307.1847, Test: 460.5336 [196.13], Avg: -12.4660 (0.243)
Ep: 70, Reward: 345.6338, Test: 442.0304 [190.60], Avg: -8.7492 (0.238)
Ep: 71, Reward: 374.0431, Test: 424.7121 [105.84], Avg: -4.1990 (0.233)
Ep: 72, Reward: 342.3216, Test: 436.0406 [160.82], Avg: -0.3713 (0.229)
Ep: 73, Reward: 428.2663, Test: 283.6306 [229.54], Avg: 0.3647 (0.224)
Ep: 74, Reward: 537.3802, Test: 411.9716 [201.26], Avg: 3.1693 (0.220)
Ep: 75, Reward: 486.0032, Test: 388.0908 [203.34], Avg: 5.5585 (0.215)
Ep: 76, Reward: 419.2700, Test: 406.6343 [188.37], Avg: 8.3210 (0.211)
Ep: 77, Reward: 435.2865, Test: 444.2630 [193.05], Avg: 11.4349 (0.207)
Ep: 78, Reward: 463.5294, Test: 538.7532 [193.46], Avg: 15.6610 (0.203)
Ep: 79, Reward: 437.6410, Test: 444.8572 [218.53], Avg: 18.2943 (0.199)
Ep: 80, Reward: 451.7301, Test: 393.6900 [200.65], Avg: 20.4517 (0.195)
Ep: 81, Reward: 556.1269, Test: 425.0481 [195.08], Avg: 23.0067 (0.191)
Ep: 82, Reward: 567.0807, Test: 652.4060 [189.65], Avg: 28.3050 (0.187)
Ep: 83, Reward: 501.7600, Test: 452.6640 [212.95], Avg: 30.8218 (0.183)
Ep: 84, Reward: 622.1818, Test: 721.7995 [147.97], Avg: 37.2101 (0.180)
Ep: 85, Reward: 655.6473, Test: 708.9521 [159.73], Avg: 43.1637 (0.176)
Ep: 86, Reward: 707.6538, Test: 579.3094 [261.80], Avg: 46.3172 (0.172)
Ep: 87, Reward: 653.0163, Test: 663.2635 [190.67], Avg: 51.1612 (0.169)
Ep: 88, Reward: 647.1630, Test: 591.5053 [292.19], Avg: 53.9494 (0.166)
Ep: 89, Reward: 639.6471, Test: 634.8872 [111.99], Avg: 59.1599 (0.162)
Ep: 90, Reward: 670.0109, Test: 690.2588 [181.43], Avg: 64.1013 (0.159)
Ep: 91, Reward: 641.0699, Test: 637.4329 [215.56], Avg: 67.9902 (0.156)
Ep: 92, Reward: 688.7624, Test: 745.2422 [173.67], Avg: 73.4050 (0.153)
Ep: 93, Reward: 617.5152, Test: 544.8724 [164.40], Avg: 76.6717 (0.150)
Ep: 94, Reward: 621.6503, Test: 677.9748 [176.75], Avg: 81.1407 (0.147)
Ep: 95, Reward: 568.7393, Test: 525.9727 [177.76], Avg: 83.9227 (0.144)
Ep: 96, Reward: 631.0564, Test: 596.2828 [156.84], Avg: 87.5878 (0.141)
Ep: 97, Reward: 599.3414, Test: 567.9246 [159.65], Avg: 90.8602 (0.138)
Ep: 98, Reward: 621.9271, Test: 662.2323 [151.00], Avg: 95.1063 (0.135)
Ep: 99, Reward: 695.1508, Test: 661.4186 [143.12], Avg: 99.3383 (0.133)
Ep: 100, Reward: 648.0975, Test: 638.7197 [215.27], Avg: 102.5473 (0.130)
Ep: 101, Reward: 706.1763, Test: 700.4367 [117.61], Avg: 107.2559 (0.127)
Ep: 102, Reward: 691.3165, Test: 576.0303 [159.21], Avg: 110.2614 (0.125)
Ep: 103, Reward: 668.4157, Test: 586.2820 [170.02], Avg: 113.2037 (0.122)
Ep: 104, Reward: 586.4703, Test: 595.4068 [255.71], Avg: 115.3607 (0.120)
Ep: 105, Reward: 546.4754, Test: 611.7300 [225.81], Avg: 117.9132 (0.117)
Ep: 106, Reward: 557.2647, Test: 567.0024 [162.73], Avg: 120.5894 (0.115)
Ep: 107, Reward: 572.2851, Test: 451.9843 [188.48], Avg: 121.9127 (0.113)
Ep: 108, Reward: 631.3945, Test: 535.5650 [198.88], Avg: 123.8831 (0.111)
Ep: 109, Reward: 548.9365, Test: 564.3532 [217.17], Avg: 125.9131 (0.108)
Ep: 110, Reward: 506.0930, Test: 612.2885 [183.12], Avg: 128.6452 (0.106)
Ep: 111, Reward: 459.7486, Test: 448.5075 [137.04], Avg: 130.2776 (0.104)
Ep: 112, Reward: 609.3241, Test: 489.9639 [186.41], Avg: 131.8110 (0.102)
Ep: 113, Reward: 518.6553, Test: 593.1350 [232.48], Avg: 133.8184 (0.100)
Ep: 114, Reward: 528.8609, Test: 417.8334 [223.73], Avg: 134.3426 (0.098)
Ep: 115, Reward: 519.5002, Test: 338.2177 [189.46], Avg: 134.4669 (0.096)
Ep: 116, Reward: 540.3710, Test: 481.5428 [192.74], Avg: 135.7860 (0.094)
Ep: 117, Reward: 534.3069, Test: 601.1455 [179.23], Avg: 138.2109 (0.092)
Ep: 118, Reward: 610.8156, Test: 539.6160 [246.41], Avg: 139.5133 (0.090)
Ep: 119, Reward: 602.3071, Test: 738.2791 [162.48], Avg: 143.1491 (0.089)
Ep: 120, Reward: 768.2178, Test: 809.7004 [33.30], Avg: 148.3825 (0.087)
Ep: 121, Reward: 746.5240, Test: 798.1723 [54.01], Avg: 153.2660 (0.085)
Ep: 122, Reward: 802.0249, Test: 769.8820 [145.40], Avg: 157.0971 (0.083)
Ep: 123, Reward: 810.3540, Test: 812.4058 [91.57], Avg: 161.6433 (0.082)
Ep: 124, Reward: 802.0326, Test: 706.9900 [231.13], Avg: 164.1571 (0.080)
Ep: 125, Reward: 733.9483, Test: 732.8398 [205.63], Avg: 167.0385 (0.078)
Ep: 126, Reward: 830.9192, Test: 764.3189 [116.90], Avg: 170.8210 (0.077)
Ep: 127, Reward: 713.6735, Test: 807.0606 [142.36], Avg: 174.6794 (0.075)
Ep: 128, Reward: 724.4671, Test: 724.0731 [177.44], Avg: 177.5627 (0.074)
Ep: 129, Reward: 784.8078, Test: 835.8262 [37.52], Avg: 182.3377 (0.072)
Ep: 130, Reward: 766.0935, Test: 747.5479 [203.30], Avg: 185.1004 (0.071)
Ep: 131, Reward: 785.5666, Test: 829.7284 [63.66], Avg: 189.5016 (0.069)
Ep: 132, Reward: 823.5288, Test: 766.5185 [138.53], Avg: 192.7985 (0.068)
Ep: 133, Reward: 862.5036, Test: 777.6444 [110.35], Avg: 196.3396 (0.067)
Ep: 134, Reward: 878.0761, Test: 817.0090 [151.74], Avg: 199.8131 (0.065)
Ep: 135, Reward: 793.3530, Test: 769.2461 [119.63], Avg: 203.1205 (0.064)
Ep: 136, Reward: 843.1371, Test: 833.7641 [52.44], Avg: 207.3409 (0.063)
Ep: 137, Reward: 874.5271, Test: 851.0389 [30.68], Avg: 211.7831 (0.062)
Ep: 138, Reward: 800.4596, Test: 848.9140 [44.88], Avg: 216.0439 (0.060)
Ep: 139, Reward: 780.1840, Test: 847.4283 [28.09], Avg: 220.3532 (0.059)
Ep: 140, Reward: 785.0191, Test: 830.0139 [42.01], Avg: 224.3790 (0.058)
Ep: 141, Reward: 806.2362, Test: 808.7279 [54.00], Avg: 228.1139 (0.057)
Ep: 142, Reward: 831.4387, Test: 790.2750 [146.36], Avg: 231.0216 (0.056)
Ep: 143, Reward: 802.8497, Test: 698.1173 [175.16], Avg: 233.0489 (0.055)
Ep: 144, Reward: 672.6205, Test: 770.3808 [170.31], Avg: 235.5801 (0.053)
Ep: 145, Reward: 740.9243, Test: 721.9685 [167.59], Avg: 237.7637 (0.052)
Ep: 146, Reward: 723.2393, Test: 654.0262 [195.61], Avg: 239.2647 (0.051)
Ep: 147, Reward: 709.5344, Test: 838.7036 [40.64], Avg: 243.0404 (0.050)
Ep: 148, Reward: 761.0242, Test: 655.1159 [207.07], Avg: 244.4163 (0.049)
Ep: 149, Reward: 784.7976, Test: 711.1818 [220.97], Avg: 246.0549 (0.048)
Ep: 150, Reward: 732.4901, Test: 851.6056 [76.94], Avg: 249.5556 (0.047)
Ep: 151, Reward: 796.5346, Test: 859.8494 [29.04], Avg: 253.3797 (0.046)
Ep: 152, Reward: 852.1279, Test: 873.5493 [41.24], Avg: 257.1636 (0.045)
Ep: 153, Reward: 832.8684, Test: 821.0913 [44.49], Avg: 260.5366 (0.045)
Ep: 154, Reward: 830.5379, Test: 859.9250 [48.37], Avg: 264.0915 (0.044)
Ep: 155, Reward: 852.2343, Test: 824.7062 [66.30], Avg: 267.2602 (0.043)
Ep: 156, Reward: 837.2400, Test: 788.5522 [75.90], Avg: 270.0971 (0.042)
Ep: 157, Reward: 816.1044, Test: 772.7525 [95.53], Avg: 272.6738 (0.041)
Ep: 158, Reward: 833.3971, Test: 830.6366 [30.07], Avg: 275.9939 (0.040)
Ep: 159, Reward: 834.7123, Test: 876.3456 [45.22], Avg: 279.4635 (0.039)
Ep: 160, Reward: 832.9234, Test: 837.7871 [29.56], Avg: 282.7478 (0.039)
Ep: 161, Reward: 880.5054, Test: 814.5304 [68.81], Avg: 285.6056 (0.038)
Ep: 162, Reward: 837.3134, Test: 875.4525 [24.99], Avg: 289.0710 (0.037)
Ep: 163, Reward: 850.1923, Test: 838.0612 [24.59], Avg: 292.2686 (0.036)
Ep: 164, Reward: 725.8893, Test: 819.3265 [154.60], Avg: 294.5259 (0.036)
Ep: 165, Reward: 873.2794, Test: 861.8907 [23.03], Avg: 297.8050 (0.035)
Ep: 166, Reward: 924.6481, Test: 752.4195 [110.71], Avg: 299.8644 (0.034)
Ep: 167, Reward: 881.8609, Test: 824.9790 [90.42], Avg: 302.4518 (0.034)
Ep: 168, Reward: 758.4131, Test: 767.1811 [202.05], Avg: 304.0061 (0.033)
Ep: 169, Reward: 842.1858, Test: 783.0543 [188.83], Avg: 305.7133 (0.032)
Ep: 170, Reward: 802.7551, Test: 759.9800 [178.26], Avg: 307.3274 (0.032)
Ep: 171, Reward: 759.0836, Test: 658.4304 [199.81], Avg: 308.2070 (0.031)
Ep: 172, Reward: 572.9853, Test: 678.2771 [153.89], Avg: 309.4566 (0.030)
Ep: 173, Reward: 804.2490, Test: 853.0545 [15.54], Avg: 312.4914 (0.030)
Ep: 174, Reward: 765.0298, Test: 789.3463 [53.09], Avg: 314.9129 (0.029)
Ep: 175, Reward: 764.2291, Test: 747.4855 [196.69], Avg: 316.2531 (0.029)
Ep: 176, Reward: 784.0870, Test: 747.7893 [166.12], Avg: 317.7527 (0.028)
Ep: 177, Reward: 827.6046, Test: 776.7216 [107.73], Avg: 319.7260 (0.027)
Ep: 178, Reward: 741.7486, Test: 834.1568 [23.81], Avg: 322.4668 (0.027)
Ep: 179, Reward: 838.7214, Test: 817.4990 [78.69], Avg: 324.7798 (0.026)
Ep: 180, Reward: 776.1987, Test: 749.9020 [199.04], Avg: 326.0289 (0.026)
Ep: 181, Reward: 689.5929, Test: 775.2488 [128.51], Avg: 327.7911 (0.025)
Ep: 182, Reward: 803.0439, Test: 842.2281 [48.21], Avg: 330.3388 (0.025)
Ep: 183, Reward: 799.5897, Test: 789.4697 [38.76], Avg: 332.6234 (0.024)
Ep: 184, Reward: 827.6815, Test: 827.1166 [37.16], Avg: 335.0955 (0.024)
Ep: 185, Reward: 846.2612, Test: 841.3825 [34.27], Avg: 337.6332 (0.023)
Ep: 186, Reward: 904.9912, Test: 860.0599 [82.86], Avg: 339.9838 (0.023)
Ep: 187, Reward: 918.3403, Test: 773.1685 [199.49], Avg: 341.2269 (0.022)
Ep: 188, Reward: 891.0831, Test: 883.7170 [31.14], Avg: 343.9325 (0.022)
Ep: 189, Reward: 892.2448, Test: 854.0137 [63.46], Avg: 346.2831 (0.022)
Ep: 190, Reward: 808.0051, Test: 769.5992 [147.00], Avg: 347.7298 (0.021)
Ep: 191, Reward: 891.4068, Test: 807.8871 [127.35], Avg: 349.4631 (0.021)
Ep: 192, Reward: 938.8234, Test: 846.1763 [46.90], Avg: 351.7937 (0.020)
Ep: 193, Reward: 774.1183, Test: 866.3231 [26.19], Avg: 354.3109 (0.020)
Ep: 194, Reward: 809.5057, Test: 840.2246 [65.50], Avg: 356.4669 (0.020)
Ep: 195, Reward: 872.2207, Test: 811.3042 [147.20], Avg: 358.0365 (0.020)
Ep: 196, Reward: 825.3031, Test: 856.3576 [25.62], Avg: 360.4360 (0.020)
Ep: 197, Reward: 757.4634, Test: 603.1522 [191.71], Avg: 360.6936 (0.020)
Ep: 198, Reward: 695.8575, Test: 789.6675 [80.80], Avg: 362.4433 (0.020)
Ep: 199, Reward: 683.0200, Test: 833.4612 [89.58], Avg: 364.3505 (0.020)
Ep: 200, Reward: 766.2083, Test: 776.8804 [146.57], Avg: 365.6737 (0.020)
Ep: 201, Reward: 862.2643, Test: 807.1372 [115.74], Avg: 367.2862 (0.020)
Ep: 202, Reward: 716.1093, Test: 632.5292 [147.31], Avg: 367.8671 (0.020)
Ep: 203, Reward: 736.6588, Test: 769.2813 [71.33], Avg: 369.4852 (0.020)
Ep: 204, Reward: 752.2263, Test: 720.9460 [142.91], Avg: 370.5025 (0.020)
Ep: 205, Reward: 553.4437, Test: 620.0434 [210.38], Avg: 370.6926 (0.020)
Ep: 206, Reward: 813.3532, Test: 715.9255 [153.99], Avg: 371.6165 (0.020)
Ep: 207, Reward: 760.1347, Test: 745.4737 [198.23], Avg: 372.4608 (0.020)
Ep: 208, Reward: 832.5563, Test: 770.4214 [204.70], Avg: 373.3855 (0.020)
Ep: 209, Reward: 783.7465, Test: 726.2808 [144.62], Avg: 374.3773 (0.020)
Ep: 210, Reward: 894.1614, Test: 846.4525 [45.36], Avg: 376.3997 (0.020)
Ep: 211, Reward: 936.1519, Test: 894.9373 [28.55], Avg: 378.7109 (0.020)
Ep: 212, Reward: 1024.0858, Test: 882.5742 [48.01], Avg: 380.8511 (0.020)
Ep: 213, Reward: 1048.1636, Test: 873.2046 [72.82], Avg: 382.8115 (0.020)
Ep: 214, Reward: 958.1839, Test: 854.2908 [87.72], Avg: 384.5965 (0.020)
Ep: 215, Reward: 861.4568, Test: 798.6734 [199.27], Avg: 385.5909 (0.020)
Ep: 216, Reward: 680.7456, Test: 808.2301 [110.78], Avg: 387.0281 (0.020)
Ep: 217, Reward: 803.9786, Test: 793.2296 [183.37], Avg: 388.0502 (0.020)
Ep: 218, Reward: 957.2529, Test: 814.2497 [188.57], Avg: 389.1353 (0.020)
Ep: 219, Reward: 946.9560, Test: 874.0924 [87.38], Avg: 390.9425 (0.020)
Ep: 220, Reward: 858.8214, Test: 813.5175 [120.12], Avg: 392.3111 (0.020)
Ep: 221, Reward: 866.9951, Test: 855.7415 [113.50], Avg: 393.8873 (0.020)
Ep: 222, Reward: 932.3922, Test: 871.3196 [31.70], Avg: 395.8861 (0.020)
Ep: 223, Reward: 963.1204, Test: 884.4759 [30.79], Avg: 397.9299 (0.020)
Ep: 224, Reward: 887.3090, Test: 857.7685 [54.46], Avg: 399.7315 (0.020)
Ep: 225, Reward: 839.3557, Test: 834.3100 [97.80], Avg: 401.2217 (0.020)
Ep: 226, Reward: 852.6573, Test: 826.3975 [96.85], Avg: 402.6681 (0.020)
Ep: 227, Reward: 828.6989, Test: 881.3889 [27.17], Avg: 404.6485 (0.020)
Ep: 228, Reward: 927.8386, Test: 872.5775 [46.92], Avg: 406.4870 (0.020)
Ep: 229, Reward: 929.5233, Test: 872.8565 [16.96], Avg: 408.4409 (0.020)
Ep: 230, Reward: 1029.8709, Test: 876.2862 [32.20], Avg: 410.3269 (0.020)
Ep: 231, Reward: 917.0259, Test: 869.9246 [13.71], Avg: 412.2488 (0.020)
Ep: 232, Reward: 1064.6865, Test: 882.2640 [20.62], Avg: 414.1776 (0.020)
Ep: 233, Reward: 950.4554, Test: 880.3553 [25.63], Avg: 416.0602 (0.020)
Ep: 234, Reward: 940.2215, Test: 868.2933 [54.63], Avg: 417.7522 (0.020)
Ep: 235, Reward: 902.1331, Test: 845.9821 [58.20], Avg: 419.3201 (0.020)
Ep: 236, Reward: 821.7976, Test: 858.8009 [11.69], Avg: 421.1251 (0.020)
Ep: 237, Reward: 927.5998, Test: 897.7999 [22.56], Avg: 423.0331 (0.020)
Ep: 238, Reward: 909.4578, Test: 895.3825 [20.58], Avg: 424.9234 (0.020)
Ep: 239, Reward: 920.0833, Test: 898.5263 [18.76], Avg: 426.8185 (0.020)
Ep: 240, Reward: 881.6858, Test: 901.6016 [18.35], Avg: 428.7125 (0.020)
Ep: 241, Reward: 889.6878, Test: 838.9705 [66.15], Avg: 430.1344 (0.020)
Ep: 242, Reward: 915.4271, Test: 768.7720 [117.17], Avg: 431.0458 (0.020)
Ep: 243, Reward: 870.4198, Test: 859.1475 [51.08], Avg: 432.5910 (0.020)
Ep: 244, Reward: 981.4448, Test: 901.6969 [13.27], Avg: 434.4515 (0.020)
Ep: 245, Reward: 956.1705, Test: 916.8612 [18.83], Avg: 436.3360 (0.020)
Ep: 246, Reward: 1036.4858, Test: 893.2604 [36.10], Avg: 438.0398 (0.020)
Ep: 247, Reward: 922.1714, Test: 734.1140 [146.09], Avg: 438.6445 (0.020)
Ep: 248, Reward: 764.9512, Test: 852.7354 [34.12], Avg: 440.1705 (0.020)
Ep: 249, Reward: 899.7734, Test: 850.7247 [104.38], Avg: 441.3952 (0.020)
Ep: 250, Reward: 946.4987, Test: 901.7918 [19.03], Avg: 443.1536 (0.020)
Ep: 251, Reward: 949.9401, Test: 741.7386 [224.72], Avg: 443.4467 (0.020)
Ep: 252, Reward: 866.0476, Test: 830.9255 [73.88], Avg: 444.6862 (0.020)
Ep: 253, Reward: 910.3160, Test: 873.8127 [42.38], Avg: 446.2089 (0.020)
Ep: 254, Reward: 976.7556, Test: 869.6791 [52.07], Avg: 447.6654 (0.020)
Ep: 255, Reward: 995.4259, Test: 831.0613 [207.37], Avg: 448.3529 (0.020)
Ep: 256, Reward: 910.7657, Test: 848.5069 [52.82], Avg: 449.7045 (0.020)
Ep: 257, Reward: 898.7806, Test: 777.9686 [193.75], Avg: 450.2258 (0.020)
Ep: 258, Reward: 883.9927, Test: 850.8886 [73.16], Avg: 451.4903 (0.020)
Ep: 259, Reward: 1017.0836, Test: 885.6238 [25.70], Avg: 453.0612 (0.020)
Ep: 260, Reward: 1044.0625, Test: 880.1123 [37.65], Avg: 454.5532 (0.020)
Ep: 261, Reward: 913.7284, Test: 807.1924 [109.34], Avg: 455.4818 (0.020)
Ep: 262, Reward: 790.8980, Test: 745.9444 [199.70], Avg: 455.8269 (0.020)
Ep: 263, Reward: 825.9566, Test: 827.5326 [76.21], Avg: 456.9462 (0.020)
Ep: 264, Reward: 952.0263, Test: 882.5158 [32.48], Avg: 458.4296 (0.020)
Ep: 265, Reward: 846.3019, Test: 831.6629 [132.25], Avg: 459.3355 (0.020)
Ep: 266, Reward: 766.1827, Test: 855.1467 [37.15], Avg: 460.6788 (0.020)
Ep: 267, Reward: 862.0296, Test: 884.9964 [15.11], Avg: 462.2057 (0.020)
Ep: 268, Reward: 931.3363, Test: 851.3677 [130.02], Avg: 463.1691 (0.020)
Ep: 269, Reward: 944.6275, Test: 821.3639 [89.33], Avg: 464.1649 (0.020)
Ep: 270, Reward: 882.5265, Test: 841.1005 [67.15], Avg: 465.3080 (0.020)
Ep: 271, Reward: 722.4394, Test: 846.8770 [44.75], Avg: 466.5463 (0.020)
Ep: 272, Reward: 924.3042, Test: 841.1062 [70.34], Avg: 467.6606 (0.020)
Ep: 273, Reward: 860.3091, Test: 813.1789 [125.19], Avg: 468.4647 (0.020)
Ep: 274, Reward: 858.5745, Test: 854.5418 [18.39], Avg: 469.8018 (0.020)
Ep: 275, Reward: 913.8614, Test: 827.9338 [91.47], Avg: 470.7680 (0.020)
Ep: 276, Reward: 806.5458, Test: 655.9760 [257.71], Avg: 470.5062 (0.020)
Ep: 277, Reward: 804.4777, Test: 627.4692 [210.31], Avg: 470.3143 (0.020)
Ep: 278, Reward: 831.1567, Test: 808.8704 [98.08], Avg: 471.1762 (0.020)
Ep: 279, Reward: 861.6054, Test: 776.5984 [169.83], Avg: 471.6605 (0.020)
Ep: 280, Reward: 869.9461, Test: 882.1537 [27.47], Avg: 473.0236 (0.020)
Ep: 281, Reward: 803.7295, Test: 824.7519 [109.42], Avg: 473.8829 (0.020)
Ep: 282, Reward: 918.2096, Test: 859.8426 [67.33], Avg: 475.0088 (0.020)
Ep: 283, Reward: 978.9425, Test: 818.5853 [141.00], Avg: 475.7221 (0.020)
Ep: 284, Reward: 915.3096, Test: 855.1796 [110.84], Avg: 476.6646 (0.020)
Ep: 285, Reward: 982.7572, Test: 884.7284 [27.00], Avg: 477.9970 (0.020)
Ep: 286, Reward: 903.5237, Test: 895.9918 [21.08], Avg: 479.3800 (0.020)
Ep: 287, Reward: 903.2514, Test: 848.3146 [141.88], Avg: 480.1684 (0.020)
Ep: 288, Reward: 1044.5117, Test: 723.7196 [174.92], Avg: 480.4058 (0.020)
Ep: 289, Reward: 796.2740, Test: 761.7867 [201.60], Avg: 480.6810 (0.020)
Ep: 290, Reward: 752.1476, Test: 827.4438 [87.21], Avg: 481.5729 (0.020)
Ep: 291, Reward: 763.7939, Test: 708.1644 [245.35], Avg: 481.5087 (0.020)
Ep: 292, Reward: 819.6485, Test: 871.3422 [54.63], Avg: 482.6527 (0.020)
Ep: 293, Reward: 717.2383, Test: 836.8886 [77.44], Avg: 483.5942 (0.020)
Ep: 294, Reward: 891.3897, Test: 833.4376 [170.64], Avg: 484.2017 (0.020)
Ep: 295, Reward: 935.6149, Test: 837.2800 [194.86], Avg: 484.7362 (0.020)
Ep: 296, Reward: 946.3396, Test: 895.7052 [23.88], Avg: 486.0395 (0.020)
Ep: 297, Reward: 928.1315, Test: 884.7667 [25.43], Avg: 487.2922 (0.020)
Ep: 298, Reward: 866.3102, Test: 876.8627 [14.63], Avg: 488.5462 (0.020)
Ep: 299, Reward: 950.9709, Test: 893.5572 [24.19], Avg: 489.8156 (0.020)
Ep: 300, Reward: 945.3992, Test: 893.0794 [20.87], Avg: 491.0860 (0.020)
Ep: 301, Reward: 896.8942, Test: 883.9800 [19.73], Avg: 492.3216 (0.020)
Ep: 302, Reward: 976.4205, Test: 851.6245 [18.24], Avg: 493.4472 (0.020)
Ep: 303, Reward: 876.5046, Test: 879.9887 [45.67], Avg: 494.5685 (0.020)
Ep: 304, Reward: 894.1583, Test: 887.6880 [22.18], Avg: 495.7847 (0.020)
Ep: 305, Reward: 836.5444, Test: 824.5473 [202.17], Avg: 496.1984 (0.020)
Ep: 306, Reward: 879.9271, Test: 861.5914 [51.45], Avg: 497.2210 (0.020)
Ep: 307, Reward: 885.1576, Test: 705.7821 [224.22], Avg: 497.1702 (0.020)
Ep: 308, Reward: 893.0716, Test: 891.1212 [24.36], Avg: 498.3663 (0.020)
Ep: 309, Reward: 1068.7459, Test: 882.5777 [27.85], Avg: 499.5158 (0.020)
Ep: 310, Reward: 899.7233, Test: 853.3518 [60.19], Avg: 500.4600 (0.020)
Ep: 311, Reward: 868.1667, Test: 904.3511 [22.74], Avg: 501.6817 (0.020)
Ep: 312, Reward: 1127.4365, Test: 839.3705 [60.84], Avg: 502.5662 (0.020)
Ep: 313, Reward: 930.8648, Test: 871.9509 [24.39], Avg: 503.6649 (0.020)
Ep: 314, Reward: 965.8286, Test: 884.5824 [18.72], Avg: 504.8147 (0.020)
Ep: 315, Reward: 1101.1073, Test: 816.7206 [152.10], Avg: 505.3204 (0.020)
Ep: 316, Reward: 1007.4804, Test: 905.8604 [20.83], Avg: 506.5182 (0.020)
Ep: 317, Reward: 1038.3382, Test: 919.1983 [19.17], Avg: 507.7557 (0.020)
Ep: 318, Reward: 1043.3928, Test: 887.4894 [21.00], Avg: 508.8802 (0.020)
Ep: 319, Reward: 990.4965, Test: 897.9814 [21.75], Avg: 510.0282 (0.020)
Ep: 320, Reward: 1112.9361, Test: 899.4842 [25.46], Avg: 511.1621 (0.020)
Ep: 321, Reward: 1141.2639, Test: 911.7848 [28.20], Avg: 512.3187 (0.020)
Ep: 322, Reward: 1012.4161, Test: 829.8697 [75.73], Avg: 513.0674 (0.020)
Ep: 323, Reward: 999.4037, Test: 741.3975 [245.99], Avg: 513.0129 (0.020)
Ep: 324, Reward: 952.7604, Test: 916.9324 [21.10], Avg: 514.1908 (0.020)
Ep: 325, Reward: 1087.0243, Test: 896.4047 [29.89], Avg: 515.2715 (0.020)
Ep: 326, Reward: 898.2495, Test: 872.9292 [40.35], Avg: 516.2419 (0.020)
Ep: 327, Reward: 953.4834, Test: 846.5457 [129.26], Avg: 516.8548 (0.020)
Ep: 328, Reward: 967.5606, Test: 881.2630 [39.17], Avg: 517.8434 (0.020)
Ep: 329, Reward: 966.5398, Test: 882.7911 [23.97], Avg: 518.8767 (0.020)
Ep: 330, Reward: 926.6538, Test: 895.9752 [30.05], Avg: 519.9251 (0.020)
Ep: 331, Reward: 992.6474, Test: 879.4015 [31.61], Avg: 520.9127 (0.020)
Ep: 332, Reward: 916.4666, Test: 884.6422 [24.44], Avg: 521.9316 (0.020)
Ep: 333, Reward: 948.5470, Test: 909.8112 [26.43], Avg: 523.0138 (0.020)
Ep: 334, Reward: 937.4831, Test: 881.3574 [28.73], Avg: 523.9977 (0.020)
Ep: 335, Reward: 839.8674, Test: 856.7015 [45.64], Avg: 524.8520 (0.020)
Ep: 336, Reward: 887.2247, Test: 609.7953 [244.73], Avg: 524.3779 (0.020)
Ep: 337, Reward: 738.8637, Test: 833.4320 [39.05], Avg: 525.1767 (0.020)
Ep: 338, Reward: 799.3791, Test: 852.6454 [23.29], Avg: 526.0740 (0.020)
Ep: 339, Reward: 842.3374, Test: 805.6778 [124.36], Avg: 526.5306 (0.020)
Ep: 340, Reward: 918.0301, Test: 878.8272 [15.31], Avg: 527.5188 (0.020)
Ep: 341, Reward: 966.2022, Test: 873.2977 [86.72], Avg: 528.2763 (0.020)
Ep: 342, Reward: 908.1682, Test: 810.2103 [187.00], Avg: 528.5531 (0.020)
Ep: 343, Reward: 794.7286, Test: 823.3172 [160.75], Avg: 528.9427 (0.020)
Ep: 344, Reward: 926.6712, Test: 902.4060 [22.37], Avg: 529.9603 (0.020)
Ep: 345, Reward: 1139.2987, Test: 828.8674 [152.73], Avg: 530.3828 (0.020)
Ep: 346, Reward: 1132.3608, Test: 840.9905 [142.92], Avg: 530.8660 (0.020)
Ep: 347, Reward: 943.5886, Test: 889.3165 [22.73], Avg: 531.8307 (0.020)
Ep: 348, Reward: 942.5647, Test: 883.4818 [52.54], Avg: 532.6878 (0.020)
Ep: 349, Reward: 964.2423, Test: 893.8214 [19.09], Avg: 533.6651 (0.020)
Ep: 350, Reward: 949.3304, Test: 886.9582 [24.56], Avg: 534.6016 (0.020)
Ep: 351, Reward: 914.7193, Test: 886.7372 [30.18], Avg: 535.5163 (0.020)
Ep: 352, Reward: 888.9278, Test: 869.4733 [69.10], Avg: 536.2666 (0.020)
Ep: 353, Reward: 947.4189, Test: 891.6873 [28.85], Avg: 537.1891 (0.020)
Ep: 354, Reward: 945.2219, Test: 888.0873 [15.66], Avg: 538.1334 (0.020)
Ep: 355, Reward: 936.5836, Test: 901.0277 [17.69], Avg: 539.1031 (0.020)
Ep: 356, Reward: 997.8516, Test: 903.4413 [20.04], Avg: 540.0675 (0.020)
Ep: 357, Reward: 913.9006, Test: 904.3533 [18.25], Avg: 541.0341 (0.020)
Ep: 358, Reward: 978.0747, Test: 904.9257 [17.53], Avg: 541.9989 (0.020)
Ep: 359, Reward: 1043.5226, Test: 903.5218 [19.06], Avg: 542.9502 (0.020)
Ep: 360, Reward: 989.7639, Test: 899.8276 [24.99], Avg: 543.8695 (0.020)
Ep: 361, Reward: 945.6446, Test: 894.2512 [35.60], Avg: 544.7391 (0.020)
Ep: 362, Reward: 887.3392, Test: 886.1293 [27.82], Avg: 545.6029 (0.020)
Ep: 363, Reward: 941.8688, Test: 888.1297 [22.56], Avg: 546.4819 (0.020)
Ep: 364, Reward: 918.0340, Test: 912.8359 [17.41], Avg: 547.4380 (0.020)
Ep: 365, Reward: 920.2441, Test: 891.4413 [19.35], Avg: 548.3250 (0.020)
Ep: 366, Reward: 991.4939, Test: 734.7870 [207.70], Avg: 548.2671 (0.020)
Ep: 367, Reward: 797.9225, Test: 770.3178 [183.45], Avg: 548.3720 (0.020)
Ep: 368, Reward: 655.2322, Test: 462.9644 [209.32], Avg: 547.5733 (0.020)
Ep: 369, Reward: 635.0771, Test: 894.4447 [25.19], Avg: 548.4427 (0.020)
Ep: 370, Reward: 849.8256, Test: 902.9441 [23.25], Avg: 549.3356 (0.020)
Ep: 371, Reward: 808.3361, Test: 650.7255 [195.74], Avg: 549.0819 (0.020)
Ep: 372, Reward: 672.8994, Test: 778.8409 [205.39], Avg: 549.1473 (0.020)
Ep: 373, Reward: 742.7826, Test: 806.0518 [119.68], Avg: 549.5142 (0.020)
Ep: 374, Reward: 697.7142, Test: 609.2328 [274.88], Avg: 548.9404 (0.020)
Ep: 375, Reward: 597.1155, Test: 712.2243 [149.24], Avg: 548.9778 (0.020)
Ep: 376, Reward: 753.2903, Test: 729.2500 [205.61], Avg: 548.9105 (0.020)
Ep: 377, Reward: 789.6263, Test: 745.0865 [167.27], Avg: 548.9870 (0.020)
Ep: 378, Reward: 829.8698, Test: 834.3971 [91.23], Avg: 549.4994 (0.020)
Ep: 379, Reward: 1018.3997, Test: 889.5777 [45.89], Avg: 550.2736 (0.020)
Ep: 380, Reward: 921.4448, Test: 854.5055 [95.48], Avg: 550.8215 (0.020)
Ep: 381, Reward: 990.0057, Test: 905.1527 [19.90], Avg: 551.6969 (0.020)
Ep: 382, Reward: 1028.9505, Test: 863.0314 [41.59], Avg: 552.4012 (0.020)
Ep: 383, Reward: 842.3050, Test: 849.1362 [164.36], Avg: 552.7460 (0.020)
Ep: 384, Reward: 855.7480, Test: 904.3330 [19.49], Avg: 553.6085 (0.020)
Ep: 385, Reward: 991.3842, Test: 905.0091 [22.31], Avg: 554.4611 (0.020)
Ep: 386, Reward: 948.4308, Test: 908.3020 [24.00], Avg: 555.3134 (0.020)
Ep: 387, Reward: 1076.0725, Test: 858.1295 [94.69], Avg: 555.8498 (0.020)
Ep: 388, Reward: 856.4434, Test: 801.6109 [93.66], Avg: 556.2408 (0.020)
Ep: 389, Reward: 866.3304, Test: 875.6308 [50.45], Avg: 556.9304 (0.020)
Ep: 390, Reward: 822.6924, Test: 850.1919 [80.97], Avg: 557.4734 (0.020)
Ep: 391, Reward: 887.0036, Test: 873.7723 [36.07], Avg: 558.1882 (0.020)
Ep: 392, Reward: 1099.3660, Test: 838.2734 [118.36], Avg: 558.5997 (0.020)
Ep: 393, Reward: 987.2611, Test: 892.8472 [38.58], Avg: 559.3502 (0.020)
Ep: 394, Reward: 942.8715, Test: 902.8391 [14.97], Avg: 560.1819 (0.020)
Ep: 395, Reward: 948.2772, Test: 903.4175 [17.60], Avg: 561.0042 (0.020)
Ep: 396, Reward: 967.0833, Test: 882.6478 [102.77], Avg: 561.5555 (0.020)
Ep: 397, Reward: 1017.0555, Test: 907.9211 [12.60], Avg: 562.3941 (0.020)
Ep: 398, Reward: 995.4651, Test: 905.1780 [20.81], Avg: 563.2011 (0.020)
Ep: 399, Reward: 1023.2470, Test: 863.0909 [63.18], Avg: 563.7928 (0.020)
Ep: 400, Reward: 1023.4593, Test: 890.5903 [22.75], Avg: 564.5511 (0.020)
Ep: 401, Reward: 939.7320, Test: 912.5841 [21.86], Avg: 565.3624 (0.020)
Ep: 402, Reward: 890.3586, Test: 758.6399 [247.27], Avg: 565.2285 (0.020)
Ep: 403, Reward: 873.4182, Test: 736.7347 [246.75], Avg: 565.0422 (0.020)
Ep: 404, Reward: 753.5628, Test: 625.8293 [291.85], Avg: 564.4717 (0.020)
Ep: 405, Reward: 574.5850, Test: 630.2390 [232.82], Avg: 564.0602 (0.020)
Ep: 406, Reward: 795.7924, Test: 846.1382 [124.63], Avg: 564.4471 (0.020)
Ep: 407, Reward: 921.3027, Test: 778.2977 [190.19], Avg: 564.5051 (0.020)
Ep: 408, Reward: 912.7091, Test: 906.8391 [16.72], Avg: 565.3012 (0.020)
Ep: 409, Reward: 1001.6763, Test: 902.8007 [21.75], Avg: 566.0713 (0.020)
Ep: 410, Reward: 894.1677, Test: 875.4523 [39.52], Avg: 566.7279 (0.020)
Ep: 411, Reward: 940.3192, Test: 902.6130 [19.86], Avg: 567.4950 (0.020)
Ep: 412, Reward: 944.1483, Test: 847.2385 [64.75], Avg: 568.0155 (0.020)
Ep: 413, Reward: 806.9171, Test: 841.5102 [116.65], Avg: 568.3944 (0.020)
Ep: 414, Reward: 826.5294, Test: 798.2131 [44.68], Avg: 568.8405 (0.020)
Ep: 415, Reward: 742.3367, Test: 785.6655 [172.53], Avg: 568.9470 (0.020)
Ep: 416, Reward: 779.4512, Test: 862.9703 [81.47], Avg: 569.4567 (0.020)
Ep: 417, Reward: 816.5822, Test: 677.9009 [214.21], Avg: 569.2037 (0.020)
Ep: 418, Reward: 780.6829, Test: 761.7440 [199.51], Avg: 569.1870 (0.020)
Ep: 419, Reward: 814.3898, Test: 756.7472 [142.75], Avg: 569.2937 (0.020)
Ep: 420, Reward: 705.3886, Test: 802.1561 [88.64], Avg: 569.6363 (0.020)
Ep: 421, Reward: 752.3559, Test: 809.8094 [121.17], Avg: 569.9183 (0.020)
Ep: 422, Reward: 915.4239, Test: 854.8612 [94.26], Avg: 570.3691 (0.020)
Ep: 423, Reward: 921.9631, Test: 891.2937 [26.86], Avg: 571.0626 (0.020)
Ep: 424, Reward: 915.1174, Test: 847.4312 [105.57], Avg: 571.4645 (0.020)
Ep: 425, Reward: 866.0728, Test: 875.4333 [12.98], Avg: 572.1476 (0.020)
Ep: 426, Reward: 851.8101, Test: 871.5900 [13.77], Avg: 572.8166 (0.020)
Ep: 427, Reward: 843.7966, Test: 804.5914 [150.52], Avg: 573.0064 (0.020)
Ep: 428, Reward: 851.7907, Test: 891.8879 [21.97], Avg: 573.6985 (0.020)
Ep: 429, Reward: 1089.2595, Test: 904.0075 [23.01], Avg: 574.4132 (0.020)
Ep: 430, Reward: 948.1754, Test: 886.8903 [16.93], Avg: 575.0989 (0.020)
Ep: 431, Reward: 891.9986, Test: 812.8864 [103.14], Avg: 575.4106 (0.020)
Ep: 432, Reward: 993.9952, Test: 851.8968 [89.55], Avg: 575.8423 (0.020)
Ep: 433, Reward: 943.1951, Test: 868.7080 [62.86], Avg: 576.3723 (0.020)
Ep: 434, Reward: 853.9402, Test: 901.1423 [37.77], Avg: 577.0321 (0.020)
Ep: 435, Reward: 989.0281, Test: 877.5950 [65.18], Avg: 577.5719 (0.020)
Ep: 436, Reward: 857.7562, Test: 875.7269 [23.99], Avg: 578.1993 (0.020)
Ep: 437, Reward: 855.4466, Test: 795.6493 [112.51], Avg: 578.4389 (0.020)
Ep: 438, Reward: 787.5595, Test: 859.7938 [55.63], Avg: 578.9531 (0.020)
Ep: 439, Reward: 970.7711, Test: 873.4484 [29.02], Avg: 579.5565 (0.020)
Ep: 440, Reward: 844.7030, Test: 892.6026 [59.04], Avg: 580.1324 (0.020)
Ep: 441, Reward: 925.0834, Test: 838.8434 [50.89], Avg: 580.6026 (0.020)
Ep: 442, Reward: 874.0380, Test: 847.5004 [99.81], Avg: 580.9798 (0.020)
Ep: 443, Reward: 910.7006, Test: 770.6650 [212.50], Avg: 580.9284 (0.020)
Ep: 444, Reward: 816.3703, Test: 848.2538 [85.29], Avg: 581.3375 (0.020)
Ep: 445, Reward: 927.0762, Test: 864.5500 [41.66], Avg: 581.8791 (0.020)
Ep: 446, Reward: 922.4073, Test: 841.3355 [96.77], Avg: 582.2430 (0.020)
Ep: 447, Reward: 898.9320, Test: 818.5869 [134.96], Avg: 582.4693 (0.020)
Ep: 448, Reward: 948.8584, Test: 821.1093 [153.18], Avg: 582.6597 (0.020)
Ep: 449, Reward: 1001.1502, Test: 922.9100 [8.59], Avg: 583.3967 (0.020)
Ep: 450, Reward: 1006.8712, Test: 887.0078 [24.98], Avg: 584.0145 (0.020)
Ep: 451, Reward: 981.1317, Test: 893.5420 [22.92], Avg: 584.6486 (0.020)
Ep: 452, Reward: 911.5673, Test: 827.5049 [84.85], Avg: 584.9974 (0.020)
Ep: 453, Reward: 870.2170, Test: 879.2511 [39.16], Avg: 585.5593 (0.020)
Ep: 454, Reward: 861.4447, Test: 757.4081 [149.00], Avg: 585.6095 (0.020)
Ep: 455, Reward: 669.2539, Test: 825.8429 [113.03], Avg: 585.8884 (0.020)
Ep: 456, Reward: 828.4260, Test: 829.2151 [38.52], Avg: 586.3366 (0.020)
Ep: 457, Reward: 769.4999, Test: 756.7644 [157.81], Avg: 586.3642 (0.020)
Ep: 458, Reward: 827.4271, Test: 711.1159 [162.56], Avg: 586.2818 (0.020)
Ep: 459, Reward: 892.2648, Test: 897.5067 [26.48], Avg: 586.9008 (0.020)
Ep: 460, Reward: 873.4489, Test: 879.1981 [13.89], Avg: 587.5047 (0.020)
Ep: 461, Reward: 897.4837, Test: 897.7587 [26.84], Avg: 588.1181 (0.020)
Ep: 462, Reward: 922.7269, Test: 873.4466 [29.23], Avg: 588.6713 (0.020)
Ep: 463, Reward: 889.5222, Test: 898.8358 [23.66], Avg: 589.2887 (0.020)
Ep: 464, Reward: 913.3136, Test: 859.5016 [85.00], Avg: 589.6871 (0.020)
Ep: 465, Reward: 922.5172, Test: 875.5381 [25.21], Avg: 590.2464 (0.020)
Ep: 466, Reward: 873.9048, Test: 850.0699 [57.82], Avg: 590.6789 (0.020)
Ep: 467, Reward: 835.2378, Test: 853.0461 [63.85], Avg: 591.1031 (0.020)
Ep: 468, Reward: 822.4820, Test: 836.7322 [97.53], Avg: 591.4189 (0.020)
Ep: 469, Reward: 871.4146, Test: 872.0954 [28.80], Avg: 591.9548 (0.020)
Ep: 470, Reward: 814.4689, Test: 897.3785 [22.83], Avg: 592.5548 (0.020)
Ep: 471, Reward: 842.6130, Test: 832.2081 [161.13], Avg: 592.7211 (0.020)
Ep: 472, Reward: 773.8866, Test: 853.6784 [36.13], Avg: 593.1965 (0.020)
Ep: 473, Reward: 833.4966, Test: 868.8085 [10.72], Avg: 593.7553 (0.020)
Ep: 474, Reward: 816.9242, Test: 799.8921 [79.21], Avg: 594.0225 (0.020)
Ep: 475, Reward: 845.6323, Test: 822.6817 [21.94], Avg: 594.4568 (0.020)
Ep: 476, Reward: 825.4475, Test: 795.6139 [138.35], Avg: 594.5885 (0.020)
Ep: 477, Reward: 827.7263, Test: 805.3871 [105.31], Avg: 594.8092 (0.020)
Ep: 478, Reward: 828.8137, Test: 731.2426 [158.97], Avg: 594.7621 (0.020)
Ep: 479, Reward: 719.6224, Test: 858.9597 [19.06], Avg: 595.2728 (0.020)
Ep: 480, Reward: 801.8736, Test: 866.5369 [8.63], Avg: 595.8188 (0.020)
Ep: 481, Reward: 849.9879, Test: 767.8956 [157.33], Avg: 595.8494 (0.020)
Ep: 482, Reward: 740.8459, Test: 713.6166 [216.77], Avg: 595.6444 (0.020)
Ep: 483, Reward: 564.3363, Test: 755.4814 [204.94], Avg: 595.5513 (0.020)
Ep: 484, Reward: 567.9509, Test: 728.1591 [144.78], Avg: 595.5262 (0.020)
Ep: 485, Reward: 648.7188, Test: 807.4478 [53.43], Avg: 595.8523 (0.020)
Ep: 486, Reward: 697.8341, Test: 805.5168 [29.53], Avg: 596.2222 (0.020)
Ep: 487, Reward: 706.0478, Test: 683.9977 [150.26], Avg: 596.0941 (0.020)
Ep: 488, Reward: 752.2531, Test: 737.9572 [44.96], Avg: 596.2923 (0.020)
Ep: 489, Reward: 763.3800, Test: 862.8509 [33.40], Avg: 596.7681 (0.020)
Ep: 490, Reward: 730.7290, Test: 832.0303 [29.83], Avg: 597.1865 (0.020)
Ep: 491, Reward: 694.1252, Test: 814.4255 [37.82], Avg: 597.5512 (0.020)
Ep: 492, Reward: 723.0491, Test: 699.0467 [177.32], Avg: 597.3974 (0.020)
Ep: 493, Reward: 753.0241, Test: 745.4915 [155.05], Avg: 597.3833 (0.020)
Ep: 494, Reward: 678.1885, Test: 565.8394 [178.54], Avg: 596.9589 (0.020)
Ep: 495, Reward: 800.7750, Test: 764.3741 [134.62], Avg: 597.0250 (0.020)
Ep: 496, Reward: 778.6165, Test: 847.5559 [21.83], Avg: 597.4852 (0.020)
Ep: 497, Reward: 745.7405, Test: 810.6000 [86.68], Avg: 597.7390 (0.020)
Ep: 498, Reward: 831.5735, Test: 787.5280 [110.14], Avg: 597.8987 (0.020)
Ep: 499, Reward: 821.6064, Test: 861.4922 [36.88], Avg: 598.3521 (0.020)
