Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, NUM_STEPS

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.001   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -56.4782, Test: -64.8707 [14.62], Avg: -79.4859 (0.980)
Ep: 1, Reward: -39.6398, Test: -54.5031 [24.79], Avg: -79.3883 (0.960)
Ep: 2, Reward: -56.9305, Test: -55.1548 [17.11], Avg: -77.0126 (0.941)
Ep: 3, Reward: -62.7562, Test: -69.3302 [27.53], Avg: -81.9739 (0.922)
Ep: 4, Reward: -58.4068, Test: -52.9394 [20.35], Avg: -80.2372 (0.904)
Ep: 5, Reward: -48.2363, Test: -59.8944 [15.44], Avg: -79.4203 (0.886)
Ep: 6, Reward: -53.1202, Test: -59.0377 [32.92], Avg: -81.2117 (0.868)
Ep: 7, Reward: -47.8266, Test: -57.6127 [35.04], Avg: -82.6422 (0.851)
Ep: 8, Reward: -45.6330, Test: -57.0815 [17.77], Avg: -81.7763 (0.834)
Ep: 9, Reward: -56.9627, Test: -55.2882 [18.33], Avg: -80.9602 (0.817)
Ep: 10, Reward: -47.5922, Test: -51.2961 [15.62], Avg: -79.6834 (0.801)
Ep: 11, Reward: -48.3162, Test: -60.6250 [16.22], Avg: -79.4470 (0.785)
Ep: 12, Reward: -47.8210, Test: -45.2856 [28.03], Avg: -78.9752 (0.769)
Ep: 13, Reward: -67.1209, Test: -41.4850 [39.46], Avg: -79.1160 (0.754)
Ep: 14, Reward: -50.1839, Test: -62.4868 [13.19], Avg: -78.8868 (0.739)
Ep: 15, Reward: -61.5906, Test: -42.8691 [22.08], Avg: -78.0156 (0.724)
Ep: 16, Reward: -53.6730, Test: -55.4184 [23.78], Avg: -78.0849 (0.709)
Ep: 17, Reward: -55.2568, Test: -42.0917 [20.38], Avg: -77.2175 (0.695)
Ep: 18, Reward: -34.4562, Test: -17.5041 [30.45], Avg: -75.6772 (0.681)
Ep: 19, Reward: -41.7508, Test: -30.2501 [48.88], Avg: -75.8497 (0.668)
Ep: 20, Reward: -37.4190, Test: -24.3027 [32.04], Avg: -74.9207 (0.654)
Ep: 21, Reward: -46.5537, Test: -24.1641 [39.67], Avg: -74.4168 (0.641)
Ep: 22, Reward: -51.8353, Test: -25.4373 [26.71], Avg: -73.4485 (0.628)
Ep: 23, Reward: -51.7936, Test: -31.1963 [40.86], Avg: -73.3906 (0.616)
Ep: 24, Reward: -32.7743, Test: -14.1098 [39.07], Avg: -72.5821 (0.603)
Ep: 25, Reward: -11.2469, Test: -23.8852 [25.56], Avg: -71.6922 (0.591)
Ep: 26, Reward: -53.1405, Test: -12.0522 [84.35], Avg: -72.6076 (0.580)
Ep: 27, Reward: -18.1134, Test: 10.6795 [72.52], Avg: -72.2231 (0.568)
Ep: 28, Reward: -5.8281, Test: -26.9919 [45.44], Avg: -72.2304 (0.557)
Ep: 29, Reward: -31.7556, Test: 9.6444 [57.84], Avg: -71.4292 (0.545)
Ep: 30, Reward: -29.2210, Test: -14.5850 [58.22], Avg: -71.4735 (0.535)
Ep: 31, Reward: -6.3948, Test: 29.1096 [56.14], Avg: -70.0847 (0.524)
Ep: 32, Reward: -19.2404, Test: -13.8182 [51.48], Avg: -69.9397 (0.513)
Ep: 33, Reward: -7.4740, Test: -30.5959 [68.37], Avg: -70.7934 (0.503)
Ep: 34, Reward: -3.9685, Test: 13.1234 [44.18], Avg: -69.6582 (0.493)
Ep: 35, Reward: -9.7070, Test: 20.4688 [87.07], Avg: -69.5731 (0.483)
Ep: 36, Reward: -0.8407, Test: 10.6741 [47.84], Avg: -68.6974 (0.474)
Ep: 37, Reward: 5.7710, Test: 35.9630 [109.76], Avg: -68.8316 (0.464)
Ep: 38, Reward: 2.8235, Test: 19.6524 [48.32], Avg: -67.8019 (0.455)
Ep: 39, Reward: 19.8966, Test: 0.0232 [77.02], Avg: -68.0318 (0.446)
Ep: 40, Reward: 48.7956, Test: 21.5951 [76.80], Avg: -67.7189 (0.437)
Ep: 41, Reward: 63.9118, Test: 72.3347 [111.83], Avg: -67.0469 (0.428)
Ep: 42, Reward: 48.9431, Test: 17.2367 [85.49], Avg: -67.0751 (0.419)
Ep: 43, Reward: 67.3096, Test: 138.6380 [78.89], Avg: -64.1928 (0.411)
Ep: 44, Reward: 75.0774, Test: 74.5977 [104.67], Avg: -63.4345 (0.403)
Ep: 45, Reward: 94.3816, Test: 188.9746 [131.73], Avg: -60.8110 (0.395)
Ep: 46, Reward: 132.2382, Test: 79.0021 [95.75], Avg: -59.8735 (0.387)
Ep: 47, Reward: 103.1670, Test: 97.2086 [107.80], Avg: -58.8468 (0.379)
Ep: 48, Reward: 78.6187, Test: 189.2636 [171.95], Avg: -57.2925 (0.372)
Ep: 49, Reward: 117.1569, Test: 130.6943 [169.36], Avg: -56.9200 (0.364)
Ep: 50, Reward: 91.6152, Test: 147.9033 [109.43], Avg: -55.0496 (0.357)
Ep: 51, Reward: 112.0188, Test: 198.9801 [160.00], Avg: -53.2414 (0.350)
Ep: 52, Reward: 101.2986, Test: 149.7430 [170.01], Avg: -52.6192 (0.343)
Ep: 53, Reward: 107.4350, Test: 158.1470 [126.07], Avg: -51.0508 (0.336)
Ep: 54, Reward: 112.0861, Test: 192.5549 [215.87], Avg: -50.5465 (0.329)
Ep: 55, Reward: 220.1775, Test: 169.3348 [146.28], Avg: -49.2321 (0.323)
Ep: 56, Reward: 152.3801, Test: 188.4264 [128.74], Avg: -47.3214 (0.316)
Ep: 57, Reward: 283.1664, Test: 179.4940 [151.25], Avg: -46.0186 (0.310)
Ep: 58, Reward: 157.4458, Test: 158.1258 [121.39], Avg: -44.6159 (0.304)
Ep: 59, Reward: 238.1281, Test: 220.3814 [133.85], Avg: -42.4301 (0.298)
Ep: 60, Reward: 243.0071, Test: 273.4432 [147.32], Avg: -39.6670 (0.292)
Ep: 61, Reward: 206.6247, Test: 145.4828 [164.34], Avg: -39.3314 (0.286)
Ep: 62, Reward: 201.5457, Test: 192.0756 [191.04], Avg: -38.6906 (0.280)
Ep: 63, Reward: 179.6506, Test: 138.3058 [116.44], Avg: -37.7445 (0.274)
Ep: 64, Reward: 99.6023, Test: 395.9123 [186.48], Avg: -33.9418 (0.269)
Ep: 65, Reward: 299.1765, Test: 306.3468 [161.64], Avg: -31.2350 (0.264)
Ep: 66, Reward: 300.4156, Test: 288.0509 [236.06], Avg: -29.9929 (0.258)
Ep: 67, Reward: 320.8011, Test: 301.0340 [128.94], Avg: -27.0210 (0.253)
Ep: 68, Reward: 156.7682, Test: 422.9059 [227.89], Avg: -23.8031 (0.248)
Ep: 69, Reward: 210.2638, Test: 342.1266 [189.62], Avg: -21.2844 (0.243)
Ep: 70, Reward: 365.2236, Test: 152.8960 [90.24], Avg: -20.1020 (0.238)
Ep: 71, Reward: 389.8414, Test: 420.6671 [181.50], Avg: -16.5011 (0.233)
Ep: 72, Reward: 417.2965, Test: 520.3871 [199.26], Avg: -11.8761 (0.229)
Ep: 73, Reward: 358.6087, Test: 345.9761 [177.03], Avg: -9.4326 (0.224)
Ep: 74, Reward: 329.5305, Test: 398.0388 [209.62], Avg: -6.7945 (0.220)
Ep: 75, Reward: 455.3768, Test: 436.6577 [128.91], Avg: -2.6558 (0.215)
Ep: 76, Reward: 509.2608, Test: 606.7481 [183.36], Avg: 2.8772 (0.211)
Ep: 77, Reward: 637.0721, Test: 557.9774 [105.15], Avg: 8.6458 (0.207)
Ep: 78, Reward: 532.8081, Test: 599.0688 [118.53], Avg: 14.6192 (0.203)
Ep: 79, Reward: 600.0177, Test: 560.3379 [144.16], Avg: 19.6387 (0.199)
Ep: 80, Reward: 552.1058, Test: 625.1112 [63.53], Avg: 26.3294 (0.195)
Ep: 81, Reward: 616.7511, Test: 422.0530 [198.94], Avg: 28.7292 (0.191)
Ep: 82, Reward: 504.3224, Test: 566.2927 [191.70], Avg: 32.8962 (0.187)
Ep: 83, Reward: 568.3299, Test: 576.7013 [223.00], Avg: 36.7153 (0.183)
Ep: 84, Reward: 655.1061, Test: 594.3279 [223.39], Avg: 40.6473 (0.180)
Ep: 85, Reward: 471.1733, Test: 429.7931 [166.58], Avg: 43.2353 (0.176)
Ep: 86, Reward: 552.6855, Test: 649.9710 [144.46], Avg: 48.5488 (0.172)
Ep: 87, Reward: 568.7817, Test: 584.8239 [231.69], Avg: 52.0100 (0.169)
Ep: 88, Reward: 468.4400, Test: 539.2426 [138.35], Avg: 55.9300 (0.166)
Ep: 89, Reward: 539.4407, Test: 510.7964 [193.26], Avg: 58.8367 (0.162)
Ep: 90, Reward: 553.7052, Test: 438.5539 [230.16], Avg: 60.4801 (0.159)
Ep: 91, Reward: 537.7742, Test: 518.2585 [187.14], Avg: 63.4218 (0.156)
Ep: 92, Reward: 572.9323, Test: 667.0483 [132.43], Avg: 68.4884 (0.153)
Ep: 93, Reward: 541.7283, Test: 433.3082 [186.36], Avg: 70.3870 (0.150)
Ep: 94, Reward: 566.6279, Test: 454.5696 [183.21], Avg: 72.5024 (0.147)
Ep: 95, Reward: 634.7541, Test: 528.0268 [141.24], Avg: 75.7762 (0.144)
Ep: 96, Reward: 565.9352, Test: 559.2675 [166.55], Avg: 79.0436 (0.141)
Ep: 97, Reward: 603.2671, Test: 466.5941 [218.72], Avg: 80.7664 (0.138)
Ep: 98, Reward: 654.7756, Test: 583.9869 [200.12], Avg: 83.8280 (0.135)
Ep: 99, Reward: 590.6215, Test: 613.0850 [230.47], Avg: 86.8159 (0.133)
Ep: 100, Reward: 534.3329, Test: 683.0988 [120.31], Avg: 91.5285 (0.130)
Ep: 101, Reward: 599.5904, Test: 550.1405 [204.83], Avg: 94.0166 (0.127)
Ep: 102, Reward: 671.8598, Test: 500.1331 [161.94], Avg: 96.3872 (0.125)
Ep: 103, Reward: 560.3972, Test: 555.1301 [239.49], Avg: 98.4954 (0.122)
Ep: 104, Reward: 630.4346, Test: 571.4705 [134.10], Avg: 101.7228 (0.120)
Ep: 105, Reward: 684.8890, Test: 692.3123 [176.58], Avg: 105.6286 (0.117)
Ep: 106, Reward: 596.8078, Test: 640.8531 [152.97], Avg: 109.2010 (0.115)
Ep: 107, Reward: 549.4322, Test: 666.4373 [158.56], Avg: 112.8925 (0.113)
Ep: 108, Reward: 583.7927, Test: 648.7217 [201.02], Avg: 115.9641 (0.111)
Ep: 109, Reward: 533.2162, Test: 535.6335 [176.75], Avg: 118.1725 (0.108)
Ep: 110, Reward: 618.8844, Test: 655.4620 [169.02], Avg: 121.4902 (0.106)
Ep: 111, Reward: 580.8118, Test: 687.2318 [109.09], Avg: 125.5675 (0.104)
Ep: 112, Reward: 555.2749, Test: 543.1074 [213.84], Avg: 127.3702 (0.102)
Ep: 113, Reward: 693.5899, Test: 712.2844 [137.96], Avg: 131.2908 (0.100)
Ep: 114, Reward: 696.9452, Test: 714.2551 [189.13], Avg: 134.7155 (0.098)
Ep: 115, Reward: 607.0750, Test: 620.9749 [180.98], Avg: 137.3472 (0.096)
Ep: 116, Reward: 600.2447, Test: 684.1912 [177.62], Avg: 140.5030 (0.094)
Ep: 117, Reward: 708.2794, Test: 700.2625 [120.50], Avg: 144.2255 (0.092)
Ep: 118, Reward: 717.7930, Test: 726.6320 [107.78], Avg: 148.2140 (0.090)
Ep: 119, Reward: 771.7072, Test: 777.9193 [105.60], Avg: 152.5815 (0.089)
Ep: 120, Reward: 775.5338, Test: 688.0199 [146.60], Avg: 155.7950 (0.087)
Ep: 121, Reward: 506.4488, Test: 760.5252 [75.70], Avg: 160.1314 (0.085)
Ep: 122, Reward: 780.1143, Test: 725.8601 [96.96], Avg: 163.9425 (0.083)
Ep: 123, Reward: 762.2689, Test: 711.7532 [67.21], Avg: 167.8183 (0.082)
Ep: 124, Reward: 750.7461, Test: 646.6466 [183.73], Avg: 170.1791 (0.080)
Ep: 125, Reward: 738.0789, Test: 753.6236 [98.00], Avg: 174.0318 (0.078)
Ep: 126, Reward: 722.9600, Test: 848.7129 [30.74], Avg: 179.1022 (0.077)
Ep: 127, Reward: 720.2016, Test: 519.5943 [222.91], Avg: 180.0208 (0.075)
Ep: 128, Reward: 717.7449, Test: 728.8579 [201.21], Avg: 182.7156 (0.074)
Ep: 129, Reward: 702.3693, Test: 686.7043 [225.32], Avg: 184.8592 (0.072)
Ep: 130, Reward: 795.0193, Test: 848.2555 [24.79], Avg: 189.7340 (0.071)
Ep: 131, Reward: 867.8648, Test: 857.4887 [42.69], Avg: 194.4694 (0.069)
Ep: 132, Reward: 848.2467, Test: 848.6035 [36.83], Avg: 199.1108 (0.068)
Ep: 133, Reward: 723.3351, Test: 646.2719 [274.54], Avg: 200.3990 (0.067)
Ep: 134, Reward: 857.4998, Test: 813.0190 [126.26], Avg: 204.0016 (0.065)
Ep: 135, Reward: 871.7601, Test: 850.9552 [74.20], Avg: 208.2131 (0.064)
Ep: 136, Reward: 878.0797, Test: 753.1309 [112.55], Avg: 211.3690 (0.063)
Ep: 137, Reward: 845.5432, Test: 844.7007 [22.59], Avg: 215.7947 (0.062)
Ep: 138, Reward: 854.3751, Test: 812.9634 [103.94], Avg: 219.3431 (0.060)
Ep: 139, Reward: 907.2461, Test: 858.8302 [26.55], Avg: 223.7212 (0.059)
Ep: 140, Reward: 839.4817, Test: 840.2057 [51.18], Avg: 227.7305 (0.058)
Ep: 141, Reward: 835.6034, Test: 839.5938 [74.71], Avg: 231.5133 (0.057)
Ep: 142, Reward: 932.0402, Test: 899.8747 [20.27], Avg: 236.0454 (0.056)
Ep: 143, Reward: 910.1674, Test: 877.1366 [17.36], Avg: 240.3769 (0.055)
Ep: 144, Reward: 926.7577, Test: 885.6014 [34.40], Avg: 244.5894 (0.053)
Ep: 145, Reward: 913.1795, Test: 887.1035 [40.93], Avg: 248.7099 (0.052)
Ep: 146, Reward: 900.0719, Test: 886.6271 [42.97], Avg: 252.7572 (0.051)
Ep: 147, Reward: 865.2157, Test: 857.8410 [37.26], Avg: 256.5938 (0.050)
Ep: 148, Reward: 875.6589, Test: 767.9914 [146.09], Avg: 259.0456 (0.049)
Ep: 149, Reward: 858.5263, Test: 762.5434 [149.62], Avg: 261.4047 (0.048)
Ep: 150, Reward: 885.9853, Test: 811.6299 [72.68], Avg: 264.5672 (0.047)
Ep: 151, Reward: 802.0675, Test: 878.3233 [27.45], Avg: 268.4245 (0.046)
Ep: 152, Reward: 851.8868, Test: 873.8134 [16.93], Avg: 272.2706 (0.045)
Ep: 153, Reward: 918.2446, Test: 831.3708 [65.56], Avg: 275.4754 (0.045)
Ep: 154, Reward: 837.5226, Test: 772.8637 [152.10], Avg: 277.7031 (0.044)
Ep: 155, Reward: 820.9083, Test: 806.7032 [147.37], Avg: 280.1495 (0.043)
Ep: 156, Reward: 790.3271, Test: 795.5599 [136.92], Avg: 282.5602 (0.042)
Ep: 157, Reward: 827.4007, Test: 768.4330 [89.39], Avg: 285.0696 (0.041)
Ep: 158, Reward: 820.9700, Test: 862.5516 [44.40], Avg: 288.4223 (0.040)
Ep: 159, Reward: 825.2222, Test: 814.7883 [168.99], Avg: 290.6559 (0.039)
Ep: 160, Reward: 884.1248, Test: 815.0126 [122.89], Avg: 293.1495 (0.039)
Ep: 161, Reward: 741.7874, Test: 797.2143 [142.27], Avg: 295.3828 (0.038)
Ep: 162, Reward: 811.9699, Test: 767.4650 [126.07], Avg: 297.5056 (0.037)
Ep: 163, Reward: 697.8670, Test: 636.0899 [217.79], Avg: 298.2421 (0.036)
Ep: 164, Reward: 693.9539, Test: 745.7102 [174.55], Avg: 299.8962 (0.036)
Ep: 165, Reward: 796.6055, Test: 634.4052 [214.62], Avg: 300.6184 (0.035)
Ep: 166, Reward: 803.0230, Test: 819.4214 [85.06], Avg: 303.2157 (0.034)
Ep: 167, Reward: 812.6042, Test: 847.5722 [62.82], Avg: 306.0820 (0.034)
Ep: 168, Reward: 831.8074, Test: 814.2090 [44.37], Avg: 308.8261 (0.033)
Ep: 169, Reward: 873.6082, Test: 851.4727 [57.24], Avg: 311.6815 (0.032)
Ep: 170, Reward: 892.9016, Test: 854.1339 [123.86], Avg: 314.1294 (0.032)
Ep: 171, Reward: 867.2545, Test: 866.4849 [35.83], Avg: 317.1324 (0.031)
Ep: 172, Reward: 851.9500, Test: 825.6215 [111.60], Avg: 319.4266 (0.030)
Ep: 173, Reward: 874.1394, Test: 822.8399 [108.11], Avg: 321.6985 (0.030)
Ep: 174, Reward: 844.7245, Test: 757.9513 [173.71], Avg: 323.1987 (0.029)
Ep: 175, Reward: 805.9950, Test: 881.0224 [28.90], Avg: 326.2039 (0.029)
Ep: 176, Reward: 891.4866, Test: 823.5432 [78.22], Avg: 328.5718 (0.028)
Ep: 177, Reward: 871.3111, Test: 793.0967 [175.35], Avg: 330.1964 (0.027)
Ep: 178, Reward: 802.7262, Test: 793.4735 [125.02], Avg: 332.0861 (0.027)
Ep: 179, Reward: 804.9848, Test: 801.7581 [183.41], Avg: 333.6765 (0.026)
Ep: 180, Reward: 826.7670, Test: 849.4694 [25.62], Avg: 336.3846 (0.026)
Ep: 181, Reward: 835.9799, Test: 830.8918 [85.75], Avg: 338.6305 (0.025)
Ep: 182, Reward: 794.8846, Test: 694.8146 [206.44], Avg: 339.4488 (0.025)
Ep: 183, Reward: 800.3115, Test: 852.9408 [23.68], Avg: 342.1108 (0.024)
Ep: 184, Reward: 869.5255, Test: 832.3181 [127.95], Avg: 344.0690 (0.024)
Ep: 185, Reward: 887.2365, Test: 795.8371 [99.52], Avg: 345.9628 (0.023)
Ep: 186, Reward: 804.7159, Test: 869.0204 [31.36], Avg: 348.5922 (0.023)
Ep: 187, Reward: 852.7201, Test: 770.2158 [211.52], Avg: 349.7098 (0.022)
Ep: 188, Reward: 920.8408, Test: 816.1285 [167.52], Avg: 351.2913 (0.022)
Ep: 189, Reward: 876.0100, Test: 715.9403 [236.74], Avg: 351.9644 (0.022)
Ep: 190, Reward: 930.0751, Test: 737.3031 [266.62], Avg: 352.5860 (0.021)
Ep: 191, Reward: 814.5808, Test: 848.7836 [119.96], Avg: 354.5455 (0.021)
Ep: 192, Reward: 890.0041, Test: 803.2783 [179.02], Avg: 355.9430 (0.020)
Ep: 193, Reward: 899.9068, Test: 816.4681 [126.50], Avg: 357.6648 (0.020)
Ep: 194, Reward: 850.2405, Test: 843.0599 [98.93], Avg: 359.6467 (0.020)
Ep: 195, Reward: 923.9857, Test: 776.4179 [193.99], Avg: 360.7833 (0.020)
Ep: 196, Reward: 936.0336, Test: 846.5988 [78.23], Avg: 362.8523 (0.020)
Ep: 197, Reward: 857.6534, Test: 780.1684 [192.28], Avg: 363.9888 (0.020)
Ep: 198, Reward: 947.2051, Test: 854.5455 [50.33], Avg: 366.2010 (0.020)
Ep: 199, Reward: 862.0946, Test: 768.9799 [190.99], Avg: 367.2600 (0.020)
Ep: 200, Reward: 710.7494, Test: 830.5704 [156.51], Avg: 368.7864 (0.020)
Ep: 201, Reward: 834.4482, Test: 801.5446 [131.98], Avg: 370.2754 (0.020)
Ep: 202, Reward: 890.1362, Test: 852.8636 [94.32], Avg: 372.1881 (0.020)
Ep: 203, Reward: 834.3601, Test: 879.3892 [24.70], Avg: 374.5532 (0.020)
Ep: 204, Reward: 860.8000, Test: 872.3075 [18.23], Avg: 376.8924 (0.020)
Ep: 205, Reward: 896.6053, Test: 878.0693 [24.81], Avg: 379.2048 (0.020)
Ep: 206, Reward: 867.4545, Test: 818.7600 [138.25], Avg: 380.6604 (0.020)
Ep: 207, Reward: 809.8984, Test: 867.0743 [20.18], Avg: 382.9019 (0.020)
Ep: 208, Reward: 852.4875, Test: 848.2468 [43.58], Avg: 384.9199 (0.020)
Ep: 209, Reward: 842.8952, Test: 755.3455 [187.14], Avg: 385.7927 (0.020)
Ep: 210, Reward: 950.0235, Test: 798.6790 [159.79], Avg: 386.9922 (0.020)
Ep: 211, Reward: 1017.4392, Test: 767.6744 [226.23], Avg: 387.7208 (0.020)
Ep: 212, Reward: 926.3181, Test: 871.8941 [77.72], Avg: 389.6290 (0.020)
Ep: 213, Reward: 1011.8753, Test: 745.4724 [241.91], Avg: 390.1614 (0.020)
Ep: 214, Reward: 1021.7706, Test: 909.4844 [16.16], Avg: 392.5017 (0.020)
Ep: 215, Reward: 1050.2117, Test: 905.1573 [24.99], Avg: 394.7595 (0.020)
Ep: 216, Reward: 1028.0409, Test: 901.2213 [23.27], Avg: 396.9862 (0.020)
Ep: 217, Reward: 1005.4424, Test: 891.4173 [46.35], Avg: 399.0416 (0.020)
Ep: 218, Reward: 992.8386, Test: 866.5263 [85.53], Avg: 400.7857 (0.020)
Ep: 219, Reward: 981.6798, Test: 854.7856 [68.04], Avg: 402.5400 (0.020)
Ep: 220, Reward: 1037.7489, Test: 898.0727 [50.44], Avg: 404.5540 (0.020)
Ep: 221, Reward: 968.2247, Test: 851.9895 [119.51], Avg: 406.0311 (0.020)
Ep: 222, Reward: 1036.0344, Test: 814.1045 [137.29], Avg: 407.2454 (0.020)
Ep: 223, Reward: 898.7414, Test: 853.5367 [37.82], Avg: 409.0689 (0.020)
Ep: 224, Reward: 937.8376, Test: 893.8055 [21.32], Avg: 411.1286 (0.020)
Ep: 225, Reward: 943.1656, Test: 846.0256 [57.27], Avg: 412.7995 (0.020)
Ep: 226, Reward: 865.0866, Test: 860.0865 [22.64], Avg: 414.6702 (0.020)
Ep: 227, Reward: 873.1265, Test: 887.5578 [17.41], Avg: 416.6679 (0.020)
Ep: 228, Reward: 909.6849, Test: 891.4946 [23.57], Avg: 418.6385 (0.020)
Ep: 229, Reward: 895.2208, Test: 894.3835 [28.77], Avg: 420.5818 (0.020)
Ep: 230, Reward: 905.4741, Test: 768.9718 [129.42], Avg: 421.5298 (0.020)
Ep: 231, Reward: 866.2281, Test: 840.0003 [154.41], Avg: 422.6680 (0.020)
Ep: 232, Reward: 958.3585, Test: 882.7605 [31.36], Avg: 424.5080 (0.020)
Ep: 233, Reward: 979.3425, Test: 898.8224 [22.36], Avg: 426.4395 (0.020)
Ep: 234, Reward: 948.9174, Test: 802.6481 [139.00], Avg: 427.4489 (0.020)
Ep: 235, Reward: 944.8711, Test: 874.7030 [71.89], Avg: 429.0394 (0.020)
Ep: 236, Reward: 893.0163, Test: 808.7815 [79.93], Avg: 430.3044 (0.020)
Ep: 237, Reward: 981.9315, Test: 883.3528 [26.88], Avg: 432.0950 (0.020)
Ep: 238, Reward: 1104.7292, Test: 778.0503 [234.65], Avg: 432.5607 (0.020)
Ep: 239, Reward: 843.3702, Test: 905.6929 [26.13], Avg: 434.4232 (0.020)
Ep: 240, Reward: 1056.5697, Test: 835.9543 [192.16], Avg: 435.2920 (0.020)
Ep: 241, Reward: 863.7986, Test: 883.4214 [58.20], Avg: 436.9033 (0.020)
Ep: 242, Reward: 924.7586, Test: 854.4144 [102.71], Avg: 438.1988 (0.020)
Ep: 243, Reward: 985.7858, Test: 898.2313 [25.99], Avg: 439.9776 (0.020)
Ep: 244, Reward: 1060.6193, Test: 857.6419 [41.87], Avg: 441.5115 (0.020)
Ep: 245, Reward: 977.7434, Test: 881.1226 [39.34], Avg: 443.1386 (0.020)
Ep: 246, Reward: 1005.2175, Test: 904.9331 [22.14], Avg: 444.9185 (0.020)
Ep: 247, Reward: 993.0546, Test: 879.8426 [13.97], Avg: 446.6159 (0.020)
Ep: 248, Reward: 1099.6449, Test: 878.6058 [39.59], Avg: 448.1918 (0.020)
Ep: 249, Reward: 910.3944, Test: 869.9988 [58.48], Avg: 449.6452 (0.020)
Ep: 250, Reward: 915.0306, Test: 881.3575 [46.36], Avg: 451.1804 (0.020)
Ep: 251, Reward: 914.1079, Test: 836.7025 [35.36], Avg: 452.5700 (0.020)
Ep: 252, Reward: 851.7627, Test: 866.6860 [62.50], Avg: 453.9598 (0.020)
Ep: 253, Reward: 880.3557, Test: 800.8630 [114.80], Avg: 454.8736 (0.020)
Ep: 254, Reward: 904.7505, Test: 896.9603 [35.40], Avg: 456.4684 (0.020)
Ep: 255, Reward: 890.5193, Test: 834.4688 [86.85], Avg: 457.6057 (0.020)
Ep: 256, Reward: 813.8658, Test: 861.0161 [29.13], Avg: 459.0621 (0.020)
Ep: 257, Reward: 886.3964, Test: 871.3144 [26.23], Avg: 460.5583 (0.020)
Ep: 258, Reward: 870.8532, Test: 880.1784 [26.20], Avg: 462.0773 (0.020)
Ep: 259, Reward: 856.4878, Test: 872.6879 [26.62], Avg: 463.5542 (0.020)
Ep: 260, Reward: 871.4787, Test: 858.4271 [30.06], Avg: 464.9519 (0.020)
Ep: 261, Reward: 894.7175, Test: 872.7923 [30.34], Avg: 466.3927 (0.020)
Ep: 262, Reward: 912.0821, Test: 877.1306 [28.38], Avg: 467.8465 (0.020)
Ep: 263, Reward: 856.7088, Test: 849.9258 [190.34], Avg: 468.5728 (0.020)
Ep: 264, Reward: 881.2281, Test: 807.8876 [199.63], Avg: 469.1000 (0.020)
Ep: 265, Reward: 731.7245, Test: 721.8452 [255.11], Avg: 469.0911 (0.020)
Ep: 266, Reward: 904.8652, Test: 772.4089 [159.52], Avg: 469.6296 (0.020)
Ep: 267, Reward: 798.9174, Test: 646.9671 [265.90], Avg: 469.2992 (0.020)
Ep: 268, Reward: 882.5421, Test: 828.5272 [138.84], Avg: 470.1185 (0.020)
Ep: 269, Reward: 833.1405, Test: 856.9651 [76.27], Avg: 471.2687 (0.020)
Ep: 270, Reward: 814.7060, Test: 769.4007 [216.53], Avg: 471.5698 (0.020)
Ep: 271, Reward: 727.4127, Test: 750.1815 [146.58], Avg: 472.0553 (0.020)
Ep: 272, Reward: 883.8788, Test: 817.6897 [112.56], Avg: 472.9090 (0.020)
Ep: 273, Reward: 798.0758, Test: 791.9416 [80.45], Avg: 473.7798 (0.020)
Ep: 274, Reward: 787.4482, Test: 804.3160 [162.25], Avg: 474.3917 (0.020)
Ep: 275, Reward: 780.1008, Test: 860.1437 [75.53], Avg: 475.5157 (0.020)
Ep: 276, Reward: 946.5917, Test: 868.9950 [73.21], Avg: 476.6719 (0.020)
Ep: 277, Reward: 1020.0324, Test: 861.4516 [96.16], Avg: 477.7101 (0.020)
Ep: 278, Reward: 872.1247, Test: 825.8600 [172.80], Avg: 478.3386 (0.020)
Ep: 279, Reward: 912.4884, Test: 884.5342 [44.47], Avg: 479.6305 (0.020)
Ep: 280, Reward: 987.4827, Test: 907.8633 [24.00], Avg: 481.0690 (0.020)
Ep: 281, Reward: 1050.8878, Test: 888.1830 [27.76], Avg: 482.4142 (0.020)
Ep: 282, Reward: 931.0647, Test: 906.1379 [27.45], Avg: 483.8145 (0.020)
Ep: 283, Reward: 1010.5097, Test: 908.2713 [35.58], Avg: 485.1838 (0.020)
Ep: 284, Reward: 1047.5134, Test: 884.8084 [42.04], Avg: 486.4385 (0.020)
Ep: 285, Reward: 1093.9324, Test: 839.0313 [190.15], Avg: 487.0065 (0.020)
Ep: 286, Reward: 954.1989, Test: 879.6165 [38.21], Avg: 488.2413 (0.020)
Ep: 287, Reward: 857.4430, Test: 810.6954 [171.62], Avg: 488.7651 (0.020)
Ep: 288, Reward: 967.1342, Test: 909.6779 [39.21], Avg: 490.0858 (0.020)
Ep: 289, Reward: 946.9369, Test: 829.7427 [224.84], Avg: 490.4817 (0.020)
Ep: 290, Reward: 973.0369, Test: 891.6385 [36.11], Avg: 491.7362 (0.020)
Ep: 291, Reward: 920.7241, Test: 843.0871 [88.19], Avg: 492.6374 (0.020)
Ep: 292, Reward: 956.9079, Test: 730.6896 [171.83], Avg: 492.8634 (0.020)
Ep: 293, Reward: 860.5923, Test: 832.4494 [144.59], Avg: 493.5267 (0.020)
Ep: 294, Reward: 993.0229, Test: 838.9164 [173.07], Avg: 494.1108 (0.020)
Ep: 295, Reward: 1011.9264, Test: 819.2380 [214.93], Avg: 494.4831 (0.020)
Ep: 296, Reward: 898.4467, Test: 904.4926 [31.60], Avg: 495.7572 (0.020)
Ep: 297, Reward: 998.4052, Test: 854.1170 [98.54], Avg: 496.6291 (0.020)
Ep: 298, Reward: 906.0798, Test: 856.2421 [60.35], Avg: 497.6299 (0.020)
Ep: 299, Reward: 1005.5716, Test: 861.3253 [81.94], Avg: 498.5691 (0.020)
Ep: 300, Reward: 1060.5264, Test: 841.2288 [130.66], Avg: 499.2735 (0.020)
Ep: 301, Reward: 873.9445, Test: 891.8417 [34.95], Avg: 500.4576 (0.020)
Ep: 302, Reward: 981.7160, Test: 894.7997 [16.61], Avg: 501.7043 (0.020)
Ep: 303, Reward: 963.9406, Test: 908.3194 [24.09], Avg: 502.9626 (0.020)
Ep: 304, Reward: 1091.4290, Test: 815.1109 [139.35], Avg: 503.5291 (0.020)
Ep: 305, Reward: 997.4257, Test: 877.4424 [38.70], Avg: 504.6246 (0.020)
Ep: 306, Reward: 988.5724, Test: 859.0398 [62.54], Avg: 505.5753 (0.020)
Ep: 307, Reward: 1009.3721, Test: 846.0420 [147.84], Avg: 506.2007 (0.020)
Ep: 308, Reward: 983.0817, Test: 898.3161 [31.80], Avg: 507.3668 (0.020)
Ep: 309, Reward: 950.5819, Test: 908.7652 [21.41], Avg: 508.5925 (0.020)
Ep: 310, Reward: 1002.7486, Test: 897.0038 [66.69], Avg: 509.6270 (0.020)
Ep: 311, Reward: 1058.4213, Test: 890.8194 [70.40], Avg: 510.6231 (0.020)
Ep: 312, Reward: 1074.8874, Test: 914.4392 [26.78], Avg: 511.8277 (0.020)
Ep: 313, Reward: 987.7979, Test: 736.5088 [276.60], Avg: 511.6624 (0.020)
Ep: 314, Reward: 1020.7106, Test: 818.6571 [162.00], Avg: 512.1227 (0.020)
Ep: 315, Reward: 995.4823, Test: 889.2918 [83.42], Avg: 513.0523 (0.020)
Ep: 316, Reward: 1065.5649, Test: 915.5834 [24.24], Avg: 514.2456 (0.020)
Ep: 317, Reward: 1052.7931, Test: 886.5728 [70.37], Avg: 515.1951 (0.020)
Ep: 318, Reward: 1064.3547, Test: 891.5175 [40.87], Avg: 516.2467 (0.020)
Ep: 319, Reward: 919.6852, Test: 880.5764 [70.27], Avg: 517.1657 (0.020)
Ep: 320, Reward: 1043.0490, Test: 882.4421 [67.12], Avg: 518.0945 (0.020)
Ep: 321, Reward: 1080.4354, Test: 909.0632 [32.51], Avg: 519.2077 (0.020)
Ep: 322, Reward: 952.9884, Test: 885.4181 [63.13], Avg: 520.1461 (0.020)
Ep: 323, Reward: 1083.7324, Test: 891.3979 [71.23], Avg: 521.0720 (0.020)
Ep: 324, Reward: 1004.9494, Test: 883.3312 [64.83], Avg: 521.9872 (0.020)
Ep: 325, Reward: 958.1580, Test: 911.6125 [16.28], Avg: 523.1324 (0.020)
Ep: 326, Reward: 952.0240, Test: 892.4293 [19.93], Avg: 524.2008 (0.020)
Ep: 327, Reward: 1061.4210, Test: 805.9741 [172.80], Avg: 524.5331 (0.020)
Ep: 328, Reward: 949.8061, Test: 905.7887 [22.43], Avg: 525.6237 (0.020)
Ep: 329, Reward: 951.5092, Test: 876.7055 [70.14], Avg: 526.4751 (0.020)
Ep: 330, Reward: 862.4925, Test: 865.7959 [99.01], Avg: 527.2011 (0.020)
Ep: 331, Reward: 814.0080, Test: 868.2403 [73.46], Avg: 528.0070 (0.020)
Ep: 332, Reward: 848.3139, Test: 833.4084 [89.84], Avg: 528.6544 (0.020)
Ep: 333, Reward: 959.1414, Test: 901.4522 [24.18], Avg: 529.6981 (0.020)
Ep: 334, Reward: 1057.4660, Test: 882.3857 [75.73], Avg: 530.5249 (0.020)
Ep: 335, Reward: 979.7355, Test: 779.1767 [220.41], Avg: 530.6089 (0.020)
Ep: 336, Reward: 864.2769, Test: 835.7751 [173.33], Avg: 531.0001 (0.020)
Ep: 337, Reward: 848.4573, Test: 881.1872 [59.22], Avg: 531.8610 (0.020)
Ep: 338, Reward: 933.7711, Test: 912.8433 [23.90], Avg: 532.9143 (0.020)
Ep: 339, Reward: 1072.4958, Test: 831.2744 [91.81], Avg: 533.5218 (0.020)
Ep: 340, Reward: 964.6188, Test: 876.0374 [58.33], Avg: 534.3552 (0.020)
Ep: 341, Reward: 930.7508, Test: 890.4536 [20.71], Avg: 535.3359 (0.020)
Ep: 342, Reward: 1008.0017, Test: 888.9045 [74.79], Avg: 536.1487 (0.020)
Ep: 343, Reward: 910.7332, Test: 885.0494 [64.77], Avg: 536.9746 (0.020)
Ep: 344, Reward: 980.0245, Test: 868.7857 [80.52], Avg: 537.7030 (0.020)
Ep: 345, Reward: 1006.0674, Test: 850.8319 [61.54], Avg: 538.4301 (0.020)
Ep: 346, Reward: 996.8386, Test: 836.9301 [88.95], Avg: 539.0340 (0.020)
Ep: 347, Reward: 950.8157, Test: 864.4980 [72.47], Avg: 539.7610 (0.020)
Ep: 348, Reward: 960.4149, Test: 883.6073 [30.28], Avg: 540.6595 (0.020)
Ep: 349, Reward: 982.4310, Test: 849.9771 [112.78], Avg: 541.2210 (0.020)
Ep: 350, Reward: 907.5294, Test: 879.1699 [35.42], Avg: 542.0829 (0.020)
Ep: 351, Reward: 911.6308, Test: 888.4006 [18.17], Avg: 543.0151 (0.020)
Ep: 352, Reward: 952.5125, Test: 881.4892 [24.55], Avg: 543.9044 (0.020)
Ep: 353, Reward: 870.6864, Test: 883.6449 [36.30], Avg: 544.7616 (0.020)
Ep: 354, Reward: 1068.6089, Test: 832.6107 [138.62], Avg: 545.1820 (0.020)
Ep: 355, Reward: 926.3201, Test: 868.0804 [62.31], Avg: 545.9140 (0.020)
Ep: 356, Reward: 930.8467, Test: 756.8282 [244.58], Avg: 545.8197 (0.020)
Ep: 357, Reward: 922.5229, Test: 891.3156 [24.52], Avg: 546.7162 (0.020)
Ep: 358, Reward: 935.8096, Test: 829.8895 [147.26], Avg: 547.0948 (0.020)
Ep: 359, Reward: 916.0285, Test: 865.5641 [100.61], Avg: 547.7000 (0.020)
Ep: 360, Reward: 919.2986, Test: 906.5438 [24.36], Avg: 548.6265 (0.020)
Ep: 361, Reward: 981.6861, Test: 840.2448 [123.43], Avg: 549.0912 (0.020)
Ep: 362, Reward: 912.8105, Test: 877.3586 [69.17], Avg: 549.8049 (0.020)
Ep: 363, Reward: 948.2305, Test: 877.2764 [10.27], Avg: 550.6763 (0.020)
Ep: 364, Reward: 838.9237, Test: 879.0947 [28.26], Avg: 551.4987 (0.020)
Ep: 365, Reward: 849.8260, Test: 868.4432 [65.86], Avg: 552.1847 (0.020)
Ep: 366, Reward: 936.6898, Test: 779.2229 [187.05], Avg: 552.2937 (0.020)
Ep: 367, Reward: 893.6306, Test: 846.3140 [72.93], Avg: 552.8945 (0.020)
Ep: 368, Reward: 953.6838, Test: 893.6621 [12.62], Avg: 553.7838 (0.020)
Ep: 369, Reward: 864.4432, Test: 882.1206 [53.58], Avg: 554.5263 (0.020)
Ep: 370, Reward: 891.0828, Test: 849.0925 [51.40], Avg: 555.1818 (0.020)
Ep: 371, Reward: 937.6113, Test: 814.7097 [90.71], Avg: 555.6356 (0.020)
Ep: 372, Reward: 980.1708, Test: 803.2162 [154.78], Avg: 555.8844 (0.020)
Ep: 373, Reward: 872.9422, Test: 851.1586 [37.42], Avg: 556.5738 (0.020)
Ep: 374, Reward: 860.8240, Test: 874.2956 [13.20], Avg: 557.3859 (0.020)
Ep: 375, Reward: 885.0631, Test: 810.0348 [116.22], Avg: 557.7487 (0.020)
Ep: 376, Reward: 939.6566, Test: 883.0818 [33.93], Avg: 558.5217 (0.020)
Ep: 377, Reward: 950.9314, Test: 901.4739 [27.07], Avg: 559.3573 (0.020)
Ep: 378, Reward: 996.4422, Test: 888.3481 [70.79], Avg: 560.0386 (0.020)
Ep: 379, Reward: 1028.0310, Test: 897.1915 [75.32], Avg: 560.7276 (0.020)
Ep: 380, Reward: 976.4167, Test: 833.5322 [194.29], Avg: 560.9337 (0.020)
Ep: 381, Reward: 988.5815, Test: 867.3835 [56.35], Avg: 561.5884 (0.020)
Ep: 382, Reward: 973.2320, Test: 833.1950 [143.17], Avg: 561.9238 (0.020)
Ep: 383, Reward: 903.9062, Test: 906.8657 [18.60], Avg: 562.7736 (0.020)
Ep: 384, Reward: 943.5522, Test: 869.4972 [128.08], Avg: 563.2376 (0.020)
Ep: 385, Reward: 983.7543, Test: 838.1238 [84.18], Avg: 563.7317 (0.020)
Ep: 386, Reward: 991.1694, Test: 894.2975 [33.49], Avg: 564.4993 (0.020)
Ep: 387, Reward: 817.7191, Test: 803.2702 [145.45], Avg: 564.7399 (0.020)
Ep: 388, Reward: 866.5080, Test: 778.5375 [180.91], Avg: 564.8244 (0.020)
Ep: 389, Reward: 940.8508, Test: 859.8587 [77.30], Avg: 565.3827 (0.020)
Ep: 390, Reward: 894.0228, Test: 870.7786 [28.61], Avg: 566.0906 (0.020)
Ep: 391, Reward: 872.4538, Test: 863.5737 [54.59], Avg: 566.7102 (0.020)
Ep: 392, Reward: 934.9610, Test: 756.5610 [178.04], Avg: 566.7403 (0.020)
Ep: 393, Reward: 817.7555, Test: 787.0350 [198.71], Avg: 566.7951 (0.020)
Ep: 394, Reward: 1063.2114, Test: 805.9359 [211.68], Avg: 566.8646 (0.020)
Ep: 395, Reward: 983.5542, Test: 830.5034 [77.98], Avg: 567.3334 (0.020)
Ep: 396, Reward: 925.5283, Test: 866.5035 [56.36], Avg: 567.9450 (0.020)
Ep: 397, Reward: 878.1372, Test: 900.4214 [26.21], Avg: 568.7145 (0.020)
Ep: 398, Reward: 924.3068, Test: 828.1854 [130.26], Avg: 569.0384 (0.020)
Ep: 399, Reward: 913.1995, Test: 831.6242 [180.49], Avg: 569.2436 (0.020)
Ep: 400, Reward: 937.3142, Test: 856.8938 [30.34], Avg: 569.8853 (0.020)
Ep: 401, Reward: 962.2973, Test: 888.9618 [25.09], Avg: 570.6166 (0.020)
Ep: 402, Reward: 829.1853, Test: 856.4103 [74.59], Avg: 571.1407 (0.020)
Ep: 403, Reward: 860.5936, Test: 869.8699 [48.77], Avg: 571.7594 (0.020)
Ep: 404, Reward: 880.3652, Test: 885.9232 [18.92], Avg: 572.4884 (0.020)
Ep: 405, Reward: 970.4123, Test: 880.2928 [33.69], Avg: 573.1635 (0.020)
Ep: 406, Reward: 971.6911, Test: 740.8395 [159.20], Avg: 573.1844 (0.020)
Ep: 407, Reward: 771.5213, Test: 816.9920 [73.24], Avg: 573.6024 (0.020)
Ep: 408, Reward: 906.5174, Test: 858.1518 [79.83], Avg: 574.1030 (0.020)
Ep: 409, Reward: 1019.7541, Test: 878.1700 [51.04], Avg: 574.7201 (0.020)
Ep: 410, Reward: 829.6733, Test: 887.0310 [21.60], Avg: 575.4274 (0.020)
Ep: 411, Reward: 911.4740, Test: 825.3814 [111.08], Avg: 575.7645 (0.020)
Ep: 412, Reward: 988.7608, Test: 858.0496 [28.36], Avg: 576.3793 (0.020)
Ep: 413, Reward: 910.3329, Test: 836.2544 [43.17], Avg: 576.9027 (0.020)
Ep: 414, Reward: 878.0287, Test: 804.9243 [99.56], Avg: 577.2123 (0.020)
Ep: 415, Reward: 800.9734, Test: 766.6512 [102.91], Avg: 577.4203 (0.020)
Ep: 416, Reward: 805.6666, Test: 779.2050 [143.18], Avg: 577.5608 (0.020)
Ep: 417, Reward: 796.9501, Test: 669.1773 [217.23], Avg: 577.2603 (0.020)
Ep: 418, Reward: 849.0321, Test: 856.1306 [58.02], Avg: 577.7874 (0.020)
Ep: 419, Reward: 848.5727, Test: 836.3194 [74.23], Avg: 578.2262 (0.020)
Ep: 420, Reward: 810.2321, Test: 749.0529 [37.05], Avg: 578.5440 (0.020)
Ep: 421, Reward: 833.6894, Test: 767.3576 [159.40], Avg: 578.6137 (0.020)
Ep: 422, Reward: 810.7100, Test: 708.1501 [248.34], Avg: 578.3328 (0.020)
Ep: 423, Reward: 778.4164, Test: 872.8321 [30.53], Avg: 578.9554 (0.020)
Ep: 424, Reward: 932.5835, Test: 908.4141 [24.93], Avg: 579.6719 (0.020)
Ep: 425, Reward: 825.1237, Test: 831.1892 [137.19], Avg: 579.9403 (0.020)
Ep: 426, Reward: 904.7839, Test: 880.7587 [21.82], Avg: 580.5937 (0.020)
Ep: 427, Reward: 844.0907, Test: 877.6092 [15.94], Avg: 581.2504 (0.020)
Ep: 428, Reward: 939.3041, Test: 875.9973 [24.55], Avg: 581.8802 (0.020)
Ep: 429, Reward: 855.5386, Test: 866.0721 [31.43], Avg: 582.4680 (0.020)
Ep: 430, Reward: 892.8893, Test: 870.7530 [26.51], Avg: 583.0754 (0.020)
Ep: 431, Reward: 835.7898, Test: 826.4705 [91.04], Avg: 583.4281 (0.020)
Ep: 432, Reward: 860.8252, Test: 833.7182 [80.64], Avg: 583.8199 (0.020)
Ep: 433, Reward: 839.5029, Test: 802.1344 [150.43], Avg: 583.9763 (0.020)
Ep: 434, Reward: 863.0951, Test: 850.7909 [67.08], Avg: 584.4354 (0.020)
Ep: 435, Reward: 842.5217, Test: 854.1294 [19.27], Avg: 585.0098 (0.020)
Ep: 436, Reward: 853.5130, Test: 841.7598 [59.55], Avg: 585.4611 (0.020)
Ep: 437, Reward: 834.8845, Test: 815.7396 [121.55], Avg: 585.7093 (0.020)
Ep: 438, Reward: 881.2615, Test: 863.2642 [30.75], Avg: 586.2715 (0.020)
Ep: 439, Reward: 889.4900, Test: 870.2418 [39.45], Avg: 586.8273 (0.020)
Ep: 440, Reward: 891.7219, Test: 872.3978 [17.38], Avg: 587.4354 (0.020)
Ep: 441, Reward: 895.6596, Test: 889.3368 [28.66], Avg: 588.0536 (0.020)
Ep: 442, Reward: 928.6216, Test: 868.4946 [37.55], Avg: 588.6019 (0.020)
Ep: 443, Reward: 913.4794, Test: 883.9271 [31.90], Avg: 589.1952 (0.020)
Ep: 444, Reward: 843.4649, Test: 868.8718 [27.15], Avg: 589.7627 (0.020)
Ep: 445, Reward: 805.6400, Test: 721.0987 [248.85], Avg: 589.4992 (0.020)
Ep: 446, Reward: 815.5571, Test: 879.7332 [52.83], Avg: 590.0303 (0.020)
Ep: 447, Reward: 798.5797, Test: 748.6785 [126.90], Avg: 590.1012 (0.020)
Ep: 448, Reward: 868.4351, Test: 754.0316 [144.08], Avg: 590.1454 (0.020)
Ep: 449, Reward: 841.5053, Test: 872.6302 [19.68], Avg: 590.7294 (0.020)
Ep: 450, Reward: 772.9399, Test: 755.7250 [82.14], Avg: 590.9131 (0.020)
Ep: 451, Reward: 803.9752, Test: 735.5671 [172.25], Avg: 590.8520 (0.020)
Ep: 452, Reward: 799.3285, Test: 865.3488 [54.48], Avg: 591.3377 (0.020)
Ep: 453, Reward: 847.7739, Test: 715.8877 [227.59], Avg: 591.1108 (0.020)
Ep: 454, Reward: 806.2970, Test: 816.1756 [131.99], Avg: 591.3153 (0.020)
Ep: 455, Reward: 839.2142, Test: 813.2407 [57.75], Avg: 591.6753 (0.020)
Ep: 456, Reward: 821.0510, Test: 764.1561 [115.96], Avg: 591.7990 (0.020)
Ep: 457, Reward: 828.5222, Test: 852.4529 [104.47], Avg: 592.1400 (0.020)
Ep: 458, Reward: 825.3962, Test: 845.9131 [37.27], Avg: 592.6117 (0.020)
Ep: 459, Reward: 791.4895, Test: 796.6304 [93.18], Avg: 592.8527 (0.020)
Ep: 460, Reward: 755.7387, Test: 874.7282 [37.99], Avg: 593.3817 (0.020)
Ep: 461, Reward: 758.4708, Test: 780.3253 [142.83], Avg: 593.4772 (0.020)
Ep: 462, Reward: 652.1639, Test: 710.1446 [138.22], Avg: 593.4307 (0.020)
Ep: 463, Reward: 733.6739, Test: 718.7841 [161.67], Avg: 593.3524 (0.020)
Ep: 464, Reward: 788.9466, Test: 740.4373 [131.90], Avg: 593.3850 (0.020)
Ep: 465, Reward: 771.3227, Test: 765.0802 [107.86], Avg: 593.5220 (0.020)
Ep: 466, Reward: 800.6736, Test: 845.7067 [38.53], Avg: 593.9795 (0.020)
Ep: 467, Reward: 803.7140, Test: 814.4421 [37.51], Avg: 594.3704 (0.020)
Ep: 468, Reward: 805.9173, Test: 767.8928 [109.77], Avg: 594.5064 (0.020)
Ep: 469, Reward: 800.7414, Test: 848.5862 [68.61], Avg: 594.9010 (0.020)
Ep: 470, Reward: 847.5256, Test: 884.6845 [26.46], Avg: 595.4601 (0.020)
Ep: 471, Reward: 788.5513, Test: 842.4509 [54.14], Avg: 595.8687 (0.020)
Ep: 472, Reward: 829.6420, Test: 766.5081 [124.65], Avg: 595.9659 (0.020)
Ep: 473, Reward: 777.5448, Test: 683.6165 [116.93], Avg: 595.9041 (0.020)
Ep: 474, Reward: 753.2322, Test: 795.0397 [53.10], Avg: 596.2115 (0.020)
Ep: 475, Reward: 711.2153, Test: 727.8359 [213.15], Avg: 596.0403 (0.020)
Ep: 476, Reward: 785.8351, Test: 815.8060 [106.82], Avg: 596.2770 (0.020)
Ep: 477, Reward: 828.6336, Test: 785.6044 [141.57], Avg: 596.3770 (0.020)
Ep: 478, Reward: 855.4311, Test: 871.6963 [59.73], Avg: 596.8270 (0.020)
Ep: 479, Reward: 882.8332, Test: 808.9709 [187.15], Avg: 596.8791 (0.020)
Ep: 480, Reward: 953.3070, Test: 724.5123 [208.28], Avg: 596.7114 (0.020)
Ep: 481, Reward: 871.0171, Test: 861.0801 [27.07], Avg: 597.2038 (0.020)
Ep: 482, Reward: 871.0341, Test: 868.9169 [56.86], Avg: 597.6486 (0.020)
Ep: 483, Reward: 943.2528, Test: 866.4351 [32.95], Avg: 598.1359 (0.020)
Ep: 484, Reward: 916.8263, Test: 882.6313 [49.26], Avg: 598.6209 (0.020)
Ep: 485, Reward: 912.9064, Test: 837.7627 [97.94], Avg: 598.9114 (0.020)
Ep: 486, Reward: 850.2798, Test: 831.3033 [85.83], Avg: 599.2124 (0.020)
Ep: 487, Reward: 825.4348, Test: 879.2325 [69.89], Avg: 599.6430 (0.020)
Ep: 488, Reward: 895.5431, Test: 865.6650 [54.00], Avg: 600.0765 (0.020)
Ep: 489, Reward: 775.8011, Test: 779.5278 [212.81], Avg: 600.0085 (0.020)
Ep: 490, Reward: 813.8164, Test: 737.5667 [174.10], Avg: 599.9340 (0.020)
Ep: 491, Reward: 724.6206, Test: 720.9212 [160.82], Avg: 599.8531 (0.020)
Ep: 492, Reward: 731.7893, Test: 701.4930 [183.83], Avg: 599.6864 (0.020)
Ep: 493, Reward: 803.8065, Test: 739.2519 [171.63], Avg: 599.6215 (0.020)
Ep: 494, Reward: 846.3918, Test: 702.8949 [140.73], Avg: 599.5458 (0.020)
Ep: 495, Reward: 853.2366, Test: 767.0159 [218.33], Avg: 599.4432 (0.020)
Ep: 496, Reward: 963.3910, Test: 791.5558 [127.03], Avg: 599.5742 (0.020)
Ep: 497, Reward: 827.4975, Test: 895.0400 [34.06], Avg: 600.0991 (0.020)
Ep: 498, Reward: 915.7761, Test: 877.0611 [61.04], Avg: 600.5318 (0.020)
Ep: 499, Reward: 928.9828, Test: 856.6766 [39.15], Avg: 600.9658 (0.020)
