Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -53.0680, Test: -50.0196 [15.17], Avg: -65.1890 (0.980)
Ep: 1, Reward: -56.1965, Test: -57.9772 [17.64], Avg: -70.4028 (0.960)
Ep: 2, Reward: -58.1129, Test: -55.6730 [22.90], Avg: -73.1271 (0.941)
Ep: 3, Reward: -56.8149, Test: -56.0477 [18.11], Avg: -73.3858 (0.922)
Ep: 4, Reward: -55.6509, Test: -57.5061 [22.44], Avg: -74.6981 (0.904)
Ep: 5, Reward: -53.7531, Test: -71.1900 [38.80], Avg: -80.5794 (0.886)
Ep: 6, Reward: -52.8437, Test: -58.0933 [11.57], Avg: -79.0194 (0.868)
Ep: 7, Reward: -55.1937, Test: -52.5380 [26.72], Avg: -79.0495 (0.851)
Ep: 8, Reward: -49.7700, Test: -53.0688 [19.13], Avg: -78.2883 (0.834)
Ep: 9, Reward: -51.9002, Test: -50.5469 [26.22], Avg: -78.1364 (0.817)
Ep: 10, Reward: -50.3185, Test: -43.3406 [18.18], Avg: -76.6262 (0.801)
Ep: 11, Reward: -64.1786, Test: -44.9716 [22.20], Avg: -75.8379 (0.785)
Ep: 12, Reward: -33.0931, Test: -47.6490 [34.04], Avg: -76.2883 (0.769)
Ep: 13, Reward: -39.4021, Test: -50.9848 [20.27], Avg: -75.9287 (0.754)
Ep: 14, Reward: -30.3731, Test: -53.3908 [25.32], Avg: -76.1142 (0.739)
Ep: 15, Reward: -46.5919, Test: -38.7800 [30.23], Avg: -75.6703 (0.724)
Ep: 16, Reward: -59.4539, Test: -61.3178 [14.95], Avg: -75.7057 (0.709)
Ep: 17, Reward: -43.8115, Test: -39.4089 [26.23], Avg: -75.1466 (0.695)
Ep: 18, Reward: -51.8479, Test: -41.5819 [23.83], Avg: -74.6342 (0.681)
Ep: 19, Reward: -32.8391, Test: -59.6168 [17.51], Avg: -74.7589 (0.668)
Ep: 20, Reward: -23.5807, Test: -57.5473 [41.06], Avg: -75.8944 (0.654)
Ep: 21, Reward: -46.1856, Test: -29.6000 [36.42], Avg: -75.4454 (0.641)
Ep: 22, Reward: -48.4903, Test: -47.4782 [49.68], Avg: -76.3896 (0.628)
Ep: 23, Reward: -36.3907, Test: -59.6069 [30.92], Avg: -76.9788 (0.616)
Ep: 24, Reward: -20.1315, Test: -40.3951 [24.71], Avg: -76.5038 (0.603)
Ep: 25, Reward: -29.8785, Test: -36.1230 [51.46], Avg: -76.9298 (0.591)
Ep: 26, Reward: -27.4672, Test: -16.3051 [30.82], Avg: -75.8257 (0.580)
Ep: 27, Reward: -43.8311, Test: -28.8795 [63.40], Avg: -76.4133 (0.568)
Ep: 28, Reward: -30.7641, Test: -30.4448 [14.28], Avg: -75.3204 (0.557)
Ep: 29, Reward: -26.0376, Test: -18.3684 [59.02], Avg: -75.3895 (0.545)
Ep: 30, Reward: -21.9759, Test: 8.3004 [63.30], Avg: -74.7318 (0.535)
Ep: 31, Reward: -25.3614, Test: -27.6006 [51.27], Avg: -74.8612 (0.524)
Ep: 32, Reward: 13.5097, Test: 4.5486 [31.19], Avg: -73.4000 (0.513)
Ep: 33, Reward: 6.7326, Test: 16.5775 [59.67], Avg: -72.5087 (0.503)
Ep: 34, Reward: 10.1457, Test: 13.4232 [75.17], Avg: -72.2012 (0.493)
Ep: 35, Reward: 26.1900, Test: 20.6427 [76.60], Avg: -71.7499 (0.483)
Ep: 36, Reward: -0.1756, Test: -5.2071 [39.82], Avg: -71.0276 (0.474)
Ep: 37, Reward: 68.0705, Test: 8.5702 [63.51], Avg: -70.6042 (0.464)
Ep: 38, Reward: 37.7573, Test: 39.5381 [84.73], Avg: -69.9525 (0.455)
Ep: 39, Reward: 55.2949, Test: 39.5403 [69.45], Avg: -68.9513 (0.446)
Ep: 40, Reward: 65.6453, Test: 39.5951 [96.77], Avg: -68.6640 (0.437)
Ep: 41, Reward: 38.7741, Test: 9.7786 [69.29], Avg: -68.4461 (0.428)
Ep: 42, Reward: 49.9675, Test: 20.7498 [71.58], Avg: -68.0365 (0.419)
Ep: 43, Reward: 15.9917, Test: 64.0942 [89.62], Avg: -67.0703 (0.411)
Ep: 44, Reward: 20.1217, Test: 35.3726 [84.70], Avg: -66.6760 (0.403)
Ep: 45, Reward: 57.3050, Test: 83.5520 [90.22], Avg: -65.3715 (0.395)
Ep: 46, Reward: 56.2669, Test: 56.0956 [114.88], Avg: -65.2313 (0.387)
Ep: 47, Reward: 38.1309, Test: 23.1726 [74.68], Avg: -64.9454 (0.379)
Ep: 48, Reward: 108.2049, Test: 106.0934 [130.77], Avg: -64.1236 (0.372)
Ep: 49, Reward: 79.1880, Test: 85.7162 [100.51], Avg: -63.1370 (0.364)
Ep: 50, Reward: 81.7121, Test: 88.9365 [155.23], Avg: -63.1989 (0.357)
Ep: 51, Reward: 43.1238, Test: 77.3025 [116.26], Avg: -62.7327 (0.350)
Ep: 52, Reward: 174.3426, Test: 157.8060 [93.40], Avg: -60.3338 (0.343)
Ep: 53, Reward: 101.1139, Test: 183.7409 [114.27], Avg: -57.9301 (0.336)
Ep: 54, Reward: 97.4624, Test: 99.7093 [92.86], Avg: -56.7524 (0.329)
Ep: 55, Reward: 121.9918, Test: 159.9188 [189.74], Avg: -56.2715 (0.323)
Ep: 56, Reward: 157.4131, Test: 115.0633 [116.54], Avg: -55.3103 (0.316)
Ep: 57, Reward: 136.2903, Test: 152.4628 [213.97], Avg: -55.4171 (0.310)
Ep: 58, Reward: 110.7975, Test: 197.3425 [159.83], Avg: -53.8420 (0.304)
Ep: 59, Reward: 132.2126, Test: 112.4390 [148.65], Avg: -53.5481 (0.298)
Ep: 60, Reward: 112.3935, Test: 159.0930 [133.97], Avg: -52.2584 (0.292)
Ep: 61, Reward: 209.2514, Test: 125.9589 [131.39], Avg: -51.5031 (0.286)
Ep: 62, Reward: 179.5435, Test: 145.1695 [113.10], Avg: -50.1765 (0.280)
Ep: 63, Reward: 190.1018, Test: 138.6999 [85.27], Avg: -48.5576 (0.274)
Ep: 64, Reward: 271.0038, Test: 208.3056 [132.88], Avg: -46.6502 (0.269)
Ep: 65, Reward: 232.2938, Test: 239.4771 [175.99], Avg: -44.9814 (0.264)
Ep: 66, Reward: 242.5279, Test: 342.4148 [187.89], Avg: -42.0037 (0.258)
Ep: 67, Reward: 364.8917, Test: 414.4562 [191.13], Avg: -38.1018 (0.253)
Ep: 68, Reward: 255.1860, Test: 247.1863 [190.83], Avg: -36.7328 (0.248)
Ep: 69, Reward: 270.4012, Test: 323.0364 [177.65], Avg: -34.1311 (0.243)
Ep: 70, Reward: 289.1920, Test: 302.7412 [217.41], Avg: -32.4485 (0.238)
Ep: 71, Reward: 213.3603, Test: 324.5704 [169.29], Avg: -29.8411 (0.233)
Ep: 72, Reward: 300.8642, Test: 309.3270 [130.80], Avg: -26.9868 (0.229)
Ep: 73, Reward: 288.1302, Test: 386.5261 [237.12], Avg: -24.6030 (0.224)
Ep: 74, Reward: 292.4150, Test: 235.1653 [214.01], Avg: -23.9929 (0.220)
Ep: 75, Reward: 359.3271, Test: 321.6386 [188.21], Avg: -21.9215 (0.215)
Ep: 76, Reward: 432.3544, Test: 376.3274 [189.81], Avg: -19.2145 (0.211)
Ep: 77, Reward: 407.4350, Test: 372.5950 [134.97], Avg: -15.9218 (0.207)
Ep: 78, Reward: 409.6320, Test: 476.0183 [135.02], Avg: -11.4038 (0.203)
Ep: 79, Reward: 405.3663, Test: 471.1838 [218.74], Avg: -8.1058 (0.199)
Ep: 80, Reward: 447.1204, Test: 526.8371 [141.03], Avg: -3.2427 (0.195)
Ep: 81, Reward: 504.1110, Test: 484.0150 [138.18], Avg: 1.0143 (0.191)
Ep: 82, Reward: 528.7843, Test: 644.9862 [136.70], Avg: 7.1260 (0.187)
Ep: 83, Reward: 626.4659, Test: 497.3914 [241.30], Avg: 10.0899 (0.183)
Ep: 84, Reward: 515.1127, Test: 544.8664 [102.60], Avg: 15.1744 (0.180)
Ep: 85, Reward: 567.7245, Test: 579.8383 [129.33], Avg: 20.2364 (0.176)
Ep: 86, Reward: 543.9356, Test: 585.8627 [165.67], Avg: 24.8336 (0.172)
Ep: 87, Reward: 603.8237, Test: 679.6253 [111.76], Avg: 31.0044 (0.169)
Ep: 88, Reward: 604.2490, Test: 493.7013 [202.00], Avg: 33.9335 (0.166)
Ep: 89, Reward: 614.3309, Test: 437.1950 [224.53], Avg: 35.9194 (0.162)
Ep: 90, Reward: 691.6908, Test: 619.2827 [120.09], Avg: 41.0103 (0.159)
Ep: 91, Reward: 522.5436, Test: 422.6339 [150.47], Avg: 43.5228 (0.156)
Ep: 92, Reward: 612.8594, Test: 674.3814 [146.49], Avg: 48.7310 (0.153)
Ep: 93, Reward: 559.0477, Test: 609.8324 [182.52], Avg: 52.7585 (0.150)
Ep: 94, Reward: 604.7880, Test: 594.4791 [211.53], Avg: 56.2342 (0.147)
Ep: 95, Reward: 561.2820, Test: 492.3287 [115.77], Avg: 59.5709 (0.144)
Ep: 96, Reward: 617.4267, Test: 648.3899 [156.43], Avg: 64.0285 (0.141)
Ep: 97, Reward: 625.1800, Test: 522.6716 [200.83], Avg: 66.6593 (0.138)
Ep: 98, Reward: 632.6794, Test: 695.1145 [81.01], Avg: 72.1890 (0.135)
Ep: 99, Reward: 590.9820, Test: 669.5344 [108.53], Avg: 77.0771 (0.133)
Ep: 100, Reward: 647.0383, Test: 556.8241 [184.54], Avg: 80.0000 (0.130)
Ep: 101, Reward: 690.2940, Test: 699.9211 [163.42], Avg: 84.4755 (0.127)
Ep: 102, Reward: 712.3526, Test: 695.5475 [161.71], Avg: 88.8382 (0.125)
Ep: 103, Reward: 603.8261, Test: 630.2761 [200.27], Avg: 92.1187 (0.122)
Ep: 104, Reward: 603.1429, Test: 548.6989 [202.64], Avg: 94.5372 (0.120)
Ep: 105, Reward: 580.8740, Test: 586.3065 [149.79], Avg: 97.7634 (0.117)
Ep: 106, Reward: 666.9748, Test: 648.4071 [190.57], Avg: 101.1285 (0.115)
Ep: 107, Reward: 619.3010, Test: 745.0331 [67.69], Avg: 106.4638 (0.113)
Ep: 108, Reward: 686.3825, Test: 675.2346 [190.74], Avg: 109.9320 (0.111)
Ep: 109, Reward: 689.9641, Test: 691.2123 [136.80], Avg: 113.9727 (0.108)
Ep: 110, Reward: 601.3907, Test: 619.0906 [179.67], Avg: 116.9047 (0.106)
Ep: 111, Reward: 761.5384, Test: 648.2406 [165.85], Avg: 120.1680 (0.104)
Ep: 112, Reward: 665.1735, Test: 732.8759 [101.82], Avg: 124.6891 (0.102)
Ep: 113, Reward: 785.8047, Test: 666.6120 [191.66], Avg: 127.7616 (0.100)
Ep: 114, Reward: 650.5753, Test: 785.1062 [94.18], Avg: 132.6587 (0.098)
Ep: 115, Reward: 763.6023, Test: 855.1019 [23.99], Avg: 138.6799 (0.096)
Ep: 116, Reward: 780.5575, Test: 817.7166 [45.47], Avg: 144.0950 (0.094)
Ep: 117, Reward: 798.7774, Test: 771.2404 [87.55], Avg: 148.6678 (0.092)
Ep: 118, Reward: 797.4932, Test: 752.2702 [109.00], Avg: 152.8241 (0.090)
Ep: 119, Reward: 775.4567, Test: 730.3176 [111.19], Avg: 156.7100 (0.089)
Ep: 120, Reward: 779.8465, Test: 808.5236 [102.03], Avg: 161.2537 (0.087)
Ep: 121, Reward: 836.9830, Test: 816.2540 [97.53], Avg: 165.8232 (0.085)
Ep: 122, Reward: 876.0886, Test: 866.0434 [24.18], Avg: 171.3194 (0.083)
Ep: 123, Reward: 855.6255, Test: 835.8314 [48.02], Avg: 176.2912 (0.082)
Ep: 124, Reward: 856.0302, Test: 841.5250 [23.81], Avg: 181.4226 (0.080)
Ep: 125, Reward: 827.0603, Test: 812.7832 [126.41], Avg: 185.4301 (0.078)
Ep: 126, Reward: 831.5639, Test: 847.0574 [15.28], Avg: 190.5194 (0.077)
Ep: 127, Reward: 837.3376, Test: 826.1696 [51.51], Avg: 195.0830 (0.075)
Ep: 128, Reward: 839.4441, Test: 850.0805 [31.76], Avg: 199.9143 (0.074)
Ep: 129, Reward: 865.9301, Test: 858.4252 [31.64], Avg: 204.7364 (0.072)
Ep: 130, Reward: 888.6414, Test: 835.3544 [110.03], Avg: 208.7103 (0.071)
Ep: 131, Reward: 836.8840, Test: 866.3169 [13.66], Avg: 213.5887 (0.069)
Ep: 132, Reward: 822.8765, Test: 862.2286 [29.92], Avg: 218.2407 (0.068)
Ep: 133, Reward: 869.9969, Test: 856.9309 [62.36], Avg: 222.5417 (0.067)
Ep: 134, Reward: 880.8113, Test: 845.3904 [57.88], Avg: 226.7267 (0.065)
Ep: 135, Reward: 854.1681, Test: 820.9532 [81.47], Avg: 230.4970 (0.064)
Ep: 136, Reward: 856.7297, Test: 851.9024 [29.65], Avg: 234.8163 (0.063)
Ep: 137, Reward: 934.0847, Test: 862.7969 [49.27], Avg: 239.0099 (0.062)
Ep: 138, Reward: 866.2701, Test: 793.7657 [118.13], Avg: 242.1511 (0.060)
Ep: 139, Reward: 918.7578, Test: 856.4917 [22.28], Avg: 246.3801 (0.059)
Ep: 140, Reward: 951.3060, Test: 862.6704 [38.53], Avg: 250.4777 (0.058)
Ep: 141, Reward: 898.0150, Test: 842.9261 [54.57], Avg: 254.2656 (0.057)
Ep: 142, Reward: 945.5166, Test: 879.6987 [30.54], Avg: 258.4257 (0.056)
Ep: 143, Reward: 893.7684, Test: 876.7979 [18.54], Avg: 262.5912 (0.055)
Ep: 144, Reward: 957.4735, Test: 864.9700 [36.00], Avg: 266.4973 (0.053)
Ep: 145, Reward: 1016.4247, Test: 881.6329 [62.72], Avg: 270.2810 (0.052)
Ep: 146, Reward: 956.0836, Test: 905.5717 [24.00], Avg: 274.4394 (0.051)
Ep: 147, Reward: 879.4132, Test: 878.4066 [15.21], Avg: 278.4174 (0.050)
Ep: 148, Reward: 880.0463, Test: 849.2150 [21.86], Avg: 282.1016 (0.049)
Ep: 149, Reward: 912.1031, Test: 891.1664 [20.13], Avg: 286.0278 (0.048)
Ep: 150, Reward: 873.1693, Test: 859.3896 [61.69], Avg: 289.4164 (0.047)
Ep: 151, Reward: 944.8571, Test: 844.5098 [53.28], Avg: 292.7178 (0.046)
Ep: 152, Reward: 871.1522, Test: 858.6858 [71.26], Avg: 295.9512 (0.045)
Ep: 153, Reward: 882.3120, Test: 880.5576 [33.81], Avg: 299.5278 (0.045)
Ep: 154, Reward: 828.1738, Test: 817.9373 [84.56], Avg: 302.3268 (0.044)
Ep: 155, Reward: 793.8413, Test: 813.5323 [144.54], Avg: 304.6772 (0.043)
Ep: 156, Reward: 928.0333, Test: 855.8143 [102.71], Avg: 307.5335 (0.042)
Ep: 157, Reward: 911.3885, Test: 868.1455 [28.06], Avg: 310.9040 (0.041)
Ep: 158, Reward: 930.5859, Test: 895.9724 [30.15], Avg: 314.3941 (0.040)
Ep: 159, Reward: 827.5705, Test: 886.2552 [34.23], Avg: 317.7543 (0.039)
Ep: 160, Reward: 888.6259, Test: 866.7807 [29.35], Avg: 320.9821 (0.039)
Ep: 161, Reward: 906.2234, Test: 826.0813 [115.00], Avg: 323.3902 (0.038)
Ep: 162, Reward: 843.9610, Test: 855.8424 [77.77], Avg: 326.1796 (0.037)
Ep: 163, Reward: 793.8162, Test: 771.7220 [152.51], Avg: 327.9664 (0.036)
Ep: 164, Reward: 818.7823, Test: 842.9589 [69.21], Avg: 330.6681 (0.036)
Ep: 165, Reward: 817.1749, Test: 819.1811 [101.53], Avg: 332.9994 (0.035)
Ep: 166, Reward: 849.9003, Test: 861.6512 [38.22], Avg: 335.9361 (0.034)
Ep: 167, Reward: 845.3677, Test: 824.1559 [81.80], Avg: 338.3552 (0.034)
Ep: 168, Reward: 851.8782, Test: 897.7916 [30.68], Avg: 341.4840 (0.033)
Ep: 169, Reward: 894.8599, Test: 866.0259 [31.14], Avg: 344.3863 (0.032)
Ep: 170, Reward: 952.2987, Test: 878.4717 [30.86], Avg: 347.3291 (0.032)
Ep: 171, Reward: 972.9970, Test: 894.4264 [22.59], Avg: 350.3786 (0.031)
Ep: 172, Reward: 957.7311, Test: 850.9006 [146.46], Avg: 352.4252 (0.030)
Ep: 173, Reward: 971.7704, Test: 891.5215 [19.75], Avg: 355.4099 (0.030)
Ep: 174, Reward: 945.6420, Test: 901.7898 [25.09], Avg: 358.3887 (0.029)
Ep: 175, Reward: 1033.7134, Test: 833.4224 [160.09], Avg: 360.1782 (0.029)
Ep: 176, Reward: 1009.4216, Test: 890.7059 [31.46], Avg: 362.9977 (0.028)
Ep: 177, Reward: 960.0462, Test: 837.4307 [125.18], Avg: 364.9598 (0.027)
Ep: 178, Reward: 970.4126, Test: 889.9056 [23.08], Avg: 367.7636 (0.027)
Ep: 179, Reward: 1024.1668, Test: 907.6667 [18.44], Avg: 370.6606 (0.026)
Ep: 180, Reward: 960.5946, Test: 891.4450 [22.85], Avg: 373.4116 (0.026)
Ep: 181, Reward: 981.2840, Test: 883.9213 [11.59], Avg: 376.1529 (0.025)
Ep: 182, Reward: 906.1803, Test: 874.0674 [58.55], Avg: 378.5538 (0.025)
Ep: 183, Reward: 1010.3900, Test: 881.3737 [14.72], Avg: 381.2065 (0.024)
Ep: 184, Reward: 1058.9906, Test: 823.8608 [127.56], Avg: 382.9097 (0.024)
Ep: 185, Reward: 891.9705, Test: 882.8408 [65.24], Avg: 385.2467 (0.023)
Ep: 186, Reward: 919.8711, Test: 900.6137 [23.37], Avg: 387.8777 (0.023)
Ep: 187, Reward: 937.2975, Test: 881.2786 [30.88], Avg: 390.3379 (0.022)
Ep: 188, Reward: 1018.3074, Test: 784.5210 [147.67], Avg: 391.6422 (0.022)
Ep: 189, Reward: 977.4792, Test: 886.7899 [21.42], Avg: 394.1356 (0.022)
Ep: 190, Reward: 942.5078, Test: 854.0698 [95.72], Avg: 396.0424 (0.021)
Ep: 191, Reward: 923.5640, Test: 861.4450 [92.21], Avg: 397.9861 (0.021)
Ep: 192, Reward: 867.9657, Test: 789.6302 [129.90], Avg: 399.3423 (0.020)
Ep: 193, Reward: 794.5136, Test: 823.1965 [114.63], Avg: 400.9362 (0.020)
Ep: 194, Reward: 853.9964, Test: 884.5172 [32.70], Avg: 403.2484 (0.020)
Ep: 195, Reward: 950.5230, Test: 851.6645 [46.62], Avg: 405.2984 (0.020)
Ep: 196, Reward: 976.9478, Test: 871.2587 [28.46], Avg: 407.5192 (0.020)
Ep: 197, Reward: 992.1634, Test: 818.9193 [147.56], Avg: 408.8517 (0.020)
Ep: 198, Reward: 934.6426, Test: 832.9876 [111.47], Avg: 410.4229 (0.020)
Ep: 199, Reward: 958.0860, Test: 878.8248 [27.89], Avg: 412.6255 (0.020)
Ep: 200, Reward: 872.2170, Test: 893.3932 [28.33], Avg: 414.8764 (0.020)
Ep: 201, Reward: 880.9639, Test: 764.9428 [136.28], Avg: 415.9347 (0.020)
Ep: 202, Reward: 828.6655, Test: 786.3953 [122.70], Avg: 417.1552 (0.020)
Ep: 203, Reward: 779.8360, Test: 853.9301 [128.93], Avg: 418.6642 (0.020)
Ep: 204, Reward: 921.6309, Test: 740.7625 [200.50], Avg: 419.2574 (0.020)
Ep: 205, Reward: 796.8069, Test: 810.4730 [117.08], Avg: 420.5882 (0.020)
Ep: 206, Reward: 799.0600, Test: 814.0540 [42.08], Avg: 422.2857 (0.020)
Ep: 207, Reward: 834.0011, Test: 722.0904 [194.75], Avg: 422.7908 (0.020)
Ep: 208, Reward: 734.5500, Test: 791.0923 [97.55], Avg: 424.0862 (0.020)
Ep: 209, Reward: 804.6039, Test: 801.2512 [169.84], Avg: 425.0735 (0.020)
Ep: 210, Reward: 773.7700, Test: 866.5079 [34.29], Avg: 427.0031 (0.020)
Ep: 211, Reward: 899.6294, Test: 879.1785 [27.04], Avg: 429.0084 (0.020)
Ep: 212, Reward: 883.3561, Test: 891.6121 [22.36], Avg: 431.0753 (0.020)
Ep: 213, Reward: 910.1006, Test: 866.9383 [37.85], Avg: 432.9352 (0.020)
Ep: 214, Reward: 983.0837, Test: 858.0120 [59.26], Avg: 434.6367 (0.020)
Ep: 215, Reward: 1007.7391, Test: 868.4916 [91.50], Avg: 436.2216 (0.020)
Ep: 216, Reward: 976.1867, Test: 907.3015 [16.72], Avg: 438.3155 (0.020)
Ep: 217, Reward: 924.9377, Test: 814.4277 [163.51], Avg: 439.2907 (0.020)
Ep: 218, Reward: 932.5950, Test: 895.0265 [16.39], Avg: 441.2968 (0.020)
Ep: 219, Reward: 948.3491, Test: 881.0900 [13.03], Avg: 443.2366 (0.020)
Ep: 220, Reward: 916.9245, Test: 881.6473 [14.79], Avg: 445.1535 (0.020)
Ep: 221, Reward: 878.2221, Test: 877.7591 [22.10], Avg: 447.0026 (0.020)
Ep: 222, Reward: 929.5767, Test: 874.2391 [10.98], Avg: 448.8692 (0.020)
Ep: 223, Reward: 865.5768, Test: 882.8471 [26.52], Avg: 450.6883 (0.020)
Ep: 224, Reward: 943.6937, Test: 856.6365 [28.30], Avg: 452.3667 (0.020)
Ep: 225, Reward: 994.5078, Test: 871.5385 [62.45], Avg: 453.9451 (0.020)
Ep: 226, Reward: 940.5932, Test: 878.1139 [18.51], Avg: 455.7322 (0.020)
Ep: 227, Reward: 892.7562, Test: 871.3840 [17.82], Avg: 457.4770 (0.020)
Ep: 228, Reward: 867.8035, Test: 872.9447 [20.46], Avg: 459.2020 (0.020)
Ep: 229, Reward: 878.5372, Test: 885.8125 [10.86], Avg: 461.0096 (0.020)
Ep: 230, Reward: 902.8337, Test: 895.8761 [11.51], Avg: 462.8423 (0.020)
Ep: 231, Reward: 900.8246, Test: 891.6625 [25.39], Avg: 464.5812 (0.020)
Ep: 232, Reward: 899.5482, Test: 876.1037 [48.63], Avg: 466.1387 (0.020)
Ep: 233, Reward: 971.3498, Test: 898.9748 [12.66], Avg: 467.9343 (0.020)
Ep: 234, Reward: 873.0682, Test: 870.9317 [23.49], Avg: 469.5493 (0.020)
Ep: 235, Reward: 879.4929, Test: 872.2667 [18.59], Avg: 471.1769 (0.020)
Ep: 236, Reward: 875.9991, Test: 822.5586 [141.31], Avg: 472.0633 (0.020)
Ep: 237, Reward: 924.5710, Test: 901.0937 [16.33], Avg: 473.7973 (0.020)
Ep: 238, Reward: 927.7482, Test: 889.7171 [16.37], Avg: 475.4691 (0.020)
Ep: 239, Reward: 987.2832, Test: 904.6463 [25.61], Avg: 477.1506 (0.020)
Ep: 240, Reward: 951.4006, Test: 909.4249 [18.31], Avg: 478.8683 (0.020)
Ep: 241, Reward: 993.7191, Test: 898.4628 [22.82], Avg: 480.5079 (0.020)
Ep: 242, Reward: 980.8305, Test: 895.2282 [17.52], Avg: 482.1425 (0.020)
Ep: 243, Reward: 987.3886, Test: 811.6624 [176.77], Avg: 482.7685 (0.020)
Ep: 244, Reward: 994.5494, Test: 859.6022 [126.88], Avg: 483.7887 (0.020)
Ep: 245, Reward: 1019.3680, Test: 887.0612 [23.60], Avg: 485.3321 (0.020)
Ep: 246, Reward: 774.0844, Test: 810.3155 [156.03], Avg: 486.0161 (0.020)
Ep: 247, Reward: 849.0645, Test: 893.9162 [26.94], Avg: 487.5522 (0.020)
Ep: 248, Reward: 989.0011, Test: 822.4152 [179.14], Avg: 488.1776 (0.020)
Ep: 249, Reward: 981.3314, Test: 900.5961 [30.59], Avg: 489.7049 (0.020)
Ep: 250, Reward: 946.9640, Test: 862.1744 [62.88], Avg: 490.9383 (0.020)
Ep: 251, Reward: 900.0199, Test: 847.3425 [23.48], Avg: 492.2595 (0.020)
Ep: 252, Reward: 822.8801, Test: 861.1449 [20.86], Avg: 493.6351 (0.020)
Ep: 253, Reward: 893.3836, Test: 881.3896 [63.20], Avg: 494.9129 (0.020)
Ep: 254, Reward: 911.6132, Test: 901.3518 [13.71], Avg: 496.4530 (0.020)
Ep: 255, Reward: 949.2358, Test: 882.7130 [11.46], Avg: 497.9171 (0.020)
Ep: 256, Reward: 903.7589, Test: 892.7703 [18.12], Avg: 499.3829 (0.020)
Ep: 257, Reward: 983.8632, Test: 878.2852 [11.80], Avg: 500.8058 (0.020)
Ep: 258, Reward: 931.4327, Test: 895.5569 [33.41], Avg: 502.2010 (0.020)
Ep: 259, Reward: 964.6500, Test: 850.4009 [115.68], Avg: 503.0953 (0.020)
Ep: 260, Reward: 929.1681, Test: 856.5053 [54.80], Avg: 504.2394 (0.020)
Ep: 261, Reward: 869.4459, Test: 750.4571 [261.29], Avg: 504.1818 (0.020)
Ep: 262, Reward: 876.2257, Test: 827.6904 [108.48], Avg: 504.9995 (0.020)
Ep: 263, Reward: 831.3214, Test: 849.5685 [106.61], Avg: 505.9008 (0.020)
Ep: 264, Reward: 871.2911, Test: 795.5123 [183.62], Avg: 506.3008 (0.020)
Ep: 265, Reward: 864.8767, Test: 883.1838 [63.90], Avg: 507.4774 (0.020)
Ep: 266, Reward: 910.2246, Test: 773.5081 [243.83], Avg: 507.5605 (0.020)
Ep: 267, Reward: 803.8802, Test: 737.8021 [173.24], Avg: 507.7732 (0.020)
Ep: 268, Reward: 719.9736, Test: 628.0891 [223.49], Avg: 507.3897 (0.020)
Ep: 269, Reward: 810.4579, Test: 861.0647 [152.11], Avg: 508.1362 (0.020)
Ep: 270, Reward: 944.0291, Test: 884.8372 [16.55], Avg: 509.4651 (0.020)
Ep: 271, Reward: 815.7299, Test: 870.7539 [22.16], Avg: 510.7119 (0.020)
Ep: 272, Reward: 797.9865, Test: 880.3503 [74.23], Avg: 511.7940 (0.020)
Ep: 273, Reward: 901.1573, Test: 875.7457 [12.82], Avg: 513.0756 (0.020)
Ep: 274, Reward: 759.5981, Test: 817.0563 [61.37], Avg: 513.9578 (0.020)
Ep: 275, Reward: 880.0197, Test: 811.1730 [177.19], Avg: 514.3927 (0.020)
Ep: 276, Reward: 865.1893, Test: 886.9718 [40.19], Avg: 515.5926 (0.020)
Ep: 277, Reward: 789.2277, Test: 792.6275 [114.64], Avg: 516.1768 (0.020)
Ep: 278, Reward: 793.7844, Test: 842.2385 [39.29], Avg: 517.2046 (0.020)
Ep: 279, Reward: 778.1691, Test: 823.2705 [157.92], Avg: 517.7337 (0.020)
Ep: 280, Reward: 856.9603, Test: 839.7800 [95.18], Avg: 518.5411 (0.020)
Ep: 281, Reward: 838.0948, Test: 876.9930 [20.84], Avg: 519.7383 (0.020)
Ep: 282, Reward: 984.8707, Test: 778.6950 [240.07], Avg: 519.8050 (0.020)
Ep: 283, Reward: 829.8159, Test: 859.6614 [29.71], Avg: 520.8971 (0.020)
Ep: 284, Reward: 869.5679, Test: 831.5169 [28.42], Avg: 521.8873 (0.020)
Ep: 285, Reward: 840.3928, Test: 867.5885 [13.42], Avg: 523.0491 (0.020)
Ep: 286, Reward: 868.7491, Test: 861.8576 [36.95], Avg: 524.1008 (0.020)
Ep: 287, Reward: 904.4848, Test: 881.2308 [20.82], Avg: 525.2686 (0.020)
Ep: 288, Reward: 915.1685, Test: 847.4242 [92.85], Avg: 526.0621 (0.020)
Ep: 289, Reward: 904.2417, Test: 863.1937 [18.16], Avg: 527.1620 (0.020)
Ep: 290, Reward: 816.1309, Test: 791.6744 [242.00], Avg: 527.2393 (0.020)
Ep: 291, Reward: 802.1095, Test: 861.6759 [27.18], Avg: 528.2916 (0.020)
Ep: 292, Reward: 837.8603, Test: 823.4010 [103.38], Avg: 528.9460 (0.020)
Ep: 293, Reward: 937.3252, Test: 786.3501 [206.56], Avg: 529.1189 (0.020)
Ep: 294, Reward: 1053.2197, Test: 910.4491 [25.71], Avg: 530.3244 (0.020)
Ep: 295, Reward: 1050.7963, Test: 841.6664 [123.56], Avg: 530.9588 (0.020)
Ep: 296, Reward: 1009.5994, Test: 859.4815 [85.40], Avg: 531.7774 (0.020)
Ep: 297, Reward: 936.6001, Test: 877.7808 [21.81], Avg: 532.8652 (0.020)
Ep: 298, Reward: 896.2504, Test: 863.0090 [58.87], Avg: 533.7725 (0.020)
Ep: 299, Reward: 961.1949, Test: 865.1253 [34.10], Avg: 534.7633 (0.020)
Ep: 300, Reward: 928.0368, Test: 824.0289 [88.12], Avg: 535.4316 (0.020)
Ep: 301, Reward: 819.9091, Test: 814.8051 [101.23], Avg: 536.0215 (0.020)
Ep: 302, Reward: 830.4263, Test: 862.7262 [62.20], Avg: 536.8944 (0.020)
Ep: 303, Reward: 935.0297, Test: 894.2880 [30.49], Avg: 537.9697 (0.020)
Ep: 304, Reward: 912.5519, Test: 902.5210 [18.33], Avg: 539.1049 (0.020)
Ep: 305, Reward: 973.2600, Test: 886.8835 [26.29], Avg: 540.1555 (0.020)
Ep: 306, Reward: 899.8097, Test: 821.5857 [31.45], Avg: 540.9698 (0.020)
Ep: 307, Reward: 820.3848, Test: 857.7854 [23.35], Avg: 541.9226 (0.020)
Ep: 308, Reward: 891.8996, Test: 892.8315 [20.34], Avg: 542.9924 (0.020)
Ep: 309, Reward: 909.7012, Test: 866.0226 [32.01], Avg: 543.9312 (0.020)
Ep: 310, Reward: 902.8543, Test: 892.6360 [45.36], Avg: 544.9066 (0.020)
Ep: 311, Reward: 908.1544, Test: 888.9525 [20.29], Avg: 545.9443 (0.020)
Ep: 312, Reward: 921.2980, Test: 869.1406 [43.35], Avg: 546.8383 (0.020)
Ep: 313, Reward: 871.5555, Test: 873.5959 [36.24], Avg: 547.7635 (0.020)
Ep: 314, Reward: 880.3541, Test: 859.7401 [23.91], Avg: 548.6780 (0.020)
Ep: 315, Reward: 898.0462, Test: 889.4950 [21.25], Avg: 549.6893 (0.020)
Ep: 316, Reward: 916.2718, Test: 842.8970 [61.47], Avg: 550.4203 (0.020)
Ep: 317, Reward: 858.1450, Test: 880.9753 [29.28], Avg: 551.3677 (0.020)
Ep: 318, Reward: 767.0869, Test: 817.2456 [195.68], Avg: 551.5878 (0.020)
Ep: 319, Reward: 671.3054, Test: 719.4724 [210.23], Avg: 551.4555 (0.020)
Ep: 320, Reward: 754.0361, Test: 822.0060 [115.08], Avg: 551.9398 (0.020)
Ep: 321, Reward: 804.4608, Test: 792.8637 [83.67], Avg: 552.4282 (0.020)
Ep: 322, Reward: 802.5207, Test: 766.7446 [194.42], Avg: 552.4898 (0.020)
Ep: 323, Reward: 798.1237, Test: 793.2463 [117.28], Avg: 552.8709 (0.020)
Ep: 324, Reward: 801.6285, Test: 685.7369 [226.58], Avg: 552.5826 (0.020)
Ep: 325, Reward: 730.9101, Test: 807.5350 [162.09], Avg: 552.8674 (0.020)
Ep: 326, Reward: 862.8673, Test: 831.3390 [72.80], Avg: 553.4964 (0.020)
Ep: 327, Reward: 834.6327, Test: 814.7113 [109.15], Avg: 553.9600 (0.020)
Ep: 328, Reward: 807.8283, Test: 763.6638 [220.98], Avg: 553.9257 (0.020)
Ep: 329, Reward: 850.7309, Test: 861.4587 [41.90], Avg: 554.7306 (0.020)
Ep: 330, Reward: 872.6488, Test: 849.8409 [49.19], Avg: 555.4736 (0.020)
Ep: 331, Reward: 791.9307, Test: 862.9022 [32.90], Avg: 556.3005 (0.020)
Ep: 332, Reward: 858.7330, Test: 875.4449 [21.33], Avg: 557.1948 (0.020)
Ep: 333, Reward: 881.2724, Test: 882.5453 [43.71], Avg: 558.0381 (0.020)
Ep: 334, Reward: 860.1501, Test: 846.8233 [102.31], Avg: 558.5947 (0.020)
Ep: 335, Reward: 907.6566, Test: 832.5112 [77.46], Avg: 559.1794 (0.020)
Ep: 336, Reward: 815.8117, Test: 709.8521 [162.98], Avg: 559.1429 (0.020)
Ep: 337, Reward: 830.7933, Test: 822.7938 [51.50], Avg: 559.7706 (0.020)
Ep: 338, Reward: 853.2178, Test: 813.8958 [192.77], Avg: 559.9515 (0.020)
Ep: 339, Reward: 856.2962, Test: 807.6220 [204.95], Avg: 560.0772 (0.020)
Ep: 340, Reward: 941.9177, Test: 858.0848 [50.02], Avg: 560.8044 (0.020)
Ep: 341, Reward: 896.3784, Test: 799.6544 [159.41], Avg: 561.0367 (0.020)
Ep: 342, Reward: 837.2670, Test: 777.3426 [222.93], Avg: 561.0174 (0.020)
Ep: 343, Reward: 855.3489, Test: 769.1184 [173.53], Avg: 561.1179 (0.020)
Ep: 344, Reward: 875.7852, Test: 840.9048 [113.08], Avg: 561.6011 (0.020)
Ep: 345, Reward: 831.8497, Test: 789.1992 [142.43], Avg: 561.8473 (0.020)
Ep: 346, Reward: 851.3824, Test: 832.6989 [39.39], Avg: 562.5143 (0.020)
Ep: 347, Reward: 780.9877, Test: 844.2828 [66.60], Avg: 563.1326 (0.020)
Ep: 348, Reward: 761.0973, Test: 850.0131 [51.70], Avg: 563.8065 (0.020)
Ep: 349, Reward: 826.4197, Test: 841.0678 [53.86], Avg: 564.4447 (0.020)
Ep: 350, Reward: 865.5282, Test: 706.0541 [258.90], Avg: 564.1106 (0.020)
Ep: 351, Reward: 739.2419, Test: 749.3259 [204.23], Avg: 564.0566 (0.020)
Ep: 352, Reward: 741.8361, Test: 720.9740 [174.00], Avg: 564.0082 (0.020)
Ep: 353, Reward: 762.2449, Test: 830.2633 [88.14], Avg: 564.5113 (0.020)
Ep: 354, Reward: 931.1805, Test: 890.5962 [13.88], Avg: 565.3908 (0.020)
Ep: 355, Reward: 926.7671, Test: 822.3951 [86.56], Avg: 565.8695 (0.020)
Ep: 356, Reward: 819.4617, Test: 842.4266 [57.81], Avg: 566.4823 (0.020)
Ep: 357, Reward: 896.7091, Test: 882.9038 [65.67], Avg: 567.1827 (0.020)
Ep: 358, Reward: 899.6079, Test: 886.3296 [13.79], Avg: 568.0333 (0.020)
Ep: 359, Reward: 903.0120, Test: 783.5835 [207.12], Avg: 568.0567 (0.020)
Ep: 360, Reward: 1015.1918, Test: 895.5110 [41.46], Avg: 568.8489 (0.020)
Ep: 361, Reward: 1005.9502, Test: 882.2407 [27.99], Avg: 569.6373 (0.020)
Ep: 362, Reward: 958.8178, Test: 863.8808 [102.30], Avg: 570.1661 (0.020)
Ep: 363, Reward: 982.1579, Test: 823.7442 [181.76], Avg: 570.3634 (0.020)
Ep: 364, Reward: 971.6863, Test: 894.4130 [13.63], Avg: 571.2138 (0.020)
Ep: 365, Reward: 873.2818, Test: 848.3414 [161.02], Avg: 571.5311 (0.020)
Ep: 366, Reward: 896.5357, Test: 883.9489 [38.62], Avg: 572.2771 (0.020)
Ep: 367, Reward: 930.4665, Test: 907.7603 [21.94], Avg: 573.1291 (0.020)
Ep: 368, Reward: 961.8308, Test: 806.6688 [133.83], Avg: 573.3994 (0.020)
Ep: 369, Reward: 965.4886, Test: 882.5703 [47.30], Avg: 574.1071 (0.020)
Ep: 370, Reward: 1021.6939, Test: 896.9247 [25.32], Avg: 574.9090 (0.020)
Ep: 371, Reward: 880.6812, Test: 885.9345 [22.93], Avg: 575.6835 (0.020)
Ep: 372, Reward: 902.4562, Test: 876.6936 [45.99], Avg: 576.3671 (0.020)
Ep: 373, Reward: 781.0306, Test: 874.4231 [18.07], Avg: 577.1158 (0.020)
Ep: 374, Reward: 926.3611, Test: 883.5155 [15.88], Avg: 577.8905 (0.020)
Ep: 375, Reward: 873.4333, Test: 708.0132 [243.76], Avg: 577.5883 (0.020)
Ep: 376, Reward: 887.0028, Test: 815.0186 [123.77], Avg: 577.8897 (0.020)
Ep: 377, Reward: 677.7924, Test: 761.6835 [149.22], Avg: 577.9812 (0.020)
Ep: 378, Reward: 931.4048, Test: 818.2313 [190.42], Avg: 578.1127 (0.020)
Ep: 379, Reward: 760.5530, Test: 799.1704 [222.31], Avg: 578.1094 (0.020)
Ep: 380, Reward: 890.2501, Test: 621.1368 [281.47], Avg: 577.4835 (0.020)
Ep: 381, Reward: 648.7881, Test: 772.1527 [193.53], Avg: 577.4865 (0.020)
Ep: 382, Reward: 843.7471, Test: 844.1669 [88.66], Avg: 577.9513 (0.020)
Ep: 383, Reward: 866.8417, Test: 820.2846 [89.75], Avg: 578.3487 (0.020)
Ep: 384, Reward: 827.0286, Test: 779.7560 [125.19], Avg: 578.5467 (0.020)
Ep: 385, Reward: 829.0238, Test: 850.4606 [99.31], Avg: 578.9938 (0.020)
Ep: 386, Reward: 845.3714, Test: 866.5399 [23.55], Avg: 579.6760 (0.020)
Ep: 387, Reward: 777.7378, Test: 804.1507 [143.02], Avg: 579.8859 (0.020)
Ep: 388, Reward: 749.7501, Test: 802.1107 [53.99], Avg: 580.3184 (0.020)
Ep: 389, Reward: 766.3230, Test: 731.8082 [196.17], Avg: 580.2038 (0.020)
Ep: 390, Reward: 730.9455, Test: 852.9016 [66.27], Avg: 580.7318 (0.020)
Ep: 391, Reward: 693.6014, Test: 806.5928 [148.34], Avg: 580.9295 (0.020)
Ep: 392, Reward: 715.6918, Test: 764.1955 [205.49], Avg: 580.8729 (0.020)
Ep: 393, Reward: 780.6242, Test: 844.1498 [44.40], Avg: 581.4285 (0.020)
Ep: 394, Reward: 866.9163, Test: 826.2023 [66.06], Avg: 581.8809 (0.020)
Ep: 395, Reward: 856.4794, Test: 798.5628 [158.01], Avg: 582.0291 (0.020)
Ep: 396, Reward: 846.5411, Test: 839.0677 [52.82], Avg: 582.5435 (0.020)
Ep: 397, Reward: 870.5931, Test: 817.9980 [91.26], Avg: 582.9058 (0.020)
Ep: 398, Reward: 857.2793, Test: 847.2177 [40.60], Avg: 583.4664 (0.020)
Ep: 399, Reward: 916.6569, Test: 764.7508 [237.82], Avg: 583.3251 (0.020)
Ep: 400, Reward: 760.3148, Test: 784.1407 [190.87], Avg: 583.3499 (0.020)
Ep: 401, Reward: 878.1949, Test: 837.3880 [62.14], Avg: 583.8272 (0.020)
Ep: 402, Reward: 815.1904, Test: 850.5712 [30.63], Avg: 584.4131 (0.020)
Ep: 403, Reward: 830.6878, Test: 801.7786 [157.28], Avg: 584.5619 (0.020)
Ep: 404, Reward: 899.3145, Test: 877.0917 [24.88], Avg: 585.2227 (0.020)
Ep: 405, Reward: 873.4551, Test: 879.8684 [25.07], Avg: 585.8867 (0.020)
Ep: 406, Reward: 896.5165, Test: 890.0170 [26.13], Avg: 586.5698 (0.020)
Ep: 407, Reward: 844.6166, Test: 884.0899 [25.30], Avg: 587.2370 (0.020)
Ep: 408, Reward: 902.9126, Test: 861.6958 [95.83], Avg: 587.6737 (0.020)
Ep: 409, Reward: 899.3289, Test: 887.1480 [25.68], Avg: 588.3415 (0.020)
Ep: 410, Reward: 1012.5029, Test: 793.6242 [203.96], Avg: 588.3447 (0.020)
Ep: 411, Reward: 936.0055, Test: 678.4480 [246.04], Avg: 587.9662 (0.020)
Ep: 412, Reward: 833.2166, Test: 874.4949 [37.69], Avg: 588.5688 (0.020)
Ep: 413, Reward: 839.3781, Test: 795.0855 [169.34], Avg: 588.6586 (0.020)
Ep: 414, Reward: 822.6357, Test: 792.1890 [189.75], Avg: 588.6918 (0.020)
Ep: 415, Reward: 865.7504, Test: 761.4857 [153.62], Avg: 588.7379 (0.020)
Ep: 416, Reward: 809.4893, Test: 670.7887 [244.95], Avg: 588.3472 (0.020)
Ep: 417, Reward: 657.3845, Test: 828.0575 [104.20], Avg: 588.6714 (0.020)
Ep: 418, Reward: 728.7880, Test: 734.2243 [202.96], Avg: 588.5344 (0.020)
Ep: 419, Reward: 807.2047, Test: 831.6582 [76.27], Avg: 588.9317 (0.020)
Ep: 420, Reward: 900.7718, Test: 791.9177 [168.52], Avg: 589.0135 (0.020)
Ep: 421, Reward: 816.3178, Test: 849.8440 [99.90], Avg: 589.3949 (0.020)
Ep: 422, Reward: 862.5423, Test: 625.5969 [243.97], Avg: 588.9037 (0.020)
Ep: 423, Reward: 773.9200, Test: 746.4840 [229.90], Avg: 588.7331 (0.020)
Ep: 424, Reward: 918.6108, Test: 869.2267 [58.69], Avg: 589.2550 (0.020)
Ep: 425, Reward: 836.6531, Test: 826.7839 [146.85], Avg: 589.4679 (0.020)
Ep: 426, Reward: 855.9539, Test: 789.7864 [113.39], Avg: 589.6715 (0.020)
Ep: 427, Reward: 863.3688, Test: 720.1843 [196.65], Avg: 589.5169 (0.020)
Ep: 428, Reward: 821.0167, Test: 888.1761 [26.36], Avg: 590.1517 (0.020)
Ep: 429, Reward: 973.4889, Test: 897.9801 [22.38], Avg: 590.8155 (0.020)
Ep: 430, Reward: 947.5076, Test: 902.3852 [32.11], Avg: 591.4639 (0.020)
Ep: 431, Reward: 1000.2482, Test: 890.5163 [21.82], Avg: 592.1057 (0.020)
Ep: 432, Reward: 948.2892, Test: 892.4309 [32.83], Avg: 592.7234 (0.020)
Ep: 433, Reward: 956.2690, Test: 840.7931 [98.65], Avg: 593.0677 (0.020)
Ep: 434, Reward: 890.6216, Test: 840.5179 [84.19], Avg: 593.4430 (0.020)
Ep: 435, Reward: 908.1746, Test: 812.6185 [148.50], Avg: 593.6051 (0.020)
Ep: 436, Reward: 941.1514, Test: 786.5641 [137.66], Avg: 593.7317 (0.020)
Ep: 437, Reward: 864.8334, Test: 812.9216 [162.44], Avg: 593.8612 (0.020)
Ep: 438, Reward: 974.2055, Test: 860.3473 [110.42], Avg: 594.2167 (0.020)
Ep: 439, Reward: 903.9709, Test: 853.0579 [78.47], Avg: 594.6267 (0.020)
Ep: 440, Reward: 832.0359, Test: 792.1226 [191.15], Avg: 594.6410 (0.020)
Ep: 441, Reward: 936.8216, Test: 905.8612 [28.48], Avg: 595.2807 (0.020)
Ep: 442, Reward: 925.2118, Test: 886.2811 [20.72], Avg: 595.8908 (0.020)
Ep: 443, Reward: 915.5960, Test: 866.7031 [30.79], Avg: 596.4314 (0.020)
Ep: 444, Reward: 925.1106, Test: 866.8473 [6.89], Avg: 597.0236 (0.020)
Ep: 445, Reward: 900.0413, Test: 896.6604 [29.95], Avg: 597.6283 (0.020)
Ep: 446, Reward: 908.9145, Test: 878.1534 [61.48], Avg: 598.1184 (0.020)
Ep: 447, Reward: 835.9716, Test: 795.7691 [88.34], Avg: 598.3624 (0.020)
Ep: 448, Reward: 825.0489, Test: 845.5705 [25.48], Avg: 598.8562 (0.020)
Ep: 449, Reward: 818.1437, Test: 859.9839 [16.65], Avg: 599.3995 (0.020)
Ep: 450, Reward: 820.8668, Test: 831.8784 [49.31], Avg: 599.8056 (0.020)
Ep: 451, Reward: 780.5507, Test: 788.0615 [100.22], Avg: 600.0004 (0.020)
Ep: 452, Reward: 847.5723, Test: 792.6556 [180.27], Avg: 600.0277 (0.020)
Ep: 453, Reward: 837.9331, Test: 711.3662 [185.18], Avg: 599.8651 (0.020)
Ep: 454, Reward: 824.0067, Test: 832.2046 [39.01], Avg: 600.2900 (0.020)
Ep: 455, Reward: 824.9178, Test: 838.1243 [33.38], Avg: 600.7383 (0.020)
Ep: 456, Reward: 822.3447, Test: 838.0564 [31.70], Avg: 601.1883 (0.020)
Ep: 457, Reward: 839.7313, Test: 831.3469 [18.56], Avg: 601.6503 (0.020)
Ep: 458, Reward: 814.0986, Test: 832.8830 [21.65], Avg: 602.1069 (0.020)
Ep: 459, Reward: 836.5170, Test: 839.7018 [27.66], Avg: 602.5633 (0.020)
Ep: 460, Reward: 836.4389, Test: 807.5596 [56.38], Avg: 602.8857 (0.020)
Ep: 461, Reward: 751.7792, Test: 799.3174 [84.82], Avg: 603.1273 (0.020)
Ep: 462, Reward: 815.8415, Test: 817.9301 [25.15], Avg: 603.5369 (0.020)
Ep: 463, Reward: 815.8442, Test: 823.9561 [36.61], Avg: 603.9330 (0.020)
Ep: 464, Reward: 833.1074, Test: 849.6630 [12.58], Avg: 604.4344 (0.020)
Ep: 465, Reward: 834.3417, Test: 857.7929 [14.32], Avg: 604.9474 (0.020)
Ep: 466, Reward: 880.0931, Test: 834.6069 [90.31], Avg: 605.2458 (0.020)
Ep: 467, Reward: 850.9703, Test: 857.0891 [17.93], Avg: 605.7456 (0.020)
Ep: 468, Reward: 857.7956, Test: 861.7273 [30.84], Avg: 606.2256 (0.020)
Ep: 469, Reward: 883.9908, Test: 864.5166 [14.20], Avg: 606.7450 (0.020)
Ep: 470, Reward: 871.4154, Test: 873.0601 [15.17], Avg: 607.2782 (0.020)
Ep: 471, Reward: 915.4552, Test: 862.2243 [20.01], Avg: 607.7759 (0.020)
Ep: 472, Reward: 861.8333, Test: 873.3245 [11.39], Avg: 608.3133 (0.020)
Ep: 473, Reward: 898.6192, Test: 890.1735 [21.61], Avg: 608.8623 (0.020)
Ep: 474, Reward: 882.4112, Test: 875.0674 [12.79], Avg: 609.3958 (0.020)
Ep: 475, Reward: 948.8703, Test: 860.6434 [28.43], Avg: 609.8639 (0.020)
Ep: 476, Reward: 886.2697, Test: 872.3042 [22.50], Avg: 610.3669 (0.020)
Ep: 477, Reward: 917.7179, Test: 880.4662 [11.73], Avg: 610.9075 (0.020)
Ep: 478, Reward: 936.0520, Test: 908.7125 [24.52], Avg: 611.4780 (0.020)
Ep: 479, Reward: 1008.3650, Test: 835.8411 [178.99], Avg: 611.5725 (0.020)
Ep: 480, Reward: 991.0785, Test: 899.5155 [26.20], Avg: 612.1167 (0.020)
Ep: 481, Reward: 914.0268, Test: 869.8124 [80.86], Avg: 612.4836 (0.020)
Ep: 482, Reward: 959.6457, Test: 904.3466 [25.19], Avg: 613.0357 (0.020)
Ep: 483, Reward: 1002.1819, Test: 897.7136 [24.01], Avg: 613.5743 (0.020)
Ep: 484, Reward: 950.3178, Test: 893.7438 [23.10], Avg: 614.1043 (0.020)
Ep: 485, Reward: 893.4363, Test: 891.9262 [21.31], Avg: 614.6321 (0.020)
Ep: 486, Reward: 1001.0788, Test: 901.3226 [23.74], Avg: 615.1721 (0.020)
Ep: 487, Reward: 913.8140, Test: 883.9740 [19.18], Avg: 615.6836 (0.020)
Ep: 488, Reward: 938.9671, Test: 885.0779 [81.26], Avg: 616.0683 (0.020)
Ep: 489, Reward: 1044.5644, Test: 882.2485 [67.56], Avg: 616.4737 (0.020)
Ep: 490, Reward: 1003.9149, Test: 899.0287 [25.03], Avg: 616.9982 (0.020)
Ep: 491, Reward: 974.1225, Test: 884.9411 [25.71], Avg: 617.4905 (0.020)
Ep: 492, Reward: 1031.1892, Test: 863.9152 [83.02], Avg: 617.8220 (0.020)
Ep: 493, Reward: 969.2075, Test: 870.9757 [63.55], Avg: 618.2058 (0.020)
Ep: 494, Reward: 998.4051, Test: 877.6961 [86.32], Avg: 618.5556 (0.020)
Ep: 495, Reward: 970.1404, Test: 890.3718 [52.29], Avg: 618.9982 (0.020)
Ep: 496, Reward: 1015.6348, Test: 906.9096 [21.80], Avg: 619.5336 (0.020)
Ep: 497, Reward: 954.0289, Test: 906.9605 [20.73], Avg: 620.0692 (0.020)
Ep: 498, Reward: 979.2969, Test: 902.7405 [16.74], Avg: 620.6021 (0.020)
Ep: 499, Reward: 901.6900, Test: 921.0833 [18.03], Avg: 621.1670 (0.020)
