Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, NUM_STEPS

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 16        	# How many experience tuples to sample from the buffer for each train step

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(list(zip(states, actions, targets, advantages)), shuffle=True)	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -49.7317, Test: -48.3359 [17.68], Avg: -66.0175 (0.980)
Ep: 1, Reward: -46.9428, Test: -51.6834 [19.04], Avg: -68.3703 (0.960)
Ep: 2, Reward: -53.3314, Test: -59.7306 [19.72], Avg: -72.0654 (0.941)
Ep: 3, Reward: -58.1323, Test: -52.1282 [24.07], Avg: -73.0996 (0.922)
Ep: 4, Reward: -53.5754, Test: -48.9299 [21.07], Avg: -72.4806 (0.904)
Ep: 5, Reward: -55.8584, Test: -60.5281 [35.06], Avg: -76.3325 (0.886)
Ep: 6, Reward: -47.4509, Test: -48.7128 [17.82], Avg: -74.9326 (0.868)
Ep: 7, Reward: -47.2870, Test: -50.8469 [21.76], Avg: -74.6418 (0.851)
Ep: 8, Reward: -45.8936, Test: -71.9450 [35.70], Avg: -78.3089 (0.834)
Ep: 9, Reward: -53.2372, Test: -59.6223 [18.75], Avg: -78.3152 (0.817)
Ep: 10, Reward: -49.7186, Test: -56.6348 [37.51], Avg: -79.7539 (0.801)
Ep: 11, Reward: -44.6466, Test: -54.2053 [33.16], Avg: -80.3880 (0.785)
Ep: 12, Reward: -48.2519, Test: -47.5055 [17.26], Avg: -79.1862 (0.769)
Ep: 13, Reward: -60.3649, Test: -33.0704 [21.61], Avg: -77.4356 (0.754)
Ep: 14, Reward: -45.3937, Test: -37.7144 [33.82], Avg: -77.0421 (0.739)
Ep: 15, Reward: -53.3256, Test: -51.9257 [13.36], Avg: -76.3076 (0.724)
Ep: 16, Reward: -43.3568, Test: -56.6630 [43.36], Avg: -77.7026 (0.709)
Ep: 17, Reward: -46.4195, Test: -53.5796 [41.47], Avg: -78.6664 (0.695)
Ep: 18, Reward: -58.6901, Test: -53.8160 [28.22], Avg: -78.8437 (0.681)
Ep: 19, Reward: -37.3877, Test: -24.1188 [43.31], Avg: -78.2729 (0.668)
Ep: 20, Reward: -38.1436, Test: -33.0545 [37.00], Avg: -77.8817 (0.654)
Ep: 21, Reward: -32.3183, Test: -48.8215 [39.58], Avg: -78.3598 (0.641)
Ep: 22, Reward: -23.4807, Test: -33.3325 [35.21], Avg: -77.9331 (0.628)
Ep: 23, Reward: -43.7680, Test: -50.4663 [17.35], Avg: -77.5115 (0.616)
Ep: 24, Reward: -50.3666, Test: -22.5332 [26.65], Avg: -76.3784 (0.603)
Ep: 25, Reward: -16.8888, Test: -17.7465 [56.93], Avg: -76.3129 (0.591)
Ep: 26, Reward: -26.6257, Test: -17.3284 [38.47], Avg: -75.5532 (0.580)
Ep: 27, Reward: -30.2297, Test: -2.1884 [44.56], Avg: -74.5245 (0.568)
Ep: 28, Reward: -10.9117, Test: -11.5072 [61.45], Avg: -74.4706 (0.557)
Ep: 29, Reward: 2.0336, Test: -6.3060 [54.21], Avg: -74.0053 (0.545)
Ep: 30, Reward: 25.2091, Test: 4.0150 [39.60], Avg: -72.7661 (0.535)
Ep: 31, Reward: -8.7159, Test: 3.8920 [44.85], Avg: -71.7720 (0.524)
Ep: 32, Reward: 7.6994, Test: -17.5057 [57.59], Avg: -71.8726 (0.513)
Ep: 33, Reward: 36.6415, Test: 22.4178 [55.05], Avg: -70.7184 (0.503)
Ep: 34, Reward: 34.1675, Test: 18.6836 [59.91], Avg: -69.8759 (0.493)
Ep: 35, Reward: 23.7492, Test: 7.5493 [68.05], Avg: -69.6155 (0.483)
Ep: 36, Reward: 16.0093, Test: 23.9789 [45.75], Avg: -68.3225 (0.474)
Ep: 37, Reward: 37.1157, Test: 20.7936 [51.69], Avg: -67.3377 (0.464)
Ep: 38, Reward: 33.3923, Test: 45.3307 [94.44], Avg: -66.8703 (0.455)
Ep: 39, Reward: 41.9430, Test: 122.9002 [133.12], Avg: -65.4540 (0.446)
Ep: 40, Reward: 59.3129, Test: 27.2910 [58.40], Avg: -64.6163 (0.437)
Ep: 41, Reward: 44.8791, Test: 0.0725 [75.81], Avg: -64.8812 (0.428)
Ep: 42, Reward: 48.7337, Test: 131.1150 [94.68], Avg: -62.5250 (0.419)
Ep: 43, Reward: 102.4289, Test: 62.0948 [82.93], Avg: -61.5776 (0.411)
Ep: 44, Reward: 46.3394, Test: 49.5942 [89.52], Avg: -61.0965 (0.403)
Ep: 45, Reward: 27.8941, Test: 46.0672 [91.34], Avg: -60.7526 (0.395)
Ep: 46, Reward: 41.0046, Test: 84.0215 [192.37], Avg: -61.7652 (0.387)
Ep: 47, Reward: 67.6867, Test: 112.8182 [150.26], Avg: -61.2584 (0.379)
Ep: 48, Reward: 41.8102, Test: -0.2594 [76.83], Avg: -61.5814 (0.372)
Ep: 49, Reward: 65.8705, Test: 48.4963 [89.99], Avg: -61.1797 (0.364)
Ep: 50, Reward: 70.1009, Test: 73.1956 [122.89], Avg: -60.9545 (0.357)
Ep: 51, Reward: 45.2166, Test: 19.5305 [76.82], Avg: -60.8841 (0.350)
Ep: 52, Reward: 132.7259, Test: 80.1127 [68.22], Avg: -59.5110 (0.343)
Ep: 53, Reward: 109.9562, Test: 38.0770 [66.83], Avg: -58.9414 (0.336)
Ep: 54, Reward: 94.7547, Test: 73.1164 [91.08], Avg: -58.1963 (0.329)
Ep: 55, Reward: 39.2673, Test: 183.5464 [190.19], Avg: -57.2757 (0.323)
Ep: 56, Reward: 155.7815, Test: 75.2360 [103.12], Avg: -56.7601 (0.316)
Ep: 57, Reward: 104.7143, Test: 51.4789 [115.70], Avg: -56.8887 (0.310)
Ep: 58, Reward: 103.5115, Test: 149.4327 [120.10], Avg: -55.4273 (0.304)
Ep: 59, Reward: 193.4419, Test: 73.5319 [113.73], Avg: -55.1735 (0.298)
Ep: 60, Reward: 94.5592, Test: 254.1379 [130.66], Avg: -52.2448 (0.292)
Ep: 61, Reward: 170.4454, Test: 282.8923 [146.05], Avg: -49.1951 (0.286)
Ep: 62, Reward: 298.5157, Test: 307.5423 [181.63], Avg: -46.4156 (0.280)
Ep: 63, Reward: 266.4514, Test: 288.4063 [167.49], Avg: -43.8010 (0.274)
Ep: 64, Reward: 245.1373, Test: 315.9599 [190.32], Avg: -41.1942 (0.269)
Ep: 65, Reward: 249.9007, Test: 375.7742 [208.71], Avg: -38.0387 (0.264)
Ep: 66, Reward: 261.3915, Test: 362.2893 [218.42], Avg: -35.3236 (0.258)
Ep: 67, Reward: 274.9472, Test: 224.1143 [233.46], Avg: -34.9416 (0.253)
Ep: 68, Reward: 334.2968, Test: 341.5256 [195.93], Avg: -32.3251 (0.248)
Ep: 69, Reward: 227.3209, Test: 408.7107 [99.56], Avg: -27.4469 (0.243)
Ep: 70, Reward: 308.8896, Test: 386.7433 [227.46], Avg: -24.8169 (0.238)
Ep: 71, Reward: 369.2335, Test: 325.9321 [206.23], Avg: -22.8097 (0.233)
Ep: 72, Reward: 292.8720, Test: 386.2889 [212.20], Avg: -20.1124 (0.229)
Ep: 73, Reward: 324.2525, Test: 358.8491 [235.21], Avg: -18.1698 (0.224)
Ep: 74, Reward: 328.0869, Test: 426.7826 [192.94], Avg: -14.8096 (0.220)
Ep: 75, Reward: 452.3847, Test: 491.9283 [226.22], Avg: -11.1186 (0.215)
Ep: 76, Reward: 345.2997, Test: 360.6630 [186.28], Avg: -8.7094 (0.211)
Ep: 77, Reward: 356.8832, Test: 375.7142 [148.37], Avg: -5.6831 (0.207)
Ep: 78, Reward: 390.7819, Test: 340.3968 [266.51], Avg: -4.6759 (0.203)
Ep: 79, Reward: 393.3293, Test: 391.9263 [213.23], Avg: -2.3838 (0.199)
Ep: 80, Reward: 326.9536, Test: 405.7906 [192.00], Avg: 0.2850 (0.195)
Ep: 81, Reward: 441.2604, Test: 412.8527 [219.57], Avg: 2.6387 (0.191)
Ep: 82, Reward: 376.6292, Test: 432.5062 [179.46], Avg: 5.6557 (0.187)
Ep: 83, Reward: 404.4403, Test: 397.4157 [251.98], Avg: 7.3197 (0.183)
Ep: 84, Reward: 512.2987, Test: 393.6634 [283.55], Avg: 8.5290 (0.180)
Ep: 85, Reward: 474.3813, Test: 420.2785 [308.99], Avg: 9.7239 (0.176)
Ep: 86, Reward: 433.2185, Test: 321.9491 [233.39], Avg: 10.6301 (0.172)
Ep: 87, Reward: 408.2504, Test: 406.7930 [200.01], Avg: 12.8591 (0.169)
Ep: 88, Reward: 450.4106, Test: 411.9749 [286.04], Avg: 14.1297 (0.166)
Ep: 89, Reward: 514.4601, Test: 507.3020 [216.45], Avg: 17.2044 (0.162)
Ep: 90, Reward: 426.0983, Test: 590.4328 [211.85], Avg: 21.1757 (0.159)
Ep: 91, Reward: 410.7143, Test: 635.2568 [185.33], Avg: 25.8360 (0.156)
Ep: 92, Reward: 560.4066, Test: 522.6655 [244.53], Avg: 28.5490 (0.153)
Ep: 93, Reward: 526.7135, Test: 594.1304 [181.58], Avg: 32.6341 (0.150)
Ep: 94, Reward: 503.3509, Test: 466.8908 [255.26], Avg: 34.5183 (0.147)
Ep: 95, Reward: 504.3824, Test: 486.3782 [228.29], Avg: 36.8471 (0.144)
Ep: 96, Reward: 524.5957, Test: 388.0715 [163.33], Avg: 38.7842 (0.141)
Ep: 97, Reward: 385.0715, Test: 476.3980 [155.10], Avg: 41.6671 (0.138)
Ep: 98, Reward: 405.1276, Test: 370.0745 [175.27], Avg: 43.2139 (0.135)
Ep: 99, Reward: 445.0914, Test: 376.9388 [218.49], Avg: 44.3662 (0.133)
Ep: 100, Reward: 523.0420, Test: 489.2956 [250.43], Avg: 46.2920 (0.130)
Ep: 101, Reward: 504.2775, Test: 510.1559 [134.49], Avg: 49.5211 (0.127)
Ep: 102, Reward: 432.5126, Test: 346.5962 [185.97], Avg: 50.5998 (0.125)
Ep: 103, Reward: 461.1622, Test: 315.0422 [179.27], Avg: 51.4188 (0.122)
Ep: 104, Reward: 609.2758, Test: 515.8106 [238.98], Avg: 53.5656 (0.120)
Ep: 105, Reward: 584.6055, Test: 531.8791 [230.39], Avg: 55.9045 (0.117)
Ep: 106, Reward: 561.0941, Test: 581.4948 [204.90], Avg: 58.9015 (0.115)
Ep: 107, Reward: 606.0003, Test: 575.6139 [182.69], Avg: 61.9943 (0.113)
Ep: 108, Reward: 524.0169, Test: 585.5419 [189.83], Avg: 65.0559 (0.111)
Ep: 109, Reward: 592.7292, Test: 520.2380 [229.23], Avg: 67.1100 (0.108)
Ep: 110, Reward: 586.9354, Test: 534.8128 [249.25], Avg: 69.0781 (0.106)
Ep: 111, Reward: 507.9585, Test: 334.9315 [181.73], Avg: 69.8292 (0.104)
Ep: 112, Reward: 426.1591, Test: 339.2907 [224.39], Avg: 70.2281 (0.102)
Ep: 113, Reward: 375.0615, Test: 388.2368 [165.10], Avg: 71.5694 (0.100)
Ep: 114, Reward: 424.1002, Test: 385.6754 [244.20], Avg: 72.1773 (0.098)
Ep: 115, Reward: 540.8497, Test: 399.1261 [127.47], Avg: 73.8969 (0.096)
Ep: 116, Reward: 540.0293, Test: 549.9054 [186.44], Avg: 76.3718 (0.094)
Ep: 117, Reward: 448.3660, Test: 506.1115 [124.40], Avg: 78.9594 (0.092)
Ep: 118, Reward: 562.9639, Test: 609.4703 [143.65], Avg: 82.2104 (0.090)
Ep: 119, Reward: 612.4366, Test: 729.8612 [121.92], Avg: 86.5914 (0.089)
Ep: 120, Reward: 816.5780, Test: 786.6427 [85.77], Avg: 91.6681 (0.087)
Ep: 121, Reward: 759.0108, Test: 740.2684 [70.26], Avg: 96.4087 (0.085)
Ep: 122, Reward: 755.6994, Test: 818.5819 [69.78], Avg: 101.7126 (0.083)
Ep: 123, Reward: 800.8720, Test: 725.9639 [164.23], Avg: 105.4225 (0.082)
Ep: 124, Reward: 788.7110, Test: 742.6900 [143.49], Avg: 109.3727 (0.080)
Ep: 125, Reward: 784.3182, Test: 739.4029 [169.51], Avg: 113.0276 (0.078)
Ep: 126, Reward: 677.5344, Test: 784.9381 [104.94], Avg: 117.4920 (0.077)
Ep: 127, Reward: 635.1616, Test: 751.2993 [181.14], Avg: 121.0285 (0.075)
Ep: 128, Reward: 742.8550, Test: 640.5977 [185.36], Avg: 123.6193 (0.074)
Ep: 129, Reward: 708.0833, Test: 638.1982 [220.50], Avg: 125.8814 (0.072)
Ep: 130, Reward: 605.4595, Test: 737.9486 [115.05], Avg: 129.6754 (0.071)
Ep: 131, Reward: 713.0915, Test: 754.6681 [125.54], Avg: 133.4591 (0.069)
Ep: 132, Reward: 820.1577, Test: 700.0358 [186.42], Avg: 136.3175 (0.068)
Ep: 133, Reward: 748.0514, Test: 644.3084 [243.29], Avg: 138.2929 (0.067)
Ep: 134, Reward: 802.6066, Test: 866.9453 [38.54], Avg: 143.4049 (0.065)
Ep: 135, Reward: 809.4665, Test: 707.8581 [252.79], Avg: 145.6965 (0.064)
Ep: 136, Reward: 776.5367, Test: 743.6698 [140.02], Avg: 149.0393 (0.063)
Ep: 137, Reward: 702.7491, Test: 781.4122 [110.30], Avg: 152.8224 (0.062)
Ep: 138, Reward: 627.3875, Test: 465.8795 [160.70], Avg: 153.9185 (0.060)
Ep: 139, Reward: 686.4121, Test: 675.5890 [213.45], Avg: 156.1201 (0.059)
Ep: 140, Reward: 740.5309, Test: 626.9604 [229.29], Avg: 157.8332 (0.058)
Ep: 141, Reward: 647.0197, Test: 639.3150 [223.50], Avg: 159.6499 (0.057)
Ep: 142, Reward: 634.6742, Test: 753.6826 [130.42], Avg: 162.8920 (0.056)
Ep: 143, Reward: 621.2922, Test: 638.3553 [201.86], Avg: 164.7920 (0.055)
Ep: 144, Reward: 658.4458, Test: 718.3059 [118.92], Avg: 167.7892 (0.053)
Ep: 145, Reward: 626.3463, Test: 520.3082 [187.74], Avg: 168.9178 (0.052)
Ep: 146, Reward: 601.9921, Test: 564.6082 [197.82], Avg: 170.2639 (0.051)
Ep: 147, Reward: 644.7947, Test: 567.4604 [166.83], Avg: 171.8205 (0.050)
Ep: 148, Reward: 772.2526, Test: 548.2120 [228.24], Avg: 172.8147 (0.049)
Ep: 149, Reward: 666.2425, Test: 733.7711 [119.06], Avg: 175.7607 (0.048)
Ep: 150, Reward: 731.6041, Test: 766.2620 [165.71], Avg: 178.5739 (0.047)
Ep: 151, Reward: 719.3471, Test: 688.3121 [171.38], Avg: 180.7999 (0.046)
Ep: 152, Reward: 743.2575, Test: 667.4040 [187.87], Avg: 182.7524 (0.045)
Ep: 153, Reward: 742.8415, Test: 685.5626 [151.08], Avg: 185.0364 (0.045)
Ep: 154, Reward: 560.6282, Test: 659.8749 [181.34], Avg: 186.9299 (0.044)
Ep: 155, Reward: 796.1714, Test: 767.3075 [109.16], Avg: 189.9505 (0.043)
Ep: 156, Reward: 776.3155, Test: 749.4798 [124.65], Avg: 192.7204 (0.042)
Ep: 157, Reward: 758.7958, Test: 839.5073 [44.53], Avg: 196.5322 (0.041)
Ep: 158, Reward: 754.8728, Test: 700.7792 [171.11], Avg: 198.6274 (0.040)
Ep: 159, Reward: 740.8441, Test: 804.3634 [107.86], Avg: 201.7391 (0.039)
Ep: 160, Reward: 723.6768, Test: 726.7262 [173.89], Avg: 203.9198 (0.039)
Ep: 161, Reward: 800.2337, Test: 775.4601 [116.61], Avg: 206.7280 (0.038)
Ep: 162, Reward: 784.3291, Test: 795.9665 [36.01], Avg: 210.1220 (0.037)
Ep: 163, Reward: 787.1002, Test: 774.6490 [93.91], Avg: 212.9916 (0.036)
Ep: 164, Reward: 766.0798, Test: 788.8161 [42.96], Avg: 216.2211 (0.036)
Ep: 165, Reward: 755.9224, Test: 796.8075 [68.64], Avg: 219.3051 (0.035)
Ep: 166, Reward: 827.9099, Test: 798.7261 [38.49], Avg: 222.5442 (0.034)
Ep: 167, Reward: 781.8811, Test: 817.2831 [47.79], Avg: 225.7998 (0.034)
Ep: 168, Reward: 853.9461, Test: 812.0436 [62.97], Avg: 228.8961 (0.033)
Ep: 169, Reward: 806.9772, Test: 857.4143 [35.94], Avg: 232.3819 (0.032)
Ep: 170, Reward: 768.4842, Test: 619.5006 [240.22], Avg: 233.2410 (0.032)
Ep: 171, Reward: 726.5123, Test: 648.0123 [174.27], Avg: 234.6392 (0.031)
Ep: 172, Reward: 772.2377, Test: 763.9728 [87.22], Avg: 237.1948 (0.030)
Ep: 173, Reward: 685.3690, Test: 623.3746 [170.48], Avg: 238.4345 (0.030)
Ep: 174, Reward: 730.3425, Test: 821.7138 [47.72], Avg: 241.4948 (0.029)
Ep: 175, Reward: 843.9967, Test: 804.0968 [78.62], Avg: 244.2447 (0.029)
Ep: 176, Reward: 802.6251, Test: 837.4458 [37.46], Avg: 247.3845 (0.028)
Ep: 177, Reward: 885.8690, Test: 857.4494 [39.12], Avg: 250.5921 (0.027)
Ep: 178, Reward: 859.8590, Test: 886.5578 [33.66], Avg: 253.9569 (0.027)
Ep: 179, Reward: 884.6571, Test: 863.5037 [25.90], Avg: 257.1994 (0.026)
Ep: 180, Reward: 893.6557, Test: 767.5756 [86.08], Avg: 259.5436 (0.026)
Ep: 181, Reward: 993.4051, Test: 855.1486 [52.58], Avg: 262.5272 (0.025)
Ep: 182, Reward: 882.3455, Test: 883.5008 [35.74], Avg: 265.7252 (0.025)
Ep: 183, Reward: 956.5963, Test: 815.9051 [121.16], Avg: 268.0569 (0.024)
Ep: 184, Reward: 757.5165, Test: 846.9898 [37.80], Avg: 270.9819 (0.024)
Ep: 185, Reward: 956.1802, Test: 845.3755 [30.88], Avg: 273.9040 (0.023)
Ep: 186, Reward: 769.8217, Test: 869.3550 [33.10], Avg: 276.9112 (0.023)
Ep: 187, Reward: 866.1738, Test: 812.8015 [186.84], Avg: 278.7678 (0.022)
Ep: 188, Reward: 907.2158, Test: 716.4807 [210.05], Avg: 279.9724 (0.022)
Ep: 189, Reward: 837.3587, Test: 828.7781 [67.71], Avg: 282.5045 (0.022)
Ep: 190, Reward: 798.6963, Test: 806.4762 [156.11], Avg: 284.4305 (0.021)
Ep: 191, Reward: 907.6014, Test: 850.7693 [54.97], Avg: 287.0938 (0.021)
Ep: 192, Reward: 868.9785, Test: 858.0233 [64.38], Avg: 289.7184 (0.020)
Ep: 193, Reward: 886.1742, Test: 810.6158 [65.97], Avg: 292.0634 (0.020)
Ep: 194, Reward: 857.3993, Test: 812.9481 [58.18], Avg: 294.4363 (0.020)
Ep: 195, Reward: 695.7472, Test: 806.4691 [144.63], Avg: 296.3108 (0.020)
Ep: 196, Reward: 863.2528, Test: 877.3318 [31.84], Avg: 299.0985 (0.020)
Ep: 197, Reward: 918.9458, Test: 823.4110 [142.54], Avg: 301.0266 (0.020)
Ep: 198, Reward: 836.9035, Test: 841.5722 [56.15], Avg: 303.4608 (0.020)
Ep: 199, Reward: 945.7023, Test: 881.3737 [35.00], Avg: 306.1754 (0.020)
Ep: 200, Reward: 910.4718, Test: 884.1413 [50.84], Avg: 308.7979 (0.020)
Ep: 201, Reward: 861.6027, Test: 822.2574 [57.57], Avg: 311.0547 (0.020)
Ep: 202, Reward: 837.4096, Test: 709.6581 [259.05], Avg: 311.7422 (0.020)
Ep: 203, Reward: 686.1044, Test: 825.4174 [161.96], Avg: 313.4663 (0.020)
Ep: 204, Reward: 804.5853, Test: 779.3435 [205.51], Avg: 314.7363 (0.020)
Ep: 205, Reward: 740.3385, Test: 677.4306 [250.45], Avg: 315.2812 (0.020)
Ep: 206, Reward: 899.4494, Test: 808.4254 [114.00], Avg: 317.1129 (0.020)
Ep: 207, Reward: 921.9407, Test: 829.4360 [113.76], Avg: 319.0290 (0.020)
Ep: 208, Reward: 865.1775, Test: 886.3107 [38.28], Avg: 321.5601 (0.020)
Ep: 209, Reward: 841.7468, Test: 725.6824 [173.42], Avg: 322.6587 (0.020)
Ep: 210, Reward: 742.9663, Test: 842.4522 [74.55], Avg: 324.7689 (0.020)
Ep: 211, Reward: 981.4415, Test: 832.5330 [96.03], Avg: 326.7110 (0.020)
Ep: 212, Reward: 858.2018, Test: 823.2453 [178.27], Avg: 328.2052 (0.020)
Ep: 213, Reward: 821.4254, Test: 827.1244 [84.86], Avg: 330.1401 (0.020)
Ep: 214, Reward: 979.2910, Test: 865.9115 [37.82], Avg: 332.4561 (0.020)
Ep: 215, Reward: 928.5779, Test: 758.2812 [194.90], Avg: 333.5252 (0.020)
Ep: 216, Reward: 953.4122, Test: 797.6707 [149.27], Avg: 334.9763 (0.020)
Ep: 217, Reward: 946.8158, Test: 872.1206 [35.54], Avg: 337.2772 (0.020)
Ep: 218, Reward: 905.0526, Test: 903.9167 [28.45], Avg: 339.7347 (0.020)
Ep: 219, Reward: 1042.7404, Test: 914.0253 [28.68], Avg: 342.2148 (0.020)
Ep: 220, Reward: 989.2229, Test: 882.2318 [32.48], Avg: 344.5113 (0.020)
Ep: 221, Reward: 981.5870, Test: 862.9176 [64.02], Avg: 346.5581 (0.020)
Ep: 222, Reward: 974.4580, Test: 869.1425 [54.84], Avg: 348.6556 (0.020)
Ep: 223, Reward: 1052.6937, Test: 873.0073 [36.69], Avg: 350.8327 (0.020)
Ep: 224, Reward: 940.4224, Test: 882.1615 [43.45], Avg: 353.0011 (0.020)
Ep: 225, Reward: 860.7203, Test: 780.2420 [184.28], Avg: 354.0761 (0.020)
Ep: 226, Reward: 963.8838, Test: 888.4933 [34.29], Avg: 356.2793 (0.020)
Ep: 227, Reward: 972.6259, Test: 874.3927 [34.79], Avg: 358.3992 (0.020)
Ep: 228, Reward: 954.8798, Test: 839.9189 [68.58], Avg: 360.2024 (0.020)
Ep: 229, Reward: 881.3562, Test: 891.3519 [36.50], Avg: 362.3530 (0.020)
Ep: 230, Reward: 966.5011, Test: 870.9020 [50.32], Avg: 364.3367 (0.020)
Ep: 231, Reward: 906.9318, Test: 793.2373 [107.61], Avg: 365.7216 (0.020)
Ep: 232, Reward: 875.6572, Test: 751.3052 [206.62], Avg: 366.4897 (0.020)
Ep: 233, Reward: 948.6394, Test: 844.9018 [149.30], Avg: 367.8961 (0.020)
Ep: 234, Reward: 901.1792, Test: 824.0965 [92.95], Avg: 369.4418 (0.020)
Ep: 235, Reward: 979.6378, Test: 711.5494 [164.45], Avg: 370.1946 (0.020)
Ep: 236, Reward: 896.8432, Test: 798.4025 [157.12], Avg: 371.3384 (0.020)
Ep: 237, Reward: 849.2812, Test: 822.8172 [109.67], Avg: 372.7746 (0.020)
Ep: 238, Reward: 834.3141, Test: 830.0619 [118.32], Avg: 374.1929 (0.020)
Ep: 239, Reward: 864.7842, Test: 856.0529 [21.12], Avg: 376.1126 (0.020)
Ep: 240, Reward: 867.4339, Test: 797.9461 [169.71], Avg: 377.1588 (0.020)
Ep: 241, Reward: 813.0821, Test: 877.1428 [26.61], Avg: 379.1149 (0.020)
Ep: 242, Reward: 815.1099, Test: 782.9116 [176.35], Avg: 380.0509 (0.020)
Ep: 243, Reward: 808.2112, Test: 858.0214 [45.99], Avg: 381.8213 (0.020)
Ep: 244, Reward: 934.0769, Test: 863.7380 [50.98], Avg: 383.5802 (0.020)
Ep: 245, Reward: 930.2686, Test: 879.7752 [22.19], Avg: 385.5071 (0.020)
Ep: 246, Reward: 962.6217, Test: 885.9057 [32.25], Avg: 387.4024 (0.020)
Ep: 247, Reward: 861.3793, Test: 740.5772 [184.20], Avg: 388.0838 (0.020)
Ep: 248, Reward: 949.9240, Test: 888.2685 [22.30], Avg: 390.0030 (0.020)
Ep: 249, Reward: 1148.1008, Test: 866.5409 [36.96], Avg: 391.7613 (0.020)
Ep: 250, Reward: 892.8445, Test: 879.4020 [21.17], Avg: 393.6197 (0.020)
Ep: 251, Reward: 1070.8206, Test: 891.2108 [31.10], Avg: 395.4709 (0.020)
Ep: 252, Reward: 889.7548, Test: 890.2151 [18.26], Avg: 397.3543 (0.020)
Ep: 253, Reward: 1030.4537, Test: 889.4603 [34.96], Avg: 399.1540 (0.020)
Ep: 254, Reward: 880.4801, Test: 871.6085 [27.78], Avg: 400.8979 (0.020)
Ep: 255, Reward: 920.2694, Test: 812.4528 [107.45], Avg: 402.0858 (0.020)
Ep: 256, Reward: 874.7644, Test: 853.5168 [96.32], Avg: 403.4676 (0.020)
Ep: 257, Reward: 897.2768, Test: 840.8006 [81.76], Avg: 404.8458 (0.020)
Ep: 258, Reward: 896.6517, Test: 897.5536 [25.37], Avg: 406.6501 (0.020)
Ep: 259, Reward: 912.1687, Test: 772.6160 [178.77], Avg: 407.3701 (0.020)
Ep: 260, Reward: 769.8472, Test: 747.1772 [155.56], Avg: 408.0761 (0.020)
Ep: 261, Reward: 873.0574, Test: 864.3042 [103.05], Avg: 409.4241 (0.020)
Ep: 262, Reward: 891.5151, Test: 859.3870 [51.43], Avg: 410.9394 (0.020)
Ep: 263, Reward: 878.3645, Test: 800.2066 [200.67], Avg: 411.6538 (0.020)
Ep: 264, Reward: 861.5988, Test: 837.0513 [84.02], Avg: 412.9420 (0.020)
Ep: 265, Reward: 881.5007, Test: 752.8631 [183.20], Avg: 413.5312 (0.020)
Ep: 266, Reward: 743.9472, Test: 827.9062 [138.86], Avg: 414.5631 (0.020)
Ep: 267, Reward: 819.2154, Test: 873.1162 [11.25], Avg: 416.2321 (0.020)
Ep: 268, Reward: 898.0300, Test: 770.0897 [176.90], Avg: 416.8900 (0.020)
Ep: 269, Reward: 718.4668, Test: 817.1706 [98.70], Avg: 418.0069 (0.020)
Ep: 270, Reward: 778.9932, Test: 731.3230 [180.05], Avg: 418.4987 (0.020)
Ep: 271, Reward: 800.0341, Test: 700.5879 [181.25], Avg: 418.8695 (0.020)
Ep: 272, Reward: 841.7842, Test: 881.7779 [30.57], Avg: 420.4531 (0.020)
Ep: 273, Reward: 854.1057, Test: 798.4961 [126.09], Avg: 421.3727 (0.020)
Ep: 274, Reward: 891.3944, Test: 867.1894 [9.51], Avg: 422.9592 (0.020)
Ep: 275, Reward: 862.4637, Test: 828.1185 [51.58], Avg: 424.2403 (0.020)
Ep: 276, Reward: 930.4794, Test: 864.9314 [26.50], Avg: 425.7356 (0.020)
Ep: 277, Reward: 857.5435, Test: 836.2177 [41.05], Avg: 427.0645 (0.020)
Ep: 278, Reward: 854.0159, Test: 875.8495 [14.56], Avg: 428.6208 (0.020)
Ep: 279, Reward: 902.4673, Test: 865.8859 [25.07], Avg: 430.0930 (0.020)
Ep: 280, Reward: 934.2927, Test: 876.3527 [28.91], Avg: 431.5782 (0.020)
Ep: 281, Reward: 862.4643, Test: 792.5026 [143.67], Avg: 432.3486 (0.020)
Ep: 282, Reward: 829.2335, Test: 894.0359 [26.62], Avg: 433.8860 (0.020)
Ep: 283, Reward: 914.8097, Test: 835.2261 [70.30], Avg: 435.0516 (0.020)
Ep: 284, Reward: 885.6060, Test: 852.3416 [24.32], Avg: 436.4305 (0.020)
Ep: 285, Reward: 927.8757, Test: 832.7302 [135.74], Avg: 437.3415 (0.020)
Ep: 286, Reward: 918.8174, Test: 809.6085 [156.65], Avg: 438.0928 (0.020)
Ep: 287, Reward: 783.8825, Test: 823.9664 [101.64], Avg: 439.0797 (0.020)
Ep: 288, Reward: 840.7241, Test: 776.2272 [137.91], Avg: 439.7691 (0.020)
Ep: 289, Reward: 832.0839, Test: 840.5246 [114.22], Avg: 440.7572 (0.020)
Ep: 290, Reward: 1013.1969, Test: 828.3586 [169.19], Avg: 441.5077 (0.020)
Ep: 291, Reward: 678.7169, Test: 787.8299 [166.77], Avg: 442.1226 (0.020)
Ep: 292, Reward: 976.9339, Test: 855.2693 [78.27], Avg: 443.2655 (0.020)
Ep: 293, Reward: 968.5476, Test: 870.3732 [47.21], Avg: 444.5577 (0.020)
Ep: 294, Reward: 872.2569, Test: 895.0510 [42.18], Avg: 445.9418 (0.020)
Ep: 295, Reward: 982.6737, Test: 844.9916 [54.95], Avg: 447.1043 (0.020)
Ep: 296, Reward: 985.0648, Test: 805.0750 [166.85], Avg: 447.7478 (0.020)
Ep: 297, Reward: 878.8256, Test: 862.2515 [39.96], Avg: 449.0046 (0.020)
Ep: 298, Reward: 928.1555, Test: 865.6970 [27.50], Avg: 450.3063 (0.020)
Ep: 299, Reward: 915.9222, Test: 879.6693 [22.76], Avg: 451.6616 (0.020)
Ep: 300, Reward: 945.3139, Test: 881.0299 [32.16], Avg: 452.9813 (0.020)
Ep: 301, Reward: 857.5151, Test: 883.7658 [27.82], Avg: 454.3156 (0.020)
Ep: 302, Reward: 977.7131, Test: 873.8089 [70.66], Avg: 455.4669 (0.020)
Ep: 303, Reward: 871.0260, Test: 840.4903 [128.21], Avg: 456.3116 (0.020)
Ep: 304, Reward: 959.2999, Test: 833.6903 [98.17], Avg: 457.2271 (0.020)
Ep: 305, Reward: 815.2709, Test: 709.2637 [172.95], Avg: 457.4855 (0.020)
Ep: 306, Reward: 770.8923, Test: 624.1520 [164.34], Avg: 457.4931 (0.020)
Ep: 307, Reward: 788.7335, Test: 716.8242 [183.85], Avg: 457.7382 (0.020)
Ep: 308, Reward: 722.0119, Test: 725.7259 [158.77], Avg: 458.0916 (0.020)
Ep: 309, Reward: 871.5847, Test: 710.2729 [159.69], Avg: 458.3900 (0.020)
Ep: 310, Reward: 827.1083, Test: 801.7466 [161.29], Avg: 458.9754 (0.020)
Ep: 311, Reward: 882.9240, Test: 867.8468 [17.45], Avg: 460.2300 (0.020)
Ep: 312, Reward: 842.9019, Test: 680.7270 [249.94], Avg: 460.1359 (0.020)
Ep: 313, Reward: 777.1244, Test: 785.4685 [229.13], Avg: 460.4423 (0.020)
Ep: 314, Reward: 892.3470, Test: 882.1900 [17.88], Avg: 461.7244 (0.020)
Ep: 315, Reward: 960.4460, Test: 745.2649 [280.58], Avg: 461.7338 (0.020)
Ep: 316, Reward: 865.3759, Test: 870.4518 [8.72], Avg: 462.9956 (0.020)
Ep: 317, Reward: 835.4227, Test: 860.1248 [17.14], Avg: 464.1905 (0.020)
Ep: 318, Reward: 798.6979, Test: 696.3855 [295.84], Avg: 463.9910 (0.020)
Ep: 319, Reward: 792.2211, Test: 788.5383 [142.01], Avg: 464.5614 (0.020)
Ep: 320, Reward: 783.6817, Test: 863.6985 [20.59], Avg: 465.7407 (0.020)
Ep: 321, Reward: 712.3524, Test: 764.2866 [184.87], Avg: 466.0938 (0.020)
Ep: 322, Reward: 775.2791, Test: 833.4475 [113.17], Avg: 466.8807 (0.020)
Ep: 323, Reward: 796.8911, Test: 699.8256 [252.04], Avg: 466.8218 (0.020)
Ep: 324, Reward: 724.1391, Test: 842.0376 [53.18], Avg: 467.8127 (0.020)
Ep: 325, Reward: 838.1994, Test: 842.7216 [53.59], Avg: 468.7983 (0.020)
Ep: 326, Reward: 819.1043, Test: 876.0940 [24.34], Avg: 469.9694 (0.020)
Ep: 327, Reward: 847.2874, Test: 873.5865 [24.77], Avg: 471.1244 (0.020)
Ep: 328, Reward: 808.9593, Test: 844.1514 [92.36], Avg: 471.9775 (0.020)
Ep: 329, Reward: 816.0049, Test: 744.3256 [224.69], Avg: 472.1219 (0.020)
Ep: 330, Reward: 896.2890, Test: 822.1258 [148.51], Avg: 472.7307 (0.020)
Ep: 331, Reward: 860.9572, Test: 770.3260 [201.51], Avg: 473.0201 (0.020)
Ep: 332, Reward: 715.7255, Test: 563.3598 [205.89], Avg: 472.6731 (0.020)
Ep: 333, Reward: 804.3790, Test: 708.3458 [260.97], Avg: 472.5973 (0.020)
Ep: 334, Reward: 780.0967, Test: 868.0043 [79.39], Avg: 473.5407 (0.020)
Ep: 335, Reward: 895.2426, Test: 838.7328 [82.98], Avg: 474.3806 (0.020)
Ep: 336, Reward: 738.9320, Test: 690.5909 [206.28], Avg: 474.4101 (0.020)
Ep: 337, Reward: 763.4831, Test: 778.4052 [124.84], Avg: 474.9401 (0.020)
Ep: 338, Reward: 761.4687, Test: 848.7232 [81.28], Avg: 475.8030 (0.020)
Ep: 339, Reward: 852.1799, Test: 882.8185 [30.55], Avg: 476.9102 (0.020)
Ep: 340, Reward: 924.5737, Test: 755.7528 [130.82], Avg: 477.3443 (0.020)
Ep: 341, Reward: 991.4350, Test: 893.4512 [17.42], Avg: 478.5101 (0.020)
Ep: 342, Reward: 911.7025, Test: 842.2103 [88.63], Avg: 479.3120 (0.020)
Ep: 343, Reward: 985.3916, Test: 815.1140 [111.05], Avg: 479.9654 (0.020)
Ep: 344, Reward: 1128.2011, Test: 883.2290 [80.71], Avg: 480.9003 (0.020)
Ep: 345, Reward: 896.2590, Test: 865.4684 [108.56], Avg: 481.6980 (0.020)
Ep: 346, Reward: 917.7867, Test: 873.5540 [96.15], Avg: 482.5502 (0.020)
Ep: 347, Reward: 999.7732, Test: 887.3170 [32.16], Avg: 483.6209 (0.020)
Ep: 348, Reward: 951.5081, Test: 895.3459 [39.24], Avg: 484.6882 (0.020)
Ep: 349, Reward: 944.7781, Test: 779.5197 [104.10], Avg: 485.2332 (0.020)
Ep: 350, Reward: 1067.2566, Test: 817.5988 [138.25], Avg: 485.7862 (0.020)
Ep: 351, Reward: 771.1831, Test: 866.0295 [46.87], Avg: 486.7333 (0.020)
Ep: 352, Reward: 838.1311, Test: 828.9597 [55.47], Avg: 487.5456 (0.020)
Ep: 353, Reward: 768.5391, Test: 874.9861 [16.96], Avg: 488.5922 (0.020)
Ep: 354, Reward: 875.6021, Test: 847.9023 [64.97], Avg: 489.4213 (0.020)
Ep: 355, Reward: 884.3427, Test: 747.2452 [108.86], Avg: 489.8398 (0.020)
Ep: 356, Reward: 678.6394, Test: 803.3070 [90.76], Avg: 490.4636 (0.020)
Ep: 357, Reward: 874.8961, Test: 850.2654 [74.55], Avg: 491.2604 (0.020)
Ep: 358, Reward: 830.5200, Test: 786.4629 [76.79], Avg: 491.8688 (0.020)
Ep: 359, Reward: 815.0847, Test: 876.6329 [13.13], Avg: 492.9011 (0.020)
Ep: 360, Reward: 879.0212, Test: 894.5763 [17.33], Avg: 493.9658 (0.020)
Ep: 361, Reward: 921.1262, Test: 894.1575 [25.45], Avg: 495.0010 (0.020)
Ep: 362, Reward: 942.2926, Test: 886.9698 [15.59], Avg: 496.0378 (0.020)
Ep: 363, Reward: 889.6185, Test: 882.3468 [26.30], Avg: 497.0269 (0.020)
Ep: 364, Reward: 948.7920, Test: 878.5130 [60.51], Avg: 497.9063 (0.020)
Ep: 365, Reward: 933.2402, Test: 878.1506 [34.50], Avg: 498.8509 (0.020)
Ep: 366, Reward: 960.6472, Test: 868.3515 [76.36], Avg: 499.6497 (0.020)
Ep: 367, Reward: 952.8328, Test: 877.4612 [35.17], Avg: 500.5808 (0.020)
Ep: 368, Reward: 817.7061, Test: 848.3803 [53.36], Avg: 501.3787 (0.020)
Ep: 369, Reward: 977.9894, Test: 822.6388 [100.87], Avg: 501.9744 (0.020)
Ep: 370, Reward: 948.8273, Test: 796.6881 [196.26], Avg: 502.2397 (0.020)
Ep: 371, Reward: 939.6676, Test: 840.2830 [63.20], Avg: 502.9786 (0.020)
Ep: 372, Reward: 897.8607, Test: 874.3265 [67.12], Avg: 503.7942 (0.020)
Ep: 373, Reward: 779.9382, Test: 604.3965 [139.12], Avg: 503.6912 (0.020)
Ep: 374, Reward: 825.1089, Test: 875.9520 [30.34], Avg: 504.6030 (0.020)
Ep: 375, Reward: 871.1279, Test: 853.3605 [79.40], Avg: 505.3194 (0.020)
Ep: 376, Reward: 813.9334, Test: 840.0146 [118.11], Avg: 505.8939 (0.020)
Ep: 377, Reward: 936.8799, Test: 754.8084 [145.58], Avg: 506.1673 (0.020)
Ep: 378, Reward: 930.3618, Test: 788.6405 [153.44], Avg: 506.5077 (0.020)
Ep: 379, Reward: 914.0111, Test: 792.9206 [124.93], Avg: 506.9327 (0.020)
Ep: 380, Reward: 823.1458, Test: 864.4632 [77.79], Avg: 507.6669 (0.020)
Ep: 381, Reward: 776.2987, Test: 837.2895 [94.93], Avg: 508.2813 (0.020)
Ep: 382, Reward: 964.7807, Test: 772.9924 [115.90], Avg: 508.6698 (0.020)
Ep: 383, Reward: 822.3290, Test: 811.8242 [131.61], Avg: 509.1165 (0.020)
Ep: 384, Reward: 847.4110, Test: 745.1471 [121.96], Avg: 509.4128 (0.020)
Ep: 385, Reward: 732.4043, Test: 863.1157 [68.87], Avg: 510.1507 (0.020)
Ep: 386, Reward: 875.5647, Test: 865.8802 [42.98], Avg: 510.9589 (0.020)
Ep: 387, Reward: 874.2754, Test: 821.7218 [83.20], Avg: 511.5454 (0.020)
Ep: 388, Reward: 752.4908, Test: 696.4550 [279.21], Avg: 511.3030 (0.020)
Ep: 389, Reward: 751.3850, Test: 814.7293 [143.17], Avg: 511.7139 (0.020)
Ep: 390, Reward: 727.7298, Test: 745.2957 [165.24], Avg: 511.8887 (0.020)
Ep: 391, Reward: 844.2815, Test: 842.8371 [134.36], Avg: 512.3902 (0.020)
Ep: 392, Reward: 883.8548, Test: 758.4215 [167.55], Avg: 512.5899 (0.020)
Ep: 393, Reward: 816.4192, Test: 812.4657 [147.41], Avg: 512.9769 (0.020)
Ep: 394, Reward: 843.8301, Test: 690.8954 [168.06], Avg: 513.0018 (0.020)
Ep: 395, Reward: 652.6172, Test: 776.4866 [113.45], Avg: 513.3807 (0.020)
Ep: 396, Reward: 813.4325, Test: 616.3596 [250.90], Avg: 513.0081 (0.020)
Ep: 397, Reward: 817.1196, Test: 759.7804 [168.85], Avg: 513.2038 (0.020)
Ep: 398, Reward: 854.3786, Test: 862.6166 [32.08], Avg: 513.9992 (0.020)
Ep: 399, Reward: 829.4243, Test: 844.1120 [132.86], Avg: 514.4923 (0.020)
Ep: 400, Reward: 904.5949, Test: 821.9731 [89.55], Avg: 515.0358 (0.020)
Ep: 401, Reward: 966.4237, Test: 894.9860 [20.13], Avg: 515.9309 (0.020)
Ep: 402, Reward: 983.1999, Test: 857.9946 [58.33], Avg: 516.6349 (0.020)
Ep: 403, Reward: 810.7645, Test: 883.4527 [19.09], Avg: 517.4956 (0.020)
Ep: 404, Reward: 881.2649, Test: 861.6435 [72.68], Avg: 518.1659 (0.020)
Ep: 405, Reward: 968.4948, Test: 902.7951 [26.25], Avg: 519.0486 (0.020)
Ep: 406, Reward: 910.3077, Test: 888.0321 [16.15], Avg: 519.9155 (0.020)
Ep: 407, Reward: 943.6144, Test: 865.3999 [52.71], Avg: 520.6331 (0.020)
Ep: 408, Reward: 883.1679, Test: 685.2597 [150.92], Avg: 520.6666 (0.020)
Ep: 409, Reward: 880.3252, Test: 837.6564 [153.00], Avg: 521.0666 (0.020)
Ep: 410, Reward: 856.2512, Test: 782.8642 [111.08], Avg: 521.4333 (0.020)
Ep: 411, Reward: 723.1207, Test: 806.6988 [143.16], Avg: 521.7782 (0.020)
Ep: 412, Reward: 846.1149, Test: 768.5457 [141.75], Avg: 522.0325 (0.020)
Ep: 413, Reward: 771.9011, Test: 794.7840 [123.45], Avg: 522.3931 (0.020)
Ep: 414, Reward: 841.3655, Test: 794.9049 [138.67], Avg: 522.7156 (0.020)
Ep: 415, Reward: 804.8062, Test: 800.1776 [117.29], Avg: 523.1006 (0.020)
Ep: 416, Reward: 841.6368, Test: 843.5945 [22.39], Avg: 523.8155 (0.020)
Ep: 417, Reward: 846.7070, Test: 828.9926 [166.04], Avg: 524.1484 (0.020)
Ep: 418, Reward: 767.0334, Test: 792.5491 [157.15], Avg: 524.4139 (0.020)
Ep: 419, Reward: 837.2262, Test: 834.6132 [65.57], Avg: 524.9963 (0.020)
Ep: 420, Reward: 809.1632, Test: 858.8777 [45.84], Avg: 525.6805 (0.020)
Ep: 421, Reward: 865.0237, Test: 753.2682 [134.61], Avg: 525.9008 (0.020)
Ep: 422, Reward: 874.4579, Test: 864.7352 [66.11], Avg: 526.5456 (0.020)
Ep: 423, Reward: 856.3339, Test: 829.9708 [49.84], Avg: 527.1437 (0.020)
Ep: 424, Reward: 804.6432, Test: 744.5319 [116.46], Avg: 527.3811 (0.020)
Ep: 425, Reward: 779.6754, Test: 867.0813 [12.27], Avg: 528.1498 (0.020)
Ep: 426, Reward: 803.2213, Test: 834.7387 [79.97], Avg: 528.6805 (0.020)
Ep: 427, Reward: 769.5377, Test: 641.8369 [228.17], Avg: 528.4118 (0.020)
Ep: 428, Reward: 833.9931, Test: 785.3960 [97.08], Avg: 528.7845 (0.020)
Ep: 429, Reward: 819.3735, Test: 795.7753 [126.37], Avg: 529.1115 (0.020)
Ep: 430, Reward: 768.6531, Test: 661.9956 [189.35], Avg: 528.9805 (0.020)
Ep: 431, Reward: 794.3866, Test: 802.3406 [99.54], Avg: 529.3829 (0.020)
Ep: 432, Reward: 824.2577, Test: 802.2488 [90.26], Avg: 529.8046 (0.020)
Ep: 433, Reward: 812.5232, Test: 853.9647 [70.99], Avg: 530.3879 (0.020)
Ep: 434, Reward: 821.9342, Test: 857.3591 [36.88], Avg: 531.0548 (0.020)
Ep: 435, Reward: 840.0806, Test: 854.7896 [47.83], Avg: 531.6876 (0.020)
Ep: 436, Reward: 904.3206, Test: 830.1154 [112.90], Avg: 532.1122 (0.020)
Ep: 437, Reward: 887.2450, Test: 774.8625 [209.65], Avg: 532.1878 (0.020)
Ep: 438, Reward: 760.5218, Test: 731.0143 [227.60], Avg: 532.1222 (0.020)
Ep: 439, Reward: 806.4314, Test: 789.2197 [169.75], Avg: 532.3207 (0.020)
Ep: 440, Reward: 834.6001, Test: 766.2184 [154.83], Avg: 532.5000 (0.020)
Ep: 441, Reward: 797.5040, Test: 885.6910 [21.80], Avg: 533.2498 (0.020)
Ep: 442, Reward: 803.7088, Test: 754.2149 [164.27], Avg: 533.3778 (0.020)
Ep: 443, Reward: 884.0751, Test: 877.7637 [38.87], Avg: 534.0659 (0.020)
Ep: 444, Reward: 809.8619, Test: 861.9999 [25.03], Avg: 534.7465 (0.020)
Ep: 445, Reward: 748.8411, Test: 731.6777 [130.79], Avg: 534.8948 (0.020)
Ep: 446, Reward: 699.5296, Test: 684.2021 [187.74], Avg: 534.8088 (0.020)
Ep: 447, Reward: 721.1060, Test: 757.7544 [168.54], Avg: 534.9303 (0.020)
Ep: 448, Reward: 744.1890, Test: 832.7086 [34.47], Avg: 535.5167 (0.020)
Ep: 449, Reward: 811.5860, Test: 785.5016 [119.66], Avg: 535.8063 (0.020)
Ep: 450, Reward: 755.1413, Test: 820.4397 [75.47], Avg: 536.2701 (0.020)
Ep: 451, Reward: 746.4987, Test: 829.9786 [55.61], Avg: 536.7969 (0.020)
Ep: 452, Reward: 891.7362, Test: 845.6235 [83.46], Avg: 537.2944 (0.020)
Ep: 453, Reward: 921.6882, Test: 821.8741 [85.62], Avg: 537.7326 (0.020)
Ep: 454, Reward: 873.0351, Test: 813.2657 [128.47], Avg: 538.0558 (0.020)
Ep: 455, Reward: 943.6835, Test: 899.6277 [28.37], Avg: 538.7865 (0.020)
Ep: 456, Reward: 971.8224, Test: 925.5656 [11.00], Avg: 539.6088 (0.020)
Ep: 457, Reward: 977.1569, Test: 870.9676 [85.60], Avg: 540.1454 (0.020)
Ep: 458, Reward: 1058.5457, Test: 913.0106 [17.41], Avg: 540.9198 (0.020)
Ep: 459, Reward: 1001.6286, Test: 896.8917 [19.36], Avg: 541.6516 (0.020)
Ep: 460, Reward: 1018.4367, Test: 916.7435 [16.22], Avg: 542.4300 (0.020)
Ep: 461, Reward: 973.9396, Test: 894.4646 [10.43], Avg: 543.1694 (0.020)
Ep: 462, Reward: 1011.6778, Test: 907.8188 [17.11], Avg: 543.9200 (0.020)
Ep: 463, Reward: 1012.3585, Test: 918.6867 [17.56], Avg: 544.6899 (0.020)
Ep: 464, Reward: 972.3190, Test: 867.8498 [58.73], Avg: 545.2585 (0.020)
Ep: 465, Reward: 1081.3058, Test: 877.0609 [31.26], Avg: 545.9035 (0.020)
Ep: 466, Reward: 928.6019, Test: 882.9809 [8.05], Avg: 546.6080 (0.020)
Ep: 467, Reward: 941.5247, Test: 770.7091 [132.54], Avg: 546.8037 (0.020)
Ep: 468, Reward: 742.2883, Test: 798.9172 [90.00], Avg: 547.1493 (0.020)
Ep: 469, Reward: 832.0744, Test: 833.2515 [100.70], Avg: 547.5438 (0.020)
Ep: 470, Reward: 901.0545, Test: 874.4114 [16.48], Avg: 548.2028 (0.020)
Ep: 471, Reward: 869.4561, Test: 870.6434 [28.84], Avg: 548.8248 (0.020)
Ep: 472, Reward: 967.1058, Test: 891.8533 [24.45], Avg: 549.4983 (0.020)
Ep: 473, Reward: 929.7893, Test: 897.2136 [9.28], Avg: 550.2123 (0.020)
Ep: 474, Reward: 953.9294, Test: 753.3952 [197.55], Avg: 550.2242 (0.020)
Ep: 475, Reward: 889.2830, Test: 912.1349 [19.89], Avg: 550.9427 (0.020)
Ep: 476, Reward: 913.1184, Test: 866.2289 [56.16], Avg: 551.4860 (0.020)
Ep: 477, Reward: 1016.9931, Test: 891.7811 [38.46], Avg: 552.1174 (0.020)
Ep: 478, Reward: 943.5836, Test: 846.2359 [132.18], Avg: 552.4555 (0.020)
Ep: 479, Reward: 992.2689, Test: 887.4906 [41.13], Avg: 553.0678 (0.020)
Ep: 480, Reward: 852.7215, Test: 893.4581 [25.67], Avg: 553.7221 (0.020)
Ep: 481, Reward: 970.0871, Test: 878.5484 [11.26], Avg: 554.3727 (0.020)
Ep: 482, Reward: 869.9048, Test: 864.0660 [14.34], Avg: 554.9841 (0.020)
Ep: 483, Reward: 876.1734, Test: 875.7382 [26.20], Avg: 555.5927 (0.020)
Ep: 484, Reward: 847.6965, Test: 842.3640 [19.03], Avg: 556.1448 (0.020)
Ep: 485, Reward: 848.0491, Test: 816.1475 [163.67], Avg: 556.3430 (0.020)
Ep: 486, Reward: 857.5518, Test: 885.1639 [22.59], Avg: 556.9718 (0.020)
Ep: 487, Reward: 814.3496, Test: 755.6744 [186.99], Avg: 556.9958 (0.020)
Ep: 488, Reward: 857.4516, Test: 828.1158 [84.33], Avg: 557.3778 (0.020)
Ep: 489, Reward: 873.7834, Test: 802.1598 [189.59], Avg: 557.4904 (0.020)
Ep: 490, Reward: 850.2438, Test: 767.5386 [167.35], Avg: 557.5774 (0.020)
Ep: 491, Reward: 923.0611, Test: 868.5467 [25.43], Avg: 558.1577 (0.020)
Ep: 492, Reward: 850.1944, Test: 853.1194 [23.84], Avg: 558.7077 (0.020)
Ep: 493, Reward: 845.5194, Test: 901.0386 [30.81], Avg: 559.3383 (0.020)
Ep: 494, Reward: 902.9651, Test: 847.4327 [76.38], Avg: 559.7660 (0.020)
Ep: 495, Reward: 894.9803, Test: 874.1228 [20.93], Avg: 560.3576 (0.020)
Ep: 496, Reward: 945.5154, Test: 883.3518 [20.62], Avg: 560.9660 (0.020)
Ep: 497, Reward: 1006.0802, Test: 881.0677 [11.70], Avg: 561.5852 (0.020)
Ep: 498, Reward: 886.6671, Test: 891.2418 [14.21], Avg: 562.2174 (0.020)
Ep: 499, Reward: 980.5353, Test: 879.5391 [14.66], Avg: 562.8227 (0.020)
