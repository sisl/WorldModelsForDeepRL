Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 64        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.0225               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -61.8006, Test: -57.4923 [16.83], Avg: -74.3268 (0.980)
Ep: 1, Reward: -55.5662, Test: -58.7396 [16.58], Avg: -74.8244 (0.960)
Ep: 2, Reward: -55.2512, Test: -59.0666 [22.20], Avg: -76.9709 (0.941)
Ep: 3, Reward: -63.2687, Test: -61.7358 [18.76], Avg: -77.8516 (0.922)
Ep: 4, Reward: -52.6858, Test: -51.4116 [13.40], Avg: -75.2435 (0.904)
Ep: 5, Reward: -68.3437, Test: -47.0112 [24.30], Avg: -74.5876 (0.886)
Ep: 6, Reward: -62.1296, Test: -41.3887 [22.19], Avg: -73.0153 (0.868)
Ep: 7, Reward: -60.0041, Test: -53.7488 [21.17], Avg: -73.2538 (0.851)
Ep: 8, Reward: -56.9529, Test: -66.1972 [41.70], Avg: -77.1029 (0.834)
Ep: 9, Reward: -49.0914, Test: -46.7789 [22.37], Avg: -76.3079 (0.817)
Ep: 10, Reward: -44.0722, Test: -49.8535 [24.24], Avg: -76.1065 (0.801)
Ep: 11, Reward: -50.1301, Test: -54.1969 [19.14], Avg: -75.8760 (0.785)
Ep: 12, Reward: -52.5053, Test: -51.6991 [25.06], Avg: -75.9436 (0.769)
Ep: 13, Reward: -60.6010, Test: -51.7030 [18.99], Avg: -75.5686 (0.754)
Ep: 14, Reward: -53.3238, Test: -50.8814 [18.23], Avg: -75.1384 (0.739)
Ep: 15, Reward: -49.5624, Test: -53.1022 [19.87], Avg: -75.0031 (0.724)
Ep: 16, Reward: -52.1451, Test: -52.1283 [37.97], Avg: -75.8909 (0.709)
Ep: 17, Reward: -54.8682, Test: -47.5083 [29.48], Avg: -75.9517 (0.695)
Ep: 18, Reward: -55.0900, Test: -60.5365 [15.70], Avg: -75.9668 (0.681)
Ep: 19, Reward: -52.7583, Test: -55.0531 [47.66], Avg: -77.3043 (0.668)
Ep: 20, Reward: -60.0775, Test: -35.7565 [37.87], Avg: -77.1293 (0.654)
Ep: 21, Reward: -45.2725, Test: -44.4453 [22.21], Avg: -76.6533 (0.641)
Ep: 22, Reward: -46.4788, Test: -24.1103 [38.91], Avg: -76.0605 (0.628)
Ep: 23, Reward: -19.7087, Test: -34.0672 [24.88], Avg: -75.3473 (0.616)
Ep: 24, Reward: -39.5573, Test: -35.2362 [31.60], Avg: -75.0067 (0.603)
Ep: 25, Reward: -39.2466, Test: -17.8701 [33.82], Avg: -74.1099 (0.591)
Ep: 26, Reward: -37.3821, Test: -31.0090 [33.01], Avg: -73.7361 (0.580)
Ep: 27, Reward: -21.9211, Test: -13.7910 [46.83], Avg: -73.2678 (0.568)
Ep: 28, Reward: -15.5426, Test: -7.2244 [45.31], Avg: -72.5528 (0.557)
Ep: 29, Reward: -16.9968, Test: 10.5408 [87.17], Avg: -72.6888 (0.545)
Ep: 30, Reward: -13.3704, Test: -25.0485 [20.72], Avg: -71.8202 (0.535)
Ep: 31, Reward: -7.0339, Test: 9.0557 [53.16], Avg: -70.9541 (0.524)
Ep: 32, Reward: -5.4959, Test: -5.7819 [34.21], Avg: -70.0158 (0.513)
Ep: 33, Reward: 47.3373, Test: 56.3476 [92.98], Avg: -69.0339 (0.503)
Ep: 34, Reward: 29.2342, Test: -6.7825 [43.16], Avg: -68.4884 (0.493)
Ep: 35, Reward: 22.8841, Test: 50.4957 [57.68], Avg: -66.7856 (0.483)
Ep: 36, Reward: 66.7429, Test: 29.5531 [64.55], Avg: -65.9264 (0.474)
Ep: 37, Reward: 46.5826, Test: 28.3877 [56.33], Avg: -64.9269 (0.464)
Ep: 38, Reward: 24.2850, Test: 19.0307 [57.94], Avg: -64.2598 (0.455)
Ep: 39, Reward: 29.6139, Test: 48.8996 [69.00], Avg: -63.1558 (0.446)
Ep: 40, Reward: 55.3265, Test: 30.8080 [80.04], Avg: -62.8162 (0.437)
Ep: 41, Reward: 49.8252, Test: 83.8666 [57.06], Avg: -60.6823 (0.428)
Ep: 42, Reward: -2.8700, Test: 23.4224 [75.12], Avg: -60.4733 (0.419)
Ep: 43, Reward: 37.6893, Test: 170.3797 [113.97], Avg: -57.8169 (0.411)
Ep: 44, Reward: 87.6589, Test: 59.7270 [78.88], Avg: -56.9577 (0.403)
Ep: 45, Reward: 44.1250, Test: 25.9475 [68.77], Avg: -56.6503 (0.395)
Ep: 46, Reward: 80.3418, Test: 42.4167 [100.94], Avg: -56.6902 (0.387)
Ep: 47, Reward: 50.3417, Test: 100.7215 [146.84], Avg: -56.4698 (0.379)
Ep: 48, Reward: 44.4675, Test: 100.5971 [130.78], Avg: -55.9333 (0.372)
Ep: 49, Reward: 69.3872, Test: 102.8755 [94.30], Avg: -54.6432 (0.364)
Ep: 50, Reward: 111.6763, Test: 139.2577 [161.93], Avg: -54.0164 (0.357)
Ep: 51, Reward: 109.2007, Test: 149.3416 [159.52], Avg: -53.1734 (0.350)
Ep: 52, Reward: 122.4970, Test: 159.6591 [154.32], Avg: -52.0695 (0.343)
Ep: 53, Reward: 182.8198, Test: 150.6997 [126.52], Avg: -50.6575 (0.336)
Ep: 54, Reward: 105.1522, Test: 145.9393 [128.89], Avg: -49.4266 (0.329)
Ep: 55, Reward: 117.1291, Test: 55.8957 [92.24], Avg: -49.1929 (0.323)
Ep: 56, Reward: 128.6535, Test: 123.1424 [139.54], Avg: -48.6175 (0.316)
Ep: 57, Reward: 81.7000, Test: 202.2918 [152.73], Avg: -46.9247 (0.310)
Ep: 58, Reward: 86.6385, Test: 105.4833 [107.93], Avg: -46.1709 (0.304)
Ep: 59, Reward: 156.4591, Test: 48.9097 [65.84], Avg: -45.6835 (0.298)
Ep: 60, Reward: 147.2121, Test: 98.0767 [112.05], Avg: -45.1636 (0.292)
Ep: 61, Reward: 136.4932, Test: 91.1395 [93.23], Avg: -44.4689 (0.286)
Ep: 62, Reward: 80.1417, Test: 155.2515 [126.21], Avg: -43.3021 (0.280)
Ep: 63, Reward: 113.2262, Test: 161.5734 [139.81], Avg: -42.2853 (0.274)
Ep: 64, Reward: 171.2888, Test: 170.2691 [199.82], Avg: -42.0894 (0.269)
Ep: 65, Reward: 126.3515, Test: 246.7076 [197.11], Avg: -40.7003 (0.264)
Ep: 66, Reward: 126.6373, Test: 252.8289 [161.48], Avg: -38.7294 (0.258)
Ep: 67, Reward: 219.9418, Test: 130.2050 [121.72], Avg: -38.0350 (0.253)
Ep: 68, Reward: 202.0554, Test: 189.0471 [215.61], Avg: -37.8687 (0.248)
Ep: 69, Reward: 222.7740, Test: 227.2500 [214.77], Avg: -37.1495 (0.243)
Ep: 70, Reward: 236.8477, Test: 296.7432 [223.77], Avg: -35.5984 (0.238)
Ep: 71, Reward: 186.2439, Test: 165.2795 [207.14], Avg: -35.6854 (0.233)
Ep: 72, Reward: 131.5341, Test: 149.3121 [233.87], Avg: -36.3549 (0.229)
Ep: 73, Reward: 262.3168, Test: 194.5712 [192.30], Avg: -35.8329 (0.224)
Ep: 74, Reward: 297.7990, Test: 254.6102 [163.64], Avg: -34.1422 (0.220)
Ep: 75, Reward: 269.7241, Test: 245.5427 [294.79], Avg: -34.3410 (0.215)
Ep: 76, Reward: 198.3200, Test: 280.6532 [208.11], Avg: -32.9528 (0.211)
Ep: 77, Reward: 293.3305, Test: 189.2720 [165.61], Avg: -32.2269 (0.207)
Ep: 78, Reward: 252.3448, Test: 295.7743 [218.03], Avg: -30.8349 (0.203)
Ep: 79, Reward: 206.1432, Test: 427.3794 [277.62], Avg: -28.5775 (0.199)
Ep: 80, Reward: 362.9400, Test: 446.0860 [217.94], Avg: -25.4081 (0.195)
Ep: 81, Reward: 324.4783, Test: 297.1639 [196.70], Avg: -23.8731 (0.191)
Ep: 82, Reward: 330.5907, Test: 352.2692 [146.82], Avg: -21.1102 (0.187)
Ep: 83, Reward: 323.4754, Test: 315.5626 [231.13], Avg: -19.8538 (0.183)
Ep: 84, Reward: 344.7883, Test: 421.7473 [234.48], Avg: -17.4171 (0.180)
Ep: 85, Reward: 306.4783, Test: 316.5928 [233.39], Avg: -16.2470 (0.176)
Ep: 86, Reward: 320.9012, Test: 324.3073 [183.19], Avg: -14.4382 (0.172)
Ep: 87, Reward: 415.8566, Test: 416.5808 [258.84], Avg: -12.4816 (0.169)
Ep: 88, Reward: 446.8211, Test: 361.0910 [222.14], Avg: -10.7802 (0.166)
Ep: 89, Reward: 336.2999, Test: 335.3548 [200.40], Avg: -9.1609 (0.162)
Ep: 90, Reward: 337.9852, Test: 435.7197 [200.14], Avg: -6.4714 (0.159)
Ep: 91, Reward: 267.6512, Test: 646.7926 [133.24], Avg: -0.8189 (0.156)
Ep: 92, Reward: 439.1354, Test: 408.5481 [189.96], Avg: 1.5403 (0.153)
Ep: 93, Reward: 501.8987, Test: 409.3796 [248.83], Avg: 3.2319 (0.150)
Ep: 94, Reward: 449.1521, Test: 396.3351 [149.60], Avg: 5.7951 (0.147)
Ep: 95, Reward: 458.5800, Test: 450.5767 [202.81], Avg: 8.3157 (0.144)
Ep: 96, Reward: 343.8066, Test: 391.2065 [254.88], Avg: 9.6354 (0.141)
Ep: 97, Reward: 416.6784, Test: 545.1048 [322.19], Avg: 11.8118 (0.138)
Ep: 98, Reward: 394.8032, Test: 328.6838 [251.50], Avg: 12.4721 (0.135)
Ep: 99, Reward: 495.9766, Test: 423.6846 [257.28], Avg: 14.0115 (0.133)
Ep: 100, Reward: 273.4795, Test: 372.0807 [209.94], Avg: 15.4781 (0.130)
Ep: 101, Reward: 473.8557, Test: 316.1608 [242.74], Avg: 16.0462 (0.127)
Ep: 102, Reward: 475.2962, Test: 460.6618 [177.44], Avg: 18.6401 (0.125)
Ep: 103, Reward: 371.3043, Test: 528.4853 [229.27], Avg: 21.3380 (0.122)
Ep: 104, Reward: 571.2448, Test: 407.3572 [280.47], Avg: 22.3432 (0.120)
Ep: 105, Reward: 455.5389, Test: 447.1084 [204.04], Avg: 24.4255 (0.117)
Ep: 106, Reward: 460.9403, Test: 481.5578 [198.76], Avg: 26.8402 (0.115)
Ep: 107, Reward: 564.9946, Test: 676.8461 [202.74], Avg: 30.9815 (0.113)
Ep: 108, Reward: 698.2022, Test: 671.8144 [208.72], Avg: 34.9459 (0.111)
Ep: 109, Reward: 614.9732, Test: 727.5015 [166.79], Avg: 39.7256 (0.108)
Ep: 110, Reward: 622.7256, Test: 703.9002 [151.20], Avg: 44.3469 (0.106)
Ep: 111, Reward: 630.7200, Test: 746.2803 [194.20], Avg: 48.8802 (0.104)
Ep: 112, Reward: 718.0319, Test: 537.3608 [270.99], Avg: 50.8049 (0.102)
Ep: 113, Reward: 655.7862, Test: 759.7834 [204.37], Avg: 55.2313 (0.100)
Ep: 114, Reward: 754.3823, Test: 746.9206 [136.43], Avg: 60.0597 (0.098)
Ep: 115, Reward: 675.3768, Test: 701.9568 [216.76], Avg: 63.7247 (0.096)
Ep: 116, Reward: 640.0524, Test: 750.1330 [202.82], Avg: 67.8579 (0.094)
Ep: 117, Reward: 737.7065, Test: 651.2207 [222.73], Avg: 70.9142 (0.092)
Ep: 118, Reward: 666.2835, Test: 703.9236 [210.40], Avg: 74.4655 (0.090)
Ep: 119, Reward: 635.7951, Test: 805.0075 [111.99], Avg: 79.6201 (0.089)
Ep: 120, Reward: 732.0566, Test: 777.4926 [171.24], Avg: 83.9725 (0.087)
Ep: 121, Reward: 593.7367, Test: 632.0304 [267.83], Avg: 86.2695 (0.085)
Ep: 122, Reward: 714.8485, Test: 701.9276 [210.64], Avg: 89.5623 (0.083)
Ep: 123, Reward: 617.6410, Test: 827.3639 [69.09], Avg: 94.9551 (0.082)
Ep: 124, Reward: 697.3534, Test: 761.0695 [128.54], Avg: 99.2557 (0.080)
Ep: 125, Reward: 790.2169, Test: 709.0101 [203.39], Avg: 102.4808 (0.078)
Ep: 126, Reward: 831.2321, Test: 720.3748 [170.43], Avg: 106.0042 (0.077)
Ep: 127, Reward: 761.1946, Test: 610.0771 [254.24], Avg: 107.9560 (0.075)
Ep: 128, Reward: 651.9415, Test: 736.5879 [210.87], Avg: 111.1944 (0.074)
Ep: 129, Reward: 671.2952, Test: 813.9493 [117.26], Avg: 115.6982 (0.072)
Ep: 130, Reward: 769.8973, Test: 751.5970 [181.69], Avg: 119.1655 (0.071)
Ep: 131, Reward: 766.3205, Test: 738.9768 [176.81], Avg: 122.5216 (0.069)
Ep: 132, Reward: 752.3178, Test: 740.3382 [213.67], Avg: 125.5603 (0.068)
Ep: 133, Reward: 688.2018, Test: 711.2787 [172.58], Avg: 128.6434 (0.067)
Ep: 134, Reward: 759.6214, Test: 743.2001 [202.74], Avg: 131.6939 (0.065)
Ep: 135, Reward: 786.4937, Test: 805.6704 [99.44], Avg: 135.9184 (0.064)
Ep: 136, Reward: 770.1968, Test: 847.5992 [52.00], Avg: 140.7336 (0.063)
Ep: 137, Reward: 811.2400, Test: 842.6525 [69.20], Avg: 145.3185 (0.062)
Ep: 138, Reward: 708.0988, Test: 724.7610 [229.86], Avg: 147.8335 (0.060)
Ep: 139, Reward: 677.3402, Test: 643.5593 [219.06], Avg: 149.8097 (0.059)
Ep: 140, Reward: 668.3485, Test: 849.5935 [19.80], Avg: 154.6322 (0.058)
Ep: 141, Reward: 665.9698, Test: 763.2497 [238.03], Avg: 157.2420 (0.057)
Ep: 142, Reward: 820.7700, Test: 812.9003 [78.19], Avg: 161.2803 (0.056)
Ep: 143, Reward: 774.8793, Test: 630.3883 [266.79], Avg: 162.6853 (0.055)
Ep: 144, Reward: 821.5888, Test: 819.6281 [151.35], Avg: 166.1721 (0.053)
Ep: 145, Reward: 692.9365, Test: 849.7872 [49.88], Avg: 170.5128 (0.052)
Ep: 146, Reward: 834.5185, Test: 849.8499 [47.23], Avg: 174.8128 (0.051)
Ep: 147, Reward: 797.6929, Test: 862.7176 [31.02], Avg: 179.2513 (0.050)
Ep: 148, Reward: 803.4968, Test: 631.7095 [237.50], Avg: 180.6939 (0.049)
Ep: 149, Reward: 782.6262, Test: 786.4091 [140.55], Avg: 183.7951 (0.048)
Ep: 150, Reward: 798.7272, Test: 818.7095 [65.26], Avg: 187.5676 (0.047)
Ep: 151, Reward: 747.5777, Test: 850.7561 [44.89], Avg: 191.6354 (0.046)
Ep: 152, Reward: 771.7163, Test: 846.6639 [29.75], Avg: 195.7221 (0.045)
Ep: 153, Reward: 740.6956, Test: 797.4275 [214.23], Avg: 198.2382 (0.045)
Ep: 154, Reward: 864.7418, Test: 666.5851 [181.75], Avg: 200.0872 (0.044)
Ep: 155, Reward: 794.3807, Test: 842.3268 [60.48], Avg: 203.8164 (0.043)
Ep: 156, Reward: 873.7825, Test: 798.5763 [114.28], Avg: 206.8768 (0.042)
Ep: 157, Reward: 827.7961, Test: 778.9942 [171.17], Avg: 209.4144 (0.041)
Ep: 158, Reward: 886.2342, Test: 734.4365 [184.41], Avg: 211.5566 (0.040)
Ep: 159, Reward: 867.7986, Test: 850.2807 [97.91], Avg: 214.9367 (0.039)
Ep: 160, Reward: 881.7441, Test: 848.3621 [76.51], Avg: 218.3959 (0.039)
Ep: 161, Reward: 803.4957, Test: 839.9498 [79.23], Avg: 221.7435 (0.038)
Ep: 162, Reward: 845.9331, Test: 850.2189 [137.35], Avg: 224.7566 (0.037)
Ep: 163, Reward: 906.3693, Test: 857.7094 [114.44], Avg: 227.9183 (0.036)
Ep: 164, Reward: 843.6203, Test: 807.9354 [206.25], Avg: 230.1835 (0.036)
Ep: 165, Reward: 808.0417, Test: 776.0359 [129.95], Avg: 232.6890 (0.035)
Ep: 166, Reward: 781.4586, Test: 825.4797 [88.47], Avg: 235.7088 (0.034)
Ep: 167, Reward: 808.5602, Test: 786.3634 [192.32], Avg: 237.8418 (0.034)
Ep: 168, Reward: 828.3845, Test: 845.3128 [25.46], Avg: 241.2856 (0.033)
Ep: 169, Reward: 743.2400, Test: 806.8058 [125.93], Avg: 243.8714 (0.032)
Ep: 170, Reward: 778.7194, Test: 862.2529 [23.09], Avg: 247.3526 (0.032)
Ep: 171, Reward: 865.1976, Test: 734.8968 [177.34], Avg: 249.1562 (0.031)
Ep: 172, Reward: 826.6710, Test: 691.9972 [209.56], Avg: 250.5046 (0.030)
Ep: 173, Reward: 807.1634, Test: 733.6143 [155.95], Avg: 252.3848 (0.030)
Ep: 174, Reward: 828.8897, Test: 795.2104 [96.95], Avg: 254.9327 (0.029)
Ep: 175, Reward: 827.9208, Test: 704.5372 [128.94], Avg: 256.7547 (0.029)
Ep: 176, Reward: 805.6377, Test: 850.1291 [24.31], Avg: 259.9697 (0.028)
Ep: 177, Reward: 773.1820, Test: 725.3370 [141.86], Avg: 261.7871 (0.027)
Ep: 178, Reward: 780.6728, Test: 738.6609 [135.07], Avg: 263.6967 (0.027)
Ep: 179, Reward: 703.2296, Test: 769.6286 [154.29], Avg: 265.6502 (0.026)
Ep: 180, Reward: 816.7216, Test: 845.1541 [48.72], Avg: 268.5828 (0.026)
Ep: 181, Reward: 783.5088, Test: 863.1250 [26.10], Avg: 271.7061 (0.025)
Ep: 182, Reward: 943.1778, Test: 891.2139 [23.48], Avg: 274.9630 (0.025)
Ep: 183, Reward: 845.7373, Test: 881.3163 [24.11], Avg: 278.1274 (0.024)
Ep: 184, Reward: 900.6779, Test: 786.9404 [250.80], Avg: 279.5221 (0.024)
Ep: 185, Reward: 883.1479, Test: 824.5112 [135.56], Avg: 281.7233 (0.023)
Ep: 186, Reward: 747.3976, Test: 872.6996 [34.92], Avg: 284.6968 (0.023)
Ep: 187, Reward: 905.7170, Test: 851.2133 [108.03], Avg: 287.1356 (0.022)
Ep: 188, Reward: 923.2573, Test: 797.6894 [131.35], Avg: 289.1420 (0.022)
Ep: 189, Reward: 839.5839, Test: 772.9707 [195.91], Avg: 290.6573 (0.022)
Ep: 190, Reward: 738.2694, Test: 771.8011 [176.56], Avg: 292.2520 (0.021)
Ep: 191, Reward: 773.3270, Test: 826.3018 [172.75], Avg: 294.1337 (0.021)
Ep: 192, Reward: 883.3283, Test: 743.8262 [259.56], Avg: 295.1189 (0.020)
Ep: 193, Reward: 772.0984, Test: 736.1259 [167.08], Avg: 296.5309 (0.020)
Ep: 194, Reward: 780.3550, Test: 779.0749 [151.29], Avg: 298.2296 (0.020)
Ep: 195, Reward: 846.3088, Test: 872.5007 [22.46], Avg: 301.0450 (0.020)
Ep: 196, Reward: 871.2553, Test: 777.2906 [207.30], Avg: 302.4102 (0.020)
Ep: 197, Reward: 766.5487, Test: 828.8145 [37.85], Avg: 304.8776 (0.020)
Ep: 198, Reward: 788.8411, Test: 691.6926 [224.05], Avg: 305.6956 (0.020)
Ep: 199, Reward: 787.0302, Test: 628.9635 [248.13], Avg: 306.0712 (0.020)
Ep: 200, Reward: 796.1820, Test: 776.8388 [128.58], Avg: 307.7737 (0.020)
Ep: 201, Reward: 790.7788, Test: 876.5950 [35.16], Avg: 310.4156 (0.020)
Ep: 202, Reward: 796.7023, Test: 745.4357 [179.47], Avg: 311.6745 (0.020)
Ep: 203, Reward: 754.7737, Test: 763.3082 [117.02], Avg: 313.3147 (0.020)
Ep: 204, Reward: 828.4579, Test: 795.1979 [170.25], Avg: 314.8349 (0.020)
Ep: 205, Reward: 840.8639, Test: 792.9521 [141.62], Avg: 316.4684 (0.020)
Ep: 206, Reward: 853.7007, Test: 761.8193 [155.35], Avg: 317.8693 (0.020)
Ep: 207, Reward: 805.5529, Test: 857.0817 [23.45], Avg: 320.3489 (0.020)
Ep: 208, Reward: 837.8146, Test: 774.0115 [185.64], Avg: 321.6313 (0.020)
Ep: 209, Reward: 754.0140, Test: 825.6415 [185.34], Avg: 323.1488 (0.020)
Ep: 210, Reward: 910.0932, Test: 710.8317 [196.28], Avg: 324.0559 (0.020)
Ep: 211, Reward: 844.7658, Test: 875.8910 [30.29], Avg: 326.5160 (0.020)
Ep: 212, Reward: 822.7446, Test: 782.9385 [214.16], Avg: 327.6534 (0.020)
Ep: 213, Reward: 940.6388, Test: 762.8263 [216.31], Avg: 328.6762 (0.020)
Ep: 214, Reward: 776.9001, Test: 878.4682 [43.38], Avg: 331.0316 (0.020)
Ep: 215, Reward: 872.6580, Test: 849.2915 [67.83], Avg: 333.1169 (0.020)
Ep: 216, Reward: 791.9641, Test: 747.6692 [232.10], Avg: 333.9577 (0.020)
Ep: 217, Reward: 863.1845, Test: 828.4851 [195.27], Avg: 335.3304 (0.020)
Ep: 218, Reward: 850.3822, Test: 831.9338 [153.52], Avg: 336.8970 (0.020)
Ep: 219, Reward: 867.8862, Test: 903.9136 [20.27], Avg: 339.3822 (0.020)
Ep: 220, Reward: 927.0630, Test: 836.4236 [110.63], Avg: 341.1307 (0.020)
Ep: 221, Reward: 923.6282, Test: 835.5000 [176.63], Avg: 342.5620 (0.020)
Ep: 222, Reward: 947.1913, Test: 894.8803 [48.93], Avg: 344.8193 (0.020)
Ep: 223, Reward: 996.8057, Test: 896.9596 [26.70], Avg: 347.1650 (0.020)
Ep: 224, Reward: 862.8020, Test: 895.6516 [13.71], Avg: 349.5418 (0.020)
Ep: 225, Reward: 842.9367, Test: 842.3997 [175.98], Avg: 350.9439 (0.020)
Ep: 226, Reward: 975.5270, Test: 897.8452 [38.09], Avg: 353.1854 (0.020)
Ep: 227, Reward: 937.5409, Test: 776.9661 [133.34], Avg: 354.4592 (0.020)
Ep: 228, Reward: 847.5986, Test: 746.2052 [183.87], Avg: 355.3670 (0.020)
Ep: 229, Reward: 782.1441, Test: 756.8853 [111.79], Avg: 356.6267 (0.020)
Ep: 230, Reward: 742.1686, Test: 759.8537 [143.01], Avg: 357.7531 (0.020)
Ep: 231, Reward: 697.7077, Test: 645.1452 [276.52], Avg: 357.8000 (0.020)
Ep: 232, Reward: 752.9611, Test: 697.6997 [212.06], Avg: 358.3487 (0.020)
Ep: 233, Reward: 755.6037, Test: 575.6389 [239.12], Avg: 358.2554 (0.020)
Ep: 234, Reward: 631.1292, Test: 621.8330 [221.82], Avg: 358.4331 (0.020)
Ep: 235, Reward: 843.8128, Test: 762.7571 [173.45], Avg: 359.4114 (0.020)
Ep: 236, Reward: 825.9371, Test: 792.5002 [159.14], Avg: 360.5672 (0.020)
Ep: 237, Reward: 854.4312, Test: 767.0906 [168.58], Avg: 361.5670 (0.020)
Ep: 238, Reward: 895.9783, Test: 811.3269 [77.23], Avg: 363.1257 (0.020)
Ep: 239, Reward: 890.8609, Test: 754.5922 [252.25], Avg: 363.7058 (0.020)
Ep: 240, Reward: 864.9652, Test: 832.8796 [109.67], Avg: 365.1975 (0.020)
Ep: 241, Reward: 812.3557, Test: 882.0439 [12.96], Avg: 367.2796 (0.020)
Ep: 242, Reward: 779.2036, Test: 843.1767 [67.47], Avg: 368.9604 (0.020)
Ep: 243, Reward: 870.1883, Test: 861.2949 [107.24], Avg: 370.5387 (0.020)
Ep: 244, Reward: 939.4737, Test: 794.8022 [212.02], Avg: 371.4049 (0.020)
Ep: 245, Reward: 938.5025, Test: 858.3573 [104.28], Avg: 372.9605 (0.020)
Ep: 246, Reward: 866.0717, Test: 894.5192 [27.69], Avg: 374.9600 (0.020)
Ep: 247, Reward: 911.1601, Test: 837.4113 [75.81], Avg: 376.5191 (0.020)
Ep: 248, Reward: 853.8536, Test: 873.6286 [22.07], Avg: 378.4268 (0.020)
Ep: 249, Reward: 891.9224, Test: 878.7131 [19.19], Avg: 380.3512 (0.020)
Ep: 250, Reward: 836.5703, Test: 882.8500 [31.50], Avg: 382.2277 (0.020)
Ep: 251, Reward: 859.5035, Test: 825.1090 [64.32], Avg: 383.7300 (0.020)
Ep: 252, Reward: 858.0560, Test: 765.3150 [135.73], Avg: 384.7017 (0.020)
Ep: 253, Reward: 887.9961, Test: 781.8359 [174.54], Avg: 385.5781 (0.020)
Ep: 254, Reward: 887.8353, Test: 768.0252 [180.30], Avg: 386.3708 (0.020)
Ep: 255, Reward: 979.5709, Test: 886.7069 [24.02], Avg: 388.2314 (0.020)
Ep: 256, Reward: 933.0825, Test: 860.0973 [109.71], Avg: 389.6406 (0.020)
Ep: 257, Reward: 850.4591, Test: 836.1978 [102.61], Avg: 390.9738 (0.020)
Ep: 258, Reward: 867.0567, Test: 848.5182 [71.61], Avg: 392.4638 (0.020)
Ep: 259, Reward: 727.4484, Test: 815.0520 [96.68], Avg: 393.7173 (0.020)
Ep: 260, Reward: 817.4099, Test: 830.4516 [125.19], Avg: 394.9110 (0.020)
Ep: 261, Reward: 861.2986, Test: 875.4930 [24.02], Avg: 396.6536 (0.020)
Ep: 262, Reward: 761.7560, Test: 807.5736 [137.54], Avg: 397.6930 (0.020)
Ep: 263, Reward: 882.6325, Test: 844.0261 [167.08], Avg: 398.7508 (0.020)
Ep: 264, Reward: 807.9991, Test: 814.3583 [165.21], Avg: 399.6957 (0.020)
Ep: 265, Reward: 876.9508, Test: 796.9030 [169.67], Avg: 400.5511 (0.020)
Ep: 266, Reward: 883.8977, Test: 709.5383 [217.52], Avg: 400.8936 (0.020)
Ep: 267, Reward: 912.8803, Test: 871.6775 [71.22], Avg: 402.3845 (0.020)
Ep: 268, Reward: 909.9412, Test: 888.2445 [11.99], Avg: 404.1461 (0.020)
Ep: 269, Reward: 944.3552, Test: 837.6093 [145.07], Avg: 405.2143 (0.020)
Ep: 270, Reward: 915.6583, Test: 897.9502 [14.52], Avg: 406.9789 (0.020)
Ep: 271, Reward: 914.1396, Test: 886.1838 [30.49], Avg: 408.6286 (0.020)
Ep: 272, Reward: 907.6721, Test: 864.3345 [77.24], Avg: 410.0149 (0.020)
Ep: 273, Reward: 796.4286, Test: 814.6013 [137.10], Avg: 410.9911 (0.020)
Ep: 274, Reward: 840.6839, Test: 822.6288 [186.97], Avg: 411.8081 (0.020)
Ep: 275, Reward: 978.0463, Test: 836.1780 [165.76], Avg: 412.7451 (0.020)
Ep: 276, Reward: 883.7028, Test: 855.3903 [46.48], Avg: 414.1753 (0.020)
Ep: 277, Reward: 759.2992, Test: 786.0768 [163.17], Avg: 414.9262 (0.020)
Ep: 278, Reward: 1013.0996, Test: 724.0812 [244.90], Avg: 415.1565 (0.020)
Ep: 279, Reward: 881.1078, Test: 777.8172 [234.99], Avg: 415.6124 (0.020)
Ep: 280, Reward: 782.6272, Test: 820.3773 [163.38], Avg: 416.4714 (0.020)
Ep: 281, Reward: 768.9539, Test: 737.5592 [228.83], Avg: 416.7986 (0.020)
Ep: 282, Reward: 927.8401, Test: 870.8491 [103.05], Avg: 418.0389 (0.020)
Ep: 283, Reward: 931.0425, Test: 785.0334 [208.64], Avg: 418.5965 (0.020)
Ep: 284, Reward: 852.8102, Test: 807.0732 [190.65], Avg: 419.2906 (0.020)
Ep: 285, Reward: 906.4343, Test: 822.2368 [135.01], Avg: 420.2274 (0.020)
Ep: 286, Reward: 901.5966, Test: 740.3861 [191.42], Avg: 420.6760 (0.020)
Ep: 287, Reward: 798.8179, Test: 826.4034 [133.71], Avg: 421.6205 (0.020)
Ep: 288, Reward: 901.7686, Test: 792.0466 [180.48], Avg: 422.2777 (0.020)
Ep: 289, Reward: 733.7985, Test: 854.2572 [105.38], Avg: 423.4040 (0.020)
Ep: 290, Reward: 645.8981, Test: 873.1903 [65.84], Avg: 424.7234 (0.020)
Ep: 291, Reward: 843.3259, Test: 878.2266 [37.40], Avg: 426.1484 (0.020)
Ep: 292, Reward: 936.7199, Test: 878.2479 [67.23], Avg: 427.4619 (0.020)
Ep: 293, Reward: 903.1569, Test: 818.3958 [136.50], Avg: 428.3274 (0.020)
Ep: 294, Reward: 936.3383, Test: 889.3946 [22.26], Avg: 429.8149 (0.020)
Ep: 295, Reward: 791.0888, Test: 906.8974 [18.22], Avg: 431.3651 (0.020)
Ep: 296, Reward: 864.2060, Test: 887.4058 [27.21], Avg: 432.8089 (0.020)
Ep: 297, Reward: 952.1954, Test: 853.2243 [97.14], Avg: 433.8938 (0.020)
Ep: 298, Reward: 951.3626, Test: 817.3869 [162.31], Avg: 434.6335 (0.020)
Ep: 299, Reward: 928.5629, Test: 891.0878 [26.13], Avg: 436.0679 (0.020)
Ep: 300, Reward: 866.3234, Test: 774.5114 [176.14], Avg: 436.6071 (0.020)
Ep: 301, Reward: 823.9043, Test: 728.8898 [198.47], Avg: 436.9178 (0.020)
Ep: 302, Reward: 774.3636, Test: 818.5076 [153.52], Avg: 437.6705 (0.020)
Ep: 303, Reward: 873.5668, Test: 876.5372 [43.20], Avg: 438.9720 (0.020)
Ep: 304, Reward: 884.8761, Test: 826.7214 [102.76], Avg: 439.9064 (0.020)
Ep: 305, Reward: 905.8706, Test: 870.4422 [29.54], Avg: 441.2168 (0.020)
Ep: 306, Reward: 952.1886, Test: 804.6566 [132.36], Avg: 441.9696 (0.020)
Ep: 307, Reward: 859.2802, Test: 876.6932 [32.98], Avg: 443.2739 (0.020)
Ep: 308, Reward: 833.1288, Test: 870.7355 [25.89], Avg: 444.5735 (0.020)
Ep: 309, Reward: 820.4254, Test: 797.1988 [152.12], Avg: 445.2203 (0.020)
Ep: 310, Reward: 798.4977, Test: 761.0168 [188.82], Avg: 445.6286 (0.020)
Ep: 311, Reward: 842.3124, Test: 730.6051 [289.02], Avg: 445.6156 (0.020)
Ep: 312, Reward: 913.2218, Test: 776.1252 [146.02], Avg: 446.2050 (0.020)
Ep: 313, Reward: 815.9469, Test: 825.4197 [121.58], Avg: 447.0255 (0.020)
Ep: 314, Reward: 738.0756, Test: 844.5687 [63.41], Avg: 448.0862 (0.020)
Ep: 315, Reward: 760.9913, Test: 837.9751 [111.10], Avg: 448.9685 (0.020)
Ep: 316, Reward: 806.1745, Test: 683.7686 [235.92], Avg: 448.9650 (0.020)
Ep: 317, Reward: 810.1665, Test: 866.3802 [87.23], Avg: 450.0033 (0.020)
Ep: 318, Reward: 893.0979, Test: 766.8967 [140.31], Avg: 450.5568 (0.020)
Ep: 319, Reward: 872.5310, Test: 873.7773 [21.01], Avg: 451.8137 (0.020)
Ep: 320, Reward: 785.1237, Test: 733.9194 [182.08], Avg: 452.1253 (0.020)
Ep: 321, Reward: 755.4658, Test: 824.9597 [91.37], Avg: 452.9995 (0.020)
Ep: 322, Reward: 843.4202, Test: 757.9210 [172.97], Avg: 453.4080 (0.020)
Ep: 323, Reward: 832.7327, Test: 847.9490 [70.07], Avg: 454.4094 (0.020)
Ep: 324, Reward: 815.6954, Test: 839.2592 [68.90], Avg: 455.3816 (0.020)
Ep: 325, Reward: 817.0642, Test: 735.4614 [205.43], Avg: 455.6106 (0.020)
Ep: 326, Reward: 878.8449, Test: 769.4250 [165.09], Avg: 456.0654 (0.020)
Ep: 327, Reward: 816.1522, Test: 845.8359 [115.00], Avg: 456.9031 (0.020)
Ep: 328, Reward: 809.8057, Test: 868.0720 [63.48], Avg: 457.9599 (0.020)
Ep: 329, Reward: 924.4436, Test: 844.5082 [78.98], Avg: 458.8919 (0.020)
Ep: 330, Reward: 930.2646, Test: 855.2405 [98.01], Avg: 459.7932 (0.020)
Ep: 331, Reward: 863.6156, Test: 867.6585 [83.77], Avg: 460.7694 (0.020)
Ep: 332, Reward: 967.8707, Test: 895.2153 [20.66], Avg: 462.0120 (0.020)
Ep: 333, Reward: 885.9897, Test: 854.6363 [78.72], Avg: 462.9518 (0.020)
Ep: 334, Reward: 909.8807, Test: 847.9797 [110.30], Avg: 463.7719 (0.020)
Ep: 335, Reward: 877.1362, Test: 730.5066 [209.85], Avg: 463.9412 (0.020)
Ep: 336, Reward: 844.1144, Test: 808.8850 [113.33], Avg: 464.6285 (0.020)
Ep: 337, Reward: 877.0496, Test: 843.5740 [104.12], Avg: 465.4416 (0.020)
Ep: 338, Reward: 866.1999, Test: 867.0669 [35.47], Avg: 466.5217 (0.020)
Ep: 339, Reward: 940.0246, Test: 882.6226 [20.59], Avg: 467.6850 (0.020)
Ep: 340, Reward: 847.7558, Test: 813.4869 [117.13], Avg: 468.3556 (0.020)
Ep: 341, Reward: 953.9376, Test: 804.8795 [147.01], Avg: 468.9097 (0.020)
Ep: 342, Reward: 801.8983, Test: 814.5806 [137.53], Avg: 469.5165 (0.020)
Ep: 343, Reward: 974.5529, Test: 829.8435 [106.28], Avg: 470.2550 (0.020)
Ep: 344, Reward: 841.9018, Test: 731.8607 [268.52], Avg: 470.2350 (0.020)
Ep: 345, Reward: 751.3368, Test: 759.1076 [148.94], Avg: 470.6394 (0.020)
Ep: 346, Reward: 808.6268, Test: 863.5803 [46.12], Avg: 471.6389 (0.020)
Ep: 347, Reward: 817.3109, Test: 849.7172 [111.16], Avg: 472.4059 (0.020)
Ep: 348, Reward: 892.4651, Test: 768.0254 [188.03], Avg: 472.7142 (0.020)
Ep: 349, Reward: 894.6279, Test: 793.9569 [131.97], Avg: 473.2550 (0.020)
Ep: 350, Reward: 828.8958, Test: 861.6166 [72.96], Avg: 474.1535 (0.020)
Ep: 351, Reward: 842.6291, Test: 745.5285 [215.03], Avg: 474.3136 (0.020)
Ep: 352, Reward: 876.3366, Test: 757.9497 [170.15], Avg: 474.6351 (0.020)
Ep: 353, Reward: 852.1088, Test: 850.7324 [114.56], Avg: 475.3739 (0.020)
Ep: 354, Reward: 799.9751, Test: 863.7827 [88.98], Avg: 476.2173 (0.020)
Ep: 355, Reward: 833.7010, Test: 801.4040 [197.99], Avg: 476.5746 (0.020)
Ep: 356, Reward: 872.5013, Test: 813.3740 [60.14], Avg: 477.3496 (0.020)
Ep: 357, Reward: 789.7532, Test: 718.7956 [223.95], Avg: 477.3985 (0.020)
Ep: 358, Reward: 801.8232, Test: 816.9079 [177.56], Avg: 477.8496 (0.020)
Ep: 359, Reward: 888.0485, Test: 764.2030 [174.41], Avg: 478.1605 (0.020)
Ep: 360, Reward: 860.2023, Test: 889.6262 [27.03], Avg: 479.2254 (0.020)
Ep: 361, Reward: 838.3372, Test: 798.5721 [209.75], Avg: 479.5282 (0.020)
Ep: 362, Reward: 853.3874, Test: 798.2370 [147.10], Avg: 480.0009 (0.020)
Ep: 363, Reward: 866.0175, Test: 782.6498 [209.79], Avg: 480.2560 (0.020)
Ep: 364, Reward: 812.6995, Test: 693.9775 [295.64], Avg: 480.0316 (0.020)
Ep: 365, Reward: 839.4168, Test: 786.2532 [211.42], Avg: 480.2906 (0.020)
Ep: 366, Reward: 928.6016, Test: 781.8319 [95.44], Avg: 480.8522 (0.020)
Ep: 367, Reward: 879.3826, Test: 754.3787 [280.52], Avg: 480.8332 (0.020)
Ep: 368, Reward: 915.5266, Test: 687.5095 [271.60], Avg: 480.6572 (0.020)
Ep: 369, Reward: 931.6902, Test: 683.3558 [313.83], Avg: 480.3569 (0.020)
Ep: 370, Reward: 644.1352, Test: 579.2418 [282.69], Avg: 479.8614 (0.020)
Ep: 371, Reward: 895.5081, Test: 734.7745 [217.71], Avg: 479.9615 (0.020)
Ep: 372, Reward: 885.7229, Test: 619.5090 [316.18], Avg: 479.4879 (0.020)
Ep: 373, Reward: 748.7112, Test: 692.4451 [205.50], Avg: 479.5079 (0.020)
Ep: 374, Reward: 783.9056, Test: 786.5594 [144.35], Avg: 479.9417 (0.020)
Ep: 375, Reward: 704.5025, Test: 729.6266 [188.08], Avg: 480.1056 (0.020)
Ep: 376, Reward: 813.7300, Test: 627.9571 [274.37], Avg: 479.7700 (0.020)
Ep: 377, Reward: 865.0727, Test: 719.0580 [160.42], Avg: 479.9786 (0.020)
Ep: 378, Reward: 839.9459, Test: 724.9660 [212.21], Avg: 480.0651 (0.020)
Ep: 379, Reward: 892.2402, Test: 809.6026 [148.01], Avg: 480.5428 (0.020)
Ep: 380, Reward: 888.4184, Test: 795.6547 [133.47], Avg: 481.0196 (0.020)
Ep: 381, Reward: 757.7704, Test: 838.8269 [62.27], Avg: 481.7932 (0.020)
Ep: 382, Reward: 877.3391, Test: 843.1072 [62.13], Avg: 482.5744 (0.020)
Ep: 383, Reward: 866.4218, Test: 825.4882 [100.94], Avg: 483.2045 (0.020)
Ep: 384, Reward: 801.5852, Test: 674.8886 [267.32], Avg: 483.0081 (0.020)
Ep: 385, Reward: 871.3416, Test: 815.3923 [167.44], Avg: 483.4354 (0.020)
Ep: 386, Reward: 894.1856, Test: 726.3851 [236.65], Avg: 483.4517 (0.020)
Ep: 387, Reward: 851.3349, Test: 685.2445 [277.35], Avg: 483.2569 (0.020)
Ep: 388, Reward: 714.0176, Test: 812.1490 [151.43], Avg: 483.7131 (0.020)
Ep: 389, Reward: 871.7282, Test: 804.9722 [165.68], Avg: 484.1120 (0.020)
Ep: 390, Reward: 885.7840, Test: 840.9978 [77.66], Avg: 484.8262 (0.020)
Ep: 391, Reward: 751.2542, Test: 849.1063 [119.96], Avg: 485.4494 (0.020)
Ep: 392, Reward: 890.8473, Test: 801.0750 [200.87], Avg: 485.7414 (0.020)
Ep: 393, Reward: 844.2453, Test: 888.5420 [13.26], Avg: 486.7301 (0.020)
Ep: 394, Reward: 909.3336, Test: 844.7653 [93.65], Avg: 487.3994 (0.020)
Ep: 395, Reward: 599.9687, Test: 824.4858 [169.19], Avg: 487.8234 (0.020)
Ep: 396, Reward: 827.9056, Test: 796.4543 [167.05], Avg: 488.1800 (0.020)
Ep: 397, Reward: 810.6649, Test: 809.7917 [154.40], Avg: 488.6002 (0.020)
Ep: 398, Reward: 775.2068, Test: 787.7535 [213.25], Avg: 488.8155 (0.020)
Ep: 399, Reward: 863.2924, Test: 850.1099 [66.36], Avg: 489.5528 (0.020)
Ep: 400, Reward: 1048.1022, Test: 887.9324 [21.50], Avg: 490.4927 (0.020)
Ep: 401, Reward: 890.9444, Test: 862.5134 [25.79], Avg: 491.3539 (0.020)
Ep: 402, Reward: 850.7785, Test: 785.5679 [178.34], Avg: 491.6415 (0.020)
Ep: 403, Reward: 888.7944, Test: 823.1826 [136.72], Avg: 492.1237 (0.020)
Ep: 404, Reward: 946.1435, Test: 895.1220 [18.68], Avg: 493.0726 (0.020)
Ep: 405, Reward: 865.3939, Test: 850.0673 [95.77], Avg: 493.7160 (0.020)
Ep: 406, Reward: 875.2034, Test: 797.5425 [185.85], Avg: 494.0059 (0.020)
Ep: 407, Reward: 943.9420, Test: 847.9529 [92.86], Avg: 494.6458 (0.020)
Ep: 408, Reward: 954.5318, Test: 781.8663 [186.21], Avg: 494.8928 (0.020)
Ep: 409, Reward: 869.7711, Test: 762.9783 [248.75], Avg: 494.9399 (0.020)
Ep: 410, Reward: 790.4120, Test: 737.1189 [186.47], Avg: 495.0755 (0.020)
Ep: 411, Reward: 801.4927, Test: 793.0948 [168.41], Avg: 495.3901 (0.020)
Ep: 412, Reward: 764.2987, Test: 879.9693 [31.46], Avg: 496.2451 (0.020)
Ep: 413, Reward: 789.5599, Test: 826.3476 [186.00], Avg: 496.5932 (0.020)
Ep: 414, Reward: 877.7613, Test: 873.9303 [45.88], Avg: 497.3918 (0.020)
Ep: 415, Reward: 948.0193, Test: 835.7465 [118.13], Avg: 497.9212 (0.020)
Ep: 416, Reward: 863.0544, Test: 825.6780 [161.22], Avg: 498.3206 (0.020)
Ep: 417, Reward: 887.2230, Test: 850.3104 [92.83], Avg: 498.9406 (0.020)
Ep: 418, Reward: 877.2234, Test: 684.3647 [186.91], Avg: 498.9370 (0.020)
Ep: 419, Reward: 802.2759, Test: 814.5299 [152.54], Avg: 499.3253 (0.020)
Ep: 420, Reward: 819.7232, Test: 779.8499 [117.32], Avg: 499.7129 (0.020)
Ep: 421, Reward: 725.1094, Test: 534.0651 [351.29], Avg: 498.9619 (0.020)
Ep: 422, Reward: 681.2942, Test: 849.8313 [90.55], Avg: 499.5773 (0.020)
Ep: 423, Reward: 820.9146, Test: 880.0294 [19.12], Avg: 500.4295 (0.020)
Ep: 424, Reward: 828.1227, Test: 872.3136 [20.20], Avg: 501.2570 (0.020)
Ep: 425, Reward: 882.8453, Test: 800.1158 [95.43], Avg: 501.7345 (0.020)
Ep: 426, Reward: 817.3166, Test: 813.0091 [219.82], Avg: 501.9487 (0.020)
Ep: 427, Reward: 783.0933, Test: 865.3439 [65.23], Avg: 502.6453 (0.020)
Ep: 428, Reward: 883.0778, Test: 883.7946 [44.22], Avg: 503.4307 (0.020)
Ep: 429, Reward: 881.5107, Test: 831.7535 [138.37], Avg: 503.8725 (0.020)
Ep: 430, Reward: 916.6800, Test: 870.9745 [25.55], Avg: 504.6650 (0.020)
Ep: 431, Reward: 925.7066, Test: 843.0268 [84.25], Avg: 505.2532 (0.020)
Ep: 432, Reward: 841.6688, Test: 893.8114 [18.83], Avg: 506.1070 (0.020)
Ep: 433, Reward: 949.4661, Test: 896.7202 [24.05], Avg: 506.9517 (0.020)
Ep: 434, Reward: 896.6867, Test: 864.2295 [79.94], Avg: 507.5892 (0.020)
Ep: 435, Reward: 915.3864, Test: 840.0915 [110.88], Avg: 508.0975 (0.020)
Ep: 436, Reward: 971.8682, Test: 891.4376 [18.06], Avg: 508.9334 (0.020)
Ep: 437, Reward: 901.0500, Test: 835.6840 [95.33], Avg: 509.4618 (0.020)
Ep: 438, Reward: 896.8696, Test: 833.0166 [110.09], Avg: 509.9480 (0.020)
Ep: 439, Reward: 905.2476, Test: 862.3280 [45.55], Avg: 510.6454 (0.020)
Ep: 440, Reward: 904.0712, Test: 879.8911 [29.89], Avg: 511.4149 (0.020)
Ep: 441, Reward: 841.2488, Test: 801.9097 [136.25], Avg: 511.7638 (0.020)
Ep: 442, Reward: 889.1338, Test: 850.1211 [97.02], Avg: 512.3086 (0.020)
Ep: 443, Reward: 874.5682, Test: 880.0251 [13.69], Avg: 513.1060 (0.020)
Ep: 444, Reward: 879.4033, Test: 838.6552 [31.00], Avg: 513.7679 (0.020)
Ep: 445, Reward: 880.7039, Test: 808.4445 [114.51], Avg: 514.1718 (0.020)
Ep: 446, Reward: 850.5271, Test: 837.2973 [141.56], Avg: 514.5780 (0.020)
Ep: 447, Reward: 798.4212, Test: 889.6626 [31.57], Avg: 515.3448 (0.020)
Ep: 448, Reward: 885.0321, Test: 887.2002 [18.77], Avg: 516.1312 (0.020)
Ep: 449, Reward: 874.9775, Test: 824.2717 [196.26], Avg: 516.3798 (0.020)
Ep: 450, Reward: 841.3268, Test: 879.9139 [23.08], Avg: 517.1347 (0.020)
Ep: 451, Reward: 923.5935, Test: 839.8373 [88.76], Avg: 517.6523 (0.020)
Ep: 452, Reward: 891.5809, Test: 850.7145 [83.73], Avg: 518.2027 (0.020)
Ep: 453, Reward: 842.6341, Test: 817.5390 [191.09], Avg: 518.4411 (0.020)
Ep: 454, Reward: 830.6384, Test: 853.8916 [72.72], Avg: 519.0186 (0.020)
Ep: 455, Reward: 854.9513, Test: 817.8043 [157.07], Avg: 519.3293 (0.020)
Ep: 456, Reward: 887.8188, Test: 859.7963 [88.88], Avg: 519.8799 (0.020)
Ep: 457, Reward: 851.2319, Test: 898.1454 [21.72], Avg: 520.6584 (0.020)
Ep: 458, Reward: 871.2350, Test: 879.8622 [10.60], Avg: 521.4178 (0.020)
Ep: 459, Reward: 860.9999, Test: 846.5758 [16.81], Avg: 522.0882 (0.020)
Ep: 460, Reward: 863.5630, Test: 880.5437 [18.61], Avg: 522.8254 (0.020)
Ep: 461, Reward: 884.0941, Test: 864.6001 [30.64], Avg: 523.4988 (0.020)
Ep: 462, Reward: 783.4129, Test: 853.6391 [35.68], Avg: 524.1348 (0.020)
Ep: 463, Reward: 869.3093, Test: 786.8634 [158.39], Avg: 524.3597 (0.020)
Ep: 464, Reward: 834.7488, Test: 812.4765 [137.41], Avg: 524.6837 (0.020)
Ep: 465, Reward: 875.8273, Test: 879.3787 [17.45], Avg: 525.4074 (0.020)
Ep: 466, Reward: 860.7263, Test: 857.4064 [58.64], Avg: 525.9928 (0.020)
Ep: 467, Reward: 884.5506, Test: 881.3974 [21.01], Avg: 526.7073 (0.020)
Ep: 468, Reward: 870.8267, Test: 878.2967 [15.16], Avg: 527.4246 (0.020)
Ep: 469, Reward: 810.5741, Test: 854.4288 [79.17], Avg: 527.9520 (0.020)
Ep: 470, Reward: 848.8353, Test: 840.9528 [87.38], Avg: 528.4310 (0.020)
Ep: 471, Reward: 829.1159, Test: 802.2969 [153.60], Avg: 528.6858 (0.020)
Ep: 472, Reward: 905.2430, Test: 790.9831 [231.44], Avg: 528.7510 (0.020)
Ep: 473, Reward: 887.6375, Test: 848.7439 [74.04], Avg: 529.2699 (0.020)
Ep: 474, Reward: 937.8849, Test: 885.2931 [24.26], Avg: 529.9684 (0.020)
Ep: 475, Reward: 920.6668, Test: 864.6061 [94.97], Avg: 530.4719 (0.020)
Ep: 476, Reward: 910.2163, Test: 847.3989 [66.66], Avg: 530.9965 (0.020)
Ep: 477, Reward: 909.4879, Test: 854.8407 [73.81], Avg: 531.5196 (0.020)
Ep: 478, Reward: 855.9893, Test: 775.3340 [202.78], Avg: 531.6053 (0.020)
Ep: 479, Reward: 894.5459, Test: 847.6816 [73.30], Avg: 532.1111 (0.020)
Ep: 480, Reward: 885.7002, Test: 839.8200 [99.98], Avg: 532.5429 (0.020)
Ep: 481, Reward: 818.9710, Test: 848.7910 [82.10], Avg: 533.0287 (0.020)
Ep: 482, Reward: 799.4616, Test: 857.3035 [84.67], Avg: 533.5248 (0.020)
Ep: 483, Reward: 848.7145, Test: 862.3224 [64.72], Avg: 534.0704 (0.020)
Ep: 484, Reward: 915.6599, Test: 887.4474 [18.56], Avg: 534.7607 (0.020)
Ep: 485, Reward: 881.5132, Test: 837.0635 [111.00], Avg: 535.1544 (0.020)
Ep: 486, Reward: 888.2920, Test: 863.5429 [16.39], Avg: 535.7950 (0.020)
Ep: 487, Reward: 880.6126, Test: 878.3870 [21.62], Avg: 536.4527 (0.020)
Ep: 488, Reward: 879.7770, Test: 822.6422 [118.71], Avg: 536.7952 (0.020)
Ep: 489, Reward: 875.5625, Test: 880.0620 [20.24], Avg: 537.4545 (0.020)
Ep: 490, Reward: 883.1013, Test: 868.4017 [22.90], Avg: 538.0819 (0.020)
Ep: 491, Reward: 887.3985, Test: 888.3432 [14.03], Avg: 538.7653 (0.020)
Ep: 492, Reward: 860.4774, Test: 878.6348 [12.82], Avg: 539.4287 (0.020)
Ep: 493, Reward: 853.1889, Test: 879.8287 [16.08], Avg: 540.0852 (0.020)
Ep: 494, Reward: 897.1134, Test: 812.6539 [135.63], Avg: 540.3618 (0.020)
Ep: 495, Reward: 847.3737, Test: 882.9894 [7.61], Avg: 541.0373 (0.020)
Ep: 496, Reward: 839.8218, Test: 817.9738 [180.65], Avg: 541.2310 (0.020)
Ep: 497, Reward: 854.1480, Test: 708.0432 [273.47], Avg: 541.0168 (0.020)
Ep: 498, Reward: 784.6331, Test: 668.6894 [221.96], Avg: 540.8279 (0.020)
Ep: 499, Reward: 866.7477, Test: 779.5858 [151.11], Avg: 541.0031 (0.020)
