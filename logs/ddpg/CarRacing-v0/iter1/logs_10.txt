Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 32,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.0225               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -53.5639, Test: -65.3932 [15.65], Avg: -81.0407 (0.980)
Ep: 1, Reward: -64.4099, Test: -58.1842 [16.19], Avg: -77.7097 (0.960)
Ep: 2, Reward: -53.1937, Test: -52.8527 [18.98], Avg: -75.7494 (0.941)
Ep: 3, Reward: -54.1072, Test: -63.1184 [15.82], Avg: -76.5474 (0.922)
Ep: 4, Reward: -50.0651, Test: -64.4265 [16.70], Avg: -77.4625 (0.904)
Ep: 5, Reward: -45.4443, Test: -58.5659 [12.06], Avg: -76.3228 (0.886)
Ep: 6, Reward: -58.3269, Test: -65.8967 [10.61], Avg: -76.3494 (0.868)
Ep: 7, Reward: -53.4053, Test: -46.6410 [24.56], Avg: -75.7065 (0.851)
Ep: 8, Reward: -61.6236, Test: -54.0492 [22.61], Avg: -75.8121 (0.834)
Ep: 9, Reward: -61.6341, Test: -45.3645 [20.38], Avg: -74.8049 (0.817)
Ep: 10, Reward: -62.4863, Test: -60.6211 [22.31], Avg: -75.5436 (0.801)
Ep: 11, Reward: -52.0765, Test: -45.2678 [23.68], Avg: -74.9941 (0.785)
Ep: 12, Reward: -53.4097, Test: -39.4084 [20.05], Avg: -73.7992 (0.769)
Ep: 13, Reward: -66.8904, Test: -55.0819 [22.41], Avg: -74.0627 (0.754)
Ep: 14, Reward: -49.6393, Test: -58.4605 [14.41], Avg: -73.9832 (0.739)
Ep: 15, Reward: -56.1011, Test: -49.1442 [23.46], Avg: -73.8968 (0.724)
Ep: 16, Reward: -52.8724, Test: -63.1452 [20.68], Avg: -74.4809 (0.709)
Ep: 17, Reward: -59.3279, Test: -33.0016 [23.96], Avg: -73.5076 (0.695)
Ep: 18, Reward: -50.6031, Test: -38.6111 [22.41], Avg: -72.8506 (0.681)
Ep: 19, Reward: -48.9530, Test: -48.7436 [22.42], Avg: -72.7661 (0.668)
Ep: 20, Reward: -53.8749, Test: -68.3567 [48.14], Avg: -74.8486 (0.654)
Ep: 21, Reward: -50.2764, Test: -58.0774 [33.75], Avg: -75.6203 (0.641)
Ep: 22, Reward: -42.5967, Test: -14.4838 [33.05], Avg: -74.3993 (0.628)
Ep: 23, Reward: -40.2775, Test: -34.8199 [42.67], Avg: -74.5282 (0.616)
Ep: 24, Reward: -46.9073, Test: -62.2762 [72.78], Avg: -76.9493 (0.603)
Ep: 25, Reward: -58.2798, Test: -40.5428 [40.11], Avg: -77.0918 (0.591)
Ep: 26, Reward: -28.9805, Test: -56.7365 [53.70], Avg: -78.3268 (0.580)
Ep: 27, Reward: -40.7009, Test: -24.7818 [26.53], Avg: -77.3620 (0.568)
Ep: 28, Reward: -25.3640, Test: 2.9245 [50.82], Avg: -76.3460 (0.557)
Ep: 29, Reward: -19.9523, Test: -9.0603 [56.82], Avg: -75.9973 (0.545)
Ep: 30, Reward: -9.7574, Test: -15.2710 [50.92], Avg: -75.6809 (0.535)
Ep: 31, Reward: -2.6040, Test: -48.9074 [40.81], Avg: -76.1195 (0.524)
Ep: 32, Reward: -38.7307, Test: -13.6770 [47.65], Avg: -75.6714 (0.513)
Ep: 33, Reward: -10.1087, Test: -22.7973 [38.83], Avg: -75.2582 (0.503)
Ep: 34, Reward: 8.0142, Test: 82.9918 [81.91], Avg: -73.0770 (0.493)
Ep: 35, Reward: 12.5353, Test: 0.6333 [52.09], Avg: -72.4765 (0.483)
Ep: 36, Reward: 16.2107, Test: 16.9575 [73.86], Avg: -72.0555 (0.474)
Ep: 37, Reward: 45.5612, Test: 62.2679 [110.92], Avg: -71.4395 (0.464)
Ep: 38, Reward: 24.6718, Test: 53.7604 [139.16], Avg: -71.7975 (0.455)
Ep: 39, Reward: 38.2809, Test: 39.7419 [69.96], Avg: -70.7581 (0.446)
Ep: 40, Reward: 54.8965, Test: 49.0863 [125.03], Avg: -70.8845 (0.437)
Ep: 41, Reward: 12.3775, Test: 18.3138 [47.31], Avg: -69.8871 (0.428)
Ep: 42, Reward: 24.8676, Test: 22.6533 [48.59], Avg: -68.8649 (0.419)
Ep: 43, Reward: 12.6073, Test: 18.0931 [81.35], Avg: -68.7374 (0.411)
Ep: 44, Reward: 82.0969, Test: 94.8717 [129.40], Avg: -67.9772 (0.403)
Ep: 45, Reward: 46.4463, Test: 26.8949 [138.90], Avg: -68.9343 (0.395)
Ep: 46, Reward: 83.1327, Test: 3.8604 [76.56], Avg: -69.0145 (0.387)
Ep: 47, Reward: 62.5106, Test: 121.0659 [156.01], Avg: -68.3048 (0.379)
Ep: 48, Reward: 102.1777, Test: 67.7542 [146.97], Avg: -68.5274 (0.372)
Ep: 49, Reward: 34.5312, Test: 53.0106 [96.62], Avg: -68.0290 (0.364)
Ep: 50, Reward: 73.1384, Test: 30.9929 [88.33], Avg: -67.8193 (0.357)
Ep: 51, Reward: 59.1741, Test: 86.1610 [147.69], Avg: -67.6984 (0.350)
Ep: 52, Reward: 85.2578, Test: 64.4795 [74.78], Avg: -66.6153 (0.343)
Ep: 53, Reward: 80.6163, Test: 97.2452 [178.88], Avg: -66.8935 (0.336)
Ep: 54, Reward: 142.3307, Test: 84.9963 [120.78], Avg: -66.3278 (0.329)
Ep: 55, Reward: 117.8985, Test: 113.1855 [166.25], Avg: -66.0909 (0.323)
Ep: 56, Reward: 127.2107, Test: 48.6180 [143.90], Avg: -66.6030 (0.316)
Ep: 57, Reward: 141.0954, Test: 195.5767 [181.98], Avg: -65.2202 (0.310)
Ep: 58, Reward: 176.6592, Test: 102.6644 [107.25], Avg: -64.1924 (0.304)
Ep: 59, Reward: 190.0640, Test: 291.6587 [257.88], Avg: -62.5596 (0.298)
Ep: 60, Reward: 209.3897, Test: 211.7445 [244.85], Avg: -62.0767 (0.292)
Ep: 61, Reward: 177.5147, Test: 258.3014 [171.75], Avg: -59.6795 (0.286)
Ep: 62, Reward: 207.4583, Test: 300.7775 [234.48], Avg: -57.6799 (0.280)
Ep: 63, Reward: 248.8457, Test: 259.2950 [233.59], Avg: -56.3770 (0.274)
Ep: 64, Reward: 242.1385, Test: 212.4634 [151.77], Avg: -54.5759 (0.269)
Ep: 65, Reward: 210.5832, Test: 224.8154 [143.72], Avg: -52.5204 (0.264)
Ep: 66, Reward: 188.3245, Test: 245.7217 [272.67], Avg: -52.1387 (0.258)
Ep: 67, Reward: 123.1761, Test: 134.3046 [68.72], Avg: -50.4075 (0.253)
Ep: 68, Reward: 212.6503, Test: 164.1195 [152.70], Avg: -49.5114 (0.248)
Ep: 69, Reward: 177.5077, Test: 232.3892 [156.97], Avg: -47.7267 (0.243)
Ep: 70, Reward: 221.5483, Test: 275.2021 [203.84], Avg: -46.0494 (0.238)
Ep: 71, Reward: 179.1069, Test: 217.1557 [150.63], Avg: -44.4859 (0.233)
Ep: 72, Reward: 179.4556, Test: 129.2108 [160.87], Avg: -44.3102 (0.229)
Ep: 73, Reward: 200.8649, Test: 122.1247 [146.70], Avg: -44.0436 (0.224)
Ep: 74, Reward: 234.3515, Test: 245.4479 [209.19], Avg: -42.9728 (0.220)
Ep: 75, Reward: 245.3839, Test: 270.8905 [96.53], Avg: -40.1132 (0.215)
Ep: 76, Reward: 305.9841, Test: 344.4269 [211.55], Avg: -37.8667 (0.211)
Ep: 77, Reward: 366.9800, Test: 438.2739 [98.80], Avg: -33.0290 (0.207)
Ep: 78, Reward: 365.0229, Test: 410.7346 [247.04], Avg: -30.5388 (0.203)
Ep: 79, Reward: 343.3958, Test: 295.2631 [165.01], Avg: -28.5289 (0.199)
Ep: 80, Reward: 379.0865, Test: 453.3160 [188.32], Avg: -24.9051 (0.195)
Ep: 81, Reward: 454.7003, Test: 417.1927 [223.66], Avg: -22.2412 (0.191)
Ep: 82, Reward: 393.4293, Test: 465.4549 [238.86], Avg: -19.2432 (0.187)
Ep: 83, Reward: 494.0332, Test: 419.6234 [150.46], Avg: -15.8098 (0.183)
Ep: 84, Reward: 428.6510, Test: 452.0359 [231.86], Avg: -13.0334 (0.180)
Ep: 85, Reward: 325.3970, Test: 463.4048 [184.17], Avg: -9.6350 (0.176)
Ep: 86, Reward: 406.2364, Test: 304.2986 [169.05], Avg: -7.9697 (0.172)
Ep: 87, Reward: 362.2241, Test: 554.1422 [199.11], Avg: -3.8448 (0.169)
Ep: 88, Reward: 348.1750, Test: 547.5580 [226.61], Avg: -0.1954 (0.166)
Ep: 89, Reward: 350.0981, Test: 401.2013 [261.85], Avg: 1.3551 (0.162)
Ep: 90, Reward: 425.8749, Test: 453.7091 [292.43], Avg: 3.1125 (0.159)
Ep: 91, Reward: 424.6841, Test: 474.0496 [238.56], Avg: 5.6384 (0.156)
Ep: 92, Reward: 385.2546, Test: 420.9744 [170.50], Avg: 8.2711 (0.153)
Ep: 93, Reward: 340.5062, Test: 395.3751 [260.32], Avg: 9.6198 (0.150)
Ep: 94, Reward: 346.1222, Test: 480.2160 [251.95], Avg: 11.9214 (0.147)
Ep: 95, Reward: 395.8128, Test: 391.7405 [188.46], Avg: 13.9147 (0.144)
Ep: 96, Reward: 410.2341, Test: 526.4868 [202.79], Avg: 17.1083 (0.141)
Ep: 97, Reward: 429.3178, Test: 342.4147 [93.87], Avg: 19.4699 (0.138)
Ep: 98, Reward: 444.3389, Test: 330.5291 [106.18], Avg: 21.5393 (0.135)
Ep: 99, Reward: 386.5698, Test: 441.8099 [225.27], Avg: 23.4893 (0.133)
Ep: 100, Reward: 449.6839, Test: 442.3041 [198.75], Avg: 25.6681 (0.130)
Ep: 101, Reward: 422.6811, Test: 388.2450 [213.44], Avg: 27.1303 (0.127)
Ep: 102, Reward: 459.7800, Test: 278.7432 [152.39], Avg: 28.0937 (0.125)
Ep: 103, Reward: 431.1898, Test: 525.6464 [172.69], Avg: 31.2174 (0.122)
Ep: 104, Reward: 442.0345, Test: 425.0363 [178.33], Avg: 33.2696 (0.120)
Ep: 105, Reward: 440.1460, Test: 381.6341 [183.98], Avg: 34.8205 (0.117)
Ep: 106, Reward: 478.6068, Test: 392.5918 [185.45], Avg: 36.4309 (0.115)
Ep: 107, Reward: 511.7471, Test: 574.8678 [262.13], Avg: 38.9894 (0.113)
Ep: 108, Reward: 478.8688, Test: 479.9065 [212.04], Avg: 41.0891 (0.111)
Ep: 109, Reward: 538.4812, Test: 516.6205 [172.17], Avg: 43.8470 (0.108)
Ep: 110, Reward: 479.9819, Test: 643.1246 [178.35], Avg: 47.6391 (0.106)
Ep: 111, Reward: 573.0684, Test: 510.2681 [208.13], Avg: 49.9115 (0.104)
Ep: 112, Reward: 520.2798, Test: 560.7832 [133.98], Avg: 53.2468 (0.102)
Ep: 113, Reward: 573.5087, Test: 520.4305 [194.12], Avg: 55.6421 (0.100)
Ep: 114, Reward: 491.2428, Test: 453.0889 [182.63], Avg: 57.5101 (0.098)
Ep: 115, Reward: 546.9930, Test: 474.7410 [184.28], Avg: 59.5182 (0.096)
Ep: 116, Reward: 398.3157, Test: 342.7421 [147.73], Avg: 60.6763 (0.094)
Ep: 117, Reward: 388.8108, Test: 330.6535 [136.28], Avg: 61.8094 (0.092)
Ep: 118, Reward: 404.5191, Test: 356.4039 [138.27], Avg: 63.1230 (0.090)
Ep: 119, Reward: 322.5530, Test: 364.8250 [212.11], Avg: 63.8696 (0.089)
Ep: 120, Reward: 394.6669, Test: 373.3381 [216.74], Avg: 64.6359 (0.087)
Ep: 121, Reward: 395.6096, Test: 453.3490 [173.53], Avg: 66.3997 (0.085)
Ep: 122, Reward: 478.5431, Test: 389.2736 [113.33], Avg: 68.1034 (0.083)
Ep: 123, Reward: 485.2950, Test: 455.1272 [177.63], Avg: 69.7920 (0.082)
Ep: 124, Reward: 462.2955, Test: 535.5175 [147.99], Avg: 72.3339 (0.080)
Ep: 125, Reward: 533.4705, Test: 518.4427 [164.07], Avg: 74.5723 (0.078)
Ep: 126, Reward: 458.2064, Test: 523.4483 [135.42], Avg: 77.0405 (0.077)
Ep: 127, Reward: 481.8089, Test: 498.2935 [203.33], Avg: 78.7430 (0.075)
Ep: 128, Reward: 466.4507, Test: 388.6100 [175.65], Avg: 79.7835 (0.074)
Ep: 129, Reward: 551.9006, Test: 472.0449 [217.90], Avg: 81.1247 (0.072)
Ep: 130, Reward: 436.9337, Test: 566.6527 [308.64], Avg: 82.4750 (0.071)
Ep: 131, Reward: 533.2329, Test: 480.7608 [273.75], Avg: 83.4184 (0.069)
Ep: 132, Reward: 374.4137, Test: 460.8853 [289.51], Avg: 84.0797 (0.068)
Ep: 133, Reward: 398.3910, Test: 399.1329 [224.94], Avg: 84.7522 (0.067)
Ep: 134, Reward: 517.4895, Test: 357.1774 [167.89], Avg: 85.5266 (0.065)
Ep: 135, Reward: 443.7684, Test: 372.5279 [265.26], Avg: 85.6865 (0.064)
Ep: 136, Reward: 443.5410, Test: 441.4595 [279.46], Avg: 86.2435 (0.063)
Ep: 137, Reward: 505.1089, Test: 467.2948 [223.29], Avg: 87.3867 (0.062)
Ep: 138, Reward: 516.3407, Test: 434.6239 [258.68], Avg: 88.0237 (0.060)
Ep: 139, Reward: 347.9133, Test: 380.4326 [206.00], Avg: 88.6409 (0.059)
Ep: 140, Reward: 526.2313, Test: 500.6903 [179.55], Avg: 90.2898 (0.058)
Ep: 141, Reward: 550.8045, Test: 765.2009 [133.70], Avg: 94.1012 (0.057)
Ep: 142, Reward: 554.8381, Test: 644.3820 [232.31], Avg: 96.3247 (0.056)
Ep: 143, Reward: 543.7482, Test: 558.9846 [262.41], Avg: 97.7154 (0.055)
Ep: 144, Reward: 623.5804, Test: 577.6684 [248.66], Avg: 99.3105 (0.053)
Ep: 145, Reward: 547.8848, Test: 534.3088 [128.62], Avg: 101.4090 (0.052)
Ep: 146, Reward: 645.0283, Test: 596.5122 [256.09], Avg: 103.0349 (0.051)
Ep: 147, Reward: 580.3195, Test: 510.3758 [224.07], Avg: 104.2733 (0.050)
Ep: 148, Reward: 493.7238, Test: 499.1583 [220.18], Avg: 105.4458 (0.049)
Ep: 149, Reward: 458.7567, Test: 362.1216 [247.46], Avg: 105.5072 (0.048)
Ep: 150, Reward: 398.4462, Test: 580.5934 [246.89], Avg: 107.0185 (0.047)
Ep: 151, Reward: 467.3753, Test: 437.5450 [262.54], Avg: 107.4658 (0.046)
Ep: 152, Reward: 414.6110, Test: 549.6945 [132.33], Avg: 109.4913 (0.045)
Ep: 153, Reward: 484.1269, Test: 565.1152 [173.23], Avg: 111.3250 (0.045)
Ep: 154, Reward: 502.9657, Test: 557.0878 [261.20], Avg: 112.5157 (0.044)
Ep: 155, Reward: 419.9335, Test: 369.7273 [187.16], Avg: 112.9648 (0.043)
Ep: 156, Reward: 389.9187, Test: 429.0742 [237.28], Avg: 113.4669 (0.042)
Ep: 157, Reward: 296.3253, Test: 256.7039 [167.64], Avg: 113.3124 (0.041)
Ep: 158, Reward: 381.5881, Test: 393.3467 [209.50], Avg: 113.7560 (0.040)
Ep: 159, Reward: 314.1134, Test: 343.0740 [171.35], Avg: 114.1183 (0.039)
Ep: 160, Reward: 455.8321, Test: 262.7653 [172.70], Avg: 113.9689 (0.039)
Ep: 161, Reward: 417.5552, Test: 515.3878 [247.54], Avg: 114.9188 (0.038)
Ep: 162, Reward: 461.7951, Test: 335.3717 [179.21], Avg: 115.1718 (0.037)
Ep: 163, Reward: 424.1564, Test: 566.5452 [166.01], Avg: 116.9119 (0.036)
Ep: 164, Reward: 289.4533, Test: 387.8939 [170.89], Avg: 117.5185 (0.036)
Ep: 165, Reward: 293.3564, Test: 220.2659 [125.55], Avg: 117.3811 (0.035)
Ep: 166, Reward: 341.3292, Test: 460.9728 [213.26], Avg: 118.1616 (0.034)
Ep: 167, Reward: 290.3140, Test: 373.2204 [194.10], Avg: 118.5244 (0.034)
Ep: 168, Reward: 308.2466, Test: 414.0132 [203.10], Avg: 119.0711 (0.033)
Ep: 169, Reward: 316.0483, Test: 357.9066 [172.15], Avg: 119.4633 (0.032)
Ep: 170, Reward: 367.9102, Test: 344.0775 [103.88], Avg: 120.1694 (0.032)
Ep: 171, Reward: 330.9177, Test: 399.8575 [139.06], Avg: 120.9870 (0.031)
Ep: 172, Reward: 331.5604, Test: 343.9884 [185.70], Avg: 121.2026 (0.030)
Ep: 173, Reward: 301.1785, Test: 422.7179 [178.49], Avg: 121.9096 (0.030)
Ep: 174, Reward: 323.9783, Test: 379.7863 [166.46], Avg: 122.4320 (0.029)
Ep: 175, Reward: 396.2489, Test: 367.9066 [108.16], Avg: 123.2122 (0.029)
Ep: 176, Reward: 403.2879, Test: 343.0067 [128.85], Avg: 123.7260 (0.028)
Ep: 177, Reward: 479.7653, Test: 384.9775 [144.70], Avg: 124.3808 (0.027)
Ep: 178, Reward: 411.8368, Test: 535.7051 [201.40], Avg: 125.5536 (0.027)
Ep: 179, Reward: 423.5296, Test: 473.4328 [109.12], Avg: 126.8800 (0.026)
Ep: 180, Reward: 425.0010, Test: 485.5997 [156.37], Avg: 127.9980 (0.026)
Ep: 181, Reward: 532.8502, Test: 428.9818 [192.92], Avg: 128.5917 (0.025)
Ep: 182, Reward: 495.9641, Test: 423.9571 [191.63], Avg: 129.1586 (0.025)
Ep: 183, Reward: 466.6568, Test: 485.9308 [128.70], Avg: 130.3981 (0.024)
Ep: 184, Reward: 360.1063, Test: 401.8672 [185.42], Avg: 130.8633 (0.024)
Ep: 185, Reward: 351.0417, Test: 369.4451 [169.59], Avg: 131.2342 (0.023)
Ep: 186, Reward: 351.5776, Test: 433.1482 [190.15], Avg: 131.8319 (0.023)
Ep: 187, Reward: 440.6068, Test: 254.2093 [184.04], Avg: 131.5039 (0.022)
Ep: 188, Reward: 433.6682, Test: 372.2862 [200.71], Avg: 131.7159 (0.022)
Ep: 189, Reward: 421.4532, Test: 375.0539 [216.24], Avg: 131.8586 (0.022)
Ep: 190, Reward: 367.8250, Test: 465.1447 [165.45], Avg: 132.7373 (0.021)
Ep: 191, Reward: 385.1290, Test: 328.6882 [175.95], Avg: 132.8415 (0.021)
Ep: 192, Reward: 399.8408, Test: 422.1885 [166.61], Avg: 133.4774 (0.020)
Ep: 193, Reward: 418.0719, Test: 389.6178 [124.51], Avg: 134.1559 (0.020)
Ep: 194, Reward: 436.9949, Test: 366.9760 [183.48], Avg: 134.4090 (0.020)
Ep: 195, Reward: 363.6165, Test: 492.9674 [236.60], Avg: 135.0312 (0.020)
Ep: 196, Reward: 376.5206, Test: 337.6654 [103.01], Avg: 135.5369 (0.020)
Ep: 197, Reward: 388.3536, Test: 368.2349 [174.86], Avg: 135.8290 (0.020)
Ep: 198, Reward: 450.1301, Test: 400.6799 [166.68], Avg: 136.3223 (0.020)
Ep: 199, Reward: 465.3862, Test: 401.4960 [155.92], Avg: 136.8686 (0.020)
Ep: 200, Reward: 448.3851, Test: 428.5481 [157.36], Avg: 137.5368 (0.020)
Ep: 201, Reward: 477.6936, Test: 438.3861 [243.17], Avg: 137.8224 (0.020)
Ep: 202, Reward: 340.4980, Test: 420.4464 [234.17], Avg: 138.0611 (0.020)
Ep: 203, Reward: 478.7110, Test: 521.9808 [138.61], Avg: 139.2636 (0.020)
Ep: 204, Reward: 506.8168, Test: 578.6856 [209.93], Avg: 140.3831 (0.020)
Ep: 205, Reward: 540.7541, Test: 534.4324 [173.24], Avg: 141.4549 (0.020)
Ep: 206, Reward: 518.7983, Test: 562.6424 [150.23], Avg: 142.7639 (0.020)
Ep: 207, Reward: 538.6854, Test: 584.3001 [184.21], Avg: 144.0010 (0.020)
Ep: 208, Reward: 389.7948, Test: 375.0907 [136.20], Avg: 144.4551 (0.020)
Ep: 209, Reward: 391.0834, Test: 303.2098 [168.07], Avg: 144.4107 (0.020)
Ep: 210, Reward: 395.0967, Test: 423.8341 [254.51], Avg: 144.5288 (0.020)
Ep: 211, Reward: 366.3739, Test: 415.4013 [194.63], Avg: 144.8885 (0.020)
Ep: 212, Reward: 402.7669, Test: 346.4733 [237.73], Avg: 144.7188 (0.020)
Ep: 213, Reward: 452.0495, Test: 442.6794 [263.23], Avg: 144.8811 (0.020)
Ep: 214, Reward: 529.1028, Test: 386.5151 [126.66], Avg: 145.4158 (0.020)
Ep: 215, Reward: 417.4950, Test: 362.4118 [155.08], Avg: 145.7025 (0.020)
Ep: 216, Reward: 423.8164, Test: 517.7351 [128.78], Avg: 146.8235 (0.020)
Ep: 217, Reward: 544.7506, Test: 566.8354 [146.97], Avg: 148.0760 (0.020)
Ep: 218, Reward: 426.0545, Test: 418.0879 [248.06], Avg: 148.1762 (0.020)
Ep: 219, Reward: 444.3006, Test: 571.4522 [224.89], Avg: 149.0779 (0.020)
Ep: 220, Reward: 477.4458, Test: 473.7511 [185.09], Avg: 149.7095 (0.020)
Ep: 221, Reward: 450.6381, Test: 382.0311 [167.94], Avg: 149.9996 (0.020)
Ep: 222, Reward: 416.6902, Test: 521.6184 [152.91], Avg: 150.9803 (0.020)
Ep: 223, Reward: 481.4201, Test: 410.2565 [132.47], Avg: 151.5464 (0.020)
Ep: 224, Reward: 601.7558, Test: 578.1763 [103.50], Avg: 152.9825 (0.020)
Ep: 225, Reward: 459.6372, Test: 542.3232 [170.48], Avg: 153.9509 (0.020)
Ep: 226, Reward: 424.9137, Test: 493.4281 [141.79], Avg: 154.8218 (0.020)
Ep: 227, Reward: 494.5608, Test: 532.8591 [228.78], Avg: 155.4764 (0.020)
Ep: 228, Reward: 538.7250, Test: 514.5970 [243.47], Avg: 155.9814 (0.020)
Ep: 229, Reward: 556.6453, Test: 393.4787 [186.87], Avg: 156.2016 (0.020)
Ep: 230, Reward: 580.7901, Test: 591.3743 [221.27], Avg: 157.1276 (0.020)
Ep: 231, Reward: 560.2460, Test: 439.1593 [137.58], Avg: 157.7502 (0.020)
Ep: 232, Reward: 514.3154, Test: 562.0388 [142.20], Avg: 158.8750 (0.020)
Ep: 233, Reward: 511.8832, Test: 529.2259 [145.74], Avg: 159.8349 (0.020)
Ep: 234, Reward: 418.3185, Test: 618.6326 [126.26], Avg: 161.2500 (0.020)
Ep: 235, Reward: 541.6437, Test: 334.8434 [171.36], Avg: 161.2594 (0.020)
Ep: 236, Reward: 433.5331, Test: 626.8176 [156.68], Avg: 162.5627 (0.020)
Ep: 237, Reward: 467.5935, Test: 433.4423 [127.48], Avg: 163.1653 (0.020)
Ep: 238, Reward: 551.2828, Test: 602.4832 [161.96], Avg: 164.3258 (0.020)
Ep: 239, Reward: 558.1745, Test: 463.3335 [160.25], Avg: 164.9039 (0.020)
Ep: 240, Reward: 527.5722, Test: 660.3507 [215.21], Avg: 166.0667 (0.020)
Ep: 241, Reward: 624.3996, Test: 610.3570 [157.21], Avg: 167.2530 (0.020)
Ep: 242, Reward: 516.1189, Test: 599.6654 [196.20], Avg: 168.2251 (0.020)
Ep: 243, Reward: 512.9358, Test: 253.1470 [208.06], Avg: 167.7204 (0.020)
Ep: 244, Reward: 419.0309, Test: 458.5140 [173.66], Avg: 168.1985 (0.020)
Ep: 245, Reward: 494.4195, Test: 453.5473 [107.46], Avg: 168.9216 (0.020)
Ep: 246, Reward: 442.4098, Test: 563.9260 [174.08], Avg: 169.8160 (0.020)
Ep: 247, Reward: 466.8656, Test: 457.8826 [147.36], Avg: 170.3834 (0.020)
Ep: 248, Reward: 366.1663, Test: 380.6321 [170.06], Avg: 170.5448 (0.020)
Ep: 249, Reward: 422.4987, Test: 535.6565 [181.35], Avg: 171.2798 (0.020)
Ep: 250, Reward: 509.5950, Test: 520.9406 [137.12], Avg: 172.1266 (0.020)
Ep: 251, Reward: 501.2329, Test: 359.9442 [104.34], Avg: 172.4579 (0.020)
Ep: 252, Reward: 426.0507, Test: 483.9916 [143.48], Avg: 173.1221 (0.020)
Ep: 253, Reward: 424.2624, Test: 493.1256 [190.82], Avg: 173.6307 (0.020)
Ep: 254, Reward: 511.4797, Test: 410.3530 [152.00], Avg: 173.9629 (0.020)
Ep: 255, Reward: 436.2825, Test: 544.5912 [216.11], Avg: 174.5665 (0.020)
Ep: 256, Reward: 478.5618, Test: 550.9320 [250.86], Avg: 175.0549 (0.020)
Ep: 257, Reward: 444.4829, Test: 558.6789 [227.09], Avg: 175.6616 (0.020)
Ep: 258, Reward: 467.9139, Test: 460.4495 [238.69], Avg: 175.8396 (0.020)
Ep: 259, Reward: 384.6481, Test: 291.0687 [214.60], Avg: 175.4574 (0.020)
Ep: 260, Reward: 411.3220, Test: 433.1675 [217.13], Avg: 175.6129 (0.020)
Ep: 261, Reward: 382.0646, Test: 499.0774 [219.04], Avg: 176.0115 (0.020)
Ep: 262, Reward: 477.0935, Test: 525.5361 [194.65], Avg: 176.6004 (0.020)
Ep: 263, Reward: 510.6287, Test: 513.3060 [209.04], Avg: 177.0839 (0.020)
Ep: 264, Reward: 401.7303, Test: 372.8180 [79.25], Avg: 177.5235 (0.020)
Ep: 265, Reward: 475.6568, Test: 437.9255 [145.32], Avg: 177.9561 (0.020)
Ep: 266, Reward: 514.8202, Test: 472.7034 [155.26], Avg: 178.4786 (0.020)
Ep: 267, Reward: 483.8987, Test: 412.5204 [175.30], Avg: 178.6977 (0.020)
Ep: 268, Reward: 463.6679, Test: 422.9615 [157.37], Avg: 179.0208 (0.020)
Ep: 269, Reward: 390.4904, Test: 308.8939 [168.89], Avg: 178.8763 (0.020)
Ep: 270, Reward: 385.3054, Test: 427.7834 [151.50], Avg: 179.2357 (0.020)
Ep: 271, Reward: 425.0150, Test: 293.4135 [156.89], Avg: 179.0787 (0.020)
Ep: 272, Reward: 412.4593, Test: 426.3498 [161.77], Avg: 179.3919 (0.020)
Ep: 273, Reward: 434.1879, Test: 345.2424 [167.11], Avg: 179.3873 (0.020)
Ep: 274, Reward: 448.9690, Test: 413.9495 [201.83], Avg: 179.5063 (0.020)
Ep: 275, Reward: 449.4962, Test: 511.3311 [153.81], Avg: 180.1513 (0.020)
Ep: 276, Reward: 486.8628, Test: 385.3265 [152.60], Avg: 180.3411 (0.020)
Ep: 277, Reward: 355.2289, Test: 403.8894 [243.53], Avg: 180.2692 (0.020)
Ep: 278, Reward: 283.5541, Test: 419.6417 [236.83], Avg: 180.2783 (0.020)
Ep: 279, Reward: 360.9222, Test: 283.4955 [78.14], Avg: 180.3679 (0.020)
Ep: 280, Reward: 434.8127, Test: 661.4446 [111.06], Avg: 181.6847 (0.020)
Ep: 281, Reward: 590.3056, Test: 673.2237 [180.63], Avg: 182.7872 (0.020)
Ep: 282, Reward: 605.0130, Test: 582.8076 [156.98], Avg: 183.6460 (0.020)
Ep: 283, Reward: 555.5493, Test: 311.7280 [159.78], Avg: 183.5344 (0.020)
Ep: 284, Reward: 504.6502, Test: 551.8785 [161.84], Avg: 184.2590 (0.020)
Ep: 285, Reward: 622.3104, Test: 644.2853 [148.41], Avg: 185.3485 (0.020)
Ep: 286, Reward: 526.5539, Test: 504.9912 [212.74], Avg: 185.7210 (0.020)
Ep: 287, Reward: 589.7492, Test: 583.2997 [102.10], Avg: 186.7470 (0.020)
Ep: 288, Reward: 650.0680, Test: 541.5260 [221.81], Avg: 187.2071 (0.020)
Ep: 289, Reward: 545.5741, Test: 505.8211 [251.70], Avg: 187.4378 (0.020)
Ep: 290, Reward: 593.8641, Test: 421.5070 [194.13], Avg: 187.5750 (0.020)
Ep: 291, Reward: 602.7283, Test: 563.2402 [98.86], Avg: 188.5230 (0.020)
Ep: 292, Reward: 641.9826, Test: 520.2818 [195.99], Avg: 188.9864 (0.020)
Ep: 293, Reward: 611.4862, Test: 715.4873 [124.80], Avg: 190.3527 (0.020)
Ep: 294, Reward: 711.4361, Test: 690.2824 [247.18], Avg: 191.2095 (0.020)
Ep: 295, Reward: 715.8265, Test: 747.6625 [119.55], Avg: 192.6855 (0.020)
Ep: 296, Reward: 765.6838, Test: 801.1228 [102.54], Avg: 194.3889 (0.020)
Ep: 297, Reward: 801.1690, Test: 686.6558 [176.61], Avg: 195.4481 (0.020)
Ep: 298, Reward: 737.5755, Test: 569.2526 [212.04], Avg: 195.9892 (0.020)
Ep: 299, Reward: 701.5245, Test: 777.7041 [99.83], Avg: 197.5955 (0.020)
Ep: 300, Reward: 749.2668, Test: 650.1301 [170.72], Avg: 198.5317 (0.020)
Ep: 301, Reward: 766.5590, Test: 797.3046 [73.90], Avg: 200.2697 (0.020)
Ep: 302, Reward: 824.3008, Test: 791.7919 [90.23], Avg: 201.9242 (0.020)
Ep: 303, Reward: 767.1911, Test: 657.6306 [234.26], Avg: 202.6526 (0.020)
Ep: 304, Reward: 682.4079, Test: 846.1361 [49.83], Avg: 204.5991 (0.020)
Ep: 305, Reward: 796.6835, Test: 799.7982 [73.66], Avg: 206.3034 (0.020)
Ep: 306, Reward: 795.3642, Test: 817.2814 [99.79], Avg: 207.9685 (0.020)
Ep: 307, Reward: 677.4554, Test: 756.5971 [119.10], Avg: 209.3631 (0.020)
Ep: 308, Reward: 706.2924, Test: 715.2221 [170.69], Avg: 210.4478 (0.020)
Ep: 309, Reward: 823.7068, Test: 801.6292 [82.15], Avg: 212.0898 (0.020)
Ep: 310, Reward: 832.8431, Test: 766.4395 [156.41], Avg: 213.3694 (0.020)
Ep: 311, Reward: 840.5919, Test: 785.8766 [154.42], Avg: 214.7094 (0.020)
Ep: 312, Reward: 757.3919, Test: 757.7561 [190.18], Avg: 215.8368 (0.020)
Ep: 313, Reward: 791.0105, Test: 828.4959 [65.17], Avg: 217.5804 (0.020)
Ep: 314, Reward: 729.9021, Test: 715.9941 [187.32], Avg: 218.5680 (0.020)
Ep: 315, Reward: 683.4863, Test: 812.1659 [67.43], Avg: 220.2331 (0.020)
Ep: 316, Reward: 671.0558, Test: 635.6700 [219.33], Avg: 220.8517 (0.020)
Ep: 317, Reward: 647.1141, Test: 754.0210 [158.30], Avg: 222.0305 (0.020)
Ep: 318, Reward: 767.4053, Test: 620.7347 [240.31], Avg: 222.5271 (0.020)
Ep: 319, Reward: 767.3640, Test: 570.9144 [247.98], Avg: 222.8408 (0.020)
Ep: 320, Reward: 798.9936, Test: 770.1934 [182.55], Avg: 223.9773 (0.020)
Ep: 321, Reward: 660.8242, Test: 452.6911 [226.01], Avg: 223.9857 (0.020)
Ep: 322, Reward: 572.0045, Test: 375.7139 [192.05], Avg: 223.8608 (0.020)
Ep: 323, Reward: 356.8907, Test: 427.7812 [140.23], Avg: 224.0574 (0.020)
Ep: 324, Reward: 431.8662, Test: 538.3010 [222.66], Avg: 224.3392 (0.020)
Ep: 325, Reward: 531.2416, Test: 428.1574 [236.84], Avg: 224.2379 (0.020)
Ep: 326, Reward: 536.8387, Test: 456.8851 [253.39], Avg: 224.1745 (0.020)
Ep: 327, Reward: 550.4375, Test: 525.2620 [271.23], Avg: 224.2655 (0.020)
Ep: 328, Reward: 449.4059, Test: 416.8639 [254.26], Avg: 224.0781 (0.020)
Ep: 329, Reward: 443.1972, Test: 588.2657 [228.84], Avg: 224.4882 (0.020)
Ep: 330, Reward: 679.4460, Test: 779.2260 [121.06], Avg: 225.7984 (0.020)
Ep: 331, Reward: 732.0929, Test: 858.7340 [44.00], Avg: 227.5723 (0.020)
Ep: 332, Reward: 844.8747, Test: 778.7443 [177.60], Avg: 228.6942 (0.020)
Ep: 333, Reward: 795.4342, Test: 623.4312 [191.20], Avg: 229.3036 (0.020)
Ep: 334, Reward: 652.0038, Test: 508.7334 [305.00], Avg: 229.2273 (0.020)
Ep: 335, Reward: 578.6372, Test: 466.2034 [197.93], Avg: 229.3435 (0.020)
Ep: 336, Reward: 615.5617, Test: 582.0207 [166.91], Avg: 229.8947 (0.020)
Ep: 337, Reward: 658.8659, Test: 636.6426 [277.07], Avg: 230.2784 (0.020)
Ep: 338, Reward: 607.4432, Test: 633.5703 [209.75], Avg: 230.8493 (0.020)
Ep: 339, Reward: 579.7255, Test: 521.3393 [271.56], Avg: 230.9050 (0.020)
Ep: 340, Reward: 514.3846, Test: 451.3954 [174.52], Avg: 231.0398 (0.020)
Ep: 341, Reward: 440.5334, Test: 558.3280 [285.29], Avg: 231.1625 (0.020)
Ep: 342, Reward: 510.5714, Test: 497.7240 [315.04], Avg: 231.0212 (0.020)
Ep: 343, Reward: 632.2574, Test: 782.6401 [134.48], Avg: 232.2338 (0.020)
Ep: 344, Reward: 842.9675, Test: 798.8867 [112.91], Avg: 233.5490 (0.020)
Ep: 345, Reward: 827.1069, Test: 745.5688 [194.28], Avg: 234.4673 (0.020)
Ep: 346, Reward: 741.5717, Test: 823.4710 [84.82], Avg: 235.9203 (0.020)
Ep: 347, Reward: 857.1220, Test: 770.8432 [175.69], Avg: 236.9526 (0.020)
Ep: 348, Reward: 872.4340, Test: 857.3676 [21.54], Avg: 238.6686 (0.020)
Ep: 349, Reward: 831.1504, Test: 674.5796 [180.89], Avg: 239.3972 (0.020)
Ep: 350, Reward: 717.0521, Test: 628.9795 [276.42], Avg: 239.7196 (0.020)
Ep: 351, Reward: 634.3779, Test: 811.1648 [96.55], Avg: 241.0687 (0.020)
Ep: 352, Reward: 756.5157, Test: 749.2595 [108.25], Avg: 242.2017 (0.020)
Ep: 353, Reward: 760.8070, Test: 686.5819 [178.59], Avg: 242.9525 (0.020)
Ep: 354, Reward: 729.2341, Test: 622.5195 [180.30], Avg: 243.5139 (0.020)
Ep: 355, Reward: 553.4985, Test: 584.4577 [298.64], Avg: 243.6327 (0.020)
Ep: 356, Reward: 546.0301, Test: 536.0636 [294.78], Avg: 243.6261 (0.020)
Ep: 357, Reward: 580.3393, Test: 796.8351 [231.78], Avg: 244.5239 (0.020)
Ep: 358, Reward: 711.2696, Test: 725.3055 [166.77], Avg: 245.3986 (0.020)
Ep: 359, Reward: 765.8242, Test: 792.9738 [124.20], Avg: 246.5747 (0.020)
Ep: 360, Reward: 836.5577, Test: 784.9366 [178.64], Avg: 247.5711 (0.020)
Ep: 361, Reward: 875.7231, Test: 666.3371 [184.66], Avg: 248.2178 (0.020)
Ep: 362, Reward: 655.1420, Test: 596.9456 [222.85], Avg: 248.5646 (0.020)
Ep: 363, Reward: 595.2027, Test: 505.3782 [178.77], Avg: 248.7790 (0.020)
Ep: 364, Reward: 588.0811, Test: 697.8780 [223.07], Avg: 249.3982 (0.020)
Ep: 365, Reward: 487.9970, Test: 406.5613 [250.72], Avg: 249.1426 (0.020)
Ep: 366, Reward: 497.7607, Test: 420.2765 [181.01], Avg: 249.1157 (0.020)
Ep: 367, Reward: 515.7309, Test: 537.6299 [227.69], Avg: 249.2810 (0.020)
Ep: 368, Reward: 504.1942, Test: 494.2589 [196.70], Avg: 249.4118 (0.020)
Ep: 369, Reward: 597.6520, Test: 634.0020 [182.37], Avg: 249.9583 (0.020)
Ep: 370, Reward: 724.7072, Test: 719.9504 [175.67], Avg: 250.7517 (0.020)
Ep: 371, Reward: 750.1194, Test: 753.7335 [174.69], Avg: 251.6342 (0.020)
Ep: 372, Reward: 921.2365, Test: 872.0688 [44.70], Avg: 253.1777 (0.020)
Ep: 373, Reward: 946.2969, Test: 842.2102 [142.71], Avg: 254.3711 (0.020)
Ep: 374, Reward: 886.4214, Test: 788.3627 [165.15], Avg: 255.3547 (0.020)
Ep: 375, Reward: 788.0847, Test: 822.9975 [112.50], Avg: 256.5651 (0.020)
Ep: 376, Reward: 819.8297, Test: 836.1644 [40.12], Avg: 257.9961 (0.020)
Ep: 377, Reward: 667.5921, Test: 663.9740 [202.08], Avg: 258.5355 (0.020)
Ep: 378, Reward: 466.9096, Test: 393.7744 [182.45], Avg: 258.4110 (0.020)
Ep: 379, Reward: 513.0482, Test: 561.9768 [292.68], Avg: 258.4396 (0.020)
Ep: 380, Reward: 550.5750, Test: 555.4147 [219.58], Avg: 258.6428 (0.020)
Ep: 381, Reward: 494.6060, Test: 468.2619 [287.60], Avg: 258.4386 (0.020)
Ep: 382, Reward: 467.9796, Test: 609.5591 [233.66], Avg: 258.7453 (0.020)
Ep: 383, Reward: 406.2242, Test: 481.7666 [207.14], Avg: 258.7866 (0.020)
Ep: 384, Reward: 526.6183, Test: 598.0609 [255.83], Avg: 259.0034 (0.020)
Ep: 385, Reward: 490.9496, Test: 512.0276 [266.95], Avg: 258.9673 (0.020)
Ep: 386, Reward: 695.2031, Test: 778.4234 [132.36], Avg: 259.9676 (0.020)
Ep: 387, Reward: 698.1019, Test: 667.8677 [253.84], Avg: 260.3646 (0.020)
Ep: 388, Reward: 715.8916, Test: 879.6942 [15.32], Avg: 261.9174 (0.020)
Ep: 389, Reward: 863.2362, Test: 827.8043 [117.59], Avg: 263.0668 (0.020)
Ep: 390, Reward: 829.8832, Test: 820.5376 [65.42], Avg: 264.3253 (0.020)
Ep: 391, Reward: 870.2256, Test: 875.7745 [32.19], Avg: 265.8030 (0.020)
Ep: 392, Reward: 929.7094, Test: 908.6510 [14.09], Avg: 267.4029 (0.020)
Ep: 393, Reward: 1009.7102, Test: 888.0823 [38.50], Avg: 268.8805 (0.020)
Ep: 394, Reward: 851.7159, Test: 659.1119 [245.77], Avg: 269.2462 (0.020)
Ep: 395, Reward: 763.3058, Test: 812.5290 [163.20], Avg: 270.2060 (0.020)
Ep: 396, Reward: 872.5292, Test: 848.6252 [57.26], Avg: 271.5188 (0.020)
Ep: 397, Reward: 856.7054, Test: 792.8563 [100.97], Avg: 272.5750 (0.020)
Ep: 398, Reward: 805.4965, Test: 762.5930 [184.98], Avg: 273.3395 (0.020)
Ep: 399, Reward: 687.3855, Test: 800.3083 [148.50], Avg: 274.2857 (0.020)
Ep: 400, Reward: 651.8663, Test: 636.8417 [194.27], Avg: 274.7053 (0.020)
Ep: 401, Reward: 661.0369, Test: 663.8059 [163.97], Avg: 275.2654 (0.020)
Ep: 402, Reward: 749.9814, Test: 876.1043 [22.12], Avg: 276.7014 (0.020)
Ep: 403, Reward: 762.4173, Test: 693.3688 [182.99], Avg: 277.2798 (0.020)
Ep: 404, Reward: 634.9325, Test: 581.5611 [226.60], Avg: 277.4716 (0.020)
Ep: 405, Reward: 614.5601, Test: 719.0490 [250.18], Avg: 277.9430 (0.020)
Ep: 406, Reward: 754.5934, Test: 790.6942 [178.12], Avg: 278.7652 (0.020)
Ep: 407, Reward: 852.0197, Test: 831.7870 [154.22], Avg: 279.7427 (0.020)
Ep: 408, Reward: 738.0241, Test: 741.9087 [252.32], Avg: 280.2557 (0.020)
Ep: 409, Reward: 871.4108, Test: 817.0044 [87.94], Avg: 281.3504 (0.020)
Ep: 410, Reward: 757.9634, Test: 756.9216 [80.94], Avg: 282.3106 (0.020)
Ep: 411, Reward: 620.3635, Test: 576.6585 [236.75], Avg: 282.4503 (0.020)
Ep: 412, Reward: 500.1965, Test: 232.9213 [95.48], Avg: 282.0992 (0.020)
Ep: 413, Reward: 438.7411, Test: 598.2421 [170.79], Avg: 282.4503 (0.020)
Ep: 414, Reward: 747.5775, Test: 649.4344 [188.24], Avg: 282.8811 (0.020)
Ep: 415, Reward: 632.5880, Test: 746.4113 [91.48], Avg: 283.7754 (0.020)
Ep: 416, Reward: 658.8129, Test: 656.2978 [146.07], Avg: 284.3185 (0.020)
Ep: 417, Reward: 628.0263, Test: 630.4938 [246.45], Avg: 284.5571 (0.020)
Ep: 418, Reward: 653.5745, Test: 682.3182 [262.13], Avg: 284.8807 (0.020)
Ep: 419, Reward: 680.5277, Test: 785.5464 [203.91], Avg: 285.5873 (0.020)
Ep: 420, Reward: 773.5748, Test: 810.7867 [80.12], Avg: 286.6445 (0.020)
Ep: 421, Reward: 687.6771, Test: 698.0871 [281.08], Avg: 286.9534 (0.020)
Ep: 422, Reward: 800.6906, Test: 782.2607 [228.41], Avg: 287.5844 (0.020)
Ep: 423, Reward: 755.1159, Test: 685.8797 [241.06], Avg: 287.9552 (0.020)
Ep: 424, Reward: 773.6220, Test: 675.9752 [210.85], Avg: 288.3721 (0.020)
Ep: 425, Reward: 607.1968, Test: 790.8865 [151.48], Avg: 289.1961 (0.020)
Ep: 426, Reward: 647.6907, Test: 776.2542 [146.47], Avg: 289.9938 (0.020)
Ep: 427, Reward: 653.6008, Test: 458.7258 [316.24], Avg: 289.6491 (0.020)
Ep: 428, Reward: 716.2284, Test: 649.1199 [282.36], Avg: 289.8289 (0.020)
Ep: 429, Reward: 888.6550, Test: 806.5778 [234.19], Avg: 290.4860 (0.020)
Ep: 430, Reward: 965.7318, Test: 857.0453 [83.40], Avg: 291.6070 (0.020)
Ep: 431, Reward: 941.9038, Test: 829.7070 [148.05], Avg: 292.5099 (0.020)
Ep: 432, Reward: 1061.7023, Test: 884.8763 [26.92], Avg: 293.8158 (0.020)
Ep: 433, Reward: 961.4082, Test: 892.0997 [28.44], Avg: 295.1288 (0.020)
Ep: 434, Reward: 1004.6541, Test: 668.2262 [266.40], Avg: 295.3741 (0.020)
Ep: 435, Reward: 879.5393, Test: 562.7822 [291.76], Avg: 295.3182 (0.020)
Ep: 436, Reward: 942.1498, Test: 835.1298 [86.97], Avg: 296.3545 (0.020)
Ep: 437, Reward: 871.5485, Test: 770.7369 [225.24], Avg: 296.9233 (0.020)
Ep: 438, Reward: 900.3791, Test: 570.6094 [272.04], Avg: 296.9270 (0.020)
Ep: 439, Reward: 769.1221, Test: 593.0689 [196.06], Avg: 297.1545 (0.020)
Ep: 440, Reward: 645.6523, Test: 489.0311 [334.43], Avg: 296.8312 (0.020)
Ep: 441, Reward: 649.4885, Test: 645.9511 [297.43], Avg: 296.9482 (0.020)
Ep: 442, Reward: 830.1017, Test: 743.3993 [230.35], Avg: 297.4360 (0.020)
Ep: 443, Reward: 869.0777, Test: 901.5553 [22.83], Avg: 298.7452 (0.020)
Ep: 444, Reward: 888.6338, Test: 900.7098 [37.12], Avg: 300.0145 (0.020)
Ep: 445, Reward: 871.1765, Test: 779.1054 [228.85], Avg: 300.5756 (0.020)
Ep: 446, Reward: 802.0441, Test: 513.0370 [298.41], Avg: 300.3833 (0.020)
Ep: 447, Reward: 818.2817, Test: 733.1100 [205.82], Avg: 300.8898 (0.020)
Ep: 448, Reward: 689.8755, Test: 407.9961 [262.50], Avg: 300.5437 (0.020)
Ep: 449, Reward: 605.9091, Test: 692.7361 [255.87], Avg: 300.8467 (0.020)
Ep: 450, Reward: 632.1483, Test: 765.8495 [198.14], Avg: 301.4384 (0.020)
Ep: 451, Reward: 811.4740, Test: 645.8656 [245.24], Avg: 301.6578 (0.020)
Ep: 452, Reward: 849.2379, Test: 798.9728 [119.70], Avg: 302.4914 (0.020)
Ep: 453, Reward: 790.2498, Test: 691.5916 [280.44], Avg: 302.7307 (0.020)
Ep: 454, Reward: 852.3580, Test: 855.3166 [209.51], Avg: 303.4848 (0.020)
Ep: 455, Reward: 939.5080, Test: 737.4061 [247.65], Avg: 303.8932 (0.020)
Ep: 456, Reward: 906.0996, Test: 696.7235 [177.84], Avg: 304.3637 (0.020)
Ep: 457, Reward: 729.7158, Test: 700.2517 [279.43], Avg: 304.6179 (0.020)
Ep: 458, Reward: 847.1786, Test: 644.7420 [190.07], Avg: 304.9449 (0.020)
Ep: 459, Reward: 800.0476, Test: 765.3312 [202.44], Avg: 305.5056 (0.020)
Ep: 460, Reward: 769.9660, Test: 857.6779 [39.80], Avg: 306.6170 (0.020)
Ep: 461, Reward: 881.3354, Test: 870.9366 [71.22], Avg: 307.6844 (0.020)
Ep: 462, Reward: 902.0425, Test: 812.1425 [157.13], Avg: 308.4345 (0.020)
Ep: 463, Reward: 847.0637, Test: 805.1044 [133.39], Avg: 309.2174 (0.020)
Ep: 464, Reward: 752.7747, Test: 707.9726 [237.47], Avg: 309.5643 (0.020)
Ep: 465, Reward: 880.3744, Test: 749.8995 [220.17], Avg: 310.0367 (0.020)
Ep: 466, Reward: 645.8864, Test: 736.4814 [260.12], Avg: 310.3929 (0.020)
Ep: 467, Reward: 710.6468, Test: 784.4379 [166.10], Avg: 311.0509 (0.020)
Ep: 468, Reward: 870.9849, Test: 763.0003 [212.52], Avg: 311.5614 (0.020)
Ep: 469, Reward: 856.4416, Test: 834.6007 [218.96], Avg: 312.2084 (0.020)
Ep: 470, Reward: 904.0491, Test: 816.6342 [108.78], Avg: 313.0484 (0.020)
Ep: 471, Reward: 846.6858, Test: 879.2528 [83.75], Avg: 314.0705 (0.020)
Ep: 472, Reward: 938.9152, Test: 829.1653 [160.67], Avg: 314.8199 (0.020)
Ep: 473, Reward: 899.0748, Test: 798.6321 [177.60], Avg: 315.4659 (0.020)
Ep: 474, Reward: 831.9823, Test: 842.0448 [117.22], Avg: 316.3277 (0.020)
Ep: 475, Reward: 868.2861, Test: 733.5148 [127.23], Avg: 316.9368 (0.020)
Ep: 476, Reward: 740.4687, Test: 756.0015 [224.01], Avg: 317.3877 (0.020)
Ep: 477, Reward: 881.7195, Test: 786.1601 [108.36], Avg: 318.1417 (0.020)
Ep: 478, Reward: 776.9882, Test: 850.3848 [41.80], Avg: 319.1656 (0.020)
Ep: 479, Reward: 852.8652, Test: 860.3220 [40.37], Avg: 320.2089 (0.020)
Ep: 480, Reward: 846.0509, Test: 809.4436 [70.31], Avg: 321.0798 (0.020)
Ep: 481, Reward: 869.4498, Test: 697.1995 [229.84], Avg: 321.3833 (0.020)
Ep: 482, Reward: 787.0623, Test: 703.7192 [222.82], Avg: 321.7136 (0.020)
Ep: 483, Reward: 667.4727, Test: 874.0978 [29.03], Avg: 322.7949 (0.020)
Ep: 484, Reward: 823.6649, Test: 723.5117 [223.43], Avg: 323.1604 (0.020)
Ep: 485, Reward: 800.5671, Test: 806.8073 [97.54], Avg: 323.9549 (0.020)
Ep: 486, Reward: 805.4604, Test: 838.5250 [123.46], Avg: 324.7580 (0.020)
Ep: 487, Reward: 842.3115, Test: 787.9513 [138.72], Avg: 325.4229 (0.020)
Ep: 488, Reward: 834.3004, Test: 802.5439 [111.54], Avg: 326.1705 (0.020)
Ep: 489, Reward: 739.1992, Test: 764.2193 [108.98], Avg: 326.8421 (0.020)
Ep: 490, Reward: 789.6044, Test: 823.7372 [132.92], Avg: 327.5834 (0.020)
Ep: 491, Reward: 815.2614, Test: 895.1268 [21.80], Avg: 328.6926 (0.020)
Ep: 492, Reward: 814.8947, Test: 825.4727 [165.91], Avg: 329.3637 (0.020)
Ep: 493, Reward: 852.1460, Test: 880.4127 [20.49], Avg: 330.4377 (0.020)
Ep: 494, Reward: 866.8784, Test: 862.8467 [52.48], Avg: 331.4073 (0.020)
Ep: 495, Reward: 850.1742, Test: 843.1228 [21.64], Avg: 332.3954 (0.020)
Ep: 496, Reward: 824.2040, Test: 816.5341 [109.61], Avg: 333.1489 (0.020)
Ep: 497, Reward: 840.7782, Test: 828.3072 [29.18], Avg: 334.0847 (0.020)
Ep: 498, Reward: 814.4473, Test: 781.1882 [130.68], Avg: 334.7188 (0.020)
Ep: 499, Reward: 744.4231, Test: 856.0390 [35.26], Avg: 335.6909 (0.020)
