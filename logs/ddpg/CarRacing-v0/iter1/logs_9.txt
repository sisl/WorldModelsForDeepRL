Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.0225               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%10==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)
		
Ep: 0, Reward: -63.4927, Test: -48.2444 [18.37], Avg: -66.6166 (0.980)
Ep: 1, Reward: -49.2957, Test: -55.0170 [13.93], Avg: -67.7809 (0.960)
Ep: 2, Reward: -53.7662, Test: -64.9456 [18.69], Avg: -73.0661 (0.941)
Ep: 3, Reward: -56.7693, Test: -54.8037 [26.21], Avg: -75.0520 (0.922)
Ep: 4, Reward: -62.9037, Test: -45.5763 [35.01], Avg: -76.1594 (0.904)
Ep: 5, Reward: -50.8212, Test: -48.7893 [18.16], Avg: -74.6247 (0.886)
Ep: 6, Reward: -46.7262, Test: -69.1100 [21.32], Avg: -76.8826 (0.868)
Ep: 7, Reward: -51.2163, Test: -57.1019 [11.42], Avg: -75.8374 (0.851)
Ep: 8, Reward: -58.1115, Test: -44.2289 [30.04], Avg: -75.6635 (0.834)
Ep: 9, Reward: -45.0774, Test: -69.9579 [38.58], Avg: -78.9514 (0.817)
Ep: 10, Reward: -60.9830, Test: -64.4075 [12.22], Avg: -78.7402 (0.801)
Ep: 11, Reward: -62.4575, Test: -49.7196 [21.98], Avg: -78.1536 (0.785)
Ep: 12, Reward: -54.8925, Test: -62.1089 [13.03], Avg: -77.9217 (0.769)
Ep: 13, Reward: -64.9494, Test: -52.0756 [34.40], Avg: -78.5325 (0.754)
Ep: 14, Reward: -64.4126, Test: -57.4078 [13.32], Avg: -78.0124 (0.739)
Ep: 15, Reward: -51.5991, Test: -75.0614 [37.04], Avg: -80.1433 (0.724)
Ep: 16, Reward: -48.4748, Test: -65.7360 [36.64], Avg: -81.4511 (0.709)
Ep: 17, Reward: -54.2382, Test: -65.4706 [31.97], Avg: -82.3396 (0.695)
Ep: 18, Reward: -60.6546, Test: -39.0072 [20.98], Avg: -81.1633 (0.681)
Ep: 19, Reward: -59.4393, Test: -49.1054 [25.43], Avg: -80.8321 (0.668)
Ep: 20, Reward: -58.5630, Test: -60.0314 [20.44], Avg: -80.8151 (0.654)
Ep: 21, Reward: -67.5603, Test: -68.9875 [51.05], Avg: -82.5977 (0.641)
Ep: 22, Reward: -71.0415, Test: -54.7976 [19.70], Avg: -82.2454 (0.628)
Ep: 23, Reward: -70.2793, Test: -52.2877 [19.13], Avg: -81.7942 (0.616)
Ep: 24, Reward: -49.2213, Test: -43.2380 [26.03], Avg: -81.2933 (0.603)
Ep: 25, Reward: -42.8347, Test: -55.3268 [15.91], Avg: -80.9066 (0.591)
Ep: 26, Reward: -50.0437, Test: -77.8752 [46.38], Avg: -82.5122 (0.580)
Ep: 27, Reward: -48.9338, Test: -65.4620 [33.90], Avg: -83.1139 (0.568)
Ep: 28, Reward: -37.5380, Test: -41.0750 [24.23], Avg: -82.4997 (0.557)
Ep: 29, Reward: -41.0061, Test: -66.6258 [16.08], Avg: -82.5067 (0.545)
Ep: 30, Reward: -46.4845, Test: -67.3514 [11.50], Avg: -82.3889 (0.535)
Ep: 31, Reward: -37.1224, Test: -63.2646 [15.67], Avg: -82.2808 (0.524)
Ep: 32, Reward: -49.0027, Test: -69.8490 [22.61], Avg: -82.5894 (0.513)
Ep: 33, Reward: -49.8532, Test: -60.0104 [25.01], Avg: -82.6609 (0.503)
Ep: 34, Reward: -50.6527, Test: -71.1557 [24.93], Avg: -83.0445 (0.493)
Ep: 35, Reward: -35.8673, Test: -67.6123 [13.56], Avg: -82.9925 (0.483)
Ep: 36, Reward: -51.2909, Test: -66.5088 [6.44], Avg: -82.7211 (0.474)
Ep: 37, Reward: -41.5012, Test: -48.6586 [21.45], Avg: -82.3893 (0.464)
Ep: 38, Reward: -35.2752, Test: -63.7436 [15.08], Avg: -82.2980 (0.455)
Ep: 39, Reward: -54.1338, Test: -60.3048 [29.64], Avg: -82.4892 (0.446)
Ep: 40, Reward: -53.9377, Test: -65.7801 [15.98], Avg: -82.4714 (0.437)
Ep: 41, Reward: -50.9718, Test: 44.7066 [86.60], Avg: -81.5052 (0.428)
Ep: 42, Reward: 139.9995, Test: 155.2298 [137.94], Avg: -79.2075 (0.419)
Ep: 43, Reward: 76.5945, Test: 62.7103 [69.20], Avg: -77.5548 (0.411)
Ep: 44, Reward: 24.7373, Test: 15.4819 [77.44], Avg: -77.2081 (0.403)
Ep: 45, Reward: 25.3995, Test: 35.1364 [71.82], Avg: -76.3272 (0.395)
Ep: 46, Reward: 18.3470, Test: 38.3887 [83.34], Avg: -75.6596 (0.387)
Ep: 47, Reward: 24.0671, Test: 60.2262 [105.13], Avg: -75.0188 (0.379)
Ep: 48, Reward: 93.9566, Test: 155.4483 [113.16], Avg: -72.6248 (0.372)
Ep: 49, Reward: 74.7624, Test: 49.2887 [66.57], Avg: -71.5180 (0.364)
Ep: 50, Reward: 96.4421, Test: 131.4282 [173.55], Avg: -70.9416 (0.357)
Ep: 51, Reward: 78.7088, Test: 96.2243 [129.31], Avg: -70.2136 (0.350)
Ep: 52, Reward: 193.8363, Test: 223.6786 [131.78], Avg: -67.1548 (0.343)
Ep: 53, Reward: 130.4071, Test: 251.1831 [129.55], Avg: -63.6587 (0.336)
Ep: 54, Reward: 175.5020, Test: 93.4584 [143.54], Avg: -63.4118 (0.329)
Ep: 55, Reward: 178.1485, Test: 141.7452 [168.61], Avg: -62.7593 (0.323)
Ep: 56, Reward: 151.7820, Test: 193.3428 [116.64], Avg: -60.3125 (0.316)
Ep: 57, Reward: 96.1269, Test: 56.4483 [114.02], Avg: -60.2653 (0.310)
Ep: 58, Reward: 93.7099, Test: 280.1151 [224.03], Avg: -58.2933 (0.304)
Ep: 59, Reward: 205.3127, Test: 38.6005 [80.81], Avg: -58.0252 (0.298)
Ep: 60, Reward: 190.8851, Test: 356.7650 [159.78], Avg: -53.8446 (0.292)
Ep: 61, Reward: 215.6736, Test: 209.8425 [169.13], Avg: -52.3195 (0.286)
Ep: 62, Reward: 170.4903, Test: 277.9589 [109.43], Avg: -48.8139 (0.280)
Ep: 63, Reward: 187.3767, Test: 257.2137 [179.27], Avg: -46.8333 (0.274)
Ep: 64, Reward: 183.5027, Test: 284.6323 [128.20], Avg: -43.7061 (0.269)
Ep: 65, Reward: 263.7484, Test: 380.0827 [165.24], Avg: -39.7888 (0.264)
Ep: 66, Reward: 273.1876, Test: 281.2510 [133.56], Avg: -36.9906 (0.258)
Ep: 67, Reward: 259.0829, Test: 297.4690 [257.46], Avg: -35.8583 (0.253)
Ep: 68, Reward: 230.5803, Test: 405.2066 [131.34], Avg: -31.3694 (0.248)
Ep: 69, Reward: 287.2624, Test: 324.0041 [207.15], Avg: -29.2519 (0.243)
Ep: 70, Reward: 249.2121, Test: 361.3857 [256.58], Avg: -27.3637 (0.238)
Ep: 71, Reward: 358.1269, Test: 361.7484 [153.16], Avg: -24.0866 (0.233)
Ep: 72, Reward: 315.3528, Test: 442.4869 [170.69], Avg: -20.0334 (0.229)
Ep: 73, Reward: 333.0444, Test: 336.7231 [204.21], Avg: -17.9720 (0.224)
Ep: 74, Reward: 444.8416, Test: 334.4552 [217.62], Avg: -16.1745 (0.220)
Ep: 75, Reward: 335.2881, Test: 585.8879 [145.59], Avg: -10.1684 (0.215)
Ep: 76, Reward: 415.9475, Test: 371.1755 [138.74], Avg: -7.0176 (0.211)
Ep: 77, Reward: 386.5549, Test: 369.5895 [197.53], Avg: -4.7217 (0.207)
Ep: 78, Reward: 457.0631, Test: 471.8265 [225.31], Avg: -1.5414 (0.203)
Ep: 79, Reward: 565.8206, Test: 577.0681 [192.24], Avg: 3.2881 (0.199)
Ep: 80, Reward: 490.6469, Test: 512.8315 [171.88], Avg: 7.4568 (0.195)
Ep: 81, Reward: 448.0728, Test: 581.4673 [243.45], Avg: 11.4881 (0.191)
Ep: 82, Reward: 372.2706, Test: 412.6044 [214.92], Avg: 13.7314 (0.187)
Ep: 83, Reward: 483.8786, Test: 484.3562 [237.71], Avg: 16.5042 (0.183)
Ep: 84, Reward: 371.4319, Test: 379.4708 [168.17], Avg: 18.7959 (0.180)
Ep: 85, Reward: 513.7722, Test: 514.3011 [141.68], Avg: 22.9101 (0.176)
Ep: 86, Reward: 396.2075, Test: 556.4778 [183.07], Avg: 26.9388 (0.172)
Ep: 87, Reward: 487.1004, Test: 475.0653 [186.19], Avg: 29.9153 (0.169)
Ep: 88, Reward: 597.3618, Test: 601.3771 [140.44], Avg: 34.7582 (0.166)
Ep: 89, Reward: 572.7427, Test: 564.9782 [156.56], Avg: 38.9100 (0.162)
Ep: 90, Reward: 552.4482, Test: 483.0982 [206.39], Avg: 41.5231 (0.159)
Ep: 91, Reward: 504.0396, Test: 490.7082 [162.18], Avg: 44.6427 (0.156)
Ep: 92, Reward: 562.9571, Test: 529.4986 [139.93], Avg: 48.3516 (0.153)
Ep: 93, Reward: 593.0375, Test: 551.4595 [228.08], Avg: 51.2774 (0.150)
Ep: 94, Reward: 471.9659, Test: 513.4892 [263.12], Avg: 53.3731 (0.147)
Ep: 95, Reward: 500.2280, Test: 428.6024 [215.73], Avg: 55.0346 (0.144)
Ep: 96, Reward: 495.8070, Test: 497.8940 [227.65], Avg: 57.2533 (0.141)
Ep: 97, Reward: 529.1632, Test: 439.2746 [252.44], Avg: 58.5756 (0.138)
Ep: 98, Reward: 493.6835, Test: 588.5229 [147.53], Avg: 62.4383 (0.135)
Ep: 99, Reward: 445.3459, Test: 523.8867 [274.36], Avg: 64.3092 (0.133)
Ep: 100, Reward: 480.1072, Test: 539.9747 [234.93], Avg: 66.6927 (0.130)
Ep: 101, Reward: 458.9643, Test: 488.9006 [257.29], Avg: 68.3095 (0.127)
Ep: 102, Reward: 474.2238, Test: 607.4438 [131.23], Avg: 72.2697 (0.125)
Ep: 103, Reward: 623.7891, Test: 419.7066 [126.57], Avg: 74.3934 (0.122)
Ep: 104, Reward: 577.3046, Test: 475.4118 [221.49], Avg: 76.1032 (0.120)
Ep: 105, Reward: 549.8974, Test: 457.9554 [187.26], Avg: 77.9390 (0.117)
Ep: 106, Reward: 510.6498, Test: 615.5093 [212.14], Avg: 80.9804 (0.115)
Ep: 107, Reward: 530.7447, Test: 613.4885 [244.01], Avg: 83.6517 (0.113)
Ep: 108, Reward: 569.8347, Test: 535.1047 [155.59], Avg: 86.3661 (0.111)
Ep: 109, Reward: 603.6365, Test: 440.6964 [206.66], Avg: 87.7085 (0.108)
Ep: 110, Reward: 655.6446, Test: 485.5227 [166.91], Avg: 89.7888 (0.106)
Ep: 111, Reward: 482.2538, Test: 286.2725 [195.08], Avg: 89.8013 (0.104)
Ep: 112, Reward: 334.9662, Test: 477.2363 [241.04], Avg: 91.0969 (0.102)
Ep: 113, Reward: 326.2000, Test: 263.6939 [222.55], Avg: 90.6587 (0.100)
Ep: 114, Reward: 392.7092, Test: 337.8420 [262.74], Avg: 90.5234 (0.098)
Ep: 115, Reward: 313.9056, Test: 312.7238 [177.55], Avg: 90.9083 (0.096)
Ep: 116, Reward: 285.9131, Test: 468.2877 [258.73], Avg: 91.9224 (0.094)
Ep: 117, Reward: 507.0289, Test: 551.8597 [272.17], Avg: 93.5136 (0.092)
Ep: 118, Reward: 622.2768, Test: 477.2583 [246.99], Avg: 94.6629 (0.090)
Ep: 119, Reward: 555.6171, Test: 441.2654 [264.46], Avg: 95.3474 (0.089)
Ep: 120, Reward: 494.4651, Test: 389.4348 [190.38], Avg: 96.2045 (0.087)
Ep: 121, Reward: 538.1954, Test: 532.4717 [241.92], Avg: 97.7975 (0.085)
Ep: 122, Reward: 475.9053, Test: 478.3869 [225.15], Avg: 99.0612 (0.083)
Ep: 123, Reward: 307.8247, Test: 345.6902 [263.53], Avg: 98.9249 (0.082)
Ep: 124, Reward: 370.3204, Test: 445.3896 [245.96], Avg: 99.7289 (0.080)
Ep: 125, Reward: 300.6977, Test: 425.9129 [271.99], Avg: 100.1590 (0.078)
Ep: 126, Reward: 471.3931, Test: 467.2114 [248.08], Avg: 101.0958 (0.077)
Ep: 127, Reward: 411.7268, Test: 284.5195 [146.64], Avg: 101.3832 (0.075)
Ep: 128, Reward: 463.8654, Test: 423.1304 [202.14], Avg: 102.3104 (0.074)
Ep: 129, Reward: 406.2651, Test: 427.4089 [227.54], Avg: 103.0609 (0.072)
Ep: 130, Reward: 478.1654, Test: 469.4231 [263.94], Avg: 103.8428 (0.071)
Ep: 131, Reward: 531.1164, Test: 494.7894 [245.95], Avg: 104.9412 (0.069)
Ep: 132, Reward: 490.5887, Test: 514.7504 [253.08], Avg: 106.1196 (0.068)
Ep: 133, Reward: 351.1639, Test: 434.5701 [192.76], Avg: 107.1322 (0.067)
Ep: 134, Reward: 333.5878, Test: 337.4603 [171.44], Avg: 107.5685 (0.065)
Ep: 135, Reward: 394.1485, Test: 369.2203 [262.27], Avg: 107.5640 (0.064)
Ep: 136, Reward: 460.8457, Test: 459.9037 [224.57], Avg: 108.4966 (0.063)
Ep: 137, Reward: 425.8115, Test: 347.5650 [157.61], Avg: 109.0869 (0.062)
Ep: 138, Reward: 536.9577, Test: 490.2221 [199.88], Avg: 110.3909 (0.060)
Ep: 139, Reward: 460.4143, Test: 538.6839 [211.11], Avg: 111.9422 (0.059)
Ep: 140, Reward: 396.6122, Test: 549.7585 [248.92], Avg: 113.2819 (0.058)
Ep: 141, Reward: 665.7625, Test: 567.4824 [190.95], Avg: 115.1357 (0.057)
Ep: 142, Reward: 569.2785, Test: 486.5218 [203.39], Avg: 116.3105 (0.056)
Ep: 143, Reward: 564.1826, Test: 591.9361 [227.68], Avg: 118.0324 (0.055)
Ep: 144, Reward: 514.7700, Test: 690.1204 [193.28], Avg: 120.6448 (0.053)
Ep: 145, Reward: 579.3630, Test: 643.1121 [215.43], Avg: 122.7478 (0.052)
Ep: 146, Reward: 623.2544, Test: 661.2576 [154.54], Avg: 125.3599 (0.051)
Ep: 147, Reward: 601.7289, Test: 386.9949 [212.14], Avg: 125.6943 (0.050)
Ep: 148, Reward: 713.9051, Test: 616.8404 [252.54], Avg: 127.2957 (0.049)
Ep: 149, Reward: 602.5461, Test: 602.7823 [212.06], Avg: 129.0519 (0.048)
Ep: 150, Reward: 569.7170, Test: 624.7768 [189.66], Avg: 131.0788 (0.047)
Ep: 151, Reward: 594.3817, Test: 519.9923 [269.06], Avg: 131.8673 (0.046)
Ep: 152, Reward: 471.6698, Test: 322.2720 [138.77], Avg: 132.2048 (0.045)
Ep: 153, Reward: 639.7888, Test: 698.3281 [165.10], Avg: 134.8089 (0.045)
Ep: 154, Reward: 599.6527, Test: 520.7077 [229.72], Avg: 135.8165 (0.044)
Ep: 155, Reward: 535.0989, Test: 663.3102 [163.85], Avg: 138.1476 (0.043)
Ep: 156, Reward: 499.9675, Test: 627.7587 [267.53], Avg: 139.5621 (0.042)
Ep: 157, Reward: 570.2978, Test: 411.1635 [162.11], Avg: 140.2550 (0.041)
Ep: 158, Reward: 345.2583, Test: 390.5788 [261.44], Avg: 140.1851 (0.040)
Ep: 159, Reward: 513.6312, Test: 567.8231 [250.91], Avg: 141.2897 (0.039)
Ep: 160, Reward: 609.4305, Test: 629.9424 [215.30], Avg: 142.9875 (0.039)
Ep: 161, Reward: 625.8909, Test: 654.8138 [233.62], Avg: 144.7048 (0.038)
Ep: 162, Reward: 561.3448, Test: 480.9305 [289.00], Avg: 144.9945 (0.037)
Ep: 163, Reward: 647.7428, Test: 771.2959 [168.89], Avg: 147.7836 (0.036)
Ep: 164, Reward: 662.7012, Test: 651.2548 [233.69], Avg: 149.4187 (0.036)
Ep: 165, Reward: 594.9801, Test: 649.8472 [247.01], Avg: 150.9453 (0.035)
Ep: 166, Reward: 595.8273, Test: 682.7645 [222.62], Avg: 152.7967 (0.034)
Ep: 167, Reward: 583.7447, Test: 460.9517 [190.84], Avg: 153.4951 (0.034)
Ep: 168, Reward: 412.7595, Test: 659.2438 [224.67], Avg: 155.1583 (0.033)
Ep: 169, Reward: 678.5344, Test: 677.7525 [196.50], Avg: 157.0765 (0.032)
Ep: 170, Reward: 603.3933, Test: 592.9460 [275.35], Avg: 158.0152 (0.032)
Ep: 171, Reward: 601.0813, Test: 569.8626 [276.66], Avg: 158.8011 (0.031)
Ep: 172, Reward: 570.7636, Test: 745.0960 [188.10], Avg: 161.1028 (0.030)
Ep: 173, Reward: 496.9599, Test: 830.6274 [27.28], Avg: 164.7939 (0.030)
Ep: 174, Reward: 695.7438, Test: 660.5716 [220.73], Avg: 166.3656 (0.029)
Ep: 175, Reward: 753.9806, Test: 711.0781 [238.58], Avg: 168.1050 (0.029)
Ep: 176, Reward: 577.1236, Test: 642.4061 [239.16], Avg: 169.4335 (0.028)
Ep: 177, Reward: 626.5590, Test: 714.2851 [183.89], Avg: 171.4613 (0.027)
Ep: 178, Reward: 639.1836, Test: 696.7425 [176.57], Avg: 173.4094 (0.027)
Ep: 179, Reward: 753.9586, Test: 792.5737 [148.39], Avg: 176.0248 (0.026)
Ep: 180, Reward: 741.9787, Test: 660.0299 [208.05], Avg: 177.5495 (0.026)
Ep: 181, Reward: 665.3309, Test: 793.1843 [72.13], Avg: 180.5357 (0.025)
Ep: 182, Reward: 805.6620, Test: 844.4709 [23.38], Avg: 184.0360 (0.025)
Ep: 183, Reward: 679.8372, Test: 748.8531 [162.37], Avg: 186.2233 (0.024)
Ep: 184, Reward: 701.1753, Test: 664.4737 [220.84], Avg: 187.6147 (0.024)
Ep: 185, Reward: 697.8045, Test: 644.6294 [197.49], Avg: 189.0100 (0.023)
Ep: 186, Reward: 677.9868, Test: 735.2515 [142.94], Avg: 191.1667 (0.023)
Ep: 187, Reward: 714.2491, Test: 671.2705 [213.72], Avg: 192.5836 (0.022)
Ep: 188, Reward: 608.5609, Test: 623.1500 [224.30], Avg: 193.6750 (0.022)
Ep: 189, Reward: 702.6924, Test: 657.3274 [190.18], Avg: 195.1143 (0.022)
Ep: 190, Reward: 663.2603, Test: 661.3287 [163.02], Avg: 196.7017 (0.021)
Ep: 191, Reward: 550.6832, Test: 490.9980 [183.07], Avg: 197.2810 (0.021)
Ep: 192, Reward: 682.8796, Test: 659.2305 [174.27], Avg: 198.7715 (0.020)
Ep: 193, Reward: 689.5651, Test: 713.5844 [188.50], Avg: 200.4536 (0.020)
Ep: 194, Reward: 604.4324, Test: 763.0132 [136.44], Avg: 202.6388 (0.020)
Ep: 195, Reward: 700.0773, Test: 708.8104 [85.95], Avg: 204.7828 (0.020)
Ep: 196, Reward: 737.8467, Test: 644.0492 [178.31], Avg: 206.1075 (0.020)
Ep: 197, Reward: 705.4873, Test: 686.4205 [235.78], Avg: 207.3425 (0.020)
Ep: 198, Reward: 754.2034, Test: 793.4429 [121.95], Avg: 209.6749 (0.020)
Ep: 199, Reward: 708.4133, Test: 693.2309 [173.35], Avg: 211.2259 (0.020)
Ep: 200, Reward: 687.6631, Test: 633.6854 [171.17], Avg: 212.4761 (0.020)
Ep: 201, Reward: 674.5394, Test: 744.0768 [130.73], Avg: 214.4606 (0.020)
Ep: 202, Reward: 782.3820, Test: 709.5038 [198.67], Avg: 215.9206 (0.020)
Ep: 203, Reward: 738.1291, Test: 664.4934 [195.68], Avg: 217.1602 (0.020)
Ep: 204, Reward: 823.7033, Test: 823.6997 [82.98], Avg: 219.7142 (0.020)
Ep: 205, Reward: 829.5905, Test: 821.8892 [98.48], Avg: 222.1593 (0.020)
Ep: 206, Reward: 766.2874, Test: 821.7184 [121.94], Avg: 224.4667 (0.020)
Ep: 207, Reward: 739.0425, Test: 853.5921 [81.32], Avg: 227.1003 (0.020)
Ep: 208, Reward: 817.4216, Test: 811.8066 [132.34], Avg: 229.2648 (0.020)
Ep: 209, Reward: 835.7904, Test: 678.0293 [159.17], Avg: 230.6438 (0.020)
Ep: 210, Reward: 848.4975, Test: 828.1888 [94.85], Avg: 233.0263 (0.020)
Ep: 211, Reward: 849.5619, Test: 823.3454 [111.88], Avg: 235.2831 (0.020)
Ep: 212, Reward: 842.2668, Test: 799.2248 [142.63], Avg: 237.2611 (0.020)
Ep: 213, Reward: 964.5661, Test: 810.7212 [155.35], Avg: 239.2149 (0.020)
Ep: 214, Reward: 839.2183, Test: 842.5367 [80.35], Avg: 241.6473 (0.020)
Ep: 215, Reward: 878.8991, Test: 852.0248 [118.01], Avg: 243.9268 (0.020)
Ep: 216, Reward: 966.0394, Test: 841.6418 [57.23], Avg: 246.4175 (0.020)
Ep: 217, Reward: 797.8676, Test: 837.0598 [60.56], Avg: 248.8491 (0.020)
Ep: 218, Reward: 861.1315, Test: 859.8282 [52.83], Avg: 251.3977 (0.020)
Ep: 219, Reward: 813.1445, Test: 818.9855 [143.62], Avg: 253.3248 (0.020)
Ep: 220, Reward: 861.1409, Test: 827.2521 [104.94], Avg: 255.4469 (0.020)
Ep: 221, Reward: 821.9880, Test: 881.2103 [15.73], Avg: 258.1948 (0.020)
Ep: 222, Reward: 846.7011, Test: 827.2756 [83.64], Avg: 260.3717 (0.020)
Ep: 223, Reward: 835.8705, Test: 781.6364 [147.49], Avg: 262.0403 (0.020)
Ep: 224, Reward: 847.8239, Test: 811.6203 [127.16], Avg: 263.9177 (0.020)
Ep: 225, Reward: 763.4470, Test: 857.7835 [34.66], Avg: 266.3921 (0.020)
Ep: 226, Reward: 816.3148, Test: 708.0002 [169.60], Avg: 267.5904 (0.020)
Ep: 227, Reward: 674.9355, Test: 788.6399 [121.61], Avg: 269.3423 (0.020)
Ep: 228, Reward: 758.8279, Test: 860.0969 [47.05], Avg: 271.7165 (0.020)
Ep: 229, Reward: 832.0393, Test: 835.7231 [87.22], Avg: 273.7895 (0.020)
Ep: 230, Reward: 774.6838, Test: 776.5464 [168.95], Avg: 275.2346 (0.020)
Ep: 231, Reward: 856.7855, Test: 779.7970 [133.43], Avg: 276.8343 (0.020)
Ep: 232, Reward: 858.4506, Test: 856.3717 [11.67], Avg: 279.2715 (0.020)
Ep: 233, Reward: 822.1609, Test: 866.3077 [13.46], Avg: 281.7227 (0.020)
Ep: 234, Reward: 873.4324, Test: 863.3384 [74.29], Avg: 283.8815 (0.020)
Ep: 235, Reward: 879.6893, Test: 866.7807 [52.11], Avg: 286.1306 (0.020)
Ep: 236, Reward: 937.0230, Test: 879.2680 [9.33], Avg: 288.5939 (0.020)
Ep: 237, Reward: 899.8089, Test: 898.3711 [23.31], Avg: 291.0581 (0.020)
Ep: 238, Reward: 868.4518, Test: 870.1786 [38.51], Avg: 293.3201 (0.020)
Ep: 239, Reward: 838.3637, Test: 879.7354 [20.78], Avg: 295.6769 (0.020)
Ep: 240, Reward: 869.9920, Test: 836.2277 [87.22], Avg: 297.5579 (0.020)
Ep: 241, Reward: 880.3869, Test: 863.9510 [62.31], Avg: 299.6409 (0.020)
Ep: 242, Reward: 918.5620, Test: 855.4916 [58.83], Avg: 301.6863 (0.020)
Ep: 243, Reward: 869.8630, Test: 873.3830 [13.51], Avg: 303.9739 (0.020)
Ep: 244, Reward: 841.4208, Test: 866.3080 [28.89], Avg: 306.1512 (0.020)
Ep: 245, Reward: 855.0223, Test: 878.9361 [17.16], Avg: 308.4099 (0.020)
Ep: 246, Reward: 939.9361, Test: 834.9994 [98.25], Avg: 310.1441 (0.020)
Ep: 247, Reward: 905.9685, Test: 803.3953 [169.35], Avg: 311.4501 (0.020)
Ep: 248, Reward: 856.7624, Test: 831.3090 [118.03], Avg: 313.0639 (0.020)
Ep: 249, Reward: 888.2763, Test: 853.3859 [77.03], Avg: 314.9171 (0.020)
Ep: 250, Reward: 911.9773, Test: 869.8570 [50.12], Avg: 316.9283 (0.020)
Ep: 251, Reward: 894.2514, Test: 873.1477 [36.38], Avg: 318.9911 (0.020)
Ep: 252, Reward: 928.8097, Test: 889.3223 [13.65], Avg: 321.1914 (0.020)
Ep: 253, Reward: 998.4295, Test: 890.2432 [12.41], Avg: 323.3829 (0.020)
Ep: 254, Reward: 970.0167, Test: 874.0492 [72.55], Avg: 325.2579 (0.020)
Ep: 255, Reward: 905.8794, Test: 860.6000 [20.80], Avg: 327.2678 (0.020)
Ep: 256, Reward: 859.9490, Test: 876.3105 [36.51], Avg: 329.2621 (0.020)
Ep: 257, Reward: 879.5751, Test: 894.6503 [12.54], Avg: 331.4050 (0.020)
Ep: 258, Reward: 952.0449, Test: 875.3228 [20.73], Avg: 333.4250 (0.020)
Ep: 259, Reward: 937.5576, Test: 884.2615 [9.82], Avg: 335.5058 (0.020)
Ep: 260, Reward: 846.8182, Test: 870.0580 [16.88], Avg: 337.4893 (0.020)
Ep: 261, Reward: 843.4899, Test: 839.1854 [90.39], Avg: 339.0591 (0.020)
Ep: 262, Reward: 912.5616, Test: 813.6700 [170.23], Avg: 340.2165 (0.020)
Ep: 263, Reward: 914.4387, Test: 909.5933 [19.43], Avg: 342.2996 (0.020)
Ep: 264, Reward: 894.6785, Test: 862.0301 [67.05], Avg: 344.0079 (0.020)
Ep: 265, Reward: 937.2844, Test: 791.7773 [161.73], Avg: 345.0832 (0.020)
Ep: 266, Reward: 884.1965, Test: 861.5206 [50.45], Avg: 346.8284 (0.020)
Ep: 267, Reward: 867.6326, Test: 890.1572 [13.74], Avg: 348.8045 (0.020)
Ep: 268, Reward: 918.3005, Test: 846.1381 [112.27], Avg: 350.2360 (0.020)
Ep: 269, Reward: 959.8885, Test: 826.7567 [142.80], Avg: 351.4720 (0.020)
Ep: 270, Reward: 798.1198, Test: 816.4240 [113.45], Avg: 352.7691 (0.020)
Ep: 271, Reward: 781.0896, Test: 815.8891 [182.68], Avg: 353.8001 (0.020)
Ep: 272, Reward: 968.5313, Test: 907.9508 [15.08], Avg: 355.7747 (0.020)
Ep: 273, Reward: 958.1775, Test: 901.9140 [19.59], Avg: 357.6964 (0.020)
Ep: 274, Reward: 954.7046, Test: 891.4085 [10.11], Avg: 359.6004 (0.020)
Ep: 275, Reward: 911.4862, Test: 834.1987 [154.95], Avg: 360.7586 (0.020)
Ep: 276, Reward: 907.4384, Test: 800.3255 [166.57], Avg: 361.7441 (0.020)
Ep: 277, Reward: 849.1302, Test: 859.7291 [69.57], Avg: 363.2852 (0.020)
Ep: 278, Reward: 855.0411, Test: 800.6703 [119.90], Avg: 364.4232 (0.020)
Ep: 279, Reward: 836.2019, Test: 687.3203 [211.54], Avg: 364.8209 (0.020)
Ep: 280, Reward: 942.4776, Test: 852.7211 [107.12], Avg: 366.1760 (0.020)
Ep: 281, Reward: 921.7822, Test: 828.7515 [203.54], Avg: 367.0946 (0.020)
Ep: 282, Reward: 846.6775, Test: 874.7976 [33.71], Avg: 368.7695 (0.020)
Ep: 283, Reward: 898.8128, Test: 768.0570 [228.41], Avg: 369.3711 (0.020)
Ep: 284, Reward: 854.1454, Test: 892.1308 [13.46], Avg: 371.1581 (0.020)
Ep: 285, Reward: 818.5591, Test: 703.5076 [167.98], Avg: 371.7328 (0.020)
Ep: 286, Reward: 828.5067, Test: 717.2498 [215.45], Avg: 372.1860 (0.020)
Ep: 287, Reward: 733.9818, Test: 801.5056 [186.89], Avg: 373.0278 (0.020)
Ep: 288, Reward: 870.7820, Test: 856.3724 [87.53], Avg: 374.3974 (0.020)
Ep: 289, Reward: 890.8072, Test: 889.5062 [17.59], Avg: 376.1129 (0.020)
Ep: 290, Reward: 838.4921, Test: 868.0451 [51.13], Avg: 377.6277 (0.020)
Ep: 291, Reward: 792.7343, Test: 718.6359 [280.17], Avg: 377.8361 (0.020)
Ep: 292, Reward: 800.9022, Test: 675.5499 [268.24], Avg: 377.9367 (0.020)
Ep: 293, Reward: 698.2814, Test: 847.4831 [76.33], Avg: 379.2741 (0.020)
Ep: 294, Reward: 835.8469, Test: 755.4432 [183.46], Avg: 379.9274 (0.020)
Ep: 295, Reward: 770.3752, Test: 756.0337 [164.14], Avg: 380.6435 (0.020)
Ep: 296, Reward: 728.1398, Test: 847.1448 [136.26], Avg: 381.7554 (0.020)
Ep: 297, Reward: 886.3787, Test: 898.7142 [12.29], Avg: 383.4489 (0.020)
Ep: 298, Reward: 1056.6291, Test: 852.2748 [78.17], Avg: 384.7555 (0.020)
Ep: 299, Reward: 944.9652, Test: 837.3014 [162.86], Avg: 385.7211 (0.020)
Ep: 300, Reward: 887.2142, Test: 900.4047 [49.25], Avg: 387.2674 (0.020)
Ep: 301, Reward: 707.7713, Test: 869.0636 [34.22], Avg: 388.7494 (0.020)
Ep: 302, Reward: 877.1684, Test: 717.4236 [256.40], Avg: 388.9879 (0.020)
Ep: 303, Reward: 791.6537, Test: 724.8587 [280.43], Avg: 389.1703 (0.020)
Ep: 304, Reward: 713.6799, Test: 757.5103 [209.68], Avg: 389.6905 (0.020)
Ep: 305, Reward: 868.0100, Test: 687.0173 [266.20], Avg: 389.7922 (0.020)
Ep: 306, Reward: 787.4812, Test: 795.5494 [126.31], Avg: 390.7025 (0.020)
Ep: 307, Reward: 617.1134, Test: 596.9376 [275.99], Avg: 390.4760 (0.020)
Ep: 308, Reward: 693.0947, Test: 550.2818 [281.46], Avg: 390.0823 (0.020)
Ep: 309, Reward: 735.4377, Test: 506.8860 [259.79], Avg: 389.6210 (0.020)
Ep: 310, Reward: 638.2858, Test: 778.7148 [140.16], Avg: 390.4215 (0.020)
Ep: 311, Reward: 737.9914, Test: 597.6673 [242.25], Avg: 390.3093 (0.020)
Ep: 312, Reward: 861.2081, Test: 600.3693 [305.53], Avg: 390.0042 (0.020)
Ep: 313, Reward: 732.0456, Test: 733.6034 [266.59], Avg: 390.2495 (0.020)
Ep: 314, Reward: 738.4359, Test: 729.4118 [182.34], Avg: 390.7473 (0.020)
Ep: 315, Reward: 842.1787, Test: 746.7631 [254.20], Avg: 391.0695 (0.020)
Ep: 316, Reward: 856.4303, Test: 757.9484 [208.57], Avg: 391.5689 (0.020)
Ep: 317, Reward: 725.5284, Test: 570.7733 [251.60], Avg: 391.3413 (0.020)
Ep: 318, Reward: 696.0520, Test: 747.2492 [191.95], Avg: 391.8552 (0.020)
Ep: 319, Reward: 690.4799, Test: 690.4660 [261.01], Avg: 391.9727 (0.020)
Ep: 320, Reward: 671.3318, Test: 647.6408 [266.27], Avg: 391.9397 (0.020)
Ep: 321, Reward: 683.0612, Test: 670.3958 [200.42], Avg: 392.1821 (0.020)
Ep: 322, Reward: 764.8073, Test: 544.0140 [242.89], Avg: 391.9001 (0.020)
Ep: 323, Reward: 714.2698, Test: 731.6723 [265.44], Avg: 392.1296 (0.020)
Ep: 324, Reward: 768.7690, Test: 821.6297 [84.47], Avg: 393.1912 (0.020)
Ep: 325, Reward: 697.9543, Test: 544.4118 [271.59], Avg: 392.8220 (0.020)
Ep: 326, Reward: 659.2394, Test: 624.8962 [287.26], Avg: 392.6532 (0.020)
Ep: 327, Reward: 539.6557, Test: 660.3219 [177.89], Avg: 392.9269 (0.020)
Ep: 328, Reward: 540.3893, Test: 634.3692 [170.26], Avg: 393.1433 (0.020)
Ep: 329, Reward: 705.0640, Test: 684.9833 [195.71], Avg: 393.4346 (0.020)
Ep: 330, Reward: 610.4588, Test: 460.2053 [197.47], Avg: 393.0397 (0.020)
Ep: 331, Reward: 535.4911, Test: 593.0905 [289.57], Avg: 392.7701 (0.020)
Ep: 332, Reward: 615.7016, Test: 662.4519 [266.90], Avg: 392.7784 (0.020)
Ep: 333, Reward: 785.9569, Test: 671.7477 [213.50], Avg: 392.9744 (0.020)
Ep: 334, Reward: 731.6422, Test: 697.3511 [185.59], Avg: 393.3290 (0.020)
Ep: 335, Reward: 609.8439, Test: 719.3816 [229.60], Avg: 393.6161 (0.020)
Ep: 336, Reward: 818.6689, Test: 847.2541 [73.79], Avg: 394.7433 (0.020)
Ep: 337, Reward: 719.9479, Test: 767.3492 [224.23], Avg: 395.1822 (0.020)
Ep: 338, Reward: 782.6095, Test: 883.0906 [19.72], Avg: 396.5633 (0.020)
Ep: 339, Reward: 855.7772, Test: 844.9845 [96.12], Avg: 397.5995 (0.020)
Ep: 340, Reward: 888.1069, Test: 885.0037 [27.29], Avg: 398.9488 (0.020)
Ep: 341, Reward: 853.3765, Test: 659.2453 [303.80], Avg: 398.8216 (0.020)
Ep: 342, Reward: 956.6625, Test: 837.4943 [130.73], Avg: 399.7194 (0.020)
Ep: 343, Reward: 856.5790, Test: 876.2414 [10.64], Avg: 401.0737 (0.020)
Ep: 344, Reward: 883.8295, Test: 865.9214 [26.54], Avg: 402.3442 (0.020)
Ep: 345, Reward: 891.4352, Test: 826.4365 [171.65], Avg: 403.0738 (0.020)
Ep: 346, Reward: 695.2192, Test: 725.3497 [229.92], Avg: 403.3399 (0.020)
Ep: 347, Reward: 698.6192, Test: 814.1130 [163.18], Avg: 404.0514 (0.020)
Ep: 348, Reward: 865.1511, Test: 850.4464 [143.26], Avg: 404.9200 (0.020)
Ep: 349, Reward: 905.4079, Test: 794.1208 [170.00], Avg: 405.5463 (0.020)
Ep: 350, Reward: 834.7526, Test: 774.2228 [123.85], Avg: 406.2438 (0.020)
Ep: 351, Reward: 820.2632, Test: 760.2655 [214.86], Avg: 406.6391 (0.020)
Ep: 352, Reward: 793.5322, Test: 777.2465 [173.85], Avg: 407.1965 (0.020)
Ep: 353, Reward: 753.2638, Test: 750.6434 [204.38], Avg: 407.5894 (0.020)
Ep: 354, Reward: 746.0997, Test: 721.1627 [214.07], Avg: 407.8696 (0.020)
Ep: 355, Reward: 694.7144, Test: 544.6421 [266.82], Avg: 407.5043 (0.020)
Ep: 356, Reward: 753.2302, Test: 757.4819 [253.00], Avg: 407.7760 (0.020)
Ep: 357, Reward: 738.8036, Test: 819.2759 [177.99], Avg: 408.4283 (0.020)
Ep: 358, Reward: 689.3354, Test: 790.1439 [124.27], Avg: 409.1454 (0.020)
Ep: 359, Reward: 858.0535, Test: 754.2168 [210.39], Avg: 409.5195 (0.020)
Ep: 360, Reward: 811.1800, Test: 793.1260 [124.28], Avg: 410.2379 (0.020)
Ep: 361, Reward: 841.4453, Test: 892.3385 [18.08], Avg: 411.5197 (0.020)
Ep: 362, Reward: 793.6769, Test: 778.7531 [97.33], Avg: 412.2632 (0.020)
Ep: 363, Reward: 763.7448, Test: 693.2698 [199.34], Avg: 412.4876 (0.020)
Ep: 364, Reward: 792.0524, Test: 795.9821 [106.49], Avg: 413.2465 (0.020)
Ep: 365, Reward: 762.3919, Test: 818.0890 [112.11], Avg: 414.0463 (0.020)
Ep: 366, Reward: 837.6716, Test: 762.0316 [215.08], Avg: 414.4085 (0.020)
Ep: 367, Reward: 753.6128, Test: 776.1786 [152.37], Avg: 414.9775 (0.020)
Ep: 368, Reward: 801.6804, Test: 811.0819 [175.49], Avg: 415.5754 (0.020)
Ep: 369, Reward: 817.0724, Test: 821.0609 [145.90], Avg: 416.2769 (0.020)
Ep: 370, Reward: 852.4234, Test: 906.4279 [22.38], Avg: 417.5378 (0.020)
Ep: 371, Reward: 1076.6279, Test: 889.9831 [91.21], Avg: 418.5626 (0.020)
Ep: 372, Reward: 983.0269, Test: 880.7933 [103.67], Avg: 419.5239 (0.020)
Ep: 373, Reward: 1100.1857, Test: 897.4900 [64.32], Avg: 420.6299 (0.020)
Ep: 374, Reward: 1014.1014, Test: 877.1170 [79.40], Avg: 421.6355 (0.020)
Ep: 375, Reward: 1149.6347, Test: 909.6974 [24.08], Avg: 422.8695 (0.020)
Ep: 376, Reward: 982.8243, Test: 905.8254 [17.01], Avg: 424.1054 (0.020)
Ep: 377, Reward: 890.8288, Test: 870.4818 [37.24], Avg: 425.1878 (0.020)
Ep: 378, Reward: 846.5365, Test: 772.6058 [236.27], Avg: 425.4810 (0.020)
Ep: 379, Reward: 854.8406, Test: 764.0420 [269.91], Avg: 425.6617 (0.020)
Ep: 380, Reward: 900.4221, Test: 862.8001 [78.55], Avg: 426.6029 (0.020)
Ep: 381, Reward: 798.3650, Test: 718.9287 [235.00], Avg: 426.7529 (0.020)
Ep: 382, Reward: 916.2490, Test: 854.8925 [47.79], Avg: 427.7460 (0.020)
Ep: 383, Reward: 837.7529, Test: 906.6842 [20.31], Avg: 428.9404 (0.020)
Ep: 384, Reward: 972.4320, Test: 859.0816 [112.35], Avg: 429.7658 (0.020)
Ep: 385, Reward: 995.1038, Test: 830.5907 [94.44], Avg: 430.5595 (0.020)
Ep: 386, Reward: 902.4826, Test: 826.6054 [134.74], Avg: 431.2347 (0.020)
Ep: 387, Reward: 994.6474, Test: 849.2127 [105.70], Avg: 432.0396 (0.020)
Ep: 388, Reward: 968.2733, Test: 863.5189 [103.98], Avg: 432.8815 (0.020)
Ep: 389, Reward: 951.7632, Test: 902.7295 [25.14], Avg: 434.0217 (0.020)
Ep: 390, Reward: 961.0061, Test: 867.6218 [65.05], Avg: 434.9643 (0.020)
Ep: 391, Reward: 945.5123, Test: 823.6026 [111.97], Avg: 435.6701 (0.020)
Ep: 392, Reward: 987.1873, Test: 879.7003 [59.44], Avg: 436.6487 (0.020)
Ep: 393, Reward: 925.4307, Test: 901.9915 [15.68], Avg: 437.7900 (0.020)
Ep: 394, Reward: 968.5469, Test: 897.0543 [50.77], Avg: 438.8241 (0.020)
Ep: 395, Reward: 971.6496, Test: 788.4939 [226.48], Avg: 439.1352 (0.020)
Ep: 396, Reward: 1018.3623, Test: 889.6073 [22.63], Avg: 440.2129 (0.020)
Ep: 397, Reward: 835.5564, Test: 778.5057 [226.97], Avg: 440.4926 (0.020)
Ep: 398, Reward: 987.1625, Test: 882.1941 [22.25], Avg: 441.5439 (0.020)
Ep: 399, Reward: 985.2590, Test: 833.5837 [183.42], Avg: 442.0654 (0.020)
Ep: 400, Reward: 887.9366, Test: 862.2963 [115.41], Avg: 442.8256 (0.020)
Ep: 401, Reward: 981.1259, Test: 804.3425 [187.26], Avg: 443.2591 (0.020)
Ep: 402, Reward: 833.0528, Test: 877.6316 [15.50], Avg: 444.2984 (0.020)
Ep: 403, Reward: 947.3354, Test: 866.2113 [81.35], Avg: 445.1414 (0.020)
Ep: 404, Reward: 931.0718, Test: 880.7848 [20.30], Avg: 446.1670 (0.020)
Ep: 405, Reward: 871.1700, Test: 847.2159 [64.83], Avg: 446.9951 (0.020)
Ep: 406, Reward: 897.2207, Test: 846.4961 [126.44], Avg: 447.6660 (0.020)
Ep: 407, Reward: 718.1030, Test: 862.1759 [66.02], Avg: 448.5201 (0.020)
Ep: 408, Reward: 886.7220, Test: 877.2109 [86.02], Avg: 449.3580 (0.020)
Ep: 409, Reward: 911.1538, Test: 884.1036 [87.76], Avg: 450.2043 (0.020)
Ep: 410, Reward: 896.4555, Test: 851.3534 [164.41], Avg: 450.7803 (0.020)
Ep: 411, Reward: 1058.4218, Test: 899.2308 [18.25], Avg: 451.8244 (0.020)
Ep: 412, Reward: 988.1128, Test: 892.5173 [62.78], Avg: 452.7395 (0.020)
Ep: 413, Reward: 981.9690, Test: 857.8914 [68.36], Avg: 453.5530 (0.020)
Ep: 414, Reward: 914.0934, Test: 774.2752 [244.46], Avg: 453.7368 (0.020)
Ep: 415, Reward: 952.9206, Test: 824.2480 [180.04], Avg: 454.1946 (0.020)
Ep: 416, Reward: 890.2749, Test: 894.0953 [33.76], Avg: 455.1686 (0.020)
Ep: 417, Reward: 963.1631, Test: 886.5406 [61.78], Avg: 456.0528 (0.020)
Ep: 418, Reward: 923.3740, Test: 863.9411 [44.86], Avg: 456.9192 (0.020)
Ep: 419, Reward: 934.2627, Test: 909.3983 [25.29], Avg: 457.9363 (0.020)
Ep: 420, Reward: 1007.5752, Test: 886.2510 [26.81], Avg: 458.8900 (0.020)
Ep: 421, Reward: 1119.3637, Test: 885.3225 [46.79], Avg: 459.7896 (0.020)
Ep: 422, Reward: 959.2168, Test: 812.0118 [137.65], Avg: 460.2969 (0.020)
Ep: 423, Reward: 841.2453, Test: 888.8874 [22.24], Avg: 461.2553 (0.020)
Ep: 424, Reward: 1055.4335, Test: 905.2665 [30.44], Avg: 462.2284 (0.020)
Ep: 425, Reward: 1077.4591, Test: 827.8960 [179.49], Avg: 462.6654 (0.020)
Ep: 426, Reward: 1023.5743, Test: 857.5257 [144.32], Avg: 463.2521 (0.020)
Ep: 427, Reward: 959.5804, Test: 886.4995 [24.18], Avg: 464.1846 (0.020)
Ep: 428, Reward: 1018.0951, Test: 910.8575 [22.07], Avg: 465.1743 (0.020)
Ep: 429, Reward: 914.5154, Test: 848.8811 [89.46], Avg: 465.8586 (0.020)
Ep: 430, Reward: 923.1899, Test: 844.0008 [117.98], Avg: 466.4622 (0.020)
Ep: 431, Reward: 865.3541, Test: 755.9695 [197.30], Avg: 466.6757 (0.020)
Ep: 432, Reward: 746.2108, Test: 848.1782 [148.57], Avg: 467.2136 (0.020)
Ep: 433, Reward: 878.2388, Test: 872.3297 [69.41], Avg: 467.9871 (0.020)
Ep: 434, Reward: 788.2121, Test: 904.2625 [20.78], Avg: 468.9423 (0.020)
Ep: 435, Reward: 1017.2873, Test: 860.3601 [52.77], Avg: 469.7190 (0.020)
Ep: 436, Reward: 764.2644, Test: 884.4078 [15.65], Avg: 470.6321 (0.020)
Ep: 437, Reward: 899.5355, Test: 781.5236 [178.16], Avg: 470.9352 (0.020)
Ep: 438, Reward: 810.6277, Test: 848.2550 [144.78], Avg: 471.4649 (0.020)
Ep: 439, Reward: 935.2181, Test: 827.1924 [169.08], Avg: 471.8891 (0.020)
Ep: 440, Reward: 997.2742, Test: 758.5050 [193.97], Avg: 472.0992 (0.020)
Ep: 441, Reward: 928.4811, Test: 861.1948 [102.89], Avg: 472.7467 (0.020)
Ep: 442, Reward: 1017.4925, Test: 838.5268 [194.07], Avg: 473.1343 (0.020)
Ep: 443, Reward: 980.9591, Test: 838.4202 [179.55], Avg: 473.5526 (0.020)
Ep: 444, Reward: 1088.4694, Test: 923.2639 [14.68], Avg: 474.5302 (0.020)
Ep: 445, Reward: 899.4058, Test: 892.4177 [29.47], Avg: 475.4011 (0.020)
Ep: 446, Reward: 921.9679, Test: 889.9028 [37.36], Avg: 476.2448 (0.020)
Ep: 447, Reward: 952.9019, Test: 849.6880 [146.52], Avg: 476.7514 (0.020)
Ep: 448, Reward: 977.3509, Test: 735.5068 [237.15], Avg: 476.7995 (0.020)
Ep: 449, Reward: 921.2998, Test: 903.7957 [16.19], Avg: 477.7124 (0.020)
Ep: 450, Reward: 852.7240, Test: 911.7379 [20.83], Avg: 478.6286 (0.020)
Ep: 451, Reward: 919.4327, Test: 777.7989 [151.49], Avg: 478.9553 (0.020)
Ep: 452, Reward: 879.1067, Test: 796.8795 [172.80], Avg: 479.2756 (0.020)
Ep: 453, Reward: 917.9820, Test: 828.3335 [137.43], Avg: 479.7418 (0.020)
Ep: 454, Reward: 1040.6155, Test: 834.7724 [165.80], Avg: 480.1577 (0.020)
Ep: 455, Reward: 946.6088, Test: 803.2753 [197.24], Avg: 480.4337 (0.020)
Ep: 456, Reward: 694.5799, Test: 880.4657 [72.59], Avg: 481.1502 (0.020)
Ep: 457, Reward: 875.2119, Test: 703.7281 [255.73], Avg: 481.0778 (0.020)
Ep: 458, Reward: 851.8554, Test: 704.4093 [256.87], Avg: 481.0048 (0.020)
Ep: 459, Reward: 953.0259, Test: 831.4247 [210.46], Avg: 481.3090 (0.020)
Ep: 460, Reward: 913.8129, Test: 850.3735 [166.87], Avg: 481.7476 (0.020)
Ep: 461, Reward: 881.6171, Test: 794.3183 [145.35], Avg: 482.1096 (0.020)
Ep: 462, Reward: 957.4549, Test: 832.2015 [119.08], Avg: 482.6085 (0.020)
Ep: 463, Reward: 783.2241, Test: 898.9816 [28.64], Avg: 483.4442 (0.020)
Ep: 464, Reward: 903.1541, Test: 786.5163 [185.99], Avg: 483.6960 (0.020)
Ep: 465, Reward: 891.0702, Test: 733.7586 [238.42], Avg: 483.7209 (0.020)
Ep: 466, Reward: 782.3933, Test: 778.5156 [152.35], Avg: 484.0260 (0.020)
Ep: 467, Reward: 775.2588, Test: 838.9637 [72.34], Avg: 484.6298 (0.020)
Ep: 468, Reward: 725.7001, Test: 655.1431 [183.65], Avg: 484.6018 (0.020)
Ep: 469, Reward: 719.2139, Test: 673.3784 [228.92], Avg: 484.5164 (0.020)
Ep: 470, Reward: 794.8480, Test: 693.1122 [251.85], Avg: 484.4245 (0.020)
Ep: 471, Reward: 762.7785, Test: 885.5528 [34.21], Avg: 485.2019 (0.020)
Ep: 472, Reward: 929.7438, Test: 713.9163 [186.68], Avg: 485.2908 (0.020)
Ep: 473, Reward: 902.6063, Test: 734.7225 [181.66], Avg: 485.4337 (0.020)
Ep: 474, Reward: 750.8649, Test: 823.6136 [149.99], Avg: 485.8299 (0.020)
Ep: 475, Reward: 896.9397, Test: 786.5013 [170.93], Avg: 486.1025 (0.020)
Ep: 476, Reward: 854.0545, Test: 901.1826 [19.13], Avg: 486.9326 (0.020)
Ep: 477, Reward: 875.0844, Test: 877.5917 [22.28], Avg: 487.7033 (0.020)
Ep: 478, Reward: 939.7001, Test: 821.1436 [180.19], Avg: 488.0232 (0.020)
Ep: 479, Reward: 986.1103, Test: 816.3800 [204.33], Avg: 488.2816 (0.020)
Ep: 480, Reward: 915.6283, Test: 881.7518 [24.29], Avg: 489.0491 (0.020)
Ep: 481, Reward: 905.8462, Test: 834.7336 [170.08], Avg: 489.4134 (0.020)
Ep: 482, Reward: 904.3696, Test: 788.4738 [145.43], Avg: 489.7315 (0.020)
Ep: 483, Reward: 849.3823, Test: 730.5731 [261.43], Avg: 489.6890 (0.020)
Ep: 484, Reward: 843.2119, Test: 833.9415 [140.02], Avg: 490.1101 (0.020)
Ep: 485, Reward: 955.3427, Test: 793.9732 [192.41], Avg: 490.3394 (0.020)
Ep: 486, Reward: 947.6043, Test: 776.2813 [247.59], Avg: 490.4182 (0.020)
Ep: 487, Reward: 945.3096, Test: 899.4957 [25.09], Avg: 491.2050 (0.020)
Ep: 488, Reward: 945.0439, Test: 892.6186 [14.43], Avg: 491.9964 (0.020)
Ep: 489, Reward: 1004.3204, Test: 880.4451 [72.50], Avg: 492.6412 (0.020)
Ep: 490, Reward: 911.0932, Test: 894.6817 [16.93], Avg: 493.4255 (0.020)
Ep: 491, Reward: 937.8088, Test: 887.6682 [21.82], Avg: 494.1825 (0.020)
Ep: 492, Reward: 890.6402, Test: 875.0069 [37.38], Avg: 494.8791 (0.020)
Ep: 493, Reward: 943.6671, Test: 875.9984 [33.22], Avg: 495.5834 (0.020)
Ep: 494, Reward: 893.2126, Test: 857.8697 [101.29], Avg: 496.1107 (0.020)
Ep: 495, Reward: 913.0784, Test: 845.6845 [168.13], Avg: 496.4765 (0.020)
Ep: 496, Reward: 978.9117, Test: 831.1915 [173.94], Avg: 496.8000 (0.020)
Ep: 497, Reward: 978.3268, Test: 890.2145 [20.71], Avg: 497.5484 (0.020)
Ep: 498, Reward: 892.0201, Test: 895.3238 [26.75], Avg: 498.2919 (0.020)
Ep: 499, Reward: 923.0748, Test: 866.1599 [73.46], Avg: 498.8807 (0.020)
