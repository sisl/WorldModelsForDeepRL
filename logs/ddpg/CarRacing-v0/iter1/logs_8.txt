Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/


import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.01                	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 50					# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.1                 	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

Ep: 0, Reward: -64.1321, Test: -66.6639 [28.71], Avg: -95.3760 (0.980)
Ep: 1, Reward: -60.3350, Test: -49.7612 [27.94], Avg: -86.5392 (0.960)
Ep: 2, Reward: -62.2235, Test: -59.0243 [29.29], Avg: -87.1320 (0.941)
Ep: 3, Reward: -55.9158, Test: -47.1700 [22.48], Avg: -82.7604 (0.922)
Ep: 4, Reward: -59.4188, Test: -52.7456 [20.07], Avg: -80.7720 (0.904)
Ep: 5, Reward: -50.6127, Test: -53.8608 [24.24], Avg: -80.3273 (0.886)
Ep: 6, Reward: -63.6600, Test: -47.0673 [35.78], Avg: -80.6869 (0.868)
Ep: 7, Reward: -56.9550, Test: -53.1574 [20.44], Avg: -79.8009 (0.851)
Ep: 8, Reward: -57.1811, Test: -57.4167 [18.84], Avg: -79.4071 (0.834)
Ep: 9, Reward: -58.5092, Test: -60.7742 [14.94], Avg: -79.0375 (0.817)
Ep: 10, Reward: -47.4880, Test: -55.0272 [17.35], Avg: -78.4320 (0.801)
Ep: 11, Reward: -50.5212, Test: -58.7240 [15.92], Avg: -78.1167 (0.785)
Ep: 12, Reward: -43.5907, Test: -47.8919 [21.43], Avg: -77.4403 (0.769)
Ep: 13, Reward: -62.8842, Test: -45.1615 [24.83], Avg: -76.9084 (0.754)
Ep: 14, Reward: -52.9878, Test: -47.3275 [22.87], Avg: -76.4608 (0.739)
Ep: 15, Reward: -54.3314, Test: -62.7482 [14.21], Avg: -76.4919 (0.724)
Ep: 16, Reward: -59.8701, Test: -60.6213 [19.41], Avg: -76.7003 (0.709)
Ep: 17, Reward: -44.4834, Test: -65.5497 [42.90], Avg: -78.4640 (0.695)
Ep: 18, Reward: -50.7068, Test: -48.0817 [32.60], Avg: -78.5807 (0.681)
Ep: 19, Reward: -46.8135, Test: -61.9604 [16.31], Avg: -78.5654 (0.668)
Ep: 20, Reward: -52.6410, Test: -41.6479 [29.81], Avg: -78.2270 (0.654)
Ep: 21, Reward: -43.1248, Test: -48.2644 [22.20], Avg: -77.8741 (0.641)
Ep: 22, Reward: -50.9144, Test: -43.3874 [30.52], Avg: -77.7016 (0.628)
Ep: 23, Reward: -39.9161, Test: -56.0376 [20.04], Avg: -77.6339 (0.616)
Ep: 24, Reward: -48.1400, Test: -46.3818 [22.86], Avg: -77.2983 (0.603)
Ep: 25, Reward: -23.0742, Test: -32.0820 [15.66], Avg: -76.1614 (0.591)
Ep: 26, Reward: -40.5521, Test: -49.9087 [30.38], Avg: -76.3143 (0.580)
Ep: 27, Reward: -30.0651, Test: -45.4062 [39.94], Avg: -76.6369 (0.568)
Ep: 28, Reward: -44.3946, Test: -35.8126 [24.80], Avg: -76.0844 (0.557)
Ep: 29, Reward: -46.3943, Test: -8.8636 [56.81], Avg: -75.7374 (0.545)
Ep: 30, Reward: -17.1689, Test: -16.6728 [28.34], Avg: -74.7464 (0.535)
Ep: 31, Reward: -8.5244, Test: -4.1846 [36.66], Avg: -73.6871 (0.524)
Ep: 32, Reward: -8.5387, Test: 32.4791 [90.27], Avg: -73.2054 (0.513)
Ep: 33, Reward: 2.0341, Test: 18.0625 [55.15], Avg: -72.1430 (0.503)
Ep: 34, Reward: 22.2832, Test: 59.1405 [105.91], Avg: -71.4180 (0.493)
Ep: 35, Reward: 14.6231, Test: 8.1079 [50.23], Avg: -70.6042 (0.483)
Ep: 36, Reward: 7.6274, Test: 41.8513 [103.84], Avg: -70.3712 (0.474)
Ep: 37, Reward: 42.5729, Test: 8.5337 [72.37], Avg: -70.1993 (0.464)
Ep: 38, Reward: -5.6855, Test: 8.0457 [70.70], Avg: -70.0058 (0.455)
Ep: 39, Reward: 0.5438, Test: 43.6821 [96.35], Avg: -69.5725 (0.446)
Ep: 40, Reward: 12.2882, Test: 27.4814 [73.49], Avg: -68.9979 (0.437)
Ep: 41, Reward: 7.7447, Test: 84.6922 [104.22], Avg: -67.8200 (0.428)
Ep: 42, Reward: 85.9712, Test: 16.2238 [66.00], Avg: -67.4005 (0.419)
Ep: 43, Reward: 49.4059, Test: 10.7309 [40.09], Avg: -66.5360 (0.411)
Ep: 44, Reward: 70.1003, Test: 95.4862 [136.54], Avg: -65.9698 (0.403)
Ep: 45, Reward: 68.7823, Test: 79.4535 [139.30], Avg: -65.8366 (0.395)
Ep: 46, Reward: 85.7655, Test: 80.1437 [141.36], Avg: -65.7384 (0.387)
Ep: 47, Reward: 72.7550, Test: 87.4007 [110.39], Avg: -64.8479 (0.379)
Ep: 48, Reward: 124.9929, Test: 71.6028 [111.44], Avg: -64.3375 (0.372)
Ep: 49, Reward: 86.2451, Test: 146.1356 [181.03], Avg: -63.7488 (0.364)
Ep: 50, Reward: 136.2667, Test: 59.6473 [145.56], Avg: -64.1834 (0.357)
Ep: 51, Reward: 87.4674, Test: 115.5145 [133.28], Avg: -63.2907 (0.350)
Ep: 52, Reward: 119.2328, Test: 77.3940 [120.13], Avg: -62.9030 (0.343)
Ep: 53, Reward: 156.5089, Test: 239.6511 [129.23], Avg: -59.6933 (0.336)
Ep: 54, Reward: 177.4472, Test: 136.0806 [164.39], Avg: -59.1227 (0.329)
Ep: 55, Reward: 112.4202, Test: 114.9114 [129.07], Avg: -58.3198 (0.323)
Ep: 56, Reward: 67.8881, Test: 118.9796 [173.90], Avg: -58.2601 (0.316)
Ep: 57, Reward: 64.4611, Test: 59.1845 [102.30], Avg: -57.9991 (0.310)
Ep: 58, Reward: 116.9008, Test: 97.2724 [126.66], Avg: -57.5141 (0.304)
Ep: 59, Reward: 90.8610, Test: 159.7265 [154.53], Avg: -56.4689 (0.298)
Ep: 60, Reward: 94.4520, Test: 128.3586 [126.00], Avg: -55.5046 (0.292)
Ep: 61, Reward: 159.0959, Test: 285.9441 [167.98], Avg: -52.7067 (0.286)
Ep: 62, Reward: 243.2215, Test: 261.4671 [145.99], Avg: -50.0371 (0.280)
Ep: 63, Reward: 162.5659, Test: 118.0840 [139.05], Avg: -49.5828 (0.274)
Ep: 64, Reward: 154.6579, Test: 232.9993 [238.46], Avg: -48.9041 (0.269)
Ep: 65, Reward: 278.3497, Test: 194.7641 [157.84], Avg: -47.6038 (0.264)
Ep: 66, Reward: 262.5543, Test: 259.8953 [270.48], Avg: -47.0512 (0.258)
Ep: 67, Reward: 226.7620, Test: 249.5225 [181.89], Avg: -45.3647 (0.253)
Ep: 68, Reward: 332.6862, Test: 416.5104 [191.34], Avg: -41.4440 (0.248)
Ep: 69, Reward: 269.8351, Test: 301.3098 [132.16], Avg: -38.4355 (0.243)
Ep: 70, Reward: 351.0970, Test: 95.1522 [145.59], Avg: -38.6046 (0.238)
Ep: 71, Reward: 333.0532, Test: 326.8492 [217.30], Avg: -36.5469 (0.233)
Ep: 72, Reward: 290.5665, Test: 264.5591 [145.56], Avg: -34.4161 (0.229)
Ep: 73, Reward: 345.7588, Test: 374.0071 [208.09], Avg: -31.7088 (0.224)
Ep: 74, Reward: 353.4637, Test: 389.0298 [198.51], Avg: -28.7458 (0.220)
Ep: 75, Reward: 310.8581, Test: 260.4217 [214.73], Avg: -27.7663 (0.215)
Ep: 76, Reward: 390.3102, Test: 542.4869 [247.49], Avg: -23.5746 (0.211)
Ep: 77, Reward: 385.0954, Test: 488.9403 [155.31], Avg: -18.9951 (0.207)
Ep: 78, Reward: 462.0424, Test: 437.8919 [229.48], Avg: -16.1165 (0.203)
Ep: 79, Reward: 396.5747, Test: 497.6878 [200.66], Avg: -12.2022 (0.199)
Ep: 80, Reward: 508.4911, Test: 416.2116 [207.75], Avg: -9.4779 (0.195)
Ep: 81, Reward: 500.5854, Test: 474.2816 [206.40], Avg: -6.0954 (0.191)
Ep: 82, Reward: 479.9635, Test: 450.5769 [164.86], Avg: -2.5796 (0.187)
Ep: 83, Reward: 497.3313, Test: 517.1835 [182.06], Avg: 1.4406 (0.183)
Ep: 84, Reward: 503.6484, Test: 455.5112 [148.82], Avg: 5.0319 (0.180)
Ep: 85, Reward: 536.2165, Test: 522.8700 [222.74], Avg: 8.4632 (0.176)
Ep: 86, Reward: 497.6487, Test: 432.4667 [212.63], Avg: 10.8928 (0.172)
Ep: 87, Reward: 444.9909, Test: 429.2449 [229.40], Avg: 13.0399 (0.169)
Ep: 88, Reward: 538.5574, Test: 583.6837 [177.03], Avg: 17.4625 (0.166)
Ep: 89, Reward: 519.3044, Test: 567.0134 [187.30], Avg: 21.4875 (0.162)
Ep: 90, Reward: 507.4663, Test: 504.7082 [229.05], Avg: 24.2807 (0.159)
Ep: 91, Reward: 584.2125, Test: 652.2343 [186.08], Avg: 29.0837 (0.156)
Ep: 92, Reward: 598.2436, Test: 458.7138 [223.24], Avg: 31.3029 (0.153)
Ep: 93, Reward: 527.8421, Test: 573.7031 [289.72], Avg: 33.9910 (0.150)
Ep: 94, Reward: 635.2803, Test: 580.4094 [173.95], Avg: 37.9117 (0.147)
Ep: 95, Reward: 683.4794, Test: 608.5470 [195.03], Avg: 41.8243 (0.144)
Ep: 96, Reward: 581.0083, Test: 623.1104 [244.97], Avg: 45.2915 (0.141)
Ep: 97, Reward: 616.9789, Test: 591.5914 [198.24], Avg: 48.8431 (0.138)
Ep: 98, Reward: 597.9345, Test: 597.7400 [230.30], Avg: 52.0613 (0.135)
Ep: 99, Reward: 577.0453, Test: 540.6562 [256.94], Avg: 54.3778 (0.133)
Ep: 100, Reward: 685.1136, Test: 597.9572 [170.43], Avg: 58.0723 (0.130)
Ep: 101, Reward: 552.4073, Test: 616.7632 [203.42], Avg: 61.5554 (0.127)
Ep: 102, Reward: 547.3053, Test: 489.1828 [171.19], Avg: 64.0451 (0.125)
Ep: 103, Reward: 569.9294, Test: 583.2680 [183.24], Avg: 67.2756 (0.122)
Ep: 104, Reward: 618.9944, Test: 442.7411 [198.30], Avg: 68.9629 (0.120)
Ep: 105, Reward: 511.2927, Test: 658.6965 [171.34], Avg: 72.9100 (0.117)
Ep: 106, Reward: 527.6283, Test: 604.3670 [185.53], Avg: 76.1430 (0.115)
Ep: 107, Reward: 591.7969, Test: 535.3301 [212.10], Avg: 78.4309 (0.113)
Ep: 108, Reward: 486.9388, Test: 688.0404 [175.49], Avg: 82.4136 (0.111)
Ep: 109, Reward: 660.5962, Test: 549.9556 [179.57], Avg: 85.0315 (0.108)
Ep: 110, Reward: 551.5869, Test: 522.6313 [155.84], Avg: 87.5699 (0.106)
Ep: 111, Reward: 546.9284, Test: 511.9102 [213.60], Avg: 89.4515 (0.104)
Ep: 112, Reward: 504.8016, Test: 560.7474 [161.66], Avg: 92.1916 (0.102)
Ep: 113, Reward: 549.8526, Test: 509.0873 [171.44], Avg: 94.3447 (0.100)
Ep: 114, Reward: 438.0229, Test: 509.1050 [163.53], Avg: 96.5294 (0.098)
Ep: 115, Reward: 546.0392, Test: 522.1063 [152.83], Avg: 98.8807 (0.096)
Ep: 116, Reward: 538.8014, Test: 511.4442 [160.27], Avg: 101.0371 (0.094)
Ep: 117, Reward: 468.9937, Test: 617.4991 [124.17], Avg: 104.3616 (0.092)
Ep: 118, Reward: 527.0449, Test: 367.5169 [158.43], Avg: 105.2416 (0.090)
Ep: 119, Reward: 389.5862, Test: 513.9070 [168.35], Avg: 107.2442 (0.089)
Ep: 120, Reward: 528.2670, Test: 410.0579 [161.74], Avg: 108.4101 (0.087)
Ep: 121, Reward: 405.1742, Test: 497.1362 [115.80], Avg: 110.6472 (0.085)
Ep: 122, Reward: 529.6228, Test: 587.7532 [202.37], Avg: 112.8809 (0.083)
Ep: 123, Reward: 434.0196, Test: 524.5367 [154.75], Avg: 114.9527 (0.082)
Ep: 124, Reward: 503.2418, Test: 448.2605 [191.77], Avg: 116.0850 (0.080)
Ep: 125, Reward: 471.4512, Test: 499.9044 [162.56], Avg: 117.8410 (0.078)
Ep: 126, Reward: 470.4704, Test: 600.9341 [179.67], Avg: 120.2302 (0.077)
Ep: 127, Reward: 496.8448, Test: 415.9566 [132.83], Avg: 121.5028 (0.075)
Ep: 128, Reward: 499.1413, Test: 465.7284 [184.95], Avg: 122.7374 (0.074)
Ep: 129, Reward: 375.5986, Test: 497.7377 [144.52], Avg: 124.5104 (0.072)
Ep: 130, Reward: 419.3027, Test: 484.0599 [131.08], Avg: 126.2544 (0.071)
Ep: 131, Reward: 405.1623, Test: 417.6340 [141.96], Avg: 127.3864 (0.069)
Ep: 132, Reward: 459.9930, Test: 366.2610 [85.30], Avg: 128.5411 (0.068)
Ep: 133, Reward: 469.6941, Test: 426.9633 [150.22], Avg: 129.6470 (0.067)
Ep: 134, Reward: 461.0912, Test: 444.0996 [171.78], Avg: 130.7038 (0.065)
Ep: 135, Reward: 490.3601, Test: 417.3884 [122.41], Avg: 131.9117 (0.064)
Ep: 136, Reward: 465.0971, Test: 453.6412 [170.13], Avg: 133.0183 (0.063)
Ep: 137, Reward: 480.4621, Test: 560.4691 [169.89], Avg: 134.8846 (0.062)
Ep: 138, Reward: 383.4148, Test: 358.4486 [151.50], Avg: 135.4031 (0.060)
Ep: 139, Reward: 397.4432, Test: 417.5300 [102.66], Avg: 136.6850 (0.059)
Ep: 140, Reward: 407.4620, Test: 459.1541 [199.94], Avg: 137.5540 (0.058)
Ep: 141, Reward: 402.9795, Test: 447.4443 [195.26], Avg: 138.3613 (0.057)
Ep: 142, Reward: 396.1117, Test: 428.6299 [169.02], Avg: 139.2092 (0.056)
Ep: 143, Reward: 357.4859, Test: 464.5512 [118.86], Avg: 140.6431 (0.055)
Ep: 144, Reward: 444.3490, Test: 551.0422 [169.94], Avg: 142.3014 (0.053)
Ep: 145, Reward: 611.8241, Test: 439.2357 [214.81], Avg: 142.8640 (0.052)
Ep: 146, Reward: 442.1196, Test: 415.2598 [272.61], Avg: 142.8625 (0.051)
Ep: 147, Reward: 470.5533, Test: 559.8564 [187.22], Avg: 144.4150 (0.050)
Ep: 148, Reward: 483.7581, Test: 590.6852 [243.68], Avg: 145.7747 (0.049)
Ep: 149, Reward: 609.8585, Test: 629.9141 [236.75], Avg: 147.4239 (0.048)
Ep: 150, Reward: 516.7901, Test: 395.3890 [181.39], Avg: 147.8649 (0.047)
Ep: 151, Reward: 503.3459, Test: 533.9743 [284.51], Avg: 148.5332 (0.046)
Ep: 152, Reward: 416.8658, Test: 545.2347 [202.39], Avg: 149.8033 (0.045)
Ep: 153, Reward: 710.4168, Test: 529.5883 [210.20], Avg: 150.9045 (0.045)
Ep: 154, Reward: 610.9092, Test: 615.4076 [227.22], Avg: 152.4353 (0.044)
Ep: 155, Reward: 608.4969, Test: 593.4334 [257.08], Avg: 153.6143 (0.043)
Ep: 156, Reward: 695.7261, Test: 565.4207 [226.12], Avg: 154.7970 (0.042)
Ep: 157, Reward: 612.8687, Test: 825.6289 [69.32], Avg: 158.6041 (0.041)
Ep: 158, Reward: 715.7065, Test: 460.9324 [221.72], Avg: 159.1111 (0.040)
Ep: 159, Reward: 528.4500, Test: 637.6306 [231.08], Avg: 160.6575 (0.039)
Ep: 160, Reward: 572.4364, Test: 439.9049 [200.07], Avg: 161.1493 (0.039)
Ep: 161, Reward: 446.9479, Test: 526.8243 [214.77], Avg: 162.0809 (0.038)
Ep: 162, Reward: 622.7709, Test: 689.8178 [192.28], Avg: 164.1389 (0.037)
Ep: 163, Reward: 622.0143, Test: 455.3173 [182.31], Avg: 164.8027 (0.036)
Ep: 164, Reward: 464.1769, Test: 488.7243 [182.17], Avg: 165.6618 (0.036)
Ep: 165, Reward: 470.8274, Test: 564.8547 [202.20], Avg: 166.8485 (0.035)
Ep: 166, Reward: 612.8814, Test: 659.2984 [266.32], Avg: 168.2026 (0.034)
Ep: 167, Reward: 506.2829, Test: 493.8860 [243.95], Avg: 168.6891 (0.034)
Ep: 168, Reward: 618.3349, Test: 604.9942 [201.27], Avg: 170.0798 (0.033)
Ep: 169, Reward: 569.7539, Test: 596.9622 [217.05], Avg: 171.3141 (0.032)
Ep: 170, Reward: 507.6159, Test: 648.2246 [179.36], Avg: 173.0542 (0.032)
Ep: 171, Reward: 601.4266, Test: 579.6000 [218.16], Avg: 174.1495 (0.031)
Ep: 172, Reward: 488.9064, Test: 359.0619 [210.86], Avg: 173.9995 (0.030)
Ep: 173, Reward: 530.5421, Test: 593.3006 [264.73], Avg: 174.8878 (0.030)
Ep: 174, Reward: 590.6073, Test: 639.4303 [211.13], Avg: 176.3359 (0.029)
Ep: 175, Reward: 576.0031, Test: 547.9644 [178.67], Avg: 177.4322 (0.029)
Ep: 176, Reward: 591.8546, Test: 716.6967 [165.52], Avg: 179.5438 (0.028)
Ep: 177, Reward: 578.7671, Test: 672.4943 [164.34], Avg: 181.3899 (0.027)
Ep: 178, Reward: 667.6637, Test: 745.4986 [146.05], Avg: 183.7254 (0.027)
Ep: 179, Reward: 553.5616, Test: 659.0981 [205.87], Avg: 185.2227 (0.026)
Ep: 180, Reward: 571.9913, Test: 628.9681 [255.96], Avg: 186.2601 (0.026)
Ep: 181, Reward: 626.5639, Test: 684.9578 [195.06], Avg: 187.9285 (0.025)
Ep: 182, Reward: 617.9319, Test: 565.8514 [175.43], Avg: 189.0350 (0.025)
Ep: 183, Reward: 697.0250, Test: 420.7845 [193.56], Avg: 189.2426 (0.024)
Ep: 184, Reward: 602.6232, Test: 709.2157 [114.17], Avg: 191.4361 (0.024)
Ep: 185, Reward: 575.6747, Test: 501.3794 [275.67], Avg: 191.6204 (0.023)
Ep: 186, Reward: 613.6140, Test: 631.1336 [182.86], Avg: 192.9929 (0.023)
Ep: 187, Reward: 755.1697, Test: 752.8610 [159.38], Avg: 195.1231 (0.022)
Ep: 188, Reward: 633.8224, Test: 633.0739 [185.75], Avg: 196.4575 (0.022)
Ep: 189, Reward: 599.0497, Test: 547.4402 [156.41], Avg: 197.4816 (0.022)
Ep: 190, Reward: 557.6934, Test: 619.2764 [191.07], Avg: 198.6896 (0.021)
Ep: 191, Reward: 667.1968, Test: 564.2078 [268.61], Avg: 199.1943 (0.021)
Ep: 192, Reward: 599.7591, Test: 431.3907 [259.71], Avg: 199.0518 (0.020)
Ep: 193, Reward: 576.0865, Test: 542.1865 [249.31], Avg: 199.5354 (0.020)
Ep: 194, Reward: 525.1908, Test: 447.7591 [263.32], Avg: 199.4579 (0.019)
Ep: 195, Reward: 512.9395, Test: 394.2919 [136.16], Avg: 199.7573 (0.019)
Ep: 196, Reward: 410.9188, Test: 467.4950 [188.30], Avg: 200.1605 (0.019)
Ep: 197, Reward: 593.7948, Test: 555.8502 [181.91], Avg: 201.0382 (0.018)
Ep: 198, Reward: 572.7678, Test: 356.3101 [136.93], Avg: 201.1303 (0.018)
Ep: 199, Reward: 565.9233, Test: 650.2016 [238.94], Avg: 202.1810 (0.018)
Ep: 200, Reward: 596.2963, Test: 790.4989 [28.96], Avg: 204.9639 (0.017)
Ep: 201, Reward: 582.3405, Test: 633.2309 [245.77], Avg: 205.8673 (0.017)
Ep: 202, Reward: 609.2841, Test: 673.9885 [179.31], Avg: 207.2901 (0.017)
Ep: 203, Reward: 735.9422, Test: 456.4449 [194.51], Avg: 207.5579 (0.016)
Ep: 204, Reward: 607.9653, Test: 704.3536 [159.72], Avg: 209.2022 (0.016)
Ep: 205, Reward: 680.8446, Test: 586.9324 [232.00], Avg: 209.9097 (0.016)
Ep: 206, Reward: 616.1586, Test: 646.9570 [177.88], Avg: 211.1617 (0.015)
Ep: 207, Reward: 609.9878, Test: 702.5074 [170.56], Avg: 212.7039 (0.015)
Ep: 208, Reward: 723.6030, Test: 574.2429 [255.15], Avg: 213.2130 (0.015)
Ep: 209, Reward: 679.6905, Test: 788.3321 [74.99], Avg: 215.5945 (0.014)
Ep: 210, Reward: 712.0691, Test: 807.4800 [95.87], Avg: 217.9453 (0.014)
Ep: 211, Reward: 603.9750, Test: 742.9793 [207.15], Avg: 219.4448 (0.014)
Ep: 212, Reward: 515.2954, Test: 655.2453 [206.54], Avg: 220.5211 (0.014)
Ep: 213, Reward: 639.7296, Test: 611.1539 [259.10], Avg: 221.1358 (0.013)
Ep: 214, Reward: 661.5612, Test: 635.9379 [247.36], Avg: 221.9145 (0.013)
Ep: 215, Reward: 713.4290, Test: 755.1739 [201.04], Avg: 223.4526 (0.013)
Ep: 216, Reward: 715.8323, Test: 731.6514 [151.61], Avg: 225.0959 (0.012)
Ep: 217, Reward: 712.0160, Test: 765.7568 [233.54], Avg: 226.5047 (0.012)
Ep: 218, Reward: 731.7181, Test: 771.0843 [98.11], Avg: 228.5434 (0.012)
Ep: 219, Reward: 741.6427, Test: 801.1941 [69.95], Avg: 230.8284 (0.012)
Ep: 220, Reward: 829.9305, Test: 836.6991 [78.99], Avg: 233.2124 (0.012)
Ep: 221, Reward: 797.9304, Test: 787.9546 [64.55], Avg: 235.4205 (0.011)
Ep: 222, Reward: 770.3886, Test: 712.3388 [185.69], Avg: 236.7264 (0.011)
Ep: 223, Reward: 792.4596, Test: 836.1783 [81.90], Avg: 239.0369 (0.011)
Ep: 224, Reward: 786.1730, Test: 755.8866 [163.22], Avg: 240.6086 (0.011)
Ep: 225, Reward: 868.7994, Test: 832.2512 [104.44], Avg: 242.7644 (0.010)
Ep: 226, Reward: 854.7489, Test: 863.2859 [23.99], Avg: 245.3923 (0.010)
Ep: 227, Reward: 761.9262, Test: 793.0482 [155.94], Avg: 247.1103 (0.010)
Ep: 228, Reward: 879.8453, Test: 638.8956 [236.71], Avg: 247.7875 (0.010)
Ep: 229, Reward: 797.6511, Test: 814.1461 [153.91], Avg: 249.5807 (0.010)
Ep: 230, Reward: 783.1804, Test: 732.6658 [260.94], Avg: 250.5424 (0.010)
Ep: 231, Reward: 826.1685, Test: 855.6298 [34.66], Avg: 253.0012 (0.010)
Ep: 232, Reward: 748.6289, Test: 782.8889 [162.03], Avg: 254.5800 (0.010)
Ep: 233, Reward: 766.6758, Test: 848.2113 [89.17], Avg: 256.7358 (0.010)
Ep: 234, Reward: 801.6556, Test: 757.9906 [184.01], Avg: 258.0858 (0.010)
Ep: 235, Reward: 843.8744, Test: 850.4273 [47.42], Avg: 260.3948 (0.010)
Ep: 236, Reward: 820.6100, Test: 868.8902 [45.65], Avg: 262.7697 (0.010)
Ep: 237, Reward: 821.2664, Test: 742.8619 [168.08], Avg: 264.0806 (0.010)
Ep: 238, Reward: 853.5706, Test: 784.5892 [136.55], Avg: 265.6872 (0.010)
Ep: 239, Reward: 809.2312, Test: 743.2097 [205.32], Avg: 266.8213 (0.010)
Ep: 240, Reward: 843.2808, Test: 787.2847 [177.05], Avg: 268.2463 (0.010)
Ep: 241, Reward: 841.9776, Test: 858.7605 [19.27], Avg: 270.6068 (0.010)
Ep: 242, Reward: 761.7330, Test: 820.4820 [143.45], Avg: 272.2793 (0.010)
Ep: 243, Reward: 834.9890, Test: 871.6573 [34.51], Avg: 274.5944 (0.010)
Ep: 244, Reward: 790.0501, Test: 877.8375 [17.01], Avg: 276.9872 (0.010)
Ep: 245, Reward: 875.0049, Test: 821.2251 [131.52], Avg: 278.6649 (0.010)
Ep: 246, Reward: 741.9438, Test: 690.7259 [181.29], Avg: 279.5992 (0.010)
Ep: 247, Reward: 744.4952, Test: 673.1897 [193.91], Avg: 280.4043 (0.010)
Ep: 248, Reward: 767.9743, Test: 857.6355 [61.17], Avg: 282.4769 (0.010)
Ep: 249, Reward: 817.6835, Test: 850.0109 [45.76], Avg: 284.5640 (0.010)
Ep: 250, Reward: 774.9203, Test: 832.4220 [45.93], Avg: 286.5637 (0.010)
Ep: 251, Reward: 804.5134, Test: 852.3907 [29.64], Avg: 288.6914 (0.010)
Ep: 252, Reward: 813.4870, Test: 767.9747 [193.95], Avg: 289.8192 (0.010)
Ep: 253, Reward: 799.4185, Test: 817.2981 [119.61], Avg: 291.4250 (0.010)
Ep: 254, Reward: 806.5511, Test: 833.7940 [100.71], Avg: 293.1570 (0.010)
Ep: 255, Reward: 866.0211, Test: 816.8380 [140.35], Avg: 294.6544 (0.010)
Ep: 256, Reward: 819.4678, Test: 797.5472 [118.83], Avg: 296.1488 (0.010)
Ep: 257, Reward: 868.0292, Test: 892.9053 [26.58], Avg: 298.3587 (0.010)
Ep: 258, Reward: 899.3733, Test: 861.6424 [36.24], Avg: 300.3936 (0.010)
Ep: 259, Reward: 882.9912, Test: 633.3471 [228.54], Avg: 300.7952 (0.010)
Ep: 260, Reward: 782.5485, Test: 838.5268 [114.40], Avg: 302.4172 (0.010)
Ep: 261, Reward: 860.1545, Test: 803.0294 [144.38], Avg: 303.7769 (0.010)
Ep: 262, Reward: 790.3698, Test: 854.9365 [37.82], Avg: 305.7287 (0.010)
Ep: 263, Reward: 780.4271, Test: 829.0125 [140.64], Avg: 307.1782 (0.010)
Ep: 264, Reward: 873.3603, Test: 840.1277 [43.13], Avg: 309.0265 (0.010)
Ep: 265, Reward: 798.2654, Test: 849.7782 [144.52], Avg: 310.5161 (0.010)
Ep: 266, Reward: 710.9637, Test: 711.6949 [215.10], Avg: 311.2131 (0.010)
Ep: 267, Reward: 806.9843, Test: 807.3730 [84.79], Avg: 312.7480 (0.010)
Ep: 268, Reward: 685.7604, Test: 726.3419 [171.76], Avg: 313.6471 (0.010)
Ep: 269, Reward: 721.8346, Test: 856.8275 [51.44], Avg: 315.4683 (0.010)
Ep: 270, Reward: 788.8742, Test: 802.8295 [143.44], Avg: 316.7374 (0.010)
Ep: 271, Reward: 731.0354, Test: 676.4445 [178.46], Avg: 317.4038 (0.010)
Ep: 272, Reward: 707.8229, Test: 822.5631 [127.57], Avg: 318.7869 (0.010)
Ep: 273, Reward: 677.2547, Test: 622.6698 [238.17], Avg: 319.0267 (0.010)
Ep: 274, Reward: 756.5337, Test: 690.5628 [176.78], Avg: 319.7349 (0.010)
Ep: 275, Reward: 608.8019, Test: 749.4607 [160.68], Avg: 320.7098 (0.010)
Ep: 276, Reward: 736.9458, Test: 771.1112 [143.59], Avg: 321.8174 (0.010)
Ep: 277, Reward: 757.3162, Test: 865.7409 [25.31], Avg: 323.6829 (0.010)
Ep: 278, Reward: 752.4252, Test: 714.9423 [185.30], Avg: 324.4211 (0.010)
Ep: 279, Reward: 591.3620, Test: 778.4226 [77.72], Avg: 325.7650 (0.010)
Ep: 280, Reward: 817.6552, Test: 796.0110 [135.26], Avg: 326.9571 (0.010)
Ep: 281, Reward: 890.3813, Test: 671.7745 [151.37], Avg: 327.6431 (0.010)
Ep: 282, Reward: 741.8743, Test: 797.7623 [147.58], Avg: 328.7828 (0.010)
Ep: 283, Reward: 820.4168, Test: 797.4102 [100.78], Avg: 330.0780 (0.010)
Ep: 284, Reward: 764.2604, Test: 786.6078 [142.74], Avg: 331.1791 (0.010)
Ep: 285, Reward: 634.1290, Test: 707.4603 [159.96], Avg: 331.9354 (0.010)
Ep: 286, Reward: 854.0912, Test: 726.4286 [176.36], Avg: 332.6954 (0.010)
Ep: 287, Reward: 702.1843, Test: 835.7856 [60.30], Avg: 334.2329 (0.010)
Ep: 288, Reward: 724.5901, Test: 731.7531 [183.83], Avg: 334.9723 (0.010)
Ep: 289, Reward: 730.9532, Test: 819.0559 [109.51], Avg: 336.2640 (0.010)
Ep: 290, Reward: 837.0156, Test: 830.9769 [100.80], Avg: 337.6176 (0.010)
Ep: 291, Reward: 894.2144, Test: 815.0602 [129.88], Avg: 338.8079 (0.010)
Ep: 292, Reward: 841.1208, Test: 830.0919 [61.27], Avg: 340.2755 (0.010)
Ep: 293, Reward: 800.0070, Test: 818.7799 [127.82], Avg: 341.4684 (0.010)
Ep: 294, Reward: 850.8974, Test: 816.2711 [179.17], Avg: 342.4705 (0.010)
Ep: 295, Reward: 851.4710, Test: 811.4661 [130.03], Avg: 343.6156 (0.010)
Ep: 296, Reward: 669.8004, Test: 685.6082 [243.49], Avg: 343.9473 (0.010)
Ep: 297, Reward: 855.4037, Test: 863.4114 [108.34], Avg: 345.3269 (0.010)
Ep: 298, Reward: 814.0920, Test: 766.3623 [212.54], Avg: 346.0242 (0.010)
Ep: 299, Reward: 883.7157, Test: 714.1644 [203.41], Avg: 346.5733 (0.010)
Ep: 300, Reward: 815.1877, Test: 846.3398 [49.32], Avg: 348.0698 (0.010)
Ep: 301, Reward: 741.9205, Test: 868.9277 [26.43], Avg: 349.7070 (0.010)
Ep: 302, Reward: 831.3920, Test: 682.4831 [255.68], Avg: 349.9615 (0.010)
Ep: 303, Reward: 824.7761, Test: 804.5317 [156.32], Avg: 350.9426 (0.010)
Ep: 304, Reward: 883.4184, Test: 843.1089 [75.44], Avg: 352.3089 (0.010)
Ep: 305, Reward: 745.0896, Test: 813.1139 [126.20], Avg: 353.4023 (0.010)
Ep: 306, Reward: 750.6898, Test: 812.8035 [106.42], Avg: 354.5521 (0.010)
Ep: 307, Reward: 737.7012, Test: 866.3180 [62.61], Avg: 356.0104 (0.010)
Ep: 308, Reward: 888.4172, Test: 754.0975 [178.80], Avg: 356.7201 (0.010)
Ep: 309, Reward: 844.1068, Test: 792.1082 [176.26], Avg: 357.5560 (0.010)
Ep: 310, Reward: 755.8959, Test: 802.7688 [202.53], Avg: 358.3363 (0.010)
Ep: 311, Reward: 767.5035, Test: 837.3955 [182.48], Avg: 359.2869 (0.010)
Ep: 312, Reward: 1012.7648, Test: 738.4367 [240.51], Avg: 359.7298 (0.010)
Ep: 313, Reward: 1009.8066, Test: 805.1799 [118.41], Avg: 360.7714 (0.010)
Ep: 314, Reward: 809.4069, Test: 818.1029 [157.52], Avg: 361.7232 (0.010)
Ep: 315, Reward: 991.9015, Test: 780.2155 [232.97], Avg: 362.3103 (0.010)
Ep: 316, Reward: 894.7094, Test: 916.0758 [19.49], Avg: 363.9957 (0.010)
Ep: 317, Reward: 933.7694, Test: 782.7622 [153.37], Avg: 364.8302 (0.010)
Ep: 318, Reward: 890.8549, Test: 853.8131 [139.49], Avg: 365.9258 (0.010)
Ep: 319, Reward: 747.8515, Test: 809.0609 [94.43], Avg: 367.0155 (0.010)
Ep: 320, Reward: 886.4307, Test: 767.7995 [214.01], Avg: 367.5974 (0.010)
Ep: 321, Reward: 932.2785, Test: 745.8678 [215.66], Avg: 368.1024 (0.010)
Ep: 322, Reward: 800.6785, Test: 806.4502 [129.97], Avg: 369.0571 (0.010)
Ep: 323, Reward: 613.5967, Test: 691.5301 [193.81], Avg: 369.4542 (0.010)
Ep: 324, Reward: 611.7064, Test: 680.7463 [190.07], Avg: 369.8272 (0.010)
Ep: 325, Reward: 764.3456, Test: 519.3973 [258.06], Avg: 369.4944 (0.010)
Ep: 326, Reward: 781.5124, Test: 853.6709 [151.03], Avg: 370.5132 (0.010)
Ep: 327, Reward: 742.6151, Test: 614.8380 [249.56], Avg: 370.4973 (0.010)
Ep: 328, Reward: 785.3788, Test: 753.1822 [249.57], Avg: 370.9019 (0.010)
Ep: 329, Reward: 831.4508, Test: 823.4176 [124.43], Avg: 371.8961 (0.010)
Ep: 330, Reward: 822.4742, Test: 857.0113 [111.57], Avg: 373.0246 (0.010)
Ep: 331, Reward: 793.3949, Test: 758.6942 [185.40], Avg: 373.6279 (0.010)
Ep: 332, Reward: 656.1744, Test: 515.1496 [300.35], Avg: 373.1509 (0.010)
Ep: 333, Reward: 538.4207, Test: 676.3805 [287.02], Avg: 373.1995 (0.010)
Ep: 334, Reward: 803.9707, Test: 798.4904 [195.77], Avg: 373.8846 (0.010)
Ep: 335, Reward: 837.3358, Test: 804.2656 [144.49], Avg: 374.7355 (0.010)
Ep: 336, Reward: 865.5060, Test: 845.7347 [95.70], Avg: 375.8491 (0.010)
Ep: 337, Reward: 828.6115, Test: 879.7896 [67.02], Avg: 377.1418 (0.010)
Ep: 338, Reward: 826.8203, Test: 838.0048 [162.09], Avg: 378.0231 (0.010)
Ep: 339, Reward: 822.0367, Test: 790.9087 [187.86], Avg: 378.6850 (0.010)
Ep: 340, Reward: 876.1967, Test: 842.4500 [87.17], Avg: 379.7894 (0.010)
Ep: 341, Reward: 907.4390, Test: 887.8343 [31.17], Avg: 381.1837 (0.010)
Ep: 342, Reward: 889.4658, Test: 835.2177 [105.01], Avg: 382.2013 (0.010)
Ep: 343, Reward: 849.0910, Test: 817.1793 [160.40], Avg: 382.9995 (0.010)
Ep: 344, Reward: 815.2424, Test: 828.2846 [133.18], Avg: 383.9041 (0.010)
Ep: 345, Reward: 999.3813, Test: 890.5897 [30.13], Avg: 385.2815 (0.010)
Ep: 346, Reward: 926.0401, Test: 898.3218 [22.78], Avg: 386.6943 (0.010)
Ep: 347, Reward: 736.4884, Test: 789.9954 [204.68], Avg: 387.2651 (0.010)
Ep: 348, Reward: 959.8951, Test: 859.5789 [50.22], Avg: 388.4745 (0.010)
Ep: 349, Reward: 922.3142, Test: 886.1613 [19.20], Avg: 389.8416 (0.010)
Ep: 350, Reward: 875.6873, Test: 856.1292 [98.63], Avg: 390.8891 (0.010)
Ep: 351, Reward: 998.6104, Test: 841.0626 [149.08], Avg: 391.7445 (0.010)
Ep: 352, Reward: 1007.7314, Test: 759.5276 [242.84], Avg: 392.0984 (0.010)
Ep: 353, Reward: 810.7840, Test: 876.7795 [70.75], Avg: 393.2677 (0.010)
Ep: 354, Reward: 934.8803, Test: 767.4815 [198.27], Avg: 393.7633 (0.010)
Ep: 355, Reward: 923.0208, Test: 779.9932 [167.80], Avg: 394.3769 (0.010)
Ep: 356, Reward: 835.7664, Test: 848.6039 [137.77], Avg: 395.2633 (0.010)
Ep: 357, Reward: 841.9704, Test: 888.5372 [19.12], Avg: 396.5878 (0.010)
Ep: 358, Reward: 967.5377, Test: 796.6520 [205.33], Avg: 397.1302 (0.010)
Ep: 359, Reward: 930.8487, Test: 884.8265 [52.93], Avg: 398.3379 (0.010)
Ep: 360, Reward: 818.9647, Test: 736.8165 [249.31], Avg: 398.5849 (0.010)
Ep: 361, Reward: 915.2482, Test: 872.3378 [63.36], Avg: 399.7186 (0.010)
Ep: 362, Reward: 940.1247, Test: 846.4283 [125.61], Avg: 400.6031 (0.010)
Ep: 363, Reward: 932.9187, Test: 819.0966 [162.18], Avg: 401.3073 (0.010)
Ep: 364, Reward: 920.3498, Test: 742.6119 [232.91], Avg: 401.6043 (0.010)
Ep: 365, Reward: 917.0259, Test: 905.3056 [35.19], Avg: 402.8843 (0.010)
Ep: 366, Reward: 970.7927, Test: 881.9806 [72.02], Avg: 403.9936 (0.010)
Ep: 367, Reward: 1030.8057, Test: 897.1055 [26.04], Avg: 405.2628 (0.010)
Ep: 368, Reward: 922.5715, Test: 870.5272 [93.06], Avg: 406.2714 (0.010)
Ep: 369, Reward: 1079.7883, Test: 903.9284 [22.63], Avg: 407.5553 (0.010)
Ep: 370, Reward: 897.3357, Test: 875.5759 [59.56], Avg: 408.6563 (0.010)
Ep: 371, Reward: 1042.4414, Test: 891.8563 [16.26], Avg: 409.9115 (0.010)
Ep: 372, Reward: 922.0081, Test: 852.7486 [188.34], Avg: 410.5938 (0.010)
Ep: 373, Reward: 968.8865, Test: 888.4503 [25.84], Avg: 411.8024 (0.010)
Ep: 374, Reward: 917.8841, Test: 833.1032 [139.44], Avg: 412.5540 (0.010)
Ep: 375, Reward: 874.0567, Test: 856.0464 [63.12], Avg: 413.5657 (0.010)
Ep: 376, Reward: 885.9288, Test: 813.4694 [180.53], Avg: 414.1476 (0.010)
Ep: 377, Reward: 955.1508, Test: 890.1704 [26.28], Avg: 415.3374 (0.010)
Ep: 378, Reward: 919.3247, Test: 823.5009 [159.56], Avg: 415.9933 (0.010)
Ep: 379, Reward: 932.7689, Test: 848.7861 [145.78], Avg: 416.7486 (0.010)
Ep: 380, Reward: 813.2638, Test: 900.2724 [23.11], Avg: 417.9571 (0.010)
Ep: 381, Reward: 1064.5807, Test: 883.2262 [101.94], Avg: 418.9082 (0.010)
Ep: 382, Reward: 878.5172, Test: 874.6356 [89.84], Avg: 419.8635 (0.010)
Ep: 383, Reward: 1003.5893, Test: 884.4641 [71.61], Avg: 420.8869 (0.010)
Ep: 384, Reward: 1080.6609, Test: 862.8582 [128.37], Avg: 421.7014 (0.010)
Ep: 385, Reward: 1044.3351, Test: 849.3707 [140.02], Avg: 422.4467 (0.010)
Ep: 386, Reward: 864.9780, Test: 904.3816 [25.69], Avg: 423.6256 (0.010)
Ep: 387, Reward: 941.8234, Test: 858.9159 [60.24], Avg: 424.5922 (0.010)
Ep: 388, Reward: 892.5143, Test: 792.4270 [140.00], Avg: 425.1779 (0.010)
Ep: 389, Reward: 822.1443, Test: 866.9786 [19.68], Avg: 426.2603 (0.010)
Ep: 390, Reward: 938.7857, Test: 905.2309 [17.23], Avg: 427.4412 (0.010)
Ep: 391, Reward: 864.3177, Test: 847.4902 [168.81], Avg: 428.0821 (0.010)
Ep: 392, Reward: 983.2964, Test: 882.7317 [24.86], Avg: 429.1757 (0.010)
Ep: 393, Reward: 863.9798, Test: 858.7866 [34.56], Avg: 430.1784 (0.010)
Ep: 394, Reward: 855.3605, Test: 794.1730 [165.40], Avg: 430.6812 (0.010)
Ep: 395, Reward: 879.0175, Test: 892.2293 [26.69], Avg: 431.7793 (0.010)
Ep: 396, Reward: 907.1829, Test: 761.3995 [180.56], Avg: 432.1548 (0.010)
Ep: 397, Reward: 688.2652, Test: 737.6696 [173.19], Avg: 432.4873 (0.010)
Ep: 398, Reward: 792.0387, Test: 815.7540 [128.55], Avg: 433.1257 (0.010)
Ep: 399, Reward: 829.9106, Test: 822.6347 [148.11], Avg: 433.7292 (0.010)
Ep: 400, Reward: 830.9568, Test: 855.4971 [124.00], Avg: 434.4717 (0.010)
Ep: 401, Reward: 1018.1205, Test: 891.1992 [50.48], Avg: 435.4823 (0.010)
Ep: 402, Reward: 932.3215, Test: 814.6514 [130.37], Avg: 436.0996 (0.010)
Ep: 403, Reward: 934.1195, Test: 864.6221 [62.78], Avg: 437.0050 (0.010)
Ep: 404, Reward: 822.1480, Test: 780.1787 [209.10], Avg: 437.3360 (0.010)
Ep: 405, Reward: 829.6757, Test: 862.9781 [68.07], Avg: 438.2167 (0.010)
Ep: 406, Reward: 949.5379, Test: 758.1946 [169.04], Avg: 438.5876 (0.010)
Ep: 407, Reward: 890.8531, Test: 875.2310 [45.65], Avg: 439.5459 (0.010)
Ep: 408, Reward: 922.7349, Test: 829.0532 [159.74], Avg: 440.1077 (0.010)
Ep: 409, Reward: 916.0919, Test: 862.1992 [56.66], Avg: 440.9990 (0.010)
Ep: 410, Reward: 891.5468, Test: 861.6054 [55.66], Avg: 441.8869 (0.010)
Ep: 411, Reward: 814.2005, Test: 797.0518 [95.76], Avg: 442.5165 (0.010)
Ep: 412, Reward: 841.0130, Test: 816.4940 [154.40], Avg: 443.0482 (0.010)
Ep: 413, Reward: 820.1201, Test: 811.5893 [197.92], Avg: 443.4603 (0.010)
Ep: 414, Reward: 793.7680, Test: 881.0953 [27.99], Avg: 444.4474 (0.010)
Ep: 415, Reward: 837.2905, Test: 841.4577 [111.06], Avg: 445.1348 (0.010)
Ep: 416, Reward: 772.6789, Test: 791.0497 [143.57], Avg: 445.6200 (0.010)
Ep: 417, Reward: 817.3439, Test: 808.9407 [113.73], Avg: 446.2171 (0.010)
Ep: 418, Reward: 846.8225, Test: 791.5016 [213.92], Avg: 446.5306 (0.010)
Ep: 419, Reward: 870.1828, Test: 733.6599 [193.38], Avg: 446.7538 (0.010)
Ep: 420, Reward: 858.8837, Test: 878.5601 [38.12], Avg: 447.6890 (0.010)
Ep: 421, Reward: 952.1185, Test: 821.2019 [117.42], Avg: 448.2958 (0.010)
Ep: 422, Reward: 892.3015, Test: 825.3229 [147.70], Avg: 448.8379 (0.010)
Ep: 423, Reward: 830.9763, Test: 881.3261 [37.24], Avg: 449.7701 (0.010)
Ep: 424, Reward: 866.8978, Test: 883.2473 [29.59], Avg: 450.7205 (0.010)
Ep: 425, Reward: 884.5150, Test: 872.1433 [19.29], Avg: 451.6644 (0.010)
Ep: 426, Reward: 900.0317, Test: 762.2442 [184.74], Avg: 451.9591 (0.010)
Ep: 427, Reward: 914.7416, Test: 849.9132 [62.52], Avg: 452.7429 (0.010)
Ep: 428, Reward: 926.0804, Test: 904.2356 [21.77], Avg: 453.7445 (0.010)
Ep: 429, Reward: 995.2775, Test: 871.4826 [74.51], Avg: 454.5428 (0.010)
Ep: 430, Reward: 948.5828, Test: 878.0784 [8.50], Avg: 455.5057 (0.010)
Ep: 431, Reward: 893.3982, Test: 899.7329 [17.36], Avg: 456.4938 (0.010)
Ep: 432, Reward: 876.0846, Test: 861.9057 [62.85], Avg: 457.2850 (0.010)
Ep: 433, Reward: 873.1489, Test: 883.2178 [32.72], Avg: 458.1910 (0.010)
Ep: 434, Reward: 966.9323, Test: 925.8552 [10.07], Avg: 459.2429 (0.010)
Ep: 435, Reward: 1041.7481, Test: 895.6178 [20.23], Avg: 460.1974 (0.010)
Ep: 436, Reward: 980.1766, Test: 890.2397 [16.64], Avg: 461.1434 (0.010)
Ep: 437, Reward: 928.7805, Test: 904.6516 [19.55], Avg: 462.1113 (0.010)
Ep: 438, Reward: 1112.8437, Test: 907.3799 [18.81], Avg: 463.0828 (0.010)
Ep: 439, Reward: 1098.7080, Test: 906.0553 [19.21], Avg: 464.0459 (0.010)
Ep: 440, Reward: 948.9145, Test: 893.1035 [12.25], Avg: 464.9910 (0.010)
Ep: 441, Reward: 903.7820, Test: 883.3288 [8.15], Avg: 465.9190 (0.010)
Ep: 442, Reward: 1075.4544, Test: 914.0976 [18.51], Avg: 466.8889 (0.010)
Ep: 443, Reward: 1064.1597, Test: 854.7754 [136.23], Avg: 467.4558 (0.010)
Ep: 444, Reward: 1007.8163, Test: 842.7282 [169.23], Avg: 467.9188 (0.010)
Ep: 445, Reward: 864.1465, Test: 811.0191 [211.25], Avg: 468.2144 (0.010)
Ep: 446, Reward: 952.3507, Test: 900.6899 [20.92], Avg: 469.1351 (0.010)
Ep: 447, Reward: 1008.5804, Test: 901.5607 [19.92], Avg: 470.0559 (0.010)
Ep: 448, Reward: 986.2055, Test: 843.2014 [92.28], Avg: 470.6814 (0.010)
Ep: 449, Reward: 960.0194, Test: 775.5556 [183.54], Avg: 470.9510 (0.010)
Ep: 450, Reward: 879.6424, Test: 884.7487 [38.19], Avg: 471.7839 (0.010)
Ep: 451, Reward: 896.3434, Test: 885.5402 [24.26], Avg: 472.6456 (0.010)
Ep: 452, Reward: 1071.4280, Test: 857.3413 [127.01], Avg: 473.2144 (0.010)
Ep: 453, Reward: 950.7767, Test: 894.1259 [16.59], Avg: 474.1050 (0.010)
Ep: 454, Reward: 912.4035, Test: 793.2874 [214.69], Avg: 474.3347 (0.010)
Ep: 455, Reward: 1006.9620, Test: 896.9782 [17.95], Avg: 475.2222 (0.010)
Ep: 456, Reward: 1015.4010, Test: 830.9758 [164.80], Avg: 475.6400 (0.010)
Ep: 457, Reward: 913.4551, Test: 878.9248 [70.43], Avg: 476.3668 (0.010)
Ep: 458, Reward: 869.5668, Test: 859.6305 [139.13], Avg: 476.8986 (0.010)
Ep: 459, Reward: 970.1046, Test: 850.1660 [162.34], Avg: 477.3572 (0.010)
Ep: 460, Reward: 860.7443, Test: 738.6692 [243.40], Avg: 477.3960 (0.010)
Ep: 461, Reward: 751.6557, Test: 702.4521 [201.07], Avg: 477.4479 (0.010)
Ep: 462, Reward: 819.5645, Test: 772.4336 [172.17], Avg: 477.7132 (0.010)
Ep: 463, Reward: 736.0733, Test: 734.5618 [224.47], Avg: 477.7830 (0.010)
Ep: 464, Reward: 818.1869, Test: 769.8824 [239.08], Avg: 477.8970 (0.010)
Ep: 465, Reward: 820.3102, Test: 834.4520 [156.82], Avg: 478.3256 (0.010)
Ep: 466, Reward: 826.9959, Test: 752.0699 [235.75], Avg: 478.4070 (0.010)
Ep: 467, Reward: 970.6131, Test: 774.2519 [173.92], Avg: 478.6675 (0.010)
Ep: 468, Reward: 925.8111, Test: 836.6863 [158.89], Avg: 479.0921 (0.010)
Ep: 469, Reward: 998.9875, Test: 843.7052 [170.43], Avg: 479.5052 (0.010)
Ep: 470, Reward: 1039.0540, Test: 881.6221 [57.02], Avg: 480.2379 (0.010)
Ep: 471, Reward: 936.7375, Test: 889.9973 [47.90], Avg: 481.0046 (0.010)
Ep: 472, Reward: 944.2659, Test: 905.2258 [26.50], Avg: 481.8454 (0.010)
Ep: 473, Reward: 962.0403, Test: 823.6758 [194.89], Avg: 482.1554 (0.010)
Ep: 474, Reward: 983.5877, Test: 886.7046 [16.49], Avg: 482.9724 (0.010)
Ep: 475, Reward: 924.0946, Test: 905.0661 [20.63], Avg: 483.8158 (0.010)
Ep: 476, Reward: 894.4262, Test: 849.8336 [121.38], Avg: 484.3287 (0.010)
Ep: 477, Reward: 917.9071, Test: 865.3097 [65.83], Avg: 484.9880 (0.010)
Ep: 478, Reward: 1005.7950, Test: 872.4962 [18.33], Avg: 485.7587 (0.010)
Ep: 479, Reward: 947.0687, Test: 795.4515 [232.49], Avg: 485.9195 (0.010)
Ep: 480, Reward: 1090.1974, Test: 908.0211 [13.05], Avg: 486.7700 (0.010)
Ep: 481, Reward: 1018.9201, Test: 908.5736 [17.65], Avg: 487.6084 (0.010)
Ep: 482, Reward: 981.6335, Test: 904.8301 [16.38], Avg: 488.4384 (0.010)
Ep: 483, Reward: 1081.5052, Test: 910.8891 [13.45], Avg: 489.2834 (0.010)
Ep: 484, Reward: 1024.2113, Test: 857.8455 [129.49], Avg: 489.7763 (0.010)
Ep: 485, Reward: 1036.0980, Test: 858.2586 [100.19], Avg: 490.3284 (0.010)
Ep: 486, Reward: 1012.0834, Test: 879.3377 [13.93], Avg: 491.0986 (0.010)
Ep: 487, Reward: 995.5931, Test: 912.2282 [13.33], Avg: 491.9342 (0.010)
Ep: 488, Reward: 1025.0320, Test: 836.1743 [175.83], Avg: 492.2786 (0.010)
Ep: 489, Reward: 943.1154, Test: 897.2559 [20.14], Avg: 493.0640 (0.010)
Ep: 490, Reward: 991.0235, Test: 900.5904 [20.72], Avg: 493.8518 (0.010)
Ep: 491, Reward: 924.1539, Test: 854.0352 [198.33], Avg: 494.1808 (0.010)
Ep: 492, Reward: 928.9305, Test: 879.6064 [96.87], Avg: 494.7661 (0.010)
Ep: 493, Reward: 1024.1818, Test: 859.3834 [100.04], Avg: 495.3016 (0.010)
Ep: 494, Reward: 1064.7929, Test: 918.6702 [12.33], Avg: 496.1320 (0.010)
Ep: 495, Reward: 1099.4355, Test: 770.7495 [212.70], Avg: 496.2569 (0.010)
Ep: 496, Reward: 1075.9972, Test: 885.1025 [122.98], Avg: 496.7918 (0.010)
Ep: 497, Reward: 943.9259, Test: 845.3841 [200.85], Avg: 497.0885 (0.010)
Ep: 498, Reward: 962.3550, Test: 866.5692 [100.66], Avg: 497.6272 (0.010)
Ep: 499, Reward: 983.6701, Test: 873.3324 [58.61], Avg: 498.2614 (0.010)
