Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

# LEARN_RATE = 0.00005           	# Sets how much we want to update the network weights at each training step
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.0225               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -43.9788, Test: -61.9938 [12.95], Avg: -74.9483 (0.980)
Ep: 1, Reward: -58.9842, Test: -46.2565 [34.74], Avg: -77.9700 (0.960)
Ep: 2, Reward: -66.3801, Test: -61.5276 [14.22], Avg: -77.2278 (0.941)
Ep: 3, Reward: -55.5415, Test: -46.5604 [27.03], Avg: -76.3190 (0.922)
Ep: 4, Reward: -53.7862, Test: -54.6062 [28.80], Avg: -77.7372 (0.904)
Ep: 5, Reward: -50.2385, Test: -56.0815 [21.85], Avg: -77.7695 (0.886)
Ep: 6, Reward: -63.9893, Test: -56.2895 [18.10], Avg: -77.2867 (0.868)
Ep: 7, Reward: -50.4060, Test: -52.0765 [34.66], Avg: -78.4674 (0.851)
Ep: 8, Reward: -76.6580, Test: -64.3526 [18.69], Avg: -78.9754 (0.834)
Ep: 9, Reward: -48.2060, Test: -55.8855 [18.51], Avg: -78.5171 (0.817)
Ep: 10, Reward: -46.6933, Test: -56.7482 [21.94], Avg: -78.5322 (0.801)
Ep: 11, Reward: -56.6408, Test: -56.1535 [19.42], Avg: -78.2860 (0.785)
Ep: 12, Reward: -60.4054, Test: -52.5340 [19.99], Avg: -77.8427 (0.769)
Ep: 13, Reward: -64.9336, Test: -54.8952 [18.52], Avg: -77.5264 (0.754)
Ep: 14, Reward: -50.5990, Test: -55.1352 [18.47], Avg: -77.2652 (0.739)
Ep: 15, Reward: -49.1252, Test: -57.2408 [15.28], Avg: -76.9686 (0.724)
Ep: 16, Reward: -36.6008, Test: -33.3442 [27.20], Avg: -76.0026 (0.709)
Ep: 17, Reward: -43.3952, Test: -52.2753 [13.48], Avg: -75.4335 (0.695)
Ep: 18, Reward: -34.9519, Test: -34.4528 [31.07], Avg: -74.9116 (0.681)
Ep: 19, Reward: -49.7766, Test: -35.9862 [35.79], Avg: -74.7550 (0.668)
Ep: 20, Reward: -33.5146, Test: -28.2092 [31.54], Avg: -74.0406 (0.654)
Ep: 21, Reward: -29.5473, Test: -58.0553 [57.24], Avg: -75.9158 (0.641)
Ep: 22, Reward: -50.4845, Test: -38.5726 [43.77], Avg: -76.1953 (0.628)
Ep: 23, Reward: -26.3733, Test: -11.6742 [41.80], Avg: -75.2488 (0.616)
Ep: 24, Reward: -16.5830, Test: -34.4820 [24.67], Avg: -74.6049 (0.603)
Ep: 25, Reward: -14.8138, Test: -34.2579 [41.82], Avg: -74.6617 (0.591)
Ep: 26, Reward: -33.5226, Test: -26.7772 [63.01], Avg: -75.2218 (0.580)
Ep: 27, Reward: -11.7279, Test: -36.3422 [28.50], Avg: -74.8510 (0.568)
Ep: 28, Reward: 16.5449, Test: -1.2584 [48.27], Avg: -73.9778 (0.557)
Ep: 29, Reward: -26.0626, Test: -16.6540 [37.04], Avg: -73.3018 (0.545)
Ep: 30, Reward: 7.5922, Test: 18.4937 [79.45], Avg: -72.9037 (0.535)
Ep: 31, Reward: 6.8030, Test: 87.0000 [81.27], Avg: -70.4464 (0.524)
Ep: 32, Reward: 18.0610, Test: -0.7770 [42.74], Avg: -69.6303 (0.513)
Ep: 33, Reward: 11.2263, Test: 9.5591 [35.67], Avg: -68.3503 (0.503)
Ep: 34, Reward: 25.4620, Test: 42.8738 [62.77], Avg: -66.9659 (0.493)
Ep: 35, Reward: 6.2868, Test: -12.3411 [38.64], Avg: -66.5218 (0.483)
Ep: 36, Reward: 14.0188, Test: -0.8445 [90.80], Avg: -67.2008 (0.474)
Ep: 37, Reward: -0.9079, Test: 9.7706 [88.61], Avg: -67.5070 (0.464)
Ep: 38, Reward: 12.9277, Test: -2.2164 [69.58], Avg: -67.6170 (0.455)
Ep: 39, Reward: 5.0231, Test: -25.1131 [45.54], Avg: -67.6928 (0.446)
Ep: 40, Reward: 8.6716, Test: 19.3904 [99.24], Avg: -67.9892 (0.437)
Ep: 41, Reward: -24.7693, Test: 32.4120 [84.58], Avg: -67.6126 (0.428)
Ep: 42, Reward: 70.6986, Test: 40.9321 [93.58], Avg: -67.2645 (0.419)
Ep: 43, Reward: 44.2803, Test: 117.5870 [165.21], Avg: -66.8181 (0.411)
Ep: 44, Reward: 17.3073, Test: 101.6768 [116.44], Avg: -65.6613 (0.403)
Ep: 45, Reward: 71.6187, Test: 19.6033 [97.64], Avg: -65.9303 (0.395)
Ep: 46, Reward: 57.9106, Test: 24.3823 [91.07], Avg: -65.9463 (0.387)
Ep: 47, Reward: 97.6122, Test: 66.7852 [74.21], Avg: -64.7271 (0.379)
Ep: 48, Reward: 94.8102, Test: 8.8910 [65.33], Avg: -64.5579 (0.372)
Ep: 49, Reward: 115.6934, Test: 53.7081 [91.25], Avg: -64.0175 (0.364)
Ep: 50, Reward: 92.2029, Test: 144.5365 [148.45], Avg: -62.8390 (0.357)
Ep: 51, Reward: 113.1572, Test: 104.3033 [97.63], Avg: -61.5022 (0.350)
Ep: 52, Reward: 35.8461, Test: 121.9068 [102.87], Avg: -59.9826 (0.343)
Ep: 53, Reward: 134.5960, Test: 85.9413 [86.02], Avg: -58.8733 (0.336)
Ep: 54, Reward: 99.0922, Test: 119.9007 [88.89], Avg: -57.2391 (0.329)
Ep: 55, Reward: 105.7974, Test: 77.9965 [97.04], Avg: -56.5571 (0.323)
Ep: 56, Reward: 30.8421, Test: 117.6930 [136.71], Avg: -55.8985 (0.316)
Ep: 57, Reward: 133.6591, Test: 178.9516 [136.96], Avg: -54.2107 (0.310)
Ep: 58, Reward: 116.9226, Test: 146.0885 [165.17], Avg: -53.6154 (0.304)
Ep: 59, Reward: 127.0226, Test: 122.5559 [139.08], Avg: -52.9972 (0.298)
Ep: 60, Reward: 154.4465, Test: 121.5869 [136.95], Avg: -52.3802 (0.292)
Ep: 61, Reward: 131.6570, Test: 173.3261 [166.81], Avg: -51.4303 (0.286)
Ep: 62, Reward: 172.1797, Test: 136.0758 [215.75], Avg: -51.8786 (0.280)
Ep: 63, Reward: 120.9361, Test: 265.2375 [167.87], Avg: -49.5466 (0.274)
Ep: 64, Reward: 155.0608, Test: 362.2914 [205.36], Avg: -46.3700 (0.269)
Ep: 65, Reward: 261.8023, Test: 399.4657 [214.15], Avg: -42.8597 (0.264)
Ep: 66, Reward: 237.2779, Test: 226.0545 [202.31], Avg: -41.8657 (0.258)
Ep: 67, Reward: 247.3357, Test: 248.1695 [200.57], Avg: -40.5500 (0.253)
Ep: 68, Reward: 351.1663, Test: 286.7726 [215.40], Avg: -38.9279 (0.248)
Ep: 69, Reward: 363.5691, Test: 342.6772 [159.44], Avg: -35.7542 (0.243)
Ep: 70, Reward: 348.0604, Test: 294.0609 [226.10], Avg: -34.2934 (0.238)
Ep: 71, Reward: 298.0527, Test: 239.7905 [178.21], Avg: -32.9618 (0.233)
Ep: 72, Reward: 307.5726, Test: 426.4573 [208.82], Avg: -29.5289 (0.229)
Ep: 73, Reward: 246.9468, Test: 287.6605 [173.53], Avg: -27.5875 (0.224)
Ep: 74, Reward: 204.7955, Test: 357.5878 [210.97], Avg: -25.2647 (0.220)
Ep: 75, Reward: 356.0123, Test: 305.6575 [252.13], Avg: -24.2280 (0.215)
Ep: 76, Reward: 458.9886, Test: 313.1034 [196.95], Avg: -22.4049 (0.211)
Ep: 77, Reward: 322.9151, Test: 486.3989 [186.12], Avg: -18.2680 (0.207)
Ep: 78, Reward: 443.1832, Test: 421.7761 [169.83], Avg: -14.8476 (0.203)
Ep: 79, Reward: 586.7692, Test: 511.2371 [210.87], Avg: -10.9073 (0.199)
Ep: 80, Reward: 372.9112, Test: 420.7056 [172.67], Avg: -7.7105 (0.195)
Ep: 81, Reward: 461.4524, Test: 415.9332 [256.66], Avg: -5.6742 (0.191)
Ep: 82, Reward: 443.5266, Test: 405.0842 [192.02], Avg: -3.0388 (0.187)
Ep: 83, Reward: 408.2868, Test: 251.5433 [263.06], Avg: -3.1397 (0.183)
Ep: 84, Reward: 405.7569, Test: 312.1156 [243.70], Avg: -2.2980 (0.180)
Ep: 85, Reward: 486.2925, Test: 449.5405 [210.60], Avg: 0.5071 (0.176)
Ep: 86, Reward: 432.0856, Test: 529.1269 [181.87], Avg: 4.4928 (0.172)
Ep: 87, Reward: 453.3421, Test: 370.6123 [264.64], Avg: 5.6459 (0.169)
Ep: 88, Reward: 377.6125, Test: 551.9679 [279.05], Avg: 8.6490 (0.166)
Ep: 89, Reward: 504.4866, Test: 455.2952 [246.52], Avg: 10.8726 (0.162)
Ep: 90, Reward: 568.6512, Test: 527.2787 [224.17], Avg: 14.0840 (0.159)
Ep: 91, Reward: 562.3091, Test: 361.4498 [217.06], Avg: 15.5004 (0.156)
Ep: 92, Reward: 560.5046, Test: 559.9570 [304.12], Avg: 18.0846 (0.153)
Ep: 93, Reward: 570.7969, Test: 590.4566 [247.45], Avg: 21.5412 (0.150)
Ep: 94, Reward: 399.7501, Test: 541.1142 [188.74], Avg: 25.0237 (0.147)
Ep: 95, Reward: 415.3416, Test: 359.0128 [177.51], Avg: 26.6537 (0.144)
Ep: 96, Reward: 510.6415, Test: 531.5567 [238.58], Avg: 29.3992 (0.141)
Ep: 97, Reward: 409.1069, Test: 449.0199 [265.43], Avg: 30.9726 (0.138)
Ep: 98, Reward: 438.1075, Test: 356.9915 [210.83], Avg: 32.1362 (0.135)
Ep: 99, Reward: 385.0335, Test: 604.9914 [222.81], Avg: 35.6367 (0.133)
Ep: 100, Reward: 445.2252, Test: 393.1029 [247.76], Avg: 36.7229 (0.130)
Ep: 101, Reward: 352.7272, Test: 651.6130 [169.85], Avg: 41.0861 (0.127)
Ep: 102, Reward: 365.9341, Test: 288.9532 [230.33], Avg: 41.2564 (0.125)
Ep: 103, Reward: 385.3194, Test: 273.9863 [204.99], Avg: 41.5231 (0.122)
Ep: 104, Reward: 500.3305, Test: 420.6695 [166.88], Avg: 43.5448 (0.120)
Ep: 105, Reward: 402.5484, Test: 425.4488 [174.73], Avg: 45.4992 (0.117)
Ep: 106, Reward: 310.1115, Test: 352.8453 [148.24], Avg: 46.9862 (0.115)
Ep: 107, Reward: 369.8278, Test: 415.3357 [213.21], Avg: 48.4226 (0.113)
Ep: 108, Reward: 493.1203, Test: 401.4330 [211.42], Avg: 49.7216 (0.111)
Ep: 109, Reward: 387.5426, Test: 339.3367 [195.82], Avg: 50.5743 (0.108)
Ep: 110, Reward: 294.1691, Test: 306.2274 [216.34], Avg: 50.9284 (0.106)
Ep: 111, Reward: 364.1254, Test: 386.3421 [237.50], Avg: 51.8027 (0.104)
Ep: 112, Reward: 429.2968, Test: 327.0924 [112.24], Avg: 53.2457 (0.102)
Ep: 113, Reward: 397.0522, Test: 447.6068 [247.77], Avg: 54.5315 (0.100)
Ep: 114, Reward: 395.0954, Test: 399.4734 [201.77], Avg: 55.7765 (0.098)
Ep: 115, Reward: 461.8958, Test: 359.2389 [194.06], Avg: 56.7196 (0.096)
Ep: 116, Reward: 489.3886, Test: 271.3601 [153.29], Avg: 57.2439 (0.094)
Ep: 117, Reward: 424.1670, Test: 403.3925 [178.28], Avg: 58.6665 (0.092)
Ep: 118, Reward: 386.7179, Test: 499.3910 [177.57], Avg: 60.8779 (0.090)
Ep: 119, Reward: 400.6754, Test: 382.7922 [168.67], Avg: 62.1549 (0.089)
Ep: 120, Reward: 495.6647, Test: 448.0336 [194.97], Avg: 63.7327 (0.087)
Ep: 121, Reward: 443.7683, Test: 457.1693 [223.78], Avg: 65.1233 (0.085)
Ep: 122, Reward: 400.4677, Test: 354.2289 [253.51], Avg: 65.4127 (0.083)
Ep: 123, Reward: 401.8329, Test: 411.7640 [181.21], Avg: 66.7445 (0.082)
Ep: 124, Reward: 376.2661, Test: 242.9027 [139.87], Avg: 67.0348 (0.080)
Ep: 125, Reward: 348.7564, Test: 394.7227 [248.41], Avg: 67.6640 (0.078)
Ep: 126, Reward: 396.2498, Test: 252.2901 [137.15], Avg: 68.0378 (0.077)
Ep: 127, Reward: 287.6383, Test: 306.2763 [269.25], Avg: 67.7956 (0.075)
Ep: 128, Reward: 395.3822, Test: 359.0937 [162.75], Avg: 68.7921 (0.074)
Ep: 129, Reward: 441.6966, Test: 374.7626 [148.13], Avg: 70.0063 (0.072)
Ep: 130, Reward: 439.6610, Test: 468.6560 [209.26], Avg: 71.4519 (0.071)
Ep: 131, Reward: 467.0160, Test: 473.2473 [174.39], Avg: 73.1747 (0.069)
Ep: 132, Reward: 541.4999, Test: 630.7460 [194.39], Avg: 75.9053 (0.068)
Ep: 133, Reward: 510.6559, Test: 480.4754 [297.87], Avg: 76.7016 (0.067)
Ep: 134, Reward: 513.7424, Test: 529.0447 [249.13], Avg: 78.2069 (0.065)
Ep: 135, Reward: 481.0198, Test: 515.3525 [210.65], Avg: 79.8723 (0.064)
Ep: 136, Reward: 602.8955, Test: 477.1929 [187.86], Avg: 81.4012 (0.063)
Ep: 137, Reward: 511.0915, Test: 511.6171 [249.18], Avg: 82.7130 (0.062)
Ep: 138, Reward: 572.8090, Test: 582.5355 [211.63], Avg: 84.7864 (0.060)
Ep: 139, Reward: 665.5205, Test: 506.9723 [190.28], Avg: 86.4429 (0.059)
Ep: 140, Reward: 623.3153, Test: 681.4441 [168.63], Avg: 89.4667 (0.058)
Ep: 141, Reward: 643.3311, Test: 689.3430 [135.55], Avg: 92.7367 (0.057)
Ep: 142, Reward: 656.9031, Test: 538.6686 [223.95], Avg: 94.2890 (0.056)
Ep: 143, Reward: 572.9232, Test: 652.7994 [200.16], Avg: 96.7775 (0.055)
Ep: 144, Reward: 780.5613, Test: 649.6070 [196.86], Avg: 99.2324 (0.053)
Ep: 145, Reward: 744.1218, Test: 713.7304 [143.72], Avg: 102.4570 (0.052)
Ep: 146, Reward: 584.2320, Test: 706.5652 [210.72], Avg: 105.1331 (0.051)
Ep: 147, Reward: 685.9230, Test: 734.2696 [176.12], Avg: 108.1940 (0.050)
Ep: 148, Reward: 661.9550, Test: 707.9334 [230.35], Avg: 110.6731 (0.049)
Ep: 149, Reward: 759.1796, Test: 692.8944 [219.53], Avg: 113.0910 (0.048)
Ep: 150, Reward: 706.9744, Test: 769.6694 [95.62], Avg: 116.8060 (0.047)
Ep: 151, Reward: 789.5827, Test: 744.7736 [87.60], Avg: 120.3610 (0.046)
Ep: 152, Reward: 844.5628, Test: 694.2164 [176.83], Avg: 122.9559 (0.045)
Ep: 153, Reward: 760.8328, Test: 655.4795 [218.85], Avg: 124.9928 (0.045)
Ep: 154, Reward: 690.7519, Test: 609.3344 [242.61], Avg: 126.5523 (0.044)
Ep: 155, Reward: 650.3550, Test: 639.6581 [211.53], Avg: 128.4855 (0.043)
Ep: 156, Reward: 560.0279, Test: 611.5771 [282.64], Avg: 129.7623 (0.042)
Ep: 157, Reward: 703.9167, Test: 548.2867 [166.26], Avg: 131.3589 (0.041)
Ep: 158, Reward: 683.7572, Test: 624.2848 [237.12], Avg: 132.9677 (0.040)
Ep: 159, Reward: 711.9139, Test: 715.4415 [155.25], Avg: 135.6378 (0.039)
Ep: 160, Reward: 633.5981, Test: 757.7724 [119.41], Avg: 138.7603 (0.039)
Ep: 161, Reward: 621.9308, Test: 647.2333 [165.78], Avg: 140.8757 (0.038)
Ep: 162, Reward: 690.0679, Test: 717.3536 [172.74], Avg: 143.3526 (0.037)
Ep: 163, Reward: 709.7670, Test: 739.5874 [111.57], Avg: 146.3079 (0.036)
Ep: 164, Reward: 655.1823, Test: 643.1079 [220.34], Avg: 147.9834 (0.036)
Ep: 165, Reward: 697.2075, Test: 649.9150 [171.08], Avg: 149.9765 (0.035)
Ep: 166, Reward: 623.7577, Test: 734.6134 [187.30], Avg: 152.3557 (0.034)
Ep: 167, Reward: 641.5625, Test: 562.3651 [260.95], Avg: 153.2430 (0.034)
Ep: 168, Reward: 641.1928, Test: 721.8958 [173.59], Avg: 155.5806 (0.033)
Ep: 169, Reward: 725.9850, Test: 717.6545 [209.38], Avg: 157.6553 (0.032)
Ep: 170, Reward: 741.2986, Test: 817.7913 [72.05], Avg: 161.0944 (0.032)
Ep: 171, Reward: 791.9843, Test: 733.6509 [178.74], Avg: 163.3840 (0.031)
Ep: 172, Reward: 646.6990, Test: 800.4880 [91.85], Avg: 166.5358 (0.030)
Ep: 173, Reward: 690.3331, Test: 811.0372 [91.01], Avg: 169.7167 (0.030)
Ep: 174, Reward: 767.3559, Test: 686.6579 [257.97], Avg: 171.1966 (0.029)
Ep: 175, Reward: 814.9185, Test: 716.4530 [174.75], Avg: 173.3018 (0.029)
Ep: 176, Reward: 716.1671, Test: 562.8001 [279.89], Avg: 173.9210 (0.028)
Ep: 177, Reward: 846.3708, Test: 740.3239 [213.50], Avg: 175.9036 (0.027)
Ep: 178, Reward: 778.8367, Test: 796.4710 [130.73], Avg: 178.6402 (0.027)
Ep: 179, Reward: 712.8178, Test: 713.3652 [212.36], Avg: 180.4311 (0.026)
Ep: 180, Reward: 675.1382, Test: 813.3533 [78.98], Avg: 183.4915 (0.026)
Ep: 181, Reward: 672.5681, Test: 553.9575 [206.88], Avg: 184.3903 (0.025)
Ep: 182, Reward: 635.2049, Test: 741.0001 [116.75], Avg: 186.7939 (0.025)
Ep: 183, Reward: 713.9514, Test: 665.8078 [201.76], Avg: 188.3007 (0.024)
Ep: 184, Reward: 706.7352, Test: 473.3699 [232.13], Avg: 188.5869 (0.024)
Ep: 185, Reward: 668.5581, Test: 501.8735 [210.11], Avg: 189.1416 (0.023)
Ep: 186, Reward: 655.6640, Test: 614.8206 [267.00], Avg: 189.9901 (0.023)
Ep: 187, Reward: 688.2461, Test: 746.4471 [115.43], Avg: 192.3360 (0.022)
Ep: 188, Reward: 823.8648, Test: 762.8423 [169.69], Avg: 194.4567 (0.022)
Ep: 189, Reward: 710.1249, Test: 788.0275 [105.59], Avg: 197.0251 (0.022)
Ep: 190, Reward: 857.0494, Test: 681.9412 [159.54], Avg: 198.7286 (0.021)
Ep: 191, Reward: 829.9610, Test: 742.5257 [135.43], Avg: 200.8555 (0.021)
Ep: 192, Reward: 772.0739, Test: 815.3014 [90.85], Avg: 203.5685 (0.020)
Ep: 193, Reward: 799.3264, Test: 746.5897 [112.55], Avg: 205.7874 (0.020)
Ep: 194, Reward: 810.9861, Test: 836.5784 [24.68], Avg: 208.8957 (0.020)
Ep: 195, Reward: 740.1683, Test: 706.8221 [187.90], Avg: 210.4775 (0.020)
Ep: 196, Reward: 695.2416, Test: 812.0560 [86.56], Avg: 213.0918 (0.020)
Ep: 197, Reward: 774.9034, Test: 822.5591 [81.83], Avg: 215.7566 (0.020)
Ep: 198, Reward: 787.9516, Test: 814.6154 [84.59], Avg: 218.3409 (0.020)
Ep: 199, Reward: 797.4622, Test: 691.2921 [249.08], Avg: 219.4602 (0.020)
Ep: 200, Reward: 780.3122, Test: 851.9287 [52.47], Avg: 222.3458 (0.020)
Ep: 201, Reward: 724.2976, Test: 762.9655 [108.69], Avg: 224.4841 (0.020)
Ep: 202, Reward: 733.4751, Test: 611.3546 [283.37], Avg: 224.9939 (0.020)
Ep: 203, Reward: 703.4223, Test: 622.5187 [245.58], Avg: 225.7388 (0.020)
Ep: 204, Reward: 741.0027, Test: 851.5220 [34.54], Avg: 228.6229 (0.020)
Ep: 205, Reward: 699.8561, Test: 719.6824 [196.90], Avg: 230.0509 (0.020)
Ep: 206, Reward: 831.8624, Test: 825.5308 [76.35], Avg: 232.5587 (0.020)
Ep: 207, Reward: 817.3023, Test: 750.6963 [143.60], Avg: 234.3594 (0.020)
Ep: 208, Reward: 875.0268, Test: 729.1070 [214.91], Avg: 235.6983 (0.020)
Ep: 209, Reward: 849.0187, Test: 830.7260 [49.99], Avg: 238.2938 (0.020)
Ep: 210, Reward: 789.5162, Test: 823.7649 [77.06], Avg: 240.7033 (0.020)
Ep: 211, Reward: 760.8854, Test: 719.2392 [250.75], Avg: 241.7777 (0.020)
Ep: 212, Reward: 814.7192, Test: 739.5474 [142.04], Avg: 243.4478 (0.020)
Ep: 213, Reward: 826.1174, Test: 765.0878 [190.47], Avg: 244.9954 (0.020)
Ep: 214, Reward: 708.9368, Test: 714.0970 [185.05], Avg: 246.3165 (0.020)
Ep: 215, Reward: 812.0981, Test: 708.1401 [208.50], Avg: 247.4893 (0.020)
Ep: 216, Reward: 780.5499, Test: 725.0073 [197.18], Avg: 248.7812 (0.020)
Ep: 217, Reward: 776.3734, Test: 755.1263 [180.17], Avg: 250.2775 (0.020)
Ep: 218, Reward: 839.9895, Test: 714.9921 [183.36], Avg: 251.5622 (0.020)
Ep: 219, Reward: 798.1609, Test: 757.4592 [133.89], Avg: 253.2531 (0.020)
Ep: 220, Reward: 856.9750, Test: 790.4482 [98.58], Avg: 255.2378 (0.020)
Ep: 221, Reward: 795.9192, Test: 823.4712 [81.08], Avg: 257.4322 (0.020)
Ep: 222, Reward: 807.4275, Test: 851.1784 [30.55], Avg: 259.9577 (0.020)
Ep: 223, Reward: 713.8610, Test: 788.0494 [92.60], Avg: 261.9018 (0.020)
Ep: 224, Reward: 744.7104, Test: 743.1349 [181.43], Avg: 263.2343 (0.020)
Ep: 225, Reward: 845.2631, Test: 671.5091 [228.24], Avg: 264.0309 (0.020)
Ep: 226, Reward: 728.6397, Test: 730.2869 [194.45], Avg: 265.2283 (0.020)
Ep: 227, Reward: 710.2390, Test: 791.6718 [185.98], Avg: 266.7215 (0.020)
Ep: 228, Reward: 766.3430, Test: 720.3965 [223.91], Avg: 267.7249 (0.020)
Ep: 229, Reward: 726.3726, Test: 723.6859 [201.08], Avg: 268.8330 (0.020)
Ep: 230, Reward: 764.2374, Test: 788.1942 [156.00], Avg: 270.4060 (0.020)
Ep: 231, Reward: 780.8626, Test: 498.8276 [255.15], Avg: 270.2908 (0.020)
Ep: 232, Reward: 714.7447, Test: 784.5597 [92.40], Avg: 272.1014 (0.020)
Ep: 233, Reward: 742.9929, Test: 688.7975 [255.00], Avg: 272.7924 (0.020)
Ep: 234, Reward: 728.8271, Test: 698.1596 [202.86], Avg: 273.7392 (0.020)
Ep: 235, Reward: 707.8952, Test: 619.3347 [284.52], Avg: 273.9980 (0.020)
Ep: 236, Reward: 796.6154, Test: 850.7175 [57.03], Avg: 276.1908 (0.020)
Ep: 237, Reward: 849.1089, Test: 748.6930 [225.70], Avg: 277.2278 (0.020)
Ep: 238, Reward: 701.7728, Test: 839.4009 [125.13], Avg: 279.0564 (0.020)
Ep: 239, Reward: 730.9936, Test: 763.9532 [152.88], Avg: 280.4398 (0.020)
Ep: 240, Reward: 722.8408, Test: 783.7221 [166.83], Avg: 281.8359 (0.020)
Ep: 241, Reward: 791.0298, Test: 776.0358 [129.01], Avg: 283.3449 (0.020)
Ep: 242, Reward: 807.6535, Test: 812.2359 [137.20], Avg: 284.9568 (0.020)
Ep: 243, Reward: 781.3206, Test: 724.7414 [229.04], Avg: 285.8205 (0.020)
Ep: 244, Reward: 800.9372, Test: 900.7647 [21.96], Avg: 288.2409 (0.020)
Ep: 245, Reward: 983.7884, Test: 891.8563 [54.94], Avg: 290.4713 (0.020)
Ep: 246, Reward: 905.1549, Test: 813.8300 [175.35], Avg: 291.8802 (0.020)
Ep: 247, Reward: 898.5535, Test: 850.8288 [100.74], Avg: 293.7278 (0.020)
Ep: 248, Reward: 891.7258, Test: 849.6106 [73.95], Avg: 295.6633 (0.020)
Ep: 249, Reward: 827.4114, Test: 840.0408 [105.77], Avg: 297.4177 (0.020)
Ep: 250, Reward: 861.4833, Test: 795.0554 [155.12], Avg: 298.7823 (0.020)
Ep: 251, Reward: 820.1494, Test: 712.0540 [224.03], Avg: 299.5333 (0.020)
Ep: 252, Reward: 837.9836, Test: 829.5404 [112.53], Avg: 301.1834 (0.020)
Ep: 253, Reward: 815.1155, Test: 669.7026 [191.59], Avg: 301.8800 (0.020)
Ep: 254, Reward: 709.9961, Test: 843.3098 [60.85], Avg: 303.7646 (0.020)
Ep: 255, Reward: 813.2110, Test: 791.7087 [182.30], Avg: 304.9585 (0.020)
Ep: 256, Reward: 788.8738, Test: 816.7497 [129.58], Avg: 306.4457 (0.020)
Ep: 257, Reward: 860.1024, Test: 846.0875 [109.46], Avg: 308.1130 (0.020)
Ep: 258, Reward: 892.3514, Test: 794.8725 [236.85], Avg: 309.0779 (0.020)
Ep: 259, Reward: 805.1776, Test: 808.1508 [162.23], Avg: 310.3735 (0.020)
Ep: 260, Reward: 784.7917, Test: 795.8835 [136.74], Avg: 311.7098 (0.020)
Ep: 261, Reward: 818.7610, Test: 897.3591 [28.47], Avg: 313.8364 (0.020)
Ep: 262, Reward: 914.1422, Test: 795.7788 [117.90], Avg: 315.2206 (0.020)
Ep: 263, Reward: 926.3653, Test: 836.3350 [191.72], Avg: 316.4683 (0.020)
Ep: 264, Reward: 873.5666, Test: 741.1973 [228.24], Avg: 317.2098 (0.020)
Ep: 265, Reward: 805.5555, Test: 828.1627 [72.23], Avg: 318.8591 (0.020)
Ep: 266, Reward: 837.6430, Test: 844.2436 [77.68], Avg: 320.5359 (0.020)
Ep: 267, Reward: 780.6042, Test: 807.1317 [97.39], Avg: 321.9881 (0.020)
Ep: 268, Reward: 778.2704, Test: 644.0194 [194.41], Avg: 322.4625 (0.020)
Ep: 269, Reward: 856.0603, Test: 786.2507 [140.65], Avg: 323.6593 (0.020)
Ep: 270, Reward: 707.6810, Test: 728.4511 [168.43], Avg: 324.5315 (0.020)
Ep: 271, Reward: 817.5438, Test: 761.1320 [138.81], Avg: 325.6263 (0.020)
Ep: 272, Reward: 777.9856, Test: 698.2921 [169.08], Avg: 326.3721 (0.020)
Ep: 273, Reward: 816.9281, Test: 695.3964 [172.60], Avg: 327.0890 (0.020)
Ep: 274, Reward: 806.3038, Test: 828.3135 [86.20], Avg: 328.5981 (0.020)
Ep: 275, Reward: 857.2768, Test: 744.4461 [161.91], Avg: 329.5182 (0.020)
Ep: 276, Reward: 860.2110, Test: 880.8404 [46.70], Avg: 331.3399 (0.020)
Ep: 277, Reward: 733.3219, Test: 702.8852 [242.32], Avg: 331.8048 (0.020)
Ep: 278, Reward: 650.5818, Test: 804.6965 [111.68], Avg: 333.0994 (0.020)
Ep: 279, Reward: 673.7785, Test: 785.3501 [170.25], Avg: 334.1065 (0.020)
Ep: 280, Reward: 744.5491, Test: 729.0889 [186.58], Avg: 334.8482 (0.020)
Ep: 281, Reward: 649.2161, Test: 812.0777 [67.80], Avg: 336.3001 (0.020)
Ep: 282, Reward: 701.6093, Test: 653.8074 [180.84], Avg: 336.7830 (0.020)
Ep: 283, Reward: 709.8705, Test: 728.3736 [137.29], Avg: 337.6784 (0.020)
Ep: 284, Reward: 472.0719, Test: 686.2861 [193.79], Avg: 338.2217 (0.020)
Ep: 285, Reward: 677.8834, Test: 507.0539 [206.47], Avg: 338.0901 (0.020)
Ep: 286, Reward: 460.6634, Test: 484.6200 [271.74], Avg: 337.6538 (0.020)
Ep: 287, Reward: 674.1635, Test: 559.7019 [212.92], Avg: 337.6855 (0.020)
Ep: 288, Reward: 594.5749, Test: 582.8556 [228.78], Avg: 337.7422 (0.020)
Ep: 289, Reward: 734.8998, Test: 528.8981 [308.66], Avg: 337.3370 (0.020)
Ep: 290, Reward: 777.5950, Test: 623.4963 [238.32], Avg: 337.5014 (0.020)
Ep: 291, Reward: 614.7654, Test: 779.8314 [209.46], Avg: 338.2989 (0.020)
Ep: 292, Reward: 584.7928, Test: 706.7606 [145.77], Avg: 339.0589 (0.020)
Ep: 293, Reward: 822.9701, Test: 738.2971 [194.79], Avg: 339.7543 (0.020)
Ep: 294, Reward: 680.3412, Test: 651.9180 [209.24], Avg: 340.1032 (0.020)
Ep: 295, Reward: 592.1216, Test: 687.4008 [172.05], Avg: 340.6953 (0.020)
Ep: 296, Reward: 605.4868, Test: 526.7216 [234.46], Avg: 340.5322 (0.020)
Ep: 297, Reward: 632.5267, Test: 730.2924 [178.34], Avg: 341.2417 (0.020)
Ep: 298, Reward: 713.4908, Test: 806.1250 [145.97], Avg: 342.3083 (0.020)
Ep: 299, Reward: 709.4892, Test: 649.2191 [268.88], Avg: 342.4351 (0.020)
Ep: 300, Reward: 706.0111, Test: 525.6905 [323.29], Avg: 341.9698 (0.020)
Ep: 301, Reward: 568.2546, Test: 661.2918 [269.80], Avg: 342.1338 (0.020)
Ep: 302, Reward: 656.2658, Test: 632.6864 [217.83], Avg: 342.3738 (0.020)
Ep: 303, Reward: 657.1977, Test: 347.7563 [228.26], Avg: 341.6407 (0.020)
Ep: 304, Reward: 573.7463, Test: 579.9695 [298.31], Avg: 341.4440 (0.020)
Ep: 305, Reward: 644.4028, Test: 447.2058 [205.82], Avg: 341.1171 (0.020)
Ep: 306, Reward: 753.5729, Test: 666.7757 [241.37], Avg: 341.3916 (0.020)
Ep: 307, Reward: 701.1266, Test: 700.8039 [235.79], Avg: 341.7930 (0.020)
Ep: 308, Reward: 768.7923, Test: 529.9406 [252.95], Avg: 341.5833 (0.020)
Ep: 309, Reward: 717.5047, Test: 455.9090 [370.91], Avg: 340.7556 (0.020)
Ep: 310, Reward: 552.7027, Test: 591.1618 [195.33], Avg: 340.9327 (0.020)
Ep: 311, Reward: 595.7778, Test: 508.7406 [257.12], Avg: 340.6464 (0.020)
Ep: 312, Reward: 657.0566, Test: 541.0247 [264.27], Avg: 340.4423 (0.020)
Ep: 313, Reward: 610.1340, Test: 530.3774 [235.53], Avg: 340.2971 (0.020)
Ep: 314, Reward: 583.6578, Test: 687.5578 [254.53], Avg: 340.5915 (0.020)
Ep: 315, Reward: 675.7650, Test: 727.9280 [150.52], Avg: 341.3409 (0.020)
Ep: 316, Reward: 748.3144, Test: 868.9074 [70.69], Avg: 342.7821 (0.020)
Ep: 317, Reward: 638.0686, Test: 821.7216 [101.18], Avg: 343.9701 (0.020)
Ep: 318, Reward: 755.0309, Test: 791.0745 [201.92], Avg: 344.7387 (0.020)
Ep: 319, Reward: 831.5223, Test: 765.5001 [231.56], Avg: 345.3299 (0.020)
Ep: 320, Reward: 679.3967, Test: 864.1562 [36.19], Avg: 346.8334 (0.020)
Ep: 321, Reward: 733.8384, Test: 621.0947 [225.32], Avg: 346.9854 (0.020)
Ep: 322, Reward: 654.4651, Test: 647.7999 [287.47], Avg: 347.0267 (0.020)
Ep: 323, Reward: 649.5748, Test: 665.5475 [243.71], Avg: 347.2576 (0.020)
Ep: 324, Reward: 615.1794, Test: 627.0098 [305.10], Avg: 347.1796 (0.020)
Ep: 325, Reward: 497.1993, Test: 752.9666 [109.81], Avg: 348.0875 (0.020)
Ep: 326, Reward: 788.7879, Test: 719.5853 [186.04], Avg: 348.6547 (0.020)
Ep: 327, Reward: 728.6360, Test: 808.2942 [84.19], Avg: 349.7993 (0.020)
Ep: 328, Reward: 850.7770, Test: 740.7089 [156.25], Avg: 350.5126 (0.020)
Ep: 329, Reward: 691.3810, Test: 750.6273 [141.00], Avg: 351.2978 (0.020)
Ep: 330, Reward: 722.5728, Test: 814.9214 [144.74], Avg: 352.2612 (0.020)
Ep: 331, Reward: 719.8993, Test: 816.9362 [179.98], Avg: 353.1187 (0.020)
Ep: 332, Reward: 925.5632, Test: 723.2037 [210.58], Avg: 353.5977 (0.020)
Ep: 333, Reward: 784.8774, Test: 800.2107 [135.81], Avg: 354.5282 (0.020)
Ep: 334, Reward: 899.8159, Test: 686.2213 [213.24], Avg: 354.8819 (0.020)
Ep: 335, Reward: 711.1776, Test: 823.5592 [203.18], Avg: 355.6720 (0.020)
Ep: 336, Reward: 837.5393, Test: 854.2511 [132.08], Avg: 356.7595 (0.020)
Ep: 337, Reward: 988.3014, Test: 822.2967 [156.60], Avg: 357.6736 (0.020)
Ep: 338, Reward: 906.3426, Test: 529.4116 [283.25], Avg: 357.3446 (0.020)
Ep: 339, Reward: 763.7330, Test: 800.9621 [124.28], Avg: 358.2839 (0.020)
Ep: 340, Reward: 783.8937, Test: 757.4200 [259.17], Avg: 358.6943 (0.020)
Ep: 341, Reward: 1011.5303, Test: 871.1190 [95.31], Avg: 359.9140 (0.020)
Ep: 342, Reward: 827.9175, Test: 828.0518 [189.18], Avg: 360.7273 (0.020)
Ep: 343, Reward: 840.8960, Test: 882.6460 [65.66], Avg: 362.0536 (0.020)
Ep: 344, Reward: 946.7591, Test: 827.6483 [144.78], Avg: 362.9835 (0.020)
Ep: 345, Reward: 860.7533, Test: 837.6967 [150.91], Avg: 363.9194 (0.020)
Ep: 346, Reward: 816.4554, Test: 690.1075 [188.70], Avg: 364.3156 (0.020)
Ep: 347, Reward: 751.9142, Test: 655.8467 [201.51], Avg: 364.5742 (0.020)
Ep: 348, Reward: 736.7235, Test: 817.4926 [119.33], Avg: 365.5301 (0.020)
Ep: 349, Reward: 649.3625, Test: 762.1974 [175.01], Avg: 366.1634 (0.020)
Ep: 350, Reward: 704.8453, Test: 781.1743 [109.82], Avg: 367.0329 (0.020)
Ep: 351, Reward: 812.5391, Test: 759.2397 [156.42], Avg: 367.7027 (0.020)
Ep: 352, Reward: 809.3098, Test: 703.5110 [212.76], Avg: 368.0513 (0.020)
Ep: 353, Reward: 774.2038, Test: 749.3034 [264.00], Avg: 368.3825 (0.020)
Ep: 354, Reward: 772.6412, Test: 736.3458 [202.00], Avg: 368.8500 (0.020)
Ep: 355, Reward: 777.2926, Test: 743.0012 [197.81], Avg: 369.3454 (0.020)
Ep: 356, Reward: 816.6636, Test: 564.5650 [245.29], Avg: 369.2051 (0.020)
Ep: 357, Reward: 638.8486, Test: 468.9638 [260.89], Avg: 368.7551 (0.020)
Ep: 358, Reward: 708.9515, Test: 654.3632 [197.13], Avg: 369.0015 (0.020)
Ep: 359, Reward: 713.8585, Test: 805.7275 [78.33], Avg: 369.9971 (0.020)
Ep: 360, Reward: 699.0966, Test: 546.7414 [242.57], Avg: 369.8147 (0.020)
Ep: 361, Reward: 684.9205, Test: 818.6439 [147.36], Avg: 370.6475 (0.020)
Ep: 362, Reward: 780.5417, Test: 740.6932 [135.65], Avg: 371.2932 (0.020)
Ep: 363, Reward: 1001.2011, Test: 687.8937 [177.67], Avg: 371.6749 (0.020)
Ep: 364, Reward: 832.5826, Test: 705.8932 [235.15], Avg: 371.9463 (0.020)
Ep: 365, Reward: 865.4894, Test: 572.6006 [288.74], Avg: 371.7057 (0.020)
Ep: 366, Reward: 648.4855, Test: 793.4056 [109.29], Avg: 372.5569 (0.020)
Ep: 367, Reward: 727.3424, Test: 681.0783 [248.77], Avg: 372.7193 (0.020)
Ep: 368, Reward: 748.4370, Test: 688.3735 [213.53], Avg: 372.9960 (0.020)
Ep: 369, Reward: 569.5462, Test: 364.3060 [168.55], Avg: 372.5170 (0.020)
Ep: 370, Reward: 524.1044, Test: 701.4605 [223.99], Avg: 372.7999 (0.020)
Ep: 371, Reward: 729.3988, Test: 712.0558 [181.08], Avg: 373.2251 (0.020)
Ep: 372, Reward: 638.7853, Test: 627.2862 [355.84], Avg: 372.9522 (0.020)
Ep: 373, Reward: 643.4103, Test: 706.3619 [227.21], Avg: 373.2362 (0.020)
Ep: 374, Reward: 734.9567, Test: 633.9697 [291.58], Avg: 373.1539 (0.020)
Ep: 375, Reward: 568.1862, Test: 684.3375 [191.26], Avg: 373.4729 (0.020)
Ep: 376, Reward: 765.8821, Test: 623.7591 [209.26], Avg: 373.5817 (0.020)
Ep: 377, Reward: 796.4140, Test: 648.5428 [231.88], Avg: 373.6957 (0.020)
Ep: 378, Reward: 686.0778, Test: 581.6435 [149.89], Avg: 373.8489 (0.020)
Ep: 379, Reward: 551.4751, Test: 641.0734 [262.23], Avg: 373.8620 (0.020)
Ep: 380, Reward: 666.0583, Test: 580.2763 [216.94], Avg: 373.8344 (0.020)
Ep: 381, Reward: 554.3523, Test: 535.6487 [249.28], Avg: 373.6054 (0.020)
Ep: 382, Reward: 507.7275, Test: 586.0328 [228.59], Avg: 373.5632 (0.020)
Ep: 383, Reward: 685.3266, Test: 723.5955 [149.14], Avg: 374.0864 (0.020)
Ep: 384, Reward: 585.2523, Test: 536.9186 [349.53], Avg: 373.6015 (0.020)
Ep: 385, Reward: 571.0247, Test: 673.6973 [275.89], Avg: 373.6642 (0.020)
Ep: 386, Reward: 606.6568, Test: 728.3325 [238.72], Avg: 373.9638 (0.020)
Ep: 387, Reward: 630.4048, Test: 720.5875 [231.98], Avg: 374.2592 (0.020)
Ep: 388, Reward: 584.2418, Test: 633.6732 [276.02], Avg: 374.2166 (0.020)
Ep: 389, Reward: 776.6908, Test: 683.9270 [269.56], Avg: 374.3195 (0.020)
Ep: 390, Reward: 651.0540, Test: 794.2866 [169.90], Avg: 374.9591 (0.020)
Ep: 391, Reward: 738.6936, Test: 783.5381 [203.49], Avg: 375.4822 (0.020)
Ep: 392, Reward: 663.0897, Test: 771.1291 [241.03], Avg: 375.8757 (0.020)
Ep: 393, Reward: 878.9528, Test: 661.0245 [239.98], Avg: 375.9903 (0.020)
Ep: 394, Reward: 748.4897, Test: 564.6519 [296.81], Avg: 375.7165 (0.020)
Ep: 395, Reward: 683.1304, Test: 736.9518 [194.24], Avg: 376.1382 (0.020)
Ep: 396, Reward: 772.1247, Test: 785.8856 [167.58], Avg: 376.7482 (0.020)
Ep: 397, Reward: 869.0838, Test: 695.7846 [234.21], Avg: 376.9613 (0.020)
Ep: 398, Reward: 700.5932, Test: 619.1447 [291.46], Avg: 376.8378 (0.020)
Ep: 399, Reward: 658.8638, Test: 740.1614 [254.66], Avg: 377.1095 (0.020)
Ep: 400, Reward: 808.4801, Test: 726.1271 [163.43], Avg: 377.5723 (0.020)
Ep: 401, Reward: 740.5810, Test: 661.8975 [232.30], Avg: 377.7017 (0.020)
Ep: 402, Reward: 657.3193, Test: 547.3676 [340.37], Avg: 377.2781 (0.020)
Ep: 403, Reward: 670.7296, Test: 549.3072 [285.34], Avg: 376.9977 (0.020)
Ep: 404, Reward: 610.1008, Test: 664.7855 [236.11], Avg: 377.1253 (0.020)
Ep: 405, Reward: 775.9589, Test: 608.4168 [246.09], Avg: 377.0888 (0.020)
Ep: 406, Reward: 631.4089, Test: 708.2781 [295.06], Avg: 377.1776 (0.020)
Ep: 407, Reward: 721.7717, Test: 622.3090 [266.86], Avg: 377.1243 (0.020)
Ep: 408, Reward: 765.8531, Test: 556.2873 [295.81], Avg: 376.8391 (0.020)
Ep: 409, Reward: 748.3031, Test: 672.4383 [217.77], Avg: 377.0290 (0.020)
Ep: 410, Reward: 623.3598, Test: 657.6274 [281.12], Avg: 377.0277 (0.020)
Ep: 411, Reward: 773.8791, Test: 821.7451 [162.08], Avg: 377.7137 (0.020)
Ep: 412, Reward: 808.1437, Test: 702.8370 [259.88], Avg: 377.8717 (0.020)
Ep: 413, Reward: 632.0834, Test: 693.6395 [248.71], Avg: 378.0337 (0.020)
Ep: 414, Reward: 677.4328, Test: 799.8409 [179.20], Avg: 378.6183 (0.020)
Ep: 415, Reward: 858.0737, Test: 817.5891 [80.76], Avg: 379.4793 (0.020)
Ep: 416, Reward: 850.4118, Test: 789.3183 [222.75], Avg: 379.9280 (0.020)
Ep: 417, Reward: 773.7888, Test: 603.7748 [285.19], Avg: 379.7812 (0.020)
Ep: 418, Reward: 679.6893, Test: 801.4466 [175.05], Avg: 380.3698 (0.020)
Ep: 419, Reward: 877.3934, Test: 676.2600 [256.29], Avg: 380.4641 (0.020)
Ep: 420, Reward: 714.8198, Test: 727.3856 [146.59], Avg: 380.9400 (0.020)
Ep: 421, Reward: 664.4701, Test: 803.1247 [156.31], Avg: 381.5700 (0.020)
Ep: 422, Reward: 700.2931, Test: 690.4792 [226.02], Avg: 381.7660 (0.020)
Ep: 423, Reward: 606.3283, Test: 626.3559 [188.66], Avg: 381.8979 (0.020)
Ep: 424, Reward: 817.2103, Test: 693.9615 [198.09], Avg: 382.1660 (0.020)
Ep: 425, Reward: 787.0252, Test: 694.1877 [218.27], Avg: 382.3861 (0.020)
Ep: 426, Reward: 684.1260, Test: 733.0564 [124.46], Avg: 382.9159 (0.020)
Ep: 427, Reward: 725.4471, Test: 692.0556 [202.38], Avg: 383.1653 (0.020)
Ep: 428, Reward: 801.6562, Test: 768.5395 [155.60], Avg: 383.7009 (0.020)
Ep: 429, Reward: 827.9340, Test: 809.9019 [188.19], Avg: 384.2544 (0.020)
Ep: 430, Reward: 809.9185, Test: 733.5114 [243.28], Avg: 384.5003 (0.020)
Ep: 431, Reward: 945.7092, Test: 702.6487 [258.72], Avg: 384.6379 (0.020)
Ep: 432, Reward: 810.4048, Test: 735.7447 [267.99], Avg: 384.8298 (0.020)
Ep: 433, Reward: 733.6321, Test: 643.6900 [269.73], Avg: 384.8048 (0.020)
Ep: 434, Reward: 790.8097, Test: 879.5272 [31.84], Avg: 385.8689 (0.020)
Ep: 435, Reward: 780.1801, Test: 765.8794 [210.42], Avg: 386.2578 (0.020)
Ep: 436, Reward: 751.9432, Test: 671.9242 [293.15], Avg: 386.2407 (0.020)
Ep: 437, Reward: 837.5913, Test: 729.3113 [261.27], Avg: 386.4275 (0.020)
Ep: 438, Reward: 671.1014, Test: 714.1751 [204.85], Avg: 386.7074 (0.020)
Ep: 439, Reward: 888.5425, Test: 808.5578 [144.65], Avg: 387.3374 (0.020)
Ep: 440, Reward: 816.3280, Test: 677.4178 [298.08], Avg: 387.3193 (0.020)
Ep: 441, Reward: 799.1222, Test: 699.1972 [235.39], Avg: 387.4923 (0.020)
Ep: 442, Reward: 784.3104, Test: 665.7441 [250.27], Avg: 387.5555 (0.020)
Ep: 443, Reward: 784.2357, Test: 806.8861 [88.29], Avg: 388.3011 (0.020)
Ep: 444, Reward: 744.3906, Test: 768.7784 [134.32], Avg: 388.8543 (0.020)
Ep: 445, Reward: 804.8226, Test: 770.3563 [209.52], Avg: 389.2399 (0.020)
Ep: 446, Reward: 828.3812, Test: 852.4031 [56.37], Avg: 390.1499 (0.020)
Ep: 447, Reward: 901.0403, Test: 822.3721 [73.78], Avg: 390.9500 (0.020)
Ep: 448, Reward: 834.0651, Test: 766.7607 [214.33], Avg: 391.3097 (0.020)
Ep: 449, Reward: 727.5290, Test: 737.2010 [186.32], Avg: 391.6642 (0.020)
Ep: 450, Reward: 764.3329, Test: 793.2796 [190.10], Avg: 392.1332 (0.020)
Ep: 451, Reward: 872.5416, Test: 786.8635 [196.35], Avg: 392.5721 (0.020)
Ep: 452, Reward: 791.3937, Test: 855.3802 [73.52], Avg: 393.4315 (0.020)
Ep: 453, Reward: 905.7708, Test: 884.9269 [51.52], Avg: 394.4006 (0.020)
Ep: 454, Reward: 820.0557, Test: 839.2734 [118.66], Avg: 395.1176 (0.020)
Ep: 455, Reward: 873.6703, Test: 872.1814 [36.11], Avg: 396.0846 (0.020)
Ep: 456, Reward: 847.9658, Test: 856.2347 [64.45], Avg: 396.9504 (0.020)
Ep: 457, Reward: 943.0720, Test: 745.1994 [229.81], Avg: 397.2090 (0.020)
Ep: 458, Reward: 1058.2397, Test: 885.1009 [67.16], Avg: 398.1257 (0.020)
Ep: 459, Reward: 874.8997, Test: 790.8077 [237.62], Avg: 398.4628 (0.020)
Ep: 460, Reward: 810.0725, Test: 676.0108 [297.33], Avg: 398.4198 (0.020)
Ep: 461, Reward: 781.4222, Test: 822.5626 [83.47], Avg: 399.1572 (0.020)
Ep: 462, Reward: 693.3573, Test: 802.4598 [153.88], Avg: 399.6959 (0.020)
Ep: 463, Reward: 604.1209, Test: 669.5750 [244.58], Avg: 399.7505 (0.020)
Ep: 464, Reward: 785.4599, Test: 648.1160 [275.12], Avg: 399.6929 (0.020)
Ep: 465, Reward: 730.2790, Test: 805.7440 [113.44], Avg: 400.3209 (0.020)
Ep: 466, Reward: 821.8768, Test: 786.4839 [218.13], Avg: 400.6807 (0.020)
Ep: 467, Reward: 792.0313, Test: 779.4536 [110.11], Avg: 401.2547 (0.020)
Ep: 468, Reward: 752.7637, Test: 810.8359 [91.91], Avg: 401.9320 (0.020)
Ep: 469, Reward: 793.8896, Test: 683.8057 [226.72], Avg: 402.0494 (0.020)
Ep: 470, Reward: 929.8402, Test: 747.2925 [198.58], Avg: 402.3608 (0.020)
Ep: 471, Reward: 730.1745, Test: 873.9178 [27.54], Avg: 403.3015 (0.020)
Ep: 472, Reward: 838.8542, Test: 829.9365 [111.74], Avg: 403.9672 (0.020)
Ep: 473, Reward: 906.4723, Test: 757.3806 [221.21], Avg: 404.2461 (0.020)
Ep: 474, Reward: 822.3466, Test: 788.8006 [148.94], Avg: 404.7422 (0.020)
Ep: 475, Reward: 772.9065, Test: 823.7769 [87.99], Avg: 405.4376 (0.020)
Ep: 476, Reward: 729.8284, Test: 770.6230 [189.85], Avg: 405.8052 (0.020)
Ep: 477, Reward: 615.5165, Test: 682.4766 [249.77], Avg: 405.8615 (0.020)
Ep: 478, Reward: 728.2964, Test: 778.2604 [150.87], Avg: 406.3240 (0.020)
Ep: 479, Reward: 494.8315, Test: 611.4206 [256.18], Avg: 406.2176 (0.020)
Ep: 480, Reward: 804.5447, Test: 795.1476 [124.47], Avg: 406.7674 (0.020)
Ep: 481, Reward: 749.8207, Test: 639.4938 [247.71], Avg: 406.7363 (0.020)
Ep: 482, Reward: 782.3938, Test: 822.6540 [145.82], Avg: 407.2955 (0.020)
Ep: 483, Reward: 857.9964, Test: 683.3552 [246.94], Avg: 407.3557 (0.020)
Ep: 484, Reward: 869.0465, Test: 787.2204 [146.55], Avg: 407.8367 (0.020)
Ep: 485, Reward: 869.8874, Test: 762.5739 [199.37], Avg: 408.1564 (0.020)
Ep: 486, Reward: 800.6578, Test: 817.6571 [122.64], Avg: 408.7454 (0.020)
Ep: 487, Reward: 764.4990, Test: 699.9773 [267.51], Avg: 408.7940 (0.020)
Ep: 488, Reward: 770.8766, Test: 752.1335 [219.28], Avg: 409.0477 (0.020)
Ep: 489, Reward: 872.3905, Test: 718.7492 [185.55], Avg: 409.3011 (0.020)
Ep: 490, Reward: 670.3511, Test: 505.1922 [275.28], Avg: 408.9357 (0.020)
Ep: 491, Reward: 706.4318, Test: 876.6356 [18.89], Avg: 409.8480 (0.020)
Ep: 492, Reward: 848.9173, Test: 697.3686 [218.06], Avg: 409.9888 (0.020)
Ep: 493, Reward: 749.9849, Test: 772.4925 [161.13], Avg: 410.3965 (0.020)
Ep: 494, Reward: 744.1040, Test: 782.6720 [207.32], Avg: 410.7297 (0.020)
Ep: 495, Reward: 758.0446, Test: 751.1886 [195.70], Avg: 411.0216 (0.020)
Ep: 496, Reward: 637.3595, Test: 728.3499 [256.44], Avg: 411.1441 (0.020)
Ep: 497, Reward: 664.1436, Test: 718.7662 [230.13], Avg: 411.2997 (0.020)
Ep: 498, Reward: 609.3455, Test: 441.1392 [296.92], Avg: 410.7645 (0.020)
Ep: 499, Reward: 629.7889, Test: 584.1731 [295.73], Avg: 410.5198 (0.020)
