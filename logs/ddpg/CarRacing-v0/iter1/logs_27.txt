Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, NUM_STEPS

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(list(zip(states, actions, targets, advantages)), shuffle=True)	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		Reward_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(Reward_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Reward: {Reward_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	Reward_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			Reward_reward = np.mean([rollout(env, agent) for _ in range(10)])
			Reward_rewards.append(Reward_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {Reward_reward}, Avg: {np.mean(Reward_rewards)}")
			if Reward_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Step: 0000, Rewards: -57.9315, Reward: -51.2150 [15.92], Avg: -67.1323 (0.980)
Step: 1000, Rewards: -54.6097, Reward: -66.0303 [9.39], Avg: -71.2766 (0.960)
Step: 2000, Rewards: -47.5883, Reward: -59.8132 [16.37], Avg: -72.9120 (0.941)
Step: 3000, Rewards: -60.7390, Reward: -57.8494 [17.88], Avg: -73.6172 (0.922)
Step: 4000, Rewards: -42.5574, Reward: -60.2708 [17.51], Avg: -74.4496 (0.904)
Step: 5000, Rewards: -56.8591, Reward: -36.8737 [21.01], Avg: -71.6890 (0.886)
Step: 6000, Rewards: -49.4958, Reward: -61.1604 [12.44], Avg: -71.9626 (0.868)
Step: 7000, Rewards: -59.3391, Reward: -50.2344 [13.01], Avg: -70.8726 (0.851)
Step: 8000, Rewards: -42.2670, Reward: -43.5730 [23.93], Avg: -70.4982 (0.834)
Step: 9000, Rewards: -61.7988, Reward: -41.9009 [36.55], Avg: -71.2935 (0.817)
Step: 10000, Rewards: -59.0838, Reward: -49.1277 [26.09], Avg: -71.6500 (0.801)
Step: 11000, Rewards: -47.4447, Reward: -51.2000 [37.84], Avg: -73.0992 (0.785)
Step: 12000, Rewards: -57.4550, Reward: -56.0261 [22.54], Avg: -73.5201 (0.769)
Step: 13000, Rewards: -66.0257, Reward: -42.4781 [32.04], Avg: -73.5911 (0.754)
Step: 14000, Rewards: -57.5016, Reward: -52.4418 [23.04], Avg: -73.7170 (0.739)
Step: 15000, Rewards: -49.5613, Reward: -31.4653 [15.52], Avg: -72.0463 (0.724)
Step: 16000, Rewards: -53.8146, Reward: -43.0743 [17.95], Avg: -71.3980 (0.709)
Step: 17000, Rewards: -26.1741, Reward: -22.3510 [50.03], Avg: -71.4529 (0.695)
Step: 18000, Rewards: -24.8589, Reward: -54.9043 [17.61], Avg: -71.5088 (0.681)
Step: 19000, Rewards: -36.1163, Reward: -48.7602 [16.24], Avg: -71.1835 (0.668)
Step: 20000, Rewards: -46.1451, Reward: -48.0082 [34.84], Avg: -71.7389 (0.654)
Step: 21000, Rewards: -31.0332, Reward: -43.5072 [49.62], Avg: -72.7112 (0.641)
Step: 22000, Rewards: -38.8245, Reward: -39.2353 [19.56], Avg: -72.1063 (0.628)
Step: 23000, Rewards: -30.7411, Reward: -25.5257 [31.25], Avg: -71.4675 (0.616)
Step: 24000, Rewards: -56.4676, Reward: -25.3815 [26.01], Avg: -70.6645 (0.603)
Step: 25000, Rewards: -25.2128, Reward: -25.9064 [40.81], Avg: -70.5127 (0.591)
Step: 26000, Rewards: -27.0693, Reward: -20.6805 [51.23], Avg: -70.5645 (0.580)
Step: 27000, Rewards: -11.6175, Reward: -30.4215 [26.78], Avg: -70.0872 (0.568)
Step: 28000, Rewards: -21.9027, Reward: -14.2308 [35.44], Avg: -69.3833 (0.557)
Step: 29000, Rewards: -27.6063, Reward: -32.0663 [25.69], Avg: -68.9957 (0.545)
Step: 30000, Rewards: -48.8553, Reward: -37.5166 [56.10], Avg: -69.7900 (0.535)
Step: 31000, Rewards: -23.7798, Reward: -19.1790 [42.43], Avg: -69.5343 (0.524)
Step: 32000, Rewards: 7.8995, Reward: -1.0525 [50.11], Avg: -68.9776 (0.513)
Step: 33000, Rewards: -8.3338, Reward: 5.4491 [65.05], Avg: -68.7019 (0.503)
Step: 34000, Rewards: 34.0456, Reward: 32.0503 [82.91], Avg: -68.1922 (0.493)
Step: 35000, Rewards: -5.8109, Reward: -12.7971 [70.06], Avg: -68.5995 (0.483)
Step: 36000, Rewards: 8.8610, Reward: -5.2843 [64.55], Avg: -68.6328 (0.474)
Step: 37000, Rewards: -17.7105, Reward: 29.8337 [42.02], Avg: -67.1474 (0.464)
Step: 38000, Rewards: -5.0753, Reward: 20.6388 [71.67], Avg: -66.7342 (0.455)
Step: 39000, Rewards: 25.5123, Reward: -5.3423 [63.23], Avg: -66.7803 (0.446)
Step: 40000, Rewards: 33.6574, Reward: -1.3970 [75.84], Avg: -67.0353 (0.437)
Step: 41000, Rewards: -9.5836, Reward: 4.9154 [58.05], Avg: -66.7043 (0.428)
Step: 42000, Rewards: 50.0763, Reward: 56.9816 [106.09], Avg: -66.2950 (0.419)
Step: 43000, Rewards: 47.8288, Reward: 38.0333 [101.25], Avg: -66.2249 (0.411)
Step: 44000, Rewards: 20.3391, Reward: 97.1969 [46.12], Avg: -63.6181 (0.403)
Step: 45000, Rewards: 78.9895, Reward: 52.2725 [73.86], Avg: -62.7044 (0.395)
Step: 46000, Rewards: 52.6118, Reward: 75.0742 [86.44], Avg: -61.6121 (0.387)
Step: 47000, Rewards: 126.6270, Reward: 77.0719 [132.40], Avg: -61.4812 (0.379)
Step: 48000, Rewards: 119.2572, Reward: 175.0861 [144.28], Avg: -59.5978 (0.372)
Step: 49000, Rewards: 127.0374, Reward: 166.5495 [127.33], Avg: -57.6214 (0.364)
Step: 50000, Rewards: 95.7279, Reward: 150.9654 [132.88], Avg: -56.1369 (0.357)
Step: 51000, Rewards: 122.2823, Reward: 94.8907 [111.96], Avg: -55.3856 (0.350)
Step: 52000, Rewards: 122.8688, Reward: 166.5582 [98.57], Avg: -53.0579 (0.343)
Step: 53000, Rewards: 151.3119, Reward: 185.7624 [140.23], Avg: -51.2322 (0.336)
Step: 54000, Rewards: 60.0676, Reward: 196.1062 [113.51], Avg: -48.7990 (0.329)
Step: 55000, Rewards: 157.7940, Reward: 125.8624 [83.83], Avg: -47.1770 (0.323)
Step: 56000, Rewards: 174.5576, Reward: 179.8562 [148.83], Avg: -45.8050 (0.316)
Step: 57000, Rewards: 171.7436, Reward: 184.5789 [105.88], Avg: -43.6583 (0.310)
Step: 58000, Rewards: 335.3611, Reward: 245.7050 [167.03], Avg: -41.5848 (0.304)
Step: 59000, Rewards: 262.1920, Reward: 188.9294 [105.16], Avg: -39.4956 (0.298)
Step: 60000, Rewards: 290.1113, Reward: 316.3190 [138.82], Avg: -35.9383 (0.292)
Step: 61000, Rewards: 233.3306, Reward: 251.7050 [177.95], Avg: -34.1691 (0.286)
Step: 62000, Rewards: 162.6703, Reward: 73.7001 [101.61], Avg: -34.0698 (0.280)
Step: 63000, Rewards: 199.8901, Reward: 148.8603 [105.93], Avg: -32.8667 (0.274)
Step: 64000, Rewards: 238.8625, Reward: 238.2366 [144.22], Avg: -30.9146 (0.269)
Step: 65000, Rewards: 215.5565, Reward: 202.3954 [136.41], Avg: -29.4464 (0.264)
Step: 66000, Rewards: 268.2707, Reward: 171.9532 [110.36], Avg: -28.0876 (0.258)
Step: 67000, Rewards: 219.0524, Reward: 368.6584 [190.75], Avg: -25.0583 (0.253)
Step: 68000, Rewards: 286.0110, Reward: 419.6445 [179.56], Avg: -21.2157 (0.248)
Step: 69000, Rewards: 401.9955, Reward: 361.2058 [97.00], Avg: -17.1383 (0.243)
Step: 70000, Rewards: 297.5393, Reward: 486.2055 [177.24], Avg: -12.5453 (0.238)
Step: 71000, Rewards: 300.6387, Reward: 331.5202 [194.04], Avg: -10.4616 (0.233)
Step: 72000, Rewards: 317.6959, Reward: 317.8613 [127.08], Avg: -7.7049 (0.229)
Step: 73000, Rewards: 333.5302, Reward: 361.0392 [125.18], Avg: -4.4135 (0.224)
Step: 74000, Rewards: 364.3822, Reward: 406.9103 [155.95], Avg: -1.0085 (0.220)
Step: 75000, Rewards: 419.8832, Reward: 438.0008 [183.08], Avg: 2.3591 (0.215)
Step: 76000, Rewards: 556.0629, Reward: 424.3612 [192.79], Avg: 5.3358 (0.211)
Step: 77000, Rewards: 548.5824, Reward: 434.9492 [193.20], Avg: 8.3667 (0.207)
Step: 78000, Rewards: 474.2452, Reward: 468.6378 [131.58], Avg: 12.5273 (0.203)
Step: 79000, Rewards: 534.7834, Reward: 530.2363 [150.63], Avg: 17.1158 (0.199)
Step: 80000, Rewards: 490.8011, Reward: 529.6613 [131.38], Avg: 21.8215 (0.195)
Step: 81000, Rewards: 520.3696, Reward: 471.1883 [138.94], Avg: 25.6072 (0.191)
Step: 82000, Rewards: 469.5317, Reward: 475.7247 [174.86], Avg: 28.9236 (0.187)
Step: 83000, Rewards: 526.1471, Reward: 471.9907 [118.65], Avg: 32.7857 (0.183)
Step: 84000, Rewards: 558.4459, Reward: 540.0373 [193.28], Avg: 36.4795 (0.180)
Step: 85000, Rewards: 579.5017, Reward: 647.4579 [160.48], Avg: 41.7178 (0.176)
Step: 86000, Rewards: 474.7673, Reward: 530.0671 [179.60], Avg: 45.2667 (0.172)
Step: 87000, Rewards: 660.6249, Reward: 667.8311 [179.08], Avg: 50.3063 (0.169)
Step: 88000, Rewards: 539.2907, Reward: 474.6591 [230.93], Avg: 52.4796 (0.166)
Step: 89000, Rewards: 340.8553, Reward: 323.2359 [221.62], Avg: 53.0256 (0.162)
Step: 90000, Rewards: 491.6527, Reward: 501.8584 [260.70], Avg: 55.0930 (0.159)
Step: 91000, Rewards: 629.1791, Reward: 553.2867 [166.13], Avg: 58.7023 (0.156)
Step: 92000, Rewards: 557.1427, Reward: 673.8535 [124.61], Avg: 63.9770 (0.153)
Step: 93000, Rewards: 545.5790, Reward: 566.8582 [202.32], Avg: 67.1744 (0.150)
Step: 94000, Rewards: 601.1410, Reward: 628.4289 [153.70], Avg: 71.4645 (0.147)
Step: 95000, Rewards: 573.9201, Reward: 630.2179 [207.75], Avg: 75.1207 (0.144)
Step: 96000, Rewards: 625.4765, Reward: 713.8109 [122.51], Avg: 80.4422 (0.141)
Step: 97000, Rewards: 609.8144, Reward: 609.3121 [174.68], Avg: 84.0563 (0.138)
Step: 98000, Rewards: 565.8088, Reward: 545.7031 [179.65], Avg: 86.9047 (0.135)
Step: 99000, Rewards: 584.5343, Reward: 648.4291 [168.55], Avg: 90.8344 (0.133)
Step: 100000, Rewards: 606.1560, Reward: 578.0156 [184.09], Avg: 93.8354 (0.130)
Step: 101000, Rewards: 554.9626, Reward: 545.4484 [173.46], Avg: 96.5623 (0.127)
Step: 102000, Rewards: 539.6832, Reward: 505.1898 [198.40], Avg: 98.6034 (0.125)
Step: 103000, Rewards: 546.3647, Reward: 567.1151 [184.20], Avg: 101.3371 (0.122)
Step: 104000, Rewards: 499.8054, Reward: 375.0285 [210.15], Avg: 101.9423 (0.120)
Step: 105000, Rewards: 578.1669, Reward: 543.5777 [167.02], Avg: 104.5330 (0.117)
Step: 106000, Rewards: 569.2876, Reward: 623.8944 [220.30], Avg: 107.3280 (0.115)
Step: 107000, Rewards: 583.1826, Reward: 651.0499 [195.87], Avg: 110.5489 (0.113)
Step: 108000, Rewards: 613.9567, Reward: 637.2871 [178.92], Avg: 113.7399 (0.111)
Step: 109000, Rewards: 663.9676, Reward: 696.8890 [154.74], Avg: 117.6345 (0.108)
Step: 110000, Rewards: 653.3364, Reward: 703.3561 [181.62], Avg: 121.2751 (0.106)
Step: 111000, Rewards: 635.1641, Reward: 593.3462 [236.96], Avg: 123.3742 (0.104)
Step: 112000, Rewards: 711.1272, Reward: 701.8620 [186.75], Avg: 126.8409 (0.102)
Step: 113000, Rewards: 727.9435, Reward: 772.2031 [58.03], Avg: 131.9930 (0.100)
Step: 114000, Rewards: 763.7501, Reward: 764.0498 [72.87], Avg: 136.8555 (0.098)
Step: 115000, Rewards: 728.3055, Reward: 727.4780 [105.13], Avg: 141.0408 (0.096)
Step: 116000, Rewards: 817.1649, Reward: 772.5494 [140.79], Avg: 145.2349 (0.094)
Step: 117000, Rewards: 825.5535, Reward: 800.1215 [34.81], Avg: 150.4898 (0.092)
Step: 118000, Rewards: 735.4142, Reward: 750.1692 [106.78], Avg: 154.6318 (0.090)
Step: 119000, Rewards: 802.4421, Reward: 683.6773 [146.15], Avg: 157.8226 (0.089)
Step: 120000, Rewards: 767.6673, Reward: 765.2056 [134.64], Avg: 161.7295 (0.087)
Step: 121000, Rewards: 791.4887, Reward: 734.6289 [130.68], Avg: 165.3543 (0.085)
Step: 122000, Rewards: 744.7114, Reward: 876.5479 [39.08], Avg: 170.8186 (0.083)
Step: 123000, Rewards: 706.6011, Reward: 571.0592 [244.37], Avg: 172.0756 (0.082)
Step: 124000, Rewards: 768.8611, Reward: 763.2914 [123.46], Avg: 175.8176 (0.080)
Step: 125000, Rewards: 836.3548, Reward: 674.6089 [222.48], Avg: 178.0106 (0.078)
Step: 126000, Rewards: 790.5841, Reward: 811.7408 [122.20], Avg: 182.0384 (0.077)
Step: 127000, Rewards: 695.7810, Reward: 692.8373 [185.93], Avg: 184.5764 (0.075)
Step: 128000, Rewards: 728.8968, Reward: 818.7112 [41.63], Avg: 189.1695 (0.074)
Step: 129000, Rewards: 849.7020, Reward: 811.6731 [26.85], Avg: 193.7514 (0.072)
Step: 130000, Rewards: 817.0137, Reward: 834.4708 [48.78], Avg: 198.2700 (0.071)
Step: 131000, Rewards: 820.0161, Reward: 857.9842 [27.38], Avg: 203.0605 (0.069)
Step: 132000, Rewards: 865.0199, Reward: 868.1764 [17.28], Avg: 207.9314 (0.068)
Step: 133000, Rewards: 828.7701, Reward: 843.0173 [90.72], Avg: 211.9939 (0.067)
Step: 134000, Rewards: 817.6793, Reward: 809.3871 [56.18], Avg: 216.0029 (0.065)
Step: 135000, Rewards: 761.5313, Reward: 848.6427 [31.66], Avg: 220.4219 (0.064)
Step: 136000, Rewards: 819.1861, Reward: 723.8784 [120.51], Avg: 223.2171 (0.063)
Step: 137000, Rewards: 779.8861, Reward: 803.3334 [130.00], Avg: 226.4788 (0.062)
Step: 138000, Rewards: 857.4206, Reward: 853.6051 [33.82], Avg: 230.7472 (0.060)
Step: 139000, Rewards: 864.4579, Reward: 828.5797 [35.40], Avg: 234.7645 (0.059)
Step: 140000, Rewards: 820.5381, Reward: 817.2555 [41.93], Avg: 238.5983 (0.058)
Step: 141000, Rewards: 802.8334, Reward: 833.4288 [25.32], Avg: 242.6090 (0.057)
Step: 142000, Rewards: 841.2795, Reward: 834.3682 [44.95], Avg: 246.4328 (0.056)
Step: 143000, Rewards: 908.0257, Reward: 825.0264 [97.99], Avg: 249.7703 (0.055)
Step: 144000, Rewards: 820.0962, Reward: 870.2328 [21.08], Avg: 253.9040 (0.053)
Step: 145000, Rewards: 817.9253, Reward: 816.0344 [121.40], Avg: 256.9227 (0.052)
Step: 146000, Rewards: 808.4708, Reward: 809.0410 [98.71], Avg: 260.0071 (0.051)
Step: 147000, Rewards: 815.7349, Reward: 837.5850 [66.98], Avg: 263.4571 (0.050)
Step: 148000, Rewards: 843.3801, Reward: 776.1998 [193.41], Avg: 265.6004 (0.049)
Step: 149000, Rewards: 852.3126, Reward: 816.2597 [83.66], Avg: 268.7137 (0.048)
Step: 150000, Rewards: 799.5341, Reward: 865.9907 [39.78], Avg: 272.4057 (0.047)
Step: 151000, Rewards: 889.8462, Reward: 746.1622 [159.52], Avg: 274.4731 (0.046)
Step: 152000, Rewards: 837.9960, Reward: 671.9626 [183.69], Avg: 275.8704 (0.045)
Step: 153000, Rewards: 757.8784, Reward: 860.6315 [32.34], Avg: 279.4576 (0.045)
Step: 154000, Rewards: 833.6731, Reward: 818.3986 [146.59], Avg: 281.9889 (0.044)
Step: 155000, Rewards: 808.2457, Reward: 782.3486 [118.05], Avg: 284.4396 (0.043)
Step: 156000, Rewards: 792.7318, Reward: 872.3662 [30.57], Avg: 287.9897 (0.042)
Step: 157000, Rewards: 762.4179, Reward: 846.6051 [32.83], Avg: 291.3174 (0.041)
Step: 158000, Rewards: 936.3448, Reward: 865.1202 [17.19], Avg: 294.8181 (0.040)
Step: 159000, Rewards: 889.1000, Reward: 800.5530 [145.64], Avg: 297.0687 (0.039)
Step: 160000, Rewards: 961.9887, Reward: 863.1371 [34.44], Avg: 300.3708 (0.039)
Step: 161000, Rewards: 863.3882, Reward: 845.7156 [112.30], Avg: 303.0439 (0.038)
Step: 162000, Rewards: 883.9592, Reward: 877.5668 [48.57], Avg: 306.2706 (0.037)
Step: 163000, Rewards: 928.4652, Reward: 889.3423 [21.94], Avg: 309.6921 (0.036)
Step: 164000, Rewards: 949.0365, Reward: 882.3716 [55.49], Avg: 312.8266 (0.036)
Step: 165000, Rewards: 890.2701, Reward: 890.1414 [32.35], Avg: 316.1095 (0.035)
Step: 166000, Rewards: 922.7846, Reward: 880.9330 [62.30], Avg: 319.1187 (0.034)
Step: 167000, Rewards: 884.1734, Reward: 844.5061 [129.69], Avg: 321.4740 (0.034)
Step: 168000, Rewards: 915.5429, Reward: 896.9568 [18.45], Avg: 324.7700 (0.033)
Step: 169000, Rewards: 955.7422, Reward: 877.7964 [28.25], Avg: 327.8570 (0.032)
Step: 170000, Rewards: 883.5897, Reward: 862.3271 [58.24], Avg: 330.6419 (0.032)
Step: 171000, Rewards: 913.7643, Reward: 860.1078 [99.27], Avg: 333.1431 (0.031)
Step: 172000, Rewards: 852.3526, Reward: 862.4995 [27.36], Avg: 336.0448 (0.030)
Step: 173000, Rewards: 832.2554, Reward: 878.3228 [25.07], Avg: 339.0172 (0.030)
Step: 174000, Rewards: 900.1602, Reward: 829.4990 [49.50], Avg: 341.5372 (0.029)
Step: 175000, Rewards: 864.3437, Reward: 778.9225 [191.08], Avg: 342.9366 (0.029)
Step: 176000, Rewards: 852.4940, Reward: 830.9419 [135.89], Avg: 344.9259 (0.028)
Step: 177000, Rewards: 899.7510, Reward: 884.0574 [35.22], Avg: 347.7569 (0.027)
Step: 178000, Rewards: 857.9752, Reward: 830.2281 [33.06], Avg: 350.2676 (0.027)
Step: 179000, Rewards: 826.3835, Reward: 782.8073 [64.84], Avg: 352.3104 (0.026)
Step: 180000, Rewards: 861.5621, Reward: 871.0337 [22.59], Avg: 355.0514 (0.026)
Step: 181000, Rewards: 963.9042, Reward: 775.6220 [197.17], Avg: 356.2789 (0.025)
Step: 182000, Rewards: 892.7265, Reward: 880.1990 [14.41], Avg: 359.0631 (0.025)
Step: 183000, Rewards: 904.8460, Reward: 888.9308 [25.01], Avg: 361.8069 (0.024)
Step: 184000, Rewards: 915.3468, Reward: 879.7622 [14.12], Avg: 364.5303 (0.024)
Step: 185000, Rewards: 841.2127, Reward: 892.8279 [18.31], Avg: 367.2722 (0.023)
Step: 186000, Rewards: 866.0455, Reward: 860.5657 [16.75], Avg: 369.8205 (0.023)
Step: 187000, Rewards: 858.3260, Reward: 881.2554 [16.96], Avg: 372.4507 (0.022)
Step: 188000, Rewards: 965.3676, Reward: 889.6449 [17.58], Avg: 375.0942 (0.022)
Step: 189000, Rewards: 902.5928, Reward: 908.2888 [22.29], Avg: 377.7831 (0.022)
Step: 190000, Rewards: 950.9975, Reward: 890.6307 [27.38], Avg: 380.3248 (0.021)
Step: 191000, Rewards: 917.5768, Reward: 869.6703 [32.55], Avg: 382.7040 (0.021)
Step: 192000, Rewards: 881.5812, Reward: 840.9878 [83.33], Avg: 384.6467 (0.020)
Step: 193000, Rewards: 868.4545, Reward: 912.9447 [15.40], Avg: 387.2905 (0.020)
Step: 194000, Rewards: 956.0033, Reward: 859.0460 [58.12], Avg: 389.4117 (0.020)
Step: 195000, Rewards: 1002.2288, Reward: 724.9034 [241.60], Avg: 389.8908 (0.020)
Step: 196000, Rewards: 1010.0564, Reward: 781.9015 [224.43], Avg: 390.7415 (0.020)
Step: 197000, Rewards: 887.9660, Reward: 865.7765 [54.89], Avg: 392.8634 (0.020)
Step: 198000, Rewards: 1011.2308, Reward: 891.4199 [44.03], Avg: 395.1475 (0.020)
Step: 199000, Rewards: 873.3350, Reward: 776.1560 [114.37], Avg: 396.4807 (0.020)
Step: 200000, Rewards: 961.0126, Reward: 782.3583 [207.64], Avg: 397.3674 (0.020)
Step: 201000, Rewards: 878.5566, Reward: 816.5480 [230.81], Avg: 398.2999 (0.020)
Step: 202000, Rewards: 1049.9312, Reward: 827.0777 [191.44], Avg: 399.4691 (0.020)
Step: 203000, Rewards: 1116.0618, Reward: 923.4300 [7.49], Avg: 402.0008 (0.020)
Step: 204000, Rewards: 1104.3836, Reward: 855.4506 [166.21], Avg: 403.4020 (0.020)
Step: 205000, Rewards: 1003.6242, Reward: 909.8730 [20.56], Avg: 405.7607 (0.020)
Step: 206000, Rewards: 1056.7963, Reward: 866.2179 [104.38], Avg: 407.4809 (0.020)
Step: 207000, Rewards: 966.3533, Reward: 827.7789 [194.56], Avg: 408.5662 (0.020)
Step: 208000, Rewards: 1015.4073, Reward: 861.2598 [136.96], Avg: 410.0769 (0.020)
Step: 209000, Rewards: 1024.8261, Reward: 870.6636 [76.43], Avg: 411.9062 (0.020)
Step: 210000, Rewards: 1089.5572, Reward: 877.2038 [22.42], Avg: 414.0051 (0.020)
Step: 211000, Rewards: 828.8370, Reward: 912.9208 [15.66], Avg: 416.2847 (0.020)
Step: 212000, Rewards: 982.2145, Reward: 846.4839 [116.28], Avg: 417.7585 (0.020)
Step: 213000, Rewards: 892.5687, Reward: 832.6794 [133.47], Avg: 419.0737 (0.020)
Step: 214000, Rewards: 848.0541, Reward: 797.7384 [200.21], Avg: 419.9037 (0.020)
Step: 215000, Rewards: 823.7929, Reward: 758.4626 [233.49], Avg: 420.3901 (0.020)
Step: 216000, Rewards: 857.7456, Reward: 860.9846 [60.72], Avg: 422.1407 (0.020)
Step: 217000, Rewards: 901.5459, Reward: 722.5499 [149.53], Avg: 422.8328 (0.020)
Step: 218000, Rewards: 880.4966, Reward: 649.7861 [253.30], Avg: 422.7125 (0.020)
Step: 219000, Rewards: 863.6877, Reward: 791.6803 [165.12], Avg: 423.6391 (0.020)
Step: 220000, Rewards: 885.0328, Reward: 880.3625 [20.42], Avg: 425.6133 (0.020)
Step: 221000, Rewards: 861.5954, Reward: 861.7368 [36.18], Avg: 427.4148 (0.020)
Step: 222000, Rewards: 876.4217, Reward: 853.0131 [27.98], Avg: 429.1979 (0.020)
Step: 223000, Rewards: 862.0156, Reward: 853.5031 [24.68], Avg: 430.9819 (0.020)
Step: 224000, Rewards: 888.7497, Reward: 871.2259 [16.54], Avg: 432.8650 (0.020)
Step: 225000, Rewards: 869.3457, Reward: 889.9966 [14.91], Avg: 434.8218 (0.020)
Step: 226000, Rewards: 848.9921, Reward: 885.0430 [19.92], Avg: 436.7174 (0.020)
Step: 227000, Rewards: 921.5282, Reward: 898.8384 [26.39], Avg: 438.6285 (0.020)
Step: 228000, Rewards: 963.2229, Reward: 881.6023 [31.15], Avg: 440.4269 (0.020)
Step: 229000, Rewards: 896.6856, Reward: 887.8588 [38.72], Avg: 442.2039 (0.020)
Step: 230000, Rewards: 887.1667, Reward: 789.9554 [222.59], Avg: 442.7457 (0.020)
Step: 231000, Rewards: 931.9837, Reward: 871.9163 [25.31], Avg: 444.4864 (0.020)
Step: 232000, Rewards: 972.8119, Reward: 739.2223 [252.41], Avg: 444.6681 (0.020)
Step: 233000, Rewards: 942.9527, Reward: 700.0298 [223.91], Avg: 444.8025 (0.020)
Step: 234000, Rewards: 788.7323, Reward: 809.1974 [126.66], Avg: 445.8142 (0.020)
Step: 235000, Rewards: 967.6944, Reward: 851.1252 [98.30], Avg: 447.1151 (0.020)
Step: 236000, Rewards: 980.8345, Reward: 881.3024 [16.61], Avg: 448.8770 (0.020)
Step: 237000, Rewards: 1022.3665, Reward: 910.5807 [17.16], Avg: 450.7448 (0.020)
Step: 238000, Rewards: 1042.5032, Reward: 890.5896 [74.38], Avg: 452.2740 (0.020)
Step: 239000, Rewards: 1034.6613, Reward: 885.3089 [61.10], Avg: 453.8237 (0.020)
Step: 240000, Rewards: 1010.2624, Reward: 896.9170 [22.53], Avg: 455.5688 (0.020)
Step: 241000, Rewards: 865.7028, Reward: 856.7666 [29.30], Avg: 457.1056 (0.020)
Step: 242000, Rewards: 902.1648, Reward: 873.5238 [16.59], Avg: 458.7510 (0.020)
Step: 243000, Rewards: 819.5829, Reward: 805.7553 [162.00], Avg: 459.5092 (0.020)
Step: 244000, Rewards: 900.2211, Reward: 862.9321 [81.97], Avg: 460.8212 (0.020)
Step: 245000, Rewards: 881.0538, Reward: 848.0957 [89.83], Avg: 462.0303 (0.020)
Step: 246000, Rewards: 933.6642, Reward: 841.3451 [82.10], Avg: 463.2336 (0.020)
Step: 247000, Rewards: 852.3715, Reward: 881.9221 [75.95], Avg: 464.6157 (0.020)
Step: 248000, Rewards: 907.5687, Reward: 892.5940 [49.01], Avg: 466.1376 (0.020)
Step: 249000, Rewards: 1017.0380, Reward: 896.8685 [24.77], Avg: 467.7615 (0.020)
Step: 250000, Rewards: 1052.1290, Reward: 882.5662 [20.82], Avg: 469.3311 (0.020)
Step: 251000, Rewards: 982.3322, Reward: 910.1650 [23.51], Avg: 470.9872 (0.020)
Step: 252000, Rewards: 1072.8916, Reward: 874.9470 [108.49], Avg: 472.1550 (0.020)
Step: 253000, Rewards: 924.1345, Reward: 862.2762 [26.01], Avg: 473.5886 (0.020)
Step: 254000, Rewards: 871.9115, Reward: 892.2738 [28.78], Avg: 475.1176 (0.020)
Step: 255000, Rewards: 947.0536, Reward: 916.1674 [19.90], Avg: 476.7627 (0.020)
Step: 256000, Rewards: 1095.0751, Reward: 873.7227 [63.48], Avg: 478.0603 (0.020)
Step: 257000, Rewards: 1158.9377, Reward: 902.4936 [29.52], Avg: 479.5910 (0.020)
Step: 258000, Rewards: 1073.7613, Reward: 819.9580 [251.37], Avg: 479.9346 (0.020)
Step: 259000, Rewards: 958.9892, Reward: 889.8941 [63.50], Avg: 481.2671 (0.020)
Step: 260000, Rewards: 909.3113, Reward: 806.4444 [187.58], Avg: 481.7943 (0.020)
Step: 261000, Rewards: 929.5253, Reward: 794.4827 [168.57], Avg: 482.3444 (0.020)
Step: 262000, Rewards: 1016.7572, Reward: 892.1926 [36.09], Avg: 483.7655 (0.020)
Step: 263000, Rewards: 1023.7593, Reward: 817.4088 [172.14], Avg: 484.3773 (0.020)
Step: 264000, Rewards: 950.0833, Reward: 742.1162 [248.61], Avg: 484.4117 (0.020)
Step: 265000, Rewards: 908.0775, Reward: 897.1855 [63.93], Avg: 485.7232 (0.020)
Step: 266000, Rewards: 929.4948, Reward: 865.5581 [93.51], Avg: 486.7955 (0.020)
Step: 267000, Rewards: 961.9901, Reward: 724.9121 [155.48], Avg: 487.1039 (0.020)
Step: 268000, Rewards: 1009.6882, Reward: 878.1507 [114.06], Avg: 488.1336 (0.020)
Step: 269000, Rewards: 1037.0444, Reward: 839.8385 [161.55], Avg: 488.8378 (0.020)
Step: 270000, Rewards: 1091.4588, Reward: 907.9506 [25.54], Avg: 490.2901 (0.020)
Step: 271000, Rewards: 1073.6500, Reward: 883.0117 [68.32], Avg: 491.4828 (0.020)
Step: 272000, Rewards: 1159.3396, Reward: 895.1161 [22.30], Avg: 492.8796 (0.020)
Step: 273000, Rewards: 979.4148, Reward: 900.5089 [52.16], Avg: 494.1769 (0.020)
Step: 274000, Rewards: 1021.1140, Reward: 910.8037 [21.19], Avg: 495.6149 (0.020)
Step: 275000, Rewards: 986.6033, Reward: 891.6119 [63.13], Avg: 496.8209 (0.020)
Step: 276000, Rewards: 1156.1435, Reward: 856.5737 [178.99], Avg: 497.4735 (0.020)
Step: 277000, Rewards: 968.8912, Reward: 725.6863 [230.85], Avg: 497.4640 (0.020)
Step: 278000, Rewards: 970.3237, Reward: 906.5373 [16.23], Avg: 498.8720 (0.020)
Step: 279000, Rewards: 972.6422, Reward: 887.3130 [54.15], Avg: 500.0659 (0.020)
Step: 280000, Rewards: 1021.2686, Reward: 911.9397 [22.52], Avg: 501.4515 (0.020)
Step: 281000, Rewards: 986.8310, Reward: 870.9276 [41.62], Avg: 502.6141 (0.020)
Step: 282000, Rewards: 899.3857, Reward: 887.0931 [23.29], Avg: 503.8904 (0.020)
Step: 283000, Rewards: 999.3610, Reward: 902.1295 [18.69], Avg: 505.2269 (0.020)
Step: 284000, Rewards: 935.3432, Reward: 904.4691 [22.70], Avg: 506.5480 (0.020)
Step: 285000, Rewards: 975.8245, Reward: 911.3932 [21.95], Avg: 507.8868 (0.020)
Step: 286000, Rewards: 1091.7193, Reward: 867.5113 [139.01], Avg: 508.6555 (0.020)
Step: 287000, Rewards: 945.4710, Reward: 896.9560 [13.15], Avg: 509.9581 (0.020)
Step: 288000, Rewards: 856.2338, Reward: 916.4627 [18.86], Avg: 511.2994 (0.020)
Step: 289000, Rewards: 1006.5199, Reward: 857.1571 [150.83], Avg: 511.9719 (0.020)
Step: 290000, Rewards: 939.2019, Reward: 887.6976 [17.34], Avg: 513.2035 (0.020)
Step: 291000, Rewards: 779.6505, Reward: 897.7792 [23.85], Avg: 514.4389 (0.020)
Step: 292000, Rewards: 1000.5709, Reward: 786.9618 [216.81], Avg: 514.6290 (0.020)
Step: 293000, Rewards: 954.6023, Reward: 911.2809 [35.78], Avg: 515.8564 (0.020)
Step: 294000, Rewards: 976.7164, Reward: 802.2803 [198.67], Avg: 516.1539 (0.020)
Step: 295000, Rewards: 1114.7612, Reward: 916.8481 [13.78], Avg: 517.4611 (0.020)
Step: 296000, Rewards: 997.7171, Reward: 910.0074 [15.12], Avg: 518.7319 (0.020)
Step: 297000, Rewards: 866.6650, Reward: 913.7321 [18.05], Avg: 519.9968 (0.020)
Step: 298000, Rewards: 1050.0059, Reward: 828.1666 [202.93], Avg: 520.3488 (0.020)
Step: 299000, Rewards: 883.1161, Reward: 877.3631 [30.26], Avg: 521.4379 (0.020)
Step: 300000, Rewards: 901.9904, Reward: 885.5499 [33.38], Avg: 522.5367 (0.020)
Step: 301000, Rewards: 903.6447, Reward: 851.6737 [78.00], Avg: 523.3683 (0.020)
Step: 302000, Rewards: 923.6438, Reward: 848.7944 [101.20], Avg: 524.1083 (0.020)
Step: 303000, Rewards: 774.3192, Reward: 778.4985 [189.57], Avg: 524.3215 (0.020)
Step: 304000, Rewards: 965.8311, Reward: 818.6296 [190.57], Avg: 524.6617 (0.020)
Step: 305000, Rewards: 868.7319, Reward: 879.0698 [21.47], Avg: 525.7497 (0.020)
Step: 306000, Rewards: 940.9646, Reward: 838.7460 [78.30], Avg: 526.5142 (0.020)
Step: 307000, Rewards: 829.8651, Reward: 800.6737 [114.79], Avg: 527.0316 (0.020)
Step: 308000, Rewards: 885.0237, Reward: 818.6571 [110.21], Avg: 527.6187 (0.020)
Step: 309000, Rewards: 847.8183, Reward: 849.9956 [48.86], Avg: 528.5010 (0.020)
Step: 310000, Rewards: 819.1367, Reward: 774.0904 [167.72], Avg: 528.7514 (0.020)
Step: 311000, Rewards: 889.5115, Reward: 892.4842 [25.79], Avg: 529.8346 (0.020)
Step: 312000, Rewards: 1025.3873, Reward: 880.4890 [63.36], Avg: 530.7524 (0.020)
Step: 313000, Rewards: 969.2460, Reward: 907.8437 [27.07], Avg: 531.8671 (0.020)
Step: 314000, Rewards: 979.2372, Reward: 911.0439 [21.71], Avg: 533.0019 (0.020)
Step: 315000, Rewards: 1074.0572, Reward: 880.0670 [96.56], Avg: 533.7947 (0.020)
Step: 316000, Rewards: 991.7612, Reward: 914.4547 [21.05], Avg: 534.9291 (0.020)
Step: 317000, Rewards: 1025.1157, Reward: 783.1451 [191.72], Avg: 535.1068 (0.020)
Step: 318000, Rewards: 1072.4055, Reward: 925.3000 [4.01], Avg: 536.3174 (0.020)
Step: 319000, Rewards: 1047.4255, Reward: 903.3662 [47.62], Avg: 537.3156 (0.020)
Step: 320000, Rewards: 1063.5740, Reward: 898.4381 [25.97], Avg: 538.3597 (0.020)
Step: 321000, Rewards: 1036.3151, Reward: 886.2744 [34.33], Avg: 539.3336 (0.020)
Step: 322000, Rewards: 961.8181, Reward: 915.4929 [15.62], Avg: 540.4498 (0.020)
Step: 323000, Rewards: 1010.5107, Reward: 910.6384 [22.40], Avg: 541.5232 (0.020)
Step: 324000, Rewards: 1020.2222, Reward: 895.2161 [43.17], Avg: 542.4786 (0.020)
Step: 325000, Rewards: 1107.5474, Reward: 924.0600 [6.99], Avg: 543.6277 (0.020)
Step: 326000, Rewards: 990.9027, Reward: 729.1123 [253.39], Avg: 543.4200 (0.020)
Step: 327000, Rewards: 767.7147, Reward: 865.6860 [87.47], Avg: 544.1359 (0.020)
Step: 328000, Rewards: 880.4321, Reward: 838.4890 [148.10], Avg: 544.5804 (0.020)
Step: 329000, Rewards: 777.8138, Reward: 776.3982 [246.71], Avg: 544.5353 (0.020)
Step: 330000, Rewards: 1042.3067, Reward: 788.2312 [201.70], Avg: 544.6621 (0.020)
Step: 331000, Rewards: 928.2908, Reward: 811.3738 [171.35], Avg: 544.9494 (0.020)
Step: 332000, Rewards: 1034.3383, Reward: 886.7650 [36.06], Avg: 545.8676 (0.020)
Step: 333000, Rewards: 845.2751, Reward: 729.6632 [195.35], Avg: 545.8330 (0.020)
Step: 334000, Rewards: 754.6693, Reward: 695.0971 [220.75], Avg: 545.6196 (0.020)
Step: 335000, Rewards: 833.2145, Reward: 765.3480 [182.02], Avg: 545.7318 (0.020)
Step: 336000, Rewards: 873.8591, Reward: 732.5683 [186.58], Avg: 545.7326 (0.020)
Step: 337000, Rewards: 761.4461, Reward: 834.5728 [208.23], Avg: 545.9711 (0.020)
Step: 338000, Rewards: 894.6041, Reward: 704.3577 [205.00], Avg: 545.8336 (0.020)
Step: 339000, Rewards: 917.9267, Reward: 870.0374 [62.74], Avg: 546.6026 (0.020)
Step: 340000, Rewards: 960.5776, Reward: 832.0509 [115.75], Avg: 547.1003 (0.020)
Step: 341000, Rewards: 900.0410, Reward: 860.5092 [63.97], Avg: 547.8296 (0.020)
Step: 342000, Rewards: 796.5322, Reward: 884.4679 [16.56], Avg: 548.7628 (0.020)
Step: 343000, Rewards: 817.4760, Reward: 825.5572 [188.95], Avg: 549.0182 (0.020)
Step: 344000, Rewards: 916.5667, Reward: 902.3817 [23.52], Avg: 549.9742 (0.020)
Step: 345000, Rewards: 910.9720, Reward: 887.2410 [14.74], Avg: 550.9064 (0.020)
Step: 346000, Rewards: 918.4525, Reward: 843.4498 [91.89], Avg: 551.4846 (0.020)
Step: 347000, Rewards: 980.9209, Reward: 894.6096 [18.10], Avg: 552.4186 (0.020)
Step: 348000, Rewards: 886.8337, Reward: 873.9339 [27.51], Avg: 553.2610 (0.020)
Step: 349000, Rewards: 898.7720, Reward: 830.1327 [88.67], Avg: 553.7988 (0.020)
Step: 350000, Rewards: 887.5318, Reward: 842.8112 [86.84], Avg: 554.3747 (0.020)
Step: 351000, Rewards: 863.4256, Reward: 831.2384 [143.29], Avg: 554.7542 (0.020)
Step: 352000, Rewards: 841.6235, Reward: 727.6348 [163.00], Avg: 554.7822 (0.020)
Step: 353000, Rewards: 904.2918, Reward: 876.3402 [20.77], Avg: 555.6319 (0.020)
Step: 354000, Rewards: 843.7918, Reward: 744.0616 [143.63], Avg: 555.7581 (0.020)
Step: 355000, Rewards: 789.9342, Reward: 859.6920 [36.88], Avg: 556.5082 (0.020)
Step: 356000, Rewards: 729.3575, Reward: 866.1935 [44.88], Avg: 557.2500 (0.020)
Step: 357000, Rewards: 881.4061, Reward: 775.4194 [196.83], Avg: 557.3096 (0.020)
Step: 358000, Rewards: 889.5737, Reward: 874.1434 [24.07], Avg: 558.1251 (0.020)
Step: 359000, Rewards: 864.7332, Reward: 775.4100 [200.45], Avg: 558.1719 (0.020)
Step: 360000, Rewards: 693.9107, Reward: 797.4144 [131.55], Avg: 558.4702 (0.020)
Step: 361000, Rewards: 657.0263, Reward: 737.2255 [145.89], Avg: 558.5610 (0.020)
Step: 362000, Rewards: 673.9004, Reward: 735.2571 [160.74], Avg: 558.6049 (0.020)
Step: 363000, Rewards: 627.5055, Reward: 767.0556 [180.92], Avg: 558.6806 (0.020)
Step: 364000, Rewards: 866.3289, Reward: 641.5080 [263.63], Avg: 558.1852 (0.020)
Step: 365000, Rewards: 903.9610, Reward: 831.5242 [143.97], Avg: 558.5387 (0.020)
Step: 366000, Rewards: 781.7664, Reward: 870.7632 [60.08], Avg: 559.2257 (0.020)
Step: 367000, Rewards: 1038.9154, Reward: 886.3376 [69.99], Avg: 559.9244 (0.020)
Step: 368000, Rewards: 1044.7223, Reward: 902.5576 [41.62], Avg: 560.7402 (0.020)
Step: 369000, Rewards: 1016.1359, Reward: 894.9183 [24.07], Avg: 561.5783 (0.020)
Step: 370000, Rewards: 952.9209, Reward: 913.0075 [14.13], Avg: 562.4875 (0.020)
Step: 371000, Rewards: 839.2726, Reward: 881.7777 [39.10], Avg: 563.2407 (0.020)
Step: 372000, Rewards: 952.2729, Reward: 909.6673 [20.60], Avg: 564.1142 (0.020)
Step: 373000, Rewards: 967.3394, Reward: 889.1765 [25.28], Avg: 564.9158 (0.020)
Step: 374000, Rewards: 1019.1836, Reward: 877.9069 [33.12], Avg: 565.6621 (0.020)
Step: 375000, Rewards: 916.8428, Reward: 786.0064 [163.13], Avg: 565.8143 (0.020)
Step: 376000, Rewards: 925.7582, Reward: 883.6133 [20.26], Avg: 566.6035 (0.020)
Step: 377000, Rewards: 871.4976, Reward: 794.0125 [184.00], Avg: 566.7183 (0.020)
Step: 378000, Rewards: 852.6878, Reward: 888.7882 [34.56], Avg: 567.4769 (0.020)
Step: 379000, Rewards: 885.4523, Reward: 790.6043 [179.51], Avg: 567.5917 (0.020)
Step: 380000, Rewards: 791.8694, Reward: 768.1920 [180.72], Avg: 567.6438 (0.020)
Step: 381000, Rewards: 688.8677, Reward: 827.7646 [129.97], Avg: 567.9846 (0.020)
Step: 382000, Rewards: 679.7898, Reward: 849.9357 [73.21], Avg: 568.5296 (0.020)
Step: 383000, Rewards: 894.1294, Reward: 755.8164 [129.48], Avg: 568.6801 (0.020)
Step: 384000, Rewards: 881.0383, Reward: 692.4556 [248.01], Avg: 568.3574 (0.020)
Step: 385000, Rewards: 867.0874, Reward: 715.0793 [192.88], Avg: 568.2378 (0.020)
Step: 386000, Rewards: 788.8518, Reward: 811.4694 [161.03], Avg: 568.4502 (0.020)
Step: 387000, Rewards: 913.4866, Reward: 901.6634 [27.93], Avg: 569.2370 (0.020)
Step: 388000, Rewards: 920.9027, Reward: 876.2903 [28.55], Avg: 569.9530 (0.020)
Step: 389000, Rewards: 928.0959, Reward: 893.3773 [23.70], Avg: 570.7215 (0.020)
Step: 390000, Rewards: 843.7084, Reward: 781.2331 [169.04], Avg: 570.8276 (0.020)
Step: 391000, Rewards: 827.7629, Reward: 829.4917 [128.16], Avg: 571.1605 (0.020)
Step: 392000, Rewards: 868.1419, Reward: 830.8945 [95.72], Avg: 571.5778 (0.020)
Step: 393000, Rewards: 879.2158, Reward: 887.2368 [32.12], Avg: 572.2975 (0.020)
Step: 394000, Rewards: 836.6161, Reward: 867.6377 [16.48], Avg: 573.0035 (0.020)
Step: 395000, Rewards: 886.6374, Reward: 785.0085 [99.44], Avg: 573.2877 (0.020)
Step: 396000, Rewards: 840.5512, Reward: 767.7055 [171.27], Avg: 573.3460 (0.020)
Step: 397000, Rewards: 833.5445, Reward: 870.6780 [19.03], Avg: 574.0453 (0.020)
Step: 398000, Rewards: 848.0902, Reward: 837.6589 [49.04], Avg: 574.5831 (0.020)
Step: 399000, Rewards: 846.6124, Reward: 817.0720 [132.58], Avg: 574.8578 (0.020)
Step: 400000, Rewards: 869.9671, Reward: 856.8008 [50.22], Avg: 575.4357 (0.020)
Step: 401000, Rewards: 896.4939, Reward: 880.8333 [7.42], Avg: 576.1769 (0.020)
Step: 402000, Rewards: 903.9735, Reward: 888.8744 [78.95], Avg: 576.7570 (0.020)
Step: 403000, Rewards: 877.9142, Reward: 840.9961 [148.40], Avg: 577.0437 (0.020)
Step: 404000, Rewards: 849.8236, Reward: 829.7779 [85.68], Avg: 577.4562 (0.020)
Step: 405000, Rewards: 778.0457, Reward: 837.1698 [64.24], Avg: 577.9376 (0.020)
Step: 406000, Rewards: 818.0472, Reward: 761.2597 [155.45], Avg: 578.0061 (0.020)
Step: 407000, Rewards: 880.3381, Reward: 830.9250 [89.59], Avg: 578.4064 (0.020)
Step: 408000, Rewards: 875.9804, Reward: 868.5937 [28.75], Avg: 579.0457 (0.020)
Step: 409000, Rewards: 885.2794, Reward: 868.8493 [17.93], Avg: 579.7088 (0.020)
Step: 410000, Rewards: 889.2257, Reward: 892.4061 [26.09], Avg: 580.4061 (0.020)
Step: 411000, Rewards: 901.6123, Reward: 885.6689 [18.73], Avg: 581.1016 (0.020)
Step: 412000, Rewards: 829.0855, Reward: 890.1669 [28.58], Avg: 581.7807 (0.020)
Step: 413000, Rewards: 901.8684, Reward: 832.0029 [141.33], Avg: 582.0437 (0.020)
Step: 414000, Rewards: 832.2670, Reward: 822.6760 [96.37], Avg: 582.3914 (0.020)
Step: 415000, Rewards: 868.5054, Reward: 856.6340 [31.76], Avg: 582.9742 (0.020)
Step: 416000, Rewards: 888.9838, Reward: 783.8906 [124.28], Avg: 583.1580 (0.020)
Step: 417000, Rewards: 806.0549, Reward: 789.9932 [129.22], Avg: 583.3437 (0.020)
Step: 418000, Rewards: 825.7268, Reward: 799.5844 [184.57], Avg: 583.4193 (0.020)
Step: 419000, Rewards: 828.9960, Reward: 849.5897 [84.83], Avg: 583.8511 (0.020)
Step: 420000, Rewards: 902.5849, Reward: 889.7769 [18.43], Avg: 584.5340 (0.020)
Step: 421000, Rewards: 884.2259, Reward: 730.3394 [158.43], Avg: 584.5040 (0.020)
Step: 422000, Rewards: 854.6771, Reward: 838.4002 [43.33], Avg: 585.0018 (0.020)
Step: 423000, Rewards: 791.7826, Reward: 813.7808 [135.74], Avg: 585.2213 (0.020)
Step: 424000, Rewards: 855.5885, Reward: 800.9725 [125.22], Avg: 585.4343 (0.020)
Step: 425000, Rewards: 919.4207, Reward: 890.3187 [29.33], Avg: 586.0811 (0.020)
Step: 426000, Rewards: 854.6598, Reward: 814.3354 [59.93], Avg: 586.4753 (0.020)
Step: 427000, Rewards: 873.6775, Reward: 876.7244 [52.59], Avg: 587.0306 (0.020)
Step: 428000, Rewards: 887.0350, Reward: 882.6528 [12.49], Avg: 587.6906 (0.020)
Step: 429000, Rewards: 846.4878, Reward: 865.6788 [18.83], Avg: 588.2933 (0.020)
Step: 430000, Rewards: 839.1810, Reward: 748.8069 [142.01], Avg: 588.3362 (0.020)
Step: 431000, Rewards: 801.8750, Reward: 835.5150 [38.40], Avg: 588.8195 (0.020)
Step: 432000, Rewards: 733.0280, Reward: 804.4530 [137.44], Avg: 589.0001 (0.020)
Step: 433000, Rewards: 730.1464, Reward: 846.7791 [26.90], Avg: 589.5321 (0.020)
Step: 434000, Rewards: 859.8659, Reward: 697.5920 [151.95], Avg: 589.4312 (0.020)
Step: 435000, Rewards: 781.9957, Reward: 853.3934 [26.66], Avg: 589.9755 (0.020)
Step: 436000, Rewards: 875.9908, Reward: 807.2093 [124.19], Avg: 590.1884 (0.020)
Step: 437000, Rewards: 917.8603, Reward: 836.2657 [155.58], Avg: 590.3950 (0.020)
Step: 438000, Rewards: 970.3660, Reward: 866.4640 [56.00], Avg: 590.8963 (0.020)
Step: 439000, Rewards: 968.3608, Reward: 907.5112 [14.36], Avg: 591.5833 (0.020)
Step: 440000, Rewards: 984.1362, Reward: 832.2001 [150.73], Avg: 591.7871 (0.020)
Step: 441000, Rewards: 1081.6161, Reward: 910.3633 [19.76], Avg: 592.4631 (0.020)
Step: 442000, Rewards: 1039.6420, Reward: 885.7780 [10.01], Avg: 593.1027 (0.020)
Step: 443000, Rewards: 983.4202, Reward: 888.4093 [29.02], Avg: 593.7024 (0.020)
Step: 444000, Rewards: 918.0354, Reward: 877.3204 [82.75], Avg: 594.1538 (0.020)
Step: 445000, Rewards: 900.4300, Reward: 891.6819 [27.18], Avg: 594.7600 (0.020)
Step: 446000, Rewards: 902.2325, Reward: 899.4318 [16.42], Avg: 595.4048 (0.020)
Step: 447000, Rewards: 967.8513, Reward: 864.8681 [32.29], Avg: 595.9342 (0.020)
Step: 448000, Rewards: 918.5918, Reward: 895.3586 [22.48], Avg: 596.5510 (0.020)
Step: 449000, Rewards: 910.9509, Reward: 779.2328 [184.86], Avg: 596.5462 (0.020)
Step: 450000, Rewards: 882.1133, Reward: 857.3389 [65.45], Avg: 596.9793 (0.020)
Step: 451000, Rewards: 848.0105, Reward: 853.0294 [69.53], Avg: 597.3920 (0.020)
Step: 452000, Rewards: 863.4709, Reward: 677.9667 [235.61], Avg: 597.0497 (0.020)
Step: 453000, Rewards: 811.0139, Reward: 842.1628 [95.84], Avg: 597.3785 (0.020)
Step: 454000, Rewards: 871.0325, Reward: 865.6243 [29.84], Avg: 597.9025 (0.020)
Step: 455000, Rewards: 900.2892, Reward: 839.5386 [101.84], Avg: 598.2091 (0.020)
Step: 456000, Rewards: 867.0763, Reward: 849.6300 [105.17], Avg: 598.5291 (0.020)
Step: 457000, Rewards: 897.1113, Reward: 872.2947 [36.57], Avg: 599.0470 (0.020)
Step: 458000, Rewards: 819.7293, Reward: 788.4808 [182.35], Avg: 599.0624 (0.020)
Step: 459000, Rewards: 772.0972, Reward: 496.7138 [292.92], Avg: 598.2032 (0.020)
Step: 460000, Rewards: 670.2126, Reward: 774.2840 [129.10], Avg: 598.3051 (0.020)
Step: 461000, Rewards: 770.7468, Reward: 787.4069 [204.60], Avg: 598.2715 (0.020)
Step: 462000, Rewards: 838.3450, Reward: 810.0077 [120.94], Avg: 598.4676 (0.020)
Step: 463000, Rewards: 741.5645, Reward: 840.3963 [64.01], Avg: 598.8511 (0.020)
Step: 464000, Rewards: 847.7001, Reward: 758.3251 [243.13], Avg: 598.6712 (0.020)
Step: 465000, Rewards: 774.1042, Reward: 761.9147 [179.06], Avg: 598.6373 (0.020)
Step: 466000, Rewards: 799.8734, Reward: 842.1653 [119.73], Avg: 598.9024 (0.020)
Step: 467000, Rewards: 852.4308, Reward: 853.3791 [72.36], Avg: 599.2915 (0.020)
Step: 468000, Rewards: 863.2416, Reward: 851.1123 [67.95], Avg: 599.6835 (0.020)
Step: 469000, Rewards: 845.0231, Reward: 788.0398 [130.99], Avg: 599.8056 (0.020)
Step: 470000, Rewards: 812.7419, Reward: 849.6163 [16.01], Avg: 600.3020 (0.020)
Step: 471000, Rewards: 888.8702, Reward: 868.1974 [13.13], Avg: 600.8417 (0.020)
Step: 472000, Rewards: 820.8295, Reward: 819.6759 [38.16], Avg: 601.2237 (0.020)
Step: 473000, Rewards: 873.0511, Reward: 865.0474 [61.70], Avg: 601.6501 (0.020)
Step: 474000, Rewards: 794.1150, Reward: 865.1368 [16.23], Avg: 602.1707 (0.020)
Step: 475000, Rewards: 870.2564, Reward: 859.6363 [19.93], Avg: 602.6697 (0.020)
Step: 476000, Rewards: 864.2850, Reward: 868.0961 [14.65], Avg: 603.1954 (0.020)
Step: 477000, Rewards: 856.2588, Reward: 762.7367 [174.22], Avg: 603.1647 (0.020)
Step: 478000, Rewards: 856.2660, Reward: 840.6073 [10.54], Avg: 603.6384 (0.020)
Step: 479000, Rewards: 854.8632, Reward: 861.9442 [52.70], Avg: 604.0668 (0.020)
Step: 480000, Rewards: 730.2411, Reward: 746.2139 [218.72], Avg: 603.9076 (0.020)
Step: 481000, Rewards: 936.8461, Reward: 738.4854 [223.05], Avg: 603.7241 (0.020)
Step: 482000, Rewards: 872.0130, Reward: 446.6080 [270.25], Avg: 602.8392 (0.020)
Step: 483000, Rewards: 521.3091, Reward: 796.5937 [150.95], Avg: 602.9277 (0.020)
Step: 484000, Rewards: 838.4078, Reward: 867.3587 [26.85], Avg: 603.4175 (0.020)
Step: 485000, Rewards: 760.2834, Reward: 847.2653 [45.17], Avg: 603.8263 (0.020)
Step: 486000, Rewards: 773.7404, Reward: 848.0310 [117.48], Avg: 604.0865 (0.020)
Step: 487000, Rewards: 936.0652, Reward: 797.9196 [212.08], Avg: 604.0491 (0.020)
Step: 488000, Rewards: 825.1569, Reward: 882.7324 [35.39], Avg: 604.5467 (0.020)
Step: 489000, Rewards: 941.4917, Reward: 836.4600 [152.67], Avg: 604.7084 (0.020)
Step: 490000, Rewards: 848.6868, Reward: 880.9793 [65.20], Avg: 605.1383 (0.020)
Step: 491000, Rewards: 892.2887, Reward: 858.2177 [145.58], Avg: 605.3568 (0.020)
Step: 492000, Rewards: 889.9267, Reward: 864.1953 [86.65], Avg: 605.7060 (0.020)
Step: 493000, Rewards: 961.5201, Reward: 803.5282 [162.82], Avg: 605.7769 (0.020)
Step: 494000, Rewards: 904.9014, Reward: 876.1763 [13.05], Avg: 606.2968 (0.020)
Step: 495000, Rewards: 866.0876, Reward: 889.3315 [13.13], Avg: 606.8409 (0.020)
Step: 496000, Rewards: 929.0908, Reward: 795.0576 [130.77], Avg: 606.9565 (0.020)
Step: 497000, Rewards: 915.5244, Reward: 826.4585 [159.53], Avg: 607.0769 (0.020)
Step: 498000, Rewards: 976.2385, Reward: 749.5327 [302.50], Avg: 606.7562 (0.020)
Step: 499000, Rewards: 960.2503, Reward: 909.0776 [22.62], Avg: 607.3156 (0.020)
