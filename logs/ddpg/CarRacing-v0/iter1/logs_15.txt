Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN

LEARN_RATE = 0.00005           	# Sets how much we want to update the network weights at each training step
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.0225               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -51.1464, Test: -57.3820 [13.50], Avg: -70.8793 (0.980)
Ep: 1, Reward: -65.0913, Test: -54.6076 [24.23], Avg: -74.8572 (0.960)
Ep: 2, Reward: -49.8789, Test: -49.1306 [27.44], Avg: -75.4285 (0.941)
Ep: 3, Reward: -75.9866, Test: -50.4596 [25.38], Avg: -75.5301 (0.922)
Ep: 4, Reward: -41.4164, Test: -48.2540 [19.71], Avg: -74.0169 (0.904)
Ep: 5, Reward: -45.3018, Test: -45.9731 [23.69], Avg: -73.2920 (0.886)
Ep: 6, Reward: -49.6387, Test: -54.0245 [21.51], Avg: -73.6130 (0.868)
Ep: 7, Reward: -70.4760, Test: -45.0823 [18.65], Avg: -72.3774 (0.851)
Ep: 8, Reward: -45.5966, Test: -56.1250 [16.12], Avg: -72.3628 (0.834)
Ep: 9, Reward: -43.1126, Test: -54.1921 [19.39], Avg: -72.4846 (0.817)
Ep: 10, Reward: -43.7462, Test: -58.9265 [15.55], Avg: -72.6659 (0.801)
Ep: 11, Reward: -48.0761, Test: -50.0875 [19.72], Avg: -72.4277 (0.785)
Ep: 12, Reward: -53.4029, Test: -41.8864 [24.69], Avg: -71.9778 (0.769)
Ep: 13, Reward: -63.0533, Test: -65.4835 [35.33], Avg: -74.0376 (0.754)
Ep: 14, Reward: -59.3173, Test: -54.7704 [27.74], Avg: -74.6022 (0.739)
Ep: 15, Reward: -48.7267, Test: -54.9600 [19.30], Avg: -74.5807 (0.724)
Ep: 16, Reward: -51.3000, Test: -41.5695 [30.45], Avg: -74.4299 (0.709)
Ep: 17, Reward: -43.2813, Test: -48.7245 [22.83], Avg: -74.2703 (0.695)
Ep: 18, Reward: -47.9916, Test: -53.4302 [50.18], Avg: -75.8145 (0.681)
Ep: 19, Reward: -27.9112, Test: -45.9626 [22.43], Avg: -75.4434 (0.668)
Ep: 20, Reward: -34.1215, Test: -45.2337 [15.80], Avg: -74.7572 (0.654)
Ep: 21, Reward: -52.5301, Test: -55.6346 [35.17], Avg: -75.4866 (0.641)
Ep: 22, Reward: -30.5208, Test: -29.5438 [23.06], Avg: -74.4916 (0.628)
Ep: 23, Reward: -31.7344, Test: -45.4015 [34.29], Avg: -74.7082 (0.616)
Ep: 24, Reward: -17.5093, Test: -29.3117 [34.75], Avg: -74.2823 (0.603)
Ep: 25, Reward: -53.6473, Test: -62.2835 [54.02], Avg: -75.8987 (0.591)
Ep: 26, Reward: -30.4788, Test: -38.3948 [23.74], Avg: -75.3889 (0.580)
Ep: 27, Reward: -49.2995, Test: -48.9717 [23.50], Avg: -75.2847 (0.568)
Ep: 28, Reward: -20.9219, Test: -38.2725 [47.30], Avg: -75.6396 (0.557)
Ep: 29, Reward: -14.3269, Test: -28.2495 [41.35], Avg: -75.4382 (0.545)
Ep: 30, Reward: -43.5400, Test: -38.7627 [30.03], Avg: -75.2237 (0.535)
Ep: 31, Reward: -46.5421, Test: -33.5716 [31.25], Avg: -74.8987 (0.524)
Ep: 32, Reward: -36.1036, Test: -31.6250 [21.21], Avg: -74.2302 (0.513)
Ep: 33, Reward: -50.3433, Test: -25.7713 [36.70], Avg: -73.8843 (0.503)
Ep: 34, Reward: -36.7835, Test: 6.6095 [40.12], Avg: -72.7308 (0.493)
Ep: 35, Reward: -44.9605, Test: -4.2791 [54.14], Avg: -72.3332 (0.483)
Ep: 36, Reward: -13.4986, Test: -25.3470 [16.63], Avg: -71.5129 (0.474)
Ep: 37, Reward: -23.4806, Test: -21.0652 [38.87], Avg: -71.2082 (0.464)
Ep: 38, Reward: -23.2755, Test: 16.8697 [59.64], Avg: -70.4791 (0.455)
Ep: 39, Reward: -1.8002, Test: 13.3312 [56.89], Avg: -69.8060 (0.446)
Ep: 40, Reward: 37.4940, Test: 40.8992 [114.56], Avg: -69.9001 (0.437)
Ep: 41, Reward: 73.0978, Test: 53.4681 [111.77], Avg: -69.6240 (0.428)
Ep: 42, Reward: 59.3225, Test: 53.1028 [105.93], Avg: -69.2333 (0.419)
Ep: 43, Reward: 46.2268, Test: 24.3590 [61.83], Avg: -68.5115 (0.411)
Ep: 44, Reward: 43.0707, Test: 121.0741 [95.98], Avg: -66.4313 (0.403)
Ep: 45, Reward: 22.5762, Test: 43.5148 [68.06], Avg: -65.5208 (0.395)
Ep: 46, Reward: 34.7581, Test: 142.5660 [147.14], Avg: -64.2241 (0.387)
Ep: 47, Reward: 96.7104, Test: 118.8247 [135.81], Avg: -63.2400 (0.379)
Ep: 48, Reward: 92.8123, Test: 78.4969 [108.94], Avg: -62.5707 (0.372)
Ep: 49, Reward: 112.6923, Test: 63.7680 [105.27], Avg: -62.1494 (0.364)
Ep: 50, Reward: 64.0592, Test: 122.6162 [148.57], Avg: -61.4397 (0.357)
Ep: 51, Reward: 84.4509, Test: 150.9962 [135.33], Avg: -59.9568 (0.350)
Ep: 52, Reward: 248.1091, Test: 133.7391 [125.31], Avg: -58.6666 (0.343)
Ep: 53, Reward: 152.9941, Test: 189.5354 [100.80], Avg: -55.9369 (0.336)
Ep: 54, Reward: 255.9956, Test: 183.5425 [123.98], Avg: -53.8368 (0.329)
Ep: 55, Reward: 157.3339, Test: 220.1444 [141.41], Avg: -51.4695 (0.323)
Ep: 56, Reward: 175.8534, Test: 279.1522 [152.54], Avg: -48.3453 (0.316)
Ep: 57, Reward: 264.0910, Test: 261.4877 [115.40], Avg: -44.9929 (0.310)
Ep: 58, Reward: 248.5715, Test: 327.5438 [177.75], Avg: -41.6915 (0.304)
Ep: 59, Reward: 215.8449, Test: 222.3834 [140.97], Avg: -39.6397 (0.298)
Ep: 60, Reward: 295.3830, Test: 229.9490 [112.71], Avg: -37.0679 (0.292)
Ep: 61, Reward: 221.2999, Test: 272.7089 [195.92], Avg: -35.2316 (0.286)
Ep: 62, Reward: 215.6938, Test: 196.7003 [176.29], Avg: -34.3484 (0.280)
Ep: 63, Reward: 282.5714, Test: 297.7174 [136.92], Avg: -31.2993 (0.274)
Ep: 64, Reward: 278.2628, Test: 410.5066 [204.67], Avg: -27.6510 (0.269)
Ep: 65, Reward: 246.5115, Test: 196.5935 [148.85], Avg: -26.5088 (0.264)
Ep: 66, Reward: 345.0182, Test: 441.0995 [217.10], Avg: -22.7698 (0.258)
Ep: 67, Reward: 325.8437, Test: 196.8149 [128.39], Avg: -21.4287 (0.253)
Ep: 68, Reward: 299.9090, Test: 318.8733 [161.00], Avg: -18.8300 (0.248)
Ep: 69, Reward: 276.6300, Test: 278.7816 [175.26], Avg: -17.0821 (0.243)
Ep: 70, Reward: 320.4219, Test: 319.9538 [220.51], Avg: -15.4409 (0.238)
Ep: 71, Reward: 377.7662, Test: 384.3962 [247.80], Avg: -13.3293 (0.233)
Ep: 72, Reward: 410.2160, Test: 456.8814 [215.29], Avg: -9.8372 (0.229)
Ep: 73, Reward: 296.0373, Test: 472.4585 [176.47], Avg: -5.7045 (0.224)
Ep: 74, Reward: 392.3109, Test: 402.7539 [283.87], Avg: -4.0432 (0.220)
Ep: 75, Reward: 449.9072, Test: 406.6603 [209.65], Avg: -1.3977 (0.215)
Ep: 76, Reward: 372.2844, Test: 480.3451 [201.50], Avg: 2.2418 (0.211)
Ep: 77, Reward: 363.7201, Test: 488.5121 [248.72], Avg: 5.2873 (0.207)
Ep: 78, Reward: 406.4534, Test: 286.3671 [244.02], Avg: 5.7564 (0.203)
Ep: 79, Reward: 474.6179, Test: 465.5065 [248.22], Avg: 8.4005 (0.199)
Ep: 80, Reward: 399.7344, Test: 340.4880 [137.75], Avg: 10.7998 (0.195)
Ep: 81, Reward: 421.8489, Test: 313.3230 [249.28], Avg: 11.4491 (0.191)
Ep: 82, Reward: 388.8526, Test: 423.2006 [228.45], Avg: 13.6576 (0.187)
Ep: 83, Reward: 362.4248, Test: 387.8622 [223.61], Avg: 15.4504 (0.183)
Ep: 84, Reward: 352.5359, Test: 563.9494 [241.74], Avg: 19.0593 (0.180)
Ep: 85, Reward: 460.6587, Test: 358.4145 [280.16], Avg: 19.7477 (0.176)
Ep: 86, Reward: 498.2233, Test: 430.4998 [236.05], Avg: 21.7557 (0.172)
Ep: 87, Reward: 476.7377, Test: 469.0221 [186.60], Avg: 24.7178 (0.169)
Ep: 88, Reward: 498.3275, Test: 492.4958 [259.68], Avg: 27.0560 (0.166)
Ep: 89, Reward: 555.0405, Test: 671.3038 [147.99], Avg: 32.5699 (0.162)
Ep: 90, Reward: 684.5463, Test: 566.2146 [207.98], Avg: 36.1486 (0.159)
Ep: 91, Reward: 509.7920, Test: 649.3641 [209.20], Avg: 40.5401 (0.156)
Ep: 92, Reward: 591.9313, Test: 613.8825 [226.46], Avg: 44.2700 (0.153)
Ep: 93, Reward: 554.3649, Test: 634.9444 [233.09], Avg: 48.0741 (0.150)
Ep: 94, Reward: 616.3841, Test: 556.5990 [221.59], Avg: 51.0945 (0.147)
Ep: 95, Reward: 537.2351, Test: 558.3674 [254.10], Avg: 53.7317 (0.144)
Ep: 96, Reward: 543.4899, Test: 551.4929 [231.23], Avg: 56.4794 (0.141)
Ep: 97, Reward: 559.8857, Test: 375.5974 [222.29], Avg: 57.4675 (0.138)
Ep: 98, Reward: 528.9997, Test: 477.4738 [264.85], Avg: 59.0348 (0.135)
Ep: 99, Reward: 487.1409, Test: 538.5722 [188.34], Avg: 61.9467 (0.133)
Ep: 100, Reward: 461.9470, Test: 522.1790 [160.76], Avg: 64.9117 (0.130)
Ep: 101, Reward: 434.6446, Test: 518.3177 [351.57], Avg: 65.9101 (0.127)
Ep: 102, Reward: 503.9907, Test: 534.6006 [186.66], Avg: 68.6482 (0.125)
Ep: 103, Reward: 528.5949, Test: 561.9925 [246.63], Avg: 71.0204 (0.122)
Ep: 104, Reward: 417.2720, Test: 570.1416 [214.00], Avg: 73.7359 (0.120)
Ep: 105, Reward: 560.8173, Test: 537.8187 [209.70], Avg: 76.1358 (0.117)
Ep: 106, Reward: 668.6980, Test: 496.2825 [187.57], Avg: 78.3094 (0.115)
Ep: 107, Reward: 546.3148, Test: 445.4124 [314.31], Avg: 78.7983 (0.113)
Ep: 108, Reward: 585.6163, Test: 627.3633 [231.61], Avg: 81.7061 (0.111)
Ep: 109, Reward: 485.2057, Test: 624.7656 [134.09], Avg: 85.4239 (0.108)
Ep: 110, Reward: 578.9599, Test: 685.3996 [222.11], Avg: 88.8282 (0.106)
Ep: 111, Reward: 359.1533, Test: 540.0117 [229.86], Avg: 90.8043 (0.104)
Ep: 112, Reward: 619.8127, Test: 555.2887 [264.60], Avg: 92.5732 (0.102)
Ep: 113, Reward: 536.4632, Test: 587.5884 [228.50], Avg: 94.9110 (0.100)
Ep: 114, Reward: 588.9401, Test: 468.6004 [277.83], Avg: 95.7445 (0.098)
Ep: 115, Reward: 507.8024, Test: 572.7752 [197.89], Avg: 98.1510 (0.096)
Ep: 116, Reward: 520.0599, Test: 392.9801 [225.61], Avg: 98.7426 (0.094)
Ep: 117, Reward: 624.0066, Test: 445.1736 [210.87], Avg: 99.8914 (0.092)
Ep: 118, Reward: 646.5920, Test: 630.1905 [214.49], Avg: 102.5453 (0.090)
Ep: 119, Reward: 706.4918, Test: 528.9651 [219.74], Avg: 104.2676 (0.089)
Ep: 120, Reward: 612.2230, Test: 501.7665 [213.54], Avg: 105.7879 (0.087)
Ep: 121, Reward: 482.0854, Test: 596.4982 [248.66], Avg: 107.7719 (0.085)
Ep: 122, Reward: 576.8123, Test: 517.7110 [254.09], Avg: 109.0390 (0.083)
Ep: 123, Reward: 530.6576, Test: 559.2415 [260.58], Avg: 110.5682 (0.082)
Ep: 124, Reward: 544.9532, Test: 641.8012 [165.60], Avg: 113.4932 (0.080)
Ep: 125, Reward: 528.6846, Test: 525.5591 [191.63], Avg: 115.2427 (0.078)
Ep: 126, Reward: 501.1569, Test: 456.9811 [263.52], Avg: 115.8586 (0.077)
Ep: 127, Reward: 360.7487, Test: 381.5091 [250.34], Avg: 115.9782 (0.075)
Ep: 128, Reward: 377.8167, Test: 366.3824 [221.23], Avg: 116.2043 (0.074)
Ep: 129, Reward: 260.5323, Test: 414.6820 [179.37], Avg: 117.1205 (0.072)
Ep: 130, Reward: 338.1352, Test: 315.2510 [131.72], Avg: 117.6275 (0.071)
Ep: 131, Reward: 342.5578, Test: 261.0743 [196.14], Avg: 117.2283 (0.069)
Ep: 132, Reward: 322.1560, Test: 386.0759 [195.90], Avg: 117.7768 (0.068)
Ep: 133, Reward: 465.9046, Test: 443.8396 [185.78], Avg: 118.8237 (0.067)
Ep: 134, Reward: 398.5731, Test: 353.3534 [156.98], Avg: 119.3981 (0.065)
Ep: 135, Reward: 346.3280, Test: 392.8041 [170.24], Avg: 120.1567 (0.064)
Ep: 136, Reward: 349.5928, Test: 306.6392 [114.30], Avg: 120.6835 (0.063)
Ep: 137, Reward: 393.8586, Test: 373.5028 [192.75], Avg: 121.1188 (0.062)
Ep: 138, Reward: 346.9930, Test: 367.2215 [216.40], Avg: 121.3325 (0.060)
Ep: 139, Reward: 443.7431, Test: 423.9893 [173.46], Avg: 122.2554 (0.059)
Ep: 140, Reward: 473.4791, Test: 562.1027 [192.33], Avg: 124.0108 (0.058)
Ep: 141, Reward: 562.4170, Test: 647.7920 [170.87], Avg: 126.4960 (0.057)
Ep: 142, Reward: 587.6598, Test: 544.6619 [181.06], Avg: 128.1541 (0.056)
Ep: 143, Reward: 535.3316, Test: 594.5070 [187.60], Avg: 130.0899 (0.055)
Ep: 144, Reward: 541.7835, Test: 596.5861 [187.77], Avg: 132.0122 (0.053)
Ep: 145, Reward: 490.0019, Test: 528.1674 [191.91], Avg: 133.4111 (0.052)
Ep: 146, Reward: 545.4677, Test: 520.3007 [263.40], Avg: 134.2512 (0.051)
Ep: 147, Reward: 626.5189, Test: 561.5253 [218.61], Avg: 135.6611 (0.050)
Ep: 148, Reward: 518.7969, Test: 640.6514 [138.23], Avg: 138.1226 (0.049)
Ep: 149, Reward: 603.3745, Test: 540.4353 [113.82], Avg: 140.0459 (0.048)
Ep: 150, Reward: 605.8661, Test: 392.0757 [166.20], Avg: 140.6143 (0.047)
Ep: 151, Reward: 581.0478, Test: 365.3603 [190.29], Avg: 140.8410 (0.046)
Ep: 152, Reward: 660.0579, Test: 519.7940 [183.28], Avg: 142.1199 (0.045)
Ep: 153, Reward: 697.0519, Test: 586.8581 [167.71], Avg: 143.9188 (0.045)
Ep: 154, Reward: 559.4292, Test: 486.1983 [176.09], Avg: 144.9910 (0.044)
Ep: 155, Reward: 463.4702, Test: 343.9393 [132.09], Avg: 145.4195 (0.043)
Ep: 156, Reward: 354.3738, Test: 444.8343 [216.66], Avg: 145.9466 (0.042)
Ep: 157, Reward: 444.2004, Test: 456.1780 [210.71], Avg: 146.5765 (0.041)
Ep: 158, Reward: 479.1423, Test: 454.5987 [251.85], Avg: 146.9298 (0.040)
Ep: 159, Reward: 459.3781, Test: 568.1935 [209.06], Avg: 148.2561 (0.039)
Ep: 160, Reward: 451.0501, Test: 545.1974 [151.31], Avg: 149.7817 (0.039)
Ep: 161, Reward: 481.9814, Test: 466.5416 [75.76], Avg: 151.2694 (0.038)
Ep: 162, Reward: 444.9145, Test: 526.1806 [243.04], Avg: 152.0784 (0.037)
Ep: 163, Reward: 467.6758, Test: 323.3448 [194.92], Avg: 151.9342 (0.036)
Ep: 164, Reward: 354.7722, Test: 376.2699 [212.86], Avg: 152.0037 (0.036)
Ep: 165, Reward: 402.3396, Test: 524.1987 [184.44], Avg: 153.1347 (0.035)
Ep: 166, Reward: 486.8469, Test: 458.3679 [181.62], Avg: 153.8749 (0.034)
Ep: 167, Reward: 512.1586, Test: 404.6768 [167.04], Avg: 154.3735 (0.034)
Ep: 168, Reward: 532.3902, Test: 441.9214 [261.55], Avg: 154.5273 (0.033)
Ep: 169, Reward: 341.6436, Test: 585.9239 [192.44], Avg: 155.9330 (0.032)
Ep: 170, Reward: 501.9935, Test: 487.8852 [215.33], Avg: 156.6150 (0.032)
Ep: 171, Reward: 507.5105, Test: 322.1584 [199.53], Avg: 156.4174 (0.031)
Ep: 172, Reward: 363.4066, Test: 489.4906 [195.36], Avg: 157.2134 (0.030)
Ep: 173, Reward: 353.8462, Test: 376.8161 [221.60], Avg: 157.2019 (0.030)
Ep: 174, Reward: 345.6907, Test: 447.7926 [211.72], Avg: 157.6526 (0.029)
Ep: 175, Reward: 380.5735, Test: 489.2691 [199.11], Avg: 158.4055 (0.029)
Ep: 176, Reward: 416.5523, Test: 328.7388 [139.22], Avg: 158.5813 (0.028)
Ep: 177, Reward: 310.5042, Test: 358.1071 [166.72], Avg: 158.7656 (0.027)
Ep: 178, Reward: 323.0336, Test: 274.4218 [125.30], Avg: 158.7117 (0.027)
Ep: 179, Reward: 320.5682, Test: 335.0258 [181.58], Avg: 158.6825 (0.026)
Ep: 180, Reward: 390.4668, Test: 256.8650 [143.37], Avg: 158.4328 (0.026)
Ep: 181, Reward: 343.9157, Test: 335.4775 [120.90], Avg: 158.7413 (0.025)
Ep: 182, Reward: 381.7761, Test: 275.6266 [155.77], Avg: 158.5288 (0.025)
Ep: 183, Reward: 227.7223, Test: 245.7504 [131.78], Avg: 158.2866 (0.024)
Ep: 184, Reward: 319.7781, Test: 314.1422 [185.43], Avg: 158.1268 (0.024)
Ep: 185, Reward: 286.8811, Test: 367.2248 [203.70], Avg: 158.1558 (0.023)
Ep: 186, Reward: 216.1258, Test: 191.4671 [196.56], Avg: 157.2828 (0.023)
Ep: 187, Reward: 293.4015, Test: 264.1216 [167.42], Avg: 156.9606 (0.022)
Ep: 188, Reward: 287.2141, Test: 358.5079 [262.55], Avg: 156.6378 (0.022)
Ep: 189, Reward: 306.6483, Test: 319.3927 [257.50], Avg: 156.1391 (0.022)
Ep: 190, Reward: 323.5505, Test: 273.3054 [148.31], Avg: 155.9761 (0.021)
Ep: 191, Reward: 340.4712, Test: 258.3307 [83.91], Avg: 156.0721 (0.021)
Ep: 192, Reward: 317.2246, Test: 270.3985 [180.33], Avg: 155.7301 (0.020)
Ep: 193, Reward: 324.6760, Test: 286.5298 [191.59], Avg: 155.4168 (0.020)
Ep: 194, Reward: 279.1245, Test: 238.3318 [220.51], Avg: 154.7111 (0.020)
Ep: 195, Reward: 299.3829, Test: 249.7560 [149.13], Avg: 154.4352 (0.020)
Ep: 196, Reward: 270.2247, Test: 304.6676 [233.60], Avg: 154.0120 (0.020)
Ep: 197, Reward: 295.6335, Test: 184.1140 [137.21], Avg: 153.4711 (0.020)
Ep: 198, Reward: 237.7867, Test: 269.6987 [193.70], Avg: 153.0818 (0.020)
Ep: 199, Reward: 275.5857, Test: 295.4183 [177.06], Avg: 152.9081 (0.020)
Ep: 200, Reward: 221.4153, Test: 173.3417 [151.51], Avg: 152.2560 (0.020)
Ep: 201, Reward: 268.7057, Test: 237.4227 [139.96], Avg: 151.9848 (0.020)
Ep: 202, Reward: 238.2619, Test: 281.3454 [82.46], Avg: 152.2158 (0.020)
Ep: 203, Reward: 259.3538, Test: 315.5777 [206.29], Avg: 152.0054 (0.020)
Ep: 204, Reward: 230.6222, Test: 297.2207 [104.69], Avg: 152.2030 (0.020)
Ep: 205, Reward: 223.8054, Test: 201.8810 [128.36], Avg: 151.8211 (0.020)
Ep: 206, Reward: 218.8943, Test: 159.3528 [103.72], Avg: 151.3564 (0.020)
Ep: 207, Reward: 258.7068, Test: 271.3882 [123.48], Avg: 151.3398 (0.020)
Ep: 208, Reward: 231.3258, Test: 355.7427 [118.12], Avg: 151.7527 (0.020)
Ep: 209, Reward: 199.9167, Test: 231.9492 [197.67], Avg: 151.1933 (0.020)
Ep: 210, Reward: 155.6696, Test: 186.1474 [142.70], Avg: 150.6826 (0.020)
Ep: 211, Reward: 204.4046, Test: 229.4106 [129.78], Avg: 150.4418 (0.020)
Ep: 212, Reward: 231.2117, Test: 282.2469 [134.52], Avg: 150.4291 (0.020)
Ep: 213, Reward: 233.1981, Test: 255.7846 [145.87], Avg: 150.2398 (0.020)
Ep: 214, Reward: 325.7624, Test: 302.2551 [147.71], Avg: 150.2598 (0.020)
Ep: 215, Reward: 385.3429, Test: 249.8397 [147.91], Avg: 150.0360 (0.020)
Ep: 216, Reward: 289.3744, Test: 296.0738 [149.57], Avg: 150.0198 (0.020)
Ep: 217, Reward: 259.0237, Test: 388.6022 [168.98], Avg: 150.3390 (0.020)
Ep: 218, Reward: 242.5256, Test: 318.7787 [122.09], Avg: 150.5507 (0.020)
Ep: 219, Reward: 288.0676, Test: 291.9903 [237.61], Avg: 150.1135 (0.020)
Ep: 220, Reward: 273.9476, Test: 367.9863 [159.64], Avg: 150.3770 (0.020)
Ep: 221, Reward: 253.5572, Test: 207.5046 [119.03], Avg: 150.0982 (0.020)
Ep: 222, Reward: 238.5096, Test: 176.3275 [63.11], Avg: 149.9328 (0.020)
Ep: 223, Reward: 195.4668, Test: 403.8950 [213.89], Avg: 150.1117 (0.020)
Ep: 224, Reward: 225.5645, Test: 195.6954 [138.39], Avg: 149.6992 (0.020)
Ep: 225, Reward: 300.9844, Test: 308.1331 [146.78], Avg: 149.7508 (0.020)
Ep: 226, Reward: 212.6510, Test: 267.1151 [133.92], Avg: 149.6778 (0.020)
Ep: 227, Reward: 234.2149, Test: 137.3515 [103.60], Avg: 149.1694 (0.020)
Ep: 228, Reward: 269.4815, Test: 278.4019 [115.41], Avg: 149.2297 (0.020)
Ep: 229, Reward: 287.2046, Test: 389.3767 [201.86], Avg: 149.3962 (0.020)
Ep: 230, Reward: 360.0139, Test: 285.7306 [217.05], Avg: 149.0468 (0.020)
Ep: 231, Reward: 410.8889, Test: 388.8033 [244.64], Avg: 149.0258 (0.020)
Ep: 232, Reward: 386.9946, Test: 353.0587 [160.33], Avg: 149.2133 (0.020)
Ep: 233, Reward: 373.0832, Test: 433.5370 [232.11], Avg: 149.4364 (0.020)
Ep: 234, Reward: 279.5475, Test: 330.9050 [218.77], Avg: 149.2777 (0.020)
Ep: 235, Reward: 272.9904, Test: 337.5506 [214.73], Avg: 149.1656 (0.020)
Ep: 236, Reward: 362.2992, Test: 300.9441 [276.94], Avg: 148.6375 (0.020)
Ep: 237, Reward: 302.9614, Test: 472.1162 [200.35], Avg: 149.1548 (0.020)
Ep: 238, Reward: 415.6468, Test: 229.3889 [134.71], Avg: 148.9269 (0.020)
Ep: 239, Reward: 266.8183, Test: 272.9400 [203.60], Avg: 148.5953 (0.020)
Ep: 240, Reward: 279.1137, Test: 369.4592 [248.59], Avg: 148.4802 (0.020)
Ep: 241, Reward: 317.5418, Test: 487.7380 [217.88], Avg: 148.9818 (0.020)
Ep: 242, Reward: 378.9084, Test: 400.8239 [311.16], Avg: 148.7377 (0.020)
Ep: 243, Reward: 371.7097, Test: 287.4358 [248.06], Avg: 148.2895 (0.020)
Ep: 244, Reward: 428.2193, Test: 563.5953 [190.77], Avg: 149.2059 (0.020)
Ep: 245, Reward: 391.3766, Test: 419.0108 [252.49], Avg: 149.2763 (0.020)
Ep: 246, Reward: 433.3537, Test: 470.6646 [308.58], Avg: 149.3282 (0.020)
Ep: 247, Reward: 613.1683, Test: 533.3642 [311.11], Avg: 149.6222 (0.020)
Ep: 248, Reward: 686.8069, Test: 626.3109 [315.17], Avg: 150.2709 (0.020)
Ep: 249, Reward: 719.3915, Test: 646.6645 [303.25], Avg: 151.0435 (0.020)
Ep: 250, Reward: 353.5309, Test: 484.0792 [247.74], Avg: 151.3833 (0.020)
Ep: 251, Reward: 330.8332, Test: 431.2805 [183.55], Avg: 151.7657 (0.020)
Ep: 252, Reward: 369.2501, Test: 497.0080 [273.44], Avg: 152.0495 (0.020)
Ep: 253, Reward: 467.5016, Test: 337.3583 [264.55], Avg: 151.7375 (0.020)
Ep: 254, Reward: 516.2196, Test: 497.2693 [185.07], Avg: 152.3668 (0.020)
Ep: 255, Reward: 503.2812, Test: 472.5922 [227.87], Avg: 152.7275 (0.020)
Ep: 256, Reward: 502.0589, Test: 514.5724 [229.48], Avg: 153.2425 (0.020)
Ep: 257, Reward: 522.2213, Test: 549.1399 [211.17], Avg: 153.9585 (0.020)
Ep: 258, Reward: 487.3413, Test: 624.8918 [325.52], Avg: 154.5200 (0.020)
Ep: 259, Reward: 634.8748, Test: 586.9230 [129.80], Avg: 155.6838 (0.020)
Ep: 260, Reward: 677.9025, Test: 688.5948 [217.23], Avg: 156.8933 (0.020)
Ep: 261, Reward: 763.9727, Test: 658.1572 [237.06], Avg: 157.9017 (0.020)
Ep: 262, Reward: 530.1580, Test: 680.1576 [266.63], Avg: 158.8737 (0.020)
Ep: 263, Reward: 652.4457, Test: 752.9023 [131.84], Avg: 160.6244 (0.020)
Ep: 264, Reward: 812.6331, Test: 757.6552 [155.87], Avg: 162.2892 (0.020)
Ep: 265, Reward: 697.7578, Test: 609.7164 [313.77], Avg: 162.7917 (0.020)
Ep: 266, Reward: 784.5275, Test: 647.7905 [203.09], Avg: 163.8475 (0.020)
Ep: 267, Reward: 702.3564, Test: 729.0692 [177.60], Avg: 165.2938 (0.020)
Ep: 268, Reward: 680.4655, Test: 721.3066 [191.30], Avg: 166.6496 (0.020)
Ep: 269, Reward: 762.2382, Test: 763.2681 [187.24], Avg: 168.1659 (0.020)
Ep: 270, Reward: 691.8960, Test: 734.9941 [178.05], Avg: 169.6005 (0.020)
Ep: 271, Reward: 669.5143, Test: 800.7930 [117.91], Avg: 171.4875 (0.020)
Ep: 272, Reward: 771.2880, Test: 697.1564 [205.13], Avg: 172.6617 (0.020)
Ep: 273, Reward: 728.4938, Test: 624.2243 [288.98], Avg: 173.2551 (0.020)
Ep: 274, Reward: 748.9156, Test: 370.4159 [265.25], Avg: 173.0074 (0.020)
Ep: 275, Reward: 480.6502, Test: 501.0106 [285.33], Avg: 173.1621 (0.020)
Ep: 276, Reward: 369.7352, Test: 552.3235 [263.03], Avg: 173.5813 (0.020)
Ep: 277, Reward: 403.9965, Test: 468.6680 [183.76], Avg: 173.9818 (0.020)
Ep: 278, Reward: 555.9099, Test: 733.0949 [153.37], Avg: 175.4360 (0.020)
Ep: 279, Reward: 665.5091, Test: 576.2300 [211.72], Avg: 176.1113 (0.020)
Ep: 280, Reward: 576.4075, Test: 766.9826 [90.43], Avg: 177.8922 (0.020)
Ep: 281, Reward: 710.3671, Test: 694.1696 [172.87], Avg: 179.1100 (0.020)
Ep: 282, Reward: 590.5850, Test: 445.3104 [247.60], Avg: 179.1757 (0.020)
Ep: 283, Reward: 535.3802, Test: 611.4534 [191.17], Avg: 180.0246 (0.020)
Ep: 284, Reward: 685.2764, Test: 517.3563 [145.78], Avg: 180.6968 (0.020)
Ep: 285, Reward: 546.7366, Test: 658.2031 [122.20], Avg: 181.9391 (0.020)
Ep: 286, Reward: 554.1705, Test: 454.4276 [158.03], Avg: 182.3379 (0.020)
Ep: 287, Reward: 697.4759, Test: 647.7971 [153.74], Avg: 183.4202 (0.020)
Ep: 288, Reward: 715.0086, Test: 785.3305 [103.53], Avg: 185.1447 (0.020)
Ep: 289, Reward: 722.5597, Test: 710.0327 [165.73], Avg: 186.3832 (0.020)
Ep: 290, Reward: 580.8333, Test: 719.0783 [228.96], Avg: 187.4270 (0.020)
Ep: 291, Reward: 704.1725, Test: 723.5716 [129.23], Avg: 188.8205 (0.020)
Ep: 292, Reward: 716.7234, Test: 666.1323 [184.95], Avg: 189.8183 (0.020)
Ep: 293, Reward: 601.9284, Test: 771.0648 [139.31], Avg: 191.3215 (0.020)
Ep: 294, Reward: 541.0639, Test: 632.8612 [197.95], Avg: 192.1473 (0.020)
Ep: 295, Reward: 629.6073, Test: 673.1614 [155.28], Avg: 193.2477 (0.020)
Ep: 296, Reward: 643.5675, Test: 552.7802 [187.44], Avg: 193.8271 (0.020)
Ep: 297, Reward: 652.1485, Test: 624.8495 [231.34], Avg: 194.4972 (0.020)
Ep: 298, Reward: 722.1033, Test: 731.8697 [230.15], Avg: 195.5247 (0.020)
Ep: 299, Reward: 726.3150, Test: 797.9973 [202.79], Avg: 196.8570 (0.020)
Ep: 300, Reward: 786.9999, Test: 695.0369 [147.34], Avg: 198.0226 (0.020)
Ep: 301, Reward: 671.7348, Test: 636.7156 [281.97], Avg: 198.5415 (0.020)
Ep: 302, Reward: 622.6934, Test: 522.1158 [262.83], Avg: 198.7420 (0.020)
Ep: 303, Reward: 609.3936, Test: 572.8353 [245.37], Avg: 199.1655 (0.020)
Ep: 304, Reward: 544.7402, Test: 734.3385 [180.19], Avg: 200.3293 (0.020)
Ep: 305, Reward: 590.8333, Test: 508.4663 [203.05], Avg: 200.6727 (0.020)
Ep: 306, Reward: 564.9393, Test: 493.3752 [258.96], Avg: 200.7827 (0.020)
Ep: 307, Reward: 597.2052, Test: 389.1481 [189.74], Avg: 200.7782 (0.020)
Ep: 308, Reward: 617.7132, Test: 657.2558 [173.63], Avg: 201.6935 (0.020)
Ep: 309, Reward: 597.0686, Test: 614.5259 [217.40], Avg: 202.3240 (0.020)
Ep: 310, Reward: 592.8184, Test: 630.3648 [194.29], Avg: 203.0756 (0.020)
Ep: 311, Reward: 507.2648, Test: 483.3962 [112.13], Avg: 203.6147 (0.020)
Ep: 312, Reward: 689.3736, Test: 603.2426 [255.01], Avg: 204.0767 (0.020)
Ep: 313, Reward: 633.4971, Test: 515.9027 [237.91], Avg: 204.3121 (0.020)
Ep: 314, Reward: 668.1060, Test: 592.9539 [234.72], Avg: 204.8008 (0.020)
Ep: 315, Reward: 574.7520, Test: 653.6494 [235.68], Avg: 205.4753 (0.020)
Ep: 316, Reward: 587.2279, Test: 420.4862 [136.13], Avg: 205.7242 (0.020)
Ep: 317, Reward: 514.1239, Test: 587.0688 [189.80], Avg: 206.3265 (0.020)
Ep: 318, Reward: 626.7637, Test: 616.9454 [187.13], Avg: 207.0271 (0.020)
Ep: 319, Reward: 602.6761, Test: 726.4836 [195.58], Avg: 208.0392 (0.020)
Ep: 320, Reward: 743.8470, Test: 690.2193 [222.25], Avg: 208.8490 (0.020)
Ep: 321, Reward: 629.6566, Test: 680.0017 [185.70], Avg: 209.7355 (0.020)
Ep: 322, Reward: 659.1895, Test: 615.7477 [222.07], Avg: 210.3050 (0.020)
Ep: 323, Reward: 750.6094, Test: 696.7600 [222.10], Avg: 211.1209 (0.020)
Ep: 324, Reward: 599.9198, Test: 798.3729 [165.73], Avg: 212.4179 (0.020)
Ep: 325, Reward: 609.2169, Test: 709.7715 [217.88], Avg: 213.2751 (0.020)
Ep: 326, Reward: 524.7027, Test: 596.5899 [238.91], Avg: 213.7167 (0.020)
Ep: 327, Reward: 694.5502, Test: 606.6477 [245.21], Avg: 214.1671 (0.020)
Ep: 328, Reward: 685.3605, Test: 697.8979 [193.31], Avg: 215.0499 (0.020)
Ep: 329, Reward: 609.2843, Test: 486.3006 [198.62], Avg: 215.2700 (0.020)
Ep: 330, Reward: 569.6251, Test: 526.3235 [230.34], Avg: 215.5138 (0.020)
Ep: 331, Reward: 522.5894, Test: 554.6512 [147.88], Avg: 216.0899 (0.020)
Ep: 332, Reward: 491.9667, Test: 623.1160 [191.72], Avg: 216.7365 (0.020)
Ep: 333, Reward: 429.2033, Test: 576.6882 [286.42], Avg: 216.9566 (0.020)
Ep: 334, Reward: 621.0804, Test: 563.6365 [276.63], Avg: 217.1657 (0.020)
Ep: 335, Reward: 528.3960, Test: 735.5602 [138.47], Avg: 218.2965 (0.020)
Ep: 336, Reward: 633.8776, Test: 569.8603 [258.45], Avg: 218.5728 (0.020)
Ep: 337, Reward: 665.5951, Test: 646.2171 [223.47], Avg: 219.1768 (0.020)
Ep: 338, Reward: 521.8773, Test: 706.0553 [236.55], Avg: 219.9153 (0.020)
Ep: 339, Reward: 614.7834, Test: 555.9162 [242.46], Avg: 220.1904 (0.020)
Ep: 340, Reward: 646.2215, Test: 599.1596 [233.07], Avg: 220.6182 (0.020)
Ep: 341, Reward: 547.6659, Test: 653.7991 [212.55], Avg: 221.2633 (0.020)
Ep: 342, Reward: 603.3116, Test: 555.3017 [301.61], Avg: 221.3579 (0.020)
Ep: 343, Reward: 626.7921, Test: 599.9502 [181.15], Avg: 221.9318 (0.020)
Ep: 344, Reward: 674.5271, Test: 752.1264 [166.55], Avg: 222.9859 (0.020)
Ep: 345, Reward: 715.2931, Test: 637.9384 [225.74], Avg: 223.5327 (0.020)
Ep: 346, Reward: 685.7706, Test: 722.7483 [155.92], Avg: 224.5220 (0.020)
Ep: 347, Reward: 648.1791, Test: 672.8972 [195.86], Avg: 225.2477 (0.020)
Ep: 348, Reward: 706.5579, Test: 653.9597 [278.73], Avg: 225.6774 (0.020)
Ep: 349, Reward: 666.1522, Test: 564.8298 [205.86], Avg: 226.0583 (0.020)
Ep: 350, Reward: 599.9209, Test: 643.9462 [242.55], Avg: 226.5578 (0.020)
Ep: 351, Reward: 607.7946, Test: 574.2021 [202.65], Avg: 226.9697 (0.020)
Ep: 352, Reward: 689.5357, Test: 648.7954 [253.16], Avg: 227.4475 (0.020)
Ep: 353, Reward: 726.5850, Test: 795.9152 [84.15], Avg: 228.8156 (0.020)
Ep: 354, Reward: 767.9279, Test: 754.8130 [109.40], Avg: 229.9892 (0.020)
Ep: 355, Reward: 635.0566, Test: 459.5342 [296.09], Avg: 229.8022 (0.020)
Ep: 356, Reward: 530.5799, Test: 478.0321 [251.62], Avg: 229.7927 (0.020)
Ep: 357, Reward: 688.3372, Test: 588.8129 [226.20], Avg: 230.1638 (0.020)
Ep: 358, Reward: 600.1175, Test: 440.7410 [199.48], Avg: 230.1947 (0.020)
Ep: 359, Reward: 545.3251, Test: 667.8510 [174.12], Avg: 230.9267 (0.020)
Ep: 360, Reward: 445.3897, Test: 614.9016 [200.54], Avg: 231.4348 (0.020)
Ep: 361, Reward: 658.3799, Test: 733.0003 [184.21], Avg: 232.3115 (0.020)
Ep: 362, Reward: 511.9816, Test: 675.2936 [234.43], Avg: 232.8860 (0.020)
Ep: 363, Reward: 578.0640, Test: 590.4086 [191.01], Avg: 233.3435 (0.020)
Ep: 364, Reward: 538.5724, Test: 484.1451 [198.94], Avg: 233.4856 (0.020)
Ep: 365, Reward: 618.0756, Test: 707.5345 [168.98], Avg: 234.3191 (0.020)
Ep: 366, Reward: 494.9323, Test: 444.5515 [210.29], Avg: 234.3189 (0.020)
Ep: 367, Reward: 462.5207, Test: 537.4484 [206.13], Avg: 234.5825 (0.020)
Ep: 368, Reward: 455.3697, Test: 586.4490 [235.36], Avg: 234.8983 (0.020)
Ep: 369, Reward: 481.8370, Test: 541.5797 [216.00], Avg: 235.1434 (0.020)
Ep: 370, Reward: 497.3010, Test: 588.5921 [254.62], Avg: 235.4097 (0.020)
Ep: 371, Reward: 495.3175, Test: 396.1834 [160.07], Avg: 235.4117 (0.020)
Ep: 372, Reward: 413.6094, Test: 386.1547 [190.76], Avg: 235.3044 (0.020)
Ep: 373, Reward: 379.9719, Test: 410.2332 [233.82], Avg: 235.1469 (0.020)
Ep: 374, Reward: 446.1836, Test: 333.5558 [165.14], Avg: 234.9689 (0.020)
Ep: 375, Reward: 440.7983, Test: 641.8033 [267.91], Avg: 235.3384 (0.020)
Ep: 376, Reward: 510.5971, Test: 699.8395 [239.31], Avg: 235.9357 (0.020)
Ep: 377, Reward: 586.5631, Test: 685.4766 [202.56], Avg: 236.5891 (0.020)
Ep: 378, Reward: 650.2242, Test: 606.3254 [166.63], Avg: 237.1250 (0.020)
Ep: 379, Reward: 635.7978, Test: 647.9679 [266.72], Avg: 237.5043 (0.020)
Ep: 380, Reward: 627.3187, Test: 771.4189 [183.05], Avg: 238.4252 (0.020)
Ep: 381, Reward: 646.1764, Test: 709.5643 [221.16], Avg: 239.0796 (0.020)
Ep: 382, Reward: 802.2902, Test: 618.1655 [242.92], Avg: 239.4351 (0.020)
Ep: 383, Reward: 743.1899, Test: 507.2235 [286.26], Avg: 239.3870 (0.020)
Ep: 384, Reward: 657.6262, Test: 703.6864 [261.53], Avg: 239.9137 (0.020)
Ep: 385, Reward: 635.6069, Test: 656.0039 [252.38], Avg: 240.3378 (0.020)
Ep: 386, Reward: 619.1811, Test: 658.8137 [274.42], Avg: 240.7100 (0.020)
Ep: 387, Reward: 718.2207, Test: 617.6237 [325.95], Avg: 240.8414 (0.020)
Ep: 388, Reward: 765.4697, Test: 865.5838 [24.38], Avg: 242.3847 (0.020)
Ep: 389, Reward: 764.7342, Test: 621.4431 [313.43], Avg: 242.5530 (0.020)
Ep: 390, Reward: 840.7111, Test: 736.4216 [248.30], Avg: 243.1811 (0.020)
Ep: 391, Reward: 831.0206, Test: 743.4857 [233.42], Avg: 243.8619 (0.020)
Ep: 392, Reward: 707.1944, Test: 665.2444 [279.81], Avg: 244.2221 (0.020)
Ep: 393, Reward: 742.3687, Test: 624.7456 [334.65], Avg: 244.3385 (0.020)
Ep: 394, Reward: 677.0124, Test: 811.0597 [104.50], Avg: 245.5087 (0.020)
Ep: 395, Reward: 573.7632, Test: 621.7504 [290.52], Avg: 245.7252 (0.020)
Ep: 396, Reward: 774.0122, Test: 845.7851 [117.58], Avg: 246.9405 (0.020)
Ep: 397, Reward: 764.4148, Test: 632.6947 [244.81], Avg: 247.2946 (0.020)
Ep: 398, Reward: 720.8186, Test: 517.8249 [264.13], Avg: 247.3107 (0.020)
Ep: 399, Reward: 688.1238, Test: 677.6955 [205.88], Avg: 247.8719 (0.020)
Ep: 400, Reward: 565.1422, Test: 680.0158 [249.19], Avg: 248.3282 (0.020)
Ep: 401, Reward: 714.9936, Test: 497.7165 [332.81], Avg: 248.1207 (0.020)
Ep: 402, Reward: 611.4752, Test: 452.0168 [276.15], Avg: 247.9414 (0.020)
Ep: 403, Reward: 607.0747, Test: 558.6323 [270.51], Avg: 248.0408 (0.020)
Ep: 404, Reward: 619.5710, Test: 763.7713 [159.56], Avg: 248.9203 (0.020)
Ep: 405, Reward: 628.3941, Test: 632.8940 [260.43], Avg: 249.2246 (0.020)
Ep: 406, Reward: 570.8593, Test: 631.4371 [243.38], Avg: 249.5657 (0.020)
Ep: 407, Reward: 616.7867, Test: 578.4481 [271.74], Avg: 249.7057 (0.020)
Ep: 408, Reward: 670.0997, Test: 542.1071 [200.55], Avg: 249.9303 (0.020)
Ep: 409, Reward: 567.2530, Test: 619.8783 [251.32], Avg: 250.2196 (0.020)
Ep: 410, Reward: 531.6817, Test: 520.0562 [165.68], Avg: 250.4731 (0.020)
Ep: 411, Reward: 557.1868, Test: 655.6595 [239.19], Avg: 250.8760 (0.020)
Ep: 412, Reward: 544.1088, Test: 548.7701 [258.28], Avg: 250.9719 (0.020)
Ep: 413, Reward: 680.9739, Test: 513.1887 [301.72], Avg: 250.8765 (0.020)
Ep: 414, Reward: 546.7719, Test: 540.4057 [189.43], Avg: 251.1177 (0.020)
Ep: 415, Reward: 613.7278, Test: 545.9909 [227.70], Avg: 251.2792 (0.020)
Ep: 416, Reward: 547.3949, Test: 451.1342 [306.04], Avg: 251.0245 (0.020)
Ep: 417, Reward: 779.4807, Test: 615.9966 [245.63], Avg: 251.3100 (0.020)
Ep: 418, Reward: 690.1083, Test: 361.1374 [170.67], Avg: 251.1648 (0.020)
Ep: 419, Reward: 579.9065, Test: 473.5984 [206.98], Avg: 251.2016 (0.020)
Ep: 420, Reward: 512.6581, Test: 586.7925 [248.80], Avg: 251.4077 (0.020)
Ep: 421, Reward: 503.4809, Test: 700.5147 [229.39], Avg: 251.9284 (0.020)
Ep: 422, Reward: 706.8106, Test: 532.2568 [295.62], Avg: 251.8923 (0.020)
Ep: 423, Reward: 469.9827, Test: 600.3702 [226.46], Avg: 252.1800 (0.020)
Ep: 424, Reward: 473.3027, Test: 635.0659 [230.41], Avg: 252.5388 (0.020)
Ep: 425, Reward: 536.2312, Test: 555.8818 [228.86], Avg: 252.7137 (0.020)
Ep: 426, Reward: 437.9140, Test: 515.0664 [200.44], Avg: 252.8587 (0.020)
Ep: 427, Reward: 537.0917, Test: 495.0106 [234.07], Avg: 252.8775 (0.020)
Ep: 428, Reward: 581.8507, Test: 647.8502 [178.48], Avg: 253.3822 (0.020)
Ep: 429, Reward: 651.2258, Test: 638.3430 [190.47], Avg: 253.8345 (0.020)
Ep: 430, Reward: 547.8433, Test: 602.1614 [239.86], Avg: 254.0862 (0.020)
Ep: 431, Reward: 689.8929, Test: 612.2401 [235.72], Avg: 254.3696 (0.020)
Ep: 432, Reward: 559.3805, Test: 594.0538 [265.87], Avg: 254.5400 (0.020)
Ep: 433, Reward: 493.2627, Test: 593.0386 [222.45], Avg: 254.8074 (0.020)
Ep: 434, Reward: 523.0316, Test: 599.8479 [246.52], Avg: 255.0339 (0.020)
Ep: 435, Reward: 673.3451, Test: 559.9715 [219.21], Avg: 255.2305 (0.020)
Ep: 436, Reward: 617.4267, Test: 739.4443 [170.03], Avg: 255.9495 (0.020)
Ep: 437, Reward: 651.2935, Test: 586.1748 [268.58], Avg: 256.0902 (0.020)
Ep: 438, Reward: 609.8721, Test: 658.6248 [310.07], Avg: 256.3009 (0.020)
Ep: 439, Reward: 681.6261, Test: 780.3799 [174.10], Avg: 257.0963 (0.020)
Ep: 440, Reward: 608.3418, Test: 602.0059 [220.88], Avg: 257.3775 (0.020)
Ep: 441, Reward: 567.4198, Test: 749.2886 [205.79], Avg: 258.0248 (0.020)
Ep: 442, Reward: 709.4780, Test: 796.3743 [115.97], Avg: 258.9783 (0.020)
Ep: 443, Reward: 710.7452, Test: 806.5098 [186.16], Avg: 259.7922 (0.020)
Ep: 444, Reward: 715.5806, Test: 760.9596 [224.21], Avg: 260.4146 (0.020)
Ep: 445, Reward: 785.2035, Test: 767.2495 [174.18], Avg: 261.1604 (0.020)
Ep: 446, Reward: 784.0791, Test: 762.6990 [203.55], Avg: 261.8271 (0.020)
Ep: 447, Reward: 802.3571, Test: 834.2022 [31.64], Avg: 263.0341 (0.020)
Ep: 448, Reward: 653.6214, Test: 539.5513 [210.53], Avg: 263.1811 (0.020)
Ep: 449, Reward: 554.0777, Test: 676.0285 [189.19], Avg: 263.6781 (0.020)
Ep: 450, Reward: 573.4332, Test: 708.1600 [233.23], Avg: 264.1465 (0.020)
Ep: 451, Reward: 641.8077, Test: 581.6530 [277.86], Avg: 264.2342 (0.020)
Ep: 452, Reward: 581.0451, Test: 711.8142 [145.06], Avg: 264.9020 (0.020)
Ep: 453, Reward: 601.2574, Test: 584.1189 [206.68], Avg: 265.1499 (0.020)
Ep: 454, Reward: 773.0545, Test: 650.1956 [257.52], Avg: 265.4302 (0.020)
Ep: 455, Reward: 701.4978, Test: 580.5366 [203.53], Avg: 265.6749 (0.020)
Ep: 456, Reward: 654.0728, Test: 629.8874 [175.35], Avg: 266.0881 (0.020)
Ep: 457, Reward: 645.4094, Test: 841.4807 [76.81], Avg: 267.1767 (0.020)
Ep: 458, Reward: 836.9565, Test: 815.9070 [122.43], Avg: 268.1055 (0.020)
Ep: 459, Reward: 786.3838, Test: 797.0522 [153.92], Avg: 268.9208 (0.020)
Ep: 460, Reward: 724.2089, Test: 637.0094 [179.34], Avg: 269.3302 (0.020)
Ep: 461, Reward: 645.3853, Test: 545.1208 [239.52], Avg: 269.4087 (0.020)
Ep: 462, Reward: 588.8450, Test: 612.2305 [273.50], Avg: 269.5584 (0.020)
Ep: 463, Reward: 631.3342, Test: 620.2526 [175.48], Avg: 269.9361 (0.020)
Ep: 464, Reward: 790.8151, Test: 648.5032 [177.28], Avg: 270.3689 (0.020)
Ep: 465, Reward: 622.5400, Test: 648.5436 [203.11], Avg: 270.7446 (0.020)
Ep: 466, Reward: 743.7972, Test: 640.9431 [288.47], Avg: 270.9196 (0.020)
Ep: 467, Reward: 753.0118, Test: 794.8363 [88.45], Avg: 271.8501 (0.020)
Ep: 468, Reward: 692.1821, Test: 813.6782 [108.26], Avg: 272.7746 (0.020)
Ep: 469, Reward: 780.9777, Test: 734.1540 [154.85], Avg: 273.4268 (0.020)
Ep: 470, Reward: 632.1743, Test: 712.8614 [178.39], Avg: 273.9810 (0.020)
Ep: 471, Reward: 761.9700, Test: 707.5514 [248.84], Avg: 274.3724 (0.020)
Ep: 472, Reward: 699.1689, Test: 515.3561 [238.21], Avg: 274.3782 (0.020)
Ep: 473, Reward: 630.9494, Test: 598.8164 [212.09], Avg: 274.6153 (0.020)
Ep: 474, Reward: 664.2815, Test: 590.0611 [183.57], Avg: 274.8929 (0.020)
Ep: 475, Reward: 542.7155, Test: 657.2774 [230.54], Avg: 275.2119 (0.020)
Ep: 476, Reward: 611.7432, Test: 592.8826 [227.18], Avg: 275.4016 (0.020)
Ep: 477, Reward: 713.4498, Test: 519.0183 [293.91], Avg: 275.2964 (0.020)
Ep: 478, Reward: 799.3137, Test: 731.7024 [177.19], Avg: 275.8793 (0.020)
Ep: 479, Reward: 829.0040, Test: 617.8904 [274.48], Avg: 276.0200 (0.020)
Ep: 480, Reward: 807.3759, Test: 735.2055 [196.56], Avg: 276.5660 (0.020)
Ep: 481, Reward: 682.7565, Test: 636.8354 [256.87], Avg: 276.7805 (0.020)
Ep: 482, Reward: 788.9247, Test: 803.4585 [135.40], Avg: 277.5906 (0.020)
Ep: 483, Reward: 699.5312, Test: 845.9326 [100.70], Avg: 278.5568 (0.020)
Ep: 484, Reward: 901.7148, Test: 803.1538 [244.09], Avg: 279.1352 (0.020)
Ep: 485, Reward: 797.0088, Test: 879.3818 [22.66], Avg: 280.3236 (0.020)
Ep: 486, Reward: 869.1451, Test: 874.2232 [47.39], Avg: 281.4458 (0.020)
Ep: 487, Reward: 776.1387, Test: 849.7746 [54.57], Avg: 282.4986 (0.020)
Ep: 488, Reward: 765.7955, Test: 833.5188 [60.41], Avg: 283.5019 (0.020)
Ep: 489, Reward: 837.5441, Test: 786.3472 [175.01], Avg: 284.1709 (0.020)
Ep: 490, Reward: 732.5247, Test: 740.0841 [249.93], Avg: 284.5905 (0.020)
Ep: 491, Reward: 828.1145, Test: 778.7342 [165.79], Avg: 285.2578 (0.020)
Ep: 492, Reward: 841.7934, Test: 745.7187 [193.79], Avg: 285.7988 (0.020)
Ep: 493, Reward: 725.3604, Test: 792.3220 [160.12], Avg: 286.5000 (0.020)
Ep: 494, Reward: 814.3712, Test: 828.4507 [26.46], Avg: 287.5414 (0.020)
Ep: 495, Reward: 817.9016, Test: 702.1321 [264.29], Avg: 287.8444 (0.020)
Ep: 496, Reward: 678.2557, Test: 668.4993 [285.82], Avg: 288.0352 (0.020)
Ep: 497, Reward: 749.1228, Test: 793.1411 [100.31], Avg: 288.8480 (0.020)
Ep: 498, Reward: 720.0211, Test: 712.8191 [271.57], Avg: 289.1535 (0.020)
Ep: 499, Reward: 821.4346, Test: 817.8421 [108.01], Avg: 289.9948 (0.020)
