Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.9			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ppo", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -71.2449, Test: -57.4525 [19.86], Avg: -77.3133 (0.980)
Ep: 1, Reward: -55.2273, Test: -52.9943 [17.24], Avg: -73.7743 (0.960)
Ep: 2, Reward: -55.4669, Test: -60.4083 [30.47], Avg: -79.4765 (0.941)
Ep: 3, Reward: -62.7099, Test: -55.3477 [14.52], Avg: -77.0744 (0.922)
Ep: 4, Reward: -68.5524, Test: -59.7266 [16.61], Avg: -76.9273 (0.904)
Ep: 5, Reward: -63.7301, Test: -53.1956 [29.62], Avg: -77.9089 (0.886)
Ep: 6, Reward: -52.8448, Test: -57.1121 [22.58], Avg: -78.1637 (0.868)
Ep: 7, Reward: -45.0181, Test: -57.1150 [20.55], Avg: -78.1012 (0.851)
Ep: 8, Reward: -63.0816, Test: -57.3801 [21.42], Avg: -78.1788 (0.834)
Ep: 9, Reward: -72.2276, Test: -57.5514 [20.66], Avg: -78.1819 (0.817)
Ep: 10, Reward: -67.6306, Test: -54.3014 [18.67], Avg: -77.7077 (0.801)
Ep: 11, Reward: -38.0840, Test: -52.3633 [21.63], Avg: -77.3984 (0.785)
Ep: 12, Reward: -42.0740, Test: -58.6122 [17.05], Avg: -77.2650 (0.769)
Ep: 13, Reward: -39.3676, Test: -51.7998 [24.05], Avg: -77.1640 (0.754)
Ep: 14, Reward: -48.5428, Test: -61.8522 [12.52], Avg: -76.9780 (0.739)
Ep: 15, Reward: -52.8280, Test: -47.4651 [25.74], Avg: -76.7422 (0.724)
Ep: 16, Reward: -48.1850, Test: -60.2934 [37.25], Avg: -77.9660 (0.709)
Ep: 17, Reward: -49.4054, Test: -57.9123 [20.98], Avg: -78.0172 (0.695)
Ep: 18, Reward: -62.5001, Test: -53.0088 [25.66], Avg: -78.0516 (0.681)
Ep: 19, Reward: -50.8430, Test: -61.3689 [20.06], Avg: -78.2204 (0.668)
Ep: 20, Reward: -50.3442, Test: -50.0144 [32.06], Avg: -78.4038 (0.654)
Ep: 21, Reward: -60.5695, Test: -48.1067 [22.17], Avg: -78.0342 (0.641)
Ep: 22, Reward: -42.1266, Test: -51.2901 [21.83], Avg: -77.8206 (0.628)
Ep: 23, Reward: -35.4748, Test: -54.4311 [22.97], Avg: -77.8032 (0.616)
Ep: 24, Reward: -52.3918, Test: -51.7198 [34.04], Avg: -78.1213 (0.603)
Ep: 25, Reward: -57.2449, Test: -49.9334 [22.17], Avg: -77.8899 (0.591)
Ep: 26, Reward: -51.7571, Test: -58.4600 [38.13], Avg: -78.5826 (0.580)
Ep: 27, Reward: -21.8182, Test: -47.3328 [20.72], Avg: -78.2067 (0.568)
Ep: 28, Reward: -46.0568, Test: -38.7022 [34.56], Avg: -78.0360 (0.557)
Ep: 29, Reward: -26.5474, Test: -36.1883 [11.51], Avg: -77.0248 (0.545)
Ep: 30, Reward: -39.7667, Test: -9.3396 [60.32], Avg: -76.7871 (0.535)
Ep: 31, Reward: -32.0776, Test: -37.7543 [32.83], Avg: -76.5932 (0.524)
Ep: 32, Reward: -14.5955, Test: -20.8164 [26.81], Avg: -75.7154 (0.513)
Ep: 33, Reward: -25.5469, Test: 19.7148 [57.57], Avg: -74.6017 (0.503)
Ep: 34, Reward: 3.9870, Test: -0.7549 [42.46], Avg: -73.7048 (0.493)
Ep: 35, Reward: -11.7572, Test: -2.8645 [65.54], Avg: -73.5577 (0.483)
Ep: 36, Reward: -17.0212, Test: -16.2011 [41.99], Avg: -73.1424 (0.474)
Ep: 37, Reward: -6.2365, Test: 14.3279 [68.26], Avg: -72.6370 (0.464)
Ep: 38, Reward: 10.2832, Test: 24.4553 [66.84], Avg: -71.8613 (0.455)
Ep: 39, Reward: 35.7059, Test: 50.7046 [104.54], Avg: -71.4107 (0.446)
Ep: 40, Reward: 21.3838, Test: 19.6786 [76.19], Avg: -71.0473 (0.437)
Ep: 41, Reward: 15.1536, Test: 41.9809 [61.95], Avg: -69.8313 (0.428)
Ep: 42, Reward: -7.9290, Test: 77.9538 [86.19], Avg: -68.3988 (0.419)
Ep: 43, Reward: 58.7050, Test: 74.3710 [102.80], Avg: -67.4905 (0.411)
Ep: 44, Reward: 65.9373, Test: 71.0458 [63.39], Avg: -65.8205 (0.403)
Ep: 45, Reward: 99.9358, Test: 73.1574 [91.72], Avg: -64.7931 (0.395)
Ep: 46, Reward: 59.5935, Test: 160.1829 [144.69], Avg: -63.0849 (0.387)
Ep: 47, Reward: 98.7418, Test: 113.4306 [117.71], Avg: -61.8598 (0.379)
Ep: 48, Reward: 61.7125, Test: 90.7076 [94.73], Avg: -60.6794 (0.372)
Ep: 49, Reward: 60.0957, Test: 74.7537 [104.53], Avg: -60.0613 (0.364)
Ep: 50, Reward: 79.8028, Test: 147.3034 [142.95], Avg: -58.7982 (0.357)
Ep: 51, Reward: 123.0065, Test: 100.2473 [93.50], Avg: -57.5377 (0.350)
Ep: 52, Reward: 68.6650, Test: 160.2507 [160.29], Avg: -56.4528 (0.343)
Ep: 53, Reward: 135.0077, Test: 190.0934 [103.64], Avg: -53.8064 (0.336)
Ep: 54, Reward: 135.6780, Test: 76.3869 [105.89], Avg: -53.3646 (0.329)
Ep: 55, Reward: 51.3284, Test: 104.2175 [104.50], Avg: -52.4167 (0.323)
Ep: 56, Reward: 116.8938, Test: 33.7957 [76.20], Avg: -52.2411 (0.316)
Ep: 57, Reward: 71.7477, Test: 121.4522 [136.68], Avg: -51.6030 (0.310)
Ep: 58, Reward: 90.2949, Test: 128.0261 [124.10], Avg: -50.6617 (0.304)
Ep: 59, Reward: 121.5774, Test: 61.1877 [97.17], Avg: -50.4171 (0.298)
Ep: 60, Reward: 203.7740, Test: 274.1022 [188.11], Avg: -48.1809 (0.292)
Ep: 61, Reward: 200.3375, Test: 159.9311 [143.06], Avg: -47.1316 (0.286)
Ep: 62, Reward: 208.0270, Test: 159.9681 [140.78], Avg: -46.0789 (0.280)
Ep: 63, Reward: 211.5711, Test: 304.3846 [155.70], Avg: -43.0356 (0.274)
Ep: 64, Reward: 268.6582, Test: 199.6560 [191.09], Avg: -42.2418 (0.269)
Ep: 65, Reward: 253.6274, Test: 145.3194 [121.21], Avg: -41.2365 (0.264)
Ep: 66, Reward: 262.8007, Test: 153.2969 [132.88], Avg: -40.3163 (0.258)
Ep: 67, Reward: 311.9762, Test: 147.6512 [204.91], Avg: -40.5655 (0.253)
Ep: 68, Reward: 288.1974, Test: 231.5773 [198.88], Avg: -39.5038 (0.248)
Ep: 69, Reward: 311.5098, Test: 275.3228 [112.32], Avg: -36.6108 (0.243)
Ep: 70, Reward: 230.1092, Test: 315.6436 [260.35], Avg: -35.3164 (0.238)
Ep: 71, Reward: 307.9184, Test: 175.0460 [197.48], Avg: -35.1374 (0.233)
Ep: 72, Reward: 325.7935, Test: 363.8597 [157.98], Avg: -31.8359 (0.229)
Ep: 73, Reward: 226.1670, Test: 249.4588 [191.33], Avg: -30.6201 (0.224)
Ep: 74, Reward: 219.3452, Test: 226.7127 [195.66], Avg: -29.7978 (0.220)
Ep: 75, Reward: 194.8389, Test: 116.0967 [116.02], Avg: -29.4047 (0.215)
Ep: 76, Reward: 108.9365, Test: 150.3202 [131.20], Avg: -28.7745 (0.211)
Ep: 77, Reward: 167.6295, Test: 142.3689 [133.14], Avg: -28.2873 (0.207)
Ep: 78, Reward: 202.4394, Test: 253.1041 [127.61], Avg: -26.3407 (0.203)
Ep: 79, Reward: 205.7710, Test: 311.4435 [149.24], Avg: -23.9839 (0.199)
Ep: 80, Reward: 104.3810, Test: 100.0919 [170.88], Avg: -24.5618 (0.195)
Ep: 81, Reward: 183.8624, Test: 323.7624 [214.26], Avg: -22.9269 (0.191)
Ep: 82, Reward: 103.7149, Test: 178.0326 [218.38], Avg: -23.1368 (0.187)
Ep: 83, Reward: 187.4637, Test: 268.0223 [228.72], Avg: -22.3936 (0.183)
Ep: 84, Reward: 309.1639, Test: 197.5851 [195.33], Avg: -22.1036 (0.180)
Ep: 85, Reward: 412.2730, Test: 447.0106 [256.54], Avg: -19.6318 (0.176)
Ep: 86, Reward: 326.1991, Test: 549.4213 [276.44], Avg: -16.2684 (0.172)
Ep: 87, Reward: 487.5388, Test: 578.8448 [242.76], Avg: -12.2644 (0.169)
Ep: 88, Reward: 578.2801, Test: 499.2375 [246.29], Avg: -9.2845 (0.166)
Ep: 89, Reward: 427.0298, Test: 470.8541 [167.08], Avg: -5.8061 (0.162)
Ep: 90, Reward: 586.1992, Test: 389.3170 [259.27], Avg: -4.3132 (0.159)
Ep: 91, Reward: 582.2557, Test: 570.9173 [253.96], Avg: -0.8211 (0.156)
Ep: 92, Reward: 650.5348, Test: 676.6751 [80.92], Avg: 5.5937 (0.153)
Ep: 93, Reward: 562.1270, Test: 548.9200 [196.97], Avg: 9.2783 (0.150)
Ep: 94, Reward: 720.9631, Test: 718.2542 [143.06], Avg: 15.2354 (0.147)
Ep: 95, Reward: 598.7386, Test: 580.5063 [191.95], Avg: 19.1242 (0.144)
Ep: 96, Reward: 590.3707, Test: 572.2745 [252.04], Avg: 22.2284 (0.141)
Ep: 97, Reward: 604.8142, Test: 696.6623 [130.10], Avg: 27.7828 (0.138)
Ep: 98, Reward: 609.6774, Test: 564.3537 [236.68], Avg: 30.8120 (0.135)
Ep: 99, Reward: 627.2929, Test: 705.2442 [131.20], Avg: 36.2443 (0.133)
Ep: 100, Reward: 620.3797, Test: 742.8674 [79.42], Avg: 42.4542 (0.130)
Ep: 101, Reward: 576.1693, Test: 555.8546 [242.92], Avg: 45.1060 (0.127)
Ep: 102, Reward: 566.9657, Test: 566.8921 [216.66], Avg: 48.0684 (0.125)
Ep: 103, Reward: 622.3246, Test: 487.7225 [226.00], Avg: 50.1227 (0.122)
Ep: 104, Reward: 617.3145, Test: 543.6682 [178.82], Avg: 53.1201 (0.120)
Ep: 105, Reward: 627.0514, Test: 552.1716 [194.05], Avg: 55.9975 (0.117)
Ep: 106, Reward: 629.2398, Test: 693.1950 [187.80], Avg: 60.1975 (0.115)
Ep: 107, Reward: 621.7281, Test: 563.9377 [182.02], Avg: 63.1764 (0.113)
Ep: 108, Reward: 630.6883, Test: 685.5979 [143.68], Avg: 67.5686 (0.111)
Ep: 109, Reward: 644.7807, Test: 593.1738 [136.37], Avg: 71.1071 (0.108)
Ep: 110, Reward: 686.1087, Test: 638.4230 [181.24], Avg: 74.5852 (0.106)
Ep: 111, Reward: 661.1639, Test: 734.0130 [149.30], Avg: 79.1399 (0.104)
Ep: 112, Reward: 655.0835, Test: 727.6179 [173.09], Avg: 83.3469 (0.102)
Ep: 113, Reward: 559.0864, Test: 669.1261 [246.52], Avg: 86.3228 (0.100)
Ep: 114, Reward: 632.2357, Test: 602.7724 [221.85], Avg: 88.8845 (0.098)
Ep: 115, Reward: 710.0299, Test: 517.1028 [230.73], Avg: 90.5870 (0.096)
Ep: 116, Reward: 674.8279, Test: 737.7862 [123.58], Avg: 95.0624 (0.094)
Ep: 117, Reward: 712.1756, Test: 700.8061 [129.44], Avg: 99.0988 (0.092)
Ep: 118, Reward: 699.6842, Test: 632.2293 [247.03], Avg: 101.5031 (0.090)
Ep: 119, Reward: 643.2063, Test: 680.6280 [197.33], Avg: 104.6846 (0.089)
Ep: 120, Reward: 614.5941, Test: 684.1239 [169.81], Avg: 108.0700 (0.087)
Ep: 121, Reward: 656.3217, Test: 794.6892 [156.87], Avg: 112.4122 (0.085)
Ep: 122, Reward: 765.2174, Test: 818.2092 [91.81], Avg: 117.4040 (0.083)
Ep: 123, Reward: 720.8171, Test: 715.4411 [190.48], Avg: 120.6907 (0.082)
Ep: 124, Reward: 753.9431, Test: 748.8486 [173.19], Avg: 124.3304 (0.080)
Ep: 125, Reward: 783.0327, Test: 810.7327 [47.47], Avg: 129.4013 (0.078)
Ep: 126, Reward: 740.4155, Test: 842.5498 [39.79], Avg: 134.7033 (0.077)
Ep: 127, Reward: 795.4557, Test: 807.6876 [92.71], Avg: 139.2367 (0.075)
Ep: 128, Reward: 776.1439, Test: 649.5500 [173.85], Avg: 141.8450 (0.074)
Ep: 129, Reward: 708.7838, Test: 675.8819 [223.90], Avg: 144.2307 (0.072)
Ep: 130, Reward: 701.1555, Test: 744.9534 [256.70], Avg: 146.8568 (0.071)
Ep: 131, Reward: 645.2891, Test: 665.8564 [251.07], Avg: 148.8866 (0.069)
Ep: 132, Reward: 676.3076, Test: 779.3941 [166.67], Avg: 152.3741 (0.068)
Ep: 133, Reward: 653.8405, Test: 735.2765 [129.69], Avg: 155.7562 (0.067)
Ep: 134, Reward: 793.1953, Test: 668.1291 [202.11], Avg: 158.0545 (0.065)
Ep: 135, Reward: 719.5035, Test: 734.3456 [160.73], Avg: 161.1101 (0.064)
Ep: 136, Reward: 730.8928, Test: 764.3441 [104.25], Avg: 164.7523 (0.063)
Ep: 137, Reward: 786.7175, Test: 807.4941 [112.35], Avg: 168.5958 (0.062)
Ep: 138, Reward: 782.6993, Test: 840.2933 [40.10], Avg: 173.1396 (0.060)
Ep: 139, Reward: 801.0651, Test: 722.9117 [179.44], Avg: 175.7849 (0.059)
Ep: 140, Reward: 687.8225, Test: 836.1320 [39.68], Avg: 180.1868 (0.058)
Ep: 141, Reward: 780.0416, Test: 747.7198 [222.58], Avg: 182.6160 (0.057)
Ep: 142, Reward: 740.9270, Test: 773.1887 [154.05], Avg: 185.6686 (0.056)
Ep: 143, Reward: 780.0608, Test: 607.7422 [226.09], Avg: 187.0296 (0.055)
Ep: 144, Reward: 717.8756, Test: 667.9442 [197.81], Avg: 188.9821 (0.053)
Ep: 145, Reward: 695.6750, Test: 727.7811 [209.20], Avg: 191.2396 (0.052)
Ep: 146, Reward: 603.2897, Test: 686.4228 [211.11], Avg: 193.1721 (0.051)
Ep: 147, Reward: 711.4948, Test: 782.0194 [89.68], Avg: 196.5448 (0.050)
Ep: 148, Reward: 782.8500, Test: 796.8841 [142.31], Avg: 199.6188 (0.049)
Ep: 149, Reward: 652.7906, Test: 687.3022 [190.83], Avg: 201.5979 (0.048)
Ep: 150, Reward: 670.1918, Test: 672.7574 [179.77], Avg: 203.5276 (0.047)
Ep: 151, Reward: 694.9047, Test: 815.8374 [33.19], Avg: 207.3376 (0.046)
Ep: 152, Reward: 670.1004, Test: 685.5713 [161.26], Avg: 209.4093 (0.045)
Ep: 153, Reward: 638.3755, Test: 670.1524 [252.84], Avg: 210.7593 (0.045)
Ep: 154, Reward: 655.1523, Test: 768.7724 [163.27], Avg: 213.3061 (0.044)
Ep: 155, Reward: 687.3457, Test: 696.3158 [183.02], Avg: 215.2291 (0.043)
Ep: 156, Reward: 657.6364, Test: 776.7327 [59.31], Avg: 218.4278 (0.042)
Ep: 157, Reward: 697.5843, Test: 687.1223 [186.56], Avg: 220.2134 (0.041)
Ep: 158, Reward: 670.5623, Test: 801.7365 [123.54], Avg: 223.0938 (0.040)
Ep: 159, Reward: 752.4805, Test: 718.9331 [201.48], Avg: 224.9336 (0.039)
Ep: 160, Reward: 751.1878, Test: 767.2993 [153.38], Avg: 227.3496 (0.039)
Ep: 161, Reward: 778.4734, Test: 762.4976 [99.85], Avg: 230.0366 (0.038)
Ep: 162, Reward: 790.1120, Test: 730.7334 [194.50], Avg: 231.9151 (0.037)
Ep: 163, Reward: 841.0855, Test: 834.8125 [100.13], Avg: 234.9808 (0.036)
Ep: 164, Reward: 799.6641, Test: 872.1275 [24.28], Avg: 238.6951 (0.036)
Ep: 165, Reward: 830.9080, Test: 880.4229 [25.23], Avg: 242.4090 (0.035)
Ep: 166, Reward: 795.7615, Test: 835.3011 [66.52], Avg: 245.5609 (0.034)
Ep: 167, Reward: 792.5014, Test: 837.2596 [71.27], Avg: 248.6588 (0.034)
Ep: 168, Reward: 833.6194, Test: 796.2633 [92.19], Avg: 251.3535 (0.033)
Ep: 169, Reward: 781.1003, Test: 847.3751 [25.34], Avg: 254.7105 (0.032)
Ep: 170, Reward: 742.8207, Test: 804.2426 [135.44], Avg: 257.1321 (0.032)
Ep: 171, Reward: 831.8722, Test: 843.3649 [29.19], Avg: 260.3707 (0.031)
Ep: 172, Reward: 759.5873, Test: 756.2629 [196.41], Avg: 262.1018 (0.030)
Ep: 173, Reward: 774.1887, Test: 835.8794 [67.04], Avg: 265.0141 (0.030)
Ep: 174, Reward: 859.4690, Test: 810.5208 [137.74], Avg: 267.3442 (0.029)
Ep: 175, Reward: 851.1546, Test: 834.9837 [47.14], Avg: 270.3016 (0.029)
Ep: 176, Reward: 793.2870, Test: 698.6589 [213.12], Avg: 271.5176 (0.028)
Ep: 177, Reward: 811.8095, Test: 758.3243 [158.51], Avg: 273.3620 (0.027)
Ep: 178, Reward: 805.9672, Test: 716.9211 [214.98], Avg: 274.6389 (0.027)
Ep: 179, Reward: 875.9712, Test: 739.6707 [185.51], Avg: 276.1918 (0.026)
Ep: 180, Reward: 855.1371, Test: 879.1542 [32.16], Avg: 279.3454 (0.026)
Ep: 181, Reward: 906.8008, Test: 810.1655 [117.99], Avg: 281.6137 (0.025)
Ep: 182, Reward: 773.8411, Test: 881.1398 [35.64], Avg: 284.6950 (0.025)
Ep: 183, Reward: 928.9914, Test: 846.0827 [91.81], Avg: 287.2471 (0.024)
Ep: 184, Reward: 850.0696, Test: 706.7076 [183.01], Avg: 288.5252 (0.024)
Ep: 185, Reward: 860.6172, Test: 833.2381 [89.79], Avg: 290.9710 (0.023)
Ep: 186, Reward: 762.9174, Test: 840.9776 [162.86], Avg: 293.0413 (0.023)
Ep: 187, Reward: 910.2400, Test: 782.3117 [206.41], Avg: 294.5459 (0.022)
Ep: 188, Reward: 833.2356, Test: 858.1175 [68.13], Avg: 297.1673 (0.022)
Ep: 189, Reward: 825.6158, Test: 756.1997 [202.95], Avg: 298.5151 (0.022)
Ep: 190, Reward: 839.4300, Test: 721.8521 [144.50], Avg: 299.9750 (0.021)
Ep: 191, Reward: 830.3126, Test: 853.8816 [29.70], Avg: 302.7052 (0.021)
Ep: 192, Reward: 738.8998, Test: 799.5571 [193.62], Avg: 304.2764 (0.020)
Ep: 193, Reward: 799.4740, Test: 761.8295 [164.45], Avg: 305.7872 (0.020)
Ep: 194, Reward: 769.3079, Test: 654.8078 [212.74], Avg: 306.4861 (0.020)
Ep: 195, Reward: 787.3420, Test: 753.4379 [172.77], Avg: 307.8850 (0.020)
Ep: 196, Reward: 856.0789, Test: 793.6098 [155.39], Avg: 309.5618 (0.020)
Ep: 197, Reward: 793.4862, Test: 782.8392 [120.14], Avg: 311.3453 (0.020)
Ep: 198, Reward: 688.7603, Test: 781.5703 [113.45], Avg: 313.1382 (0.020)
Ep: 199, Reward: 765.7531, Test: 810.8129 [120.32], Avg: 315.0249 (0.020)
Ep: 200, Reward: 826.1242, Test: 853.5143 [31.60], Avg: 317.5468 (0.020)
Ep: 201, Reward: 835.8831, Test: 867.8795 [33.72], Avg: 320.1043 (0.020)
Ep: 202, Reward: 808.2207, Test: 797.0616 [108.94], Avg: 321.9172 (0.020)
Ep: 203, Reward: 868.5208, Test: 816.1667 [54.17], Avg: 324.0744 (0.020)
Ep: 204, Reward: 867.4053, Test: 890.9295 [20.80], Avg: 326.7381 (0.020)
Ep: 205, Reward: 866.4128, Test: 838.5533 [55.71], Avg: 328.9522 (0.020)
Ep: 206, Reward: 840.5719, Test: 813.2802 [94.81], Avg: 330.8339 (0.020)
Ep: 207, Reward: 905.4034, Test: 860.8916 [80.15], Avg: 332.9969 (0.020)
Ep: 208, Reward: 955.5911, Test: 821.7359 [139.86], Avg: 334.6662 (0.020)
Ep: 209, Reward: 970.2829, Test: 886.9225 [20.58], Avg: 337.1980 (0.020)
Ep: 210, Reward: 1094.2981, Test: 907.6108 [18.42], Avg: 339.8141 (0.020)
Ep: 211, Reward: 1007.6094, Test: 893.5435 [34.82], Avg: 342.2618 (0.020)
Ep: 212, Reward: 995.3686, Test: 898.8718 [64.28], Avg: 344.5732 (0.020)
Ep: 213, Reward: 1075.0093, Test: 878.2096 [35.19], Avg: 346.9024 (0.020)
Ep: 214, Reward: 914.5441, Test: 880.0712 [65.55], Avg: 349.0773 (0.020)
Ep: 215, Reward: 951.6574, Test: 863.5262 [78.19], Avg: 351.0970 (0.020)
Ep: 216, Reward: 941.1185, Test: 875.9361 [38.94], Avg: 353.3362 (0.020)
Ep: 217, Reward: 908.8302, Test: 880.8813 [58.74], Avg: 355.4867 (0.020)
Ep: 218, Reward: 937.0980, Test: 845.2638 [104.99], Avg: 357.2437 (0.020)
Ep: 219, Reward: 836.9148, Test: 820.6045 [87.87], Avg: 358.9505 (0.020)
Ep: 220, Reward: 843.1574, Test: 865.9502 [17.89], Avg: 361.1636 (0.020)
Ep: 221, Reward: 831.2646, Test: 866.4365 [29.57], Avg: 363.3064 (0.020)
Ep: 222, Reward: 860.9672, Test: 834.5636 [68.03], Avg: 365.1146 (0.020)
Ep: 223, Reward: 792.9153, Test: 881.5362 [16.79], Avg: 367.3451 (0.020)
Ep: 224, Reward: 877.8713, Test: 874.4130 [32.04], Avg: 369.4563 (0.020)
Ep: 225, Reward: 853.5879, Test: 785.2152 [210.02], Avg: 370.3667 (0.020)
Ep: 226, Reward: 796.7346, Test: 840.9562 [59.15], Avg: 372.1792 (0.020)
Ep: 227, Reward: 865.1301, Test: 858.6939 [67.17], Avg: 374.0184 (0.020)
Ep: 228, Reward: 933.4354, Test: 758.2096 [203.15], Avg: 374.8090 (0.020)
Ep: 229, Reward: 788.8645, Test: 832.9444 [82.97], Avg: 376.4401 (0.020)
Ep: 230, Reward: 852.9083, Test: 806.1649 [109.44], Avg: 377.8266 (0.020)
Ep: 231, Reward: 907.1813, Test: 886.4647 [38.75], Avg: 379.8520 (0.020)
Ep: 232, Reward: 971.7199, Test: 893.9643 [29.80], Avg: 381.9306 (0.020)
Ep: 233, Reward: 996.2847, Test: 882.6655 [20.51], Avg: 383.9828 (0.020)
Ep: 234, Reward: 983.7831, Test: 863.3101 [78.11], Avg: 385.6902 (0.020)
Ep: 235, Reward: 804.8352, Test: 730.9680 [129.06], Avg: 386.6063 (0.020)
Ep: 236, Reward: 783.7571, Test: 854.8542 [47.17], Avg: 388.3830 (0.020)
Ep: 237, Reward: 833.0332, Test: 802.6467 [117.48], Avg: 389.6300 (0.020)
Ep: 238, Reward: 841.7350, Test: 808.3172 [56.91], Avg: 391.1437 (0.020)
Ep: 239, Reward: 821.5437, Test: 851.1796 [26.55], Avg: 392.9499 (0.020)
Ep: 240, Reward: 844.7812, Test: 839.9064 [75.57], Avg: 394.4909 (0.020)
Ep: 241, Reward: 896.1869, Test: 852.1960 [40.06], Avg: 396.2167 (0.020)
Ep: 242, Reward: 809.2281, Test: 858.8799 [73.22], Avg: 397.8194 (0.020)
Ep: 243, Reward: 923.3986, Test: 872.9054 [19.81], Avg: 399.6853 (0.020)
Ep: 244, Reward: 923.0845, Test: 869.7703 [21.17], Avg: 401.5176 (0.020)
Ep: 245, Reward: 894.3147, Test: 886.5998 [24.14], Avg: 403.3913 (0.020)
Ep: 246, Reward: 838.7244, Test: 908.4130 [17.83], Avg: 405.3637 (0.020)
Ep: 247, Reward: 1076.9161, Test: 890.0697 [37.48], Avg: 407.1671 (0.020)
Ep: 248, Reward: 957.6820, Test: 883.3222 [20.57], Avg: 408.9967 (0.020)
Ep: 249, Reward: 873.3053, Test: 883.5673 [18.11], Avg: 410.8226 (0.020)
Ep: 250, Reward: 924.8527, Test: 823.3430 [92.64], Avg: 412.0970 (0.020)
Ep: 251, Reward: 878.4034, Test: 802.3571 [186.47], Avg: 412.9057 (0.020)
Ep: 252, Reward: 895.1922, Test: 833.2930 [97.20], Avg: 414.1831 (0.020)
Ep: 253, Reward: 793.3852, Test: 882.2372 [12.82], Avg: 415.9754 (0.020)
Ep: 254, Reward: 953.2816, Test: 869.7827 [60.91], Avg: 417.5161 (0.020)
Ep: 255, Reward: 849.9668, Test: 883.0686 [27.10], Avg: 419.2289 (0.020)
Ep: 256, Reward: 951.4515, Test: 888.7915 [26.47], Avg: 420.9529 (0.020)
Ep: 257, Reward: 853.4592, Test: 823.1178 [98.24], Avg: 422.1310 (0.020)
Ep: 258, Reward: 875.3311, Test: 848.1860 [26.33], Avg: 423.6743 (0.020)
Ep: 259, Reward: 871.6709, Test: 837.5921 [73.32], Avg: 424.9843 (0.020)
Ep: 260, Reward: 917.6394, Test: 836.5707 [57.45], Avg: 426.3411 (0.020)
Ep: 261, Reward: 898.5839, Test: 870.9421 [18.94], Avg: 427.9658 (0.020)
Ep: 262, Reward: 815.0980, Test: 875.4462 [15.25], Avg: 429.6093 (0.020)
Ep: 263, Reward: 861.0637, Test: 856.9408 [69.70], Avg: 430.9639 (0.020)
Ep: 264, Reward: 843.8836, Test: 846.5993 [107.51], Avg: 432.1266 (0.020)
Ep: 265, Reward: 942.2467, Test: 859.3911 [87.72], Avg: 433.4031 (0.020)
Ep: 266, Reward: 886.9561, Test: 816.1515 [85.03], Avg: 434.5182 (0.020)
Ep: 267, Reward: 877.2910, Test: 713.8417 [252.53], Avg: 434.6182 (0.020)
Ep: 268, Reward: 950.0392, Test: 825.7526 [110.76], Avg: 435.6605 (0.020)
Ep: 269, Reward: 972.8192, Test: 861.7860 [63.52], Avg: 437.0035 (0.020)
Ep: 270, Reward: 934.8858, Test: 844.6160 [71.97], Avg: 438.2420 (0.020)
Ep: 271, Reward: 864.5324, Test: 875.2497 [46.69], Avg: 439.6770 (0.020)
Ep: 272, Reward: 927.5542, Test: 839.7097 [148.39], Avg: 440.5987 (0.020)
Ep: 273, Reward: 899.2584, Test: 765.2903 [207.51], Avg: 441.0264 (0.020)
Ep: 274, Reward: 842.4238, Test: 842.6973 [78.43], Avg: 442.2019 (0.020)
Ep: 275, Reward: 795.2103, Test: 743.5862 [119.26], Avg: 442.8617 (0.020)
Ep: 276, Reward: 768.4839, Test: 742.7613 [136.08], Avg: 443.4531 (0.020)
Ep: 277, Reward: 830.5046, Test: 877.3403 [18.10], Avg: 444.9488 (0.020)
Ep: 278, Reward: 923.6958, Test: 829.3012 [88.25], Avg: 446.0101 (0.020)
Ep: 279, Reward: 917.0321, Test: 845.9607 [125.39], Avg: 446.9907 (0.020)
Ep: 280, Reward: 855.2895, Test: 810.4097 [209.65], Avg: 447.5379 (0.020)
Ep: 281, Reward: 932.6051, Test: 671.5249 [237.70], Avg: 447.4893 (0.020)
Ep: 282, Reward: 792.0808, Test: 863.3895 [37.26], Avg: 448.8272 (0.020)
Ep: 283, Reward: 933.1300, Test: 820.4756 [203.78], Avg: 449.4183 (0.020)
Ep: 284, Reward: 858.8321, Test: 745.4668 [208.03], Avg: 449.7272 (0.020)
Ep: 285, Reward: 844.5143, Test: 888.5899 [11.66], Avg: 451.2209 (0.020)
Ep: 286, Reward: 724.9944, Test: 745.2874 [124.33], Avg: 451.8123 (0.020)
Ep: 287, Reward: 918.0853, Test: 798.8939 [150.42], Avg: 452.4952 (0.020)
Ep: 288, Reward: 787.4342, Test: 869.1440 [47.68], Avg: 453.7719 (0.020)
Ep: 289, Reward: 1014.0357, Test: 852.3446 [95.75], Avg: 454.8161 (0.020)
Ep: 290, Reward: 901.1662, Test: 858.1926 [51.02], Avg: 456.0269 (0.020)
Ep: 291, Reward: 854.2934, Test: 826.3199 [82.07], Avg: 457.0140 (0.020)
Ep: 292, Reward: 894.1154, Test: 835.4218 [111.53], Avg: 457.9248 (0.020)
Ep: 293, Reward: 883.2197, Test: 841.1639 [60.10], Avg: 459.0239 (0.020)
Ep: 294, Reward: 935.2338, Test: 880.1806 [27.47], Avg: 460.3585 (0.020)
Ep: 295, Reward: 829.1656, Test: 893.6476 [24.76], Avg: 461.7386 (0.020)
Ep: 296, Reward: 876.5341, Test: 771.2913 [196.05], Avg: 462.1208 (0.020)
Ep: 297, Reward: 864.3632, Test: 825.6459 [102.43], Avg: 462.9970 (0.020)
Ep: 298, Reward: 916.4264, Test: 818.7022 [161.30], Avg: 463.6471 (0.020)
Ep: 299, Reward: 867.2388, Test: 821.2492 [92.97], Avg: 464.5293 (0.020)
Ep: 300, Reward: 930.7946, Test: 803.6731 [157.55], Avg: 465.1326 (0.020)
Ep: 301, Reward: 827.6216, Test: 869.0129 [19.88], Avg: 466.4041 (0.020)
Ep: 302, Reward: 894.0069, Test: 883.8943 [46.55], Avg: 467.6283 (0.020)
Ep: 303, Reward: 941.9245, Test: 816.6187 [172.30], Avg: 468.2095 (0.020)
Ep: 304, Reward: 975.1137, Test: 851.3909 [73.11], Avg: 469.2262 (0.020)
Ep: 305, Reward: 900.3483, Test: 835.4561 [93.65], Avg: 470.1169 (0.020)
Ep: 306, Reward: 854.5236, Test: 832.0659 [134.68], Avg: 470.8572 (0.020)
Ep: 307, Reward: 899.4917, Test: 880.4490 [23.26], Avg: 472.1116 (0.020)
Ep: 308, Reward: 785.4379, Test: 850.1274 [35.35], Avg: 473.2205 (0.020)
Ep: 309, Reward: 893.1660, Test: 881.4495 [36.84], Avg: 474.4185 (0.020)
Ep: 310, Reward: 808.0254, Test: 857.8977 [22.82], Avg: 475.5782 (0.020)
Ep: 311, Reward: 859.0185, Test: 875.0084 [25.43], Avg: 476.7769 (0.020)
Ep: 312, Reward: 828.7666, Test: 776.4744 [152.50], Avg: 477.2472 (0.020)
Ep: 313, Reward: 984.4435, Test: 846.6134 [84.78], Avg: 478.1536 (0.020)
Ep: 314, Reward: 925.6369, Test: 800.1917 [125.41], Avg: 478.7778 (0.020)
Ep: 315, Reward: 897.0718, Test: 798.2435 [126.62], Avg: 479.3881 (0.020)
Ep: 316, Reward: 825.3258, Test: 828.2817 [138.80], Avg: 480.0508 (0.020)
Ep: 317, Reward: 902.1066, Test: 829.8164 [93.28], Avg: 480.8574 (0.020)
Ep: 318, Reward: 1005.3721, Test: 792.2218 [193.70], Avg: 481.2262 (0.020)
Ep: 319, Reward: 896.0694, Test: 851.3448 [59.13], Avg: 482.1981 (0.020)
Ep: 320, Reward: 815.1528, Test: 847.2008 [63.12], Avg: 483.1385 (0.020)
Ep: 321, Reward: 979.7028, Test: 865.9043 [59.20], Avg: 484.1434 (0.020)
Ep: 322, Reward: 793.8735, Test: 858.4759 [71.20], Avg: 485.0818 (0.020)
Ep: 323, Reward: 839.7504, Test: 829.6831 [151.32], Avg: 485.6784 (0.020)
Ep: 324, Reward: 824.6979, Test: 864.6028 [48.51], Avg: 486.6951 (0.020)
Ep: 325, Reward: 888.4233, Test: 873.5650 [97.06], Avg: 487.5840 (0.020)
Ep: 326, Reward: 868.6814, Test: 891.2439 [31.97], Avg: 488.7207 (0.020)
Ep: 327, Reward: 992.4022, Test: 860.5226 [54.00], Avg: 489.6896 (0.020)
Ep: 328, Reward: 853.1381, Test: 824.3724 [101.33], Avg: 490.3989 (0.020)
Ep: 329, Reward: 786.4525, Test: 890.0386 [29.56], Avg: 491.5204 (0.020)
Ep: 330, Reward: 898.9705, Test: 744.4810 [205.72], Avg: 491.6631 (0.020)
Ep: 331, Reward: 1024.0757, Test: 882.5549 [21.14], Avg: 492.7768 (0.020)
Ep: 332, Reward: 920.3700, Test: 871.3261 [30.09], Avg: 493.8232 (0.020)
Ep: 333, Reward: 842.2724, Test: 883.3322 [26.65], Avg: 494.9096 (0.020)
Ep: 334, Reward: 1019.1971, Test: 834.3677 [157.28], Avg: 495.4534 (0.020)
Ep: 335, Reward: 1072.7513, Test: 884.1636 [22.82], Avg: 496.5424 (0.020)
Ep: 336, Reward: 997.2977, Test: 884.0872 [34.04], Avg: 497.5914 (0.020)
Ep: 337, Reward: 974.5233, Test: 861.0525 [46.06], Avg: 498.5304 (0.020)
Ep: 338, Reward: 851.9248, Test: 758.6161 [187.86], Avg: 498.7435 (0.020)
Ep: 339, Reward: 923.4569, Test: 811.1278 [81.45], Avg: 499.4227 (0.020)
Ep: 340, Reward: 857.2992, Test: 796.3276 [128.73], Avg: 499.9159 (0.020)
Ep: 341, Reward: 845.2232, Test: 863.9720 [33.69], Avg: 500.8819 (0.020)
Ep: 342, Reward: 793.5297, Test: 803.3866 [148.89], Avg: 501.3297 (0.020)
Ep: 343, Reward: 873.0016, Test: 621.8568 [172.38], Avg: 501.1790 (0.020)
Ep: 344, Reward: 663.3452, Test: 859.0351 [61.21], Avg: 502.0388 (0.020)
Ep: 345, Reward: 835.1900, Test: 685.6965 [172.02], Avg: 502.0724 (0.020)
Ep: 346, Reward: 794.2307, Test: 863.9331 [23.93], Avg: 503.0463 (0.020)
Ep: 347, Reward: 882.0085, Test: 890.3640 [21.66], Avg: 504.0970 (0.020)
Ep: 348, Reward: 820.0520, Test: 814.1035 [177.60], Avg: 504.4764 (0.020)
Ep: 349, Reward: 813.5062, Test: 710.0046 [224.44], Avg: 504.4224 (0.020)
Ep: 350, Reward: 798.2073, Test: 780.6678 [130.03], Avg: 504.8390 (0.020)
Ep: 351, Reward: 826.0167, Test: 719.7833 [226.67], Avg: 504.8057 (0.020)
Ep: 352, Reward: 843.3695, Test: 852.2930 [25.02], Avg: 505.7192 (0.020)
Ep: 353, Reward: 726.4517, Test: 855.5275 [71.44], Avg: 506.5055 (0.020)
Ep: 354, Reward: 893.0595, Test: 851.7426 [47.94], Avg: 507.3430 (0.020)
Ep: 355, Reward: 842.3467, Test: 830.2406 [70.43], Avg: 508.0522 (0.020)
Ep: 356, Reward: 808.8982, Test: 805.8093 [101.59], Avg: 508.6017 (0.020)
Ep: 357, Reward: 850.2937, Test: 807.1681 [200.12], Avg: 508.8766 (0.020)
Ep: 358, Reward: 816.9333, Test: 882.0033 [27.14], Avg: 509.8404 (0.020)
Ep: 359, Reward: 731.6166, Test: 782.3110 [150.90], Avg: 510.1781 (0.020)
Ep: 360, Reward: 827.3140, Test: 870.4056 [17.03], Avg: 511.1288 (0.020)
Ep: 361, Reward: 983.4225, Test: 822.0116 [163.18], Avg: 511.5368 (0.020)
Ep: 362, Reward: 820.6566, Test: 860.6748 [85.61], Avg: 512.2628 (0.020)
Ep: 363, Reward: 915.9516, Test: 881.3678 [35.45], Avg: 513.1794 (0.020)
Ep: 364, Reward: 911.5988, Test: 880.7452 [57.38], Avg: 514.0292 (0.020)
Ep: 365, Reward: 906.3051, Test: 855.8859 [78.91], Avg: 514.7477 (0.020)
Ep: 366, Reward: 909.0312, Test: 804.0967 [166.00], Avg: 515.0838 (0.020)
Ep: 367, Reward: 921.9019, Test: 886.3868 [16.77], Avg: 516.0472 (0.020)
Ep: 368, Reward: 968.0067, Test: 879.8943 [26.07], Avg: 516.9626 (0.020)
Ep: 369, Reward: 1043.6778, Test: 872.4434 [22.65], Avg: 517.8621 (0.020)
Ep: 370, Reward: 924.3721, Test: 884.1062 [30.17], Avg: 518.7680 (0.020)
Ep: 371, Reward: 939.5349, Test: 876.6891 [17.42], Avg: 519.6833 (0.020)
Ep: 372, Reward: 952.6843, Test: 885.4525 [57.10], Avg: 520.5108 (0.020)
Ep: 373, Reward: 1089.5133, Test: 896.0135 [27.86], Avg: 521.4404 (0.020)
Ep: 374, Reward: 1075.7570, Test: 883.5695 [33.05], Avg: 522.3179 (0.020)
Ep: 375, Reward: 924.5763, Test: 839.8883 [203.53], Avg: 522.6212 (0.020)
Ep: 376, Reward: 903.1638, Test: 903.7099 [24.64], Avg: 523.5667 (0.020)
Ep: 377, Reward: 883.8251, Test: 870.3441 [24.24], Avg: 524.4200 (0.020)
Ep: 378, Reward: 846.8398, Test: 778.9531 [122.04], Avg: 524.7695 (0.020)
Ep: 379, Reward: 820.8655, Test: 864.0443 [16.51], Avg: 525.6189 (0.020)
Ep: 380, Reward: 896.1837, Test: 850.7610 [38.88], Avg: 526.3703 (0.020)
Ep: 381, Reward: 897.3929, Test: 829.5150 [86.84], Avg: 526.9365 (0.020)
Ep: 382, Reward: 1046.2741, Test: 892.8587 [17.69], Avg: 527.8457 (0.020)
Ep: 383, Reward: 1051.2456, Test: 862.4845 [130.91], Avg: 528.3763 (0.020)
Ep: 384, Reward: 1059.7209, Test: 888.3313 [74.72], Avg: 529.1171 (0.020)
Ep: 385, Reward: 1084.2080, Test: 892.2787 [15.97], Avg: 530.0166 (0.020)
Ep: 386, Reward: 1030.7437, Test: 907.0796 [25.61], Avg: 530.9247 (0.020)
Ep: 387, Reward: 1087.2826, Test: 833.2910 [148.79], Avg: 531.3205 (0.020)
Ep: 388, Reward: 989.3704, Test: 875.5761 [27.73], Avg: 532.1342 (0.020)
Ep: 389, Reward: 1013.5980, Test: 783.7887 [200.66], Avg: 532.2650 (0.020)
Ep: 390, Reward: 900.9227, Test: 890.6629 [29.76], Avg: 533.1055 (0.020)
Ep: 391, Reward: 1086.7723, Test: 905.1889 [30.95], Avg: 533.9758 (0.020)
Ep: 392, Reward: 1121.9317, Test: 910.3700 [28.25], Avg: 534.8616 (0.020)
Ep: 393, Reward: 958.6213, Test: 739.9093 [216.07], Avg: 534.8337 (0.020)
Ep: 394, Reward: 1019.7156, Test: 847.5921 [62.88], Avg: 535.4663 (0.020)
Ep: 395, Reward: 1051.6981, Test: 857.1018 [178.34], Avg: 535.8281 (0.020)
Ep: 396, Reward: 842.7560, Test: 770.0900 [166.86], Avg: 535.9979 (0.020)
Ep: 397, Reward: 775.3847, Test: 830.5764 [89.56], Avg: 536.5130 (0.020)
Ep: 398, Reward: 1038.1641, Test: 910.8475 [18.08], Avg: 537.4059 (0.020)
Ep: 399, Reward: 949.3231, Test: 865.4201 [59.59], Avg: 538.0769 (0.020)
Ep: 400, Reward: 1060.6066, Test: 841.7138 [146.36], Avg: 538.4692 (0.020)
Ep: 401, Reward: 926.3910, Test: 854.1993 [156.09], Avg: 538.8663 (0.020)
Ep: 402, Reward: 787.4453, Test: 822.2962 [243.78], Avg: 538.9647 (0.020)
Ep: 403, Reward: 746.9446, Test: 695.4261 [294.25], Avg: 538.6236 (0.020)
Ep: 404, Reward: 775.5257, Test: 872.6872 [70.93], Avg: 539.2733 (0.020)
Ep: 405, Reward: 920.3242, Test: 538.4195 [171.83], Avg: 538.8480 (0.020)
Ep: 406, Reward: 604.9556, Test: 790.8989 [198.74], Avg: 538.9790 (0.020)
Ep: 407, Reward: 738.1280, Test: 755.1007 [185.33], Avg: 539.0545 (0.020)
Ep: 408, Reward: 845.4252, Test: 847.4340 [95.81], Avg: 539.5742 (0.020)
Ep: 409, Reward: 879.0566, Test: 883.2164 [18.88], Avg: 540.3663 (0.020)
Ep: 410, Reward: 914.1733, Test: 819.2861 [146.27], Avg: 540.6890 (0.020)
Ep: 411, Reward: 953.9496, Test: 838.6225 [116.00], Avg: 541.1306 (0.020)
Ep: 412, Reward: 806.1604, Test: 742.7165 [224.16], Avg: 541.0760 (0.020)
Ep: 413, Reward: 765.8720, Test: 764.4561 [113.78], Avg: 541.3407 (0.020)
Ep: 414, Reward: 764.9259, Test: 798.1562 [170.88], Avg: 541.5478 (0.020)
Ep: 415, Reward: 954.9158, Test: 840.8682 [64.62], Avg: 542.1120 (0.020)
Ep: 416, Reward: 859.8475, Test: 870.7358 [64.55], Avg: 542.7452 (0.020)
Ep: 417, Reward: 904.4789, Test: 827.8391 [105.59], Avg: 543.1747 (0.020)
Ep: 418, Reward: 871.1207, Test: 851.0567 [43.34], Avg: 543.8060 (0.020)
Ep: 419, Reward: 956.7453, Test: 864.1175 [35.18], Avg: 544.4849 (0.020)
Ep: 420, Reward: 883.0372, Test: 844.4312 [83.65], Avg: 544.9987 (0.020)
Ep: 421, Reward: 891.1444, Test: 858.4919 [90.61], Avg: 545.5268 (0.020)
Ep: 422, Reward: 972.3617, Test: 900.9611 [21.90], Avg: 546.3153 (0.020)
Ep: 423, Reward: 1076.3991, Test: 893.8406 [22.18], Avg: 547.0826 (0.020)
Ep: 424, Reward: 876.2467, Test: 875.9058 [74.47], Avg: 547.6811 (0.020)
Ep: 425, Reward: 995.7306, Test: 740.4319 [208.10], Avg: 547.6451 (0.020)
Ep: 426, Reward: 850.5773, Test: 851.7173 [121.98], Avg: 548.0715 (0.020)
Ep: 427, Reward: 1094.2301, Test: 899.9660 [21.61], Avg: 548.8432 (0.020)
Ep: 428, Reward: 942.8805, Test: 843.5087 [154.06], Avg: 549.1710 (0.020)
Ep: 429, Reward: 974.7877, Test: 861.7968 [58.38], Avg: 549.7623 (0.020)
Ep: 430, Reward: 833.8641, Test: 823.4342 [83.50], Avg: 550.2035 (0.020)
Ep: 431, Reward: 946.5695, Test: 827.7422 [96.29], Avg: 550.6231 (0.020)
Ep: 432, Reward: 949.2963, Test: 898.4296 [31.43], Avg: 551.3537 (0.020)
Ep: 433, Reward: 1101.4739, Test: 879.7381 [62.37], Avg: 551.9667 (0.020)
Ep: 434, Reward: 946.2417, Test: 910.6428 [22.41], Avg: 552.7397 (0.020)
Ep: 435, Reward: 1088.0401, Test: 887.8127 [32.00], Avg: 553.4348 (0.020)
Ep: 436, Reward: 978.8111, Test: 856.4080 [69.29], Avg: 553.9696 (0.020)
Ep: 437, Reward: 929.5207, Test: 893.5903 [32.65], Avg: 554.6704 (0.020)
Ep: 438, Reward: 1132.5481, Test: 886.3632 [29.84], Avg: 555.3580 (0.020)
Ep: 439, Reward: 981.4621, Test: 844.8376 [77.48], Avg: 555.8398 (0.020)
Ep: 440, Reward: 959.9907, Test: 858.5895 [43.91], Avg: 556.4267 (0.020)
Ep: 441, Reward: 974.4157, Test: 889.5654 [57.25], Avg: 557.0509 (0.020)
Ep: 442, Reward: 862.8808, Test: 858.8292 [68.63], Avg: 557.5772 (0.020)
Ep: 443, Reward: 941.2070, Test: 878.4521 [67.45], Avg: 558.1480 (0.020)
Ep: 444, Reward: 1063.6102, Test: 839.7998 [88.22], Avg: 558.5827 (0.020)
Ep: 445, Reward: 898.1128, Test: 893.3125 [36.48], Avg: 559.2514 (0.020)
Ep: 446, Reward: 1045.7347, Test: 896.1532 [29.08], Avg: 559.9400 (0.020)
Ep: 447, Reward: 898.1101, Test: 877.1019 [39.29], Avg: 560.5603 (0.020)
Ep: 448, Reward: 943.9854, Test: 862.0701 [89.62], Avg: 561.0322 (0.020)
Ep: 449, Reward: 959.5627, Test: 828.4764 [81.14], Avg: 561.4462 (0.020)
Ep: 450, Reward: 956.1227, Test: 891.4255 [34.16], Avg: 562.1021 (0.020)
Ep: 451, Reward: 849.4720, Test: 793.8899 [139.38], Avg: 562.3065 (0.020)
Ep: 452, Reward: 944.8500, Test: 870.8389 [40.87], Avg: 562.8974 (0.020)
Ep: 453, Reward: 1043.7858, Test: 864.4535 [76.21], Avg: 563.3938 (0.020)
Ep: 454, Reward: 903.9263, Test: 851.3864 [124.63], Avg: 563.7528 (0.020)
Ep: 455, Reward: 1181.5843, Test: 908.4421 [31.57], Avg: 564.4395 (0.020)
Ep: 456, Reward: 1144.0751, Test: 896.4269 [26.40], Avg: 565.1081 (0.020)
Ep: 457, Reward: 1048.3238, Test: 762.3397 [219.25], Avg: 565.0601 (0.020)
Ep: 458, Reward: 1119.9552, Test: 802.1229 [195.65], Avg: 565.1503 (0.020)
Ep: 459, Reward: 1042.7032, Test: 862.0661 [105.10], Avg: 565.5673 (0.020)
Ep: 460, Reward: 1205.3177, Test: 803.8222 [197.08], Avg: 565.6566 (0.020)
Ep: 461, Reward: 901.4401, Test: 807.4957 [128.37], Avg: 565.9022 (0.020)
Ep: 462, Reward: 1030.7407, Test: 894.0448 [50.96], Avg: 566.5009 (0.020)
Ep: 463, Reward: 1037.7119, Test: 848.8570 [112.09], Avg: 566.8678 (0.020)
Ep: 464, Reward: 928.9361, Test: 900.4327 [25.85], Avg: 567.5295 (0.020)
Ep: 465, Reward: 830.8887, Test: 779.4825 [189.73], Avg: 567.5772 (0.020)
Ep: 466, Reward: 1155.7965, Test: 889.0309 [25.66], Avg: 568.2106 (0.020)
Ep: 467, Reward: 1062.1964, Test: 853.8948 [92.14], Avg: 568.6242 (0.020)
Ep: 468, Reward: 1026.1558, Test: 875.0997 [102.05], Avg: 569.0601 (0.020)
Ep: 469, Reward: 984.8497, Test: 879.8987 [16.68], Avg: 569.6859 (0.020)
Ep: 470, Reward: 1089.6378, Test: 910.2495 [28.09], Avg: 570.3494 (0.020)
Ep: 471, Reward: 1041.6749, Test: 895.4394 [31.71], Avg: 570.9709 (0.020)
Ep: 472, Reward: 1130.0305, Test: 877.6885 [58.30], Avg: 571.4961 (0.020)
Ep: 473, Reward: 1000.7278, Test: 914.8679 [24.33], Avg: 572.1692 (0.020)
Ep: 474, Reward: 1006.4253, Test: 837.3246 [108.70], Avg: 572.4986 (0.020)
Ep: 475, Reward: 924.5976, Test: 881.5755 [21.49], Avg: 573.1028 (0.020)
Ep: 476, Reward: 1027.3068, Test: 801.1095 [187.74], Avg: 573.1872 (0.020)
Ep: 477, Reward: 1037.0436, Test: 840.4828 [83.56], Avg: 573.5716 (0.020)
Ep: 478, Reward: 937.1107, Test: 909.8065 [29.55], Avg: 574.2118 (0.020)
Ep: 479, Reward: 1073.4335, Test: 794.4133 [164.47], Avg: 574.3280 (0.020)
Ep: 480, Reward: 960.3251, Test: 826.6808 [135.55], Avg: 574.5708 (0.020)
Ep: 481, Reward: 948.9357, Test: 835.4339 [117.53], Avg: 574.8682 (0.020)
Ep: 482, Reward: 962.9688, Test: 787.0948 [154.12], Avg: 574.9885 (0.020)
Ep: 483, Reward: 1050.5664, Test: 834.9097 [183.38], Avg: 575.1466 (0.020)
Ep: 484, Reward: 1002.6622, Test: 890.6869 [26.91], Avg: 575.7417 (0.020)
Ep: 485, Reward: 917.1154, Test: 800.2137 [136.74], Avg: 575.9223 (0.020)
Ep: 486, Reward: 1004.9677, Test: 911.2018 [18.58], Avg: 576.5726 (0.020)
Ep: 487, Reward: 1061.7943, Test: 864.0314 [72.34], Avg: 577.0134 (0.020)
Ep: 488, Reward: 1091.2656, Test: 859.2656 [98.71], Avg: 577.3887 (0.020)
Ep: 489, Reward: 1062.8922, Test: 828.8053 [124.38], Avg: 577.6480 (0.020)
Ep: 490, Reward: 938.5346, Test: 838.1439 [122.11], Avg: 577.9298 (0.020)
Ep: 491, Reward: 900.2974, Test: 909.8095 [20.95], Avg: 578.5618 (0.020)
Ep: 492, Reward: 1076.0335, Test: 883.4190 [87.58], Avg: 579.0025 (0.020)
Ep: 493, Reward: 933.2180, Test: 898.1869 [26.69], Avg: 579.5946 (0.020)
Ep: 494, Reward: 1080.1569, Test: 875.2583 [94.03], Avg: 580.0019 (0.020)
Ep: 495, Reward: 1087.6226, Test: 911.8781 [31.37], Avg: 580.6078 (0.020)
Ep: 496, Reward: 1128.4689, Test: 910.8858 [24.86], Avg: 581.2223 (0.020)
Ep: 497, Reward: 1000.3039, Test: 903.4816 [38.03], Avg: 581.7930 (0.020)
Ep: 498, Reward: 1071.6419, Test: 819.7329 [122.58], Avg: 582.0242 (0.020)
Ep: 499, Reward: 1052.6349, Test: 907.7607 [27.73], Avg: 582.6202 (0.020)
