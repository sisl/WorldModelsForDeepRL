Model: <class 'models.ddpg.DDPGAgent'>, Dir: iter1/
statemodel: <class 'utils.envs.WorldModel'>, num_envs: 32,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, MAX_BUFFER_SIZE

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)
		self.replay_buffer = PrioritizedReplayBuffer(MAX_BUFFER_SIZE)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets, advantages)]
			self.replay_buffer.extend(zip(states, actions, targets, advantages))	
		if len(self.replay_buffer) > 0:
			(states, actions, targets, advantages), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.97			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.0225               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.995             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import os
import gym
import torch
import argparse
import numpy as np
from collections import deque
from models.ppo import PPOAgent
from models.rand import RandomAgent
from models.ddpg import DDPGAgent, EPS_MIN
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, WorldModel, ImgStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--iternum", type=int, default=-1, choices=[-1,0,1], help="Whether to train using World Model to load (0 or 1) or raw images (-1)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddpg", "ppo"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--runs", type=int, default=1, help="Number of episodes to train the agent")
parser.add_argument("--trial", action="store_true", help="Whether to show a trial run training on the Pendulum-v0 environment")
args = parser.parse_args()

ENV_NAME = "CarRacing-v0"

class WorldACAgent(RandomAgent):
	def __init__(self, action_size, num_envs, acagent, statemodel=WorldModel, load="", gpu=True, train=True):
		super().__init__(action_size)
		self.world_model = statemodel(action_size, num_envs, load=load, gpu=gpu)
		self.acagent = acagent(self.world_model.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state, latent = self.world_model.get_state(state)
		env_action, action = self.acagent.get_env_action(env, state, eps, sample)
		self.world_model.step(latent, env_action)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.world_model.get_state(next_state)[0]
		self.acagent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.world_model.num_envs if num_envs is None else num_envs
		self.world_model.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		self.acagent.network.save_model(dirname, name)

	def load(self, dirname="pytorch", name="best"):
		self.world_model.load_model(dirname, name)
		self.acagent.network.load_model(dirname, name)
		return self

def run(model, statemodel, runs=1, load_dir="", ports=16):
	num_envs = len(ports) if type(ports) == list else min(ports, 16)
	logger = Logger(model, load_dir, statemodel=statemodel, num_envs=num_envs)
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = WorldACAgent(envs.action_size, num_envs, model, statemodel, load=load_dir)
	total_rewards = []
	for ep in range(runs):
		states = envs.reset()
		agent.reset(num_envs)
		total_reward = 0
		for _ in range(envs.env.spec.max_episode_steps):
			env_actions, actions, states = agent.get_env_action(envs.env, states)
			next_states, rewards, dones, _ = envs.step(env_actions, render=(ep%runs==0))
			agent.train(states, actions, next_states, rewards, dones)
			total_reward += np.mean(rewards)
			states = next_states
		rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(10)]
		test_reward = np.mean(rollouts) - np.std(rollouts)
		total_rewards.append(test_reward)
		agent.save_model(load_dir, "checkpoint")
		if total_rewards[-1] >= max(total_rewards): agent.save_model(load_dir)
		logger.log(f"Ep: {ep}, Reward: {total_reward:.4f}, Test: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.acagent.eps:.3f})")
	envs.close()

def trial(model, steps=40000, ports=16):
	env_name = "Pendulum-v0"
	envs = EnvManager(ENV_NAME, ports) if type(ports) == list else EnsembleEnv(ENV_NAME, ports)
	agent = model(envs.state_size, envs.action_size, decay=0.99)
	env = gym.make(env_name)
	state = envs.reset()
	test_rewards = []
	for s in range(steps):
		env_action, action = agent.get_env_action(env, state)
		next_state, reward, done, _ = envs.step(env_action)
		agent.train(state, action, next_state, reward, done)
		state = next_state
		if s % env.spec.max_episode_steps == 0:
			test_reward = np.mean([rollout(env, agent) for _ in range(10)])
			test_rewards.append(test_reward)
			print(f"Ep: {s//env.spec.max_episode_steps}, Rewards: {test_reward}, Avg: {np.mean(test_rewards)}")
			if test_reward > -200: break
	env.close()
	envs.close()

if __name__ == "__main__":
	dirname = "pytorch" if args.iternum < 0 else f"iter{args.iternum}/"
	state = ImgStack if args.iternum < 0 else WorldModel
	model = PPOAgent if args.model == "ppo" else DDPGAgent
	if args.trial:
		trial(model, ports=args.workerports)
	elif args.selfport is not None:
		EnvWorker(args.selfport, ENV_NAME).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, state, args.runs, dirname, args.workerports)

Ep: 0, Reward: -61.5801, Test: -51.0741 [15.47], Avg: -66.5435 (0.980)
Ep: 1, Reward: -63.6069, Test: -49.7706 [18.44], Avg: -67.3778 (0.960)
Ep: 2, Reward: -58.1701, Test: -59.3576 [20.09], Avg: -71.3994 (0.941)
Ep: 3, Reward: -42.8402, Test: -75.8920 [33.50], Avg: -80.8983 (0.922)
Ep: 4, Reward: -46.5961, Test: -50.2858 [23.76], Avg: -79.5273 (0.904)
Ep: 5, Reward: -46.1165, Test: -59.9991 [14.48], Avg: -78.6853 (0.886)
Ep: 6, Reward: -51.1149, Test: -47.6395 [22.64], Avg: -77.4846 (0.868)
Ep: 7, Reward: -51.4768, Test: -53.7112 [25.26], Avg: -77.6704 (0.851)
Ep: 8, Reward: -51.7922, Test: -55.1000 [27.62], Avg: -78.2314 (0.834)
Ep: 9, Reward: -53.0626, Test: -34.4953 [28.30], Avg: -76.6881 (0.817)
Ep: 10, Reward: -52.9025, Test: -41.5511 [32.18], Avg: -76.4192 (0.801)
Ep: 11, Reward: -64.2121, Test: -38.4544 [29.71], Avg: -75.7315 (0.785)
Ep: 12, Reward: -53.6470, Test: -64.0229 [16.39], Avg: -76.0918 (0.769)
Ep: 13, Reward: -51.4795, Test: -60.2097 [34.44], Avg: -77.4175 (0.754)
Ep: 14, Reward: -66.3487, Test: -39.0572 [23.10], Avg: -76.4004 (0.739)
Ep: 15, Reward: -48.7779, Test: -55.3645 [17.70], Avg: -76.1921 (0.724)
Ep: 16, Reward: -40.7873, Test: -54.8214 [12.96], Avg: -75.6972 (0.709)
Ep: 17, Reward: -53.6803, Test: -52.4291 [38.55], Avg: -76.5461 (0.695)
Ep: 18, Reward: -53.8102, Test: -50.1670 [20.55], Avg: -76.2395 (0.681)
Ep: 19, Reward: -41.2884, Test: -35.9311 [24.42], Avg: -75.4453 (0.668)
Ep: 20, Reward: -40.3578, Test: -47.1924 [55.36], Avg: -76.7362 (0.654)
Ep: 21, Reward: -57.4850, Test: -50.2477 [39.77], Avg: -77.3398 (0.641)
Ep: 22, Reward: -48.6475, Test: -40.9068 [22.64], Avg: -76.7400 (0.628)
Ep: 23, Reward: -48.7021, Test: -32.8109 [62.97], Avg: -77.5334 (0.616)
Ep: 24, Reward: -44.3310, Test: -38.3240 [48.71], Avg: -77.9135 (0.603)
Ep: 25, Reward: -42.2759, Test: -41.2700 [44.32], Avg: -78.2088 (0.591)
Ep: 26, Reward: -41.3674, Test: -27.7021 [52.93], Avg: -78.2983 (0.580)
Ep: 27, Reward: -25.9122, Test: -47.8564 [60.31], Avg: -79.3649 (0.568)
Ep: 28, Reward: -29.9152, Test: -15.6995 [51.72], Avg: -78.9529 (0.557)
Ep: 29, Reward: -37.5588, Test: -22.5213 [47.73], Avg: -78.6630 (0.545)
Ep: 30, Reward: -31.6055, Test: -3.9552 [30.51], Avg: -77.2373 (0.535)
Ep: 31, Reward: -22.4734, Test: 3.8272 [45.34], Avg: -76.1211 (0.524)
Ep: 32, Reward: -10.0798, Test: -26.8068 [41.71], Avg: -75.8905 (0.513)
Ep: 33, Reward: -8.1518, Test: -15.7513 [40.42], Avg: -75.3105 (0.503)
Ep: 34, Reward: 4.6290, Test: 58.4537 [66.10], Avg: -73.3773 (0.493)
Ep: 35, Reward: 19.9638, Test: 9.8047 [67.75], Avg: -72.9488 (0.483)
Ep: 36, Reward: 52.4589, Test: 46.3449 [99.94], Avg: -72.4257 (0.474)
Ep: 37, Reward: 55.4453, Test: -18.5250 [63.72], Avg: -72.6841 (0.464)
Ep: 38, Reward: 74.9833, Test: 64.7834 [96.65], Avg: -71.6376 (0.455)
Ep: 39, Reward: 55.9803, Test: 42.1365 [100.92], Avg: -71.3163 (0.446)
Ep: 40, Reward: 23.2060, Test: 60.3459 [118.64], Avg: -70.9988 (0.437)
Ep: 41, Reward: 47.6585, Test: 72.7244 [67.00], Avg: -69.1721 (0.428)
Ep: 42, Reward: 39.3657, Test: 75.2542 [85.96], Avg: -67.8125 (0.419)
Ep: 43, Reward: 98.1826, Test: 60.8411 [144.02], Avg: -68.1617 (0.411)
Ep: 44, Reward: 76.0784, Test: 97.6659 [87.37], Avg: -66.4182 (0.403)
Ep: 45, Reward: 61.0028, Test: 67.0302 [96.16], Avg: -65.6076 (0.395)
Ep: 46, Reward: 57.1753, Test: 42.1976 [95.93], Avg: -65.3549 (0.387)
Ep: 47, Reward: 29.2534, Test: 13.1077 [89.96], Avg: -65.5945 (0.379)
Ep: 48, Reward: 5.0960, Test: 28.4870 [93.10], Avg: -65.5744 (0.372)
Ep: 49, Reward: 23.1000, Test: -0.8871 [38.14], Avg: -65.0434 (0.364)
Ep: 50, Reward: -14.8135, Test: 29.0248 [75.30], Avg: -64.6753 (0.357)
Ep: 51, Reward: 48.7319, Test: -20.3451 [34.52], Avg: -64.4867 (0.350)
Ep: 52, Reward: 4.7987, Test: 13.1793 [90.52], Avg: -64.7293 (0.343)
Ep: 53, Reward: -15.6871, Test: 116.6453 [168.87], Avg: -64.4977 (0.336)
Ep: 54, Reward: 77.4594, Test: 47.2918 [110.04], Avg: -64.4658 (0.329)
Ep: 55, Reward: 7.0748, Test: 102.7153 [144.97], Avg: -64.0692 (0.323)
Ep: 56, Reward: 57.3334, Test: 119.3380 [108.36], Avg: -62.7526 (0.316)
Ep: 57, Reward: 63.3214, Test: 86.2885 [96.49], Avg: -61.8467 (0.310)
Ep: 58, Reward: 73.1942, Test: 155.5487 [168.58], Avg: -61.0193 (0.304)
Ep: 59, Reward: 92.9468, Test: 109.6952 [112.37], Avg: -60.0468 (0.298)
Ep: 60, Reward: 209.6130, Test: 146.9191 [158.07], Avg: -59.2452 (0.292)
Ep: 61, Reward: 283.7098, Test: 237.0056 [163.05], Avg: -57.0968 (0.286)
Ep: 62, Reward: 164.4217, Test: 238.9058 [150.29], Avg: -54.7839 (0.280)
Ep: 63, Reward: 213.5527, Test: 192.3054 [183.80], Avg: -53.7950 (0.274)
Ep: 64, Reward: 238.5550, Test: 217.9513 [204.48], Avg: -52.7601 (0.269)
Ep: 65, Reward: 143.7586, Test: 259.4089 [266.78], Avg: -52.0724 (0.264)
Ep: 66, Reward: 167.2917, Test: 256.6082 [190.07], Avg: -50.3021 (0.258)
Ep: 67, Reward: 202.2196, Test: 180.5186 [157.70], Avg: -49.2268 (0.253)
Ep: 68, Reward: 192.6367, Test: 201.9100 [157.89], Avg: -47.8754 (0.248)
Ep: 69, Reward: 291.0562, Test: 183.6152 [289.37], Avg: -48.7022 (0.243)
Ep: 70, Reward: 246.0769, Test: 190.2421 [207.17], Avg: -48.2547 (0.238)
Ep: 71, Reward: 256.1635, Test: 315.7760 [237.88], Avg: -46.5026 (0.233)
Ep: 72, Reward: 335.0056, Test: 275.9762 [217.44], Avg: -45.0638 (0.229)
Ep: 73, Reward: 307.0174, Test: 268.4870 [265.89], Avg: -44.4197 (0.224)
Ep: 74, Reward: 261.6840, Test: 444.5646 [273.67], Avg: -41.5489 (0.220)
Ep: 75, Reward: 326.7534, Test: 293.0677 [236.62], Avg: -40.2595 (0.215)
Ep: 76, Reward: 224.7250, Test: 222.2568 [166.89], Avg: -39.0176 (0.211)
Ep: 77, Reward: 239.9299, Test: 273.7457 [266.63], Avg: -38.4262 (0.207)
Ep: 78, Reward: 245.7923, Test: 378.7385 [265.90], Avg: -36.5114 (0.203)
Ep: 79, Reward: 277.1230, Test: 315.1521 [238.25], Avg: -35.0937 (0.199)
Ep: 80, Reward: 415.6678, Test: 423.3563 [194.85], Avg: -31.8393 (0.195)
Ep: 81, Reward: 417.5340, Test: 448.9684 [161.90], Avg: -27.9502 (0.191)
Ep: 82, Reward: 371.0064, Test: 362.4527 [253.93], Avg: -26.3060 (0.187)
Ep: 83, Reward: 418.3804, Test: 464.4184 [259.96], Avg: -23.5589 (0.183)
Ep: 84, Reward: 357.9585, Test: 387.2630 [274.63], Avg: -21.9566 (0.180)
Ep: 85, Reward: 305.1632, Test: 304.7513 [162.54], Avg: -20.0477 (0.176)
Ep: 86, Reward: 433.2768, Test: 406.0583 [166.03], Avg: -17.0584 (0.172)
Ep: 87, Reward: 430.0312, Test: 522.5411 [268.28], Avg: -13.9751 (0.169)
Ep: 88, Reward: 419.4897, Test: 445.2123 [243.15], Avg: -11.5477 (0.166)
Ep: 89, Reward: 509.6545, Test: 527.1395 [250.40], Avg: -8.3446 (0.162)
Ep: 90, Reward: 446.7093, Test: 414.5302 [231.65], Avg: -6.2432 (0.159)
Ep: 91, Reward: 400.4377, Test: 288.0738 [186.08], Avg: -5.0668 (0.156)
Ep: 92, Reward: 312.9540, Test: 251.3792 [132.03], Avg: -3.7289 (0.153)
Ep: 93, Reward: 287.4717, Test: 286.6873 [211.73], Avg: -2.8919 (0.150)
Ep: 94, Reward: 323.8646, Test: 260.5417 [210.22], Avg: -2.3318 (0.147)
Ep: 95, Reward: 400.8774, Test: 299.2337 [168.28], Avg: -0.9433 (0.144)
Ep: 96, Reward: 343.2709, Test: 310.1727 [160.80], Avg: 0.6063 (0.141)
Ep: 97, Reward: 274.4898, Test: 320.3021 [185.82], Avg: 1.9724 (0.138)
Ep: 98, Reward: 250.2021, Test: 398.5641 [217.42], Avg: 3.7822 (0.135)
Ep: 99, Reward: 372.9828, Test: 307.3406 [201.86], Avg: 4.7992 (0.133)
Ep: 100, Reward: 301.6646, Test: 348.2882 [161.17], Avg: 6.6043 (0.130)
Ep: 101, Reward: 276.7774, Test: 302.4877 [156.17], Avg: 7.9740 (0.127)
Ep: 102, Reward: 339.5694, Test: 309.2064 [158.29], Avg: 9.3618 (0.125)
Ep: 103, Reward: 321.2882, Test: 422.8546 [227.33], Avg: 11.1519 (0.122)
Ep: 104, Reward: 217.5666, Test: 352.3652 [206.06], Avg: 12.4390 (0.120)
Ep: 105, Reward: 242.1904, Test: 220.6744 [110.30], Avg: 13.3630 (0.117)
Ep: 106, Reward: 287.2673, Test: 222.5726 [159.13], Avg: 13.8310 (0.115)
Ep: 107, Reward: 278.1635, Test: 302.2939 [251.46], Avg: 14.1736 (0.113)
Ep: 108, Reward: 286.9464, Test: 177.3434 [142.14], Avg: 14.3666 (0.111)
Ep: 109, Reward: 313.8985, Test: 293.3058 [82.46], Avg: 16.1528 (0.108)
Ep: 110, Reward: 424.3828, Test: 426.6670 [206.51], Avg: 17.9907 (0.106)
Ep: 111, Reward: 342.9838, Test: 231.6707 [213.44], Avg: 17.9928 (0.104)
Ep: 112, Reward: 289.2822, Test: 191.3465 [123.00], Avg: 18.4384 (0.102)
Ep: 113, Reward: 289.6305, Test: 332.4865 [129.13], Avg: 20.0605 (0.100)
Ep: 114, Reward: 322.8656, Test: 374.3433 [214.42], Avg: 21.2767 (0.098)
Ep: 115, Reward: 271.5157, Test: 264.1105 [162.14], Avg: 21.9724 (0.096)
Ep: 116, Reward: 240.9852, Test: 190.3103 [96.27], Avg: 22.5884 (0.094)
Ep: 117, Reward: 237.4670, Test: 239.6826 [129.27], Avg: 23.3326 (0.092)
Ep: 118, Reward: 275.8865, Test: 114.6228 [121.13], Avg: 23.0819 (0.090)
Ep: 119, Reward: 294.7551, Test: 233.3402 [127.53], Avg: 23.7713 (0.089)
Ep: 120, Reward: 339.6651, Test: 284.8736 [94.24], Avg: 25.1503 (0.087)
Ep: 121, Reward: 377.3817, Test: 312.1450 [140.21], Avg: 26.3535 (0.085)
Ep: 122, Reward: 398.8673, Test: 352.3731 [247.13], Avg: 26.9949 (0.083)
Ep: 123, Reward: 355.0066, Test: 308.5319 [192.26], Avg: 27.7149 (0.080)
Ep: 124, Reward: 284.5051, Test: 238.4124 [119.16], Avg: 28.4471 (0.078)
Ep: 125, Reward: 311.7859, Test: 198.7298 [130.27], Avg: 28.7647 (0.077)
Ep: 126, Reward: 230.1679, Test: 281.6048 [160.07], Avg: 29.4952 (0.075)
Ep: 127, Reward: 222.7265, Test: 202.2190 [122.88], Avg: 29.8846 (0.074)
Ep: 128, Reward: 273.7157, Test: 467.0211 [182.10], Avg: 31.8616 (0.072)
Ep: 129, Reward: 384.0295, Test: 560.9675 [167.24], Avg: 34.6452 (0.071)
Ep: 130, Reward: 499.0867, Test: 468.0355 [221.50], Avg: 36.2627 (0.069)
Ep: 131, Reward: 529.1260, Test: 572.6132 [195.36], Avg: 38.8460 (0.068)
Ep: 132, Reward: 414.1638, Test: 608.4101 [178.48], Avg: 41.7865 (0.067)
Ep: 133, Reward: 555.7556, Test: 726.1543 [139.12], Avg: 45.8555 (0.065)
Ep: 134, Reward: 632.4258, Test: 542.8301 [260.55], Avg: 47.6068 (0.064)
Ep: 135, Reward: 543.6780, Test: 481.9009 [269.12], Avg: 48.8213 (0.063)
Ep: 136, Reward: 574.2755, Test: 397.7130 [174.41], Avg: 50.0949 (0.062)
Ep: 137, Reward: 478.1178, Test: 319.9705 [170.57], Avg: 50.8145 (0.060)
Ep: 138, Reward: 527.8760, Test: 674.3386 [173.77], Avg: 54.0501 (0.059)
Ep: 139, Reward: 549.5403, Test: 457.7104 [235.84], Avg: 55.2488 (0.058)
Ep: 140, Reward: 581.6970, Test: 592.8996 [230.99], Avg: 57.4237 (0.057)
Ep: 141, Reward: 535.5899, Test: 450.6998 [307.80], Avg: 58.0256 (0.056)
Ep: 142, Reward: 467.9816, Test: 524.8265 [280.02], Avg: 59.3318 (0.055)
Ep: 143, Reward: 561.6611, Test: 343.2311 [140.83], Avg: 60.3253 (0.053)
Ep: 144, Reward: 542.2868, Test: 471.7657 [280.42], Avg: 61.2289 (0.052)
Ep: 145, Reward: 542.2001, Test: 679.2020 [231.72], Avg: 63.8745 (0.051)
Ep: 146, Reward: 667.6454, Test: 540.0860 [231.38], Avg: 65.5400 (0.050)
Ep: 147, Reward: 605.4685, Test: 593.7986 [228.70], Avg: 67.5640 (0.049)
Ep: 148, Reward: 541.3778, Test: 363.5287 [227.28], Avg: 68.0250 (0.048)
Ep: 149, Reward: 413.4651, Test: 520.2024 [237.24], Avg: 69.4579 (0.047)
Ep: 150, Reward: 490.7124, Test: 546.8519 [248.22], Avg: 70.9756 (0.046)
Ep: 151, Reward: 317.1656, Test: 212.4469 [154.86], Avg: 70.8876 (0.045)
Ep: 152, Reward: 253.2805, Test: 222.2294 [143.39], Avg: 70.9395 (0.045)
Ep: 153, Reward: 317.3868, Test: 254.0400 [149.67], Avg: 71.1566 (0.044)
Ep: 154, Reward: 365.1051, Test: 338.7537 [222.51], Avg: 71.4475 (0.043)
Ep: 155, Reward: 407.6456, Test: 476.0136 [227.63], Avg: 72.5817 (0.042)
Ep: 156, Reward: 359.0428, Test: 266.0424 [152.87], Avg: 72.8403 (0.041)
Ep: 157, Reward: 293.8003, Test: 206.2184 [176.92], Avg: 72.5647 (0.040)
Ep: 158, Reward: 316.4156, Test: 284.9284 [137.89], Avg: 73.0331 (0.039)
Ep: 159, Reward: 295.9545, Test: 540.2469 [182.44], Avg: 74.8129 (0.039)
Ep: 160, Reward: 376.8508, Test: 254.5588 [182.73], Avg: 74.7944 (0.038)
Ep: 161, Reward: 372.6844, Test: 385.0241 [140.77], Avg: 75.8404 (0.037)
Ep: 162, Reward: 389.5001, Test: 335.5228 [216.50], Avg: 76.1054 (0.036)
Ep: 163, Reward: 389.0054, Test: 396.3815 [127.85], Avg: 77.2787 (0.036)
Ep: 164, Reward: 313.9880, Test: 328.0829 [175.99], Avg: 77.7321 (0.035)
Ep: 165, Reward: 371.5517, Test: 237.5141 [117.39], Avg: 77.9875 (0.034)
Ep: 166, Reward: 350.2501, Test: 265.6213 [125.27], Avg: 78.3610 (0.034)
Ep: 167, Reward: 283.7882, Test: 265.5744 [146.81], Avg: 78.6015 (0.033)
Ep: 168, Reward: 311.8696, Test: 432.6651 [217.89], Avg: 79.4073 (0.032)
Ep: 169, Reward: 326.9626, Test: 589.4709 [151.61], Avg: 81.5158 (0.032)
Ep: 170, Reward: 436.7445, Test: 297.1199 [266.04], Avg: 81.2209 (0.031)
Ep: 171, Reward: 423.2154, Test: 324.6073 [233.28], Avg: 81.2797 (0.030)
Ep: 172, Reward: 328.0744, Test: 295.7770 [182.40], Avg: 81.4652 (0.030)
Ep: 173, Reward: 388.5120, Test: 312.9612 [179.45], Avg: 81.7643 (0.029)
Ep: 174, Reward: 454.1987, Test: 356.6185 [191.30], Avg: 82.2418 (0.029)
Ep: 175, Reward: 297.7524, Test: 412.2915 [248.36], Avg: 82.7059 (0.028)
Ep: 176, Reward: 405.6377, Test: 406.4707 [247.06], Avg: 83.1393 (0.027)
Ep: 177, Reward: 362.2230, Test: 333.7469 [139.61], Avg: 83.7629 (0.027)
Ep: 178, Reward: 384.7401, Test: 465.8979 [209.09], Avg: 84.7296 (0.026)
Ep: 179, Reward: 354.0437, Test: 403.0704 [125.94], Avg: 85.7985 (0.026)
Ep: 180, Reward: 395.7732, Test: 422.4821 [188.11], Avg: 86.6194 (0.025)
Ep: 181, Reward: 399.4839, Test: 596.0889 [255.52], Avg: 88.0147 (0.025)
Ep: 182, Reward: 506.9950, Test: 405.4074 [179.82], Avg: 88.7665 (0.024)
Ep: 183, Reward: 370.5813, Test: 192.4542 [104.90], Avg: 88.7599 (0.024)
Ep: 184, Reward: 266.8685, Test: 315.6828 [117.20], Avg: 89.3530 (0.023)
Ep: 185, Reward: 236.1927, Test: 253.2639 [166.83], Avg: 89.3373 (0.023)
Ep: 186, Reward: 272.9073, Test: 285.2148 [118.25], Avg: 89.7524 (0.022)
Ep: 187, Reward: 339.8409, Test: 315.8228 [193.68], Avg: 89.9247 (0.022)
Ep: 188, Reward: 371.4607, Test: 375.0115 [142.57], Avg: 90.6787 (0.022)
Ep: 189, Reward: 371.7975, Test: 365.9989 [166.41], Avg: 91.2520 (0.021)
Ep: 190, Reward: 403.9581, Test: 369.6534 [199.84], Avg: 91.6633 (0.021)
Ep: 191, Reward: 366.3046, Test: 341.7579 [201.61], Avg: 91.9158 (0.020)
Ep: 192, Reward: 295.6754, Test: 294.0002 [182.04], Avg: 92.0197 (0.020)
Ep: 193, Reward: 340.5498, Test: 415.8138 [246.30], Avg: 92.4191 (0.020)
Ep: 194, Reward: 327.9673, Test: 354.1965 [170.78], Avg: 92.8858 (0.020)
Ep: 195, Reward: 378.5677, Test: 425.3391 [251.94], Avg: 93.2965 (0.020)
Ep: 196, Reward: 409.3621, Test: 344.9329 [184.64], Avg: 93.6367 (0.020)
Ep: 197, Reward: 398.8260, Test: 303.0341 [73.17], Avg: 94.3247 (0.020)
Ep: 198, Reward: 461.8062, Test: 414.4836 [206.15], Avg: 94.8976 (0.020)
Ep: 199, Reward: 488.6101, Test: 265.8267 [153.97], Avg: 94.9824 (0.020)
Ep: 200, Reward: 342.0550, Test: 327.1944 [194.22], Avg: 95.1714 (0.020)
Ep: 201, Reward: 381.2740, Test: 426.8121 [139.93], Avg: 96.1205 (0.020)
Ep: 202, Reward: 314.2263, Test: 487.7844 [193.56], Avg: 97.0963 (0.020)
Ep: 203, Reward: 387.1354, Test: 219.2340 [104.59], Avg: 97.1824 (0.020)
Ep: 204, Reward: 329.6981, Test: 333.0591 [191.80], Avg: 97.3974 (0.020)
Ep: 205, Reward: 311.6041, Test: 292.8244 [200.29], Avg: 97.3738 (0.020)
Ep: 206, Reward: 283.1782, Test: 403.5192 [259.87], Avg: 97.5973 (0.020)
Ep: 207, Reward: 324.3237, Test: 251.3686 [196.12], Avg: 97.3937 (0.020)
Ep: 208, Reward: 188.0698, Test: 347.0650 [176.72], Avg: 97.7427 (0.020)
Ep: 209, Reward: 440.6350, Test: 361.7737 [184.71], Avg: 98.1204 (0.020)
Ep: 210, Reward: 374.9904, Test: 302.1931 [224.55], Avg: 98.0234 (0.020)
Ep: 211, Reward: 362.5987, Test: 152.0082 [103.90], Avg: 97.7880 (0.020)
Ep: 212, Reward: 305.1905, Test: 206.9974 [199.19], Avg: 97.3655 (0.020)
Ep: 213, Reward: 381.7001, Test: 332.9849 [148.66], Avg: 97.7719 (0.020)
Ep: 214, Reward: 417.2250, Test: 331.5876 [140.67], Avg: 98.2051 (0.020)
Ep: 215, Reward: 525.8412, Test: 381.9149 [84.84], Avg: 99.1258 (0.020)
Ep: 216, Reward: 405.9181, Test: 557.8176 [205.49], Avg: 100.2926 (0.020)
Ep: 217, Reward: 617.4212, Test: 298.7430 [122.86], Avg: 100.6394 (0.020)
Ep: 218, Reward: 310.5917, Test: 529.7496 [253.50], Avg: 101.4412 (0.020)
Ep: 219, Reward: 486.4990, Test: 444.0341 [202.59], Avg: 102.0776 (0.020)
Ep: 220, Reward: 449.5063, Test: 358.2244 [242.26], Avg: 102.1404 (0.020)
Ep: 221, Reward: 343.9210, Test: 262.3843 [181.33], Avg: 102.0455 (0.020)
Ep: 222, Reward: 325.0472, Test: 353.5192 [152.19], Avg: 102.4907 (0.020)
Ep: 223, Reward: 350.3166, Test: 428.5600 [168.23], Avg: 103.1953 (0.020)
Ep: 224, Reward: 451.6054, Test: 566.3820 [227.33], Avg: 104.2436 (0.020)
Ep: 225, Reward: 355.9755, Test: 338.5634 [156.42], Avg: 104.5882 (0.020)
Ep: 226, Reward: 365.6801, Test: 270.8235 [187.57], Avg: 104.4943 (0.020)
Ep: 227, Reward: 277.6255, Test: 446.9949 [210.20], Avg: 105.0745 (0.020)
Ep: 228, Reward: 440.7971, Test: 407.8858 [245.85], Avg: 105.3233 (0.020)
Ep: 229, Reward: 403.9004, Test: 335.8286 [119.64], Avg: 105.8053 (0.020)
Ep: 230, Reward: 202.3134, Test: 288.6113 [183.59], Avg: 105.8019 (0.020)
Ep: 231, Reward: 367.6115, Test: 383.8870 [250.30], Avg: 105.9216 (0.020)
Ep: 232, Reward: 345.4122, Test: 291.0624 [237.25], Avg: 105.6980 (0.020)
Ep: 233, Reward: 282.3682, Test: 289.5008 [135.67], Avg: 105.9037 (0.020)
Ep: 234, Reward: 326.2645, Test: 320.5288 [212.11], Avg: 105.9144 (0.020)
Ep: 235, Reward: 255.6801, Test: 319.0291 [119.70], Avg: 106.3102 (0.020)
Ep: 236, Reward: 384.0088, Test: 498.4652 [210.46], Avg: 107.0769 (0.020)
Ep: 237, Reward: 398.0613, Test: 433.2139 [231.96], Avg: 107.4726 (0.020)
Ep: 238, Reward: 320.7741, Test: 288.0244 [223.55], Avg: 107.2927 (0.020)
Ep: 239, Reward: 300.8979, Test: 180.8736 [151.97], Avg: 106.9661 (0.020)
Ep: 240, Reward: 293.4760, Test: 250.1739 [43.03], Avg: 107.3817 (0.020)
Ep: 241, Reward: 294.3896, Test: 272.0696 [194.00], Avg: 107.2606 (0.020)
Ep: 242, Reward: 198.9404, Test: 286.4956 [187.34], Avg: 107.2272 (0.020)
Ep: 243, Reward: 261.4754, Test: 241.1446 [113.45], Avg: 107.3111 (0.020)
Ep: 244, Reward: 276.3733, Test: 327.7504 [131.91], Avg: 107.6725 (0.020)
Ep: 245, Reward: 250.2208, Test: 281.6237 [96.34], Avg: 107.9880 (0.020)
Ep: 246, Reward: 192.7105, Test: 362.6427 [195.35], Avg: 108.2281 (0.020)
Ep: 247, Reward: 268.2925, Test: 186.0589 [121.29], Avg: 108.0528 (0.020)
Ep: 248, Reward: 164.6226, Test: 371.4475 [160.54], Avg: 108.4659 (0.020)
Ep: 249, Reward: 245.2059, Test: 352.2735 [172.53], Avg: 108.7510 (0.020)
Ep: 250, Reward: 291.4019, Test: 343.7319 [208.99], Avg: 108.8545 (0.020)
Ep: 251, Reward: 225.1199, Test: 289.0043 [203.71], Avg: 108.7610 (0.020)
Ep: 252, Reward: 255.6930, Test: 344.4837 [203.03], Avg: 108.8903 (0.020)
Ep: 253, Reward: 194.9115, Test: 233.6582 [169.13], Avg: 108.7156 (0.020)
Ep: 254, Reward: 227.7629, Test: 235.7918 [184.25], Avg: 108.4914 (0.020)
Ep: 255, Reward: 283.7268, Test: 339.1194 [150.35], Avg: 108.8049 (0.020)
Ep: 256, Reward: 434.5270, Test: 522.3544 [193.16], Avg: 109.6625 (0.020)
Ep: 257, Reward: 574.3617, Test: 794.8679 [85.04], Avg: 111.9887 (0.020)
Ep: 258, Reward: 766.7279, Test: 624.9968 [190.89], Avg: 113.2324 (0.020)
Ep: 259, Reward: 705.5469, Test: 646.6808 [182.66], Avg: 114.5816 (0.020)
Ep: 260, Reward: 721.9124, Test: 598.5098 [247.95], Avg: 115.4857 (0.020)
Ep: 261, Reward: 564.1173, Test: 290.8744 [85.25], Avg: 115.8297 (0.020)
Ep: 262, Reward: 396.2874, Test: 463.0129 [221.72], Avg: 116.3068 (0.020)
Ep: 263, Reward: 497.5953, Test: 545.3365 [169.39], Avg: 117.2903 (0.020)
Ep: 264, Reward: 581.7571, Test: 662.3547 [164.59], Avg: 118.7260 (0.020)
Ep: 265, Reward: 724.1597, Test: 577.2914 [194.78], Avg: 119.7177 (0.020)
Ep: 266, Reward: 715.1385, Test: 755.1569 [220.08], Avg: 121.2733 (0.020)
Ep: 267, Reward: 697.4278, Test: 554.2227 [192.81], Avg: 122.1694 (0.020)
Ep: 268, Reward: 602.9539, Test: 416.1444 [139.23], Avg: 122.7446 (0.020)
Ep: 269, Reward: 518.7841, Test: 643.1795 [163.88], Avg: 124.0652 (0.020)
Ep: 270, Reward: 628.2209, Test: 616.4492 [225.16], Avg: 125.0513 (0.020)
Ep: 271, Reward: 541.1898, Test: 519.4912 [207.56], Avg: 125.7383 (0.020)
Ep: 272, Reward: 448.9848, Test: 372.3043 [195.72], Avg: 125.9246 (0.020)
Ep: 273, Reward: 461.8600, Test: 358.6852 [109.75], Avg: 126.3735 (0.020)
Ep: 274, Reward: 445.3401, Test: 574.1727 [247.63], Avg: 127.1014 (0.020)
Ep: 275, Reward: 517.5850, Test: 556.5030 [213.84], Avg: 127.8825 (0.020)
Ep: 276, Reward: 568.2312, Test: 706.6241 [195.31], Avg: 129.2667 (0.020)
Ep: 277, Reward: 690.4735, Test: 706.6888 [194.42], Avg: 130.6444 (0.020)
Ep: 278, Reward: 697.3365, Test: 655.1094 [159.86], Avg: 131.9512 (0.020)
Ep: 279, Reward: 645.9600, Test: 540.9129 [226.20], Avg: 132.6039 (0.020)
Ep: 280, Reward: 539.0043, Test: 671.5972 [211.65], Avg: 133.7689 (0.020)
Ep: 281, Reward: 676.0007, Test: 719.2861 [146.71], Avg: 135.3249 (0.020)
Ep: 282, Reward: 753.5638, Test: 642.5281 [208.97], Avg: 136.3787 (0.020)
Ep: 283, Reward: 772.3630, Test: 728.7370 [183.70], Avg: 137.8177 (0.020)
Ep: 284, Reward: 802.1453, Test: 728.5862 [215.03], Avg: 139.1360 (0.020)
Ep: 285, Reward: 817.7041, Test: 746.4689 [204.88], Avg: 140.5432 (0.020)
Ep: 286, Reward: 685.8505, Test: 679.3656 [261.08], Avg: 141.5110 (0.020)
Ep: 287, Reward: 543.7602, Test: 798.4961 [119.53], Avg: 143.3771 (0.020)
Ep: 288, Reward: 716.5334, Test: 836.9866 [100.67], Avg: 145.4288 (0.020)
Ep: 289, Reward: 747.3318, Test: 531.2172 [246.13], Avg: 145.9104 (0.020)
Ep: 290, Reward: 472.4348, Test: 475.6585 [216.94], Avg: 146.2980 (0.020)
Ep: 291, Reward: 494.5663, Test: 430.8730 [172.48], Avg: 146.6819 (0.020)
Ep: 292, Reward: 384.9665, Test: 494.2971 [293.55], Avg: 146.8664 (0.020)
Ep: 293, Reward: 486.6610, Test: 316.2940 [191.83], Avg: 146.7902 (0.020)
Ep: 294, Reward: 491.7172, Test: 362.3399 [216.93], Avg: 146.7855 (0.020)
Ep: 295, Reward: 550.6092, Test: 729.6623 [197.70], Avg: 148.0868 (0.020)
Ep: 296, Reward: 660.0508, Test: 816.3393 [77.10], Avg: 150.0772 (0.020)
Ep: 297, Reward: 795.6042, Test: 615.8314 [204.05], Avg: 150.9554 (0.020)
Ep: 298, Reward: 685.6507, Test: 632.9163 [200.55], Avg: 151.8966 (0.020)
Ep: 299, Reward: 777.3550, Test: 733.9392 [204.95], Avg: 153.1536 (0.020)
Ep: 300, Reward: 697.5422, Test: 817.7356 [89.72], Avg: 155.0634 (0.020)
Ep: 301, Reward: 696.7463, Test: 714.4253 [197.09], Avg: 156.2630 (0.020)
Ep: 302, Reward: 689.2684, Test: 620.2335 [181.10], Avg: 157.1966 (0.020)
Ep: 303, Reward: 538.7842, Test: 432.6896 [266.21], Avg: 157.2271 (0.020)
Ep: 304, Reward: 448.5313, Test: 668.2193 [137.61], Avg: 158.4513 (0.020)
Ep: 305, Reward: 534.0074, Test: 496.1525 [147.44], Avg: 159.0730 (0.020)
Ep: 306, Reward: 452.0077, Test: 524.9863 [206.60], Avg: 159.5920 (0.020)
Ep: 307, Reward: 645.4797, Test: 724.2579 [198.26], Avg: 160.7816 (0.020)
Ep: 308, Reward: 661.4923, Test: 584.0776 [254.03], Avg: 161.3294 (0.020)
Ep: 309, Reward: 550.1284, Test: 582.1184 [199.03], Avg: 162.0447 (0.020)
Ep: 310, Reward: 714.5586, Test: 697.4423 [210.51], Avg: 163.0894 (0.020)
Ep: 311, Reward: 700.1428, Test: 621.9607 [184.22], Avg: 163.9697 (0.020)
Ep: 312, Reward: 559.5152, Test: 575.9021 [156.79], Avg: 164.7848 (0.020)
Ep: 313, Reward: 672.9914, Test: 681.7143 [178.37], Avg: 165.8630 (0.020)
Ep: 314, Reward: 613.5513, Test: 658.1304 [203.96], Avg: 166.7783 (0.020)
Ep: 315, Reward: 638.7232, Test: 548.1204 [121.11], Avg: 167.6018 (0.020)
Ep: 316, Reward: 557.3057, Test: 614.9435 [266.37], Avg: 168.1727 (0.020)
Ep: 317, Reward: 706.6991, Test: 693.8887 [210.73], Avg: 169.1632 (0.020)
Ep: 318, Reward: 543.5262, Test: 492.7688 [241.91], Avg: 169.4193 (0.020)
Ep: 319, Reward: 710.5775, Test: 677.3271 [179.42], Avg: 170.4458 (0.020)
Ep: 320, Reward: 779.6736, Test: 644.4427 [187.53], Avg: 171.3382 (0.020)
Ep: 321, Reward: 706.4147, Test: 800.9059 [91.55], Avg: 173.0091 (0.020)
Ep: 322, Reward: 633.3247, Test: 654.8505 [215.64], Avg: 173.8333 (0.020)
Ep: 323, Reward: 521.5641, Test: 571.7091 [286.06], Avg: 174.1784 (0.020)
Ep: 324, Reward: 642.7781, Test: 625.9393 [224.45], Avg: 174.8778 (0.020)
Ep: 325, Reward: 676.3360, Test: 598.5472 [254.40], Avg: 175.3970 (0.020)
Ep: 326, Reward: 641.3871, Test: 541.2092 [270.71], Avg: 175.6878 (0.020)
Ep: 327, Reward: 456.6455, Test: 541.3954 [250.70], Avg: 176.0385 (0.020)
Ep: 328, Reward: 482.8194, Test: 402.1669 [207.91], Avg: 176.0939 (0.020)
Ep: 329, Reward: 430.5532, Test: 350.4395 [158.32], Avg: 176.1424 (0.020)
Ep: 330, Reward: 341.7270, Test: 428.0922 [180.49], Avg: 176.3583 (0.020)
Ep: 331, Reward: 577.6940, Test: 513.5070 [289.54], Avg: 176.5017 (0.020)
Ep: 332, Reward: 654.6112, Test: 443.0999 [189.36], Avg: 176.7337 (0.020)
Ep: 333, Reward: 657.4541, Test: 637.3541 [172.74], Avg: 177.5956 (0.020)
Ep: 334, Reward: 595.4978, Test: 511.1368 [265.86], Avg: 177.7976 (0.020)
Ep: 335, Reward: 482.0034, Test: 473.3843 [241.53], Avg: 177.9585 (0.020)
Ep: 336, Reward: 472.1374, Test: 527.2036 [213.19], Avg: 178.3622 (0.020)
Ep: 337, Reward: 525.7742, Test: 491.1081 [181.93], Avg: 178.7492 (0.020)
Ep: 338, Reward: 355.7159, Test: 352.2161 [163.38], Avg: 178.7790 (0.020)
Ep: 339, Reward: 444.5943, Test: 418.6488 [253.86], Avg: 178.7378 (0.020)
Ep: 340, Reward: 501.9373, Test: 633.9388 [200.08], Avg: 179.4860 (0.020)
Ep: 341, Reward: 630.0007, Test: 634.9941 [157.90], Avg: 180.3562 (0.020)
Ep: 342, Reward: 587.5008, Test: 530.5333 [217.70], Avg: 180.7424 (0.020)
Ep: 343, Reward: 668.0827, Test: 640.7431 [280.03], Avg: 181.2656 (0.020)
Ep: 344, Reward: 647.2892, Test: 528.1914 [204.65], Avg: 181.6780 (0.020)
Ep: 345, Reward: 574.2356, Test: 784.8533 [118.81], Avg: 183.0779 (0.020)
Ep: 346, Reward: 570.0011, Test: 666.2260 [105.63], Avg: 184.1658 (0.020)
Ep: 347, Reward: 555.0287, Test: 785.5066 [160.65], Avg: 185.4322 (0.020)
Ep: 348, Reward: 578.7956, Test: 694.6411 [170.38], Avg: 186.4030 (0.020)
Ep: 349, Reward: 662.6869, Test: 614.2413 [239.43], Avg: 186.9413 (0.020)
Ep: 350, Reward: 672.6856, Test: 599.4572 [262.43], Avg: 187.3689 (0.020)
Ep: 351, Reward: 461.4286, Test: 603.1679 [224.23], Avg: 187.9132 (0.020)
Ep: 352, Reward: 515.9237, Test: 416.0468 [220.42], Avg: 187.9350 (0.020)
Ep: 353, Reward: 473.6355, Test: 317.4628 [109.52], Avg: 187.9915 (0.020)
Ep: 354, Reward: 475.5017, Test: 616.7787 [194.85], Avg: 188.6505 (0.020)
Ep: 355, Reward: 548.0700, Test: 591.3277 [184.23], Avg: 189.2641 (0.020)
Ep: 356, Reward: 611.9888, Test: 684.4276 [184.15], Avg: 190.1353 (0.020)
Ep: 357, Reward: 637.4250, Test: 602.8195 [223.27], Avg: 190.6644 (0.020)
Ep: 358, Reward: 671.1127, Test: 667.0296 [191.43], Avg: 191.4581 (0.020)
Ep: 359, Reward: 743.0699, Test: 602.3001 [247.67], Avg: 191.9113 (0.020)
Ep: 360, Reward: 771.0245, Test: 776.2952 [145.18], Avg: 193.1280 (0.020)
Ep: 361, Reward: 814.5420, Test: 755.5819 [124.85], Avg: 194.3368 (0.020)
Ep: 362, Reward: 843.0959, Test: 620.7911 [252.56], Avg: 194.8159 (0.020)
Ep: 363, Reward: 780.8879, Test: 701.1423 [169.29], Avg: 195.7418 (0.020)
Ep: 364, Reward: 591.6278, Test: 585.8590 [171.35], Avg: 196.3411 (0.020)
Ep: 365, Reward: 717.3290, Test: 590.4976 [275.40], Avg: 196.6656 (0.020)
Ep: 366, Reward: 676.2632, Test: 562.1139 [215.92], Avg: 197.0730 (0.020)
Ep: 367, Reward: 679.3529, Test: 728.5099 [197.18], Avg: 197.9813 (0.020)
Ep: 368, Reward: 593.9461, Test: 670.3913 [193.35], Avg: 198.7376 (0.020)
Ep: 369, Reward: 665.3225, Test: 589.0613 [237.61], Avg: 199.1504 (0.020)
Ep: 370, Reward: 616.6361, Test: 753.0646 [124.33], Avg: 200.3083 (0.020)
Ep: 371, Reward: 624.4369, Test: 620.9295 [154.08], Avg: 201.0248 (0.020)
Ep: 372, Reward: 705.5780, Test: 609.2117 [199.64], Avg: 201.5839 (0.020)
Ep: 373, Reward: 714.5256, Test: 600.9581 [219.55], Avg: 202.0647 (0.020)
Ep: 374, Reward: 695.1940, Test: 744.2229 [176.99], Avg: 203.0385 (0.020)
Ep: 375, Reward: 646.0123, Test: 685.5899 [134.16], Avg: 203.9651 (0.020)
Ep: 376, Reward: 683.3130, Test: 706.1917 [132.92], Avg: 204.9447 (0.020)
Ep: 377, Reward: 671.7648, Test: 647.3873 [200.64], Avg: 205.5844 (0.020)
Ep: 378, Reward: 659.1268, Test: 657.5552 [203.76], Avg: 206.2393 (0.020)
Ep: 379, Reward: 744.6834, Test: 762.5013 [160.77], Avg: 207.2801 (0.020)
Ep: 380, Reward: 692.4640, Test: 694.7560 [172.01], Avg: 208.1081 (0.020)
Ep: 381, Reward: 631.9966, Test: 550.7320 [209.37], Avg: 208.4569 (0.020)
Ep: 382, Reward: 711.9713, Test: 800.0341 [134.36], Avg: 209.6507 (0.020)
Ep: 383, Reward: 716.5585, Test: 487.2423 [178.90], Avg: 209.9077 (0.020)
Ep: 384, Reward: 629.4859, Test: 743.7317 [144.74], Avg: 210.9183 (0.020)
Ep: 385, Reward: 768.6598, Test: 751.3378 [161.16], Avg: 211.9008 (0.020)
Ep: 386, Reward: 719.1978, Test: 657.3481 [157.75], Avg: 212.6442 (0.020)
Ep: 387, Reward: 653.2748, Test: 608.7589 [80.37], Avg: 213.4580 (0.020)
Ep: 388, Reward: 721.8249, Test: 695.1967 [132.14], Avg: 214.3567 (0.020)
Ep: 389, Reward: 708.4544, Test: 644.2296 [228.52], Avg: 214.8730 (0.020)
Ep: 390, Reward: 669.7337, Test: 681.9940 [133.60], Avg: 215.7260 (0.020)
Ep: 391, Reward: 626.6390, Test: 465.0091 [167.59], Avg: 215.9344 (0.020)
Ep: 392, Reward: 587.5358, Test: 701.5940 [176.03], Avg: 216.7223 (0.020)
Ep: 393, Reward: 651.6852, Test: 618.8099 [218.28], Avg: 217.1888 (0.020)
Ep: 394, Reward: 812.0645, Test: 828.8152 [65.70], Avg: 218.5709 (0.020)
Ep: 395, Reward: 860.9496, Test: 833.5622 [107.74], Avg: 219.8518 (0.020)
Ep: 396, Reward: 789.0982, Test: 858.9247 [81.54], Avg: 221.2562 (0.020)
Ep: 397, Reward: 817.1305, Test: 707.2553 [198.42], Avg: 221.9787 (0.020)
Ep: 398, Reward: 794.7484, Test: 735.7059 [185.47], Avg: 222.8014 (0.020)
Ep: 399, Reward: 798.0606, Test: 715.4343 [219.28], Avg: 223.4848 (0.020)
Ep: 400, Reward: 675.6937, Test: 599.9272 [157.89], Avg: 224.0298 (0.020)
Ep: 401, Reward: 572.1492, Test: 691.6232 [181.18], Avg: 224.7423 (0.020)
Ep: 402, Reward: 717.4290, Test: 721.0241 [191.50], Avg: 225.4986 (0.020)
Ep: 403, Reward: 797.9785, Test: 789.7593 [131.68], Avg: 226.5693 (0.020)
Ep: 404, Reward: 843.5880, Test: 775.7651 [186.58], Avg: 227.4647 (0.020)
Ep: 405, Reward: 772.8097, Test: 687.8841 [234.29], Avg: 228.0216 (0.020)
Ep: 406, Reward: 742.3465, Test: 595.2543 [237.16], Avg: 228.3412 (0.020)
Ep: 407, Reward: 648.6444, Test: 548.2228 [252.16], Avg: 228.5072 (0.020)
Ep: 408, Reward: 682.5902, Test: 588.6067 [215.16], Avg: 228.8616 (0.020)
Ep: 409, Reward: 696.0687, Test: 742.4509 [117.13], Avg: 229.8286 (0.020)
Ep: 410, Reward: 648.6872, Test: 476.3763 [224.62], Avg: 229.8819 (0.020)
Ep: 411, Reward: 582.8729, Test: 521.3639 [205.08], Avg: 230.0916 (0.020)
Ep: 412, Reward: 536.4872, Test: 551.2129 [242.76], Avg: 230.2813 (0.020)
Ep: 413, Reward: 533.0600, Test: 564.9007 [211.56], Avg: 230.5786 (0.020)
Ep: 414, Reward: 637.1085, Test: 700.8296 [173.30], Avg: 231.2941 (0.020)
Ep: 415, Reward: 695.2120, Test: 664.8921 [267.80], Avg: 231.6927 (0.020)
Ep: 416, Reward: 591.1646, Test: 520.5514 [270.43], Avg: 231.7369 (0.020)
Ep: 417, Reward: 530.1065, Test: 117.5358 [128.97], Avg: 231.1551 (0.020)
Ep: 418, Reward: 274.7128, Test: 388.3055 [220.60], Avg: 231.0037 (0.020)
Ep: 419, Reward: 472.5815, Test: 450.4009 [181.54], Avg: 231.0938 (0.020)
Ep: 420, Reward: 436.0463, Test: 417.9891 [188.30], Avg: 231.0905 (0.020)
Ep: 421, Reward: 426.4270, Test: 350.3978 [193.90], Avg: 230.9137 (0.020)
Ep: 422, Reward: 509.8934, Test: 577.2918 [213.38], Avg: 231.2282 (0.020)
Ep: 423, Reward: 526.0350, Test: 429.1343 [223.72], Avg: 231.1673 (0.020)
Ep: 424, Reward: 461.2772, Test: 515.9346 [151.48], Avg: 231.4809 (0.020)
Ep: 425, Reward: 544.0849, Test: 288.4251 [233.68], Avg: 231.0660 (0.020)
Ep: 426, Reward: 540.8114, Test: 711.5133 [135.99], Avg: 231.8727 (0.020)
Ep: 427, Reward: 666.8669, Test: 711.7859 [222.18], Avg: 232.4749 (0.020)
Ep: 428, Reward: 686.4719, Test: 677.9547 [123.47], Avg: 233.2255 (0.020)
Ep: 429, Reward: 753.7162, Test: 781.4494 [156.54], Avg: 234.1364 (0.020)
Ep: 430, Reward: 733.0847, Test: 683.3804 [135.68], Avg: 234.8639 (0.020)
Ep: 431, Reward: 760.4394, Test: 721.7646 [188.13], Avg: 235.5555 (0.020)
Ep: 432, Reward: 781.2136, Test: 650.5513 [275.00], Avg: 235.8788 (0.020)
Ep: 433, Reward: 794.7924, Test: 757.2044 [148.30], Avg: 236.7384 (0.020)
Ep: 434, Reward: 774.3449, Test: 831.7778 [55.14], Avg: 237.9795 (0.020)
Ep: 435, Reward: 679.2728, Test: 611.1945 [221.77], Avg: 238.3269 (0.020)
Ep: 436, Reward: 627.6945, Test: 572.6279 [217.89], Avg: 238.5932 (0.020)
Ep: 437, Reward: 634.1816, Test: 806.1041 [39.92], Avg: 239.7978 (0.020)
Ep: 438, Reward: 734.7987, Test: 773.7826 [154.09], Avg: 240.6632 (0.020)
Ep: 439, Reward: 732.6010, Test: 665.0877 [219.73], Avg: 241.1284 (0.020)
Ep: 440, Reward: 647.7477, Test: 630.3967 [180.61], Avg: 241.6015 (0.020)
Ep: 441, Reward: 555.7052, Test: 560.8977 [140.73], Avg: 242.0055 (0.020)
Ep: 442, Reward: 571.8952, Test: 641.4434 [139.99], Avg: 242.5912 (0.020)
Ep: 443, Reward: 616.3801, Test: 433.5100 [179.41], Avg: 242.6171 (0.020)
Ep: 444, Reward: 573.8301, Test: 509.5860 [222.76], Avg: 242.7164 (0.020)
Ep: 445, Reward: 607.6341, Test: 446.3728 [182.65], Avg: 242.7635 (0.020)
Ep: 446, Reward: 422.0672, Test: 400.9857 [192.47], Avg: 242.6869 (0.020)
Ep: 447, Reward: 421.4883, Test: 359.0718 [143.60], Avg: 242.6262 (0.020)
Ep: 448, Reward: 466.6619, Test: 515.7650 [223.72], Avg: 242.7362 (0.020)
Ep: 449, Reward: 587.2250, Test: 506.8209 [177.79], Avg: 242.9280 (0.020)
Ep: 450, Reward: 499.2982, Test: 739.0979 [141.57], Avg: 243.7142 (0.020)
Ep: 451, Reward: 762.8864, Test: 758.6936 [164.17], Avg: 244.4903 (0.020)
Ep: 452, Reward: 788.8263, Test: 765.9947 [216.13], Avg: 245.1645 (0.020)
Ep: 453, Reward: 797.0836, Test: 860.3718 [18.42], Avg: 246.4790 (0.020)
Ep: 454, Reward: 785.7513, Test: 685.0437 [136.66], Avg: 247.1425 (0.020)
Ep: 455, Reward: 651.1391, Test: 628.9449 [236.00], Avg: 247.4623 (0.020)
Ep: 456, Reward: 591.7723, Test: 526.9699 [233.50], Avg: 247.5629 (0.020)
Ep: 457, Reward: 560.3480, Test: 598.9216 [264.91], Avg: 247.7517 (0.020)
Ep: 458, Reward: 507.7130, Test: 495.5373 [244.07], Avg: 247.7598 (0.020)
Ep: 459, Reward: 427.8762, Test: 270.5533 [221.98], Avg: 247.3268 (0.020)
Ep: 460, Reward: 336.8078, Test: 379.1080 [155.62], Avg: 247.2751 (0.020)
Ep: 461, Reward: 371.8325, Test: 383.8197 [197.43], Avg: 247.1433 (0.020)
Ep: 462, Reward: 369.0359, Test: 370.3063 [176.33], Avg: 247.0285 (0.020)
Ep: 463, Reward: 458.3767, Test: 423.4285 [144.25], Avg: 247.0978 (0.020)
Ep: 464, Reward: 359.2070, Test: 346.4623 [189.23], Avg: 246.9045 (0.020)
Ep: 465, Reward: 558.4733, Test: 675.4653 [135.65], Avg: 247.5330 (0.020)
Ep: 466, Reward: 597.6615, Test: 565.0717 [229.98], Avg: 247.7205 (0.020)
Ep: 467, Reward: 596.7619, Test: 757.9665 [123.29], Avg: 248.5474 (0.020)
Ep: 468, Reward: 717.4951, Test: 749.9713 [166.13], Avg: 249.2623 (0.020)
Ep: 469, Reward: 789.0736, Test: 717.3056 [204.72], Avg: 249.8226 (0.020)
Ep: 470, Reward: 722.5006, Test: 747.1691 [202.36], Avg: 250.4488 (0.020)
Ep: 471, Reward: 791.1240, Test: 743.6509 [166.99], Avg: 251.1400 (0.020)
Ep: 472, Reward: 835.5683, Test: 854.0384 [54.91], Avg: 252.2985 (0.020)
Ep: 473, Reward: 720.6735, Test: 773.2441 [91.88], Avg: 253.2037 (0.020)
Ep: 474, Reward: 767.0407, Test: 751.7452 [99.69], Avg: 254.0434 (0.020)
Ep: 475, Reward: 673.3130, Test: 758.9925 [118.84], Avg: 254.8545 (0.020)
Ep: 476, Reward: 783.6791, Test: 786.5248 [96.37], Avg: 255.7671 (0.020)
Ep: 477, Reward: 706.8336, Test: 801.4303 [70.33], Avg: 256.7616 (0.020)
Ep: 478, Reward: 823.4564, Test: 629.3248 [285.73], Avg: 256.9428 (0.020)
Ep: 479, Reward: 680.1214, Test: 585.3665 [239.83], Avg: 257.1274 (0.020)
Ep: 480, Reward: 635.2816, Test: 551.4755 [228.89], Avg: 257.2635 (0.020)
Ep: 481, Reward: 721.4291, Test: 463.8450 [301.20], Avg: 257.0672 (0.020)
Ep: 482, Reward: 368.7542, Test: 406.7724 [218.36], Avg: 256.9250 (0.020)
Ep: 483, Reward: 493.4601, Test: 623.1362 [197.67], Avg: 257.2733 (0.020)
Ep: 484, Reward: 534.6956, Test: 407.4099 [231.77], Avg: 257.1050 (0.020)
Ep: 485, Reward: 481.4738, Test: 526.6388 [228.05], Avg: 257.1903 (0.020)
Ep: 486, Reward: 613.7168, Test: 790.7695 [184.25], Avg: 257.9076 (0.020)
Ep: 487, Reward: 819.7783, Test: 868.6805 [52.78], Avg: 259.0510 (0.020)
Ep: 488, Reward: 897.4137, Test: 755.1496 [205.31], Avg: 259.6457 (0.020)
Ep: 489, Reward: 738.3296, Test: 745.4401 [180.79], Avg: 260.2682 (0.020)
Ep: 490, Reward: 739.2242, Test: 768.2608 [129.47], Avg: 261.0391 (0.020)
Ep: 491, Reward: 654.0963, Test: 716.2283 [122.96], Avg: 261.7143 (0.020)
Ep: 492, Reward: 670.4000, Test: 709.9949 [183.41], Avg: 262.2516 (0.020)
Ep: 493, Reward: 672.5653, Test: 873.9650 [32.85], Avg: 263.4234 (0.020)
Ep: 494, Reward: 757.3261, Test: 724.5030 [170.81], Avg: 264.0098 (0.020)
Ep: 495, Reward: 825.0956, Test: 786.3819 [178.90], Avg: 264.7023 (0.020)
Ep: 496, Reward: 836.5782, Test: 792.3890 [142.11], Avg: 265.4781 (0.020)
Ep: 497, Reward: 724.1611, Test: 718.7695 [193.00], Avg: 266.0008 (0.020)
Ep: 498, Reward: 768.1109, Test: 738.6863 [189.65], Avg: 266.5680 (0.020)
Ep: 499, Reward: 736.7620, Test: 864.0386 [31.34], Avg: 267.7003 (0.020)
